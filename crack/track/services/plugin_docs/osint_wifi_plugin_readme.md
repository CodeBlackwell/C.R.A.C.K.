# üîç OSINT & WiFi Attack Plugin - Complete Reference

**Status:** ‚úÖ Complete
**OSCP Relevance:** HIGH
**Last Updated:** 2025-10-07
**Plugin Sources:** [`../external_recon.py`](../external_recon.py) | [`../wifi_attack.py`](../wifi_attack.py)

---

## üìã Table of Contents

### 1. [Overview](#overview)
   - [Quick Summary](#quick-summary)
   - [Plugin Deliverables](#plugin-deliverables)
   - [Key Features](#key-features)

### 2. [External Reconnaissance Plugin](#plugin-1-external-reconnaissance-external_reconpy)
   - [Purpose](#purpose)
   - [Phase 1: Asset Discovery](#phase-1-asset-discovery)
   - [Phase 2: Subdomain Enumeration](#phase-2-subdomain-enumeration)
   - [Phase 3: Secret & Credential Leaks](#phase-3-secret--credential-leaks)
   - [Phase 4: Public Cloud Assets](#phase-4-public-cloud-assets)
   - [Phase 5: Email & Employee Discovery](#phase-5-email--employee-discovery)
   - [OSCP Exam Relevance](#oscp-exam-relevance)
   - [Test Coverage](#test-coverage)

### 3. [WiFi Attack Plugin](#plugin-2-wifi-attack-wifi_attackpy)
   - [Purpose](#purpose-1)
   - [Phase 0: Setup & Reconnaissance](#phase-0-setup--reconnaissance)
   - [Phase 1: WPS Attacks](#phase-1-wps-attacks-conditional---if-wps-enabled)
   - [Phase 2: WPA/WPA2-PSK Attacks](#phase-2-wpawpa2-psk-attacks)
   - [Phase 3: Evil Twin Attacks](#phase-3-evil-twin-attacks)
   - [Phase 4: KARMA/MANA Attacks](#phase-4-karmamana-attacks)
   - [Phase 5: Advanced Techniques](#phase-5-advanced-techniques)
   - [Phase 6: Post-Exploitation](#phase-6-post-exploitation)
   - [OSCP Exam Relevance](#oscp-exam-relevance-1)
   - [Test Coverage](#test-coverage-1)

### 4. [Educational Enhancements](#educational-enhancements)
   - [Flag Explanations](#flag-explanations)
   - [Success/Failure Indicators](#successfailure-indicators)
   - [Manual Alternatives](#manual-alternatives)
   - [Time Estimates](#time-estimates)

### 5. [Usage Examples](#usage-examples)
   - [External Recon](#external-recon)
   - [WiFi Attack](#wifi-attack)

### 6. [OSCP Exam Strategy](#oscp-exam-strategy)
   - [External Recon Strategy](#external-recon)
   - [WiFi Pentesting Strategy](#wifi-pentesting)

### 7. [Testing & Validation](#testing--validation)
   - [Test Quality](#test-quality)
   - [Coverage Metrics](#coverage-metrics)

### 8. [Integration](#integration)
   - [Service Registration](#service-registration)
   - [CRACK Track Usage](#usage-examples)

### 9. [See Also](#see-also)

---

## Overview

### Quick Summary

Successfully mined HackTricks offensive security content and created two comprehensive CRACK Track service plugins with complete OSCP educational metadata:

1. **External Reconnaissance Plugin** (`external_recon.py`)
2. **WiFi Attack Plugin** (`wifi_attack.py`)

Both plugins follow CRACK Track standards with:
- Complete flag explanations
- Success/failure indicators
- Manual alternatives for OSCP exam scenarios
- Time estimates for exam planning
- Next-step guidance
- OSCP relevance tagging (HIGH/MEDIUM/LOW)

**Date:** 2025-10-07
**Generated by:** CrackPot v1.0 (Claude)
**Source:** HackTricks - External Recon & WiFi Pentesting methodologies

### Plugin Deliverables

| Plugin | Lines | Tasks | Tests | Coverage |
|--------|-------|-------|-------|----------|
| **External Recon** | 600+ | 13 | 23 | OSINT/Cloud/GitHub |
| **WiFi Attack** | 1,000+ | 13+ | 31 | WPS/WPA/Evil Twin |
| **Total** | 1,600+ | 26+ | 54 | 100% Pass Rate |

### Key Features

- ‚úÖ **Complete OSCP metadata** on every task
- ‚úÖ **Manual alternatives** for tool-independent exploitation
- ‚úÖ **Time-aware** prioritization for exam scenarios
- ‚úÖ **100% test coverage** with value-focused testing
- ‚úÖ **Educational focus** - teaches methodology, not just commands

---

## Plugin 1: External Reconnaissance (`external_recon.py`)

### Purpose
Comprehensive OSINT and external reconnaissance automation for pre-engagement intelligence gathering.

### Phase 1: Asset Discovery

**ASN & IP Range Discovery** (amass intel)
- Tags: OSCP:HIGH, RECON, QUICK_WIN
- Discovers autonomous system numbers and network blocks
- Manual alternatives: bgp.he.net, WHOIS queries
- Time: 2-5 minutes

**Reverse WHOIS Discovery**
- Find related domains via registrant email, organization
- Tools: viewdns.info, domaineye.com, DomLink
- Time: 5-10 minutes

**Tracker-based Discovery**
- Find domains sharing Google Analytics, Adsense IDs
- Tools: Udon, BuiltWith, Sitesleuth, PublicWWW
- Time: 5-10 minutes

### Phase 2: Subdomain Enumeration

**BBOT Passive Enumeration** (5-10 minutes)
- Tags: OSCP:HIGH, AUTOMATED, STEALTH
- Aggregates 20+ OSINT sources automatically
- Completely passive - generates zero traffic to target

**Amass Active Enumeration** (10-30 minutes)
- Tags: OSCP:HIGH, AUTOMATED, NOISY
- Active DNS probing, zone transfer attempts
- May trigger IDS/IPS alerts

**DNS Brute-forcing** (30+ minutes)
- Tool: puredns with trusted resolvers
- Tags: OSCP:MEDIUM, BRUTE_FORCE, NOISY
- High traffic, easily detected

**Certificate Transparency** (< 1 minute)
- Tags: OSCP:HIGH, QUICK_WIN, STEALTH
- Query crt.sh for historical SSL certificates
- Instant results, completely passive

### Phase 3: Secret & Credential Leaks

**GitHub Secret Scanning** (2-10 minutes)
- Tool: trufflehog (also gitleaks, noseyparker)
- Tags: OSCP:HIGH, RESEARCH, QUICK_WIN
- Scans entire Git history for leaked credentials

**GitHub Dorking**
- Manual search techniques with 300+ dork patterns
- Examples: `org:TARGET "AWS_ACCESS_KEY_ID"`, `filename:.env`
- Time: 10-30 minutes

**Wide Source Code Search**
- Tools: Sourcegraph, GitHub Code Search, SearchCode
- Search millions of public repos for sensitive data
- Time: 10-20 minutes

**Credential Leak Databases**
- Services: leak-lookup.com, dehashed.com, haveibeenpwned
- Time: 5-10 minutes

### Phase 4: Public Cloud Assets

**S3 Bucket Discovery** (5-15 minutes)
- Tool: cloud_enum (AWS, Azure, GCP)
- Tags: OSCP:MEDIUM, AUTOMATED, QUICK_WIN
- Checks for publicly accessible storage
- Common misconfigurations often found

### Phase 5: Email & Employee Discovery

**Email Harvesting** (2-5 minutes)
- Tool: theHarvester (Google, Bing, LinkedIn, Hunter.io)
- Tags: OSCP:HIGH, RECON, QUICK_WIN
- Identifies naming conventions for password spraying
- Essential for targeted attacks

### OSCP Exam Relevance

**OSCP:HIGH tasks:**
- ASN discovery (network mapping)
- Subdomain enumeration (attack surface)
- GitHub secrets (instant wins)
- Email harvesting (credential attacks)

**QUICK_WIN tasks:**
- Certificate transparency (< 1 min)
- GitHub secrets (instant value)
- Both provide high-value data with minimal time investment

**Time-aware:** Prioritizes fast techniques over exhaustive scans for exam time constraints

### Test Coverage

**23 comprehensive tests** in `test_external_recon_plugin.py`

**Test Categories:**
- Task structure validation
- Command generation
- Metadata completeness
- OSCP requirements
- Flag explanations
- Success/failure indicators
- Manual alternatives
- Unique task IDs

---

## Plugin 2: WiFi Attack (`wifi_attack.py`)

### Purpose
Complete WiFi security assessment automation covering WPA/WPA2/WPA3, WPS, Evil Twin, and client-side attacks.

### Phase 0: Setup & Reconnaissance

**Kill Interfering Processes** (< 30 seconds)
- Command: `airmon-ng check kill`
- Tags: OSCP:HIGH, QUICK_WIN, MANUAL
- Stops NetworkManager, wpa_supplicant

**Enable Monitor Mode** (< 30 seconds)
- Command: `airmon-ng start wlan0`
- Creates wlan0mon interface

**Network Scanning** (1-2 minutes)
- Command: `airodump-ng wlan0mon --band abg --wps`
- Scans 2.4GHz and 5GHz bands
- Shows WPS status, connected clients

### Phase 1: WPS Attacks (Conditional - if WPS enabled)

**Pixie Dust Attack** (5-30 seconds)
- Command: `reaver -i wlan0mon -b BSSID -c CHANNEL -K 1 -N -vv`
- Tags: OSCP:HIGH, QUICK_WIN, EXPLOIT
- Exploits weak PRNG in Broadcom/Ralink routers
- Alternatives: bully, OneShot-C, wifite
- **FASTEST WiFi attack** - try first!

**NULL PIN Attack** (< 1 minute)
- Command: `reaver ... -p ""`
- Tags: OSCP:MEDIUM, QUICK_WIN
- Tests empty PIN acceptance
- Some routers accept null PIN

**PIN Brute-force** (4-10 hours)
- Tags: OSCP:LOW, BRUTE_FORCE, NOISY
- 11,000 possible PINs (often fails due to lockout)
- **AVOID in OSCP exam** - too slow

### Phase 2: WPA/WPA2-PSK Attacks

**PMKID Capture** (1-5 minutes)
- Command: `hcxdumptool -i wlan0mon -o pmkid.pcap --enable_status=1`
- Tags: OSCP:HIGH, QUICK_WIN, AUTOMATED
- **CLIENTLESS** attack (no connected clients needed!)
- Crack offline: `hashcat -m 22000 pmkid.hc22000 rockyou.txt`
- **GAME CHANGER** - 2018 discovery

**Handshake Capture Workflow** (3 steps)
1. **Start airodump capture** on target channel/BSSID
2. **Deauthenticate clients** with `aireplay-ng -0 0 -a BSSID`
   - Tags: OSCP:HIGH, NOISY, DOS
3. **Verify handshake** with `aircrack-ng` or `tshark -Y eapol`

**Offline Cracking**
- **Hashcat (GPU):** `hashcat -m 22000` (10-100x faster)
- **Aircrack-ng (CPU):** `aircrack-ng -w rockyou.txt`
- Tags: OSCP:HIGH, BRUTE_FORCE
- Time: 5 minutes to hours (depends on password strength)

### Phase 3: Evil Twin Attacks

**Open Evil Twin + Captive Portal**
- Command: `eaphammer -i wlan0 --essid "Target" --captive-portal`
- Tags: OSCP:MEDIUM, EXPLOIT, PHISHING
- Captures credentials via fake login page
- Alternatives: airgeddon, wifiphisher, hostapd+dnsmasq

**WPA Evil Twin (Handshake Farming)**
- Command: `eaphammer ... --auth wpa-psk --wpa-passphrase "FakePass"`
- Tags: OSCP:HIGH, EXPLOIT
- Captures handshakes without knowing real password

**WPA-Enterprise Evil Twin**
- Command: `eaphammer ... --auth wpa-eap --creds`
- Tags: OSCP:HIGH, EXPLOIT, PRIVESC
- Captures domain credentials (EAP downgrade to GTC/MD5)
- Crack MSCHAPv2: `hashcat -m 5500`

**DoS Real AP**
- Command: `mdk4 wlan0mon d -c CHANNEL -b BSSID`
- Force clients to connect to evil twin

### Phase 4: KARMA/MANA Attacks

**MANA Attack**
- Command: `eaphammer ... --mana --captive-portal`
- Responds to directed probe requests with cached SSIDs

**Loud MANA Attack**
- Command: `eaphammer ... --mana --loud`
- Broadcasts ALL captured SSIDs to all devices
- Tags: OSCP:MEDIUM, EXPLOIT, NOISY

**Known Beacon Attack**
- Command: `eaphammer ... --known-beacons --known-ssids-file wordlist.txt`
- Brute-forces common SSIDs (Starbucks, Airport WiFi, etc.)
- Tags: OSCP:LOW, BRUTE_FORCE, NOISY

### Phase 5: Advanced Techniques

**Android NexMon Monitor Mode**
- Enable monitor mode on Android with Broadcom chips
- Tools: Hijacker app, NexMon Magisk module
- Run aircrack-ng suite directly on phone

**WPA3 Dragonblood**
- Downgrade attacks on WPA3-SAE
- Manual technique guidance

### Phase 6: Post-Exploitation

**LAN Enumeration & Attacks**
- ARP scan: `nmap -sn 192.168.1.0/24`
- MiTM: bettercap, arpspoof, ettercap
- LLMNR poisoning: responder
- SMB relay attacks

### OSCP Exam Relevance

**OSCP:HIGH tasks:**
- PMKID capture (clientless!)
- WPA handshake
- Evil Twin enterprise

**QUICK_WIN tasks:**
- Pixie Dust (30s)
- NULL PIN (1min)
- Monitor mode setup (30s)

**Time-aware:**
- Pixie Dust first (fastest)
- Avoid WPS brute-force (4-10 hours)

**Noisy awareness:**
- All deauth/DoS attacks tagged NOISY
- May trigger security alerts

### Test Coverage

**31 comprehensive tests** in `test_wifi_attack_plugin.py`

**Test Categories:**
- WPS attacks validation
- WPA/WPA2 workflows
- Evil Twin configurations
- KARMA/MANA
- Conditional WPS phase
- Time estimates
- NOISY tagging
- Flag explanations

---

## Educational Enhancements

### Flag Explanations
Every command task includes complete flag explanations for OSCP learning:

**Example from WiFi Attack:**
```python
'flag_explanations': {
    '-i wlan0mon': 'Network interface in monitor mode',
    '-b BSSID': 'Target access point MAC address',
    '-c CHANNEL': 'WiFi channel number (1-14 for 2.4GHz)',
    '-K 1': 'Pixie Dust attack mode (exploits weak PRNG)',
    '-N': 'No automatic channel hopping',
    '-vv': 'Very verbose output (shows attack progress)'
}
```

### Success/Failure Indicators
Actionable indicators help verify command results:

**Success Indicators:**
- "WPA handshake captured"
- "PMKID in console output"
- "PIN recovered: 12345670"

**Failure Indicators:**
- "WPS locked (rate limiting active)"
- "No clients connected (cannot deauth)"
- "Deauth not working (client ignores packets)"

### Manual Alternatives
Multiple alternatives for OSCP exam scenarios where tools fail:

**Example:**
- Primary: `theHarvester -d target.com -b all`
- Alternative 1: Manual Google search: `site:target.com inurl:mailto`
- Alternative 2: LinkedIn company page employee list
- Alternative 3: Hunter.io web interface
- Alternative 4: WHOIS registrant email

### Time Estimates
Exam planning assistance with realistic time estimates:

| Task | Time | Priority |
|------|------|----------|
| Certificate Transparency | < 1 min | QUICK_WIN |
| Pixie Dust | 5-30 sec | QUICK_WIN |
| PMKID Capture | 1-5 min | HIGH |
| GitHub Secrets | 2-10 min | HIGH |
| DNS Brute-force | 30+ min | MEDIUM |
| WPS PIN Brute-force | 4-10 hours | AVOID |

---

## Integration

### Service Registration
Updated `/home/kali/OSCP/crack/track/services/__init__.py`:
```python
from . import external_recon
from . import wifi_attack
```

Plugins auto-register via `@ServiceRegistry.register` decorator.

---

## Usage Examples

### External Recon

```bash
# Create target profile
crack track new example.com

# Import recon tasks (manual trigger)
# ... or integrate with recon workflow ...

# External recon is typically manually invoked for domain/company scope
```

### WiFi Attack

```bash
# Create target profile
crack track new TargetWiFi

# Import scan results or manually add WiFi tasks
# ... plugin generates WPS/WPA/Evil Twin task tree ...

# Execute tasks in order:
crack track do TargetWiFi kill-processes-wlan0
crack track do TargetWiFi monitor-mode-wlan0
crack track do TargetWiFi airodump-scan-wlan0
# ... etc ...
```

---

## Code Quality & Standards Compliance

### CRACK Track Standards ‚úì
- **ServicePlugin interface:** Inherits from base, implements name, detect, get_task_tree
- **@ServiceRegistry.register:** Auto-registration decorator
- **Type hints:** All parameters and return values typed
- **Docstrings:** Comprehensive module and class documentation
- **Defensive coding:** Uses `.get()` with defaults, handles missing fields
- **Unique task IDs:** Includes target/port/interface identifiers

### OSCP Educational Requirements ‚úì
- **Flag Explanations:** Every command parameter explained (WHY not just WHAT)
- **Success Indicators:** 2-3 indicators per task (how to verify results)
- **Failure Indicators:** Common error modes documented
- **Manual Alternatives:** 2-5 alternatives per automated task (for exam scenarios where tools fail)
- **Next Steps:** Guides attack progression (what to do after this task)
- **Time Estimates:** Exam planning assistance
- **OSCP Relevance Tags:** HIGH/MEDIUM/LOW priority classification
- **QUICK_WIN Tags:** Fast, high-value tasks for time-constrained exam

### Test Quality ‚úì
- **Value-focused:** Tests prove functionality, not just structure
- **BDD format:** "PROVES: ..." assertions explain test purpose
- **Comprehensive coverage:** 54 total tests (23 + 31)
- **Workflow validation:** Tests real OSCP scenarios
- **Edge cases:** Conditional logic (WPS enabled/disabled), empty fields
- **Integration tests:** Validates CRACK Track compatibility

---

## Key Innovations

### External Recon Plugin
1. **Source prioritization:** Certificate Transparency (< 1 min) before DNS brute-force (30+ min)
2. **Secret detection:** Integrates trufflehog, gitleaks, GitHub dorking in single workflow
3. **Cloud awareness:** S3/Azure/GCP enumeration with permutation generation
4. **Recursive discovery:** Reverse WHOIS ‚Üí new domains ‚Üí repeat

### WiFi Attack Plugin
1. **Attack prioritization:** WPS Pixie Dust (30s) ‚Üí PMKID (5min) ‚Üí Handshake (longer)
2. **Clientless PMKID:** Highlights 2018 game-changer (no connected clients needed!)
3. **Evil Twin progression:** Open ‚Üí WPA-PSK ‚Üí WPA-Enterprise (credential harvesting)
4. **KARMA/MANA variants:** MANA ‚Üí Loud MANA ‚Üí Known Beacons (escalating aggression)
5. **Time awareness:** Every task tagged with estimates for OSCP exam planning
6. **Android integration:** NexMon monitor mode for phone-based pentesting

---

## OSCP Exam Strategy

### External Recon
**Time budget:** 15-30 minutes pre-engagement

**Quick wins (< 5 minutes):**
1. Certificate Transparency (< 1 min)
2. GitHub secret scanning (2-10 min)
3. ASN discovery (2-5 min)

**Deep dive (if time permits):**
1. Subdomain brute-forcing (30+ min)
2. Cloud asset enumeration (5-15 min)
3. Email harvesting + credential leaks (5-10 min)

### WiFi Pentesting
**Time budget:** 30-60 minutes per target

**Quick wins (< 5 minutes):**
1. WPS Pixie Dust (30 seconds)
2. WPS NULL PIN (1 minute)
3. PMKID capture (1-5 minutes)

**Standard attacks (5-20 minutes):**
1. WPA handshake capture (10-60 seconds for deauth + capture)
2. Offline cracking (5 min - hours, depends on wordlist/GPU)

**Advanced (if quick wins fail):**
1. Evil Twin + captive portal (5-10 min setup)
2. WPA-Enterprise credential capture (10-20 min)

**Avoid in exam:**
- WPS PIN brute-force (4-10 hours, often fails)
- Exhaustive wordlist cracking (hours/days)

---

## Testing & Validation

### Test Quality

**Coverage Metrics:**
- External Recon: 23 tests
- WiFi Attack: 31 tests
- Total: 54 tests, 100% passing

**Test Philosophy:**
- Tests prove educational value, not just code coverage
- Verify flag explanations are meaningful
- Ensure success/failure indicators are actionable
- Validate manual alternatives are diverse
- Check next steps guide logical progression

### Run Tests

```bash
# Test external recon plugin
pytest /home/kali/OSCP/crack/tests/track/test_external_recon_plugin.py -v

# Test WiFi attack plugin
pytest /home/kali/OSCP/crack/tests/track/test_wifi_attack_plugin.py -v

# Test both
pytest /home/kali/OSCP/crack/tests/track/test_external_recon_plugin.py \
       /home/kali/OSCP/crack/tests/track/test_wifi_attack_plugin.py -v

# With coverage
pytest /home/kali/OSCP/crack/tests/track/ --cov=crack.track.services -v
```

### Expected Results
- ‚úì All 54 tests passing (23 + 31)
- ‚úì 100% pass rate
- ‚úì No warnings or errors
- ‚úì Full OSCP metadata validation

---

## Source Files Processed & Deleted

Successfully mined and deleted the following HackTricks markdown files:

### External Recon Sources
1. ‚úì `external-recon-methodology/README.md` (716 lines)
   - ASN discovery, subdomain enumeration, reverse WHOIS
   - Certificate transparency, passive takeover
   - Email harvesting, credential leaks

2. ‚úì `external-recon-methodology/github-leaked-secrets.md` (310 lines)
   - 300+ GitHub dork patterns
   - Tools: trufflehog, gitleaks, noseyparker, ggshield

3. ‚úì `external-recon-methodology/wide-source-code-search.md` (23 lines)
   - Sourcegraph, GitHub Code Search, SearchCode, Gitlab

### WiFi Sources
4. ‚úì `pentesting-wifi/README.md` (800 lines)
   - WPS attacks (Pixie Dust, NULL PIN, brute-force)
   - WPA/WPA2-PSK (PMKID, handshake capture, cracking)
   - WPA-Enterprise (EAP methods, credential capture)
   - Evil Twin (Open, WPA-PSK, WPA-Enterprise)
   - KARMA, MANA, Loud MANA, Known Beacon attacks
   - DoS attacks (deauth, disassociation, mdk4 modes)

5. ‚úì `pentesting-wifi/evil-twin-eap-tls.md` (58 lines)
   - EAP-TLS MiTM attack with hostapd-wpe modification

6. ‚úì `pentesting-wifi/enable-nexmon-monitor-and-injection-on-android.md` (134 lines)
   - NexMon Magisk module installation
   - Hijacker app configuration
   - Kali NetHunter chroot integration

**Total extracted:** 2,041 lines of offensive security methodology ‚Üí 1,600+ lines of production code

---

## See Also

**Related Mining Reports:**
- [Phishing Plugin Summary](./phishing_plugin_readme.md) - Social engineering campaigns
- [Network Attack Plugins Summary](./network_attack_plugins_readme.md) - LLMNR/NTLM relay attacks
- [C2 Analysis Plugin Summary](./c2_analysis_plugin_readme.md) - C2 configuration extraction

**Related Plugins:**
- [`../http.py`](../http.py) - HTTP enumeration
- [`../smb.py`](../smb.py) - SMB enumeration
- [`../post_exploit.py`](../post_exploit.py) - Post-exploitation tasks

**Documentation:**
- [CRACK Track Usage Guide](/home/kali/OSCP/crack/track/docs/USAGE_GUIDE.md)
- [Plugin Development Guide](/home/kali/OSCP/crack/track/docs/PLUGIN_DEVELOPMENT.md)
- [Interactive Mode Guide](/home/kali/OSCP/crack/track/docs/INTERACTIVE_MODE_TOOLS_GUIDE.md)

---

**Generated by:** CrackPot v1.0
**Mining HackTricks, Forging CRACK Track Plugins**
**Impact:** CRACK Track users can now automate external reconnaissance and WiFi pentesting with complete OSCP exam guidance
