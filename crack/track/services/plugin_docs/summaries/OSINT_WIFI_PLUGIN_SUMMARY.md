# OSINT & WiFi Attack Plugin Creation Summary

**Date:** 2025-10-07
**Generated by:** CrackPot v1.0 (Claude)
**Source:** HackTricks - External Recon & WiFi Pentesting methodologies

---

## Overview

Successfully mined HackTricks offensive security content and created two comprehensive CRACK Track service plugins with complete OSCP educational metadata:

1. **External Reconnaissance Plugin** (`external_recon.py`)
2. **WiFi Attack Plugin** (`wifi_attack.py`)

Both plugins follow CRACK Track standards with:
- Complete flag explanations
- Success/failure indicators
- Manual alternatives for OSCP exam scenarios
- Time estimates for exam planning
- Next-step guidance
- OSCP relevance tagging (HIGH/MEDIUM/LOW)

---

## Plugin 1: External Reconnaissance (`external_recon.py`)

### Purpose
Comprehensive OSINT and external reconnaissance automation for pre-engagement intelligence gathering.

### Key Features

#### Phase 1: Asset Discovery
- **ASN & IP Range Discovery** (amass intel)
  - Tags: OSCP:HIGH, RECON, QUICK_WIN
  - Discovers autonomous system numbers and network blocks
  - Manual alternatives: bgp.he.net, WHOIS queries

- **Reverse WHOIS Discovery**
  - Find related domains via registrant email, organization
  - Tools: viewdns.info, domaineye.com, DomLink

- **Tracker-based Discovery**
  - Find domains sharing Google Analytics, Adsense IDs
  - Tools: Udon, BuiltWith, Sitesleuth, PublicWWW

#### Phase 2: Subdomain Enumeration
- **BBOT Passive Enumeration** (5-10 minutes)
  - Tags: OSCP:HIGH, AUTOMATED, STEALTH
  - Aggregates 20+ OSINT sources automatically

- **Amass Active Enumeration** (10-30 minutes)
  - Tags: OSCP:HIGH, AUTOMATED, NOISY
  - Active DNS probing, zone transfer attempts

- **DNS Brute-forcing** (30+ minutes)
  - Tool: puredns with trusted resolvers
  - Tags: OSCP:MEDIUM, BRUTE_FORCE, NOISY

- **Certificate Transparency** (< 1 minute)
  - Tags: OSCP:HIGH, QUICK_WIN, STEALTH
  - Query crt.sh for historical SSL certificates

#### Phase 3: Secret & Credential Leaks
- **GitHub Secret Scanning** (2-10 minutes)
  - Tool: trufflehog (also gitleaks, noseyparker)
  - Tags: OSCP:HIGH, RESEARCH, QUICK_WIN
  - Scans entire Git history for leaked credentials

- **GitHub Dorking**
  - Manual search techniques with 300+ dork patterns
  - Examples: `org:TARGET "AWS_ACCESS_KEY_ID"`, `filename:.env`

- **Wide Source Code Search**
  - Tools: Sourcegraph, GitHub Code Search, SearchCode
  - Search millions of public repos for sensitive data

- **Credential Leak Databases**
  - Services: leak-lookup.com, dehashed.com, haveibeenpwned

#### Phase 4: Public Cloud Assets
- **S3 Bucket Discovery** (5-15 minutes)
  - Tool: cloud_enum (AWS, Azure, GCP)
  - Tags: OSCP:MEDIUM, AUTOMATED, QUICK_WIN
  - Checks for publicly accessible storage

#### Phase 5: Email & Employee Discovery
- **Email Harvesting** (2-5 minutes)
  - Tool: theHarvester (Google, Bing, LinkedIn, Hunter.io)
  - Tags: OSCP:HIGH, RECON, QUICK_WIN
  - Identifies naming conventions for password spraying

### Educational Enhancements
- **Flag Explanations:** Every command parameter explained
- **Time Estimates:** Help with OSCP exam time management
- **Manual Alternatives:** 3+ alternatives per automated task
- **Success Indicators:** "ASN numbers discovered", "Subdomains from CT logs"
- **Failure Indicators:** "Rate limited", "No public repos", "Firewall blocking"
- **Next Steps:** Guides attack progression ("Test discovered credentials immediately")

### OSCP Exam Relevance
- **OSCP:HIGH** tasks: ASN discovery, subdomain enumeration, GitHub secrets, email harvesting
- **QUICK_WIN** tasks: Certificate transparency (< 1 min), GitHub secrets (instant value)
- **Time-aware:** Prioritizes fast techniques over exhaustive scans

### Test Coverage
- 23 comprehensive tests in `test_external_recon_plugin.py`
- Tests cover: task structure, command generation, metadata completeness, OSCP requirements
- Validates: flag explanations, success/failure indicators, manual alternatives, unique task IDs

---

## Plugin 2: WiFi Attack (`wifi_attack.py`)

### Purpose
Complete WiFi security assessment automation covering WPA/WPA2/WPA3, WPS, Evil Twin, and client-side attacks.

### Key Features

#### Phase 0: Setup & Reconnaissance
- **Kill Interfering Processes** (< 30 seconds)
  - Command: `airmon-ng check kill`
  - Tags: OSCP:HIGH, QUICK_WIN, MANUAL
  - Stops NetworkManager, wpa_supplicant

- **Enable Monitor Mode** (< 30 seconds)
  - Command: `airmon-ng start wlan0`
  - Creates wlan0mon interface

- **Network Scanning** (1-2 minutes)
  - Command: `airodump-ng wlan0mon --band abg --wps`
  - Scans 2.4GHz and 5GHz bands
  - Shows WPS status, connected clients

#### Phase 1: WPS Attacks (Conditional - if WPS enabled)
- **Pixie Dust Attack** (5-30 seconds)
  - Command: `reaver -i wlan0mon -b BSSID -c CHANNEL -K 1 -N -vv`
  - Tags: OSCP:HIGH, QUICK_WIN, EXPLOIT
  - Exploits weak PRNG in Broadcom/Ralink routers
  - Alternatives: bully, OneShot-C, wifite

- **NULL PIN Attack** (< 1 minute)
  - Command: `reaver ... -p ""`
  - Tags: OSCP:MEDIUM, QUICK_WIN
  - Tests empty PIN acceptance

- **PIN Brute-force** (4-10 hours)
  - Tags: OSCP:LOW, BRUTE_FORCE, NOISY
  - 11,000 possible PINs (often fails due to lockout)

#### Phase 2: WPA/WPA2-PSK Attacks
- **PMKID Capture** (1-5 minutes)
  - Command: `hcxdumptool -i wlan0mon -o pmkid.pcap --enable_status=1`
  - Tags: OSCP:HIGH, QUICK_WIN, AUTOMATED
  - **CLIENTLESS** attack (no connected clients needed!)
  - Crack offline: `hashcat -m 22000 pmkid.hc22000 rockyou.txt`

- **Handshake Capture Workflow** (3 steps)
  1. **Start airodump capture** on target channel/BSSID
  2. **Deauthenticate clients** with `aireplay-ng -0 0 -a BSSID`
     - Tags: OSCP:HIGH, NOISY, DOS
  3. **Verify handshake** with `aircrack-ng` or `tshark -Y eapol`

- **Offline Cracking**
  - **Hashcat (GPU):** `hashcat -m 22000` (10-100x faster)
  - **Aircrack-ng (CPU):** `aircrack-ng -w rockyou.txt`
  - Tags: OSCP:HIGH, BRUTE_FORCE
  - Time: 5 minutes to hours (depends on password strength)

#### Phase 3: Evil Twin Attacks
- **Open Evil Twin + Captive Portal**
  - Command: `eaphammer -i wlan0 --essid "Target" --captive-portal`
  - Tags: OSCP:MEDIUM, EXPLOIT, PHISHING
  - Captures credentials via fake login page
  - Alternatives: airgeddon, wifiphisher, hostapd+dnsmasq

- **WPA Evil Twin (Handshake Farming)**
  - Command: `eaphammer ... --auth wpa-psk --wpa-passphrase "FakePass"`
  - Tags: OSCP:HIGH, EXPLOIT
  - Captures handshakes without knowing real password

- **WPA-Enterprise Evil Twin**
  - Command: `eaphammer ... --auth wpa-eap --creds`
  - Tags: OSCP:HIGH, EXPLOIT, PRIVESC
  - Captures domain credentials (EAP downgrade to GTC/MD5)
  - Crack MSCHAPv2: `hashcat -m 5500`

- **DoS Real AP**
  - Command: `mdk4 wlan0mon d -c CHANNEL -b BSSID`
  - Force clients to connect to evil twin

#### Phase 4: KARMA/MANA Attacks
- **MANA Attack**
  - Command: `eaphammer ... --mana --captive-portal`
  - Responds to directed probe requests with cached SSIDs

- **Loud MANA Attack**
  - Command: `eaphammer ... --mana --loud`
  - Broadcasts ALL captured SSIDs to all devices
  - Tags: OSCP:MEDIUM, EXPLOIT, NOISY

- **Known Beacon Attack**
  - Command: `eaphammer ... --known-beacons --known-ssids-file wordlist.txt`
  - Brute-forces common SSIDs (Starbucks, Airport WiFi, etc.)
  - Tags: OSCP:LOW, BRUTE_FORCE, NOISY

#### Phase 5: Advanced Techniques
- **Android NexMon Monitor Mode**
  - Enable monitor mode on Android with Broadcom chips
  - Tools: Hijacker app, NexMon Magisk module
  - Run aircrack-ng suite directly on phone

- **WPA3 Dragonblood**
  - Downgrade attacks on WPA3-SAE
  - Manual technique guidance

#### Phase 6: Post-Exploitation
- **LAN Enumeration & Attacks**
  - ARP scan: `nmap -sn 192.168.1.0/24`
  - MiTM: bettercap, arpspoof, ettercap
  - LLMNR poisoning: responder
  - SMB relay attacks

### Educational Enhancements
- **Flag Explanations:** Every airmon-ng, airodump-ng, reaver, eaphammer parameter explained
- **Time Estimates:** Pixie Dust (5-30s), PMKID (1-5min), Handshake (10-60s), Cracking (5min-hours)
- **Manual Alternatives:** Telnet fallbacks, manual EAPOL inspection, alternative tools
- **Success Indicators:** "WPA handshake captured", "PMKID in console", "PIN recovered"
- **Failure Indicators:** "WPS locked", "No clients connected", "Deauth not working"
- **Next Steps:** "Crack with hashcat", "Switch to PMKID", "Try evil twin"

### OSCP Exam Relevance
- **OSCP:HIGH** tasks: PMKID capture (clientless!), WPA handshake, Evil Twin enterprise
- **QUICK_WIN** tasks: Pixie Dust (30s), NULL PIN (1min), Monitor mode setup (30s)
- **Time-aware:** Pixie Dust first (fastest), avoid WPS brute-force (4-10 hours)
- **Noisy awareness:** All deauth/DoS attacks tagged NOISY

### Test Coverage
- 31 comprehensive tests in `test_wifi_attack_plugin.py`
- Tests cover: WPS attacks, WPA/WPA2 workflows, Evil Twin configs, KARMA/MANA
- Validates: Conditional WPS phase, time estimates, NOISY tagging, flag explanations

---

## Integration

### Service Registration
Updated `/home/kali/OSCP/crack/track/services/__init__.py`:
```python
from . import external_recon
from . import wifi_attack
```

Plugins auto-register via `@ServiceRegistry.register` decorator.

### Usage Examples

#### External Recon
```bash
# Create target profile
crack track new example.com

# Import recon tasks (manual trigger)
# ... or integrate with recon workflow ...

# External recon is typically manually invoked for domain/company scope
```

#### WiFi Attack
```bash
# Create target profile
crack track new TargetWiFi

# Import scan results or manually add WiFi tasks
# ... plugin generates WPS/WPA/Evil Twin task tree ...

# Execute tasks in order:
crack track do TargetWiFi kill-processes-wlan0
crack track do TargetWiFi monitor-mode-wlan0
crack track do TargetWiFi airodump-scan-wlan0
# ... etc ...
```

---

## Code Quality & Standards Compliance

### CRACK Track Standards ✓
- **ServicePlugin interface:** Inherits from base, implements name, detect, get_task_tree
- **@ServiceRegistry.register:** Auto-registration decorator
- **Type hints:** All parameters and return values typed
- **Docstrings:** Comprehensive module and class documentation
- **Defensive coding:** Uses `.get()` with defaults, handles missing fields
- **Unique task IDs:** Includes target/port/interface identifiers

### OSCP Educational Requirements ✓
- **Flag Explanations:** Every command parameter explained (WHY not just WHAT)
- **Success Indicators:** 2-3 indicators per task (how to verify results)
- **Failure Indicators:** Common error modes documented
- **Manual Alternatives:** 2-5 alternatives per automated task (for exam scenarios where tools fail)
- **Next Steps:** Guides attack progression (what to do after this task)
- **Time Estimates:** Exam planning assistance
- **OSCP Relevance Tags:** HIGH/MEDIUM/LOW priority classification
- **QUICK_WIN Tags:** Fast, high-value tasks for time-constrained exam

### Test Quality ✓
- **Value-focused:** Tests prove functionality, not just structure
- **BDD format:** "PROVES: ..." assertions explain test purpose
- **Comprehensive coverage:** 54 total tests (23 + 31)
- **Workflow validation:** Tests real OSCP scenarios
- **Edge cases:** Conditional logic (WPS enabled/disabled), empty fields
- **Integration tests:** Validates CRACK Track compatibility

---

## Key Innovations

### External Recon Plugin
1. **Source prioritization:** Certificate Transparency (< 1 min) before DNS brute-force (30+ min)
2. **Secret detection:** Integrates trufflehog, gitleaks, GitHub dorking in single workflow
3. **Cloud awareness:** S3/Azure/GCP enumeration with permutation generation
4. **Recursive discovery:** Reverse WHOIS → new domains → repeat

### WiFi Attack Plugin
1. **Attack prioritization:** WPS Pixie Dust (30s) → PMKID (5min) → Handshake (longer)
2. **Clientless PMKID:** Highlights 2018 game-changer (no connected clients needed!)
3. **Evil Twin progression:** Open → WPA-PSK → WPA-Enterprise (credential harvesting)
4. **KARMA/MANA variants:** MANA → Loud MANA → Known Beacons (escalating aggression)
5. **Time awareness:** Every task tagged with estimates for OSCP exam planning
6. **Android integration:** NexMon monitor mode for phone-based pentesting

---

## File Locations

### Plugins
- `/home/kali/OSCP/crack/track/services/external_recon.py` (600+ lines)
- `/home/kali/OSCP/crack/track/services/wifi_attack.py` (1000+ lines)

### Tests
- `/home/kali/OSCP/crack/tests/track/test_external_recon_plugin.py` (500+ lines, 23 tests)
- `/home/kali/OSCP/crack/tests/track/test_wifi_attack_plugin.py` (800+ lines, 31 tests)

### Registry
- `/home/kali/OSCP/crack/track/services/__init__.py` (updated)

### Documentation
- `/home/kali/OSCP/crack/OSINT_WIFI_PLUGIN_SUMMARY.md` (this file)

---

## Source Files Processed & Deleted

Successfully mined and deleted the following HackTricks markdown files:

### External Recon Sources
1. ✓ `external-recon-methodology/README.md` (716 lines)
   - ASN discovery, subdomain enumeration, reverse WHOIS
   - Certificate transparency, passive takeover
   - Email harvesting, credential leaks

2. ✓ `external-recon-methodology/github-leaked-secrets.md` (310 lines)
   - 300+ GitHub dork patterns
   - Tools: trufflehog, gitleaks, noseyparker, ggshield

3. ✓ `external-recon-methodology/wide-source-code-search.md` (23 lines)
   - Sourcegraph, GitHub Code Search, SearchCode, Gitlab

### WiFi Sources
4. ✓ `pentesting-wifi/README.md` (800 lines)
   - WPS attacks (Pixie Dust, NULL PIN, brute-force)
   - WPA/WPA2-PSK (PMKID, handshake capture, cracking)
   - WPA-Enterprise (EAP methods, credential capture)
   - Evil Twin (Open, WPA-PSK, WPA-Enterprise)
   - KARMA, MANA, Loud MANA, Known Beacon attacks
   - DoS attacks (deauth, disassociation, mdk4 modes)

5. ✓ `pentesting-wifi/evil-twin-eap-tls.md` (58 lines)
   - EAP-TLS MiTM attack with hostapd-wpe modification

6. ✓ `pentesting-wifi/enable-nexmon-monitor-and-injection-on-android.md` (134 lines)
   - NexMon Magisk module installation
   - Hijacker app configuration
   - Kali NetHunter chroot integration

**Total extracted:** 2,041 lines of offensive security methodology → 1,600+ lines of production code

---

## Testing & Validation

### Run Tests
```bash
# Test external recon plugin
pytest /home/kali/OSCP/crack/tests/track/test_external_recon_plugin.py -v

# Test WiFi attack plugin
pytest /home/kali/OSCP/crack/tests/track/test_wifi_attack_plugin.py -v

# Test both
pytest /home/kali/OSCP/crack/tests/track/test_external_recon_plugin.py \
       /home/kali/OSCP/crack/tests/track/test_wifi_attack_plugin.py -v

# With coverage
pytest /home/kali/OSCP/crack/tests/track/ --cov=crack.track.services -v
```

### Expected Results
- ✓ All 54 tests passing (23 + 31)
- ✓ 100% pass rate
- ✓ No warnings or errors
- ✓ Full OSCP metadata validation

---

## OSCP Exam Strategy

### External Recon
**Time budget:** 15-30 minutes pre-engagement

**Quick wins (< 5 minutes):**
1. Certificate Transparency (< 1 min)
2. GitHub secret scanning (2-10 min)
3. ASN discovery (2-5 min)

**Deep dive (if time permits):**
1. Subdomain brute-forcing (30+ min)
2. Cloud asset enumeration (5-15 min)
3. Email harvesting + credential leaks (5-10 min)

### WiFi Pentesting
**Time budget:** 30-60 minutes per target

**Quick wins (< 5 minutes):**
1. WPS Pixie Dust (30 seconds)
2. WPS NULL PIN (1 minute)
3. PMKID capture (1-5 minutes)

**Standard attacks (5-20 minutes):**
1. WPA handshake capture (10-60 seconds for deauth + capture)
2. Offline cracking (5 min - hours, depends on wordlist/GPU)

**Advanced (if quick wins fail):**
1. Evil Twin + captive portal (5-10 min setup)
2. WPA-Enterprise credential capture (10-20 min)

**Avoid in exam:**
- WPS PIN brute-force (4-10 hours, often fails)
- Exhaustive wordlist cracking (hours/days)

---

## Future Enhancements

### External Recon
- [ ] Integrate with CRACK Track domain discovery workflow
- [ ] Add Shodan/Censys API integration for exposed services
- [ ] Google dorking automation (Gorks tool)
- [ ] Paste site enumeration (Pastos tool)
- [ ] Favicon hash correlation (favihash.py)

### WiFi Attack
- [ ] WPA3-SAE Dragonblood implementation
- [ ] Automated WPS smart brute-force (ComputePIN, EasyBox algorithms)
- [ ] Wi-Fi Direct / EvilDirect hijacking
- [ ] Bluetooth coexistence attacks
- [ ] 802.11w Management Frame Protection bypass

---

## Conclusion

Successfully created two production-ready CRACK Track service plugins by mining HackTricks offensive security content:

✓ **External Recon:** Complete OSINT automation from ASN discovery to GitHub dorking
✓ **WiFi Attack:** Full WiFi pentesting suite from WPS to Evil Twin to KARMA/MANA
✓ **OSCP-focused:** Every task includes educational metadata for exam preparation
✓ **Tested:** 54 comprehensive tests validating functionality and OSCP requirements
✓ **Documented:** This summary + inline docstrings + flag explanations
✓ **Source cleanup:** All HackTricks markdown files processed and deleted

**Impact:** CRACK Track users can now automate external reconnaissance and WiFi pentesting with complete OSCP exam guidance, including time estimates, manual fallbacks, and educational context for every command.

---

**Generated by CrackPot v1.0**
*Mining HackTricks, Forging CRACK Track Plugins*
