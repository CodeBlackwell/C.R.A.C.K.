# ðŸŽ¯ Phishing & Social Engineering Plugin - Complete Reference

**Status:** âœ… Complete
**OSCP Relevance:** MEDIUM
**Last Updated:** 2025-10-07
**Plugin Source:** [`../phishing.py`](../phishing.py)

---

## ðŸ“‹ Table of Contents

### 1. [Overview](#overview)
   - [Quick Summary](#quick-summary)
   - [Key Features](#key-features)
   - [Deliverables](#deliverables)

### 2. [Plugin Architecture](#plugin-architecture)
   - [Campaign Phases](#campaign-phases)
   - [Campaign Types](#campaign-types)
   - [Task Structure](#task-structure)

### 3. [Campaign Phases](#campaign-phases-detailed)
   - [Phase 1: Reconnaissance](#phase-1-reconnaissance)
   - [Phase 2: Infrastructure Setup](#phase-2-infrastructure-setup)
   - [Phase 3: Payload Creation](#phase-3-payload-creation)
   - [Phase 4: Campaign Delivery](#phase-4-campaign-delivery)
   - [Phase 5: Advanced Techniques](#phase-5-advanced-techniques)

### 4. [Tools & Technologies](#tools--technologies)
   - [Primary Tools](#primary-tools)
   - [Supporting Tools](#supporting-tools)
   - [DNS/Email Services](#dnsemail-services)
   - [OSINT/Research](#osintresearch)

### 5. [Advanced Techniques](#advanced-techniques)
   - [Homograph Attacks](#homograph-attacks)
   - [Clipboard Hijacking (ClickFix)](#clipboard-hijacking-clickfix)
   - [MFA Bypass Techniques](#mfa-bypass-techniques)
   - [Mobile Phishing](#mobile-phishing)
   - [AI-Enhanced Phishing](#ai-enhanced-phishing)
   - [Discord Invite Hijacking](#discord-invite-hijacking)

### 6. [Usage Examples](#usage-examples)
   - [Full Campaign](#example-1-full-phishing-campaign)
   - [Email-Only Campaign](#example-2-email-only-campaign)
   - [Web Campaign](#example-3-web-credential-harvesting)
   - [Mobile Campaign](#mobile-campaign)

### 7. [OSCP Exam Preparation](#oscp-exam-relevance)
   - [Educational Metadata](#oscp-educational-metadata)
   - [Tag Distribution](#tag-distribution)
   - [Time Estimates](#time-estimates)

### 8. [Testing & Validation](#testing--validation)
   - [Test Suite](#test-suite)
   - [Test Results](#test-results)
   - [Test Categories](#test-categories)

### 9. [Integration](#integration-with-crack-track)
   - [Manual Activation](#manual-activation)
   - [Task Tree Structure](#task-tree-structure)
   - [Reporting Integration](#reporting-integration)

### 10. [See Also](#see-also)

---

## Overview

### Quick Summary

Successfully created comprehensive **Phishing & Social Engineering methodology plugin** for CRACK Track, extracting knowledge from 8 HackTricks markdown files covering modern offensive phishing techniques.

**Generated**: 2025-10-07
**Source**: HackTricks phishing methodology content
**Generated by**: CrackPot v1.0 (HackTricks Mining Agent)

### Key Features

- âœ… **5 major phishing campaign phases** (Recon â†’ Infrastructure â†’ Payloads â†’ Delivery â†’ Advanced)
- âœ… **4 campaign types** (Full, Email, Web, Mobile)
- âœ… **50+ task nodes** with complete OSCP metadata
- âœ… **20+ tools** covered (theHarvester, dnstwist, GoPhish, SET, wget, certbot, evilginx2)
- âœ… **100% test pass rate** (30 comprehensive tests)

### Deliverables

#### 1. Plugin File
**Location**: `/home/kali/OSCP/crack/track/services/phishing.py`
**Size**: ~30 KB
**Lines of Code**: ~1,100+

**Key Features**:
- 5 major phishing campaign phases (Recon â†’ Infrastructure â†’ Payloads â†’ Delivery â†’ Advanced)
- 4 campaign types (Full, Email, Web, Mobile)
- 50+ task nodes with complete OSCP metadata
- Tools covered: theHarvester, dnstwist, GoPhish, SET, wget, certbot, evilginx2

#### 2. Test Suite
**Location**: `/home/kali/OSCP/crack/tests/track/test_phishing_plugin.py`
**Size**: ~590 lines
**Coverage**: 30 comprehensive tests

**Test Results**:
```
============================== 30 passed in 0.07s ==============================
```

âœ… **100% Pass Rate**

---

## Plugin Architecture

### Campaign Phases Detailed

#### Phase 1: Reconnaissance
- **Login portal identification** (manual OSINT)
- **Email address discovery** (theHarvester, hunter.io, phonebook.cz)
- **SMTP email verification** (smtp-user-enum with VRFY/RCPT TO)

#### Phase 2: Infrastructure Setup
- **Domain generation**:
  - dnstwist for typosquatting/homograph variants
  - Expired domain research (expireddomains.net)
- **DNS & Email configuration**:
  - Reverse DNS (PTR records)
  - SPF records (spfwizard.net)
  - DMARC records (_dmarc subdomain)
  - DKIM setup (opendkim with 2048-bit keys)
  - Email testing (mail-tester.com, port25 verification)
- **GoPhish setup**:
  - Installation (/opt/gophish)
  - Let's Encrypt TLS certificates (certbot)
  - Admin panel configuration (port 3333 tunneling)

#### Phase 3: Payload Creation
- **Landing pages**:
  - Website cloning (wget --mirror, goclone, SET)
  - GoPhish landing page configuration
  - Credential capture forms
- **Phishing documents**:
  - Macro-enabled documents (DOCM with VBA AutoOpen/Document_Open)
  - HTA files (HTML Applications via mshta.exe)
  - LNK + ZIP embedded loaders (fileless chains, AMSI bypass)
- **Email templates**:
  - Subject line crafting (urgency without spam keywords)
  - Personalization ({{.FirstName}}, {{.LastName}})
  - Legitimate signature harvesting
  - Tracking pixel integration ({{.Tracker}})

#### Phase 4: Campaign Delivery
- **GoPhish campaign configuration**:
  - Sending profiles (SMTP, sender addresses)
  - Group/target list import (CSV format)
  - Campaign launch & scheduling
- **Campaign monitoring**:
  - Metrics tracking (open rate, click rate, submit rate)
  - Blacklist detection (malwareworld.com)
  - Canary token awareness
  - Response actions (pause, document, remediate)

#### Phase 5: Advanced Techniques
- **Homograph/Homoglyph attacks**:
  - Unicode look-alike characters (Greek Î¡, Cyrillic Ð°, Armenian Ö…)
  - Punycode domain registration (xn--...)
  - TLS certificate acquisition (no similarity checks by CAs)
- **Clipboard hijacking (Pastejacking)**:
  - JavaScript clipboard injection (navigator.clipboard.writeText)
  - ClickFix social engineering ("Press Win+R, paste, Enter")
  - Payloads: PowerShell loaders, DLL sideloading chains
  - Detection artifacts: RunMRU registry, Event ID 4688
- **MFA bypass techniques**:
  - Evilginx2 MitM reverse proxy (session token theft)
  - Help desk social engineering (MFA reset attacks)
  - PII-based verification bypass
  - Voice cloning & spoofed caller ID
- **Mobile phishing**:
  - **Android**: APK distribution (SEO, SMS, QR codes), invitation code gates, permission abuse (READ_CONTACTS, READ_SMS, SEND_SMS), data exfiltration (ZIP to /upload.php)
  - **iOS**: Mobile config profiles (.mobileconfig), MDM-like enrollment, entitlement abuse (Contacts, Photos)
- **AI-enhanced phishing**:
  - LLM-generated personalized emails
  - Voice cloning (deepfake CEO)
  - Agentic AI (autonomous domain registration, adaptive campaigns)
  - AI agent mode abuse (ChatGPT hosted browsers, credential theft via "Take over browser")
- **Discord invite hijacking**:
  - Expired invite code re-registration (vanity URLs on Level 3 boosted servers)
  - Phishing via malicious servers (#verify channel, OAuth2 prompts)
  - ClickFix integration (captchaguard.me fake CAPTCHA)

---

## OSCP Educational Metadata

### Comprehensive Coverage

**Flag Explanations**: Every command parameter documented
**Success Indicators**: 2-3 per task (e.g., "250 response code", "Email addresses discovered")
**Failure Indicators**: 2-3 per task (e.g., "Rate limiting", "VRFY disabled")
**Next Steps**: 2-3 follow-up actions per task
**Manual Alternatives**: 2-4 non-tool methods per automated task
**Time Estimates**: Included for planning (5 min â†’ 90+ min range)

### Tag Distribution

**OSCP Relevance**:
- `OSCP:HIGH` - Core techniques (theHarvester, dnstwist, GoPhish, email config)
- `OSCP:MEDIUM` - Supporting techniques (homographs, clipboard hijacking)
- `OSCP:LOW` - Advanced/niche (mobile phishing, AI, Discord)

**Method**:
- `MANUAL` - Manual procedures (domain research, configuration)
- `AUTOMATED` - Tool-based (scanners, generators)
- `NOISY` - High-traffic techniques (SMTP verification)
- `ADVANCED` - Complex multi-stage attacks (evilginx2, mobile)

**Phase**:
- `RECON` - Information gathering
- `ENUM` - Enumeration
- `EXPLOIT` - Active exploitation
- `RESEARCH` - Exploit/CVE lookup

**Special**:
- `QUICK_WIN` - Fast, high-value tasks (<5 minutes)
- `MOBILE` - Mobile-specific techniques
- `EXPLOIT` - Active exploitation

---

## Tools & Technologies

### Primary Tools
- **theHarvester** - Email/domain OSINT (100% free)
- **dnstwist** - Domain variation generation (homographs, typosquatting)
- **GoPhish** - Phishing campaign management (open source)
- **certbot** - Let's Encrypt TLS certificates
- **wget** - Website cloning (--mirror, --page-requisites)

### Supporting Tools
- **smtp-user-enum** - Email verification (VRFY/RCPT TO/EXPN)
- **urlcrazy** - Alternative domain generator
- **goclone** - Website cloning alternative
- **Social Engineer Toolkit (SET)** - Multi-purpose phishing framework
- **evilginx2** - MFA bypass (reverse proxy MitM)
- **CredSniper** - Alternative MFA bypass
- **muraena** - Alternative MFA bypass
- **EvilnoVNC** - VNC-based credential theft

### DNS/Email Services
- **spfwizard.net** - SPF record generator
- **mail-tester.com** - Email configuration scoring
- **verifier.port25.com** - Authentication verification
- **spamhaus.org** - Blacklist removal requests
- **sender.office.com** - Microsoft blacklist removal

### OSINT/Research
- **hunter.io** - Email discovery
- **phonebook.cz** - Free email lookup
- **expireddomains.net** - Aged domain search
- **fortiguard.com/webfilter** - Domain categorization checker
- **malwareworld.com** - Blacklist checker

---

## Campaign Types

### 1. Full Campaign (Default)
**Use Case**: Complete phishing assessment
**Phases**: All 5 phases
**Target**: Comprehensive red team engagement

**Example**:
```python
service_info = {
    'campaign_type': 'full',
    'target_org': 'Acme Corp'
}
tree = plugin.get_task_tree('acme.com', 443, service_info)
```

### 2. Email Campaign
**Use Case**: Email-focused phishing
**Phases**: Recon, Infrastructure, Email Templates, Delivery
**Target**: Social engineering assessments

### 3. Web Campaign
**Use Case**: Credential harvesting websites
**Phases**: Domain Setup, Landing Pages, Advanced Web Techniques
**Target**: Website cloning/typosquatting tests

### 4. Mobile Campaign
**Use Case**: Mobile app phishing
**Phases**: Mobile Recon, Android/iOS Techniques
**Target**: Mobile security assessments

---

## Advanced Techniques

### Homograph Attacks

**Unicode Scripts Covered**:
- Greek (Î¡ looks like P, Ï looks like p)
- Cyrillic (Ð° looks like a, Ðµ looks like e)
- Armenian (Ö… looks like o)
- Cherokee (áŽ¢ looks like T)

**Implementation**:
- Domain registration with look-alike characters
- TLS certificate acquisition (CAs don't verify similarity)
- Punycode representation (xn--...)
- Bypasses keyword-based email filters

**Example**:
- Paypal â†’ Î¡aypal (Greek Rho, U+03A1)
- Microsoft â†’ MicrÎ¿soft (Armenian o, U+0585)

### Clipboard Hijacking (ClickFix)

**Attack Flow**:
1. Malicious webpage (typosquat, compromised, SEO-poisoned)
2. JavaScript: `navigator.clipboard.writeText("powershell -enc BASE64")`
3. Social engineering: "Press Win+R, paste, Enter to fix error"
4. User executes payload (PowerShell loader â†’ DLL sideloading â†’ RAT)

**Common Payloads**:
- NetSupport RAT (jp2launcher.exe DLL sideloading)
- Latrodectus loader (MSI â†’ libcef.dll â†’ shellcode)
- Lumma Stealer (mshta â†’ PowerShell â†’ AutoIt script)

**Detection**:
- RunMRU registry key (Win+R history)
- Event ID 4688 (explorer.exe â†’ powershell.exe)
- Base64 in process command lines

### MFA Bypass Techniques

#### Help Desk Reset Attack

**Attack Steps**:
1. **Recon**: Gather target PII (LinkedIn, breaches, public records)
2. **Call help desk**: Impersonate target (spoofed caller ID, voice clone)
3. **Verification**: Provide PII to pass checks
4. **Request MFA reset**: "Lost phone while traveling"
5. **Enroll attacker device**: Register own MFA token
6. **Post-access (<60 min)**: Enumerate AD, lateral movement, privilege escalation

**Evasion**:
- No malware dropped
- Legitimate credential usage
- Living-off-the-land techniques (WMI, PSExec, built-in tools)

**Defense**:
- Step-up authentication for identity recovery
- Manager approval required
- Call-back to registered number
- UEBA alerts: MFA changed + new device + same user

### Mobile Phishing

#### Android APK

**Delivery**:
- SEO-poisoned landing pages (fake app stores)
- SMS phishing links
- QR codes
- Dating apps / romance scams

**Evasion**:
1. **Invitation code gate**: POST to C2, validate {"success":true}
2. **No malicious behavior** until validation
3. **Sandbox bypass**: AV dynamic analysis sees nothing
4. **Post-validation**: Request dangerous permissions
5. **Exfiltration**: ZIP data to /upload.php

**Permissions**:
```xml
<uses-permission android:name="android.permission.READ_CONTACTS"/>
<uses-permission android:name="android.permission.READ_SMS"/>
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.SEND_SMS"/>
```

**Data Stolen**:
- IMEI/IMSI, phone number
- Full contacts (JSON)
- Photos from /sdcard/DCIM (Luban compression)
- SMS content (content://sms)

---

## Usage Examples

### Example 1: Full Phishing Campaign

```python
from crack.track.services.phishing import PhishingPlugin

plugin = PhishingPlugin()

# Full campaign for Acme Corp
service_info = {
    'campaign_type': 'full',
    'target_org': 'Acme Corp'
}

tree = plugin.get_task_tree('acme.com', 443, service_info)

# Generates 50+ tasks across 5 phases:
# - Reconnaissance (login portals, email discovery)
# - Infrastructure (domain, DNS, GoPhish)
# - Payloads (landing pages, macros, templates)
# - Delivery (campaign execution, monitoring)
# - Advanced (homographs, clipboard, MFA, mobile, AI)
```

### Example 2: Email-Only Campaign

```python
service_info = {
    'campaign_type': 'email',
    'target_org': 'Example Inc'
}

tree = plugin.get_task_tree('example.com', 443, service_info)

# Focused task tree:
# - Recon + Infrastructure + Email templates + Delivery
# - Excludes web cloning and advanced techniques
```

### Example 3: Web Credential Harvesting

```python
service_info = {
    'campaign_type': 'web',
    'target_org': 'Target LLC'
}

tree = plugin.get_task_tree('target.com', 443, service_info)

# Web-focused tasks:
# - Domain acquisition (dnstwist, expired domains)
# - Landing page cloning (wget, goclone)
# - Advanced web techniques (homographs, clipboard)
```

---

## Integration with CRACK Track

### Manual Activation

Phishing plugin is **not auto-detected** - must be manually activated for phishing assessments:

```bash
# Create target profile
crack track new phishing-target.com

# Manually trigger phishing methodology
# (TODO: Implement manual plugin trigger in CLI)
```

### Task Tree Structure

Generated tasks integrate seamlessly with CRACK Track:
- Hierarchical parent/child relationships
- Status tracking (pending, in-progress, completed, skipped)
- Rich metadata for educational value
- Recommendation engine compatible

### Reporting Integration

Tasks include source tracking for OSCP writeups:
```python
profile.add_finding(
    finding_type="credential_capture",
    description="Phishing campaign captured 5 credentials",
    source="GoPhish campaign 'Password Reset' - email template with landing page cloning"
)
```

---

## Testing & Validation

### Test Suite

**Location**: `/home/kali/OSCP/crack/tests/track/test_phishing_plugin.py`
**Tests**: 30 comprehensive tests
**Pass Rate**: 100%

### Test Categories

**Detection & Structure** (5 tests):
- Plugin registration & naming
- Manual trigger (not auto-detected)
- Full campaign tree structure
- Phase completeness

**Phase Validation** (7 tests):
- Reconnaissance completeness
- Infrastructure setup (domain, DNS, email, GoPhish)
- Payload creation (landing pages, documents, templates)
- Delivery mechanisms
- Advanced techniques coverage

**OSCP Compliance** (3 tests):
- Required metadata present
- Educational content quality
- Tag distribution

**Campaign Types** (3 tests):
- Full campaign
- Email-focused
- Web-focused
- Mobile-focused

**Command Structure** (7 tests):
- theHarvester command & flags
- dnstwist command & homographs
- SPF/DKIM/DMARC coverage
- GoPhish setup
- Macro document guidance
- Clipboard hijacking details
- Homograph Unicode examples

**Technique Coverage** (5 tests):
- MFA bypass (evilginx2, help desk)
- Mobile phishing (Android APK, iOS profiles)
- AI-enhanced phishing
- Discord hijacking
- Campaign monitoring metrics

---

## Comparison with Existing Plugins

| Feature | HTTP Plugin | SMB Plugin | Post-Exploit | Phishing Plugin |
|---------|-------------|------------|--------------|-----------------|
| **Type** | Service Detection | Service Detection | Methodology | Methodology |
| **Trigger** | Auto (port 80/443) | Auto (port 445) | Manual | Manual |
| **Phases** | 1 (enumeration) | 1 (enumeration) | 2 (Linux/Windows) | 5 (campaign workflow) |
| **Task Count** | ~10 tasks | ~12 tasks | ~15 tasks | 50+ tasks |
| **Campaign Types** | N/A | N/A | N/A | 4 types |
| **OSCP Focus** | High | High | High | Medium (niche) |
| **Advanced Techniques** | No | No | No | Yes (6 categories) |

---

## See Also

**Related Mining Reports:**
- [OSINT & WiFi Plugin Summary](./osint_wifi_plugin_readme.md) - External recon techniques
- [Network Attack Plugins Summary](./network_attack_plugins_readme.md) - LLMNR/NTLM relay attacks
- [C2 Analysis Plugin Summary](./c2_analysis_plugin_readme.md) - Post-exploitation C2 detection

**Related Plugins:**
- [`../external_recon.py`](../external_recon.py) - OSINT and external reconnaissance
- [`../post_exploit.py`](../post_exploit.py) - Post-exploitation tasks

**Documentation:**
- [CRACK Track Usage Guide](/home/kali/OSCP/crack/track/docs/USAGE_GUIDE.md)
- [Plugin Development Guide](/home/kali/OSCP/crack/track/docs/PLUGIN_DEVELOPMENT.md)

---

**Generated by:** CrackPot v1.0 - HackTricks Mining Agent
**Mission Complete:** Phishing Methodology â†’ CRACK Track Service Plugin
