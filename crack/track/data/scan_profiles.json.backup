{
  "version": "1.0",
  "description": "Scan profiles for CRACK Track - defines scan strategies (stealth, aggressive, quick, etc.)",
  "profiles": [
    {
      "id": "lab-quick",
      "name": "Quick Scan (Top 1000 Ports)",
      "base_command": "nmap --top-ports 1000",
      "timing": "normal",
      "coverage": "quick",
      "use_case": "OSCP labs, CTF - fast initial discovery",
      "estimated_time": "1-2 minutes",
      "detection_risk": "medium",
      "tags": ["QUICK_WIN", "OSCP:HIGH", "LAB"],
      "phases": ["discovery"],
      "flag_explanations": {
        "--top-ports 1000": "Scan 1000 most common ports (finds 90%+ of services quickly)"
      },
      "success_indicators": [
        "Port scan completes in under 2 minutes",
        "Most common services discovered"
      ],
      "next_steps": [
        "If critical ports missing, run full scan",
        "Proceed to service version detection on discovered ports"
      ]
    },
    {
      "id": "lab-full",
      "name": "Full Port Scan (All 65535)",
      "base_command": "nmap -p-",
      "timing": "aggressive",
      "coverage": "full",
      "use_case": "OSCP labs - comprehensive port discovery (CRITICAL: never skip in OSCP)",
      "estimated_time": "5-10 minutes",
      "detection_risk": "medium",
      "tags": ["OSCP:HIGH", "LAB", "THOROUGH"],
      "phases": ["discovery"],
      "options": {
        "min_rate": 1000
      },
      "flag_explanations": {
        "-p-": "Scan all 65535 TCP ports (thorough, finds unusual high ports)",
        "--min-rate 1000": "Send at least 1000 packets/second (speeds up scan in labs)"
      },
      "success_indicators": [
        "All 65535 ports scanned",
        "Unusual high ports discovered (e.g., 8080, 9090, custom ports)"
      ],
      "failure_indicators": [
        "Scan takes >15 minutes (network issue or firewall)",
        "Too many ports filtered (firewall present)"
      ],
      "next_steps": [
        "Run service version scan on discovered ports",
        "Import results: crack track import <target> lab_full_scan.xml"
      ],
      "notes": "OSCP CRITICAL: Always run full port scan. Boxes often hide services on unusual ports."
    },
    {
      "id": "stealth-slow",
      "name": "Stealth Scan (Paranoid - T0)",
      "base_command": "nmap -sS -T0 -p-",
      "timing": "paranoid",
      "coverage": "full",
      "use_case": "Production systems with IDS/IPS - maximum stealth",
      "estimated_time": "30-60 minutes",
      "detection_risk": "very-low",
      "tags": ["STEALTH", "PRODUCTION", "SLOW"],
      "phases": ["discovery"],
      "flag_explanations": {
        "-sS": "SYN stealth scan (half-open, less likely to be logged)",
        "-T0": "Paranoid timing (extremely slow, 5 min between probes)",
        "-p-": "All ports (comprehensive)"
      },
      "success_indicators": [
        "Scan completes without triggering IDS alerts",
        "All ports discovered stealthily"
      ],
      "alternatives": [
        "Use -T1 (sneaky) for slightly faster scan",
        "Fragment packets with -f for additional evasion"
      ],
      "notes": "WARNING: Extremely slow. Only use when stealth is absolutely critical."
    },
    {
      "id": "stealth-normal",
      "name": "Stealth Scan (Polite - T2)",
      "base_command": "nmap -sS -T2 -p-",
      "timing": "polite",
      "coverage": "full",
      "use_case": "Production systems - moderate stealth, reasonable speed",
      "estimated_time": "15-20 minutes",
      "detection_risk": "low",
      "tags": ["STEALTH", "PRODUCTION"],
      "phases": ["discovery"],
      "flag_explanations": {
        "-sS": "SYN stealth scan (half-open connections)",
        "-T2": "Polite timing (slower but less likely to overwhelm target)",
        "-p-": "All 65535 ports"
      },
      "success_indicators": [
        "Scan completes without errors",
        "Minimal network noise"
      ],
      "notes": "Good balance between stealth and speed for production environments."
    },
    {
      "id": "aggressive-full",
      "name": "Aggressive Full Scan (T4)",
      "base_command": "nmap -sV -sC -A -T4 -p-",
      "timing": "aggressive",
      "coverage": "full",
      "use_case": "Labs, time-critical pentests - maximum information, maximum speed",
      "estimated_time": "10-15 minutes",
      "detection_risk": "high",
      "tags": ["AGGRESSIVE", "NOISY", "LAB"],
      "phases": ["discovery", "service-detection"],
      "flag_explanations": {
        "-sV": "Service version detection",
        "-sC": "Run default NSE scripts (finds low-hanging fruit)",
        "-A": "Aggressive mode (OS detection, traceroute, scripts)",
        "-T4": "Aggressive timing (fast, but may miss some ports on slow networks)",
        "-p-": "All ports"
      },
      "success_indicators": [
        "Service versions detected",
        "OS fingerprint obtained",
        "NSE scripts reveal vulnerabilities"
      ],
      "failure_indicators": [
        "Firewall blocks aggressive probes",
        "IDS triggers alerts"
      ],
      "notes": "NOISY: Will trigger IDS/IPS. Only use in labs or with explicit permission."
    },
    {
      "id": "udp-common",
      "name": "UDP Scan (Common Ports)",
      "base_command": "nmap -sU --top-ports 100",
      "timing": "normal",
      "coverage": "quick",
      "use_case": "Discover common UDP services (DNS, SNMP, TFTP)",
      "estimated_time": "5-10 minutes",
      "detection_risk": "medium",
      "tags": ["UDP", "OSCP:MEDIUM"],
      "phases": ["discovery"],
      "flag_explanations": {
        "-sU": "UDP scan (slower than TCP, but finds critical services)",
        "--top-ports 100": "Scan 100 most common UDP ports"
      },
      "success_indicators": [
        "UDP services discovered (DNS:53, SNMP:161, TFTP:69)",
        "SNMP community strings found"
      ],
      "alternatives": [
        "Full UDP scan: nmap -sU -p- <target> (very slow, 20-30 min)",
        "Targeted UDP: nmap -sU -p 53,69,161,500 <target>"
      ],
      "notes": "UDP scans are slow. Focus on common ports first."
    },
    {
      "id": "service-detect-default",
      "name": "Service Version Detection",
      "base_command": "nmap -sV -sC",
      "timing": "normal",
      "use_case": "Detect service versions and run safe scripts on known ports",
      "estimated_time": "2-5 minutes",
      "detection_risk": "medium",
      "tags": ["OSCP:HIGH", "SERVICE_DETECTION"],
      "phases": ["service-detection"],
      "flag_explanations": {
        "-sV": "Service version detection (probes ports to identify exact service/version)",
        "-sC": "Default NSE scripts (safe, finds common misconfigurations)"
      },
      "success_indicators": [
        "Service versions identified (e.g., Apache 2.4.41, OpenSSH 7.9)",
        "NSE scripts reveal info (e.g., SSL certs, HTTP titles)"
      ],
      "next_steps": [
        "Research versions: searchsploit Apache 2.4.41",
        "Run service-specific enumeration (HTTP, SMB, SSH plugins)"
      ],
      "notes": "Always run after port discovery to match versions to CVEs."
    },
    {
      "id": "http-enum-full",
      "name": "HTTP Enumeration (Full)",
      "base_command": "nmap --script http-enum,http-methods,http-headers",
      "timing": "normal",
      "coverage": "targeted",
      "use_case": "Comprehensive HTTP enumeration - directories, methods, headers",
      "estimated_time": "3-5 minutes",
      "detection_risk": "medium",
      "tags": ["OSCP:HIGH", "HTTP", "ENUM"],
      "phases": ["service-specific"],
      "flag_explanations": {
        "--script http-enum": "Directory/file brute-force with NSE fingerprint database",
        "--script http-methods": "Enumerate supported HTTP methods (OPTIONS, TRACE, PUT, DELETE)",
        "--script http-headers": "Analyze HTTP response headers for security info"
      },
      "success_indicators": [
        "Interesting directories discovered (/admin, /upload, /backup)",
        "Risky HTTP methods found (TRACE, PUT, DELETE)",
        "Security headers analyzed (X-Frame-Options, CSP, etc.)"
      ],
      "failure_indicators": [
        "All requests return 404 (wrong target or WAF blocking)",
        "Connection timeout (firewall blocking NSE scripts)"
      ],
      "next_steps": [
        "Manually browse discovered directories",
        "Test risky HTTP methods (PUT for file upload, TRACE for XST)",
        "Review security headers for misconfigurations"
      ],
      "alternatives": [
        "Manual: curl -v http://target/ (view headers)",
        "Manual: curl -X OPTIONS http://target/ (test methods)",
        "gobuster dir -u http://target/ -w wordlist.txt",
        "nikto -h http://target/"
      ],
      "notes": "NSE http-enum uses /nselib/data/http-fingerprints.lua database. Can be extended with custom fingerprints."
      },
    {
      "id": "http-vuln-scan",
      "name": "HTTP Vulnerability Scan",
      "base_command": "nmap --script http-vuln-*,http-sql-injection,http-waf-detect",
      "timing": "normal",
      "coverage": "targeted",
      "use_case": "Automated vulnerability detection (XSS, SQLi, WAF, known CVEs)",
      "estimated_time": "10-15 minutes",
      "detection_risk": "high",
      "tags": ["OSCP:MEDIUM", "HTTP", "VULN_SCAN", "NOISY"],
      "phases": ["exploitation"],
      "flag_explanations": {
        "--script http-vuln-*": "Run all HTTP vulnerability detection scripts (CVE checks, misconfigurations)",
        "--script http-sql-injection": "Crawl and test for SQL injection vulnerabilities",
        "--script http-waf-detect": "Detect Web Application Firewall presence"
      },
      "success_indicators": [
        "Vulnerabilities detected (CVEs, SQLi, XSS)",
        "WAF detected (adjust testing strategy)",
        "Exploitable misconfigurations found"
      ],
      "failure_indicators": [
        "WAF blocking all payloads (403 responses)",
        "Scan too slow (httpspider.maxpagecount too high)",
        "No vulnerabilities found (well-secured or false negatives)"
      ],
      "next_steps": [
        "If WAF detected: use evasion techniques or manual testing",
        "Manually verify detected vulnerabilities (false positive check)",
        "Research CVEs: searchsploit <detected-version>"
      ],
      "alternatives": [
        "Manual SQLi testing: sqlmap -u 'http://target/page.php?id=1'",
        "Manual XSS testing: Insert payloads in all inputs",
        "nikto -h http://target/ -Tuning x (exploit checks only)"
      ],
      "notes": "NOISY: Generates significant attack traffic. Only use with permission. May trigger IDS/IPS alerts."
    },
    {
      "id": "http-auth-brute",
      "name": "HTTP Authentication Brute-force",
      "base_command": "nmap --script http-brute,http-default-accounts",
      "timing": "normal",
      "coverage": "targeted",
      "use_case": "Test HTTP Basic Auth and default credentials on web apps",
      "estimated_time": "5-30 minutes (depends on wordlist size)",
      "detection_risk": "high",
      "tags": ["OSCP:MEDIUM", "BRUTE_FORCE", "HTTP", "NOISY"],
      "phases": ["exploitation"],
      "flag_explanations": {
        "--script http-brute": "Dictionary attack against HTTP Basic Authentication",
        "--script http-default-accounts": "Test default credentials (Tomcat, Cacti, routers)"
      },
      "success_indicators": [
        "Valid credentials found (user:pass)",
        "Default credentials working (admin:admin, tomcat:tomcat)",
        "Access to protected resources gained"
      ],
      "failure_indicators": [
        "Account lockout triggered",
        "Rate limiting active (slow responses)",
        "All attempts fail (strong passwords or no default creds)"
      ],
      "script_args": {
        "http-brute.path": "Target URI path (default: /)",
        "userdb": "Custom username wordlist",
        "passdb": "Custom password wordlist",
        "brute.firstOnly": "Stop after first valid account",
        "unpwdb.timelimit": "Timeout (default based on -T timing)"
      },
      "next_steps": [
        "Use found credentials to access protected areas",
        "Enumerate application functionality with authenticated access",
        "Test for privilege escalation"
      ],
      "alternatives": [
        "Manual: Use browser with credentials",
        "hydra -L users.txt -P passwords.txt http-get://target/admin/",
        "medusa -h target -U users.txt -P passwords.txt -M http",
        "Manual: Try common combos (admin:admin, root:toor)"
      ],
      "notes": "OSCP: Brute-forcing often triggers lockouts. Try manual default creds first. Use small wordlists in exams."
    },
    {
      "id": "http-cms-scan",
      "name": "CMS Detection and Scanning",
      "base_command": "nmap --script http-wordpress-enum,http-joomla-brute",
      "timing": "normal",
      "coverage": "targeted",
      "use_case": "Detect and enumerate WordPress/Joomla installations",
      "estimated_time": "5-10 minutes",
      "detection_risk": "medium",
      "tags": ["OSCP:HIGH", "HTTP", "CMS", "ENUM"],
      "phases": ["service-specific"],
      "flag_explanations": {
        "--script http-wordpress-enum": "Enumerate WordPress users, plugins, themes",
        "--script http-joomla-brute": "Brute-force Joomla admin panel"
      },
      "success_indicators": [
        "CMS detected (WordPress, Joomla)",
        "Version identified (research CVEs)",
        "Usernames enumerated (use for brute-force)",
        "Vulnerable plugins/themes found"
      ],
      "failure_indicators": [
        "No CMS detected (wrong target)",
        "Enumeration blocked (hardened installation)",
        "Non-standard paths (CMS in subdirectory)"
      ],
      "next_steps": [
        "WordPress: wpscan --url http://target/ --enumerate u,vp",
        "Research plugin versions for known exploits",
        "Brute-force with enumerated usernames",
        "Check for CVEs in CMS version"
      ],
      "alternatives": [
        "Manual WordPress detection: curl http://target/wp-login.php",
        "Manual Joomla detection: curl http://target/administrator/",
        "wpscan --url http://target/ --enumerate ap,u",
        "joomscan -u http://target/"
      ],
      "notes": "CMS enumeration often reveals usernames (author pages, posts). Use for targeted brute-force attacks."
    },
    {
      "id": "http-ssl-scan",
      "name": "HTTPS/SSL Enumeration",
      "base_command": "nmap --script ssl-cert,ssl-enum-ciphers,http-security-headers",
      "timing": "normal",
      "coverage": "targeted",
      "use_case": "Analyze SSL/TLS configuration and security headers on HTTPS",
      "estimated_time": "2-3 minutes",
      "detection_risk": "low",
      "tags": ["OSCP:MEDIUM", "HTTPS", "SSL", "RECON"],
      "phases": ["service-detection"],
      "flag_explanations": {
        "--script ssl-cert": "Extract SSL certificate details (CN, SANs, expiry)",
        "--script ssl-enum-ciphers": "Enumerate supported ciphers and protocols",
        "--script http-security-headers": "Analyze HTTP security headers"
      },
      "success_indicators": [
        "Certificate details extracted (domains, organization)",
        "Weak ciphers identified (SSLv3, RC4, etc.)",
        "Virtual hosts discovered (Subject Alternative Names)",
        "Missing security headers found"
      ],
      "failure_indicators": [
        "SSL handshake fails (incompatible client)",
        "Certificate expired or self-signed (expected for OSCP labs)"
      ],
      "next_steps": [
        "Add discovered domains/SANs to /etc/hosts",
        "Test virtual hosts for different applications",
        "Check for SSL/TLS vulnerabilities (Heartbleed, POODLE)",
        "Review missing security headers"
      ],
      "alternatives": [
        "Manual: openssl s_client -connect target:443",
        "Manual: curl -I https://target/ (view headers)",
        "testssl.sh target:443",
        "sslscan target:443"
      ],
      "notes": "Certificate SANs often reveal additional hostnames/IPs. Virtual host enumeration is critical for OSCP."
    }
  ],
  "meta": {
    "oscp_recommended": ["lab-quick", "lab-full", "service-detect-default", "http-enum-full", "http-cms-scan"],
    "production_recommended": ["stealth-normal", "stealth-slow"],
    "extensible": true,
    "agent_minable": true,
    "notes": "CrackPot agent can mine Nmap cookbook and add new profiles here",
    "output_format_best_practices": {
      "oscp_exam": {
        "recommended": "-oA",
        "explanation": "Chapter 8: Use -oA to save all formats (normal, XML, greppable) simultaneously",
        "example": "nmap -p- -oA full_scan 192.168.45.100",
        "benefits": [
          "XML for CRACK Track import and automated parsing",
          "Normal format for human-readable review during exam",
          "Greppable for quick command-line filtering",
          "Complete documentation for exam report submission"
        ],
        "files_generated": [
          "scan_name.nmap (normal format - easy to read)",
          "scan_name.xml (XML format - for imports and tools)",
          "scan_name.gnmap (greppable - for grep/awk/sed)"
        ]
      },
      "additional_flags": {
        "--reason": {
          "purpose": "Include why port is marked open/closed (syn-ack, echo-reply, etc.)",
          "oscp_value": "Helps understand firewall behavior and troubleshoot scan issues",
          "example": "nmap -p- --reason -oA scan 192.168.45.100"
        },
        "--log-errors": {
          "purpose": "Include debugging/warning info in normal and greppable output",
          "oscp_value": "Critical for troubleshooting failed scans during exam",
          "example": "nmap -A --log-errors -oA scan 192.168.45.100"
        },
        "-v or -vv": {
          "purpose": "Increase verbosity (shows ports as discovered, not just at end)",
          "oscp_value": "Real-time progress monitoring (confirms scan is working)",
          "example": "nmap -p- -vv -oA scan 192.168.45.100"
        },
        "--traceroute": {
          "purpose": "Perform traceroute to target (network topology mapping)",
          "oscp_value": "Identifies network hops and potential pivot points",
          "example": "nmap --traceroute -oA scan 192.168.45.100"
        }
      },
      "anti_patterns": {
        "xml_only": "Don't use -oX alone - you lose human-readable format for quick review",
        "no_output": "NEVER skip output flags in exam - lose all documentation",
        "append_mode": "Avoid --append-output with XML (breaks tree structure)"
      },
      "crack_track_integration": {
        "import_command": "crack track import <target> scan_name.xml",
        "auto_extracts": [
          "Nmap command used (for report documentation)",
          "Scan duration and statistics (for time tracking)",
          "OS detection with accuracy scores",
          "NSE script structured output",
          "CPE identifiers (for CVE matching)",
          "Port state reasons (troubleshooting)"
        ]
      }
    }
  }
}
