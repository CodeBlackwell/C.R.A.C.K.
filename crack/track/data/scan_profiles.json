{
  "version": "1.0",
  "description": "Scan profiles for CRACK Track - defines scan strategies (stealth, aggressive, quick, etc.)",
  "profiles": [
    {
      "id": "lab-quick",
      "name": "Quick Scan (Top 1000 Ports)",
      "base_command": "nmap --top-ports 1000",
      "timing": "normal",
      "coverage": "quick",
      "use_case": "OSCP labs, CTF - fast initial discovery",
      "estimated_time": "1-2 minutes",
      "detection_risk": "medium",
      "tags": [
        "QUICK_WIN",
        "OSCP:HIGH",
        "LAB"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "--top-ports 1000": "Scan 1000 most common ports (finds 90%+ of services quickly)"
      },
      "success_indicators": [
        "Port scan completes in under 2 minutes",
        "Most common services discovered"
      ],
      "next_steps": [
        "If critical ports missing, run full scan",
        "Proceed to service version detection on discovered ports"
      ]
    },
    {
      "id": "lab-full",
      "name": "Full Port Scan (All 65535)",
      "base_command": "nmap -p-",
      "timing": "aggressive",
      "coverage": "full",
      "use_case": "OSCP labs - comprehensive port discovery (CRITICAL: never skip in OSCP)",
      "estimated_time": "5-10 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "LAB",
        "THOROUGH"
      ],
      "phases": [
        "discovery"
      ],
      "options": {
        "min_rate": 1000
      },
      "flag_explanations": {
        "-p-": "Scan all 65535 TCP ports (thorough, finds unusual high ports)",
        "--min-rate 1000": "Send at least 1000 packets/second (speeds up scan in labs)"
      },
      "success_indicators": [
        "All 65535 ports scanned",
        "Unusual high ports discovered (e.g., 8080, 9090, custom ports)"
      ],
      "failure_indicators": [
        "Scan takes >15 minutes (network issue or firewall)",
        "Too many ports filtered (firewall present)"
      ],
      "next_steps": [
        "Run service version scan on discovered ports",
        "Import results: crack track import <target> lab_full_scan.xml"
      ],
      "notes": "OSCP CRITICAL: Always run full port scan. Boxes often hide services on unusual ports."
    },
    {
      "id": "stealth-slow",
      "name": "Stealth Scan (Paranoid - T0)",
      "base_command": "nmap -sS -T0 -p-",
      "timing": "paranoid",
      "coverage": "full",
      "use_case": "Production systems with IDS/IPS - maximum stealth",
      "estimated_time": "30-60 minutes",
      "detection_risk": "very-low",
      "tags": [
        "STEALTH",
        "PRODUCTION",
        "SLOW"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-sS": "SYN stealth scan (half-open, less likely to be logged)",
        "-T0": "Paranoid timing (extremely slow, 5 min between probes)",
        "-p-": "All ports (comprehensive)"
      },
      "success_indicators": [
        "Scan completes without triggering IDS alerts",
        "All ports discovered stealthily"
      ],
      "alternatives": [
        "Use -T1 (sneaky) for slightly faster scan",
        "Fragment packets with -f for additional evasion"
      ],
      "notes": "WARNING: Extremely slow. Only use when stealth is absolutely critical."
    },
    {
      "id": "stealth-normal",
      "name": "Stealth Scan (Polite - T2)",
      "base_command": "nmap -sS -T2 -p-",
      "timing": "polite",
      "coverage": "full",
      "use_case": "Production systems - moderate stealth, reasonable speed",
      "estimated_time": "15-20 minutes",
      "detection_risk": "low",
      "tags": [
        "STEALTH",
        "PRODUCTION"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-sS": "SYN stealth scan (half-open connections)",
        "-T2": "Polite timing (slower but less likely to overwhelm target)",
        "-p-": "All 65535 ports"
      },
      "success_indicators": [
        "Scan completes without errors",
        "Minimal network noise"
      ],
      "notes": "Good balance between stealth and speed for production environments."
    },
    {
      "id": "aggressive-full",
      "name": "Aggressive Full Scan (T4)",
      "base_command": "nmap -sV -sC -A -T4 -p-",
      "timing": "aggressive",
      "coverage": "full",
      "use_case": "Labs, time-critical pentests - maximum information, maximum speed",
      "estimated_time": "10-15 minutes",
      "detection_risk": "high",
      "tags": [
        "AGGRESSIVE",
        "NOISY",
        "LAB"
      ],
      "phases": [
        "discovery",
        "service-detection"
      ],
      "flag_explanations": {
        "-sV": "Service version detection",
        "-sC": "Run default NSE scripts (finds low-hanging fruit)",
        "-A": "Aggressive mode (OS detection, traceroute, scripts)",
        "-T4": "Aggressive timing (fast, but may miss some ports on slow networks)",
        "-p-": "All ports"
      },
      "success_indicators": [
        "Service versions detected",
        "OS fingerprint obtained",
        "NSE scripts reveal vulnerabilities"
      ],
      "failure_indicators": [
        "Firewall blocks aggressive probes",
        "IDS triggers alerts"
      ],
      "notes": "NOISY: Will trigger IDS/IPS. Only use in labs or with explicit permission."
    },
    {
      "id": "udp-common",
      "name": "UDP Scan (Common Ports)",
      "base_command": "nmap -sU --top-ports 100",
      "timing": "normal",
      "coverage": "quick",
      "use_case": "Discover common UDP services (DNS, SNMP, TFTP)",
      "estimated_time": "5-10 minutes",
      "detection_risk": "medium",
      "tags": [
        "UDP",
        "OSCP:MEDIUM"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-sU": "UDP scan (slower than TCP, but finds critical services)",
        "--top-ports 100": "Scan 100 most common UDP ports"
      },
      "success_indicators": [
        "UDP services discovered (DNS:53, SNMP:161, TFTP:69)",
        "SNMP community strings found"
      ],
      "alternatives": [
        "Full UDP scan: nmap -sU -p- <target> (very slow, 20-30 min)",
        "Targeted UDP: nmap -sU -p 53,69,161,500 <target>"
      ],
      "notes": "UDP scans are slow. Focus on common ports first."
    },
    {
      "id": "service-detect-default",
      "name": "Service Version Detection",
      "base_command": "nmap -sV -sC",
      "timing": "normal",
      "use_case": "Detect service versions and run safe scripts on known ports",
      "estimated_time": "2-5 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "SERVICE_DETECTION"
      ],
      "phases": [
        "service-detection"
      ],
      "flag_explanations": {
        "-sV": "Service version detection (probes ports to identify exact service/version)",
        "-sC": "Default NSE scripts (safe, finds common misconfigurations)"
      },
      "success_indicators": [
        "Service versions identified (e.g., Apache 2.4.41, OpenSSH 7.9)",
        "NSE scripts reveal info (e.g., SSL certs, HTTP titles)"
      ],
      "next_steps": [
        "Research versions: searchsploit Apache 2.4.41",
        "Run service-specific enumeration (HTTP, SMB, SSH plugins)"
      ],
      "notes": "Always run after port discovery to match versions to CVEs."
    },
    {
      "id": "http-enum-full",
      "name": "HTTP Enumeration (Full)",
      "base_command": "nmap --script http-enum,http-methods,http-headers",
      "timing": "normal",
      "coverage": "targeted",
      "use_case": "Comprehensive HTTP enumeration - directories, methods, headers",
      "estimated_time": "3-5 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "HTTP",
        "ENUM"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "--script http-enum": "Directory/file brute-force with NSE fingerprint database",
        "--script http-methods": "Enumerate supported HTTP methods (OPTIONS, TRACE, PUT, DELETE)",
        "--script http-headers": "Analyze HTTP response headers for security info"
      },
      "success_indicators": [
        "Interesting directories discovered (/admin, /upload, /backup)",
        "Risky HTTP methods found (TRACE, PUT, DELETE)",
        "Security headers analyzed (X-Frame-Options, CSP, etc.)"
      ],
      "failure_indicators": [
        "All requests return 404 (wrong target or WAF blocking)",
        "Connection timeout (firewall blocking NSE scripts)"
      ],
      "next_steps": [
        "Manually browse discovered directories",
        "Test risky HTTP methods (PUT for file upload, TRACE for XST)",
        "Review security headers for misconfigurations"
      ],
      "alternatives": [
        "Manual: curl -v http://target/ (view headers)",
        "Manual: curl -X OPTIONS http://target/ (test methods)",
        "gobuster dir -u http://target/ -w wordlist.txt",
        "nikto -h http://target/"
      ],
      "notes": "NSE http-enum uses /nselib/data/http-fingerprints.lua database. Can be extended with custom fingerprints."
    },
    {
      "id": "http-vuln-scan",
      "name": "HTTP Vulnerability Scan",
      "base_command": "nmap --script http-vuln-*,http-sql-injection,http-waf-detect",
      "timing": "normal",
      "coverage": "targeted",
      "use_case": "Automated vulnerability detection (XSS, SQLi, WAF, known CVEs)",
      "estimated_time": "10-15 minutes",
      "detection_risk": "high",
      "tags": [
        "OSCP:MEDIUM",
        "HTTP",
        "VULN_SCAN",
        "NOISY"
      ],
      "phases": [
        "exploitation"
      ],
      "flag_explanations": {
        "--script http-vuln-*": "Run all HTTP vulnerability detection scripts (CVE checks, misconfigurations)",
        "--script http-sql-injection": "Crawl and test for SQL injection vulnerabilities",
        "--script http-waf-detect": "Detect Web Application Firewall presence"
      },
      "success_indicators": [
        "Vulnerabilities detected (CVEs, SQLi, XSS)",
        "WAF detected (adjust testing strategy)",
        "Exploitable misconfigurations found"
      ],
      "failure_indicators": [
        "WAF blocking all payloads (403 responses)",
        "Scan too slow (httpspider.maxpagecount too high)",
        "No vulnerabilities found (well-secured or false negatives)"
      ],
      "next_steps": [
        "If WAF detected: use evasion techniques or manual testing",
        "Manually verify detected vulnerabilities (false positive check)",
        "Research CVEs: searchsploit <detected-version>"
      ],
      "alternatives": [
        "Manual SQLi testing: sqlmap -u 'http://target/page.php?id=1'",
        "Manual XSS testing: Insert payloads in all inputs",
        "nikto -h http://target/ -Tuning x (exploit checks only)"
      ],
      "notes": "NOISY: Generates significant attack traffic. Only use with permission. May trigger IDS/IPS alerts."
    },
    {
      "id": "http-auth-brute",
      "name": "HTTP Authentication Brute-force",
      "base_command": "nmap --script http-brute,http-default-accounts",
      "timing": "normal",
      "coverage": "targeted",
      "use_case": "Test HTTP Basic Auth and default credentials on web apps",
      "estimated_time": "5-30 minutes (depends on wordlist size)",
      "detection_risk": "high",
      "tags": [
        "OSCP:MEDIUM",
        "BRUTE_FORCE",
        "HTTP",
        "NOISY"
      ],
      "phases": [
        "exploitation"
      ],
      "flag_explanations": {
        "--script http-brute": "Dictionary attack against HTTP Basic Authentication",
        "--script http-default-accounts": "Test default credentials (Tomcat, Cacti, routers)"
      },
      "success_indicators": [
        "Valid credentials found (user:pass)",
        "Default credentials working (admin:admin, tomcat:tomcat)",
        "Access to protected resources gained"
      ],
      "failure_indicators": [
        "Account lockout triggered",
        "Rate limiting active (slow responses)",
        "All attempts fail (strong passwords or no default creds)"
      ],
      "script_args": {
        "http-brute.path": "Target URI path (default: /)",
        "userdb": "Custom username wordlist",
        "passdb": "Custom password wordlist",
        "brute.firstOnly": "Stop after first valid account",
        "unpwdb.timelimit": "Timeout (default based on -T timing)"
      },
      "next_steps": [
        "Use found credentials to access protected areas",
        "Enumerate application functionality with authenticated access",
        "Test for privilege escalation"
      ],
      "alternatives": [
        "Manual: Use browser with credentials",
        "hydra -L users.txt -P passwords.txt http-get://target/admin/",
        "medusa -h target -U users.txt -P passwords.txt -M http",
        "Manual: Try common combos (admin:admin, root:toor)"
      ],
      "notes": "OSCP: Brute-forcing often triggers lockouts. Try manual default creds first. Use small wordlists in exams."
    },
    {
      "id": "http-cms-scan",
      "name": "CMS Detection and Scanning",
      "base_command": "nmap --script http-wordpress-enum,http-joomla-brute",
      "timing": "normal",
      "coverage": "targeted",
      "use_case": "Detect and enumerate WordPress/Joomla installations",
      "estimated_time": "5-10 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "HTTP",
        "CMS",
        "ENUM"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "--script http-wordpress-enum": "Enumerate WordPress users, plugins, themes",
        "--script http-joomla-brute": "Brute-force Joomla admin panel"
      },
      "success_indicators": [
        "CMS detected (WordPress, Joomla)",
        "Version identified (research CVEs)",
        "Usernames enumerated (use for brute-force)",
        "Vulnerable plugins/themes found"
      ],
      "failure_indicators": [
        "No CMS detected (wrong target)",
        "Enumeration blocked (hardened installation)",
        "Non-standard paths (CMS in subdirectory)"
      ],
      "next_steps": [
        "WordPress: wpscan --url http://target/ --enumerate u,vp",
        "Research plugin versions for known exploits",
        "Brute-force with enumerated usernames",
        "Check for CVEs in CMS version"
      ],
      "alternatives": [
        "Manual WordPress detection: curl http://target/wp-login.php",
        "Manual Joomla detection: curl http://target/administrator/",
        "wpscan --url http://target/ --enumerate ap,u",
        "joomscan -u http://target/"
      ],
      "notes": "CMS enumeration often reveals usernames (author pages, posts). Use for targeted brute-force attacks."
    },
    {
      "id": "http-ssl-scan",
      "name": "HTTPS/SSL Enumeration",
      "base_command": "nmap --script ssl-cert,ssl-enum-ciphers,http-security-headers",
      "timing": "normal",
      "coverage": "targeted",
      "use_case": "Analyze SSL/TLS configuration and security headers on HTTPS",
      "estimated_time": "2-3 minutes",
      "detection_risk": "low",
      "tags": [
        "OSCP:MEDIUM",
        "HTTPS",
        "SSL",
        "RECON"
      ],
      "phases": [
        "service-detection"
      ],
      "flag_explanations": {
        "--script ssl-cert": "Extract SSL certificate details (CN, SANs, expiry)",
        "--script ssl-enum-ciphers": "Enumerate supported ciphers and protocols",
        "--script http-security-headers": "Analyze HTTP security headers"
      },
      "success_indicators": [
        "Certificate details extracted (domains, organization)",
        "Weak ciphers identified (SSLv3, RC4, etc.)",
        "Virtual hosts discovered (Subject Alternative Names)",
        "Missing security headers found"
      ],
      "failure_indicators": [
        "SSL handshake fails (incompatible client)",
        "Certificate expired or self-signed (expected for OSCP labs)"
      ],
      "next_steps": [
        "Add discovered domains/SANs to /etc/hosts",
        "Test virtual hosts for different applications",
        "Check for SSL/TLS vulnerabilities (Heartbleed, POODLE)",
        "Review missing security headers"
      ],
      "alternatives": [
        "Manual: openssl s_client -connect target:443",
        "Manual: curl -I https://target/ (view headers)",
        "testssl.sh target:443",
        "sslscan target:443"
      ],
      "notes": "Certificate SANs often reveal additional hostnames/IPs. Virtual host enumeration is critical for OSCP."
    },
    {
      "id": "quick-discovery-nodns",
      "name": "Quick Host Discovery (Skip DNS)",
      "base_command": "nmap -n -sn",
      "timing": "normal",
      "coverage": "quick",
      "use_case": "OSCP labs - fast host discovery when DNS is slow or broken (2-5x faster)",
      "estimated_time": "10-30 seconds",
      "detection_risk": "low",
      "tags": [
        "QUICK_WIN",
        "OSCP:HIGH",
        "DISCOVERY"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-n": "Skip DNS resolution (faster, avoids DNS delays that add 10-30 seconds)",
        "-sn": "Ping scan only (find live hosts, no port scan)"
      },
      "success_indicators": [
        "List of live hosts returned quickly",
        "No DNS lookup delays",
        "Scan completes in under 30 seconds for /24 network"
      ],
      "failure_indicators": [
        "All hosts shown as down (firewall blocking ICMP/ARP)",
        "Empty results (try -Pn to skip host discovery)"
      ],
      "next_steps": [
        "Run port scan on discovered hosts",
        "Use -n flag on all subsequent scans for speed",
        "Import results: crack track import <target> discovery.xml"
      ],
      "alternatives": [
        "nmap -sn <target> (with DNS, slower)",
        "fping -a -g 192.168.1.0/24 (faster for large ranges)",
        "ping -c 1 <target> (manual single host test)"
      ],
      "notes": "OSCP TIP: Use -n flag on ALL scans in labs to speed up enumeration by 2-5x. DNS lookups are major performance bottleneck."
    },
    {
      "id": "documented-full",
      "name": "Full Scan with Complete Documentation",
      "base_command": "nmap -p- -sV -sC",
      "timing": "normal",
      "coverage": "full",
      "use_case": "OSCP exam - comprehensive scan with all output formats for reporting",
      "estimated_time": "10-20 minutes",
      "detection_risk": "high",
      "tags": [
        "OSCP:HIGH",
        "THOROUGH",
        "DOCUMENTED"
      ],
      "phases": [
        "discovery",
        "service-detection"
      ],
      "flag_explanations": {
        "-p-": "All 65535 ports (comprehensive, never miss hidden services)",
        "-sV": "Service version detection (match to CVEs for exploitation)",
        "-sC": "Default NSE scripts (find common vulnerabilities and misconfigurations)",
        "-oA <basename>": "Output ALL formats (.nmap, .xml, .gnmap) with basename prefix"
      },
      "success_indicators": [
        "Three output files created: <basename>.nmap, <basename>.xml, <basename>.gnmap",
        "All ports scanned with service versions identified",
        "NSE scripts completed successfully"
      ],
      "failure_indicators": [
        "Scan incomplete (network timeout, try --min-rate 1000)",
        "Output files not created (permission denied, check directory)",
        "Service detection failed (try --version-intensity 9)"
      ],
      "next_steps": [
        "Import XML to CRACK Track: crack track import <target> <basename>.xml",
        "Review .nmap file for human-readable results in terminal",
        "Parse .gnmap file for scripting (grep-friendly format)",
        "Research discovered service versions: searchsploit <service> <version>"
      ],
      "alternatives": [
        "nmap -oN scan.txt (normal format only, incomplete)",
        "nmap -oX scan.xml (XML only, no human-readable)",
        "nmap -oG scan.gnmap (greppable only, hard to read)"
      ],
      "notes": "OSCP CRITICAL: Always use -oA flag during exam for complete documentation. Example usage: -oA nmap/initial_scan. This is REQUIRED for exam report submission."
    },
    {
      "id": "syn-stealth-fast",
      "name": "Fast SYN Stealth Scan (Privileged)",
      "base_command": "sudo nmap -sS -T4 --min-rate 1000",
      "timing": "aggressive",
      "coverage": "fast",
      "use_case": "Fast, stealthy scanning with raw packet control (requires root/sudo)",
      "estimated_time": "1-3 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "STEALTH",
        "FAST"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "sudo": "Required for raw packet creation (SYN stealth needs root)",
        "-sS": "SYN stealth scan (half-open, doesn't complete TCP handshake - harder to detect and log)",
        "-T4": "Aggressive timing (fast scan, assumes reliable fast network)",
        "--min-rate 1000": "Send at least 1000 packets/second (guarantees minimum scan speed)"
      },
      "success_indicators": [
        "Fast scan completion (under 3 minutes for full port range)",
        "Port states detected via SYN/ACK responses",
        "Low log footprint (connections not fully established)"
      ],
      "failure_indicators": [
        "Permission denied (need root/sudo access)",
        "Firewall blocking SYN packets (try different scan type)",
        "Too fast - missing ports (reduce --min-rate or use -T3)"
      ],
      "next_steps": [
        "Run service version scan on discovered ports: -sV -sC",
        "Check if connections logged (SYN scans harder to detect)",
        "Combine with -p- for full port coverage"
      ],
      "alternatives": [
        "nmap -sT (TCP connect scan, no root needed but slower and fully logged)",
        "nmap -sS -T2 (slower SYN scan but more reliable on congested networks)",
        "nc -zv <target> <port> (manual TCP connect, no root)"
      ],
      "notes": "OSCP: SYN scan (-sS) is DEFAULT for root users. Always use 'sudo nmap' for best performance. Non-root users automatically get TCP connect scan (-sT) which is slower."
    },
    {
      "id": "version-intensity-max",
      "name": "Maximum Service Version Detection",
      "base_command": "nmap -sV --version-intensity 9",
      "timing": "slow",
      "coverage": "deep",
      "use_case": "Maximum version detection accuracy (use when standard -sV fails to identify service)",
      "estimated_time": "5-15 minutes",
      "detection_risk": "high",
      "tags": [
        "OSCP:MEDIUM",
        "THOROUGH",
        "NOISY"
      ],
      "phases": [
        "service-detection"
      ],
      "flag_explanations": {
        "-sV": "Service version detection",
        "--version-intensity 9": "Maximum probe intensity (0-9 scale, default 7). Level 9 sends ALL probes from nmap-service-probes database"
      },
      "success_indicators": [
        "Accurate service versions detected where -sV failed",
        "Previously unknown services identified with version strings",
        "Detailed banner information returned"
      ],
      "failure_indicators": [
        "Very slow scan (10-15 minutes per port)",
        "High network traffic volume (may trigger IDS/IPS alerts)",
        "Still no version match (service truly unknown to Nmap database)"
      ],
      "next_steps": [
        "Research version for CVEs: searchsploit <service> <version>",
        "Submit unknown fingerprint to Nmap project for database inclusion",
        "Try manual banner grabbing: nc <target> <port>",
        "Check service-specific tools (e.g., smbclient for SMB)"
      ],
      "alternatives": [
        "nmap -sV (default intensity 7, faster but less thorough)",
        "nmap -sV --version-light (intensity 2, fastest but least accurate)",
        "nc -nv <target> <port> (manual banner grab)",
        "telnet <target> <port> (interactive banner grab)"
      ],
      "notes": "OSCP: Use when standard -sV fails to identify critical services. Level 9 sends 100+ probes per port. Very slow but comprehensive. Only use on specific ports, not full range."
    },
    {
      "id": "interface-specific-vpn",
      "name": "VPN Interface Scan (tun0)",
      "base_command": "nmap -e tun0",
      "timing": "normal",
      "coverage": "standard",
      "use_case": "OSCP VPN scanning - force traffic through VPN interface (critical for exam)",
      "estimated_time": "Depends on scan type",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "VPN",
        "TROUBLESHOOTING"
      ],
      "phases": [
        "discovery",
        "service-detection"
      ],
      "flag_explanations": {
        "-e tun0": "Specify network interface (tun0 = VPN tunnel, eth0 = local network). Forces Nmap to use specific interface for all packets"
      },
      "success_indicators": [
        "Scan completes without routing errors",
        "Traffic confirmed going through correct interface",
        "Target reachable via VPN tunnel"
      ],
      "failure_indicators": [
        "WARNING: Unable to find appropriate interface",
        "Network unreachable errors (VPN not connected)",
        "Packets routing through wrong interface"
      ],
      "next_steps": [
        "Verify VPN interface exists: ip addr show tun0",
        "Check routing table: ip route get <target>",
        "Combine with port scan: nmap -e tun0 -p- -T4 --min-rate 1000 <target>",
        "Test connectivity: ping -I tun0 <target>"
      ],
      "alternatives": [
        "ip route add <target> dev tun0 (force routing via route table)",
        "Check default route: ip route show (ensure tun0 is default)",
        "Manual interface selection: --source-port flag for additional control"
      ],
      "notes": "OSCP CRITICAL: In exam, ALWAYS verify you're using tun0 (VPN) not eth0 (local network). Check with 'ip addr show' before scanning. Wrong interface = scanning wrong network = zero points."
    }
  ],
  "os_fingerprinting_profiles": [
    {
      "id": "os-detect-standard",
      "name": "OS Detection (Standard)",
      "base_command": "nmap -O",
      "timing": "normal",
      "coverage": "metadata",
      "use_case": "Identify operating system for exploit selection (OSCP CRITICAL)",
      "estimated_time": "+2-3 minutes (add to service scan)",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "FINGERPRINTING",
        "QUICK_WIN"
      ],
      "phases": [
        "service-detection"
      ],
      "flag_explanations": {
        "-O": "OS detection via TCP/IP fingerprinting (analyzes TCP window, TTL, options)"
      },
      "success_indicators": [
        "OS family identified (Linux, Windows, BSD, etc.)",
        "CPE identifier shown",
        "Device type classified (general purpose, router, printer, etc.)"
      ],
      "failure_indicators": [
        "No exact OS matches (requires open AND closed ports)",
        "Test conditions non-ideal",
        "Firewall blocking fingerprinting probes"
      ],
      "next_steps": [
        "Research OS version: searchsploit <OS> <version>",
        "Select OS-appropriate payloads (Windows .exe, Linux ELF)",
        "Identify default paths (C:\\ vs /var/www/)"
      ],
      "alternatives": [
        "Manual TTL check: ping -c1 <TARGET> (64=Linux, 128=Windows)",
        "Banner grabbing: nc <TARGET> 22 (SSH version reveals OS)",
        "HTTP headers: curl -I http://<TARGET> (Server header)"
      ],
      "notes": "OSCP CRITICAL: Always attempt OS detection. Requires at least one open AND one closed port for accurate results. Use --osscan-guess if standard detection fails."
    },
    {
      "id": "os-detect-aggressive",
      "name": "OS Detection (Aggressive Guess)",
      "base_command": "nmap -O --osscan-guess",
      "timing": "normal",
      "coverage": "metadata",
      "use_case": "Fallback when standard OS detection fails",
      "estimated_time": "+2-3 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:MEDIUM",
        "FINGERPRINTING",
        "FALLBACK"
      ],
      "phases": [
        "service-detection"
      ],
      "flag_explanations": {
        "-O": "Enable OS detection",
        "--osscan-guess": "Make aggressive guesses when no exact match (less accurate)"
      },
      "success_indicators": [
        "OS family guessed with percentage confidence",
        "Multiple OS possibilities listed"
      ],
      "alternatives": [
        "Manual TTL check: ping -c1 <TARGET> (quickest OS hint)",
        "Try standard -O first (only use --osscan-guess as fallback)",
        "Combine with service banners for cross-validation"
      ],
      "notes": "Use when standard -O returns 'No exact OS matches'. Less reliable but better than no OS info."
    },
    {
      "id": "fingerprint-banner-grab",
      "name": "Banner Grabbing (Manual)",
      "base_command": "nc -v",
      "timing": "normal",
      "coverage": "metadata",
      "use_case": "Manual service fingerprinting when automated tools fail",
      "estimated_time": "1-2 minutes per port",
      "detection_risk": "low",
      "tags": [
        "OSCP:HIGH",
        "MANUAL",
        "FINGERPRINTING",
        "QUICK_WIN"
      ],
      "phases": [
        "service-detection"
      ],
      "flag_explanations": {
        "-v": "Verbose output (shows connection details)",
        "<TARGET>": "Target IP address",
        "<PORT>": "Port to grab banner from"
      },
      "success_indicators": [
        "Service banner displayed",
        "Version information revealed",
        "OS information leaked"
      ],
      "failure_indicators": [
        "Connection refused (port closed)",
        "Connection timeout (filtered)",
        "No banner sent (service doesn't advertise)"
      ],
      "next_steps": [
        "HTTP: curl -I http://<TARGET> (header grab)",
        "SSH: nc <TARGET> 22 (SSH version in banner)",
        "SMTP: nc <TARGET> 25, type HELO test",
        "FTP: ftp <TARGET> (banner on connect)"
      ],
      "alternatives": [
        "telnet <TARGET> <PORT>",
        "nmap -sV --version-intensity 9 <TARGET>",
        "amap <TARGET> <PORT>",
        "For HTTP: curl -v http://<TARGET>/"
      ],
      "notes": "OSCP EXAM: Manual banner grabbing is faster than version scans and works when nmap fails. Always try manual first for critical ports (22, 80, 21, 25)."
    },
    {
      "id": "firewall-detect-ack",
      "name": "Firewall Detection (TCP ACK Scan)",
      "base_command": "nmap -sA",
      "timing": "normal",
      "coverage": "firewall",
      "use_case": "Identify stateful firewalls before exploitation",
      "estimated_time": "2-5 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "FIREWALL_DETECTION",
        "RECON"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-sA": "TCP ACK scan (sends ACK packets without prior SYN - detects stateful firewalls)"
      },
      "success_indicators": [
        "All ports 'unfiltered' = no stateful firewall",
        "Mix of filtered/unfiltered = firewall with specific rules",
        "All ports 'filtered' = stateful firewall blocking all ACK packets"
      ],
      "failure_indicators": [
        "ICMP destination unreachable (firewall rejecting probes)"
      ],
      "next_steps": [
        "If firewall detected: Focus on allowed ports (80, 443 often whitelisted)",
        "If no firewall: Proceed with aggressive enumeration",
        "Try application-layer evasion (HTTP tunneling)"
      ],
      "alternatives": [
        "Manual ACK probe: hping3 -A -p80 -c1 <TARGET>",
        "Full connection: nc -v <TARGET> 80 (bypasses stateless rules)"
      ],
      "notes": "ACK scan does NOT determine open/closed ports - only filtered/unfiltered. Stateful firewalls track TCP connections and block ACK without prior SYN."
    },
    {
      "id": "udp-critical-oscp",
      "name": "UDP Critical Services (OSCP Focus)",
      "base_command": "nmap -sU -p 53,69,123,161,162,500",
      "timing": "normal",
      "coverage": "udp-targeted",
      "use_case": "Target critical UDP services for OSCP (SNMP, TFTP, DNS, NTP)",
      "estimated_time": "3-5 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "UDP",
        "QUICK_WIN"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-sU": "UDP scan (slow but finds critical services)",
        "-p 53,69,123,161,162,500": "DNS, TFTP, NTP, SNMP, SNMP-trap, IPSec"
      },
      "success_indicators": [
        "SNMP (161/162) open = community string enumeration possible",
        "TFTP (69) open = potential file download/upload",
        "DNS (53) open = zone transfer attempts"
      ],
      "failure_indicators": [
        "All ports open|filtered (no ICMP responses = firewall)",
        "Scan very slow (>10 min = increase --min-rate carefully)"
      ],
      "next_steps": [
        "SNMP: snmpwalk -v2c -c public <TARGET>",
        "SNMP: onesixtyone -c /usr/share/doc/onesixtyone/dict.txt <TARGET>",
        "TFTP: tftp <TARGET>, try 'get' for common files (config.cfg)",
        "DNS: dig axfr @<TARGET> <domain> (zone transfer)"
      ],
      "alternatives": [
        "Manual SNMP: snmpwalk -v2c -c public <TARGET>",
        "Manual TFTP: tftp <TARGET>, then 'get <file>'",
        "Manual DNS: dig @<TARGET> <domain> ANY"
      ],
      "notes": "OSCP CRITICAL: NEVER skip UDP scanning. SNMP often reveals credentials, system info. UDP scanning is slow - focus on critical ports only."
    }
  ],
  "meta": {
    "oscp_recommended": [
      "quick-discovery-nodns",
      "lab-quick",
      "lab-full",
      "dns-no-resolve",
      "evasion-skip-ping",
      "host-discovery-syn",
      "host-discovery-arp",
      "documented-full",
      "syn-stealth-fast",
      "service-detect-default",
      "version-intensity-max",
      "interface-specific-vpn",
      "os-detect-standard",
      "firewall-detect-ack",
      "udp-critical-oscp",
      "http-enum-full",
      "http-cms-scan",
      "mysql-enum-full",
      "mssql-enum-full",
      "oracle-sid-brute",
      "mongodb-enum",
      "smtp-enum-full",
      "imap-enum-full",
      "pop3-enum-full",
      "mail-all-enum"
    ],
    "production_recommended": [
      "stealth-normal",
      "stealth-slow"
    ],
    "os_fingerprinting_recommended": [
      "os-detect-standard",
      "os-detect-aggressive",
      "fingerprint-banner-grab",
      "firewall-detect-ack",
      "udp-critical-oscp"
    ],
    "mail_recommended": [
      "smtp-enum-full",
      "imap-enum-full",
      "pop3-enum-full",
      "mail-all-enum"
    ],
    "extensible": true,
    "agent_minable": true,
    "notes": "CrackPot agent can mine Nmap cookbook and add new profiles here. Chapter 7 performance profiles added.. Chapter 2 network exploration and firewall evasion profiles added.",
    "output_format_best_practices": {
      "oscp_exam": {
        "recommended": "-oA",
        "explanation": "Chapter 8: Use -oA to save all formats (normal, XML, greppable) simultaneously",
        "example": "nmap -p- -oA full_scan 192.168.45.100",
        "benefits": [
          "XML for CRACK Track import and automated parsing",
          "Normal format for human-readable review during exam",
          "Greppable for quick command-line filtering",
          "Complete documentation for exam report submission"
        ],
        "files_generated": [
          "scan_name.nmap (normal format - easy to read)",
          "scan_name.xml (XML format - for imports and tools)",
          "scan_name.gnmap (greppable - for grep/awk/sed)"
        ]
      },
      "additional_flags": {
        "--reason": {
          "purpose": "Include why port is marked open/closed (syn-ack, echo-reply, etc.)",
          "oscp_value": "Helps understand firewall behavior and troubleshoot scan issues",
          "example": "nmap -p- --reason -oA scan 192.168.45.100"
        },
        "--log-errors": {
          "purpose": "Include debugging/warning info in normal and greppable output",
          "oscp_value": "Critical for troubleshooting failed scans during exam",
          "example": "nmap -A --log-errors -oA scan 192.168.45.100"
        },
        "-v or -vv": {
          "purpose": "Increase verbosity (shows ports as discovered, not just at end)",
          "oscp_value": "Real-time progress monitoring (confirms scan is working)",
          "example": "nmap -p- -vv -oA scan 192.168.45.100"
        },
        "--traceroute": {
          "purpose": "Perform traceroute to target (network topology mapping)",
          "oscp_value": "Identifies network hops and potential pivot points",
          "example": "nmap --traceroute -oA scan 192.168.45.100"
        }
      },
      "anti_patterns": {
        "xml_only": "Don't use -oX alone - you lose human-readable format for quick review",
        "no_output": "NEVER skip output flags in exam - lose all documentation",
        "append_mode": "Avoid --append-output with XML (breaks tree structure)"
      },
      "crack_track_integration": {
        "import_command": "crack track import <target> scan_name.xml",
        "auto_extracts": [
          "Nmap command used (for report documentation)",
          "Scan duration and statistics (for time tracking)",
          "OS detection with accuracy scores",
          "NSE script structured output",
          "CPE identifiers (for CVE matching)",
          "Port state reasons (troubleshooting)"
        ]
      }
    },
    "database_recommended": [
      "mysql-enum-full",
      "mssql-enum-full",
      "oracle-sid-brute",
      "oracle-brute",
      "mongodb-enum",
      "couchdb-enum"
    ],
    "lab_recommended": [
      "lab-speed-optimized",
      "lab-retry-optimized",
      "lab-discovery-only",
      "lab-service-detect-targeted"
    ],
    "exam_recommended": [
      "lab-rate-limited",
      "lab-discovery-only",
      "lab-service-detect-targeted"
    ],
    "host_discovery_recommended": [
      "host-discovery-arp",
      "host-discovery-syn",
      "host-discovery-icmp-echo",
      "host-discovery-ack"
    ],
    "firewall_evasion_recommended": [
      "evasion-skip-ping"
    ],
    "dns_control_recommended": [
      "dns-no-resolve"
    ]
  },
  "database_profiles": [
    {
      "id": "mysql-enum-full",
      "name": "MySQL Full Enumeration",
      "base_command": "nmap --script mysql-empty-password,mysql-info,mysql-users,mysql-databases,mysql-dump-hashes,mysql-variables,mysql-audit,mysql-vuln-cve2012-2122 -p3306",
      "timing": "normal",
      "use_case": "Comprehensive MySQL enumeration (auth bypass, users, databases, hashes, insecure config)",
      "estimated_time": "2-5 minutes",
      "detection_risk": "medium",
      "tags": [
        "MYSQL",
        "DATABASE",
        "OSCP:HIGH"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "mysql-empty-password": "Test root and anonymous accounts with blank password",
        "mysql-info": "Get MySQL version and system information",
        "mysql-users": "List MySQL users (requires auth)",
        "mysql-databases": "List databases (requires auth)",
        "mysql-dump-hashes": "Extract password hashes (requires auth)",
        "mysql-variables": "Enumerate MySQL environment variables (requires auth)",
        "mysql-audit": "Check CIS MySQL security benchmarks (requires auth)",
        "mysql-vuln-cve2012-2122": "Test for CVE-2012-2122 auth bypass vulnerability",
        "-p3306": "Standard MySQL port"
      },
      "success_indicators": [
        "Empty password accounts found (critical)",
        "User list retrieved",
        "Password hashes dumped",
        "CVE-2012-2122 vulnerable",
        "Insecure configurations detected (CIS audit)"
      ],
      "failure_indicators": [
        "All scripts require authentication",
        "Access denied errors",
        "Connection refused"
      ],
      "next_steps": [
        "Use found credentials for manual enumeration",
        "Crack dumped hashes: hashcat -m 300 (MySQL5) or -m 21100 (MySQL8)",
        "Exploit CVE-2012-2122 if vulnerable",
        "Fix insecure configurations"
      ],
      "alternatives": [
        "Manual: mysql -h <target> -u root (test blank password)",
        "Metasploit: auxiliary/scanner/mysql/mysql_login + mysql_hashdump",
        "Hydra: hydra -L users.txt -P pass.txt mysql://<target>"
      ],
      "notes": "Run this after discovering MySQL. May need valid credentials for some scripts (--script-args mysqluser=root,mysqlpass=pass). Save with -oA for OSCP report."
    },
    {
      "id": "mssql-enum-full",
      "name": "MS SQL Full Enumeration",
      "base_command": "nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-dump-hashes -p1433",
      "timing": "normal",
      "use_case": "Comprehensive MS SQL enumeration (version, NTLM info, tables, hashes)",
      "estimated_time": "2-5 minutes",
      "detection_risk": "medium",
      "tags": [
        "MSSQL",
        "DATABASE",
        "OSCP:HIGH"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "ms-sql-info": "Get SQL Server version and instance details",
        "ms-sql-empty-password": "Test sa account with blank password",
        "ms-sql-config": "Enumerate server configuration",
        "ms-sql-ntlm-info": "Extract Windows/domain information via NTLM",
        "ms-sql-tables": "List databases and tables (requires auth)",
        "ms-sql-dump-hashes": "Extract password hashes (requires auth)"
      },
      "success_indicators": [
        "Version and instance name retrieved",
        "sa account has blank password",
        "NTLM domain information leaked",
        "Password hashes dumped"
      ],
      "alternatives": [
        "impacket-mssqlclient <target> -port 1433",
        "crackmapexec mssql <target> -u sa -p ''"
      ],
      "notes": "NTLM info reveals domain - valuable for AD attacks. Test xp_cmdshell for RCE."
    },
    {
      "id": "oracle-sid-brute",
      "name": "Oracle SID Enumeration",
      "base_command": "nmap -sV --script oracle-sid-brute -p1521",
      "timing": "normal",
      "use_case": "Enumerate Oracle SID names via TNS listener",
      "estimated_time": "5-10 minutes",
      "detection_risk": "medium",
      "tags": [
        "ORACLE",
        "ENUM",
        "OSCP:HIGH"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "oracle-sid-brute": "Brute-force Oracle SID names",
        "--script-args oraclesids": "Custom SID wordlist path"
      },
      "success_indicators": [
        "SID names discovered (e.g., orcl, XE, prod)"
      ],
      "next_steps": [
        "Use discovered SIDs for oracle-brute",
        "Try default credentials: system:system, scott:tiger"
      ],
      "notes": "RUN THIS FIRST before oracle-brute. Common SIDs: ORCL, XE, TEST"
    },
    {
      "id": "oracle-brute",
      "name": "Oracle Password Brute-Force",
      "base_command": "nmap -sV --script oracle-brute --script-args oracle-brute.sid=ORCL -p1521",
      "timing": "normal",
      "use_case": "Dictionary attack against Oracle database (needs SID from oracle-sid-brute)",
      "estimated_time": "5-30 minutes",
      "detection_risk": "high",
      "tags": [
        "ORACLE",
        "BRUTE_FORCE",
        "NOISY",
        "OSCP:LOW"
      ],
      "phases": [
        "exploitation"
      ],
      "flag_explanations": {
        "oracle-brute": "Brute-force Oracle authentication",
        "oracle-brute.sid": "Oracle SID name (REQUIRED - get from oracle-sid-brute)"
      },
      "success_indicators": [
        "Valid credentials found (system:system, scott:tiger)"
      ],
      "alternatives": [
        "Manual: Try default accounts first"
      ],
      "notes": "CRITICAL: Must know SID. Run oracle-sid-brute first."
    },
    {
      "id": "mongodb-enum",
      "name": "MongoDB Enumeration",
      "base_command": "nmap -p27017 --script mongodb-databases,mongodb-info",
      "timing": "normal",
      "use_case": "Enumerate MongoDB databases (often no auth required)",
      "estimated_time": "1-3 minutes",
      "detection_risk": "low",
      "tags": [
        "MONGODB",
        "NOSQL",
        "OSCP:MEDIUM",
        "QUICK_WIN"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "mongodb-databases": "List all databases in MongoDB",
        "mongodb-info": "Get MongoDB build info and server status"
      },
      "success_indicators": [
        "Database list retrieved",
        "MongoDB version identified"
      ],
      "next_steps": [
        "Connect: mongo <target>:27017",
        "Enumerate: show dbs; use <db>; show collections;"
      ],
      "notes": "MongoDB often runs WITHOUT authentication (misconfiguration). Quick win."
    },
    {
      "id": "couchdb-enum",
      "name": "CouchDB Enumeration",
      "base_command": "nmap -p5984 --script couchdb-databases,couchdb-stats",
      "timing": "normal",
      "use_case": "Enumerate CouchDB databases and statistics (HTTP-based NoSQL)",
      "estimated_time": "1-2 minutes",
      "detection_risk": "low",
      "tags": [
        "COUCHDB",
        "NOSQL",
        "OSCP:LOW",
        "QUICK_WIN"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "couchdb-databases": "List all databases via /_all_dbs API",
        "couchdb-stats": "Retrieve runtime statistics"
      },
      "success_indicators": [
        "Database list retrieved",
        "Statistics show 'admin party' (no auth)"
      ],
      "next_steps": [
        "Check: curl http://<target>:5984/_utils/ (Futon UI)",
        "List: curl http://<target>:5984/_all_dbs"
      ],
      "notes": "'Admin party' = no authentication. Futon web UI often exposed."
    }
  ],
  "mail_profiles": [
    {
      "id": "smtp-enum-full",
      "name": "SMTP Full Enumeration",
      "base_command": "nmap --script smtp-commands,smtp-enum-users,smtp-open-relay,smtp-ntlm-info -p25,465,587",
      "timing": "normal",
      "use_case": "Comprehensive SMTP enumeration (commands, users, relay test, NTLM info)",
      "estimated_time": "2-5 minutes",
      "detection_risk": "medium",
      "tags": [
        "SMTP",
        "MAIL",
        "OSCP:HIGH",
        "ENUM"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "smtp-commands": "Enumerate available SMTP commands (VRFY, EXPN, RCPT TO)",
        "smtp-enum-users": "Enumerate users via VRFY, EXPN, RCPT TO methods",
        "smtp-open-relay": "Test if server is open relay (16 tests)",
        "smtp-ntlm-info": "Extract Windows domain info via NTLM (Exchange servers)",
        "-p25,465,587": "SMTP ports: 25 (plain), 465 (SSL), 587 (submission/STARTTLS)"
      },
      "script_args": {
        "smtp-enum-users.methods": "Set enumeration methods (VRFY, EXPN, RCPT)",
        "smtp-enum-users.domain": "Domain for RCPT TO tests",
        "smtp-open-relay.domain": "Test domain for relay checks",
        "userdb": "Custom username wordlist for enumeration"
      },
      "success_indicators": [
        "SMTP commands enumerated",
        "Valid users discovered (VRFY/RCPT TO)",
        "Open relay detected (security issue)",
        "NTLM info leaked (internal hostname, domain, Windows version)"
      ],
      "failure_indicators": [
        "Authentication required before enumeration",
        "User enumeration disabled (VRFY/EXPN return 252)",
        "All relay tests denied"
      ],
      "next_steps": [
        "If users found: Use for password spray/brute-force",
        "If open relay: Test mail spoofing, document critical vuln",
        "If NTLM info: Use for AD enumeration, exploit research",
        "Check MX records: dig mx <domain>",
        "Test SPF/DKIM/DMARC: dig txt <domain> | grep spf"
      ],
      "alternatives": [
        "Manual: telnet <target> 25, then VRFY root, EXPN root",
        "Manual: nc <target> 25, test MAIL FROM/RCPT TO for enumeration",
        "smtp-user-enum -M VRFY -U users.txt -t <target>",
        "Metasploit: auxiliary/scanner/smtp/smtp_enum"
      ],
      "notes": "Chapter 6: smtp-enum-users requires no auth. Open relay = HIGH severity. NTLM works on Exchange. Save with -oA for OSCP report."
    },
    {
      "id": "smtp-vuln-scan",
      "name": "SMTP Vulnerability Scan",
      "base_command": "nmap --script smtp-vuln-*,smtp-brute -p25,465,587",
      "timing": "normal",
      "use_case": "Detect SMTP vulnerabilities and brute-force authentication",
      "estimated_time": "5-30 minutes (depends on brute-force wordlist)",
      "detection_risk": "high",
      "tags": [
        "SMTP",
        "VULN_SCAN",
        "BRUTE_FORCE",
        "OSCP:MEDIUM",
        "NOISY"
      ],
      "phases": [
        "exploitation"
      ],
      "flag_explanations": {
        "smtp-vuln-*": "Run all SMTP vulnerability detection scripts (CVEs)",
        "smtp-brute": "Dictionary attack against SMTP authentication",
        "--script-args userdb": "Custom username wordlist",
        "--script-args passdb": "Custom password wordlist",
        "--script-args brute.firstOnly": "Stop after first valid account"
      },
      "success_indicators": [
        "Vulnerabilities detected (CVE-2011-1764 Exim DKIM, etc.)",
        "Valid credentials found via brute-force",
        "Authentication bypass discovered"
      ],
      "failure_indicators": [
        "No vulnerabilities found (patched server)",
        "Brute-force triggers account lockout",
        "Rate limiting active"
      ],
      "next_steps": [
        "Research detected CVEs for exploits",
        "Use found credentials for email access",
        "Test credentials on other services (IMAP, POP3, SSH)"
      ],
      "alternatives": [
        "hydra -L users.txt -P passwords.txt smtp://<target>",
        "Manual CVE research: searchsploit <smtp-version>"
      ],
      "notes": "NOISY: Brute-force generates many connections. Try default creds first. smtp-vuln-cve2011-1764 for Exim 4.70-4.75."
    },
    {
      "id": "imap-enum-full",
      "name": "IMAP Full Enumeration",
      "base_command": "nmap --script imap-capabilities,imap-ntlm-info -p143,993",
      "timing": "normal",
      "use_case": "Comprehensive IMAP enumeration (capabilities, NTLM info)",
      "estimated_time": "1-3 minutes",
      "detection_risk": "low",
      "tags": [
        "IMAP",
        "MAIL",
        "OSCP:HIGH",
        "QUICK_WIN"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "imap-capabilities": "Enumerate IMAP capabilities (AUTH methods, commands)",
        "imap-ntlm-info": "Extract Windows domain info via NTLM (Exchange)",
        "-p143,993": "IMAP ports: 143 (plaintext), 993 (SSL/TLS)"
      },
      "success_indicators": [
        "Capabilities retrieved (IMAP4rev1, AUTH=PLAIN, AUTH=NTLM)",
        "NTLM info leaked (hostname, domain, Windows version)",
        "Authentication methods identified"
      ],
      "failure_indicators": [
        "Connection refused",
        "STARTTLS required but failed",
        "NTLM not supported"
      ],
      "next_steps": [
        "If NTLM info: Use for AD enumeration",
        "Test default credentials: admin:admin, root:root",
        "Try credentials from other services (credential reuse)",
        "Brute-force if authorized: nmap --script imap-brute"
      ],
      "alternatives": [
        "Manual: nc <target> 143, then A1 CAPABILITY",
        "Manual NTLM: telnet <target> 143, then A1 AUTHENTICATE NTLM",
        "curl imap://<target>/ --user admin:admin"
      ],
      "notes": "Chapter 6: imap-capabilities shows AUTH methods. NTLM info requires no auth. Test creds found elsewhere on IMAP."
    },
    {
      "id": "imap-brute",
      "name": "IMAP Authentication Brute-Force",
      "base_command": "nmap -p143,993 --script imap-brute",
      "timing": "normal",
      "use_case": "Dictionary attack against IMAP authentication",
      "estimated_time": "5-30 minutes (depends on wordlist)",
      "detection_risk": "high",
      "tags": [
        "IMAP",
        "BRUTE_FORCE",
        "OSCP:MEDIUM",
        "NOISY"
      ],
      "phases": [
        "exploitation"
      ],
      "flag_explanations": {
        "imap-brute": "Brute-force IMAP authentication (LOGIN, PLAIN, CRAM-MD5, DIGEST-MD5, NTLM)",
        "--script-args userdb": "Custom username wordlist",
        "--script-args passdb": "Custom password wordlist",
        "--script-args brute.mode": "user (all passes per user) or pass (all users per pass)"
      },
      "success_indicators": [
        "Valid credentials found (acc1:test, webmaster:webmaster)",
        "Account access granted"
      ],
      "failure_indicators": [
        "All attempts failed",
        "Account lockout triggered",
        "Too slow (large wordlist)"
      ],
      "next_steps": [
        "Access mailboxes with found credentials",
        "Read emails for sensitive data (passwords, VPN configs)",
        "Test credentials on other services",
        "Check Drafts folder (users save credentials there)"
      ],
      "alternatives": [
        "hydra -L users.txt -P passwords.txt imap://<target>",
        "Manual: nc <target> 143, A1 LOGIN user pass",
        "Evolution/Thunderbird GUI for manual testing"
      ],
      "notes": "Chapter 6: OSCP WARNING - Brute-force time-consuming. Try defaults first (admin:admin). Use small wordlists in exam."
    },
    {
      "id": "pop3-enum-full",
      "name": "POP3 Full Enumeration",
      "base_command": "nmap --script pop3-capabilities,pop3-ntlm-info -p110,995",
      "timing": "normal",
      "use_case": "Comprehensive POP3 enumeration (capabilities, NTLM info)",
      "estimated_time": "1-3 minutes",
      "detection_risk": "low",
      "tags": [
        "POP3",
        "MAIL",
        "OSCP:HIGH",
        "QUICK_WIN"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "pop3-capabilities": "Enumerate POP3 capabilities (CAPA command)",
        "pop3-ntlm-info": "Extract Windows domain info via NTLM (Exchange)",
        "-p110,995": "POP3 ports: 110 (plaintext), 995 (SSL/TLS)"
      },
      "success_indicators": [
        "Capabilities retrieved (USER, SASL, PIPELINING, STLS)",
        "NTLM info leaked (hostname, domain, Windows version)",
        "Authentication methods identified"
      ],
      "failure_indicators": [
        "Connection refused",
        "STLS required but failed",
        "NTLM not supported"
      ],
      "next_steps": [
        "If NTLM info: Use for AD enumeration",
        "Test default credentials",
        "Try credentials from other services",
        "Brute-force if authorized: nmap --script pop3-brute"
      ],
      "alternatives": [
        "Manual: nc <target> 110, then CAPA",
        "Manual: telnet <target> 110, USER admin, PASS admin",
        "curl pop3://<target>/ --user admin:admin --list-only"
      ],
      "notes": "Chapter 6: pop3-capabilities shows SASL methods. WARNING: POP3 downloads and may DELETE emails. Use TOP not RETR."
    },
    {
      "id": "pop3-brute",
      "name": "POP3 Authentication Brute-Force",
      "base_command": "nmap -p110,995 --script pop3-brute",
      "timing": "normal",
      "use_case": "Dictionary attack against POP3 authentication",
      "estimated_time": "5-30 minutes (depends on wordlist)",
      "detection_risk": "high",
      "tags": [
        "POP3",
        "BRUTE_FORCE",
        "OSCP:MEDIUM",
        "NOISY"
      ],
      "phases": [
        "exploitation"
      ],
      "flag_explanations": {
        "pop3-brute": "Brute-force POP3 authentication (USER/PASS)",
        "--script-args userdb": "Custom username wordlist",
        "--script-args passdb": "Custom password wordlist",
        "--script-args unpwdb.timelimit": "Timeout (0=unlimited, 60m=60 minutes)"
      },
      "success_indicators": [
        "Valid credentials found (webmaster:abc123, acc1:password)",
        "Email access granted"
      ],
      "failure_indicators": [
        "All attempts failed",
        "Rate limiting active",
        "Account lockout"
      ],
      "next_steps": [
        "Retrieve emails with found credentials",
        "Search for sensitive data (passwords, SSH keys)",
        "Test credentials on other services",
        "Document findings for OSCP report"
      ],
      "alternatives": [
        "hydra -L users.txt -P passwords.txt pop3://<target>",
        "Manual: nc <target> 110, USER admin, PASS password",
        "curl pop3://admin:password@<target>/"
      ],
      "notes": "Chapter 6: OSCP - Try defaults first. POP3 brute-force slower than other protocols. WARNING: Traditional POP3 DELETES after download."
    },
    {
      "id": "mail-all-enum",
      "name": "All Mail Protocols Enumeration",
      "base_command": "nmap --script smtp-commands,smtp-enum-users,smtp-open-relay,imap-capabilities,pop3-capabilities -p25,110,143,465,587,993,995",
      "timing": "normal",
      "use_case": "Enumerate ALL mail protocols in one scan (SMTP, IMAP, POP3)",
      "estimated_time": "3-7 minutes",
      "detection_risk": "medium",
      "tags": [
        "SMTP",
        "IMAP",
        "POP3",
        "MAIL",
        "OSCP:HIGH"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "smtp-commands": "SMTP command enumeration",
        "smtp-enum-users": "SMTP user enumeration (VRFY/EXPN/RCPT)",
        "smtp-open-relay": "SMTP open relay test",
        "imap-capabilities": "IMAP capability enumeration",
        "pop3-capabilities": "POP3 capability enumeration",
        "-p25,110,143,465,587,993,995": "All standard mail ports"
      },
      "success_indicators": [
        "Mail services discovered and enumerated",
        "Users enumerated via SMTP",
        "Open relay detected",
        "Capabilities retrieved for IMAP/POP3"
      ],
      "next_steps": [
        "Brute-force found users",
        "Test credentials across all mail services",
        "Check for NTLM info on Windows servers"
      ],
      "notes": "ONE SCAN to enumerate ALL mail protocols. Efficient for OSCP time management. Follow up with targeted brute-force."
    }
  ],
  "performance_optimized_profiles": [
    {
      "id": "lab-speed-optimized",
      "name": "Lab Speed Optimized (Hostgroup Tuning)",
      "base_command": "nmap -T4 -n -Pn --min-hostgroup 100 --max-hostgroup 500",
      "timing": "aggressive",
      "coverage": "optimized",
      "use_case": "OSCP labs - maximize speed with multiple targets",
      "estimated_time": "2-5 minutes for 100 hosts",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "LAB",
        "PERFORMANCE",
        "MULTI_TARGET"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-T4": "Aggressive timing template (fast scans for reliable networks)",
        "-n": "Skip reverse DNS resolution (saves 20-30% time)",
        "-Pn": "Skip host discovery ping (treat all hosts as up)",
        "--min-hostgroup 100": "Scan at least 100 hosts concurrently (parallel efficiency)",
        "--max-hostgroup 500": "Cap at 500 hosts per group (prevents overwhelming target network)"
      },
      "success_indicators": [
        "Scan completes significantly faster than default",
        "Results grouped efficiently (reports generated per hostgroup)",
        "No packet loss despite speed"
      ],
      "failure_indicators": [
        "Too many dropped packets (reduce max-hostgroup)",
        "Network congestion (decrease parallelism)",
        "Firewall blocking aggressive probes"
      ],
      "next_steps": [
        "If packet loss occurs: reduce --max-hostgroup to 250",
        "If scan still slow: add --max-retries 2",
        "For faster results: combine with --min-rate 1000"
      ],
      "alternatives": [
        "Default grouping: nmap -T4 192.168.1.0/24 (slower but safer)",
        "Manual parallelization: Split target list into chunks"
      ],
      "notes": "OSCP TIP: Use for subnet sweeps (192.168.x.0/24). Grouping optimizes both scan speed and report generation timing."
    },
    {
      "id": "lab-retry-optimized",
      "name": "Retry Optimized (Lab Reliability)",
      "base_command": "nmap -p- --max-retries 2 --min-rate 1000",
      "timing": "aggressive",
      "coverage": "full",
      "use_case": "OSCP labs - balance speed vs thoroughness (when network is stable)",
      "estimated_time": "3-7 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "LAB",
        "RELIABILITY",
        "BALANCED"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-p-": "Scan all 65535 TCP ports (thorough)",
        "--max-retries 2": "Retry only twice before giving up (faster, less accurate on lossy networks)",
        "--min-rate 1000": "Send at least 1000 packets/second (speeds up scan)"
      },
      "success_indicators": [
        "Scan completes in 3-7 minutes",
        "Critical ports discovered",
        "Minimal false negatives"
      ],
      "failure_indicators": [
        "Open ports missed (increase --max-retries to 6)",
        "Scan too aggressive for target (decrease --min-rate)",
        "Firewall drops packets (results show too many 'filtered')"
      ],
      "next_steps": [
        "If ports missed: Re-scan with --max-retries 6",
        "If too slow: Increase --min-rate to 2000 (risky)",
        "If too aggressive: Decrease to --max-retries 4 --min-rate 500"
      ],
      "alternatives": [
        "Conservative: nmap -p- --max-retries 10 (slower, more thorough)",
        "Aggressive: nmap -p- --max-retries 1 --min-rate 2000 (fast, risky)"
      ],
      "notes": "OSCP WARNING: --max-retries 2 trades accuracy for speed. Use only when network is stable. For exam, prefer --max-retries 6 (default)."
    },
    {
      "id": "lab-rate-limited",
      "name": "Rate Limited (Avoid Firewall Blocks)",
      "base_command": "nmap -p- --max-rate 500 --max-retries 6",
      "timing": "polite",
      "coverage": "full",
      "use_case": "OSCP exam - conservative scan when target has firewall/IDS",
      "estimated_time": "10-15 minutes",
      "detection_risk": "low",
      "tags": [
        "OSCP:HIGH",
        "EXAM",
        "STEALTH",
        "RELIABLE"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-p-": "All ports (thorough)",
        "--max-rate 500": "Cap at 500 packets/second (prevents overwhelming target, avoids IDS triggers)",
        "--max-retries 6": "Retry 6 times (compensates for slower rate, ensures accuracy)"
      },
      "success_indicators": [
        "All ports scanned without triggering blocks",
        "No 'filtered' avalanche (would indicate firewall drops)",
        "Accurate results despite slower pace"
      ],
      "failure_indicators": [
        "Scan too slow for exam time (increase --max-rate to 1000)",
        "Still triggering IDS (decrease --max-rate to 250)"
      ],
      "next_steps": [
        "Run service detection: nmap -sV -p <discovered_ports>",
        "If blocked: Further reduce --max-rate to 250"
      ],
      "alternatives": [
        "Extreme stealth: nmap -T1 -p- (very slow, 30+ minutes)",
        "Faster cautious: nmap --max-rate 1000 -p-"
      ],
      "notes": "OSCP EXAM TIP: If firewall suspected, start here. Better to scan slowly once than fast multiple times."
    },
    {
      "id": "lab-parallelism-controlled",
      "name": "Parallelism Controlled (Custom Probe Tuning)",
      "base_command": "nmap -p- --min-parallelism 10 --max-parallelism 250",
      "timing": "custom",
      "coverage": "full",
      "use_case": "Advanced - manually control probe parallelism for unstable networks",
      "estimated_time": "5-10 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:MEDIUM",
        "ADVANCED",
        "CUSTOM"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-p-": "All ports",
        "--min-parallelism 10": "Send at least 10 probes in parallel (maintains scan speed)",
        "--max-parallelism 250": "Cap at 250 parallel probes (prevents network saturation)"
      },
      "success_indicators": [
        "Scan adapts to network conditions",
        "Stable probe rate throughout scan",
        "No overwhelming of target"
      ],
      "failure_indicators": [
        "Scan too slow: increase --min-parallelism to 50",
        "Packet loss: decrease --max-parallelism to 100",
        "Unstable results: let nmap auto-adjust (remove flags)"
      ],
      "next_steps": [
        "Monitor with -v (verbose) to see parallelism adjustments",
        "If unstable: Remove flags and use -T4 (auto-adjust)"
      ],
      "alternatives": [
        "Auto-adjust: nmap -T4 -p- (recommended for most cases)",
        "Single probe: nmap --max-parallelism 1 (extremely slow, max stealth)"
      ],
      "notes": "ADVANCED: Only use if you understand your network conditions. Auto-adjust (-T4) is usually better. Disables dynamic parallelism."
    },
    {
      "id": "lab-rtt-optimized",
      "name": "RTT Optimized (Custom Timeout Tuning)",
      "base_command": "nmap -p- --initial-rtt-timeout 150ms --max-rtt-timeout 600ms --min-rtt-timeout 50ms",
      "timing": "custom",
      "coverage": "full",
      "use_case": "Low-latency networks (local lab) - optimize for fast RTT",
      "estimated_time": "4-8 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:MEDIUM",
        "LAB",
        "LOW_LATENCY",
        "ADVANCED"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-p-": "All ports",
        "--initial-rtt-timeout 150ms": "Start with 150ms timeout (faster than default 1000ms for local networks)",
        "--max-rtt-timeout 600ms": "Max timeout 600ms (prevents waiting too long on slow responses)",
        "--min-rtt-timeout 50ms": "Min timeout 50ms (low-latency networks respond quickly)"
      },
      "success_indicators": [
        "Scan completes faster than default",
        "No missed ports due to short timeouts",
        "RTT values stay within configured range"
      ],
      "failure_indicators": [
        "Ports missed (increase --max-rtt-timeout to 1000ms)",
        "Scan too aggressive (increase --initial-rtt-timeout to 300ms)"
      ],
      "next_steps": [
        "Measure actual RTT first: nping -c30 <TARGET>",
        "Set --initial-rtt-timeout to 2x average RTT",
        "Set --max-rtt-timeout to 4x max RTT"
      ],
      "alternatives": [
        "Auto-adjust: nmap -T4 (let nmap calculate RTT)",
        "High-latency: --initial-rtt-timeout 500ms --max-rtt-timeout 2000ms"
      ],
      "notes": "MEASUREMENT FIRST: Use 'nping -c30 <TARGET>' to measure actual RTT before setting custom values. Incorrect values hurt performance."
    },
    {
      "id": "lab-scan-delay",
      "name": "Scan Delay Controlled (Anti-IDS Timing)",
      "base_command": "nmap -p- --scan-delay 1s --max-scan-delay 10s",
      "timing": "polite",
      "coverage": "full",
      "use_case": "IDS evasion - add artificial delay between probes",
      "estimated_time": "20-30 minutes",
      "detection_risk": "very-low",
      "tags": [
        "OSCP:LOW",
        "STEALTH",
        "IDS_EVASION",
        "SLOW"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-p-": "All ports",
        "--scan-delay 1s": "Wait at least 1 second between probes (evades rate-based IDS)",
        "--max-scan-delay 10s": "Cap max delay at 10 seconds (prevents excessive slowdown)"
      },
      "success_indicators": [
        "Scan completes without IDS alerts",
        "Timing spacing visible in packet capture",
        "No blocked probes"
      ],
      "failure_indicators": [
        "Scan too slow for exam (not practical for OSCP)",
        "Still detected (increase --scan-delay to 3s)"
      ],
      "next_steps": [
        "Usually NOT recommended for OSCP (too slow)",
        "Use only if repeated scans trigger blocks"
      ],
      "alternatives": [
        "Faster stealth: nmap -T2 -p- (polite timing)",
        "Extreme stealth: nmap -T0 --scan-delay 5m (paranoid)"
      ],
      "notes": "OSCP WARNING: Scan delay significantly slows scans. Only use if target actively blocks normal scans. Usually --max-rate limiting is better."
    },
    {
      "id": "lab-discovery-only",
      "name": "Discovery Only (Skip Service Detection)",
      "base_command": "nmap -p- -n -Pn -T4",
      "timing": "aggressive",
      "coverage": "ports-only",
      "use_case": "OSCP labs - fast port discovery, defer service detection",
      "estimated_time": "1-3 minutes",
      "detection_risk": "medium",
      "tags": [
        "QUICK_WIN",
        "OSCP:HIGH",
        "LAB",
        "TWO_PHASE"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-p-": "All ports (but only port state, no service info)",
        "-n": "Skip reverse DNS (saves 20-30% time)",
        "-Pn": "Skip host discovery (no ping, treat as up)",
        "-T4": "Aggressive timing"
      },
      "success_indicators": [
        "Port states discovered in under 3 minutes",
        "Fast first-pass enumeration",
        "No service version overhead"
      ],
      "failure_indicators": [
        "Need service versions (must run second scan)",
        "Scan still slow (add --min-rate 1000)"
      ],
      "next_steps": [
        "Run service detection on discovered ports: nmap -sV -p <ports> <target>",
        "Import into CRACK Track: crack track import <target> discovery.xml",
        "Service plugins will trigger on second scan import"
      ],
      "alternatives": [
        "Combined scan: nmap -sV -p- -T4 (slower, single pass)",
        "Top ports first: nmap --top-ports 1000 -T4"
      ],
      "notes": "TWO-PHASE STRATEGY: 1) Fast discovery (-p- -n -Pn) 2) Targeted service scan (-sV -p <discovered>). Saves time on large labs."
    },
    {
      "id": "lab-service-detect-targeted",
      "name": "Service Detection Only (Targeted)",
      "base_command": "nmap -sV -sC -n",
      "timing": "normal",
      "coverage": "targeted",
      "use_case": "OSCP - second phase after discovery (service versions on known ports)",
      "estimated_time": "2-5 minutes (depends on open ports)",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "SERVICE_DETECTION",
        "TWO_PHASE"
      ],
      "phases": [
        "service-detection"
      ],
      "flag_explanations": {
        "-sV": "Service version detection (fingerprint exact versions)",
        "-sC": "Default NSE scripts (safe, finds common misconfigurations)",
        "-n": "Skip reverse DNS",
        "Ports": "Specify ports from discovery: -p 22,80,445,3306"
      },
      "success_indicators": [
        "Service versions identified (Apache 2.4.41, OpenSSH 7.9, etc.)",
        "NSE scripts provide additional info (HTTP titles, SSL certs)",
        "Fast because only scanning known open ports"
      ],
      "failure_indicators": [
        "Version detection fails (increase intensity: -sV --version-intensity 9)",
        "NSE scripts take too long (skip with -sV only)"
      ],
      "next_steps": [
        "Research versions: searchsploit Apache 2.4.41",
        "Import into CRACK Track: crack track import <target> services.xml",
        "Service plugins auto-generate enumeration tasks"
      ],
      "alternatives": [
        "Combined scan: nmap -sV -sC -p- (slower, single pass)",
        "Aggressive: nmap -A -p <ports> (adds OS detection, traceroute)"
      ],
      "notes": "TWO-PHASE STRATEGY PHASE 2: Use with ports discovered in phase 1. Much faster than scanning all ports with -sV."
    }
  ],
  "host_discovery_profiles": [
    {
      "id": "host-discovery-syn",
      "name": "Host Discovery - TCP SYN Ping",
      "base_command": "nmap -sn -PS",
      "timing": "normal",
      "coverage": "quick",
      "use_case": "OSCP: Discover hosts behind firewalls that block ICMP but allow TCP (common in DMZ)",
      "estimated_time": "30 seconds - 2 minutes (network dependent)",
      "detection_risk": "low",
      "tags": [
        "OSCP:HIGH",
        "QUICK_WIN",
        "STEALTH",
        "HOST_DISCOVERY"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-sn": "Ping scan only (no port scan) - discovers online hosts fast",
        "-PS": "TCP SYN ping - sends SYN packet to port 80 (default), waits for SYN/ACK or RST response"
      },
      "success_indicators": [
        "Hosts marked as 'up' in output",
        "Works when ICMP echo requests fail",
        "Discovers hosts behind stateless firewalls"
      ],
      "failure_indicators": [
        "All hosts shown as 'down' - firewall may drop RST packets (try specifying open ports: -PS22,80,443)",
        "No response - try TCP ACK ping instead (-PA)"
      ],
      "next_steps": [
        "Run full port scan on discovered hosts: nmap -p- <discovered_hosts>",
        "Combine with service detection: nmap -sV -sC <discovered_hosts>",
        "For exam: Document which hosts responded to track network topology"
      ],
      "alternatives": [
        "TCP ACK ping: nmap -sn -PA <target> (bypasses SYN filters)",
        "UDP ping: nmap -sn -PU <target> (for strict TCP filtering)",
        "Manual: for i in {1..254}; do ping -c1 -W1 192.168.1.$i & done"
      ],
      "notes": "OSCP TIP: Always try TCP SYN ping when ICMP fails. Many exam boxes filter ICMP but allow TCP to common ports. Use -PS80,443,22,21 for higher success rate."
    },
    {
      "id": "host-discovery-ack",
      "name": "Host Discovery - TCP ACK Ping",
      "base_command": "nmap -sn -PA",
      "timing": "normal",
      "coverage": "quick",
      "use_case": "OSCP: Discover hosts when SYN pings fail (bypasses stateless SYN filters)",
      "estimated_time": "30 seconds - 2 minutes",
      "detection_risk": "low",
      "tags": [
        "OSCP:MEDIUM",
        "STEALTH",
        "HOST_DISCOVERY",
        "EVASION"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-sn": "Ping scan mode (no port enumeration)",
        "-PA": "TCP ACK ping - sends ACK packet to port 80, expects RST response from online hosts"
      },
      "success_indicators": [
        "Hosts respond with RST packets (indicates host is up)",
        "Bypasses SYN packet filters",
        "Works where -PS fails"
      ],
      "failure_indicators": [
        "Blocked by stateful firewalls (most modern firewalls track connection state and drop unsolicited ACKs)",
        "If both -PS and -PA fail, try UDP ping (-PU)"
      ],
      "next_steps": [
        "If ACK ping works but SYN fails, firewall is likely stateless (older equipment)",
        "Combine techniques: nmap -sn -PS -PA <target> (tries both methods)",
        "Document firewall behavior for reporting"
      ],
      "alternatives": [
        "TCP SYN ping: nmap -sn -PS <target>",
        "ICMP timestamp: nmap -sn -PP <target>",
        "IP protocol ping: nmap -sn -PO <target>"
      ],
      "notes": "OSCP WARNING: TCP ACK ping requires root/admin privileges. Without privileges, nmap falls back to TCP SYN ping automatically. Modern firewalls with stateful inspection will block this technique."
    },
    {
      "id": "host-discovery-arp",
      "name": "Host Discovery - ARP Ping (Local Network)",
      "base_command": "nmap -sn -PR",
      "timing": "fast",
      "coverage": "full",
      "use_case": "OSCP: Most reliable host discovery on local networks (Layer 2) - cannot be blocked by firewalls",
      "estimated_time": "5-15 seconds (very fast)",
      "detection_risk": "low",
      "tags": [
        "OSCP:HIGH",
        "QUICK_WIN",
        "LOCAL",
        "HOST_DISCOVERY",
        "RELIABLE"
      ],
      "phases": [
        "discovery"
      ],
      "flag_explanations": {
        "-sn": "Ping scan mode",
        "-PR": "ARP ping - sends ARP requests (Layer 2), waits for ARP replies revealing MAC addresses"
      },
      "success_indicators": [
        "MAC addresses displayed for discovered hosts",
        "100% reliable on same subnet",
        "Bypasses all IP-layer firewalls",
        "Vendor identification from MAC OUI"
      ],
      "failure_indicators": [
        "Only works on local network (same Layer 2 segment)",
        "Cannot discover hosts across routers",
        "Requires local network access"
      ],
      "next_steps": [
        "Identify devices by MAC vendor (Intel = workstation, Huawei = router, VMware = virtual machine)",
        "Use --send-ip to force IP-layer ping instead of ARP (testing purposes)",
        "Proceed with targeted port scanning on discovered hosts"
      ],
      "alternatives": [
        "Manual ARP scan: arp-scan -l",
        "Netdiscover: netdiscover -i eth0 -r 192.168.1.0/24",
        "Manual: for i in {1..254}; do arping -c1 -I eth0 192.168.1.$i; done"
      ],
      "notes": "OSCP GOLD: ARP ping is THE most reliable host discovery method for local networks. Nmap automatically uses ARP for LAN scans even when other ping types specified. Use this first when on same subnet as target. MAC addresses help identify device types (workstations vs servers vs network equipment)."
    }
  ],
  "firewall_evasion_profiles": [
    {
      "id": "evasion-skip-ping",
      "name": "Skip Host Discovery (Assume All Hosts Up)",
      "base_command": "nmap -Pn",
      "timing": "normal",
      "coverage": "full",
      "use_case": "OSCP CRITICAL: Scan hosts that don't respond to ping probes (firewalls blocking all ping types)",
      "estimated_time": "Varies (depends on port range)",
      "detection_risk": "medium-high",
      "tags": [
        "OSCP:HIGH",
        "EVASION",
        "FIREWALL_BYPASS"
      ],
      "phases": [
        "discovery",
        "service-detection"
      ],
      "flag_explanations": {
        "-Pn": "Skip host discovery (treat all hosts as online) - proceeds directly to port scanning even if ping fails"
      },
      "success_indicators": [
        "Port scan completes on hosts that appeared 'down' in ping scan",
        "Discovers services on heavily firewalled hosts",
        "Essential for hosts with ICMP/TCP ping filters"
      ],
      "failure_indicators": [
        "Significantly slower (scans truly offline hosts too)",
        "Wastes time on non-existent hosts in large ranges",
        "More likely to trigger IDS/IPS alerts (high traffic volume)"
      ],
      "next_steps": [
        "Combine with service detection: nmap -Pn -sV -sC <target>",
        "Use with specific port ranges to reduce scan time: nmap -Pn -p 80,443,445 <target>",
        "Add timing optimization: nmap -Pn -T4 --min-rate 1000 <target>"
      ],
      "alternatives": [
        "None - this is the ultimate bypass when all ping methods fail",
        "First try all ping types before resorting to -Pn",
        "Use with caution on large networks (scan will be very slow)"
      ],
      "notes": "OSCP EXAM ESSENTIAL: If initial scan shows host as 'down' but you know it exists (challenge instructions confirm it), ALWAYS re-scan with -Pn. Many exam boxes have aggressive firewall rules blocking all ping probes. This flag is often the difference between success and failure."
    }
  ],
  "dns_control_profiles": [
    {
      "id": "dns-no-resolve",
      "name": "Disable DNS Resolution (Speed Optimization)",
      "base_command": "nmap -n",
      "timing": "fast",
      "coverage": "full",
      "use_case": "OSCP Exam: Skip DNS resolution to speed up scans (save time when hostnames not needed)",
      "estimated_time": "10-20% faster than normal scan",
      "detection_risk": "medium",
      "tags": [
        "OSCP:HIGH",
        "QUICK_WIN",
        "SPEED"
      ],
      "phases": [
        "discovery",
        "service-detection"
      ],
      "flag_explanations": {
        "-n": "Never perform DNS resolution (skip reverse DNS lookups) - faster scanning"
      },
      "success_indicators": [
        "Faster scan completion",
        "No DNS-related delays",
        "Reduces network traffic"
      ],
      "failure_indicators": [
        "Miss intelligence from hostnames",
        "No context from DNS naming"
      ],
      "next_steps": [
        "Use -n for speed during exam time crunch",
        "Use -R for thorough reconnaissance when time allows",
        "Combine: nmap -n -T4 --min-rate 1000 <target> (maximum speed)"
      ],
      "alternatives": [
        "None - this is the speed optimization flag",
        "Default behavior: nmap resolves DNS only for online hosts"
      ],
      "notes": "OSCP TIME MANAGEMENT: Use -n during timed exams to save 10-20% scan time. DNS lookups add latency. Only use -R when you specifically need hostnames for intelligence gathering. In exam: speed > pretty output."
    }
  ],
  "nse_profiles": [
    {
      "id": "nse-safe",
      "name": "NSE Safe Scripts (Default + Safe Categories)",
      "base_command": "nmap -sV -sC --script=safe",
      "timing": "normal",
      "coverage": "service-specific",
      "use_case": "OSCP: Run safe NSE scripts that won't crash services or trigger IDS (default + safe categories)",
      "estimated_time": "3-5 minutes",
      "detection_risk": "low",
      "tags": [
        "OSCP:HIGH",
        "NSE",
        "SAFE",
        "ENUM"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "-sV": "Service version detection (required for NSE script targeting)",
        "-sC": "Default NSE scripts (safe, well-tested scripts like http-title, banner grabbing)",
        "--script=safe": "Run all scripts marked 'safe' category (no crashes, no exploits, pure enumeration)"
      },
      "nse_categories": ["default", "safe"],
      "success_indicators": [
        "Service information enumerated (HTTP titles, banners, versions)",
        "No service crashes or errors",
        "Detailed enumeration data gathered"
      ],
      "failure_indicators": [
        "Scripts timeout (increase --script-timeout)",
        "Service version detection fails (use --version-intensity 9)",
        "Firewall blocks script probes"
      ],
      "next_steps": [
        "Review script output for credentials, usernames, directory listings",
        "Run targeted scripts on interesting services (--script=http-enum on port 80)",
        "Proceed to vuln category scripts: --script=vuln"
      ],
      "alternatives": [
        "Default only: nmap -sC <target> (faster, fewer scripts)",
        "Manual: Review nmap --script-help safe for available scripts",
        "Targeted: nmap --script http-enum,smb-enum-shares <target>"
      ],
      "notes": "Chapter 9: Safe scripts are thoroughly tested and won't harm services. Good for initial enumeration. Includes http-title, ssh-hostkey, ssl-cert, smb-os-discovery, etc."
    },
    {
      "id": "nse-discovery",
      "name": "NSE Discovery Scripts",
      "base_command": "nmap -sV --script=discovery",
      "timing": "normal",
      "coverage": "service-specific",
      "use_case": "OSCP: Run discovery/enumeration scripts (users, shares, directories, DNS records)",
      "estimated_time": "3-7 minutes",
      "detection_risk": "low",
      "tags": [
        "OSCP:HIGH",
        "NSE",
        "DISCOVERY",
        "ENUM"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "-sV": "Service version detection",
        "--script=discovery": "Run discovery category scripts (enumeration without exploitation)"
      },
      "nse_categories": ["discovery"],
      "script_examples": [
        "http-enum (directory brute-force with NSE fingerprint database)",
        "smb-enum-shares (list SMB shares)",
        "dns-nsid (DNS server identification)",
        "snmp-info (SNMP system information)",
        "ssh-hostkey (SSH public key extraction)"
      ],
      "success_indicators": [
        "Users enumerated (SMB, SMTP, SSH)",
        "Shares discovered (SMB, NFS)",
        "Directories found (HTTP)",
        "DNS records retrieved"
      ],
      "failure_indicators": [
        "No enumeration data (authentication required)",
        "Scripts blocked by firewall",
        "Timeout issues (reduce script count)"
      ],
      "next_steps": [
        "Use enumerated usernames for brute-force attacks",
        "Access discovered shares/directories",
        "Research enumerated software versions for CVEs"
      ],
      "alternatives": [
        "Targeted: nmap --script http-enum,smb-enum-users <target>",
        "Manual tools: enum4linux, gobuster, snmpwalk"
      ],
      "notes": "Chapter 9: Discovery scripts are non-intrusive. Use before exploit attempts. Includes powerful enumeration like http-enum (uses nselib/data/http-fingerprints.lua database)."
    },
    {
      "id": "nse-vuln",
      "name": "NSE Vulnerability Detection",
      "base_command": "nmap -sV --script=vuln",
      "timing": "normal",
      "coverage": "service-specific",
      "use_case": "OSCP: Automated vulnerability detection (EternalBlue, Shellshock, SQLi, etc.)",
      "estimated_time": "5-15 minutes",
      "detection_risk": "high",
      "tags": [
        "OSCP:HIGH",
        "NSE",
        "VULN_SCAN",
        "NOISY"
      ],
      "phases": [
        "exploitation"
      ],
      "flag_explanations": {
        "-sV": "Service version detection (required for accurate vuln matching)",
        "--script=vuln": "Run vulnerability detection scripts (checks for known CVEs and exploits)"
      },
      "nse_categories": ["vuln"],
      "script_examples": [
        "smb-vuln-ms17-010 (EternalBlue - Windows SMB RCE)",
        "http-shellshock (Shellshock CGI vulnerability)",
        "ssl-heartbleed (Heartbleed OpenSSL vulnerability)",
        "http-sql-injection (SQLi detection in forms/parameters)",
        "ftp-vsftpd-backdoor (vsftpd 2.3.4 backdoor)"
      ],
      "success_indicators": [
        "Vulnerabilities detected with CVE numbers",
        "Exploit confirmation messages",
        "Detailed vuln descriptions in output"
      ],
      "failure_indicators": [
        "No vulnerabilities found (patched system or false negatives)",
        "Scripts too noisy (triggered IDS/IPS)",
        "Scan very slow (many vuln checks run)"
      ],
      "next_steps": [
        "Research detected CVEs: searchsploit <CVE>",
        "Test exploits manually before automated exploitation",
        "Document all vulnerabilities for OSCP report",
        "Verify findings (reduce false positives)"
      ],
      "alternatives": [
        "Targeted: nmap --script smb-vuln-ms17-010 <target> (single vuln check)",
        "Manual: Research version manually via searchsploit/CVE databases",
        "Tools: Metasploit auxiliary/scanner modules"
      ],
      "notes": "Chapter 9: NOISY - May trigger IDS/IPS. Use with caution. Vuln scripts use NSE vulns library for structured reporting. Always verify findings manually."
    },
    {
      "id": "nse-auth",
      "name": "NSE Authentication Scripts",
      "base_command": "nmap -sV --script=auth",
      "timing": "normal",
      "coverage": "service-specific",
      "use_case": "OSCP: Test authentication mechanisms (default creds, auth bypass, weak auth)",
      "estimated_time": "2-5 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:MEDIUM",
        "NSE",
        "AUTH",
        "QUICK_WIN"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "-sV": "Service version detection",
        "--script=auth": "Run authentication testing scripts"
      },
      "nse_categories": ["auth"],
      "script_examples": [
        "http-auth-finder (find HTTP auth pages)",
        "ssh-auth-methods (enumerate SSH auth methods)",
        "ftp-anon (test FTP anonymous login)",
        "mysql-empty-password (test MySQL blank root password)"
      ],
      "success_indicators": [
        "Anonymous/guest access discovered",
        "Default credentials working",
        "Auth bypass vulnerabilities found"
      ],
      "failure_indicators": [
        "All auth methods require credentials",
        "Default credentials changed",
        "Scripts blocked by service config"
      ],
      "next_steps": [
        "Exploit discovered weak authentication",
        "Enumerate authenticated services",
        "Test credential reuse across services"
      ],
      "alternatives": [
        "Manual: Try common defaults (admin:admin, root:root)",
        "Targeted: nmap --script ftp-anon,mysql-empty-password <target>"
      ],
      "notes": "Chapter 9: Auth scripts test common misconfigurations. Quick wins for OSCP. Always test anonymous/guest access first."
    },
    {
      "id": "nse-brute",
      "name": "NSE Brute Force Scripts",
      "base_command": "nmap -sV --script=brute --script-args userdb=/usr/share/wordlists/seclists/Usernames/top-usernames-shortlist.txt",
      "timing": "slow",
      "coverage": "service-specific",
      "use_case": "OSCP: Credential brute-forcing (SSH, FTP, HTTP, SMB) - LAST RESORT, NOISY",
      "estimated_time": "10-60 minutes (wordlist dependent)",
      "detection_risk": "very-high",
      "tags": [
        "OSCP:LOW",
        "NSE",
        "BRUTE_FORCE",
        "NOISY"
      ],
      "phases": [
        "exploitation"
      ],
      "flag_explanations": {
        "-sV": "Service version detection",
        "--script=brute": "Run brute-force scripts (password guessing attacks)",
        "--script-args userdb": "Custom username wordlist path",
        "--script-args passdb": "Custom password wordlist path (optional)",
        "--script-args brute.firstOnly": "Stop after first valid account (faster)"
      },
      "nse_categories": ["brute"],
      "script_examples": [
        "ssh-brute (SSH password brute-force using NSE brute library)",
        "ftp-brute (FTP credential attacks)",
        "http-brute (HTTP Basic/Digest auth brute-force)",
        "smtp-brute (SMTP auth brute-force)"
      ],
      "success_indicators": [
        "Valid credentials found (user:pass pairs)",
        "Access granted to service"
      ],
      "failure_indicators": [
        "Account lockout triggered",
        "All attempts failed",
        "Rate limiting active",
        "Extremely slow progress"
      ],
      "next_steps": [
        "Use found credentials immediately",
        "Test credentials on other services (credential reuse)",
        "Document exact credentials for OSCP report"
      ],
      "alternatives": [
        "hydra -L users.txt -P passwords.txt <service>://<target>",
        "Manual: Try small custom password list first",
        "medusa -h <target> -U users.txt -P passwords.txt -M <service>"
      ],
      "notes": "Chapter 9: OSCP WARNING - Brute-force is SLOW, NOISY, often triggers lockouts. Try auth/default creds first. Use small wordlists in exam. NSE brute library provides standardized interface across protocols."
    },
    {
      "id": "nse-http-all",
      "name": "NSE HTTP Comprehensive Scan",
      "base_command": "nmap -sV --script \"http-*\" -p80,443,8080,8443",
      "timing": "normal",
      "coverage": "http-specific",
      "use_case": "OSCP: Run ALL HTTP NSE scripts on web servers (enum, vulns, auth, headers)",
      "estimated_time": "10-20 minutes",
      "detection_risk": "high",
      "tags": [
        "OSCP:HIGH",
        "NSE",
        "HTTP",
        "COMPREHENSIVE",
        "NOISY"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "-sV": "Service version detection",
        "--script \"http-*\"": "Run all scripts matching 'http-*' pattern (comprehensive HTTP testing)",
        "-p80,443,8080,8443": "Common HTTP/HTTPS ports"
      },
      "nse_categories": ["http"],
      "script_examples": [
        "http-enum (directory/file enumeration)",
        "http-methods (HTTP method testing)",
        "http-headers (security header analysis)",
        "http-sql-injection (SQLi detection)",
        "http-wordpress-enum (WordPress enumeration)",
        "http-shellshock (Shellshock vulnerability)",
        "http-waf-detect (WAF detection)"
      ],
      "success_indicators": [
        "Directories/files discovered",
        "Vulnerabilities found (SQLi, XSS, Shellshock)",
        "CMS detected and enumerated",
        "Security misconfigurations identified"
      ],
      "failure_indicators": [
        "WAF blocking all requests",
        "Scan too slow (too many scripts running)",
        "Many false positives"
      ],
      "next_steps": [
        "Manually verify detected vulnerabilities",
        "Browse discovered directories",
        "Test identified attack vectors",
        "Research detected CMS version for exploits"
      ],
      "alternatives": [
        "Targeted: nmap --script http-enum,http-methods,http-headers <target>",
        "Manual tools: gobuster, nikto, wpscan",
        "Selective: nmap --script \"http-vuln-*\" <target> (vulns only)"
      ],
      "notes": "Chapter 9: COMPREHENSIVE but NOISY. Runs 80+ HTTP scripts. May trigger WAF/IDS. Use for thorough enumeration when stealth not required. Selective scripts recommended for OSCP exam speed."
    },
    {
      "id": "nse-smb-all",
      "name": "NSE SMB Comprehensive Scan",
      "base_command": "nmap -sV --script \"smb-*\" -p139,445",
      "timing": "normal",
      "coverage": "smb-specific",
      "use_case": "OSCP: Run ALL SMB NSE scripts (enum, vulns, brute-force, exploits)",
      "estimated_time": "5-15 minutes",
      "detection_risk": "high",
      "tags": [
        "OSCP:HIGH",
        "NSE",
        "SMB",
        "COMPREHENSIVE",
        "NOISY"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "-sV": "Service version detection",
        "--script \"smb-*\"": "Run all SMB-related NSE scripts",
        "-p139,445": "SMB ports (NetBIOS session service, SMB direct)"
      },
      "nse_categories": ["smb"],
      "script_examples": [
        "smb-os-discovery (OS version, domain, workgroup)",
        "smb-enum-shares (share enumeration)",
        "smb-enum-users (user enumeration via RPC)",
        "smb-vuln-ms17-010 (EternalBlue)",
        "smb-vuln-ms08-067 (Conficker)",
        "smb-security-mode (security settings)",
        "smb-protocols (SMB protocol versions)"
      ],
      "success_indicators": [
        "Shares enumerated (including hidden $shares)",
        "Vulnerabilities detected (EternalBlue, MS08-067)",
        "Users/groups discovered",
        "OS and domain information revealed"
      ],
      "failure_indicators": [
        "Null sessions disabled (access denied)",
        "All vulnerability checks return 'not vulnerable'",
        "Scan triggers account lockout"
      ],
      "next_steps": [
        "Exploit detected vulnerabilities (MS17-010, MS08-067)",
        "Access enumerated shares: smbclient //<target>/<share>",
        "Use enumerated users for brute-force",
        "Test discovered credentials on other systems"
      ],
      "alternatives": [
        "Targeted: nmap --script smb-enum-shares,smb-vuln-ms17-010 <target>",
        "Manual tools: enum4linux, smbclient, crackmapexec",
        "Selective vulns: nmap --script \"smb-vuln-*\" <target>"
      ],
      "notes": "Chapter 9: SMB scripts are OSCP GOLD. EternalBlue (MS17-010) is common in labs. Always run SMB enumeration on Windows targets. Comprehensive but may trigger IDS."
    },
    {
      "id": "nse-script-args-example",
      "name": "NSE Script Arguments Example (HTTP Enum with Custom Paths)",
      "base_command": "nmap -sV --script http-enum --script-args http-enum.basepath=/admin/,http-enum.fingerprintfile=/custom/fingerprints.txt -p80",
      "timing": "normal",
      "coverage": "http-specific",
      "use_case": "OSCP: Demonstrate NSE script argument usage (customize script behavior)",
      "estimated_time": "3-5 minutes",
      "detection_risk": "medium",
      "tags": [
        "OSCP:MEDIUM",
        "NSE",
        "HTTP",
        "CUSTOMIZATION"
      ],
      "phases": [
        "service-specific"
      ],
      "flag_explanations": {
        "-sV": "Service version detection",
        "--script http-enum": "HTTP directory/file enumeration script",
        "--script-args http-enum.basepath": "Set custom base path for enumeration (e.g., /admin/)",
        "--script-args http-enum.fingerprintfile": "Use custom fingerprint database (extend default checks)"
      },
      "nse_categories": ["http"],
      "script_args_examples": {
        "http.useragent": "Set custom User-Agent header",
        "http.max-cache-size": "Control HTTP library cache size",
        "brute.firstonly": "Stop brute-force after first valid account",
        "userdb": "Custom username wordlist path",
        "passdb": "Custom password wordlist path",
        "unpwdb.timelimit": "Brute-force time limit (e.g., 30m)"
      },
      "success_indicators": [
        "Custom paths enumerated successfully",
        "Script behavior modified as expected",
        "Custom fingerprints detected"
      ],
      "next_steps": [
        "Review nmap --script-help <script> for all available arguments",
        "Create custom fingerprint files for http-enum",
        "Use --script-args-file for complex argument sets"
      ],
      "alternatives": [
        "View args: nmap --script-help http-enum",
        "Multiple args: --script-args arg1=val1,arg2=val2",
        "From file: --script-args-file args.txt"
      ],
      "notes": "Chapter 9: Script arguments customize NSE behavior. Use stdnse.get_script_args() in custom scripts. Common args: userdb, passdb, brute.firstonly, http.useragent. Check --script-help <script> for full arg list."
    }
  ]
}