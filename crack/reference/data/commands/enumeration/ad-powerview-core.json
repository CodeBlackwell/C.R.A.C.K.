{
  "category": "enumeration",
  "description": "Core PowerView cmdlets for Active Directory object enumeration (users, groups, computers)",
  "commands": [
    {
      "id": "powerview-get-netdomain",
      "name": "Get Domain Information (PowerView)",
      "category": "enumeration",
      "command": "Get-NetDomain",
      "description": "Retrieve current domain information including forest, domain controllers, PDC, and domain properties using PowerView",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "DOMAIN",
        "STARTER",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Forest",
        "DomainControllers",
        "PdcRoleOwner",
        "Name"
      ],
      "failure_indicators": [
        "Get-NetDomain : The term 'Get-NetDomain' is not recognized",
        "Access Denied"
      ],
      "next_steps": [
        "powerview-get-netdomaincontroller",
        "powerview-get-netuser",
        "powerview-get-netgroup"
      ],
      "alternatives": [
        "ps-get-current-domain",
        "$env:USERDNSDOMAIN",
        "systeminfo | findstr /B /C:\"Domain\""
      ],
      "prerequisites": [
        "Import-Module PowerView.ps1 or . .\\PowerView.ps1"
      ],
      "troubleshooting": {
        "Get-NetDomain not recognized": "PowerView not imported. Import: Import-Module .\\PowerView.ps1 or dot-source: . .\\PowerView.ps1",
        "Access Denied": "Not logged in as domain user. Verify: whoami /fqdn"
      },
      "notes": "PowerView simplifies .NET LDAP queries into easy-to-use cmdlets. Get-NetDomain is equivalent to [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain() but with cleaner output. Returns critical properties: PdcRoleOwner (target for enumeration), DomainMode (functional level), Forest (multi-domain environments). OSCP: Import PowerView at the start of AD enumeration for speed and convenience.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-netdomaincontroller",
      "name": "Enumerate Domain Controllers (PowerView)",
      "category": "enumeration",
      "command": "Get-NetDomainController",
      "description": "List all domain controllers in the current domain with IP addresses, OS versions, and roles",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "DOMAIN_CONTROLLER",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Forest",
        "Name",
        "IPAddress",
        "OSVersion"
      ],
      "failure_indicators": [
        "Get-NetDomainController not recognized",
        "Unable to contact domain"
      ],
      "next_steps": [
        "Target PDC for accurate enumeration",
        "Check DC OS version for vulnerabilities",
        "Identify forest root DC"
      ],
      "alternatives": [
        "nltest /dclist:<DOMAIN>",
        "nslookup -type=SRV _ldap._tcp.dc._msdcs.<DOMAIN>",
        "ps-get-pdc"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "Unable to contact domain": "DC unreachable. Check network connectivity: ping <DC>"
      },
      "notes": "Returns all DCs in the domain with detailed properties. IPAddress field useful for direct targeting. OSVersion reveals vulnerable legacy DCs (Server 2008, 2012). Forest property shows forest root (important in multi-domain environments). OSCP: Identify the PDC from PdcRoleOwner field - use this for all subsequent enumeration queries for accuracy.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-netuser",
      "name": "Enumerate All Domain Users (PowerView)",
      "category": "enumeration",
      "command": "Get-NetUser",
      "description": "Retrieve all user accounts in the domain with all attributes displayed",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "USERS",
        "STARTER",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "samaccountname",
        "distinguishedname",
        "memberof",
        "User attributes displayed"
      ],
      "failure_indicators": [
        "Get-NetUser not recognized",
        "Access Denied"
      ],
      "next_steps": [
        "powerview-get-netuser-filter",
        "powerview-get-netuser-spn",
        "Filter for specific attributes: Get-NetUser | select samaccountname,memberof"
      ],
      "alternatives": [
        "net-user-domain-list",
        "ps-directorysearcher-users"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "Too much output": "Filter attributes: Get-NetUser | select samaccountname,description,memberof | Format-Table"
      },
      "notes": "Returns ALL user attributes for every domain user - output can be overwhelming in large domains. Use select to filter: Get-NetUser | select samaccountname,pwdlastset,lastlogon filters for key attributes. Look for dormant accounts (old lastlogon), weak passwords (old pwdlastset), admin accounts (memberof contains Domain Admins). OSCP: Pipe to select immediately to avoid information overload.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-netuser-filter",
      "name": "Get Specific Domain User (PowerView)",
      "category": "enumeration",
      "command": "Get-NetUser -Identity <USERNAME>",
      "description": "Retrieve detailed information about a specific domain user",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "USERS",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Domain username to query",
          "example": "administrator",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Identity": "Specifies the user to query. Accepts samaccountname, distinguished name, or SID. Faster than filtering all users."
      },
      "success_indicators": [
        "User attributes for specified user",
        "memberof",
        "admincount"
      ],
      "failure_indicators": [
        "Get-NetUser not recognized",
        "User not found"
      ],
      "next_steps": [
        "Check memberof for Domain Admins membership",
        "Check admincount=1 for protected accounts",
        "Check serviceprincipalname for Kerberoastable accounts"
      ],
      "alternatives": [
        "net-user-domain-detail",
        "Get-NetUser | ? {$_.samaccountname -eq '<USERNAME>'}"
      ],
      "prerequisites": [
        "Import PowerView",
        "powerview-get-netuser"
      ],
      "troubleshooting": {
        "User not found": "Verify spelling. List all users first: Get-NetUser | select samaccountname"
      },
      "notes": "Much faster than Get-NetUser | Where-Object because it queries AD directly for the specific user. Key attributes to check: memberof (group memberships - Domain Admins?), admincount (1 = protected admin account), pwdlastset (password age - old = potentially weak), serviceprincipalname (Kerberoastable?), useraccountcontrol (account flags - disabled, password never expires, etc.). OSCP: Use this to quickly profile high-value target users discovered during enumeration.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-netuser-spn",
      "name": "Find Kerberoastable Accounts (PowerView)",
      "category": "enumeration",
      "command": "Get-NetUser -SPN | select samaccountname,serviceprincipalname",
      "description": "Enumerate all user accounts with Service Principal Names registered (Kerberoastable targets)",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "KERBEROASTING",
        "SPN",
        "SERVICE_ACCOUNTS",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "-SPN": "Filters users with servicePrincipalName attribute set. These accounts run services and are Kerberoastable - service tickets can be requested and cracked offline."
      },
      "success_indicators": [
        "samaccountname",
        "serviceprincipalname",
        "krbtgt excluded (not Kerberoastable)",
        "Service accounts listed"
      ],
      "failure_indicators": [
        "No SPNs found",
        "Module not imported"
      ],
      "next_steps": [
        "Request Kerberos tickets: Invoke-Kerberoast -Identity <USERNAME>",
        "Extract tickets for offline cracking",
        "Identify service type from SPN (HTTP, MSSQLSvc, etc.)"
      ],
      "alternatives": [
        "setspn-query-all",
        "Get-NetUser | ? {$_.serviceprincipalname} | select samaccountname,serviceprincipalname"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "krbtgt showing in results": "krbtgt has SPNs but is not Kerberoastable. Filter out: Get-NetUser -SPN | ? {$_.samaccountname -ne 'krbtgt'}"
      },
      "notes": "Service accounts typically have elevated privileges (local admin, database access) and weak passwords (set once, rarely changed). SPN format reveals service type: HTTP/ (web servers), MSSQLSvc/ (SQL Server), TERMSRV/ (RDP). Kerberoasting workflow: (1) Request service ticket with valid domain credentials, (2) Extract ticket (contains service account password hash), (3) Crack offline with hashcat/john (no lockout risk). OSCP: One of the most reliable privilege escalation techniques - always enumerate SPNs early.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-netgroup",
      "name": "Enumerate All Domain Groups (PowerView)",
      "category": "enumeration",
      "command": "Get-NetGroup | select cn",
      "description": "List all security groups in the domain with clean output",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "GROUPS",
        "STARTER",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "select cn": "Filters output to only show Common Name (group name). Without this, PowerView returns all attributes which is overwhelming."
      },
      "success_indicators": [
        "Domain Admins",
        "Enterprise Admins",
        "Group names listed"
      ],
      "failure_indicators": [
        "Get-NetGroup not recognized",
        "Access Denied"
      ],
      "next_steps": [
        "powerview-get-netgroup-specific",
        "powerview-get-netgroupmember",
        "Prioritize: Domain Admins, Enterprise Admins, Administrators, custom groups (IT, Service, Management)"
      ],
      "alternatives": [
        "net-group-domain-list",
        "ps-directorysearcher-groups"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1"
      },
      "notes": "Returns ALL groups including default AD groups and custom organizational groups. Default high-privilege groups: Domain Admins (domain-wide admin), Enterprise Admins (forest-wide admin), Administrators (local admin on domain computers). Custom groups often reveal organizational structure: 'IT_Admins', 'SQL_DBAs', 'Service_Accounts', 'Management'. OSCP: Look for custom groups with 'Admin', 'IT', 'Service', 'Management' in the name - often have elevated privileges not obvious from the name alone.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-netgroup-specific",
      "name": "Get Specific Group Details (PowerView)",
      "category": "enumeration",
      "command": "Get-NetGroup -Identity \"<GROUPNAME>\" | select member",
      "description": "Retrieve members of a specific domain group",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "GROUPS",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<GROUPNAME>",
          "description": "Domain group name (use quotes if spaces)",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Identity": "Specifies the group to query. Accepts group name, distinguished name, or SID.",
        "select member": "Displays only the member attribute (group members). Members shown as distinguished names."
      },
      "success_indicators": [
        "member",
        "CN=",
        "Distinguished names of members"
      ],
      "failure_indicators": [
        "Group not found",
        "Module not imported"
      ],
      "next_steps": [
        "powerview-get-netgroupmember",
        "Check for nested groups (member DNs starting with CN=group)",
        "Enumerate each member: Get-NetUser -Identity <USERNAME>"
      ],
      "alternatives": [
        "net-group-domain-members",
        "Get-NetGroupMember -Identity \"<GROUPNAME>\""
      ],
      "prerequisites": [
        "Import PowerView",
        "powerview-get-netgroup"
      ],
      "troubleshooting": {
        "Group not found": "Use quotes for group names with spaces. Verify exact name: Get-NetGroup | select cn",
        "Member field shows distinguished names": "Use Get-NetGroupMember for cleaner output with resolved usernames"
      },
      "notes": "Member attribute shows distinguished names (LDAP format) not usernames. Format: 'CN=username,CN=Users,DC=corp,DC=com' for users, 'CN=groupname,CN=Users,DC=corp,DC=com' for nested groups. If member DN starts with 'CN=' and contains 'CN=Users', it's likely a group (nested group membership). Use Get-NetGroupMember -Recurse to automatically resolve nested groups. OSCP: Domain Admins members = instant win if compromised.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-netgroupmember",
      "name": "Get Group Members Resolved (PowerView)",
      "category": "enumeration",
      "command": "Get-NetGroupMember -Identity \"<GROUPNAME>\"",
      "description": "List group members with resolved usernames and object types (cleaner than Get-NetGroup)",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "GROUPS",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<GROUPNAME>",
          "description": "Domain group name",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Identity": "Group to enumerate members for. More user-friendly output than Get-NetGroup.",
        "-Recurse (optional)": "Resolves nested groups recursively. Use: Get-NetGroupMember -Identity \"<GROUPNAME>\" -Recurse"
      },
      "success_indicators": [
        "MemberName",
        "MemberObjectClass",
        "Members listed with types (user vs group)"
      ],
      "failure_indicators": [
        "Group not found",
        "Module not imported"
      ],
      "next_steps": [
        "Use -Recurse to unravel nested groups",
        "Enumerate each user member: Get-NetUser -Identity <USERNAME>",
        "Check for service accounts in privileged groups"
      ],
      "alternatives": [
        "powerview-get-netgroup-specific",
        "net-group-domain-members"
      ],
      "prerequisites": [
        "Import PowerView",
        "powerview-get-netgroup"
      ],
      "troubleshooting": {
        "Nested groups not showing users": "Add -Recurse flag: Get-NetGroupMember -Identity \"<GROUPNAME>\" -Recurse",
        "Group not found": "Use quotes for group names with spaces"
      },
      "notes": "Cleaner output than Get-NetGroup because it resolves distinguished names to usernames and shows object types (user vs group). MemberObjectClass reveals if member is a user (objectClass=user) or nested group (objectClass=group). -Recurse flag automatically resolves nested groups - essential for finding all effective members. OSCP: Always use -Recurse for privileged groups to find hidden admin accounts nested in subgroups.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-netcomputer",
      "name": "Enumerate Domain Computers (PowerView)",
      "category": "enumeration",
      "command": "Get-NetComputer | select dnshostname,operatingsystem,operatingsystemversion",
      "description": "List all domain-joined computers with OS information for targeting",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "COMPUTERS",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "select dnshostname,operatingsystem,operatingsystemversion": "Filters output to show hostname (for connection), OS name (for targeting), and build number (for vulnerability matching)."
      },
      "success_indicators": [
        "dnshostname",
        "operatingsystem",
        "Windows Server",
        "Windows 10/11"
      ],
      "failure_indicators": [
        "Module not imported",
        "Access Denied"
      ],
      "next_steps": [
        "Target legacy OS: Get-NetComputer -OperatingSystem '*Server 2008*'",
        "Find admin access: Find-LocalAdminAccess",
        "Test connectivity: Test-Connection -ComputerName <HOST>"
      ],
      "alternatives": [
        "ps-directorysearcher-computers",
        "dsquery-computer",
        "nmap -sn <SUBNET>"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "Output too large": "Filter by OS: Get-NetComputer -OperatingSystem '*Server*' | select dnshostname,operatingsystem"
      },
      "notes": "Reveals all domain-joined machines without network scanning. operatingsystem identifies vulnerable legacy systems (Windows 7, Server 2008) for targeting. operatingsystemversion provides exact build number for CVE matching. dnshostname is the FQDN for connecting (RDP, WinRM, SMB). Filter examples: Get-NetComputer -OperatingSystem '*Server*' (servers only), Get-NetComputer -OperatingSystem '*2008*' (legacy servers). OSCP: Focus on legacy OS and servers - higher chance of misconfigurations and unpatched vulnerabilities.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-netou",
      "name": "Enumerate Organizational Units (PowerView)",
      "category": "enumeration",
      "command": "Get-NetOU | select name,distinguishedname",
      "description": "List all Organizational Units to understand domain structure and delegation",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ORGANIZATIONAL_UNITS",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {
        "select name,distinguishedname": "Shows OU name and full LDAP path. Distinguished name reveals OU hierarchy."
      },
      "success_indicators": [
        "name",
        "distinguishedname",
        "OU=",
        "Domain structure revealed"
      ],
      "failure_indicators": [
        "Module not imported"
      ],
      "next_steps": [
        "Identify interesting OUs: Servers, Workstations, Service Accounts",
        "Query objects in specific OU: Get-NetUser -SearchBase 'OU=ServiceAccounts,DC=corp,DC=com'",
        "Check OU GPO links: Get-NetGPO"
      ],
      "alternatives": [
        "Get-ADOrganizationalUnit -Filter *",
        "dsquery ou"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1"
      },
      "notes": "OUs organize objects in AD for management and GPO application. Common OUs: 'Domain Controllers' (DCs), 'Computers' (workstations), 'Servers' (servers), custom OUs by department/function. OU structure reveals organizational hierarchy and delegation boundaries. Admins often create OUs like 'Service Accounts', 'Privileged Users', 'Disabled Users' - investigate these for misconfigurations. OSCP: OUs are less critical than users/groups/computers but can reveal admin practices and potential targets.",
      "oscp_relevance": "medium"
    },
    {
      "id": "powerview-get-netgpo",
      "name": "Enumerate Group Policy Objects (PowerView)",
      "category": "enumeration",
      "command": "Get-NetGPO | select displayname,whenchanged",
      "description": "List all Group Policy Objects in the domain to identify policies and configurations",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "GPO",
        "GROUP_POLICY",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {
        "select displayname,whenchanged": "Shows GPO name and last modification date. Recent changes may indicate active admin work or policy testing."
      },
      "success_indicators": [
        "displayname",
        "whenchanged",
        "Default Domain Policy",
        "GPO names listed"
      ],
      "failure_indicators": [
        "Module not imported"
      ],
      "next_steps": [
        "Check GPO details: Get-NetGPO -Identity '<DISPLAYNAME>'",
        "Find vulnerable GPPs: Get-NetGPOGroup (looks for cpassword)",
        "Check GPO application: Get-NetOU | Get-NetGPOLink"
      ],
      "alternatives": [
        "Get-GPO -All",
        "Search SYSVOL for GPP passwords"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1"
      },
      "notes": "GPOs define domain-wide settings: password policies, software installation, scripts, security settings. Default Domain Policy controls password requirements and account lockout. Custom GPOs may contain credentials (GPP passwords - cpassword attribute), startup scripts with hardcoded credentials, or weak security settings. whenchanged shows last modification - recent changes may indicate testing/debugging GPOs with weak security. OSCP: Focus on finding GPP passwords in SYSVOL (old vulnerability but still present in legacy environments).",
      "oscp_relevance": "medium"
    },
    {
      "id": "powerview-get-netforest",
      "name": "Get Forest Information (PowerView)",
      "category": "enumeration",
      "command": "Get-NetForest",
      "description": "Retrieve AD forest information including domains, global catalog, and forest functional level",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "FOREST",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "RootDomainSid",
        "Domains",
        "GlobalCatalogs",
        "ForestMode"
      ],
      "failure_indicators": [
        "Module not imported",
        "Access Denied"
      ],
      "next_steps": [
        "Enumerate all domains in forest: Get-NetForest | select -ExpandProperty Domains",
        "Check forest trusts: Get-NetForestTrust",
        "Target root domain for Enterprise Admins"
      ],
      "alternatives": [
        "Get-ADForest",
        "[System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1"
      },
      "notes": "AD forests contain one or more domains in a trust relationship. Single domain environments: forest = domain (this command adds little value). Multi-domain environments: forest reveals domain structure and trust relationships. RootDomainSid identifies the forest root domain. Enterprise Admins group exists only in root domain and has admin rights across ALL domains in forest. OSCP: Most exam environments are single-domain, making this less relevant than Get-NetDomain. Use in multi-domain scenarios to map attack paths across domain boundaries.",
      "oscp_relevance": "medium"
    },
    {
      "id": "powerview-get-netuser-all",
      "name": "Enumerate All Domain Users (PowerView)",
      "category": "enumeration",
      "command": "Get-NetUser | select samaccountname,description,pwdlastset,lastlogon",
      "description": "List all domain users with key properties using PowerView",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "USERS",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "samaccountname": "Username (SAM account name)",
        "description": "User description field (often contains useful info like 'temp password: Winter2023')",
        "pwdlastset": "When password was last changed (identify stale accounts)",
        "lastlogon": "Last logon timestamp (identify active vs inactive accounts)"
      },
      "success_indicators": [
        "samaccountname",
        "description"
      ],
      "failure_indicators": [
        "Get-NetUser not recognized",
        "Module not imported"
      ],
      "next_steps": [
        "Filter for interesting users: | ? {$_.description -match 'password|pwd|pw'}"
      ],
      "alternatives": [
        "net user /domain",
        "LDAPSearch -LDAPQuery \"(objectClass=user)\""
      ],
      "prerequisites": [
        "Import PowerView: . .\\PowerView.ps1"
      ],
      "troubleshooting": {
        "Get-NetUser not recognized": "Import PowerView first: . .\\PowerView.ps1 or Import-Module PowerView.psd1"
      },
      "notes": "Check description fields - admins often store passwords there. Look for patterns: 'temp password', 'default password', 'reset to'.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-netcomputer-all",
      "name": "Enumerate All Domain Computers (PowerView)",
      "category": "enumeration",
      "command": "Get-NetComputer | select dnshostname,operatingsystem,lastlogon",
      "description": "List all domain computers with OS version and last logon",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "COMPUTERS",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {
        "dnshostname": "Computer's DNS hostname (FQDN)",
        "operatingsystem": "OS version (identify outdated/vulnerable systems)",
        "lastlogon": "Last logon timestamp (find active vs stale computers)"
      },
      "success_indicators": [
        "dnshostname",
        "operatingsystem"
      ],
      "failure_indicators": [
        "Get-NetComputer not recognized"
      ],
      "next_steps": [
        "Find vulnerable OS: | ? {$_.operatingsystem -match 'Server 2008|XP|Vista'}"
      ],
      "alternatives": [
        "net group \"Domain Computers\" /domain"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {},
      "notes": "Target older OS versions (Server 2008, 2012) - likely unpatched. Check lastlogon to identify active machines.",
      "oscp_relevance": "medium"
    },
    {
      "id": "powerview-get-netcomputer-ping",
      "name": "Find Live Domain Computers (PowerView)",
      "category": "enumeration",
      "command": "Get-NetComputer -Ping | select dnshostname",
      "description": "Enumerate domain computers and test connectivity with ICMP ping",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "COMPUTERS",
        "LIVE_HOSTS",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {
        "-Ping": "Tests ICMP connectivity to each computer. Only returns live/reachable hosts. WARNING: Slow on large domains (250+ computers)."
      },
      "success_indicators": [
        "dnshostname"
      ],
      "failure_indicators": [
        "Get-NetComputer not recognized",
        "No pingable hosts"
      ],
      "next_steps": [
        "Test admin access: Find-LocalAdminAccess"
      ],
      "alternatives": [
        "nmap -sn <SUBNET>"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "No pingable hosts": "ICMP may be blocked. Try without -Ping flag to get all computers."
      },
      "notes": "Slow on large domains. Use for small environments or when you need only active targets. Alternative: Get all computers then test with port scan.",
      "oscp_relevance": "medium"
    },
    {
      "id": "powerview-get-netgroup-recursive",
      "name": "Get Group Members Recursively (PowerView)",
      "category": "enumeration",
      "command": "Get-NetGroupMember -GroupName \"Domain Admins\" -Recurse",
      "description": "List all members of a group including nested group memberships",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "GROUPS",
        "DOMAIN_ADMINS",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "-GroupName": "Target group to enumerate (use quotes for names with spaces)",
        "-Recurse": "Follows nested group memberships. If User A is in GroupB, and GroupB is in Domain Admins, User A is returned."
      },
      "success_indicators": [
        "MemberName",
        "MemberDomain"
      ],
      "failure_indicators": [
        "Get-NetGroupMember not recognized",
        "Group not found"
      ],
      "next_steps": [
        "Check each member's privileges on other systems"
      ],
      "alternatives": [
        "net group \"Domain Admins\" /domain"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Group not found": "Verify group name: Get-NetGroup | select name"
      },
      "notes": "Critical for identifying privilege escalation paths. Nested groups often overlooked. Example: User \u2192 Helpdesk \u2192 ServerAdmins \u2192 Domain Admins.",
      "oscp_relevance": "high"
    }
  ]
}