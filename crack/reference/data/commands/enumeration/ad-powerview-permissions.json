{
  "category": "enumeration",
  "description": "PowerView ACL and permission enumeration for privilege escalation path discovery",
  "commands": [
    {
      "id": "powerview-get-objectacl",
      "name": "Get Object ACL (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity <OBJECT>",
      "description": "Retrieve Access Control List (permissions) for any AD object to identify who has what access",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<OBJECT>",
          "description": "AD object to query (username, groupname, or DN)",
          "example": "administrator",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Identity": "Specifies the AD object to query ACLs for. Accepts username, group name, computer name, or distinguished name.",
        "-ResolveGUIDs (optional)": "Resolves GUIDs in ObjectAceType to human-readable names. Use: Get-ObjectAcl -Identity <OBJECT> -ResolveGUIDs"
      },
      "success_indicators": [
        "ObjectDN",
        "ActiveDirectoryRights",
        "SecurityIdentifier",
        "ACE entries displayed"
      ],
      "failure_indicators": [
        "Module not imported",
        "Object not found"
      ],
      "next_steps": [
        "powerview-convert-sidtoname",
        "Filter for dangerous permissions: Get-ObjectAcl -Identity <OBJECT> | ? {$_.ActiveDirectoryRights -match 'GenericAll'}",
        "Check who has rights: Convert-SidToName <SID>"
      ],
      "alternatives": [
        "Get-Acl",
        "dsacls"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "Too much output": "Filter specific fields: Get-ObjectAcl -Identity <OBJECT> | select SecurityIdentifier,ActiveDirectoryRights"
      },
      "notes": "Returns ACL (Access Control List) - all permissions applied to an object. Each ACE (Access Control Entry) defines: (1) SecurityIdentifier (who has access - as SID), (2) ActiveDirectoryRights (what access they have - GenericAll, WriteDACL, etc.). Output is verbose - use Convert-SidToName to resolve SIDs and filter for dangerous rights. OSCP: Critical for finding privilege escalation paths - look for GenericAll, WriteDACL, WriteOwner on privileged groups/users.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-objectacl-genericall",
      "name": "Find GenericAll Permissions (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity \"<OBJECT>\" | ? {$_.ActiveDirectoryRights -eq \"GenericAll\"} | select SecurityIdentifier,ActiveDirectoryRights",
      "description": "Enumerate who has GenericAll (full control) permissions on a specific AD object",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "GENERICALL",
        "PRIVESC",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<OBJECT>",
          "description": "AD object to check (group name, username, etc.)",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "flag_explanations": {
        "? {$_.ActiveDirectoryRights -eq \"GenericAll\"}": "PowerShell Where-Object filter. Only shows ACEs where the permission is GenericAll (full control).",
        "select SecurityIdentifier,ActiveDirectoryRights": "Shows only SID (who has access) and rights (GenericAll)."
      },
      "success_indicators": [
        "SecurityIdentifier",
        "GenericAll",
        "SIDs with full control listed"
      ],
      "failure_indicators": [
        "No matching ACEs",
        "Module not imported"
      ],
      "next_steps": [
        "powerview-convert-sidtoname",
        "Convert all SIDs: Get-ObjectAcl -Identity \"<OBJECT>\" | ? {$_.ActiveDirectoryRights -eq \"GenericAll\"} | select -ExpandProperty SecurityIdentifier | Convert-SidToName",
        "Abuse GenericAll: Add-DomainGroupMember, Set-DomainUserPassword"
      ],
      "alternatives": [
        "Get-ObjectAcl -Identity \"<OBJECT>\" -ResolveGUIDs | ? {$_.ActiveDirectoryRights -match 'GenericAll'}"
      ],
      "prerequisites": [
        "Import PowerView",
        "powerview-get-objectacl"
      ],
      "troubleshooting": {
        "No results": "No GenericAll permissions found. Try other dangerous rights: WriteDACL, WriteOwner, ForceChangePassword"
      },
      "notes": "GenericAll = Full control over the object. If you have GenericAll on a user, you can: reset their password, modify attributes, read all properties. If you have GenericAll on a group, you can: add/remove members (add yourself to Domain Admins!), modify group attributes. GenericAll on computer objects: modify servicePrincipalName (Kerberoasting), LAPS password, etc. OSCP: Most powerful ACL for privilege escalation - if your user has GenericAll on a privileged group, you can add yourself to that group.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-convert-sidtoname",
      "name": "Convert SID to Username (PowerView)",
      "category": "enumeration",
      "command": "Convert-SidToName <SID>",
      "description": "Resolve Security Identifier (SID) to human-readable username, group name, or computer name",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "SID",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<SID>",
          "description": "Security Identifier to resolve",
          "example": "S-1-5-21-1987370270-658905905-1781884369-1104",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "DOMAIN\\username",
        "Resolved name displayed"
      ],
      "failure_indicators": [
        "Module not imported",
        "SID not found"
      ],
      "next_steps": [
        "Use with ACL enumeration: Get-ObjectAcl | select -ExpandProperty SecurityIdentifier | Convert-SidToName",
        "Identify object type: Get-NetUser -Identity <NAME> or Get-NetGroup -Identity <NAME>"
      ],
      "alternatives": [
        "[System.Security.Principal.SecurityIdentifier]::new('<SID>').Translate([System.Security.Principal.NTAccount]).Value"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "SID not found": "SID may be from external domain, deleted object, or invalid format"
      },
      "notes": "SIDs (Security Identifiers) are unique identifiers for AD objects. Format: S-1-5-21-<domain>-<RID>. RID (Relative Identifier) identifies the specific object: 500=Administrator, 512=Domain Admins, 513=Domain Users, etc. Get-ObjectAcl returns SIDs in SecurityIdentifier field - must convert to names for analysis. Batch conversion: Get-ObjectAcl | select -ExpandProperty SecurityIdentifier | Convert-SidToName. OSCP: Essential for ACL enumeration - SIDs are useless until converted to names.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-objectacl-writedacl",
      "name": "Find WriteDACL Permissions (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity \"<OBJECT>\" | ? {$_.ActiveDirectoryRights -match \"WriteDacl\"} | select SecurityIdentifier,ActiveDirectoryRights",
      "description": "Enumerate who can modify ACLs (permissions) on an AD object - allows granting yourself GenericAll",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "WRITEDACL",
        "PRIVESC",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<OBJECT>",
          "description": "AD object to check",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "flag_explanations": {
        "-match \"WriteDacl\"": "Regex match for WriteDacl permission. Also matches WriteDACL (case-insensitive)."
      },
      "success_indicators": [
        "SecurityIdentifier",
        "WriteDacl",
        "SIDs with DACL write access"
      ],
      "failure_indicators": [
        "No matching ACEs",
        "Module not imported"
      ],
      "next_steps": [
        "Convert SIDs to names",
        "Abuse WriteDACL: Add-DomainObjectAcl -TargetIdentity <OBJECT> -Rights All -PrincipalIdentity <YOUR_USER>",
        "Grant yourself GenericAll, then add to group or reset password"
      ],
      "alternatives": [
        "Get-ObjectAcl | ? {$_.ActiveDirectoryRights -match 'WriteProperty'}"
      ],
      "prerequisites": [
        "Import PowerView",
        "powerview-get-objectacl"
      ],
      "troubleshooting": {
        "No results": "Try WriteOwner instead - allows changing object owner to yourself, then modifying permissions"
      },
      "notes": "WriteDACL = Ability to modify the ACL (permissions) on an object. Attack path: (1) You have WriteDACL on target object, (2) Grant yourself GenericAll on that object, (3) Now you have full control. Example: WriteDACL on 'Domain Admins' group \u2192 Grant yourself GenericAll \u2192 Add yourself to Domain Admins. Similar powerful rights: WriteOwner (change owner to yourself, then modify ACL), WritePr operty (modify attributes). OSCP: WriteDACL is as powerful as GenericAll for privilege escalation - just requires one extra step.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-objectacl-forcechangepassword",
      "name": "Find ForceChangePassword Rights (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity \"<USERNAME>\" -ResolveGUIDs | ? {$_.ObjectAceType -eq \"User-Force-Change-Password\"} | select SecurityIdentifier,ObjectAceType",
      "description": "Enumerate who can reset passwords for a specific user without knowing the current password",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "PASSWORD_RESET",
        "PRIVESC",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Target user to check password reset rights on",
          "example": "administrator",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ResolveGUIDs": "Converts GUIDs in ObjectAceType to human-readable names like 'User-Force-Change-Password'.",
        "ObjectAceType -eq \"User-Force-Change-Password\"": "Filters for the specific extended right that allows password resets."
      },
      "success_indicators": [
        "SecurityIdentifier",
        "User-Force-Change-Password",
        "SIDs with password reset rights"
      ],
      "failure_indicators": [
        "No matching ACEs",
        "Module not imported"
      ],
      "next_steps": [
        "Convert SIDs to names",
        "Abuse: Set-DomainUserPassword -Identity <USERNAME> -Password (ConvertTo-SecureString 'NewPass123!' -AsPlainText -Force)",
        "Authenticate as target user with new password"
      ],
      "alternatives": [
        "Check for AllExtendedRights (includes ForceChangePassword): Get-ObjectAcl | ? {$_.ActiveDirectoryRights -match 'ExtendedRight'}"
      ],
      "prerequisites": [
        "Import PowerView",
        "powerview-get-objectacl"
      ],
      "troubleshooting": {
        "No results": "User may be protected by AdminSDHolder. Check admincount attribute: Get-NetUser -Identity <USERNAME> | select admincount"
      },
      "notes": "User-Force-Change-Password = Can reset user's password without knowing current password. Attack path: (1) You have ForceChangePassword on target user, (2) Reset their password, (3) Authenticate as them. No need for current password, no account lockout. Similar rights: AllExtendedRights (includes password reset + other extended rights). Protected accounts (admincount=1) may have this right restricted by AdminSDHolder. OSCP: If you can reset password of a Domain Admin, you've compromised the domain.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-objectacl-writeowner",
      "name": "Find WriteOwner Permissions (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity \"<OBJECT>\" | ? {$_.ActiveDirectoryRights -match \"WriteOwner\"} | select SecurityIdentifier,ActiveDirectoryRights",
      "description": "Enumerate who can change ownership of an AD object - allows granting yourself full permissions",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "WRITEOWNER",
        "PRIVESC",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<OBJECT>",
          "description": "AD object to check",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "flag_explanations": {
        "-match \"WriteOwner\"": "Regex filter for WriteOwner permission."
      },
      "success_indicators": [
        "SecurityIdentifier",
        "WriteOwner",
        "SIDs with ownership change rights"
      ],
      "failure_indicators": [
        "No matching ACEs",
        "Module not imported"
      ],
      "next_steps": [
        "Convert SIDs to names",
        "Abuse WriteOwner: (1) Set-DomainObjectOwner -Identity <OBJECT> -OwnerIdentity <YOUR_USER>, (2) Grant yourself GenericAll, (3) Abuse full control"
      ],
      "alternatives": [
        "Check for WriteDACL - similar privilege escalation path"
      ],
      "prerequisites": [
        "Import PowerView",
        "powerview-get-objectacl"
      ],
      "troubleshooting": {
        "No results": "Try WriteDACL or GenericAll instead"
      },
      "notes": "WriteOwner = Can change the owner of an AD object. Object owners have implicit rights to modify the object's ACL (permissions). Attack path: (1) You have WriteOwner on target object, (2) Change owner to yourself: Set-DomainObjectOwner, (3) As owner, grant yourself GenericAll, (4) Abuse full control (add to group, reset password, etc.). Similar to WriteDACL but requires two steps instead of one. OSCP: WriteOwner on privileged group = privilege escalation path.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-find-interestingdomainacl",
      "name": "Find Interesting ACL Misconfigurations (PowerView)",
      "category": "enumeration",
      "command": "Find-InterestingDomainAcl -ResolveGUIDs | ? {$_.IdentityReferenceName -match \"<USERNAME>\"}",
      "description": "Automatically discover ACL misconfigurations where specified user has dangerous permissions on other objects",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "AUTOMATED",
        "PRIVESC",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Your compromised username to check permissions for",
          "example": "stephanie",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ResolveGUIDs": "Resolves GUIDs to human-readable permission names.",
        "? {$_.IdentityReferenceName -match \"<USERNAME>\"}": "Filters results to only show permissions YOUR user has on other objects."
      },
      "success_indicators": [
        "IdentityReferenceName",
        "ObjectDN",
        "ActiveDirectoryRights",
        "Permissions found"
      ],
      "failure_indicators": [
        "No interesting ACLs found",
        "Module not imported"
      ],
      "next_steps": [
        "Review ActiveDirectoryRights for exploitation opportunities",
        "Check ObjectDN to identify high-value targets",
        "Abuse identified permissions with Add-DomainGroupMember or Set-DomainUserPassword"
      ],
      "alternatives": [
        "Manual enumeration: Get-ObjectAcl -Identity <TARGET> | ? {$_.SecurityIdentifier -eq <YOUR_SID>}"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "Long execution time": "Command queries entire domain. For faster results, query specific objects with Get-ObjectAcl"
      },
      "notes": "Find-InterestingDomainAcl automates ACL enumeration by scanning the entire domain for dangerous permissions. Returns interesting rights: GenericAll, WriteDACL, WriteOwner, ForceChangePassword, etc. IdentityReferenceName = who has the permission (filter for your user). ObjectDN = what object they have permission on (look for privileged groups/users). Slow in large domains - consider manual enumeration of specific high-value targets instead. OSCP: Run this early to identify all potential privilege escalation paths via ACL abuse.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-pathacl",
      "name": "Get Share Path ACL (PowerView)",
      "category": "enumeration",
      "command": "Get-PathAcl -Path \"\\\\<TARGET>\\<SHARE>\"",
      "description": "Enumerate file share permissions to identify accessible or misconfigured shares",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "SHARES",
        "PERMISSIONS",
        "OSCP:MEDIUM"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "DC1.corp.com",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "Share name",
          "example": "SYSVOL",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Path",
        "IdentityReference",
        "FileSystemRights",
        "Share permissions displayed"
      ],
      "failure_indicators": [
        "Access Denied",
        "Path not found",
        "Module not imported"
      ],
      "next_steps": [
        "Check for writable shares: FullControl, Modify, Write",
        "Look for sensitive data in accessible shares",
        "Check SYSVOL for GPP passwords"
      ],
      "alternatives": [
        "icacls \\\\<TARGET>\\<SHARE>",
        "Get-Acl -Path \\\\<TARGET>\\<SHARE> | Format-List"
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "Access Denied": "No read permissions on share. Try other shares: Find-DomainShare -CheckShareAccess"
      },
      "notes": "Get-PathAcl shows NTFS permissions on network shares. FileSystemRights shows permission level: FullControl (read/write/delete), Modify (read/write), ReadAndExecute (read/execute), etc. IdentityReference shows who has access (users/groups). Common misconfiguration: Everyone or Authenticated Users with Modify/FullControl on sensitive shares. SYSVOL share (domain-wide readable) may contain GPP passwords (cpassword attribute). OSCP: Check all discovered shares for misconfigurations and sensitive data.",
      "oscp_relevance": "medium"
    },
    {
      "id": "powerview-get-objectacl-user",
      "name": "Get User Object ACL (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity \"<USERNAME>\" | select SecurityIdentifier,ActiveDirectoryRights",
      "description": "Enumerate who has permissions on a specific user account",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Target username to check permissions on",
          "example": "sqlservice",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Identity": "Target object (user, group, computer) to check ACL on. Accepts username, DN, or SID."
      },
      "success_indicators": [
        "SecurityIdentifier",
        "ActiveDirectoryRights"
      ],
      "failure_indicators": [
        "Get-ObjectAcl not recognized",
        "Object not found"
      ],
      "next_steps": [
        "Convert SID to name: Convert-SidToName <SID>"
      ],
      "alternatives": [
        "dsacls \"<USER_DN>\""
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {
        "Object not found": "Verify username: Get-NetUser -Identity <USERNAME>"
      },
      "notes": "Identifies who can modify the user account. Look for: GenericAll (full control), WriteDACL (can change permissions), ForceChangePassword (can reset password).",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-objectacl-group",
      "name": "Get Group Object ACL (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity \"<GROUPNAME>\" | select SecurityIdentifier,ActiveDirectoryRights",
      "description": "Enumerate who has permissions on a specific group (e.g., Domain Admins)",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "GROUPS",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<GROUPNAME>",
          "description": "Target group name to check permissions on",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Identity": "Target group to enumerate ACL. Use quotes for names with spaces."
      },
      "success_indicators": [
        "SecurityIdentifier",
        "ActiveDirectoryRights"
      ],
      "failure_indicators": [
        "Get-ObjectAcl not recognized",
        "Group not found"
      ],
      "next_steps": [
        "Check if you can add members: if GenericAll or WriteProperty on 'member' attribute"
      ],
      "alternatives": [
        "dsacls \"<GROUP_DN>\""
      ],
      "prerequisites": [
        "Import PowerView"
      ],
      "troubleshooting": {},
      "notes": "Critical for privilege escalation. GenericAll on Domain Admins = you can add yourself to the group. Common misconfiguration.",
      "oscp_relevance": "high"
    }
  ]
}