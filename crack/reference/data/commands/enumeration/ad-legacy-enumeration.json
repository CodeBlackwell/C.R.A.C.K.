{
  "category": "enumeration",
  "description": "Active Directory enumeration using legacy Windows tools (net.exe, setspn.exe, dsquery.exe)",
  "commands": [
    {
      "id": "net-user-domain-list",
      "name": "List All Domain Users",
      "category": "enumeration",
      "command": "net user /domain",
      "description": "Enumerate all user accounts in the domain using built-in net.exe",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN",
        "USERS",
        "LEGACY",
        "STARTER",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "/domain": "Queries the domain controller instead of the local machine. Required to enumerate domain users rather than local accounts. Works from any domain-joined machine without special privileges."
      },
      "success_indicators": [
        "User accounts for \\\\",
        "The command completed successfully"
      ],
      "failure_indicators": [
        "The request will be processed at a domain controller",
        "System error 1355",
        "Network path was not found",
        "Access is denied"
      ],
      "next_steps": [
        "net-user-domain-detail"
      ],
      "alternatives": [
        "get-netuser"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "System error 1355": "DC unreachable. Verify domain membership: systeminfo | findstr /B /C:\"Domain\"",
        "Access is denied": "Requires domain user credentials. Verify authentication: whoami /user",
        "Network path was not found": "DNS resolution issue. Ping DC: ping <DC>"
      },
      "notes": "Built-in Windows tool, available on all Windows versions. Works without PowerShell or special privileges. Returns only usernames, not detailed attributes. OSCP: Use this first to get quick user list, then enumerate specific users with net-user-domain-detail.",
      "oscp_relevance": "high"
    },
    {
      "id": "net-user-domain-detail",
      "name": "Get Specific Domain User Details",
      "category": "enumeration",
      "command": "net user <USERNAME> /domain",
      "description": "Retrieve detailed information about a specific domain user including group memberships, password policy, and logon information",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN",
        "USERS",
        "LEGACY",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Domain username to enumerate",
          "example": "administrator",
          "required": true
        }
      ],
      "flag_explanations": {
        "/domain": "Queries the domain controller for the user account. Without this flag, net.exe searches for a local user account only."
      },
      "success_indicators": [
        "User name",
        "Full Name",
        "Local Group Memberships",
        "Global Group memberships",
        "The command completed successfully"
      ],
      "failure_indicators": [
        "The user name could not be found",
        "System error 1355",
        "Access is denied"
      ],
      "next_steps": [
        "net-group-domain-members",
        "If user in Domain Admins: prioritize as high-value target",
        "Check Password last set - old passwords may be weaker",
        "Check Last logon - dormant accounts = less detection"
      ],
      "alternatives": [],
      "prerequisites": [
        "net-user-domain-list"
      ],
      "troubleshooting": {
        "User name could not be found": "Verify spelling. List all users first: net user /domain",
        "System error 1355": "DC unreachable. Check network connectivity to domain controller"
      },
      "notes": "Reveals critical information: group memberships (Domain Admins?), password age (weak password?), last logon (dormant account?). Look for admin accounts with naming patterns like 'admin', 'svc', or 'service'. OSCP: Check 'Local Group Memberships' for Administrators - indicates local admin rights on domain computers.",
      "oscp_relevance": "high"
    },
    {
      "id": "net-group-domain-list",
      "name": "List All Domain Groups",
      "category": "enumeration",
      "command": "net group /domain",
      "description": "Enumerate all security groups in the domain",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN",
        "GROUPS",
        "LEGACY",
        "STARTER",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "/domain": "Queries domain groups instead of local groups. Essential for enumerating domain-wide security groups that may grant elevated privileges."
      },
      "success_indicators": [
        "Group Accounts for \\\\",
        "*Domain Admins",
        "*Enterprise Admins",
        "The command completed successfully"
      ],
      "failure_indicators": [
        "System error 1355",
        "Access is denied",
        "Network path was not found"
      ],
      "next_steps": [
        "net-group-domain-members",
        "Prioritize: Domain Admins, Enterprise Admins, Administrators",
        "Look for custom groups (Development, IT, Management) - may have elevated access"
      ],
      "alternatives": [
        "get-netgroup"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "System error 1355": "Cannot contact DC. Verify domain membership and network connectivity"
      },
      "notes": "Default groups (Domain Admins, Enterprise Admins) indicate high-privilege accounts. Custom groups may reveal organizational structure and potential privilege escalation paths. OSCP: Focus on groups with 'Admin', 'IT', 'Service', or 'Management' in the name - often have elevated permissions.",
      "oscp_relevance": "high"
    },
    {
      "id": "net-group-domain-members",
      "name": "List Members of Specific Domain Group",
      "category": "enumeration",
      "command": "net group \"<GROUPNAME>\" /domain",
      "description": "Enumerate all members of a specific domain group to identify high-value targets",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN",
        "GROUPS",
        "LEGACY",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<GROUPNAME>",
          "description": "Domain group name (use quotes if spaces)",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "flag_explanations": {
        "/domain": "Queries domain group membership instead of local groups. Critical for identifying users with domain-level privileges."
      },
      "success_indicators": [
        "Group name",
        "Comment",
        "Members",
        "The command completed successfully"
      ],
      "failure_indicators": [
        "The group name could not be found",
        "System error 1355",
        "Access is denied"
      ],
      "next_steps": [
        "net-user-domain-detail",
        "Enumerate each member to find attack paths",
        "Check for nested groups (groups within groups)"
      ],
      "alternatives": [],
      "prerequisites": [
        "net-group-domain-list"
      ],
      "troubleshooting": {
        "Group name could not be found": "Use quotes for group names with spaces. Verify exact name: net group /domain",
        "Nested groups not showing users": "net.exe only shows direct members. Use PowerView to unravel nested groups: Get-NetGroupMember -Recurse"
      },
      "notes": "CRITICAL: net.exe only lists user objects, NOT nested group objects. If you see a group member that looks like a username but net user <USERNAME> /domain fails, it's likely a nested group. Use PowerView or manual LDAP queries to enumerate nested groups. OSCP: Domain Admins members = instant win if compromised.",
      "oscp_relevance": "high"
    },
    {
      "id": "net-accounts-domain",
      "name": "Get Domain Password Policy",
      "category": "enumeration",
      "command": "net accounts /domain",
      "description": "Retrieve domain password policy including minimum length, complexity, lockout threshold, and password age requirements",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN",
        "PASSWORD_POLICY",
        "LEGACY",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "/domain": "Queries domain password policy instead of local machine policy. Essential for planning password attacks without triggering account lockouts."
      },
      "success_indicators": [
        "Minimum password length",
        "Maximum password age",
        "Lockout threshold",
        "Lockout duration",
        "The command completed successfully"
      ],
      "failure_indicators": [
        "System error 1355",
        "Access is denied"
      ],
      "next_steps": [
        "Plan password attacks based on policy",
        "If lockout threshold = 0: unlimited guessing attempts",
        "If lockout threshold = 5: limit to 3-4 attempts per user",
        "Create wordlist matching password requirements"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "System error 1355": "Cannot contact DC. Verify domain connectivity"
      },
      "notes": "CRITICAL for OSCP password attacks. Key fields: (1) Lockout threshold - how many failed attempts before lockout. (2) Lockout duration - how long account stays locked. (3) Minimum password length - shortest password allowed. (4) Password complexity - uppercase, lowercase, numbers, symbols required. OSCP: If lockout threshold is 0 (unlimited attempts), you can brute force freely. If threshold is 5, limit to 2-3 attempts per account to avoid detection.",
      "oscp_relevance": "high"
    },
    {
      "id": "setspn-list-user",
      "name": "List SPNs for Specific User",
      "category": "enumeration",
      "command": "setspn -L <USERNAME>",
      "description": "List Service Principal Names (SPNs) associated with a specific user account to identify service accounts and potential Kerberoasting targets",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "SPN",
        "KERBEROASTING",
        "SERVICE_ACCOUNTS",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Domain user account to query for SPNs",
          "example": "svc_sql",
          "required": true
        }
      ],
      "flag_explanations": {
        "-L": "List SPNs registered for the specified user account. SPNs indicate the account is used to run services and may have elevated privileges."
      },
      "success_indicators": [
        "Registered ServicePrincipalNames for",
        "HTTP/",
        "MSSQLSvc/",
        "No such object"
      ],
      "failure_indicators": [
        "No Such User Exists",
        "Access Denied"
      ],
      "next_steps": [
        "If SPNs found: request Kerberos service ticket",
        "Kerberoast the account: Rubeus.exe kerberoast /user:<USERNAME>",
        "Crack ticket offline: hashcat -m 13100 ticket.txt wordlist.txt",
        "Identify service type from SPN (HTTP=web, MSSQLSvc=database)"
      ],
      "alternatives": [],
      "prerequisites": [
        "net-user-domain-list"
      ],
      "troubleshooting": {
        "No such object": "User does not exist. Check spelling: net user /domain",
        "No SPNs registered": "Account is not a service account. Try other users with 'svc', 'service', or 'sql' in username"
      },
      "notes": "Service accounts often have elevated privileges (local admin, database access) and weak passwords (rarely changed). SPN format: ServiceClass/Host:Port/ServiceName. Common ServiceClass values: HTTP (web servers), MSSQLSvc (SQL Server), TERMSRV (RDP), HOST (multiple services). OSCP: Kerberoasting is a reliable offline attack - request service ticket, crack offline, no account lockout risk.",
      "oscp_relevance": "high"
    },
    {
      "id": "setspn-query-all",
      "name": "Query All SPNs in Domain",
      "category": "enumeration",
      "command": "setspn -Q */*",
      "description": "Enumerate all Service Principal Names registered in the domain to discover service accounts and services",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "SPN",
        "KERBEROASTING",
        "SERVICE_ACCOUNTS",
        "DISCOVERY",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "-Q": "Query mode - searches for SPNs matching the specified pattern.",
        "*/*": "Wildcard pattern matching all SPNs in the format ServiceClass/Host. Returns every service registered in the domain."
      },
      "success_indicators": [
        "CN=",
        "HTTP/",
        "MSSQLSvc/",
        "Existing SPN found!"
      ],
      "failure_indicators": [
        "No such SPN found",
        "Access Denied"
      ],
      "next_steps": [
        "Filter for interesting SPNs: HTTP, MSSQLSvc, TERMSRV, HOST",
        "Extract associated usernames from CN= lines",
        "setspn-list-user for each account",
        "Prioritize Kerberoasting targets"
      ],
      "alternatives": [
        "get-netuser"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Output too large": "Pipe to file: setspn -Q */* > spns.txt. Then search: findstr /I \"MSSQLSvc HTTP\" spns.txt",
        "No such SPN found": "No services registered in domain (unlikely). Verify domain connectivity."
      },
      "notes": "Reveals internal services and their hostnames/ports without port scanning. Example output: 'MSSQLSvc/DB01.corp.com:1433' indicates SQL Server on DB01 port 1433. Service accounts typically have SPNs and are high-value Kerberoasting targets. OSCP: Focus on SQL Server (MSSQLSvc), IIS (HTTP), and Exchange (exchangeMDB) SPNs - often have admin privileges.",
      "oscp_relevance": "high"
    },
    {
      "id": "dsquery-user",
      "name": "Query Domain Users with dsquery",
      "category": "enumeration",
      "command": "dsquery user",
      "description": "Query Active Directory for user objects using dsquery (built-in AD query tool)",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN",
        "USERS",
        "LEGACY",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {
        "user": "Searches for user objects in Active Directory. Returns distinguished names (DN) in LDAP format."
      },
      "success_indicators": [
        "\"CN=",
        ",CN=Users,DC=",
        "Distinguished Name format"
      ],
      "failure_indicators": [
        "dsquery is not recognized",
        "Access Denied",
        "Failed to connect to domain"
      ],
      "next_steps": [
        "dsget user <DN> -samid -desc -memberof",
        "Extract samaccountname from CN= field",
        "net-user-domain-detail for specific users"
      ],
      "alternatives": [
        "net-user-domain-list",
        "get-netuser"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "dsquery is not recognized": "Not installed. dsquery requires Remote Server Administration Tools (RSAT). Use net.exe instead: net user /domain",
        "Access Denied": "Requires domain user credentials. Standard domain users can query user objects.",
        "Failed to connect": "DC unreachable. Verify domain connectivity: ping <DC>"
      },
      "notes": "dsquery is part of Windows Server RSAT and may not be available on all Windows clients. Returns Distinguished Names (LDAP format) instead of usernames, requiring additional parsing. For OSCP, net.exe is more reliable as it's installed by default on all Windows versions. dsquery is useful when you need LDAP-formatted queries or when net.exe is restricted by policy.",
      "oscp_relevance": "medium"
    },
    {
      "id": "dsquery-computer",
      "name": "Query Domain Computers with dsquery",
      "category": "enumeration",
      "command": "dsquery computer",
      "description": "Query Active Directory for computer objects to enumerate domain-joined machines",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN",
        "COMPUTERS",
        "LEGACY",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {
        "computer": "Searches for computer objects in Active Directory. Returns distinguished names of all domain-joined computers including workstations, servers, and domain controllers."
      },
      "success_indicators": [
        "\"CN=",
        ",CN=Computers,DC=",
        ",OU=Domain Controllers,DC=",
        "Distinguished Name format"
      ],
      "failure_indicators": [
        "dsquery is not recognized",
        "Access Denied",
        "Failed to connect to domain"
      ],
      "next_steps": [
        "dsget computer <DN> -name -desc",
        "Extract hostnames for targeting",
        "Identify domain controllers: dsquery computer -name DC*"
      ],
      "alternatives": [
        "get-netcomputer"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "dsquery is not recognized": "RSAT not installed. Use alternative: Get-NetComputer or network scanning",
        "Access Denied": "Standard domain users should have read access. Verify credentials: whoami /user"
      },
      "notes": "Reveals all domain-joined computers without network scanning. Domain Controllers are in 'OU=Domain Controllers', servers/workstations in 'CN=Computers' or custom OUs. Extract hostname from CN= field. OSCP: Less useful than net.exe or PowerView since output requires parsing. Use when net.exe is restricted or you need to query specific OUs with -startnode flag.",
      "oscp_relevance": "medium"
    },
    {
      "id": "dsquery-group",
      "name": "Query Domain Groups with dsquery",
      "category": "enumeration",
      "command": "dsquery group",
      "description": "Query Active Directory for group objects to enumerate security groups",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN",
        "GROUPS",
        "LEGACY",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {
        "group": "Searches for group objects in Active Directory. Returns distinguished names of all security and distribution groups."
      },
      "success_indicators": [
        "\"CN=",
        ",CN=Users,DC=",
        "CN=Domain Admins",
        "Distinguished Name format"
      ],
      "failure_indicators": [
        "dsquery is not recognized",
        "Access Denied"
      ],
      "next_steps": [
        "dsget group <DN> -samid -members",
        "Focus on: Domain Admins, Enterprise Admins, Administrators",
        "net-group-domain-members for clean output"
      ],
      "alternatives": [
        "net-group-domain-list",
        "get-netgroup"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "dsquery is not recognized": "Use net group /domain instead",
        "Output too verbose": "Filter for admin groups: dsquery group -name \"*admin*\""
      },
      "notes": "Returns LDAP distinguished names which require parsing. net.exe provides cleaner output. Use dsquery when you need to query specific OUs or when net.exe is restricted. OSCP: Stick with net group /domain for exam - faster and cleaner output.",
      "oscp_relevance": "medium"
    },
    {
      "id": "net-group-domain-admins",
      "name": "List Domain Admins Group Members",
      "category": "enumeration",
      "command": "net group \"Domain Admins\" /domain",
      "description": "Enumerate members of Domain Admins group using built-in net.exe",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN_ADMINS",
        "GROUPS",
        "LEGACY",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "/domain": "Queries the domain controller for group membership. Required to see domain group members rather than local groups."
      },
      "success_indicators": [
        "Group name",
        "Members",
        "The command completed successfully"
      ],
      "failure_indicators": [
        "System error 1355",
        "Group name could not be found",
        "Access is denied"
      ],
      "next_steps": [
        "net-user-domain-detail"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "Group name could not be found": "Verify group exists: net group /domain"
      },
      "notes": "Critical for identifying privileged accounts. Domain Admins have full control over the domain.",
      "oscp_relevance": "high"
    },
    {
      "id": "net-group-domain-computers",
      "name": "List Domain Computers Group",
      "category": "enumeration",
      "command": "net group \"Domain Computers\" /domain",
      "description": "Enumerate computer accounts in the domain",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "COMPUTERS",
        "LEGACY",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {
        "/domain": "Queries domain controller for computer accounts"
      },
      "success_indicators": [
        "Group name",
        "Members"
      ],
      "failure_indicators": [
        "System error",
        "Access denied"
      ],
      "next_steps": [],
      "alternatives": [
        "get-netcomputer"
      ],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Shows all computer accounts in the domain. Computer names end with $.",
      "oscp_relevance": "medium"
    },
    {
      "id": "net-domain-controllers",
      "name": "Identify Domain Controllers",
      "category": "enumeration",
      "command": "nltest /dclist:<DOMAIN>",
      "description": "List all domain controllers in the domain using nltest",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN_CONTROLLERS",
        "LEGACY",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "corp.com",
          "required": true
        }
      ],
      "flag_explanations": {
        "/dclist": "Lists all domain controllers in the specified domain"
      },
      "success_indicators": [
        "PDC",
        "List of DCs"
      ],
      "failure_indicators": [
        "Cannot find domain",
        "Access denied"
      ],
      "next_steps": [],
      "alternatives": [
        "net-domain-controllers"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Cannot find domain": "Verify domain name with: systeminfo | findstr Domain"
      },
      "notes": "Domain controllers are primary targets for enumeration and attacks. PDC holds master copy of domain database.",
      "oscp_relevance": "high"
    },
    {
      "id": "setspn-list-all",
      "name": "List All SPNs in Domain",
      "category": "enumeration",
      "command": "setspn -T <DOMAIN> -Q */*",
      "description": "Enumerate all Service Principal Names (SPNs) in the domain for Kerberoasting",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "SPN",
        "KERBEROASTING",
        "LEGACY",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "corp.com",
          "required": true
        }
      ],
      "flag_explanations": {
        "-T": "Specifies the target domain to query",
        "-Q": "Queries for SPNs. */* wildcard matches all service types and hosts"
      },
      "success_indicators": [
        "CN=",
        "servicePrincipalName"
      ],
      "failure_indicators": [
        "No SPNs found",
        "Access denied",
        "RPC server unavailable"
      ],
      "next_steps": [
        "Request TGS tickets for discovered SPNs"
      ],
      "alternatives": [
        "get-netuser"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "RPC server unavailable": "DC unreachable. Check connectivity: ping <DC>"
      },
      "notes": "SPNs identify service accounts. User accounts with SPNs are Kerberoastable (can request TGS tickets and crack offline). Focus on user accounts, not computer accounts.",
      "oscp_relevance": "high"
    },
    {
      "id": "dsquery-users",
      "name": "Query All Domain Users (dsquery)",
      "category": "enumeration",
      "command": "dsquery user",
      "description": "LDAP query for all user objects in the domain using dsquery",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "USERS",
        "DSQUERY",
        "LEGACY",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "CN=",
        "OU=",
        "DC="
      ],
      "failure_indicators": [
        "dsquery is not recognized",
        "Access denied"
      ],
      "next_steps": [
        "dsget user <DN> -samid -desc"
      ],
      "alternatives": [
        "get-netuser"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "dsquery is not recognized": "Tool requires RSAT (Remote Server Administration Tools) or run from DC"
      },
      "notes": "Returns distinguished names (DNs), not usernames. Pipe to dsget for readable output: dsquery user | dsget user -samid -desc",
      "oscp_relevance": "medium"
    },
    {
      "id": "dsquery-computers",
      "name": "Query All Domain Computers (dsquery)",
      "category": "enumeration",
      "command": "dsquery computer",
      "description": "LDAP query for all computer objects in the domain",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "COMPUTERS",
        "DSQUERY",
        "LEGACY",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "CN=",
        "OU="
      ],
      "failure_indicators": [
        "dsquery is not recognized"
      ],
      "next_steps": [],
      "alternatives": [
        "get-netcomputer"
      ],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Returns DNs. Convert to hostnames: dsquery computer | dsget computer -name",
      "oscp_relevance": "medium"
    },
    {
      "id": "dsquery-admins",
      "name": "Query Domain Admins Group (dsquery)",
      "category": "enumeration",
      "command": "dsquery group -name \"Domain Admins\" | dsget group -members",
      "description": "Query Domain Admins group and list all members",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN_ADMINS",
        "DSQUERY",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "-name": "Filter groups by name",
        "-members": "List all members of the group"
      },
      "success_indicators": [
        "CN=",
        "members"
      ],
      "failure_indicators": [
        "dsquery is not recognized",
        "No members found"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Two-stage query: dsquery finds the group DN, dsget extracts members. Returns member DNs.",
      "oscp_relevance": "high"
    },
    {
      "id": "dsquery-domain-controllers",
      "name": "Query Domain Controllers (dsquery)",
      "category": "enumeration",
      "command": "dsquery server",
      "description": "Query all domain controllers in the forest",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN_CONTROLLERS",
        "DSQUERY",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "CN=",
        "Sites"
      ],
      "failure_indicators": [
        "dsquery is not recognized"
      ],
      "next_steps": [],
      "alternatives": [
        "net-domain-controllers"
      ],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Returns DC distinguished names with site information.",
      "oscp_relevance": "high"
    }
  ]
}