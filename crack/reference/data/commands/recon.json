{
  "category": "recon",
  "description": "Network reconnaissance and enumeration commands",
  "commands": [
    {
      "id": "nmap-ping-sweep",
      "name": "Network Ping Sweep",
      "category": "recon",
      "command": "nmap -sn <TARGET_SUBNET>",
      "description": "Discover live hosts on a network without port scanning",
      "tags": [
        "DISCOVERY",
        "ENUM",
        "ENUMERATION",
        "NETWORK",
        "NMAP",
        "NOISY",
        "OSCP:HIGH",
        "QUICK_WIN",
        "RECONNAISSANCE",
        "STARTER"
      ],
      "variables": [
        {
          "name": "<TARGET_SUBNET>",
          "description": "Target network in CIDR notation",
          "example": "192.168.1.0/24",
          "required": true
        }
      ],
      "flag_explanations": {
        "-sn": "Ping scan only - disables port scanning to quickly identify live hosts"
      },
      "success_indicators": [
        "Host is up",
        "MAC Address:",
        "Nmap done: X IP addresses (Y hosts up)"
      ],
      "failure_indicators": [
        "0 hosts up",
        "Host seems down",
        "Note: Host seems down"
      ],
      "next_steps": [
        "Run full port scan on discovered hosts: nmap -p- <IP>",
        "Perform service enumeration: nmap -sV -sC <IP>",
        "Check for specific services (SMB, HTTP, SSH)"
      ],
      "alternatives": [
        "fping -a -g <TARGET_SUBNET>",
        "arp-scan -l"
      ],
      "notes": "Use -sn for host discovery only, no port scan",
      "oscp_relevance": "high"
    },
    {
      "id": "nmap-quick-scan",
      "name": "Quick Full Port Scan",
      "category": "recon",
      "command": "nmap -Pn -p- --min-rate=<RATE> <TARGET> -oA <OUTPUT>",
      "description": "Fast scan of all 65535 ports",
      "tags": [
        "ENUM",
        "ENUMERATION",
        "FAST",
        "NETWORK",
        "NMAP",
        "NOISY",
        "OSCP:HIGH",
        "RECONNAISSANCE",
        "STARTER"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.1.100",
          "required": true
        },
        {
          "name": "<RATE>",
          "description": "Packets per second",
          "example": "1000",
          "required": false
        },
        {
          "name": "<OUTPUT>",
          "description": "Output filename base",
          "example": "quick_scan",
          "required": false
        }
      ],
      "flag_explanations": {
        "-Pn": "Skip host discovery - assume host is up (useful when ICMP blocked)",
        "-p-": "Scan all ports (1-65535) instead of default 1000 common ports",
        "--min-rate": "Minimum packet transmission rate per second for speed",
        "-oA": "Output in all formats (normal, XML, grepable) for documentation"
      },
      "success_indicators": [
        "open port",
        "Discovered open port",
        "/tcp open",
        "/udp open"
      ],
      "failure_indicators": [
        "Host seems down",
        "All 65535 scanned ports are closed",
        "0 hosts up"
      ],
      "next_steps": [
        "Service scan on open ports: nmap -sV -sC -p <PORTS> <TARGET>",
        "UDP scan if needed: nmap -sU --top-ports 20 <TARGET>",
        "Vulnerability scripts: nmap --script vuln -p <PORTS> <TARGET>"
      ],
      "alternatives": [
        "masscan -p1-65535 <TARGET>",
        "rustscan -a <TARGET>"
      ],
      "notes": "Adjust --min-rate based on network stability",
      "oscp_relevance": "high"
    },
    {
      "id": "nmap-service-scan",
      "name": "Service Version Detection",
      "category": "recon",
      "command": "nmap -sV -sC -p <PORTS> <TARGET> -oA <OUTPUT>",
      "description": "Detailed service enumeration with default scripts",
      "tags": [
        "DETAILED",
        "DISCOVERY",
        "ENUM",
        "ENUMERATION",
        "NMAP",
        "NOISY",
        "OSCP:HIGH",
        "PERSISTENCE",
        "RECONNAISSANCE"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.1.100",
          "required": true
        },
        {
          "name": "<PORTS>",
          "description": "Ports to scan",
          "example": "80,443,22,21",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output filename base",
          "example": "service_scan",
          "required": false
        }
      ],
      "flag_explanations": {
        "-sV": "Service version detection - probe open ports to determine service/version",
        "-sC": "Default NSE scripts - runs safe scripts for enumeration",
        "-p": "Specify ports to scan (comma-separated or range)",
        "-oA": "Output in all formats for documentation and analysis"
      },
      "success_indicators": [
        "Service Info:",
        "VERSION:",
        "Service detection performed",
        "SF-Port"
      ],
      "failure_indicators": [
        "All scanned ports are closed",
        "Service scan Timing",
        "0 services on 0 hosts"
      ],
      "next_steps": [
        "Research service versions for vulnerabilities: searchsploit <service>",
        "Web enumeration if HTTP found: gobuster dir -u http://<IP>",
        "SMB enumeration if 445 open: enum4linux -a <IP>",
        "SSH brute if 22 open: hydra -L users -P pass ssh://<IP>"
      ],
      "alternatives": [
        "nmap -A <TARGET>",
        "unicornscan -mS <TARGET>"
      ],
      "notes": "Use after quick scan to investigate open ports",
      "oscp_relevance": "high"
    },
    {
      "id": "nmap-vuln-scan",
      "name": "Vulnerability Scan",
      "category": "recon",
      "command": "nmap --script vuln -p <PORTS> <TARGET>",
      "description": "Run vulnerability detection scripts",
      "tags": [
        "AUTOMATED",
        "ENUM",
        "ENUMERATION",
        "NMAP",
        "NOISY",
        "RECONNAISSANCE",
        "VULN"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.1.100",
          "required": true
        },
        {
          "name": "<PORTS>",
          "description": "Ports to check",
          "example": "80,443,445",
          "required": true
        }
      ],
      "flag_explanations": {
        "--script": "Run NSE scripts - 'vuln' category runs all vulnerability scripts",
        "-p": "Target specific ports for vulnerability scanning"
      },
      "success_indicators": [
        "VULNERABLE:",
        "State: VULNERABLE",
        "CVE-",
        "MS17-010"
      ],
      "failure_indicators": [
        "NOT VULNERABLE",
        "Could not find",
        "No vulnerabilities found"
      ],
      "next_steps": [
        "Research found CVEs: searchsploit <CVE>",
        "Check Metasploit: msfconsole; search <vulnerability>",
        "Manual verification of vulnerabilities",
        "Try specific vuln scripts: --script smb-vuln-ms17-010"
      ],
      "alternatives": [
        "nmap --script smb-vuln* <TARGET>",
        "nessus scan",
        "openvas"
      ],
      "notes": "Can be slow, use specific scripts for better performance",
      "oscp_relevance": "medium"
    },
    {
      "id": "dns-enum",
      "name": "DNS Enumeration",
      "category": "recon",
      "command": "dnsrecon -d <DOMAIN> -t std",
      "description": "Standard DNS enumeration",
      "tags": [
        "DISCOVERY",
        "DNS",
        "ENUM",
        "ENUMERATION",
        "OSCP:MEDIUM",
        "RECONNAISSANCE"
      ],
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Target domain",
          "example": "example.com",
          "required": true
        }
      ],
      "flag_explanations": {
        "-d": "Target domain to enumerate",
        "-t": "Type of enumeration - 'std' performs standard record queries"
      },
      "success_indicators": [
        "[*] A",
        "[*] MX",
        "[*] NS",
        "[*] TXT"
      ],
      "failure_indicators": [
        "No records found",
        "SERVFAIL",
        "NXDOMAIN"
      ],
      "next_steps": [
        "Try zone transfer: dnsrecon -d <DOMAIN> -t axfr",
        "Subdomain brute: gobuster dns -d <DOMAIN> -w wordlist",
        "Check for virtual hosts on discovered IPs",
        "Reverse DNS on IP ranges: dnsrecon -r <RANGE>"
      ],
      "alternatives": [
        "dnsenum <DOMAIN>",
        "fierce --domain <DOMAIN>",
        "host -t axfr <DOMAIN> <NS>"
      ],
      "notes": "Try zone transfer with -t axfr if allowed",
      "oscp_relevance": "medium"
    },
    {
      "id": "smb-enum",
      "name": "SMB Enumeration",
      "category": "recon",
      "command": "enum4linux -a <TARGET>",
      "description": "Comprehensive SMB/NetBIOS enumeration",
      "tags": [
        "DISCOVERY",
        "ENUM",
        "ENUM4LINUX",
        "ENUMERATION",
        "NOISY",
        "OSCP:HIGH",
        "QUICK_WIN",
        "RECONNAISSANCE",
        "SAMBA",
        "SMB"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.1.100",
          "required": true
        }
      ],
      "flag_explanations": {
        "-a": "All enumeration - combines -U -S -G -P -r -o -n -i (users, shares, groups, password policy, etc.)"
      },
      "success_indicators": [
        "Share Enumeration",
        "\\\\\\\\<IP>\\\\",
        "Mapping: OK",
        "Username",
        "WORKGROUP\\\\"
      ],
      "failure_indicators": [
        "Server doesn't allow session",
        "NT_STATUS_ACCESS_DENIED",
        "Connection refused",
        "Could not connect"
      ],
      "next_steps": [
        "Try null session: smbclient -L //<IP> -N",
        "Mount shares: mount -t cifs //<IP>/<share> /mnt",
        "Check write access: smbmap -H <IP> -u guest",
        "Brute force: hydra -L users -P pass smb://<IP>"
      ],
      "alternatives": [
        "smbclient -L //<TARGET> -N",
        "smbmap -H <TARGET>",
        "crackmapexec smb <TARGET>"
      ],
      "notes": "Check for null sessions and guest access",
      "oscp_relevance": "high"
    },
    {
      "id": "snmp-enum",
      "name": "SNMP Enumeration",
      "category": "recon",
      "command": "snmpwalk -c <SNMP_COMMUNITY> -v2c <TARGET>",
      "description": "SNMP enumeration with community string",
      "tags": [
        "DISCOVERY",
        "ENUM",
        "ENUMERATION",
        "OSCP:MEDIUM",
        "RECONNAISSANCE",
        "SNMP"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.1.100",
          "required": true
        },
        {
          "name": "<SNMP_COMMUNITY>",
          "description": "SNMP community string",
          "example": "public",
          "required": true
        }
      ],
      "flag_explanations": {
        "-c": "Community string for authentication (like a password)",
        "-v2c": "SNMP version 2c - most common, supports bulk requests"
      },
      "success_indicators": [
        "iso.3.6.1",
        "SNMPv2-MIB",
        "HOST-RESOURCES-MIB",
        "sysDescr.0"
      ],
      "failure_indicators": [
        "Timeout",
        "No Response",
        "Unknown community"
      ],
      "next_steps": [
        "Extract user accounts: snmpwalk -c <SNMP_COMMUNITY> -v2c <IP> 1.3.6.1.4.1.77.1.2.25",
        "Get running processes: snmpwalk -c <SNMP_COMMUNITY> -v2c <IP> 1.3.6.1.2.1.25.4.2.1.2",
        "Try snmp-check for formatted output: snmp-check <IP>",
        "Brute community strings: onesixtyone -c wordlist <IP>"
      ],
      "alternatives": [
        "onesixtyone -c <WORDLIST> <TARGET>",
        "snmp-check <TARGET>",
        "snmpbulkwalk -c <SNMP_COMMUNITY> <TARGET>"
      ],
      "notes": "Try 'public' and 'private' as default community strings",
      "oscp_relevance": "medium"
    },
    {
      "id": "smb-null-session-shares",
      "name": "SMB Null Session Share Enumeration",
      "category": "recon",
      "command": "smbclient -N -L //<TARGET>",
      "description": "Enumerate SMB shares using null session authentication (anonymous access without credentials)",
      "tags": [
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "ENUM",
        "ENUMERATION",
        "NULL_SESSION",
        "OSCP:HIGH",
        "QUICK_WIN",
        "RECONNAISSANCE",
        "SAMBA",
        "SMB",
        "SMBCLIENT"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "192.168.45.100",
          "required": true
        }
      ],
      "flag_explanations": {
        "-N": "No password - attempts null session authentication (anonymous login without credentials)",
        "-L": "List available shares on the target server"
      },
      "success_indicators": [
        "Sharename",
        "IPC$",
        "Anonymous login successful",
        "Type",
        "Disk"
      ],
      "failure_indicators": [
        "NT_STATUS_ACCESS_DENIED",
        "NT_STATUS_LOGON_FAILURE",
        "Connection refused",
        "Protocol negotiation failed"
      ],
      "next_steps": [
        "smb-enum4linux-full",
        "smb-smbclient-connect",
        "smb-crackmapexec-shares"
      ],
      "alternatives": [
        "smb-smbmap-recursive",
        "smb-crackmapexec-shares"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "NT_STATUS_ACCESS_DENIED": "Null sessions disabled on target. Try guest authentication: smbclient -U guest%guest -L //<TARGET>",
        "Connection refused": "Port 445 filtered by firewall. Try legacy port 139: smbclient -p 139 -N -L //<TARGET>",
        "Protocol negotiation failed": "SMBv1 disabled on target. Specify minimum protocol version: smbclient -N -L //<TARGET> --option='client min protocol=SMB2'",
        "No shares visible": "Shares may be hidden from listing. Try connecting to common shares directly: C$, ADMIN$, IPC$, Users, Public"
      },
      "notes": "Null sessions often allowed on older Windows (pre-2000) and misconfigured Samba servers. This is the first step in SMB enumeration - always try before authenticated methods. Document all discovered shares in enumeration.md. Time estimate: 1-2 minutes. OSCP tip: If null session works, try accessing IPC$ for further enumeration with rpcclient.",
      "oscp_relevance": "high"
    },
    {
      "id": "smb-enum4linux-full",
      "name": "Comprehensive SMB Enumeration with enum4linux",
      "category": "recon",
      "command": "enum4linux -a <TARGET>",
      "description": "Comprehensive SMB/NetBIOS enumeration including users, shares, groups, password policy, OS info, and workgroup details",
      "tags": [
        "COMPREHENSIVE",
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "ENUM",
        "ENUM4LINUX",
        "ENUMERATION",
        "NOISY",
        "OSCP:HIGH",
        "RECONNAISSANCE",
        "SAMBA",
        "SMB"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "192.168.45.100",
          "required": true
        }
      ],
      "flag_explanations": {
        "-a": "All simple enumeration - combines: -U (users), -S (shares), -G (groups), -P (password policy), -r (RID cycling), -o (OS info), -n (NetBIOS), -i (printer info). This is the most thorough single-command SMB enumeration."
      },
      "success_indicators": [
        "Got domain/workgroup name:",
        "Share Enumeration",
        "Password Info for Domain:",
        "Users on",
        "Group Membership"
      ],
      "failure_indicators": [
        "Server doesn't allow session using username",
        "NT_STATUS_ACCESS_DENIED",
        "Could not connect",
        "Connection timed out"
      ],
      "next_steps": [
        "smb-smbclient-connect",
        "smb-smbmap-recursive",
        "smb-mount-share"
      ],
      "alternatives": [
        "smb-crackmapexec-shares",
        "smb-null-session-shares"
      ],
      "prerequisites": [
        "smb-null-session-shares"
      ],
      "troubleshooting": {
        "Access denied but null session worked": "Some info requires authentication. Get credentials and retry: enum4linux -u <USER> -p <PASS> -a <TARGET>",
        "RID cycling taking too long": "Cancel and run faster targeted queries: enum4linux -U <TARGET> (users only), enum4linux -S <TARGET> (shares only)",
        "No domain/workgroup info": "Target may be standalone. Focus on share and user enumeration instead of domain queries",
        "Connection timeout": "Port 445/139 may be rate-limited. Reduce scan speed or wait before retrying"
      },
      "notes": "enum4linux wraps multiple Samba tools (smbclient, rpcclient, net). Best used after confirming SMB is accessible. Time estimate: 3-5 minutes for full scan. Can be noisy - IDS may detect. Document findings in enumeration.md: workgroup name, users, shares, password policy (useful for credential attacks). OSCP tip: Look for shares with READ/WRITE access, weak password policies (no complexity, no lockout), and user lists for credential spraying.",
      "oscp_relevance": "high"
    },
    {
      "id": "smb-crackmapexec-shares",
      "name": "CrackMapExec SMB Share Enumeration",
      "category": "recon",
      "command": "crackmapexec smb <TARGET> -u <USERNAME> -p <PASSWORD> --shares",
      "description": "Enumerate SMB shares with authenticated access using CrackMapExec, showing detailed permission information",
      "tags": [
        "AUTHENTICATED",
        "CRACKMAPEXEC",
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "ENUM",
        "ENUMERATION",
        "OSCP:HIGH",
        "QUICK_WIN",
        "RECONNAISSANCE",
        "SAMBA",
        "SMB"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<USERNAME>",
          "description": "SMB username (or use '' for null session)",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "SMB password (or use '' for null session)",
          "example": "password123",
          "required": true
        }
      ],
      "flag_explanations": {
        "smb": "Target SMB protocol (port 445/139)",
        "-u": "Username for authentication (use '' or 'guest' for anonymous)",
        "-p": "Password for authentication (use '' for empty password or null session)",
        "--shares": "Enumerate all accessible shares and display READ/WRITE permissions"
      },
      "success_indicators": [
        "[+]",
        "READ",
        "WRITE",
        "SMB",
        "\\\\\\\\<IP>\\\\"
      ],
      "failure_indicators": [
        "[-] Error",
        "STATUS_LOGON_FAILURE",
        "STATUS_ACCESS_DENIED",
        "Connection error"
      ],
      "next_steps": [
        "smb-smbclient-connect",
        "smb-smbmap-recursive",
        "smb-mount-share"
      ],
      "alternatives": [
        "smb-smbmap-recursive",
        "smb-enum4linux-full"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Invalid credentials. Try null session: crackmapexec smb <TARGET> -u '' -p '' --shares",
        "No shares listed but command succeeds": "User authenticated but has no share access. Try different user or check for hidden shares: C$, ADMIN$",
        "Connection timeout": "Firewall blocking port 445. Try legacy port: crackmapexec smb <TARGET> -u <USER> -p <PASS> --shares --port 139",
        "Kerberos error": "Domain authentication failed. Use local auth: crackmapexec smb <TARGET> -u <USER> -p <PASS> --shares --local-auth"
      },
      "notes": "CrackMapExec is faster than enum4linux for share enumeration with known credentials. Shows explicit READ/WRITE permissions which is critical for exploitation planning. Time estimate: 30 seconds. OSCP tip: Look for non-standard shares (anything besides C$, ADMIN$, IPC$) and shares with WRITE access - potential for uploading payloads. For null session: crackmapexec smb <TARGET> -u '' -p '' --shares. For multiple targets: crackmapexec smb <SUBNET> -u <USER> -p <PASS> --shares",
      "oscp_relevance": "high"
    },
    {
      "id": "smb-smbclient-connect",
      "name": "Interactive SMB Client Connection",
      "category": "recon",
      "command": "smbclient //<TARGET>/<SHARE> -U <USERNAME>",
      "description": "Connect interactively to an SMB share for manual file browsing, downloading, and uploading",
      "tags": [
        "ENUMERATION",
        "FILE_TRANSFER",
        "INTERACTIVE",
        "OSCP:HIGH",
        "RECONNAISSANCE",
        "SAMBA",
        "SMB",
        "SMBCLIENT"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "Share name to connect to",
          "example": "Users",
          "required": true
        },
        {
          "name": "<USERNAME>",
          "description": "Username for authentication (use anonymous for null session)",
          "example": "administrator",
          "required": true
        }
      ],
      "flag_explanations": {
        "//": "UNC path format for SMB shares: //<SERVER>/<SHARE>",
        "-U": "Specify username for authentication (will prompt for password, or use %<PASS> inline for scripting)"
      },
      "success_indicators": [
        "smb: \\>",
        "Try \"help\" to get a list of possible commands",
        "Domain=",
        "getting file"
      ],
      "failure_indicators": [
        "NT_STATUS_ACCESS_DENIED",
        "NT_STATUS_BAD_NETWORK_NAME",
        "Connection to <TARGET> failed",
        "tree connect failed"
      ],
      "next_steps": [
        "Use 'ls' to list files",
        "Use 'get <FILE>' to download files",
        "Use 'put <FILE>' to upload files",
        "Search for sensitive files: passwords.txt, config files, SSH keys"
      ],
      "alternatives": [
        "smb-mount-share",
        "smb-smbmap-recursive"
      ],
      "prerequisites": [
        "smb-null-session-shares",
        "smb-crackmapexec-shares"
      ],
      "troubleshooting": {
        "NT_STATUS_ACCESS_DENIED": "No access to this share. Try different shares from enumeration or use guest: -U guest%guest",
        "NT_STATUS_BAD_NETWORK_NAME": "Share name incorrect. List shares first: smbclient -N -L //<TARGET>",
        "Connection failed": "Port 445 blocked. Try legacy: smbclient //<TARGET>/<SHARE> -U <USER> -p 139",
        "Cannot access subdirectories": "Use 'cd <DIR>' to change directories. Use 'recurse ON' + 'prompt OFF' + 'mget *' for bulk download"
      },
      "notes": "Interactive mode allows manual exploration which may reveal files missed by automated tools. Common useful commands: ls, cd, get, put, mget, mput, recurse, prompt. Time estimate: 5-15 minutes for manual exploration. OSCP tips: (1) Check for readable files in Users directories - look for Desktop, Documents, Downloads. (2) Check for writable directories - potential for malware upload. (3) Look for configuration files, scripts, passwords in plaintext. (4) For null session: smbclient //<TARGET>/<SHARE> -N. (5) For scripting: smbclient //<TARGET>/<SHARE> -U <USER>%<PASS> -c 'ls;get file.txt'",
      "oscp_relevance": "high"
    },
    {
      "id": "smb-smbmap-recursive",
      "name": "Recursive SMB Share Content Enumeration",
      "category": "recon",
      "command": "smbmap -H <TARGET> -u <USERNAME> -p <PASSWORD> -R <SHARE>",
      "description": "Recursively list all files and directories within an SMB share with detailed permissions",
      "tags": [
        "CREDENTIAL_ACCESS",
        "DETAILED",
        "DIRECTORY_ENUMERATION",
        "DISCOVERY",
        "ENUM",
        "ENUMERATION",
        "OSCP:HIGH",
        "RECONNAISSANCE",
        "RECURSIVE",
        "SAMBA",
        "SMB",
        "SMBMAP"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<USERNAME>",
          "description": "SMB username (or use 'anonymous' for null session)",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "SMB password (or use empty string for null session)",
          "example": "password123",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "Share name to recursively enumerate (or omit -R flag to list all shares)",
          "example": "Users",
          "required": false
        }
      ],
      "flag_explanations": {
        "-H": "Target hostname or IP address",
        "-u": "Username for SMB authentication",
        "-p": "Password for SMB authentication",
        "-R": "Recursively list files and directories within specified share (omit share name to recursively list ALL accessible shares)"
      },
      "success_indicators": [
        "READ",
        "WRITE",
        "dr--",
        "-r--",
        ".txt",
        "KB"
      ],
      "failure_indicators": [
        "Authentication error",
        "[-] Access Denied",
        "Unable to connect",
        "SMB SessionError"
      ],
      "next_steps": [
        "Download interesting files: smbmap -H <TARGET> -u <USER> -p <PASS> --download '<SHARE>\\path\\file.txt'",
        "Search for specific files: smbmap -H <TARGET> -u <USER> -p <PASS> -r <SHARE> -A password",
        "Look for writable directories for potential payload upload"
      ],
      "alternatives": [
        "smb-smbclient-connect",
        "smb-mount-share"
      ],
      "prerequisites": [
        "smb-crackmapexec-shares"
      ],
      "troubleshooting": {
        "Access Denied": "Credentials invalid or insufficient permissions. Verify with: smbmap -H <TARGET> -u <USER> -p <PASS> (no -R flag)",
        "Too much output": "Pipe to file: smbmap ... > smbmap_output.txt, or target specific share: -R <SHARE>",
        "Slow enumeration": "Large shares take time. Cancel and use specific share: -R <SHARE> instead of all shares",
        "Cannot find sensitive files": "Use search pattern: smbmap -H <TARGET> -u <USER> -p <PASS> -R <SHARE> -A '.txt|.xml|.config|.ps1'"
      },
      "notes": "smbmap shows file sizes and permissions which helps prioritize targets. Use -A flag with patterns to search for specific file types. Time estimate: 2-5 minutes depending on share size. OSCP tips: (1) Look for READ/WRITE directories - potential pivot points. (2) Common sensitive files: passwords.txt, users.txt, config.xml, web.config, *.ps1, *.kdbx (KeePass), id_rsa (SSH keys). (3) Use download: smbmap -H <TARGET> -u <USER> -p <PASS> --download '<SHARE>\\full\\path\\file.txt'. (4) For null session: smbmap -H <TARGET> -u '' -p ''. (5) Recursively list ALL shares: smbmap -H <TARGET> -u <USER> -p <PASS> -R (no share specified)",
      "oscp_relevance": "high"
    },
    {
      "id": "smb-mount-share",
      "name": "Mount SMB Share Locally",
      "category": "recon",
      "command": "sudo mount -t cifs -o username=<USERNAME>,password=<PASSWORD> //<TARGET>/<SHARE> <MOUNT_POINT>",
      "description": "Mount an SMB share to local filesystem for direct file access and manipulation using standard Linux tools",
      "tags": [
        "CREDENTIAL_ACCESS",
        "ENUMERATION",
        "FILE_INCLUSION",
        "FILE_TRANSFER",
        "MOUNT",
        "OSCP:HIGH",
        "PRIVILEGE_ESCALATION",
        "RECONNAISSANCE",
        "SAMBA",
        "SMB"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "Share name to mount",
          "example": "Users",
          "required": true
        },
        {
          "name": "<USERNAME>",
          "description": "SMB username (or use guest for guest access)",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "SMB password",
          "example": "password123",
          "required": true
        },
        {
          "name": "<MOUNT_POINT>",
          "description": "Local directory to mount share to (must exist)",
          "example": "/mnt/smb",
          "required": true
        }
      ],
      "flag_explanations": {
        "sudo": "Required - mounting filesystems requires root privileges",
        "-t cifs": "Filesystem type - CIFS (Common Internet File System, SMB protocol implementation)",
        "-o": "Mount options - comma-separated: username, password, and other options",
        "username=": "SMB authentication username",
        "password=": "SMB authentication password (alternative: use file=<CREDFILE> for security)"
      },
      "success_indicators": [
        "Mount succeeds silently (no output)",
        "ls <MOUNT_POINT> shows files",
        "df -h shows mounted share"
      ],
      "failure_indicators": [
        "mount error(13): Permission denied",
        "mount error(2): No such file or directory",
        "mount error(6): No such device or address",
        "Host is down"
      ],
      "next_steps": [
        "Browse share: ls -la <MOUNT_POINT>",
        "Search for files: find <MOUNT_POINT> -type f -name '*password*'",
        "Copy files: cp <MOUNT_POINT>/path/file.txt ~/loot/",
        "Unmount when done: sudo umount <MOUNT_POINT>"
      ],
      "alternatives": [
        "smb-smbclient-connect",
        "smb-smbmap-recursive"
      ],
      "prerequisites": [
        "sudo mkdir -p <MOUNT_POINT>"
      ],
      "troubleshooting": {
        "Permission denied": "Invalid credentials or share not accessible. Verify access first: smbmap -H <TARGET> -u <USER> -p <PASS>",
        "No such file or directory (mount point)": "Create mount point first: sudo mkdir -p <MOUNT_POINT>",
        "No such file or directory (share)": "Share name incorrect. List shares: smbclient -L //<TARGET> -U <USER>",
        "Host is down": "Port 445 blocked or host unreachable. Verify connectivity: sudo nmap -p 445 -Pn <TARGET>",
        "mount.cifs not found": "Install cifs-utils: sudo apt install cifs-utils",
        "Password visible in mount output": "Use credentials file: Create /tmp/smbcreds with 'username=<USER>\\npassword=<PASS>', then mount -o credentials=/tmp/smbcreds"
      },
      "notes": "Mounting allows using standard Linux tools (grep, find, cat, cp) instead of SMB-specific commands. Much faster for bulk file operations. Time estimate: 1 minute to mount. OSCP tips: (1) Always create mount point first: sudo mkdir -p /mnt/smb. (2) For null session: username=guest,password='' or username='',password=''. (3) For guest: username=guest,password=guest. (4) Unmount when done: sudo umount <MOUNT_POINT>. (5) Check what's mounted: df -h | grep cifs. (6) Force unmount if stuck: sudo umount -f <MOUNT_POINT>. (7) Use find for sensitive files: find /mnt/smb -iname '*password*' -o -iname '*.config' -o -iname 'id_rsa'",
      "oscp_relevance": "high"
    },
    {
      "id": "curl-header-enum",
      "name": "HTTP Header Enumeration",
      "category": "recon",
      "command": "curl -I -X <METHOD> http://<TARGET>:<PORT>/<PATH>",
      "description": "Enumerate HTTP response headers to identify server technology, versions, and potential security misconfigurations",
      "tags": [
        "CURL",
        "DISCOVERY",
        "ENUM",
        "ENUMERATION",
        "HTTP",
        "NETWORK",
        "OSCP:HIGH",
        "QUICK_WIN",
        "RECONNAISSANCE",
        "WEB"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "HTTP port",
          "example": "80",
          "required": false
        },
        {
          "name": "<PATH>",
          "description": "URL path to test",
          "example": "/",
          "required": false
        },
        {
          "name": "<METHOD>",
          "description": "HTTP method to use",
          "example": "GET",
          "required": false
        }
      ],
      "flag_explanations": {
        "-I": "Fetch headers only (HEAD request equivalent) - faster than full GET request",
        "-X": "Specify HTTP method (GET, POST, OPTIONS, PUT, DELETE, TRACE) - useful for testing allowed methods"
      },
      "success_indicators": [
        "HTTP/1.1 200",
        "Server:",
        "X-Powered-By:",
        "Content-Type:",
        "Set-Cookie:"
      ],
      "failure_indicators": [
        "Could not resolve host",
        "Connection refused",
        "HTTP/1.1 404",
        "HTTP/1.1 403"
      ],
      "next_steps": [
        "Research server version for vulnerabilities: searchsploit <SERVER_VERSION>",
        "Test for HTTP method vulnerabilities: curl -I -X OPTIONS http://<TARGET>",
        "Check for information disclosure in headers: X-Powered-By, Server",
        "whatweb-technology-detection"
      ],
      "alternatives": [
        "whatweb-technology-detection",
        "nmap-service-scan"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Connection refused": "Port incorrect or service down. Verify with: sudo nmap -p <PORT> -Pn <TARGET>",
        "No Server header": "Header may be suppressed for security. Try: curl -I -X OPTIONS to see allowed methods",
        "403 Forbidden on /": "Try different paths: /admin, /api, /login, or enumerate with gobuster",
        "SSL error for https": "Self-signed cert. Use: curl -I -k https://<TARGET> (-k to ignore cert errors)"
      },
      "notes": "Headers often reveal: Server version (Apache/2.4.41), Backend technology (X-Powered-By: PHP/7.4.3, ASP.NET), Framework (X-AspNet-Version), WAF presence (X-Sucuri-ID). Time estimate: 10 seconds. OSCP tips: (1) Look for outdated versions - searchsploit material. (2) X-Powered-By reveals backend language - useful for payload selection. (3) Test OPTIONS method: curl -I -X OPTIONS http://<TARGET> - may reveal PUT/DELETE allowed. (4) Missing security headers = potential vulnerabilities: X-Frame-Options, X-XSS-Protection, Content-Security-Policy. (5) For HTTPS: curl -I -k https://<TARGET> (bypass cert verification). (6) Verbose for debugging: curl -I -v http://<TARGET>",
      "oscp_relevance": "high"
    },
    {
      "id": "whatweb-technology-detection",
      "name": "Web Technology Fingerprinting",
      "category": "recon",
      "command": "whatweb -v -a 3 http://<TARGET>:<PORT>",
      "description": "Identify web technologies, CMS platforms, frameworks, JavaScript libraries, server info, and versions",
      "tags": [
        "CMS",
        "ENUM",
        "ENUMERATION",
        "FINGERPRINT",
        "NETWORK",
        "OSCP:HIGH",
        "RECONNAISSANCE",
        "WEB",
        "WHATWEB"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "HTTP/HTTPS port",
          "example": "80",
          "required": false
        }
      ],
      "flag_explanations": {
        "-v": "Verbose mode - displays detailed information about detected technologies",
        "-a": "Aggression level (1-4): 1=stealthy, 3=aggressive (default recommended), 4=heavy (may trigger IDS)",
        "3": "Aggression level 3 - good balance of thoroughness and stealth for OSCP labs"
      },
      "success_indicators": [
        "[200 OK]",
        "Title",
        "WordPress",
        "Apache",
        "PHP",
        "jQuery"
      ],
      "failure_indicators": [
        "ERROR",
        "Timeout",
        "Connection refused",
        "[404 Not Found]"
      ],
      "next_steps": [
        "If WordPress: wpscan --url http://<TARGET> --enumerate u,vp,tt",
        "If Joomla: joomscan -u http://<TARGET>",
        "If Drupal: droopescan scan drupal -u http://<TARGET>",
        "Research detected versions: searchsploit <CMS> <VERSION>"
      ],
      "alternatives": [
        "curl-header-enum",
        "nmap-service-scan"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Connection timeout": "Increase timeout: whatweb -v -a 3 --wait 5 http://<TARGET> (5 second timeout)",
        "Too much output": "Reduce aggression: whatweb -a 1 http://<TARGET> (stealthy mode)",
        "No technologies detected": "Increase aggression: whatweb -v -a 4 http://<TARGET> or try --force-text for unusual responses",
        "SSL certificate error": "Use -k flag: whatweb -v -a 3 https://<TARGET> (bypass cert verification)"
      },
      "notes": "whatweb identifies: CMS (WordPress, Joomla, Drupal), Web servers (Apache, nginx, IIS), Languages (PHP, ASP.NET, Python), Frameworks (Laravel, Django, Rails), JavaScript libraries (jQuery, Bootstrap), WAFs, Analytics. Time estimate: 30-60 seconds. OSCP tips: (1) Prioritize CMS detection - WordPress/Joomla often have known vulns. (2) Version numbers critical - check searchsploit immediately. (3) For multiple URLs: whatweb -i urls.txt. (4) Check both HTTP and HTTPS: whatweb http://<TARGET> https://<TARGET>. (5) Look for development/staging indicators: X-Debug, X-Error, verbose error messages. (6) Admin panels: /wp-admin (WordPress), /administrator (Joomla), /admin",
      "oscp_relevance": "high"
    },
    {
      "id": "vhost-fuzzing-gobuster",
      "name": "Virtual Host Discovery with Gobuster",
      "category": "recon",
      "command": "gobuster vhost -u http://<TARGET> -w <WORDLIST> -t <THREADS> --append-domain",
      "description": "Discover virtual hosts (subdomains) by fuzzing the Host header to find hidden web applications on the same IP",
      "tags": [
        "DIRECTORY_ENUMERATION",
        "DISCOVERY",
        "ENUM",
        "ENUMERATION",
        "FUZZING",
        "GOBUSTER",
        "OSCP:HIGH",
        "RECONNAISSANCE",
        "VHOST",
        "WEB"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target domain or IP address",
          "example": "example.com",
          "required": true
        },
        {
          "name": "<WORDLIST>",
          "description": "Wordlist for subdomain fuzzing",
          "example": "/usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt",
          "required": true
        },
        {
          "name": "<THREADS>",
          "description": "Number of concurrent threads",
          "example": "50",
          "required": false
        }
      ],
      "flag_explanations": {
        "vhost": "Virtual host enumeration mode - fuzzes Host header instead of URL path",
        "-u": "Target URL (must include http:// or https://)",
        "-w": "Wordlist for fuzzing subdomain names",
        "-t": "Number of concurrent threads (default 10, increase for faster scanning)",
        "--append-domain": "Append base domain to wordlist entries (e.g., 'dev' becomes 'dev.example.com')"
      },
      "success_indicators": [
        "Found:",
        "Status: 200",
        "[Status: 200]",
        "Size:"
      ],
      "failure_indicators": [
        "No valid entries",
        "Error: the server returns a status code",
        "[-] Unable to connect",
        "context deadline exceeded"
      ],
      "next_steps": [
        "Add discovered vhosts to /etc/hosts: echo '<IP> vhost.example.com' | sudo tee -a /etc/hosts",
        "Browse discovered vhosts: http://vhost.example.com",
        "Run technology detection: whatweb http://vhost.example.com",
        "Directory enumeration on new vhosts: gobuster dir -u http://vhost.example.com -w <WORDLIST>"
      ],
      "alternatives": [
        "ffuf -w <WORDLIST> -u http://<TARGET> -H 'Host: FUZZ.<DOMAIN>'"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "All entries return same size": "Server returns same response for all hosts. Filter by size: --exclude-length <SIZE> or try different status codes",
        "No results found": "Try common subdomains manually: dev, staging, test, admin, api, mobile, internal",
        "Connection errors": "Target may have rate limiting. Reduce threads: -t 10 or add delay: --delay 100ms",
        "Need to scan IP address": "Use: gobuster vhost -u http://<IP> -w <WORDLIST> --domain <DOMAIN> --append-domain"
      },
      "notes": "Virtual hosts allow multiple websites on one IP address by routing based on Host header. Often reveals development/staging environments with weaker security. Time estimate: 2-5 minutes depending on wordlist size. OSCP tips: (1) Always try vhost fuzzing on web servers - hidden apps common in CTFs. (2) Use quality wordlists: /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt. (3) After finding vhosts, add to /etc/hosts for browsing: <IP> subdomain.domain.com. (4) Common vhosts in OSCP: dev, staging, admin, api, internal, vpn, mail, blog. (5) Compare response sizes - identical sizes across all attempts = wildcard response (filter with --exclude-length). (6) For IP-based scanning: gobuster vhost -u http://<IP> -w <WORDLIST> --domain target.com --append-domain",
      "oscp_relevance": "high"
    },
    {
      "id": "dns-zone-transfer-dig",
      "name": "DNS Zone Transfer Attempt",
      "category": "recon",
      "command": "dig axfr @<NAMESERVER> <DOMAIN>",
      "description": "Attempt DNS zone transfer (AXFR) to obtain complete DNS records including subdomains, IPs, and mail servers",
      "tags": [
        "DNS",
        "ENUM",
        "ENUMERATION",
        "FILE_TRANSFER",
        "OSCP:MEDIUM",
        "QUICK_WIN",
        "RECONNAISSANCE",
        "ZONE_TRANSFER"
      ],
      "variables": [
        {
          "name": "<NAMESERVER>",
          "description": "Target nameserver IP or hostname",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "Target domain to transfer",
          "example": "example.com",
          "required": true
        }
      ],
      "flag_explanations": {
        "axfr": "Zone transfer query type - requests complete copy of zone data (AXFR = Authoritative Transfer Full)",
        "@": "Specifies which nameserver to query directly"
      },
      "success_indicators": [
        "; Transfer failed",
        "IN",
        "SOA",
        "NS",
        "A",
        "MX"
      ],
      "failure_indicators": [
        "; Transfer failed.",
        "connection timed out",
        "XFR size: 0 records",
        "communications error"
      ],
      "next_steps": [
        "If successful: Extract all subdomains and IPs from output",
        "Enumerate discovered hosts: sudo nmap -Pn -p- <DISCOVERED_IP>",
        "Add subdomains to /etc/hosts for further testing",
        "If failed: Try subdomain brute force: gobuster dns -d <DOMAIN> -w <WORDLIST>"
      ],
      "alternatives": [
        "host -t axfr <DOMAIN> <NAMESERVER>",
        "dnsrecon -d <DOMAIN> -t axfr"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Transfer failed": "Zone transfers disabled (proper security). Use subdomain enumeration instead: gobuster dns -d <DOMAIN> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt",
        "Connection timeout": "Firewall blocking port 53 or nameserver down. Verify: sudo nmap -p 53 -sU -Pn <NAMESERVER>",
        "REFUSED": "Nameserver explicitly denies transfer. Try other discovered nameservers from: dig NS <DOMAIN>",
        "Don't know nameserver": "Find nameservers first: dig NS <DOMAIN> or host -t ns <DOMAIN>"
      },
      "notes": "Zone transfers should be restricted to authorized secondary nameservers only, but misconfigurations still exist. Successful transfer provides complete DNS records - massive information disclosure. Time estimate: 30 seconds. OSCP tips: (1) Always try zone transfer first - when it works, it's instant enumeration. (2) Find nameservers: dig NS <DOMAIN> then try AXFR on each. (3) Parse output for subdomains: dig axfr @<NS> <DOMAIN> | grep -E '^[a-zA-Z0-9]' | awk '{print $1}'. (4) Look for: internal hosts, dev/staging servers, admin interfaces, mail servers, database servers. (5) If transfer fails (common), fallback to: gobuster dns, dnsrecon -t brt, fierce --domain <DOMAIN>. (6) UDP port 53 required - check firewall: sudo nmap -p 53 -sU -Pn <NS>",
      "oscp_relevance": "medium"
    }
  ]
}