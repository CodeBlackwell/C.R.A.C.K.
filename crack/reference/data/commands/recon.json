{
  "category": "recon",
  "description": "Network reconnaissance and enumeration commands",
  "commands": [
    {
      "id": "nmap-ping-sweep",
      "name": "Network Ping Sweep",
      "category": "recon",
      "command": "nmap -sn <TARGET_SUBNET>",
      "description": "Discover live hosts on a network without port scanning",
      "tags": ["NOISY", "ENUM", "QUICK_WIN", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<TARGET_SUBNET>",
          "description": "Target network in CIDR notation",
          "example": "192.168.1.0/24",
          "required": true
        }
      ],
      "flag_explanations": {
        "-sn": "Ping scan only - disables port scanning to quickly identify live hosts"
      },
      "success_indicators": [
        "Host is up",
        "MAC Address:",
        "Nmap done: X IP addresses (Y hosts up)"
      ],
      "failure_indicators": [
        "0 hosts up",
        "Host seems down",
        "Note: Host seems down"
      ],
      "next_steps": [
        "Run full port scan on discovered hosts: nmap -p- <IP>",
        "Perform service enumeration: nmap -sV -sC <IP>",
        "Check for specific services (SMB, HTTP, SSH)"
      ],
      "alternatives": ["fping -a -g <TARGET_SUBNET>", "arp-scan -l"],
      "notes": "Use -sn for host discovery only, no port scan",
      "oscp_relevance": "high"
    },
    {
      "id": "nmap-quick-scan",
      "name": "Quick Full Port Scan",
      "category": "recon",
      "command": "nmap -Pn -p- --min-rate=<RATE> <TARGET> -oA <OUTPUT>",
      "description": "Fast scan of all 65535 ports",
      "tags": ["NOISY", "ENUM", "FAST", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.1.100",
          "required": true
        },
        {
          "name": "<RATE>",
          "description": "Packets per second",
          "example": "1000",
          "required": false
        },
        {
          "name": "<OUTPUT>",
          "description": "Output filename base",
          "example": "quick_scan",
          "required": false
        }
      ],
      "flag_explanations": {
        "-Pn": "Skip host discovery - assume host is up (useful when ICMP blocked)",
        "-p-": "Scan all ports (1-65535) instead of default 1000 common ports",
        "--min-rate": "Minimum packet transmission rate per second for speed",
        "-oA": "Output in all formats (normal, XML, grepable) for documentation"
      },
      "success_indicators": [
        "open port",
        "Discovered open port",
        "/tcp open",
        "/udp open"
      ],
      "failure_indicators": [
        "Host seems down",
        "All 65535 scanned ports are closed",
        "0 hosts up"
      ],
      "next_steps": [
        "Service scan on open ports: nmap -sV -sC -p <PORTS> <TARGET>",
        "UDP scan if needed: nmap -sU --top-ports 20 <TARGET>",
        "Vulnerability scripts: nmap --script vuln -p <PORTS> <TARGET>"
      ],
      "alternatives": ["masscan -p1-65535 <TARGET>", "rustscan -a <TARGET>"],
      "notes": "Adjust --min-rate based on network stability",
      "oscp_relevance": "high"
    },
    {
      "id": "nmap-service-scan",
      "name": "Service Version Detection",
      "category": "recon",
      "command": "nmap -sV -sC -p <PORTS> <TARGET> -oA <OUTPUT>",
      "description": "Detailed service enumeration with default scripts",
      "tags": ["NOISY", "ENUM", "DETAILED", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.1.100",
          "required": true
        },
        {
          "name": "<PORTS>",
          "description": "Ports to scan",
          "example": "80,443,22,21",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output filename base",
          "example": "service_scan",
          "required": false
        }
      ],
      "flag_explanations": {
        "-sV": "Service version detection - probe open ports to determine service/version",
        "-sC": "Default NSE scripts - runs safe scripts for enumeration",
        "-p": "Specify ports to scan (comma-separated or range)",
        "-oA": "Output in all formats for documentation and analysis"
      },
      "success_indicators": [
        "Service Info:",
        "VERSION:",
        "Service detection performed",
        "SF-Port"
      ],
      "failure_indicators": [
        "All scanned ports are closed",
        "Service scan Timing",
        "0 services on 0 hosts"
      ],
      "next_steps": [
        "Research service versions for vulnerabilities: searchsploit <service>",
        "Web enumeration if HTTP found: gobuster dir -u http://<IP>",
        "SMB enumeration if 445 open: enum4linux -a <IP>",
        "SSH brute if 22 open: hydra -L users -P pass ssh://<IP>"
      ],
      "alternatives": ["nmap -A <TARGET>", "unicornscan -mS <TARGET>"],
      "notes": "Use after quick scan to investigate open ports",
      "oscp_relevance": "high"
    },
    {
      "id": "nmap-vuln-scan",
      "name": "Vulnerability Scan",
      "category": "recon",
      "command": "nmap --script vuln -p <PORTS> <TARGET>",
      "description": "Run vulnerability detection scripts",
      "tags": ["NOISY", "ENUM", "VULN", "AUTOMATED"],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.1.100",
          "required": true
        },
        {
          "name": "<PORTS>",
          "description": "Ports to check",
          "example": "80,443,445",
          "required": true
        }
      ],
      "flag_explanations": {
        "--script": "Run NSE scripts - 'vuln' category runs all vulnerability scripts",
        "-p": "Target specific ports for vulnerability scanning"
      },
      "success_indicators": [
        "VULNERABLE:",
        "State: VULNERABLE",
        "CVE-",
        "MS17-010"
      ],
      "failure_indicators": [
        "NOT VULNERABLE",
        "Could not find",
        "No vulnerabilities found"
      ],
      "next_steps": [
        "Research found CVEs: searchsploit <CVE>",
        "Check Metasploit: msfconsole; search <vulnerability>",
        "Manual verification of vulnerabilities",
        "Try specific vuln scripts: --script smb-vuln-ms17-010"
      ],
      "alternatives": ["nmap --script smb-vuln* <TARGET>", "nessus scan", "openvas"],
      "notes": "Can be slow, use specific scripts for better performance",
      "oscp_relevance": "medium"
    },
    {
      "id": "dns-enum",
      "name": "DNS Enumeration",
      "category": "recon",
      "command": "dnsrecon -d <DOMAIN> -t std",
      "description": "Standard DNS enumeration",
      "tags": ["ENUM", "DNS", "OSCP:MEDIUM"],
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Target domain",
          "example": "example.com",
          "required": true
        }
      ],
      "flag_explanations": {
        "-d": "Target domain to enumerate",
        "-t": "Type of enumeration - 'std' performs standard record queries"
      },
      "success_indicators": [
        "[*] A",
        "[*] MX",
        "[*] NS",
        "[*] TXT"
      ],
      "failure_indicators": [
        "No records found",
        "SERVFAIL",
        "NXDOMAIN"
      ],
      "next_steps": [
        "Try zone transfer: dnsrecon -d <DOMAIN> -t axfr",
        "Subdomain brute: gobuster dns -d <DOMAIN> -w wordlist",
        "Check for virtual hosts on discovered IPs",
        "Reverse DNS on IP ranges: dnsrecon -r <RANGE>"
      ],
      "alternatives": ["dnsenum <DOMAIN>", "fierce --domain <DOMAIN>", "host -t axfr <DOMAIN> <NS>"],
      "notes": "Try zone transfer with -t axfr if allowed",
      "oscp_relevance": "medium"
    },
    {
      "id": "smb-enum",
      "name": "SMB Enumeration",
      "category": "recon",
      "command": "enum4linux -a <TARGET>",
      "description": "Comprehensive SMB/NetBIOS enumeration",
      "tags": ["SMB", "ENUM", "NOISY", "OSCP:HIGH", "QUICK_WIN"],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.1.100",
          "required": true
        }
      ],
      "flag_explanations": {
        "-a": "All enumeration - combines -U -S -G -P -r -o -n -i (users, shares, groups, password policy, etc.)"
      },
      "success_indicators": [
        "Share Enumeration",
        "\\\\\\\\<IP>\\\\",
        "Mapping: OK",
        "Username",
        "WORKGROUP\\\\"
      ],
      "failure_indicators": [
        "Server doesn't allow session",
        "NT_STATUS_ACCESS_DENIED",
        "Connection refused",
        "Could not connect"
      ],
      "next_steps": [
        "Try null session: smbclient -L //<IP> -N",
        "Mount shares: mount -t cifs //<IP>/<share> /mnt",
        "Check write access: smbmap -H <IP> -u guest",
        "Brute force: hydra -L users -P pass smb://<IP>"
      ],
      "alternatives": ["smbclient -L //<TARGET> -N", "smbmap -H <TARGET>", "crackmapexec smb <TARGET>"],
      "notes": "Check for null sessions and guest access",
      "oscp_relevance": "high"
    },
    {
      "id": "snmp-enum",
      "name": "SNMP Enumeration",
      "category": "recon",
      "command": "snmpwalk -c <COMMUNITY> -v2c <TARGET>",
      "description": "SNMP enumeration with community string",
      "tags": ["SNMP", "ENUM", "OSCP:MEDIUM"],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.1.100",
          "required": true
        },
        {
          "name": "<COMMUNITY>",
          "description": "SNMP community string",
          "example": "public",
          "required": true
        }
      ],
      "flag_explanations": {
        "-c": "Community string for authentication (like a password)",
        "-v2c": "SNMP version 2c - most common, supports bulk requests"
      },
      "success_indicators": [
        "iso.3.6.1",
        "SNMPv2-MIB",
        "HOST-RESOURCES-MIB",
        "sysDescr.0"
      ],
      "failure_indicators": [
        "Timeout",
        "No Response",
        "Unknown community"
      ],
      "next_steps": [
        "Extract user accounts: snmpwalk -c <COMMUNITY> -v2c <IP> 1.3.6.1.4.1.77.1.2.25",
        "Get running processes: snmpwalk -c <COMMUNITY> -v2c <IP> 1.3.6.1.2.1.25.4.2.1.2",
        "Try snmp-check for formatted output: snmp-check <IP>",
        "Brute community strings: onesixtyone -c wordlist <IP>"
      ],
      "alternatives": ["onesixtyone -c <WORDLIST> <TARGET>", "snmp-check <TARGET>", "snmpbulkwalk -c <COMMUNITY> <TARGET>"],
      "notes": "Try 'public' and 'private' as default community strings",
      "oscp_relevance": "medium"
    }
  ]
}