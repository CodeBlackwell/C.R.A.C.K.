{
  "category": "exploitation",
  "description": "SSH login and authentication commands",
  "commands": [
    {
      "id": "ssh-login-password",
      "name": "SSH Login with Password",
      "category": "exploitation",
      "subcategory": "lateral-movement",
      "command": "sshpass -p '<PASSWORD>' ssh <USERNAME>@<TARGET> -p <PORT>",
      "description": "Non-interactive SSH login using password (automated credential testing)",
      "tags": [
        "CREDENTIAL_REUSE",
        "LATERAL_MOVEMENT",
        "LINUX",
        "OSCP:HIGH",
        "QUICK_WIN",
        "SSH"
      ],
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "SSH username",
          "example": "root",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Password to test",
          "example": "password123",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP or hostname",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "SSH port",
          "example": "22",
          "required": false
        }
      ],
      "flag_explanations": {
        "sshpass": "Tool for non-interactive SSH password authentication (bypasses interactive prompt)",
        "-p": "Provide password as command-line argument (use quotes for special chars)",
        "-p <PORT>": "Specify non-standard SSH port (default 22)"
      },
      "success_indicators": [
        "Last login:",
        "Welcome to",
        "$ prompt",
        "# prompt",
        "Successful authentication"
      ],
      "failure_indicators": [
        "Permission denied",
        "Authentication failed",
        "Connection refused",
        "No route to host",
        "Host key verification failed"
      ],
      "next_steps": [
        "linux-sudo-list",
        "linux-suid-find",
        "linux-capabilities",
        "linux-linpeas"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "Host key verification failed": "Add -o StrictHostKeyChecking=no: sshpass -p '<PASS>' ssh -o StrictHostKeyChecking=no <USER>@<TARGET>",
        "Permission denied": "Wrong credentials or user not allowed SSH. Verify: grep <USER> /etc/ssh/sshd_config for AllowUsers/DenyUsers",
        "Connection refused": "SSH service not running or port wrong. Verify: sudo nmap -p <PORT> -Pn <TARGET>",
        "sshpass not found": "Install: sudo apt install sshpass"
      },
      "notes": "sshpass enables non-interactive SSH for scripts. Dangerous in production (password visible in process list). Time estimate: 10 seconds. OSCP tips: (1) Common credential reuse: database passwords work for SSH. (2) Test discovered users: root, admin, user, www-data. (3) For exam documentation, prefer manual SSH (interactive) for screenshots. (4) Use -o options for exam targets: -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null. (5) Alternative for scripting: use SSH keys instead of sshpass.",
      "oscp_relevance": "high"
    }
  ]
}
