{
  "commands": [
    {
      "id": "kerbrute-userenum-ad",
      "name": "Kerbrute - Active Directory User Enumeration",
      "description": "Enumerate valid AD usernames via Kerberos pre-authentication (AS-REQ) - extremely fast and stealthy",
      "command": "kerbrute userenum -d <DOMAIN> --dc <DC_IP> <USERLIST>",
      "category": "enumeration",
      "subcategory": "active-directory",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Active Directory domain name (FQDN)",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<DC_IP>",
          "description": "Domain controller IP address",
          "example": "192.168.50.70",
          "required": true
        },
        {
          "name": "<USERLIST>",
          "description": "Username wordlist file",
          "example": "/usr/share/seclists/Usernames/xato-net-10-million-usernames.txt",
          "required": true
        }
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "USER_ENUMERATION",
        "KERBEROS",
        "LINUX",
        "WINDOWS",
        "OSCP:HIGH",
        "QUICK_WIN"
      ],
      "flag_explanations": {
        "userenum": "User enumeration mode",
        "-d": "Domain name (FQDN like corp.com)",
        "--dc": "Domain controller IP address",
        "-o": "Output file for valid usernames (recommended)",
        "-t": "Number of threads (default 10, increase for speed)",
        "--safe": "Low-and-slow mode (delays between requests)"
      },
      "success_indicators": [
        "[+] VALID USERNAME:",
        "Done! Tested",
        "successes"
      ],
      "failure_indicators": [
        "Network error",
        "Couldn't find any KDCs",
        "context deadline exceeded"
      ],
      "next_steps": [
        "kerbrute-passwordspray",
        "as-rep-roasting",
        "spray-passwords-ldap",
        "crackmapexec-smb-spray"
      ],
      "alternatives": [
        "enum4linux-users",
        "crackmapexec-rid",
        "ldapsearch-users"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Couldn't find any KDCs": "DC IP may be wrong or port 88 (Kerberos) is filtered. Verify: sudo nmap -p 88 -Pn -sU -v <DC_IP>",
        "context deadline exceeded": "Network timeout. Try --safe flag for slower requests or check connectivity to port 88/UDP",
        "Network error": "Kerberos port 88/UDP may be blocked. Verify firewall rules or try from different network position"
      },
      "notes": "FASTEST and MOST STEALTHY user enumeration method for AD. Uses Kerberos pre-authentication (AS-REQ) to validate usernames. NOISE LEVEL: Very Low - only generates event ID 4768 (Kerberos TGT request) for valid users, which is normal traffic. Invalid usernames don't generate security logs. SPEED: Can test thousands of usernames per second. WHY THIS WORKS: When you request a TGT for a username, Kerberos responds differently for valid vs invalid users. Valid users get 'PREAUTH_REQUIRED' error, invalid users get 'PRINCIPAL_UNKNOWN'. This is by-design behavior, not a vulnerability. TIME ESTIMATE: 10-60 seconds for 10k usernames. RECOMMENDED WORDLISTS: /usr/share/seclists/Usernames/Names/names.txt (common first names), /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt (comprehensive). OSCP TIP: Run this BEFORE password spraying to build valid username list. No credentials needed! Save output with -o flag: kerbrute userenum -d <DOMAIN> --dc <DC_IP> <USERLIST> -o valid_users.txt",
      "oscp_relevance": "high"
    },
    {
      "id": "crackmapexec-rid-cycling",
      "name": "CrackMapExec - RID Cycling User Enumeration",
      "description": "Enumerate domain users via RID cycling over SMB (requires NULL session or credentials)",
      "command": "crackmapexec smb <TARGET> -u <USERNAME> -p <PASSWORD> --rid-brute",
      "category": "enumeration",
      "subcategory": "active-directory",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Domain controller or domain member IP",
          "example": "192.168.50.70",
          "required": true
        },
        {
          "name": "<USERNAME>",
          "description": "Username (use 'guest' or '' for null session)",
          "example": "guest",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Password (use '' for blank/null session)",
          "example": "''",
          "required": true
        }
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "USER_ENUMERATION",
        "SMB",
        "RID_CYCLING",
        "LINUX",
        "OSCP:MEDIUM"
      ],
      "flag_explanations": {
        "--rid-brute": "Enable RID cycling to enumerate users",
        "-u": "Username (use '' or 'guest' for null session attempts)",
        "-p": "Password (use '' for blank password)",
        "-d": "Domain name (optional)",
        "--rid-brute-max": "Maximum RID to try (default 4000)"
      },
      "success_indicators": [
        "[+]",
        "SidTypeUser",
        "Brute forcing RIDs",
        "Found"
      ],
      "failure_indicators": [
        "STATUS_ACCESS_DENIED",
        "STATUS_LOGON_FAILURE",
        "Connection refused"
      ],
      "next_steps": [
        "crackmapexec-smb-spray",
        "kerbrute-passwordspray",
        "as-rep-roasting"
      ],
      "alternatives": [
        "kerbrute-userenum-ad",
        "enum4linux-users",
        "ldapsearch-users"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "STATUS_ACCESS_DENIED": "Null session or guest access blocked. Try with valid credentials: crackmapexec smb <TARGET> -u <VALID_USER> -p <VALID_PASS> --rid-brute",
        "STATUS_LOGON_FAILURE": "Invalid credentials. Try guest account: crackmapexec smb <TARGET> -u 'guest' -p '' --rid-brute",
        "Connection refused": "SMB port 445 blocked. Verify: sudo nmap -p 445 -Pn -v <TARGET>"
      },
      "notes": "TRADITIONAL user enumeration via RID cycling. RIDs (Relative Identifiers) are sequential numbers assigned to AD objects. By querying RID 500, 501, 502... you can enumerate users, groups, computers. REQUIRES: NULL session or valid credentials. NOISE LEVEL: High - SMB connections logged, many failed SID lookups generate events. WHY THIS WORKS: Windows exposes SID-to-name translation via MS-SAMR RPC over SMB. RIDs follow pattern: Domain SID + RID (e.g., S-1-5-21-[domain]-500 for Administrator). SLOWER than Kerbrute but works when Kerberos port filtered. TIME ESTIMATE: 1-3 minutes for default range. MANUAL ALTERNATIVE: rpcclient -U '' -N <TARGET> then lookupsids S-1-5-21-[domain]-[RID]. OSCP TIP: Prefer kerbrute-userenum-ad when possible (faster, stealthier). Use RID cycling when SMB is accessible but Kerberos is blocked, or when you want to enumerate groups/computers too (not just users).",
      "oscp_relevance": "medium"
    },
    {
      "id": "ldapsearch-users-ad",
      "name": "ldapsearch - LDAP User Enumeration",
      "description": "Enumerate Active Directory users via LDAP queries (anonymous or authenticated)",
      "command": "ldapsearch -x -H ldap://<TARGET> -b '<DOMAIN_DN>' '(&(objectClass=user)(objectCategory=person))' sAMAccountName userPrincipalName",
      "category": "enumeration",
      "subcategory": "active-directory",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Domain controller IP or hostname",
          "example": "192.168.50.70",
          "required": true
        },
        {
          "name": "<DOMAIN_DN>",
          "description": "Domain distinguished name (e.g., DC=corp,DC=com)",
          "example": "DC=corp,DC=com",
          "required": true
        }
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "USER_ENUMERATION",
        "LDAP",
        "LINUX",
        "OSCP:MEDIUM"
      ],
      "flag_explanations": {
        "-x": "Use simple authentication (no SASL)",
        "-H": "LDAP URI (ldap:// for unencrypted, ldaps:// for SSL)",
        "-b": "Base DN for search (domain root)",
        "-D": "Bind DN for authenticated queries (optional): -D '<USER>@<DOMAIN>'",
        "-w": "Password for authenticated bind (optional, use with -D)",
        "'(&(objectClass=user)(objectCategory=person))'": "LDAP filter: match user objects only (excludes computers)",
        "sAMAccountName": "Attribute: Windows username (pre-Windows 2000)",
        "userPrincipalName": "Attribute: UPN format (user@domain.com)",
        "description": "Additional attribute to retrieve user descriptions",
        "memberOf": "Additional attribute to retrieve group memberships"
      },
      "success_indicators": [
        "sAMAccountName:",
        "userPrincipalName:",
        "# numEntries:"
      ],
      "failure_indicators": [
        "ldap_bind: Invalid credentials",
        "Can't contact LDAP server",
        "Operations error",
        "# numEntries: 0"
      ],
      "next_steps": [
        "kerbrute-passwordspray",
        "spray-passwords-ldap",
        "as-rep-roasting"
      ],
      "alternatives": [
        "kerbrute-userenum-ad",
        "enum4linux-users",
        "crackmapexec-rid-cycling"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Can't contact LDAP server": "LDAP port 389 blocked. Verify: sudo nmap -p 389,636 -Pn -v <TARGET>. Try LDAPS: ldaps://<TARGET>",
        "Invalid credentials": "Anonymous bind disabled. Use credentials: ldapsearch -x -H ldap://<TARGET> -D '<USER>@<DOMAIN>' -w '<PASSWORD>' -b '<DOMAIN_DN>' ...",
        "Operations error": "Anonymous queries restricted. Retry with valid credentials.",
        "Too many results": "Add grep filter: ... | grep 'sAMAccountName:' | awk '{print $2}' > users.txt"
      },
      "notes": "COMPREHENSIVE user enumeration via LDAP. Retrieves ALL user objects from Active Directory. May work ANONYMOUSLY if anonymous LDAP binding enabled (rare in modern domains). NOISE LEVEL: Low - LDAP queries often not logged. ADVANTAGES: Gets full user list in single query, can retrieve additional attributes (description, memberOf, pwdLastSet). WHY THIS WORKS: AD exposes user objects via LDAP, readable by authenticated users (sometimes anonymous). TIME ESTIMATE: 5-15 seconds. OUTPUT PARSING: Extract usernames with grep/awk: ldapsearch ... | grep 'sAMAccountName:' | awk '{print $2}' > users.txt. USEFUL FILTERS: Non-disabled users: '(&(objectClass=user)(objectCategory=person)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))'. Users with no password expiry: '(&(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=65536))'. OSCP TIP: Try anonymous bind first. If blocked, use any valid credentials. Combine with kerbrute to validate enumerated users before spraying.",
      "oscp_relevance": "medium"
    },
    {
      "id": "enum4linux-users-ad",
      "name": "Enum4linux - SMB User Enumeration",
      "description": "Enumerate Active Directory users via SMB/RPC (supports null sessions and authenticated)",
      "command": "enum4linux -U <TARGET>",
      "category": "enumeration",
      "subcategory": "active-directory",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Domain controller or domain member IP",
          "example": "192.168.50.70",
          "required": true
        }
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "USER_ENUMERATION",
        "SMB",
        "NULL_SESSION",
        "LINUX",
        "OSCP:MEDIUM"
      ],
      "flag_explanations": {
        "-U": "Get userlist via SMB/RPC",
        "-u": "Specify username for authenticated enumeration (use with -p)",
        "-p": "Specify password for authenticated enumeration (use with -u)",
        "-a": "Do all simple enumeration (users, shares, groups, password policy)",
        "-v": "Verbose output"
      },
      "success_indicators": [
        "user:",
        "Users on",
        "Got domain/workgroup name"
      ],
      "failure_indicators": [
        "NT_STATUS_ACCESS_DENIED",
        "Cannot connect to server",
        "Protocol negotiation failed"
      ],
      "next_steps": [
        "kerbrute-passwordspray",
        "crackmapexec-smb-spray",
        "as-rep-roasting"
      ],
      "alternatives": [
        "kerbrute-userenum-ad",
        "crackmapexec-rid-cycling",
        "ldapsearch-users-ad"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "NT_STATUS_ACCESS_DENIED": "Null session blocked. Try with credentials: enum4linux -u <USER> -p <PASS> -U <TARGET>",
        "Protocol negotiation failed": "SMBv1 disabled. Use crackmapexec-rid-cycling instead (supports SMBv2/v3)",
        "Cannot connect to server": "SMB ports filtered. Verify: sudo nmap -p 139,445 -Pn -v <TARGET>"
      },
      "notes": "CLASSIC user enumeration tool for Windows/AD environments. Uses MS-SAMR RPC over SMB to enumerate users. Often works via NULL SESSION on older systems. NOISE LEVEL: Medium - SMB connections logged. LIMITATIONS: Requires SMBv1 or null sessions (both often disabled on modern domains). ADVANTAGES: Gets users, groups, shares, and password policy in one command (-a flag). WHY THIS WORKS: Windows exposes user enumeration via SAMR RPC for backward compatibility. TIME ESTIMATE: 15-45 seconds. OUTPUT PARSING: Extract usernames: enum4linux -U <TARGET> | grep 'user:' | awk -F'[][]' '{print $2}'. OSCP TIP: Great for quick all-in-one enumeration (enum4linux -a) but less reliable on modern domains than kerbrute. Use enum4linux first for broad recon, then kerbrute for targeted username validation.",
      "oscp_relevance": "medium"
    }
  ]
}
