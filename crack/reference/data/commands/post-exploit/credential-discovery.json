{
  "category": "post-exploit",
  "description": "Credential discovery and extraction commands for post-exploitation",
  "commands": [
    {
      "id": "linux-cred-discover-config",
      "name": "Discover Credentials in Config Files",
      "category": "post-exploit",
      "subcategory": "credential-access",
      "command": "grep -r -i -E '(password|passwd|pwd|dbpass)' <SEARCH_PATH> 2>/dev/null",
      "description": "Search recursively for password strings in configuration files (PHP, config, env, etc.)",
      "tags": [
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "LINUX",
        "OSCP:HIGH",
        "QUICK_WIN"
      ],
      "variables": [
        {
          "name": "<SEARCH_PATH>",
          "description": "Directory to search (common: /var/www/html, /opt, /home)",
          "example": "/var/www/html",
          "required": true
        }
      ],
      "flag_explanations": {
        "-r": "Recursive - search all subdirectories",
        "-i": "Case insensitive - matches PASSWORD, password, Password, etc.",
        "-E": "Extended regex - allows pattern matching with (password|passwd|pwd)",
        "2>/dev/null": "Suppress permission denied errors for cleaner output"
      },
      "success_indicators": [
        "password=",
        "DB_PASSWORD",
        "$password",
        "dbpass",
        "credentials"
      ],
      "failure_indicators": [
        "No such file or directory",
        "Permission denied (all results)",
        "No matches found"
      ],
      "next_steps": [
        "linux-enum-users-shells",
        "ssh-login-password",
        "mysql-connect-basic",
        "postgres-connect-basic"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "Too many results": "Narrow search: grep -r 'DB_PASSWORD' /var/www/html/*.php",
        "Permission denied": "Run with sudo or target user-writable directories",
        "No results in common paths": "Try: /opt, /home/*/.bash_history, /tmp, /var/backups"
      },
      "notes": "Common config file locations: /var/www/html/config.php, /var/www/html/wp-config.php, /etc/*.conf, .env files. Time estimate: 1-2 minutes. OSCP tip: Database credentials often reused for SSH. Look for patterns: password=, DB_PASS, dbpass, credentials, auth. Check .git/config for credentials in URLs.",
      "oscp_relevance": "high"
    },
    {
      "id": "linux-enum-users-shells",
      "name": "Enumerate Users with Login Shells",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "cat /etc/passwd | grep -v 'nologin\\|false' | cut -d: -f1",
      "description": "Extract valid usernames from /etc/passwd that have real login shells (exclude service accounts)",
      "tags": [
        "ENUMERATION",
        "LINUX",
        "OSCP:HIGH",
        "QUICK_WIN",
        "USER_DISCOVERY"
      ],
      "variables": [],
      "flag_explanations": {
        "cat /etc/passwd": "Display all user account information",
        "grep -v": "Invert match - exclude lines containing nologin or false shells",
        "cut -d: -f1": "Extract first field (username) using colon delimiter"
      },
      "success_indicators": [
        "root",
        "List of usernames",
        "User accounts with /bin/bash or /bin/sh"
      ],
      "failure_indicators": [
        "Permission denied",
        "No such file (unlikely on Linux)",
        "Empty output"
      ],
      "next_steps": [
        "ssh-login-password",
        "hydra-ssh"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "Too many service accounts": "Add more filters: grep -v 'nologin\\|false\\|sync\\|shutdown\\|halt'",
        "Need UID ranges": "Show UIDs: awk -F: '$3 >= 1000 {print $1}' /etc/passwd (human users)",
        "Want full details": "Omit final cut: cat /etc/passwd | grep -v nologin (shows home dirs, shells)"
      },
      "notes": "Valid login shells typically: /bin/bash, /bin/sh, /bin/zsh. Service accounts use /usr/sbin/nologin or /bin/false. Time estimate: 10 seconds. OSCP tip: Test discovered credentials against these users via SSH. Common OSCP usernames: user, admin, root, www-data (if shell granted). Also check: /home directories for personal data, .ssh/authorized_keys.",
      "oscp_relevance": "high"
    }
  ]
}