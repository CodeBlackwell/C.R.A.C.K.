{
  "metadata": {
    "version": "1.0",
    "description": "Full-syntax pivoting commands extracted from preservation plan Phase 2C.1c",
    "category": "pivoting",
    "date_created": "2025-11-09",
    "source": "preservation_plan.json CREATE_FULL_CMD action"
  },
  "commands": [
    {
      "id": "service-ssh-start-sysvinit",
      "name": "Start SSH Service (SysVinit)",
      "category": "pivoting",
      "subcategory": "service-management",
      "command": "service ssh start",
      "description": "Start SSH daemon using SysVinit service manager on older systems",
      "variables": [],
      "alternatives": [
        "systemctl-start-ssh"
      ],
      "notes": "Legacy service management for older Linux distributions. On systemd: use 'systemctl start ssh' or 'systemctl start sshd'. Service name varies: ssh (Debian/Ubuntu), sshd (RedHat/CentOS).",
      "oscp_relevance": "medium",
      "tags": [
        "PIVOTING",
        "SSH",
        "SYSVINIT",
        "SERVICE_MANAGEMENT"
      ]
    },
    {
      "id": "nmap-localhost-verification",
      "name": "Verify Listening Ports with Nmap",
      "category": "pivoting",
      "subcategory": "port-verification",
      "command": "nmap localhost",
      "description": "Scan localhost to verify which ports are externally accessible",
      "variables": [],
      "alternatives": [
        "netstat-listening-list",
        "ss-listening-all"
      ],
      "notes": "Verifies ports are listening AND accessible (firewall allows). Internal verification: use netstat/ss. Useful after setting up tunnels or forwarding to confirm external accessibility.",
      "oscp_relevance": "medium",
      "tags": [
        "PIVOTING",
        "NMAP",
        "PORT_VERIFICATION"
      ]
    },
    {
      "id": "netstat-routing-table",
      "name": "View Routing Table with Netstat",
      "category": "pivoting",
      "subcategory": "network-reconnaissance",
      "command": "netstat -rn",
      "description": "Display kernel routing table in numeric format",
      "variables": [],
      "flag_explanations": {
        "-r": "Display routing table",
        "-n": "Numeric output (no DNS resolution)"
      },
      "alternatives": [],
      "notes": "Shows default gateway, network routes, and interfaces. Essential for identifying network segments during pivoting. Modern alternative: 'ip route' or 'route -n'.",
      "oscp_relevance": "high",
      "tags": [
        "PIVOTING",
        "NETSTAT",
        "ROUTING",
        "NETWORK_ENUM"
      ]
    },
    {
      "id": "curl-http-service-verification",
      "name": "Verify HTTP Service Accessibility",
      "category": "pivoting",
      "subcategory": "service-verification",
      "command": "curl http://<TARGET>:<PORT>",
      "description": "Test HTTP connectivity to target service through tunnel or port forward",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP address",
          "example": "127.0.0.1",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "Target HTTP port",
          "example": "8080",
          "required": true
        }
      ],
      "alternatives": [],
      "notes": "Quick connectivity test after establishing tunnel or port forward. Add -v for verbose connection details. Use -x for testing through SOCKS proxy.",
      "oscp_relevance": "high",
      "tags": [
        "PIVOTING",
        "CURL",
        "HTTP",
        "CONNECTIVITY_TEST"
      ]
    },
    {
      "id": "ssh-local-port-forward-inline",
      "name": "SSH Local Port Forward (Inline Syntax)",
      "category": "pivoting",
      "subcategory": "port-forwarding",
      "command": "ssh -L <LOCAL_PORT>:<TARGET>:<PORT> <SSH_USER>@<SSH_HOST>",
      "description": "Forward local port through SSH to access internal network service",
      "variables": [
        {
          "name": "<LOCAL_PORT>",
          "description": "Local port to bind on attacker machine",
          "example": "8080",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target host reachable from SSH server (internal network)",
          "example": "192.168.10.50",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "Target port on destination host",
          "example": "80",
          "required": true
        },
        {
          "name": "<SSH_USER>",
          "description": "SSH username on pivot host",
          "example": "user",
          "required": true
        },
        {
          "name": "<SSH_HOST>",
          "description": "SSH server (pivot host) IP or hostname",
          "example": "10.10.10.50",
          "required": true
        }
      ],
      "alternatives": [
        "ssh-local-port-forward"
      ],
      "notes": "Local port forward: bind local port that forwards to internal target. Access via localhost:<LOCAL_PORT>. Add -N to disable shell, -f for background. Useful for accessing services on internal networks.",
      "oscp_relevance": "high",
      "tags": [
        "PIVOTING",
        "SSH",
        "PORT_FORWARD",
        "TUNNELING"
      ]
    },
    {
      "id": "crackmapexec-smb-framework",
      "name": "CrackMapExec SMB Framework",
      "category": "pivoting",
      "subcategory": "lateral-movement",
      "command": "crackmapexec smb",
      "description": "Modern SMB enumeration and exploitation framework for lateral movement",
      "variables": [],
      "alternatives": [
        "cme-smb-shares"
      ],
      "notes": "CrackMapExec (cme) is comprehensive toolkit for Active Directory enumeration, credential testing, and lateral movement. Common usage: cme smb <target> -u <user> -p <pass>. Supports pass-the-hash, shares, command execution.",
      "oscp_relevance": "high",
      "tags": [
        "PIVOTING",
        "LATERAL_MOVEMENT",
        "SMB",
        "CRACKMAPEXEC"
      ]
    },
    {
      "id": "wmic-os-version-specific",
      "name": "Get Specific OS Version via WMIC",
      "category": "pivoting",
      "subcategory": "system-enumeration",
      "command": "wmic os get caption,version",
      "description": "Query specific Windows OS information using WMI",
      "variables": [],
      "flag_explanations": {
        "os": "WMI class for operating system information",
        "get caption,version": "Retrieve only caption and version properties"
      },
      "alternatives": [
        "systeminfo-windows",
        "get-computerinfo"
      ],
      "notes": "WMIC deprecated in Windows 10 21H1+. Modern alternative: Get-CimInstance Win32_OperatingSystem. Caption shows OS name, version shows build number. Useful for identifying target OS quickly.",
      "oscp_relevance": "high",
      "tags": [
        "PIVOTING",
        "WINDOWS",
        "WMIC",
        "OS_ENUM"
      ]
    },
    {
      "id": "whoami-all-windows",
      "name": "Complete User Information (Windows)",
      "category": "pivoting",
      "subcategory": "user-enumeration",
      "command": "whoami /all",
      "description": "Display comprehensive user information including groups, privileges, and SID",
      "variables": [],
      "flag_explanations": {
        "/all": "Display all information (user, groups, privileges, integrity level)"
      },
      "alternatives": [
        "whoami-priv"
      ],
      "notes": "Shows username, SID, groups, privileges (enabled/disabled), and integrity level. Essential for privilege escalation assessment. Look for SeImpersonatePrivilege, SeBackupPrivilege, etc.",
      "oscp_relevance": "high",
      "tags": [
        "PIVOTING",
        "WINDOWS",
        "WHOAMI",
        "USER_ENUM",
        "PRIVESC"
      ]
    },
    {
      "id": "plink-remote-forward-microsocks",
      "name": "Plink Remote Forward with Microsocks",
      "category": "pivoting",
      "subcategory": "socks-proxy",
      "command": "plink -R <REMOTE_PORT>:127.0.0.1:<SOCKS_PORT> <SSH_USER>@<SSH_HOST>",
      "description": "Windows SSH remote port forward combined with microsocks for SOCKS proxy (workaround for OpenSSH <7.6)",
      "variables": [
        {
          "name": "<REMOTE_PORT>",
          "description": "Port to bind on SSH server",
          "example": "9050",
          "required": true
        },
        {
          "name": "<SOCKS_PORT>",
          "description": "Local microsocks SOCKS proxy port",
          "example": "1080",
          "required": true
        },
        {
          "name": "<SSH_USER>",
          "description": "SSH username on attacker machine",
          "example": "kali",
          "required": true
        },
        {
          "name": "<SSH_HOST>",
          "description": "Attacker SSH server IP",
          "example": "10.10.14.5",
          "required": true
        }
      ],
      "prerequisites": [],
      "notes": "Workaround for old OpenSSH versions lacking -D dynamic forward. Run microsocks locally on Windows, then use plink to forward that port back to attacker. Attacker configures proxychains to use remote port.",
      "oscp_relevance": "medium",
      "tags": [
        "PIVOTING",
        "PLINK",
        "SOCKS",
        "WINDOWS",
        "TUNNELING"
      ]
    },
    {
      "id": "ip-route-ping-verification",
      "name": "Verify Pivot Routing Capability",
      "category": "pivoting",
      "subcategory": "network-verification",
      "command": "ip route && ping <DEST_IP>",
      "description": "Verify pivot host can route to destination network",
      "variables": [
        {
          "name": "<DEST_IP>",
          "description": "Destination IP in internal network",
          "example": "172.16.10.50",
          "required": true
        }
      ],
      "notes": "Combined check: 'ip route' shows routing table, ping tests connectivity. Essential before setting up tunnels. If ping fails but route exists, check firewall rules.",
      "oscp_relevance": "high",
      "tags": [
        "PIVOTING",
        "ROUTING",
        "PING",
        "NETWORK_VERIFICATION"
      ]
    },
    {
      "id": "chisel-http-tunneling",
      "name": "Chisel HTTP Tunneling",
      "category": "pivoting",
      "subcategory": "tunneling",
      "command": "chisel",
      "description": "HTTP tunneling tool for port forwarding when SSH is blocked",
      "variables": [],
      "alternatives": [
        "ssh-dynamic-port-forward",
        "sshuttle-vpn"
      ],
      "notes": "Chisel uses HTTP/HTTPS for tunneling (bypasses SSH blocks). Server: chisel server -p <port> --reverse. Client: chisel client <server>:<port> R:socks or R:<local>:<remote>:<port>. Supports SOCKS and port forwarding.",
      "oscp_relevance": "high",
      "tags": [
        "PIVOTING",
        "CHISEL",
        "HTTP_TUNNEL",
        "SOCKS"
      ]
    },
    {
      "id": "test-netconnection-ssh-port",
      "name": "Test Outbound SSH Connectivity (PowerShell)",
      "category": "pivoting",
      "subcategory": "connectivity-testing",
      "command": "Test-NetConnection <SSH_HOST> -Port 22",
      "description": "Verify firewall allows outbound SSH from Windows target",
      "variables": [
        {
          "name": "<SSH_HOST>",
          "description": "Attacker SSH server IP or hostname",
          "example": "10.10.14.5",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Port 22": "Test connectivity to SSH port 22"
      },
      "notes": "PowerShell cmdlet to test TCP connectivity. Shows TcpTestSucceeded (true/false). Useful before attempting plink reverse tunnels. Alternative: curl telnet://<host>:22",
      "oscp_relevance": "high",
      "tags": [
        "PIVOTING",
        "WINDOWS",
        "POWERSHELL",
        "CONNECTIVITY_TEST",
        "FIREWALL"
      ]
    },
    {
      "id": "plink-remote-forward-windows",
      "name": "Plink Remote Port Forward",
      "category": "pivoting",
      "subcategory": "port-forwarding",
      "command": "plink -R <REMOTE_PORT>:127.0.0.1:<LOCAL_PORT> <SSH_USER>@<SSH_HOST>",
      "description": "Windows SSH client for reverse port forwarding (alternative to OpenSSH)",
      "variables": [
        {
          "name": "<REMOTE_PORT>",
          "description": "Port to bind on SSH server (attacker)",
          "example": "9999",
          "required": true
        },
        {
          "name": "<LOCAL_PORT>",
          "description": "Local port on Windows target to forward",
          "example": "3389",
          "required": true
        },
        {
          "name": "<SSH_USER>",
          "description": "SSH username on attacker machine",
          "example": "kali",
          "required": true
        },
        {
          "name": "<SSH_HOST>",
          "description": "Attacker SSH server IP",
          "example": "10.10.14.5",
          "required": true
        }
      ],
      "alternatives": [
        "plink-remote-forward"
      ],
      "notes": "Plink is PuTTY's CLI SSH client. Use -R for reverse tunnels (expose internal port to attacker). Add -N to disable shell. Accept host key with -batch or echo y | plink ...",
      "oscp_relevance": "high",
      "tags": [
        "PIVOTING",
        "PLINK",
        "WINDOWS",
        "PORT_FORWARD",
        "REVERSE_TUNNEL"
      ]
    },
    {
      "id": "proxychains-config-verify",
      "name": "Verify Proxychains Configuration",
      "category": "pivoting",
      "subcategory": "proxy-configuration",
      "command": "cat /etc/proxychains4.conf",
      "description": "Verify proxychains configuration has correct SOCKS proxy settings",
      "variables": [],
      "alternatives": [
        "proxychains-config"
      ],
      "notes": "Check [ProxyList] section at bottom: 'socks5 127.0.0.1 1080' (or your SOCKS port). Ensure only one active proxy line. Test with: proxychains4 curl http://10.10.10.1",
      "oscp_relevance": "high",
      "tags": [
        "PIVOTING",
        "PROXYCHAINS",
        "SOCKS",
        "CONFIGURATION"
      ]
    }
  ]
}