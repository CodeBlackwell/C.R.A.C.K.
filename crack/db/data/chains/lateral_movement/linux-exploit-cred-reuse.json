{
  "id": "linux-exploit-cred-reuse",
  "name": "Credential Reuse Attack Chain",
  "description": "Chain credential reuse across SSH, database, and web admin interfaces for lateral movement and privilege escalation.\n\nSystematically test discovered credentials against all available services to maximize access.",
  "version": "1.0.0",
  "metadata": {
    "author": "CRACK Development Team",
    "created": "2025-10-13",
    "updated": "2025-10-13",
    "tags": [
      "pentest",
      "CREDENTIAL_REUSE",
      "SSH",
      "DATABASE",
      "LATERAL_MOVEMENT",
      "QUICK_WIN",
      "LINUX",
      "MYSQL",
      "POSTGRESQL"
    ],
    "category": "lateral_movement",
    "platform": "linux",
    "references": []
  },
  "difficulty": "intermediate",
  "time_estimate": "20 minutes",
  "prerequisites": [
    "Initial foothold on target (web shell or low-privilege access)",
    "Network access to target services"
  ],
  "notes": "Credential reuse is extremely common in lab environments. Database credentials found in web config files are often reused for SSH access. This chain demonstrates systematic credential testing across multiple services. Always test discovered credentials against all enumerated users and services. Time-efficient approach: discover once, test everywhere.",
  "steps": [
    {
      "id": "discover-db-creds",
      "name": "Discover Database Credentials",
      "objective": "Extract database credentials from web configuration files",
      "description": "Search /var/www/html and other web directories for password strings in PHP config files, .env files, and configuration scripts.\nLook for database connection strings with usernames and passwords.",
      "command_ref": "linux-cred-discover-config",
      "evidence": [
        "Database username found",
        "Database password found",
        "Config file paths documented"
      ],
      "success_criteria": [
        "At least one password discovered",
        "Database username identified",
        "Connection details documented"
      ],
      "failure_conditions": [
        "No config files accessible",
        "All config files empty or encrypted",
        "Permission denied on all paths"
      ],
      "repeatable": true
    },
    {
      "id": "enum-system-users",
      "name": "Enumerate System Users",
      "objective": "Extract valid usernames from /etc/passwd with login shells",
      "description": "Filter /etc/passwd for users with real shells (not nologin or /bin/false).\nThese are potential SSH targets for credential reuse testing.",
      "command_ref": "linux-enum-users-shells",
      "evidence": [
        "List of usernames with login shells",
        "At least 2-5 valid users identified"
      ],
      "success_criteria": [
        "Valid users extracted successfully",
        "Root user confirmed in list",
        "User accounts documented for testing"
      ],
      "failure_conditions": [
        "Cannot read /etc/passwd",
        "No users with valid shells",
        "Only service accounts visible"
      ],
      "repeatable": false
    },
    {
      "id": "test-ssh-creds",
      "name": "Test Credentials on SSH",
      "objective": "Attempt SSH login with discovered database credentials",
      "description": "Use sshpass to automate SSH authentication testing.\nTry discovered database password against all enumerated usernames.\nCredential reuse is common - database passwords often work for SSH.",
      "command_ref": "ssh-login-password",
      "dependencies": [
        "discover-db-creds",
        "enum-system-users"
      ],
      "evidence": [
        "SSH login successful message",
        "Shell prompt obtained",
        "User session established"
      ],
      "success_criteria": [
        "SSH authentication succeeds",
        "Interactive shell obtained",
        "Can execute commands as authenticated user"
      ],
      "failure_conditions": [
        "Permission denied for all users",
        "Connection refused (SSH not accessible)",
        "Host key verification failed"
      ],
      "repeatable": true,
      "next_steps": [
        "linux-sudo-list",
        "linux-suid-find",
        "linux-linpeas"
      ]
    },
    {
      "id": "access-mysql",
      "name": "Access MySQL Database",
      "objective": "Connect to MySQL/MariaDB with discovered credentials",
      "description": "Use mysql client to connect with found credentials.\nEnumerate databases and tables.\nLook for users, admin, credentials tables with password hashes or plaintext passwords.",
      "command_ref": "mysql-connect-basic",
      "dependencies": [
        "discover-db-creds"
      ],
      "evidence": [
        "mysql> prompt obtained",
        "Database listing visible",
        "Table enumeration successful"
      ],
      "success_criteria": [
        "Successfully authenticated to MySQL",
        "Can list databases",
        "Can query information_schema"
      ],
      "failure_conditions": [
        "Access denied error",
        "Connection refused (port blocked)",
        "Host not allowed to connect"
      ],
      "repeatable": true,
      "next_steps": [
        "escalate-web-admin"
      ]
    },
    {
      "id": "access-postgres",
      "name": "Access PostgreSQL Database",
      "objective": "Connect to PostgreSQL with discovered credentials",
      "description": "Use psql client to connect with found credentials.\nEnumerate databases and tables.\nCheck for superuser privileges which enable file read and command execution.",
      "command_ref": "postgres-connect-basic",
      "dependencies": [
        "discover-db-creds"
      ],
      "evidence": [
        "postgres=# or postgres=> prompt obtained",
        "Database listing visible",
        "Table enumeration successful"
      ],
      "success_criteria": [
        "Successfully authenticated to PostgreSQL",
        "Can list databases with \\l",
        "Can query pg_catalog"
      ],
      "failure_conditions": [
        "Password authentication failed",
        "Database does not exist error",
        "No pg_hba.conf entry for host"
      ],
      "repeatable": true,
      "next_steps": [
        "postgres-privilege-check",
        "postgres-file-read"
      ]
    },
    {
      "id": "escalate-web-admin",
      "name": "Escalate to Web Admin",
      "objective": "Use database access to extract or reset admin password hash",
      "description": "Query users table for admin credentials.\nHash may be crackable (MD5, bcrypt) or directly modifiable if write access.\n\nCommon tables: users, admin, accounts, members.\nCommon columns: username, password, email, hash, role.",
      "command_ref": "mysql-connect-basic",
      "dependencies": [
        "access-mysql"
      ],
      "evidence": [
        "Admin username identified",
        "Password hash extracted",
        "Write access to users table confirmed"
      ],
      "success_criteria": [
        "Admin credentials extracted successfully",
        "Hash is crackable or modifiable",
        "Can identify admin login path"
      ],
      "failure_conditions": [
        "No users table found",
        "Cannot read password column",
        "All hashes are salted/bcrypt (uncrackable quickly)"
      ],
      "repeatable": false
    }
  ]
}