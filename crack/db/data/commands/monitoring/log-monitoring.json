{
  "category": "monitoring",
  "subcategory": "log-monitoring",
  "description": "Live log monitoring and system message viewing for real-time defense and troubleshooting",
  "commands": [
    {
      "id": "tail-follow-log",
      "name": "Follow Log File (Real-Time)",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "tail -f <LOG_FILE>",
      "description": "Monitor log file in real-time, displaying new lines as they are written",
      "variables": [
        {
          "name": "<LOG_FILE>",
          "description": "Path to log file",
          "example": "/var/log/syslog",
          "required": true
        }
      ],
      "flag_explanations": {
        "-f": "Follow - output appended data as file grows (real-time monitoring)"
      },
      "tags": [
        "DEFENSE",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION",
        "REAL_TIME"
      ],
      "success_indicators": [
        "Log entries appear in real-time",
        "Timestamps show current time"
      ],
      "failure_indicators": [
        "No such file or directory",
        "Permission denied",
        "tail: command not found"
      ],
      "next_steps": [],
      "alternatives": [
        "tail-follow-multiple",
        "journalctl-follow"
      ],
      "notes": "CRITICAL for pentest defense monitoring and troubleshooting.\n\nPress Ctrl+C to exit.\n\nCommon logs:\n/var/log/auth.log (authentication), /var/log/syslog (system), /var/log/apache2/access.log (web).\n\nTime estimate:\nruns continuously until stopped.\n\nManual alternative:\nwhile true; do tail -n 1 <FILE>; sleep 1; done",
      "methodology_guidance": {
        "after_success": "Watch for authentication attempts: tail -f /var/log/auth.log Monitor system messages: tail -f /var/log/syslog Watch web server logs: tail -f /var/log/apache2/access.log Filter with grep: tail-follow-filter"
      },
      "filled_example": "tail -f /var/log/syslog"
    },
    {
      "id": "tail-follow-filter",
      "name": "Follow Log with Grep Filter",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "tail -f <LOG_FILE> | grep --line-buffered <PATTERN>",
      "description": "Monitor log file in real-time, showing only lines matching a pattern",
      "variables": [
        {
          "name": "<LOG_FILE>",
          "description": "Path to log file",
          "example": "/var/log/auth.log",
          "required": true
        },
        {
          "name": "<PATTERN>",
          "description": "Pattern to filter for",
          "example": "Failed password",
          "required": true
        }
      ],
      "flag_explanations": {
        "-f": "Follow log in real-time",
        "| grep": "Pipe to grep for filtering",
        "--line-buffered": "Force grep to flush output immediately (required for real-time display)"
      },
      "tags": [
        "DEFENSE",
        "FILTERING",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION",
        "REAL_TIME"
      ],
      "success_indicators": [
        "Filtered log entries appear",
        "Only matching lines displayed"
      ],
      "failure_indicators": [
        "No matching entries",
        "Permission denied"
      ],
      "next_steps": [
        "grep-auth-failed",
        "grep-sudo-commands",
        "lastb-failed-logins",
        "journalctl-service-follow"
      ],
      "alternatives": [
        "tail-follow-log",
        "journalctl-follow",
        "journalctl-service-follow"
      ],
      "prerequisites": [
        "tail-follow-log"
      ],
      "notes": "--line-buffered is REQUIRED or grep will buffer output and display will be delayed.\n\ndefense patterns:\n'Failed password' (brute force), 'Invalid user' (enumeration), 'Accepted publickey' (successful login), 'sudo.*COMMAND' (privilege usage).\n\nTime estimate:\nruns continuously.",
      "methodology_guidance": {
        "after_success": "Monitor failed SSH attempts: tail -f /var/log/auth.log | grep 'Failed password' Watch for root logins: tail -f /var/log/auth.log | grep 'session opened.*root' Monitor sudo usage: tail -f /var/log/auth.log | grep 'sudo.*COMMAND' Track user activity: tail -f /var/log/auth.log | grep <USERNAME>"
      },
      "filled_example": "tail -f /var/log/auth.log | grep --line-buffered Failed password"
    },
    {
      "id": "tail-follow-multiple",
      "name": "Follow Multiple Log Files",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "tail -f <LOG_FILE1> <LOG_FILE2>",
      "description": "Monitor multiple log files simultaneously in real-time with file labels",
      "variables": [
        {
          "name": "<LOG_FILE1>",
          "description": "First log file",
          "example": "/var/log/syslog",
          "required": true
        },
        {
          "name": "<LOG_FILE2>",
          "description": "Second log file",
          "example": "/var/log/auth.log",
          "required": true
        }
      ],
      "flag_explanations": {
        "-f": "Follow mode for multiple files - displays filename headers"
      },
      "tags": [
        "DEFENSE",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION",
        "REAL_TIME"
      ],
      "success_indicators": [
        "==> <FILENAME> <==",
        "File headers displayed",
        "Updates from multiple logs"
      ],
      "failure_indicators": [
        "No such file or directory",
        "Permission denied"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "File headers show which file each line comes from:\n==> /var/log/syslog <==.\n\nUseful for correlating events across logs.\n\nTime estimate:\nruns continuously.",
      "methodology_guidance": {
        "after_success": "Monitor system and auth logs: tail -f /var/log/syslog /var/log/auth.log Watch application logs together Use multitail for better multi-log display (if installed)"
      },
      "filled_example": "tail -f /var/log/syslog /var/log/auth.log"
    },
    {
      "id": "journalctl-follow",
      "name": "Follow systemd Journal (Real-Time)",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "journalctl -f",
      "description": "Monitor systemd journal in real-time (unified logging for modern Linux)",
      "variables": [],
      "flag_explanations": {
        "-f": "Follow - display new journal entries as they are added (like tail -f)"
      },
      "tags": [
        "DEFENSE",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION",
        "REAL_TIME",
        "SYSTEMD"
      ],
      "success_indicators": [
        "Journal entries appear",
        "Timestamps",
        "Service names"
      ],
      "failure_indicators": [
        "journalctl: command not found",
        "Failed to access journal"
      ],
      "next_steps": [],
      "alternatives": [
        "tail-follow-log"
      ],
      "notes": "systemd journal is unified log system on modern Linux.\n\nCombines all system and service logs.\n\npractical tip:\nGreat for monitoring service failures, authentication attempts, and system events.\n\nTime estimate:\nruns continuously.\n\nFor systems without systemd:\nfall back to tail -f /var/log/syslog",
      "methodology_guidance": {
        "after_success": "Follow specific service: journalctl-service-follow Filter by priority: journalctl -f -p err (errors only) Combine filters: journalctl -f -u ssh -p warning",
        "time_estimate": "Filter by time: journalctl --since \"5 minutes ago\""
      }
    },
    {
      "id": "journalctl-service-follow",
      "name": "Follow Specific Service Logs",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "journalctl -u <SERVICE> -f",
      "description": "Monitor logs for a specific systemd service in real-time",
      "variables": [
        {
          "name": "<SERVICE>",
          "description": "Service name (without .service extension)",
          "example": "ssh",
          "required": true
        }
      ],
      "flag_explanations": {
        "-u": "Unit - filter by systemd unit (service)",
        "-f": "Follow in real-time"
      },
      "tags": [
        "DEFENSE",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION",
        "REAL_TIME",
        "SYSTEMD"
      ],
      "success_indicators": [
        "Service log entries",
        "Filtered to specified service"
      ],
      "failure_indicators": [
        "No entries found",
        "Unit not found"
      ],
      "next_steps": [
        "journalctl-priority-filter",
        "grep-auth-failed",
        "grep-sudo-commands",
        "systemctl-running-services"
      ],
      "alternatives": [
        "tail-follow-filter",
        "tail-follow-log",
        "journalctl-follow"
      ],
      "prerequisites": [
        "journalctl-follow",
        "systemctl-running-services"
      ],
      "notes": "Service-specific monitoring helps troubleshoot issues.\n\nCommon services:\nssh, apache2, nginx, mysql, postgresql, cron.\n\nCan monitor multiple:\njournalctl -u ssh -u apache2 -f.\n\nTime estimate:\nruns continuously.",
      "methodology_guidance": {
        "after_success": "Monitor SSH: journalctl -u ssh -f Monitor web server: journalctl -u apache2 -f or nginx Monitor database: journalctl -u postgresql -f Add priority filter: journalctl -u <SERVICE> -f -p err"
      },
      "filled_example": "journalctl -u ssh -f"
    },
    {
      "id": "journalctl-priority-filter",
      "name": "Filter Journal by Priority",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "journalctl -p <PRIORITY>",
      "description": "Display journal entries at or above specified priority level (emerg, alert, crit, err, warning, notice, info, debug)",
      "variables": [
        {
          "name": "<PRIORITY>",
          "description": "Priority level",
          "example": "err",
          "required": true
        }
      ],
      "flag_explanations": {
        "-p": "Priority - filter by syslog priority level (0=emerg to 7=debug). Displays specified level and above."
      },
      "tags": [
        "DEFENSE",
        "FILTERING",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION",
        "SYSTEMD"
      ],
      "success_indicators": [
        "Log entries at specified priority",
        "Error messages if -p err"
      ],
      "failure_indicators": [
        "No entries found",
        "Invalid priority"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "Priority levels (lowest to highest):\n0=emerg, 1=alert, 2=crit, 3=err, 4=warning, 5=notice, 6=info, 7=debug.\n\n-p err shows errors, critical, alert, and emergency.\n\nFor errors only (not above):\njournalctl PRIORITY=3.\n\nTime estimate:\n1-5 seconds.",
      "methodology_guidance": {
        "after_success": "View errors only: journalctl -p err View critical and above: journalctl -p crit Combine with follow: journalctl -f -p err Combine with service: journalctl -u ssh -p warning"
      },
      "filled_example": "journalctl -p err"
    },
    {
      "id": "journalctl-time-range",
      "name": "View Journal by Time Range",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "journalctl --since \"<TIME_SPEC>\" --until \"<TIME_SPEC>\"",
      "description": "Display journal entries within a specific time range",
      "variables": [
        {
          "name": "<TIME_SPEC>",
          "description": "Time specification",
          "example": "2024-01-01 10:00:00",
          "required": true
        }
      ],
      "flag_explanations": {
        "--since": "Show entries from this time onward (inclusive)",
        "--until": "Show entries up to this time (inclusive)"
      },
      "tags": [
        "DEFENSE",
        "FILTERING",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION",
        "SYSTEMD"
      ],
      "success_indicators": [
        "Log entries in time range",
        "Timestamps match range"
      ],
      "failure_indicators": [
        "No entries found",
        "Invalid time format"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "Time formats:\n'YYYY-MM-DD HH:MM:SS', 'yesterday', 'today', '1 hour ago', '30 minutes ago', '2 days ago'.\n\nSupports natural language.\n\nFor recent events:\njournalctl --since \"5 minutes ago\".\n\nTime estimate:\n1-10 seconds.",
      "methodology_guidance": {
        "time_estimate": "Last 10 minutes: journalctl --since \"10 minutes ago\" Last hour: journalctl --since \"1 hour ago\"",
        "after_success": "Today: journalctl --since today Yesterday: journalctl --since yesterday --until today"
      },
      "filled_example": "journalctl --since \"2024-01-01 10:00:00\" --until \"2024-01-01 10:00:00\""
    },
    {
      "id": "dmesg-kernel-messages",
      "name": "View Kernel Ring Buffer",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "dmesg",
      "description": "Display kernel messages from boot and hardware events (ring buffer)",
      "variables": [],
      "flag_explanations": {},
      "tags": [
        "DEFENSE",
        "HARDWARE",
        "KERNEL",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION"
      ],
      "success_indicators": [
        "Kernel messages",
        "Hardware detection",
        "Driver loading"
      ],
      "failure_indicators": [
        "dmesg: command not found",
        "Permission denied"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "Kernel ring buffer shows hardware events, driver loading, errors.\n\nUseful for hardware troubleshooting and detecting inserted USB devices.\n\nOutput can be large - pipe to less:\ndmesg | less.\n\nTime estimate:\n1-2 seconds.",
      "methodology_guidance": {
        "after_success": "Follow kernel messages: dmesg-follow Filter errors: dmesg | grep -i error Check USB devices: dmesg | grep -i usb Check disk errors: dmesg | grep -i \"I/O error\""
      }
    },
    {
      "id": "dmesg-follow",
      "name": "Follow Kernel Messages (Real-Time)",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "dmesg -w",
      "description": "Monitor kernel messages in real-time (hardware events, driver issues, errors)",
      "variables": [],
      "flag_explanations": {
        "-w": "Wait for new messages - follow mode (like tail -f)"
      },
      "tags": [
        "DEFENSE",
        "HARDWARE",
        "KERNEL",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION",
        "REAL_TIME"
      ],
      "success_indicators": [
        "Real-time kernel messages",
        "New hardware events displayed"
      ],
      "failure_indicators": [
        "dmesg: invalid option -- 'w'",
        "Permission denied"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "-w flag requires dmesg from util-linux 2.21+ (2012+).\n\nOlder systems:\nuse watch -n 1 'dmesg | tail -20'.\n\nUseful for detecting hardware insertion (USB drives).\n\nTime estimate:\nruns continuously.",
      "methodology_guidance": {
        "after_success": "Watch for USB insertion events Monitor disk errors Check for out-of-memory events Detect network interface changes"
      }
    },
    {
      "id": "grep-auth-failed",
      "name": "Search for Failed Authentication",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "grep -i \"failed\" /var/log/auth.log",
      "description": "Search authentication log for failed login attempts (brute force detection)",
      "variables": [],
      "flag_explanations": {
        "-i": "Ignore case (match 'failed', 'Failed', 'FAILED')"
      },
      "tags": [
        "AUTHENTICATION",
        "DEFENSE",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION",
        "SECURITY"
      ],
      "success_indicators": [
        "Failed password",
        "Failed publickey",
        "authentication failure"
      ],
      "failure_indicators": [
        "No such file",
        "Permission denied"
      ],
      "next_steps": [],
      "alternatives": [
        "lastb-failed-logins"
      ],
      "notes": "CRITICAL for pentest defense.\n\nPatterns:\n'Failed password for <USER>' (wrong password), 'Invalid user <USER>' (enumeration), 'Failed publickey for <USER>' (SSH key failed).\n\nMultiple failures from same IP = brute force attack.\n\nTime estimate:\n1-3 seconds.\n\nLog location varies:\n/var/log/auth.log (Debian/Ubuntu), /var/log/secure (RHEL/CentOS).",
      "methodology_guidance": {
        "after_success": "Count failed attempts: grep -c \"Failed password\" /var/log/auth.log Extract IPs: grep \"Failed password\" /var/log/auth.log | grep -oP '\\d+\\.\\d+\\.\\d+\\.\\d+' | sort | uniq -c Block attacking IPs: iptables -A INPUT -s <IP> -j DROP Check for username enumeration: grep \"Invalid user\" /var/log/auth.log"
      }
    },
    {
      "id": "grep-sudo-commands",
      "name": "Search for Sudo Command Usage",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "grep -i \"sudo.*COMMAND\" /var/log/auth.log",
      "description": "Extract all sudo command executions from auth log (privilege escalation tracking)",
      "variables": [],
      "flag_explanations": {
        "-i": "Case insensitive",
        "\"sudo.*COMMAND\"": "Pattern matches sudo entries with COMMAND field"
      },
      "tags": [
        "AUDITING",
        "DEFENSE",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION"
      ],
      "success_indicators": [
        "COMMAND=",
        "USER=",
        "sudo:"
      ],
      "failure_indicators": [
        "No matches found",
        "Permission denied"
      ],
      "prerequisites": [
        "cat-etc-sudoers",
        "tail-follow-filter"
      ],
      "alternatives": [
        "ps-aux-full",
        "journalctl-service-follow"
      ],
      "next_steps": [
        "sudo-exploit-find",
        "test-sudo-without"
      ],
      "notes": "CRITICAL for defense auditing.\n\nEach sudo execution is logged with:\ntimestamp, user, command, working directory.\n\npractical tip:\nLook for suspicious commands:\nbash, sh, vi, less, find, python (all can spawn shells).\n\nTime estimate:\n2-5 seconds depending on log size.",
      "methodology_guidance": {
        "after_success": "Identify privilege escalation attempts Track which users use sudo: grep \"sudo.*COMMAND\" /var/log/auth.log | grep -oP 'USER=\\w+' | sort | uniq -c Find specific command: grep \"sudo.*COMMAND=/usr/bin/bash\" /var/log/auth.log Check for sudo failures: grep \"sudo.*incorrect password\" /var/log/auth.log"
      }
    },
    {
      "id": "lastb-failed-logins",
      "name": "Failed Login Attempts",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "lastb -a",
      "description": "Display all failed login attempts from btmp log (bad login tracking)",
      "variables": [],
      "flag_explanations": {
        "-a": "Display hostname in last column"
      },
      "tags": [
        "AUTHENTICATION",
        "DEFENSE",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION",
        "SECURITY"
      ],
      "success_indicators": [
        "Username",
        "Terminal",
        "IP address",
        "Date/Time"
      ],
      "failure_indicators": [
        "lastb: command not found",
        "btmp: No such file",
        "Permission denied (need root)"
      ],
      "next_steps": [],
      "alternatives": [
        "grep-auth-failed"
      ],
      "notes": "Reads /var/log/btmp (bad login log).\n\nMUST run as root.\n\ndefense tip:\nMultiple failures = brute force.\n\nLook for:\n(1) Same IP, multiple users (enumeration), (2) Same user, many attempts (password guessing), (3) Many IPs, same user (distributed attack).\n\nTime estimate:\n1-5 seconds depending on attack history.",
      "methodology_guidance": {
        "after_success": "Count attempts per IP: lastb | awk '{print $3}' | sort | uniq -c | sort -rn Block attacker IPs: iptables -A INPUT -s <IP> -j DROP Check for username patterns (enumeration) Clear btmp after review: sudo truncate -s 0 /var/log/btmp"
      }
    },
    {
      "id": "journalctl-boot-messages",
      "name": "View Boot Messages",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "journalctl -b",
      "description": "Display all journal entries from current boot",
      "variables": [],
      "flag_explanations": {
        "-b": "Boot - show messages from current boot only (no previous boot messages)"
      },
      "tags": [
        "BOOT",
        "LINUX",
        "LOG_ANALYSIS",
        "MONITORING",
        "POST_EXPLOITATION",
        "SYSTEMD",
        "TROUBLESHOOTING"
      ],
      "success_indicators": [
        "Kernel boot messages",
        "Service startup messages",
        "Boot timestamp"
      ],
      "failure_indicators": [
        "No entries found",
        "journalctl: command not found"
      ],
      "next_steps": [],
      "alternatives": [
        "dmesg-kernel-messages"
      ],
      "notes": "Shows everything from current boot:\nkernel, systemd, services.\n\nPrevious boot:\n-b -1, boot before that:\n-b -2, etc.\n\nList boots:\njournalctl --list-boots.\n\nTime estimate:\n2-10 seconds depending on boot log size.",
      "methodology_guidance": {
        "after_success": "View previous boot: journalctl -b -1 List all boots: journalctl --list-boots Check for boot errors: journalctl -b -p err Check service failures: journalctl -b | grep -i failed"
      }
    }
  ]
}