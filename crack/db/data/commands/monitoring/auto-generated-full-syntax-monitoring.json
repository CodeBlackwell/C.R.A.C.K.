{
  "metadata": {
    "version": "1.0",
    "description": "Full-syntax monitoring commands extracted from preservation plan Phase 2C.1c",
    "category": "monitoring",
    "date_created": "2025-11-09",
    "source": "preservation_plan.json CREATE_FULL_CMD action"
  },
  "commands": [
    {
      "id": "proc-cmdline-all-processes",
      "name": "View All Process Command Lines",
      "category": "monitoring",
      "subcategory": "process-monitoring",
      "command": "cat /proc/*/cmdline | tr '\\0' ' '",
      "description": "Display command line arguments for all running processes by reading /proc filesystem",
      "variables": [],
      "flag_explanations": {
        "tr '\\0' ' '": "Translates null bytes (\\0) in cmdline files to spaces for readable output"
      },
      "notes": "Each process has /proc/PID/cmdline containing its command line with null-byte separators.\n\nUseful for detecting suspicious processes or hidden arguments.",
      "tags": [
        "MONITORING",
        "PROCESS_ENUM",
        "LINUX"
      ]
    },
    {
      "id": "ps-grep-pattern",
      "name": "Filter Processes by Pattern",
      "category": "monitoring",
      "subcategory": "process-monitoring",
      "command": "ps aux | grep <PATTERN>",
      "description": "Search running processes for specific pattern in command or arguments",
      "variables": [
        {
          "name": "<PATTERN>",
          "description": "Regular expression or string to search for in process list",
          "example": "apache|nginx",
          "required": true
        }
      ],
      "alternatives": [
        "ps-aux-full",
        "ps-grep-pattern"
      ],
      "notes": "Piping ps output to grep is common but creates an extra grep process in results.\n\nUse pgrep for cleaner output.",
      "tags": [
        "MONITORING",
        "PROCESS_ENUM",
        "GREP"
      ],
      "filled_example": "ps aux | grep apache|nginx"
    },
    {
      "id": "ps-grep-extract-pid",
      "name": "Extract PIDs by Process Name",
      "category": "monitoring",
      "subcategory": "process-monitoring",
      "command": "ps aux | grep <PROCESS_NAME> | awk '{print $2}'",
      "description": "Find process by name and extract only the PID using awk",
      "variables": [
        {
          "name": "<PROCESS_NAME>",
          "description": "Exact or partial process name to search for",
          "example": "sshd",
          "required": true
        }
      ],
      "flag_explanations": {
        "awk '{print $2}'": "Extracts second column (PID) from ps aux output"
      },
      "alternatives": [
        "ps-grep-pattern"
      ],
      "notes": "PID is always column 2 in 'ps aux' output.\n\nMore reliable alternatives:\npidof <name> or pgrep -f <pattern>",
      "tags": [
        "MONITORING",
        "PROCESS_ENUM",
        "AWK",
        "PID_EXTRACTION"
      ],
      "filled_example": "ps aux | grep sshd | awk '{print $2}'"
    },
    {
      "id": "proc-cmdline-specific-pid",
      "name": "View Specific Process Command Line",
      "category": "monitoring",
      "subcategory": "process-monitoring",
      "command": "cat /proc/<PID>/cmdline | tr '\\0' ' '",
      "description": "Display command line arguments for a specific process by PID",
      "variables": [
        {
          "name": "<PID>",
          "description": "Process ID to inspect",
          "example": "1234",
          "required": true
        }
      ],
      "flag_explanations": {
        "tr '\\0' ' '": "Converts null byte delimiters to spaces for readability"
      },
      "alternatives": [],
      "notes": "/proc/PID/cmdline shows exact command with all arguments.\n\nUseful for revealing hidden flags or configurations.",
      "tags": [
        "MONITORING",
        "PROCESS_ENUM",
        "LINUX",
        "PROC_FS"
      ],
      "filled_example": "cat /proc/1234/cmdline | tr '\\0' ' '"
    },
    {
      "id": "crontab-user-direct-read",
      "name": "Read User Crontab File Directly",
      "category": "monitoring",
      "subcategory": "scheduled-tasks",
      "command": "cat /var/spool/cron/crontabs/<USERNAME>",
      "description": "Directly read user's crontab file from filesystem (requires root or specific permissions)",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Username whose crontab to read",
          "example": "www-data",
          "required": true
        }
      ],
      "alternatives": [
        "crontab-user-list"
      ],
      "notes": "Direct file access requires root.\n\nPreferred method:\n'crontab -u <user> -l'.\n\nFile location varies:\nDebian/Ubuntu use /var/spool/cron/crontabs/, RedHat uses /var/spool/cron/",
      "tags": [
        "MONITORING",
        "SCHEDULED_TASKS",
        "CRON",
        "PRIVESC"
      ],
      "filled_example": "cat /var/spool/cron/crontabs/www-data"
    },
    {
      "id": "less-etc-crontab",
      "name": "View System-Wide Crontab with Less",
      "category": "monitoring",
      "subcategory": "scheduled-tasks",
      "command": "less /etc/crontab",
      "description": "Interactively view system-wide crontab file with pagination",
      "variables": [],
      "alternatives": [
        "crontab-system-wide"
      ],
      "notes": "less allows scrolling and searching (use / to search).\n\nSystem crontab includes run-parts entries for hourly/daily/weekly/monthly jobs.",
      "tags": [
        "MONITORING",
        "SCHEDULED_TASKS",
        "CRON"
      ]
    },
    {
      "id": "find-all-cron-files",
      "name": "Find All Cron Configuration Files",
      "category": "monitoring",
      "subcategory": "scheduled-tasks",
      "command": "find /etc/cron* -type f",
      "description": "Locate all cron-related configuration files in /etc directory",
      "variables": [],
      "flag_explanations": {
        "-type f": "Match only regular files (exclude directories)",
        "/etc/cron*": "Glob pattern matching /etc/crontab, /etc/cron.d/, /etc/cron.daily/, etc."
      },
      "notes": "Finds files in:\n/etc/cron.d/, /etc/cron.hourly/, /etc/cron.daily/, /etc/cron.weekly/, /etc/cron.monthly/, and /etc/crontab.\n\nEssential for comprehensive scheduled task enumeration.",
      "tags": [
        "MONITORING",
        "SCHEDULED_TASKS",
        "CRON",
        "FIND"
      ]
    },
    {
      "id": "at-command-utility",
      "name": "AT Command-Line Scheduler",
      "category": "monitoring",
      "subcategory": "scheduled-tasks",
      "command": "at",
      "description": "Schedule one-time tasks using the AT utility (alternative to cron for non-recurring jobs)",
      "variables": [],
      "notes": "AT utility schedules one-time jobs.\n\nView queued jobs:\n'atq'.\n\nView job details:\n'at -c <job_id>'.\n\nJobs stored in /var/spool/at/.\n\nRequires atd daemon running.",
      "tags": [
        "MONITORING",
        "SCHEDULED_TASKS",
        "AT"
      ]
    },
    {
      "id": "ls-at-spool-directory",
      "name": "List AT Job Spool Directory",
      "category": "monitoring",
      "subcategory": "scheduled-tasks",
      "command": "ls -la /var/spool/at/",
      "description": "Enumerate scheduled AT jobs by listing spool directory",
      "variables": [],
      "alternatives": [],
      "notes": "Direct filesystem inspection of AT jobs.\n\nJob files named with format 'a<timestamp><queue>'.\n\nBetter method:\nuse 'atq' command.\n\nRequires appropriate permissions.",
      "tags": [
        "MONITORING",
        "SCHEDULED_TASKS",
        "AT",
        "LS"
      ]
    },
    {
      "id": "tail-follow-syslog",
      "name": "Tail Syslog in Real-Time",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "tail -f /var/log/syslog",
      "description": "Monitor syslog file in real-time as new entries are written",
      "variables": [],
      "flag_explanations": {
        "-f": "Follow mode - continuously display new lines appended to file"
      },
      "alternatives": [
        "journalctl-follow"
      ],
      "notes": "Syslog path varies:\n/var/log/syslog (Debian/Ubuntu), /var/log/messages (RedHat/CentOS).\n\nOn systemd systems, prefer journalctl.\n\nUse Ctrl+C to exit.",
      "tags": [
        "MONITORING",
        "LOG_ANALYSIS",
        "TAIL"
      ]
    },
    {
      "id": "journalctl-kernel-messages",
      "name": "View Kernel Messages via Journald",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "journalctl -k",
      "description": "Display kernel messages from systemd journal (equivalent to dmesg on systemd systems)",
      "variables": [],
      "flag_explanations": {
        "-k": "Show only kernel messages (equivalent to --dmesg)"
      },
      "alternatives": [
        "dmesg-kernel-messages"
      ],
      "notes": "Requires systemd.\n\nShows same information as dmesg but with timestamps and systemd formatting.\n\nUse -f to follow in real-time.",
      "tags": [
        "MONITORING",
        "LOG_ANALYSIS",
        "JOURNALCTL",
        "KERNEL"
      ]
    },
    {
      "id": "journalctl-kernel-follow",
      "name": "Follow Kernel Messages in Real-Time",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "journalctl -kf",
      "description": "Monitor kernel messages in real-time via journald",
      "variables": [],
      "flag_explanations": {
        "-k": "Show only kernel messages",
        "-f": "Follow mode - continuously display new entries"
      },
      "alternatives": [
        "dmesg-follow"
      ],
      "notes": "Combines -k (kernel) and -f (follow).\n\nUseful for monitoring hardware events, driver issues, or kernel-level security events in real-time.",
      "tags": [
        "MONITORING",
        "LOG_ANALYSIS",
        "JOURNALCTL",
        "KERNEL"
      ]
    },
    {
      "id": "journalctl-ssh-failed-logins",
      "name": "Filter SSH Failed Login Attempts",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "journalctl -u ssh | grep -i failed",
      "description": "Search SSH service logs for failed authentication attempts",
      "variables": [],
      "flag_explanations": {
        "-u ssh": "Filter logs for the ssh service unit",
        "grep -i failed": "Case-insensitive search for 'failed' in output"
      },
      "alternatives": [],
      "notes": "Service name may vary:\nssh, sshd, ssh.service.\n\nOn non-systemd systems, check /var/log/auth.log or /var/log/secure directly.",
      "tags": [
        "MONITORING",
        "LOG_ANALYSIS",
        "JOURNALCTL",
        "SSH",
        "SECURITY"
      ]
    },
    {
      "id": "journalctl-sudo-commands",
      "name": "Search Sudo Command Execution Logs",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "journalctl | grep 'sudo.*COMMAND'",
      "description": "Find all sudo command executions logged by journald",
      "variables": [],
      "notes": "Reveals privileged command history.\n\nPattern matches sudo logs containing 'COMMAND=' entries.\n\nFor focused output:\njournalctl _COMM=sudo | grep COMMAND=",
      "tags": [
        "MONITORING",
        "LOG_ANALYSIS",
        "JOURNALCTL",
        "SUDO",
        "PRIVESC"
      ]
    },
    {
      "id": "journalctl-failed-password",
      "name": "Search Failed Password Attempts",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "journalctl | grep 'Failed password'",
      "description": "Find all failed password authentication attempts across all services",
      "variables": [],
      "alternatives": [],
      "notes": "Covers SSH, su, sudo, login, and other PAM-authenticated services.\n\nAdd -S (since) flag for time range:\njournalctl -S today | grep 'Failed password'",
      "tags": [
        "MONITORING",
        "LOG_ANALYSIS",
        "JOURNALCTL",
        "AUTH",
        "SECURITY"
      ]
    },
    {
      "id": "ls-init-d",
      "name": "List SysVinit Services",
      "category": "monitoring",
      "subcategory": "service-monitoring",
      "command": "ls /etc/init.d/",
      "description": "Enumerate legacy SysVinit service scripts",
      "variables": [],
      "alternatives": [
        "systemctl-list"
      ],
      "notes": "Shows SysVinit scripts on older systems or systemd systems with legacy services.\n\nOn systemd:\nuse 'systemctl list-unit-files'.\n\nService scripts are executable shell scripts.",
      "tags": [
        "MONITORING",
        "SERVICE_ENUM",
        "SYSVINIT"
      ]
    },
    {
      "id": "top-snapshot-memory-sorted",
      "name": "Top Memory Consumers Snapshot",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "top -bn1 -o %MEM | head -20",
      "description": "Single snapshot of top 20 processes sorted by memory usage",
      "variables": [],
      "flag_explanations": {
        "-b": "Batch mode (non-interactive)",
        "-n1": "Run for 1 iteration only",
        "-o %MEM": "Sort by memory percentage",
        "| head -20": "Show only first 20 lines (header + top processes)"
      },
      "alternatives": [],
      "notes": "Batch mode suitable for scripting.\n\nRemove head to see all processes.\n\nAlternative:\nps aux --sort=-%mem | head -20",
      "tags": [
        "MONITORING",
        "RESOURCE_MONITORING",
        "TOP",
        "MEMORY"
      ]
    },
    {
      "id": "top-snapshot-cpu-sorted",
      "name": "Top CPU Consumers Snapshot",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "top -bn1 -o %CPU | head -20",
      "description": "Single snapshot of top 20 processes sorted by CPU usage",
      "variables": [],
      "flag_explanations": {
        "-b": "Batch mode (non-interactive)",
        "-n1": "Run for 1 iteration only",
        "-o %CPU": "Sort by CPU percentage",
        "| head -20": "Show only first 20 lines"
      },
      "alternatives": [],
      "notes": "Useful for identifying CPU-intensive processes.\n\nCPU% shows usage since process start, not instantaneous.\n\nFor real-time:\nuse interactive top without -bn1.",
      "tags": [
        "MONITORING",
        "RESOURCE_MONITORING",
        "TOP",
        "CPU"
      ]
    },
    {
      "id": "cat-proc-meminfo",
      "name": "View Detailed Memory Information",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "cat /proc/meminfo",
      "description": "Display comprehensive memory statistics from kernel",
      "variables": [],
      "notes": "Shows total, free, available, buffers, cached, swap, and more.\n\nKey fields:\nMemTotal, MemFree, MemAvailable (best indicator of free memory), SwapTotal, SwapFree.",
      "tags": [
        "MONITORING",
        "RESOURCE_MONITORING",
        "MEMORY",
        "PROC_FS"
      ]
    },
    {
      "id": "top-snapshot-batch",
      "name": "Top Process Snapshot (Batch Mode)",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "top -bn1",
      "description": "Single non-interactive snapshot of system processes and resource usage",
      "variables": [],
      "flag_explanations": {
        "-b": "Batch mode (non-interactive, suitable for piping)",
        "-n1": "Run for 1 iteration then exit"
      },
      "alternatives": [
        "ps-aux-full"
      ],
      "notes": "Useful for scripting or capturing process state.\n\nShows CPU, memory, load average, and process list.\n\nDefault sort is by CPU usage.",
      "tags": [
        "MONITORING",
        "RESOURCE_MONITORING",
        "TOP"
      ]
    },
    {
      "id": "sar-cpu-monitoring",
      "name": "SAR CPU Utilization Monitoring",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "sar -u 1 5",
      "description": "Collect CPU utilization statistics every 1 second for 5 iterations",
      "variables": [],
      "flag_explanations": {
        "-u": "Report CPU utilization (default)",
        "1": "Sample interval in seconds",
        "5": "Number of samples to collect"
      },
      "notes": "Requires sysstat package.\n\nShows %user, %system, %iowait, %idle.\n\nUseful for performance analysis and baseline establishment.\n\nHistorical data in /var/log/sa/.",
      "tags": [
        "MONITORING",
        "RESOURCE_MONITORING",
        "SAR",
        "CPU"
      ]
    },
    {
      "id": "cat-proc-loadavg",
      "name": "View System Load Average",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "cat /proc/loadavg",
      "description": "Display 1, 5, and 15 minute load averages",
      "variables": [],
      "notes": "Format:\nload1 load5 load15 running/total last_pid.\n\nLoad represents average number of processes in run queue.\n\nValues > CPU count indicate potential bottleneck.",
      "tags": [
        "MONITORING",
        "RESOURCE_MONITORING",
        "LOAD",
        "PROC_FS"
      ]
    },
    {
      "id": "ls-proc-fd-all",
      "name": "List All Process File Descriptors",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "ls -l /proc/*/fd/",
      "description": "Enumerate all file descriptors for all processes (manual inspection required)",
      "variables": [],
      "alternatives": [
        "lsof-list"
      ],
      "notes": "Shows open files, sockets, pipes for all processes.\n\nRequires root for other users' processes.\n\nBetter alternative:\nlsof.\n\nUseful for identifying network connections or open files.",
      "tags": [
        "MONITORING",
        "RESOURCE_MONITORING",
        "FILE_DESCRIPTORS",
        "PROC_FS"
      ]
    },
    {
      "id": "lsof-directory-non-recursive",
      "name": "LSOF Directory Usage (Non-Recursive)",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "lsof +d <DIRECTORY>",
      "description": "List processes using files in specific directory (non-recursive, faster than +D)",
      "variables": [
        {
          "name": "<DIRECTORY>",
          "description": "Directory path to check for open files",
          "example": "/var/www/html",
          "required": true
        }
      ],
      "flag_explanations": {
        "+d": "Search directory for open files (non-recursive, faster)"
      },
      "alternatives": [
        "lsof-directory-usage"
      ],
      "notes": "Faster than +D (recursive).\n\nUse +D for recursive search.\n\nCommon use:\nidentify which processes are accessing files in specific directory.",
      "tags": [
        "MONITORING",
        "RESOURCE_MONITORING",
        "LSOF",
        "FILE_DESCRIPTORS"
      ],
      "filled_example": "lsof +d /var/www/html"
    },
    {
      "id": "cat-wtmp-utmpdump",
      "name": "Parse WTMP Login Records",
      "category": "monitoring",
      "subcategory": "log-monitoring",
      "command": "cat /var/log/wtmp | utmpdump",
      "description": "Convert binary wtmp login records to human-readable format",
      "variables": [],
      "flag_explanations": {
        "utmpdump": "Utility to decode binary utmp/wtmp files"
      },
      "alternatives": [],
      "notes": "wtmp logs all login/logout events.\n\nBinary format requires utmpdump or last command.\n\nBetter alternative:\n'last' command provides formatted output.\n\nUseful for forensics and user activity tracking.",
      "tags": [
        "MONITORING",
        "LOG_ANALYSIS",
        "WTMP",
        "LOGIN_HISTORY"
      ]
    }
  ]
}