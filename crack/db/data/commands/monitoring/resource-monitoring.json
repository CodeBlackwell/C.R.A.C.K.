{
  "category": "monitoring",
  "subcategory": "resource-monitoring",
  "description": "System resource monitoring commands for CPU, memory, I/O, and performance analysis",
  "commands": [
    {
      "id": "ps-sort-memory",
      "name": "Top Memory Consumers",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "ps aux --sort=-%mem | head -10",
      "description": "List top 10 processes by memory usage (identify memory leaks or suspicious high-memory processes)",
      "variables": [],
      "flag_explanations": {
        "aux": "All users, user-oriented format, include processes without TTY",
        "--sort=-%mem": "Sort by memory percentage descending (highest first, - for descending)",
        "| head -10": "Pipe to head to show only first 10 results"
      },
      "tags": [
        "DEFENSE",
        "DISCOVERY",
        "ENUMERATION",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "RESOURCE_MONITORING"
      ],
      "success_indicators": [
        "%MEM",
        "USER",
        "PID",
        "COMMAND"
      ],
      "failure_indicators": [
        "ps: command not found"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "defense tip:\nUnexpected high-memory processes may indicate cryptominers, memory scrapers, or DoS attacks.\n\nFor top CPU:\nps aux --sort=-%cpu | head -10.\n\nTime estimate:\n2 seconds.",
      "methodology_guidance": {
        "after_success": "Investigate high-memory processes: ps-pid-details Check if process is legitimate or malicious Monitor memory over time: free-memory-human Kill memory-hogging process if needed: kill <PID>"
      }
    },
    {
      "id": "ps-sort-cpu",
      "name": "Top CPU Consumers",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "ps aux --sort=-%cpu | head -10",
      "description": "List top 10 processes by CPU usage (identify CPU-intensive or suspicious processes)",
      "variables": [],
      "flag_explanations": {
        "aux": "All users, user-oriented format, processes without TTY",
        "--sort=-%cpu": "Sort by CPU percentage descending (highest CPU usage first)",
        "| head -10": "Show only top 10 results"
      },
      "tags": [
        "DEFENSE",
        "DISCOVERY",
        "ENUMERATION",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "RESOURCE_MONITORING"
      ],
      "success_indicators": [
        "%CPU",
        "USER",
        "PID",
        "COMMAND"
      ],
      "failure_indicators": [
        "ps: command not found"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "defense tip:\nUnexpected 100% CPU usage may indicate cryptominers, brute-force attacks, or fork bombs.\n\nTime estimate:\n2 seconds.",
      "methodology_guidance": {
        "after_success": "Investigate high-CPU process: ps-pid-details Check process legitimacy Monitor CPU over time: vmstat-cpu-monitoring Kill rogue process: kill <PID>"
      }
    },
    {
      "id": "free-memory-human",
      "name": "Memory Usage (Human Readable)",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "free -h",
      "description": "Display system memory usage in human-readable format (total, used, free, shared, buff/cache, available)",
      "variables": [],
      "flag_explanations": {
        "-h": "Human-readable - display sizes in GB/MB/KB instead of bytes"
      },
      "tags": [
        "DEFENSE",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "QUICK_WIN",
        "RESOURCE_MONITORING"
      ],
      "success_indicators": [
        "total",
        "used",
        "free",
        "available",
        "Mem:",
        "Swap:"
      ],
      "failure_indicators": [
        "free: command not found"
      ],
      "next_steps": [],
      "alternatives": [
        "cat-proc-meminfo"
      ],
      "notes": "'available' is key metric - memory available for starting new applications (includes reclaimable cache).\n\nLow available memory = system under pressure.\n\nSwap usage (high) = memory exhaustion.\n\nTime estimate:\n<1 second.",
      "methodology_guidance": {
        "after_success": "If low memory: identify top consumers with ps-sort-memory Check swap usage - high swap = potential performance issue Clear cache if needed: sudo sync && sudo echo 3 > /proc/sys/vm/drop_caches",
        "time_estimate": "Monitor memory over time: free -h -s 5 (every 5 seconds)"
      }
    },
    {
      "id": "vmstat-cpu-monitoring",
      "name": "Virtual Memory Statistics",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "vmstat 1 5",
      "description": "Monitor CPU, memory, I/O, and system activity with 5 samples at 1-second intervals",
      "variables": [],
      "flag_explanations": {
        "1": "Delay between samples in seconds",
        "5": "Number of samples to collect (omit for continuous monitoring)"
      },
      "tags": [
        "DEFENSE",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "RESOURCE_MONITORING"
      ],
      "success_indicators": [
        "procs",
        "memory",
        "swap",
        "io",
        "system",
        "cpu"
      ],
      "failure_indicators": [
        "vmstat: command not found"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "Key columns:\nr (processes waiting for CPU), b (blocked on I/O), si/so (swap in/out), us (user CPU%), sy (system CPU%), id (idle CPU%), wa (I/O wait%).\n\nHigh 'wa' = disk bottleneck.\n\nFor continuous:\nvmstat 1.\n\nTime estimate:\n5 seconds for 5 samples.",
      "methodology_guidance": {
        "after_success": "Monitor CPU idle (id column) - low idle = high CPU usage Check swap in/out (si/so) - high values = memory pressure Monitor blocked processes (b column) - indicates I/O wait Use iostat for detailed I/O statistics"
      }
    },
    {
      "id": "iostat-disk-stats",
      "name": "I/O Statistics (Disk Activity)",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "iostat -x 1 5",
      "description": "Monitor disk I/O statistics with extended details (5 samples at 1-second intervals)",
      "variables": [],
      "flag_explanations": {
        "-x": "Extended statistics - display detailed per-disk metrics including utilization, await, svctm",
        "1": "Interval in seconds between samples",
        "5": "Number of samples (omit for continuous)"
      },
      "tags": [
        "DEFENSE",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "RESOURCE_MONITORING"
      ],
      "success_indicators": [
        "Device:",
        "r/s",
        "w/s",
        "%util",
        "await"
      ],
      "failure_indicators": [
        "iostat: command not found"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "Key metrics:\nr/s (reads/sec), w/s (writes/sec), %util (disk busy %), await (average I/O wait time in ms).\n\n%util >80% consistently = disk bottleneck.\n\nTime estimate:\n5 seconds for 5 samples.\n\nPart of sysstat package.",
      "methodology_guidance": {
        "after_success": "High %util (>80%) = disk bottleneck Identify I/O-heavy processes: iotop (if installed) Check disk health: smartctl -a /dev/sda",
        "time_estimate": "High await = slow disk response time"
      }
    },
    {
      "id": "uptime-load-average",
      "name": "System Uptime and Load Average",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "uptime",
      "description": "Display system uptime and load averages (1, 5, 15 minute averages)",
      "variables": [],
      "flag_explanations": {},
      "tags": [
        "DEFENSE",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "QUICK_WIN",
        "RESOURCE_MONITORING"
      ],
      "success_indicators": [
        "up",
        "users",
        "load average:"
      ],
      "failure_indicators": [
        "uptime: command not found"
      ],
      "next_steps": [],
      "alternatives": [
        "cat-proc-loadavg"
      ],
      "notes": "Load average shows average number of processes in run queue.\n\nOn 4-core system:\nload of 4.0 = 100% CPU utilization, 8.0 = 200% (overloaded).\n\nThree numbers:\n1-min, 5-min, 15-min averages.\n\nTime estimate:\n<1 second.",
      "methodology_guidance": {
        "after_success": "Interpret load average: <1.0 per CPU core = healthy, >2.0 per core = overloaded Check CPU count: nproc or grep -c processor /proc/cpuinfo If high load: investigate with top-snapshot or ps-sort-cpu Check for runaway processes"
      }
    },
    {
      "id": "df-disk-usage",
      "name": "Disk Space Usage",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "df -h",
      "description": "Display disk space usage for all filesystems in human-readable format",
      "variables": [],
      "flag_explanations": {
        "-h": "Human-readable - show sizes in GB/MB/KB instead of blocks"
      },
      "tags": [
        "DEFENSE",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "QUICK_WIN",
        "RESOURCE_MONITORING"
      ],
      "success_indicators": [
        "Filesystem",
        "Size",
        "Used",
        "Avail",
        "Use%",
        "Mounted on"
      ],
      "failure_indicators": [
        "df: command not found"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "practical tip:\nFull disk can prevent logging, break services, and stop reverse shells.\n\nCheck Use% column.\n\nFor specific directory:\ndf -h /var.\n\nTime estimate:\n1 second.",
      "methodology_guidance": {
        "after_success": "If >90% used: find large files with du-directory-usage Check for log file bloat: du -sh /var/log/* Find large files: find / -type f -size +100M 2>/dev/null Clear space if needed"
      }
    },
    {
      "id": "du-directory-usage",
      "name": "Directory Disk Usage",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "du -sh <DIRECTORY>",
      "description": "Show total disk usage for a directory in human-readable format",
      "variables": [
        {
          "name": "<DIRECTORY>",
          "description": "Directory to check",
          "example": "/var/log",
          "required": true
        }
      ],
      "flag_explanations": {
        "-s": "Summarize - display only total for directory (not each subdirectory)",
        "-h": "Human-readable - show size in GB/MB/KB"
      },
      "tags": [
        "DEFENSE",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "RESOURCE_MONITORING"
      ],
      "success_indicators": [
        "Size followed by directory path",
        "G",
        "M",
        "K"
      ],
      "failure_indicators": [
        "du: cannot access",
        "Permission denied"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "Useful for finding what's consuming disk space.\n\nTo see subdirectories:\ndu -h <DIR> --max-depth=1 | sort -hr.\n\nTime estimate:\n1-10 seconds depending on directory size.",
      "methodology_guidance": {
        "after_success": "Find large subdirectories: du -h <DIR> --max-depth=1 | sort -hr Find large files in directory: find <DIR> -type f -size +100M Check log rotation: ls -lh /var/log/ Clear old logs or temporary files"
      },
      "filled_example": "du -sh /var/log"
    },
    {
      "id": "lsof-user-files",
      "name": "Files Opened by User",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "lsof -u <USERNAME>",
      "description": "List all files opened by a specific user (file handles, network connections, devices)",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Username to check",
          "example": "www-data",
          "required": true
        }
      ],
      "flag_explanations": {
        "-u": "User - list files opened by specific user"
      },
      "tags": [
        "DEFENSE",
        "ENUMERATION",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "RESOURCE_MONITORING"
      ],
      "success_indicators": [
        "COMMAND",
        "PID",
        "USER",
        "FD",
        "TYPE",
        "NAME"
      ],
      "failure_indicators": [
        "lsof: command not found",
        "Permission denied"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "Shows everything a user has open:\nregular files, directories, network sockets, devices.\n\nUseful for investigating compromised accounts.\n\nTime estimate:\n2-5 seconds.",
      "methodology_guidance": {
        "after_success": "Identify active processes for user Check network connections: lsof -u <USER> -i Look for suspicious file access Check deleted files still held open: lsof -u <USER> | grep deleted"
      },
      "filled_example": "lsof -u www-data"
    },
    {
      "id": "lsof-directory-usage",
      "name": "Processes Using Directory",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "lsof +D <DIRECTORY>",
      "description": "Find all processes that have files open within a directory (recursively)",
      "variables": [
        {
          "name": "<DIRECTORY>",
          "description": "Directory to check",
          "example": "/var/www",
          "required": true
        }
      ],
      "flag_explanations": {
        "+D": "Directory - recursively search directory for open files (slower than +d which is non-recursive)"
      },
      "tags": [
        "DEFENSE",
        "ENUMERATION",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "RESOURCE_MONITORING"
      ],
      "success_indicators": [
        "COMMAND",
        "PID",
        "NAME"
      ],
      "failure_indicators": [
        "No output (no processes using directory)",
        "lsof: command not found"
      ],
      "next_steps": [],
      "alternatives": [
        "fuser-directory-processes"
      ],
      "notes": "Useful before unmounting filesystems or deleting directories.\n\n+D is recursive (slow), +d is non-recursive (fast).\n\nTime estimate:\n5-30 seconds depending on directory size.",
      "methodology_guidance": {
        "after_success": "Identify processes before unmounting filesystem Kill processes if needed: kill <PID> Use fuser for simpler output: fuser-directory-processes"
      },
      "filled_example": "lsof +D /var/www"
    },
    {
      "id": "fuser-directory-processes",
      "name": "Processes Using Directory (fuser)",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "fuser -v <DIRECTORY>",
      "description": "Identify processes using files or directories (lighter than lsof)",
      "variables": [
        {
          "name": "<DIRECTORY>",
          "description": "Directory or file to check",
          "example": "/mnt/share",
          "required": true
        }
      ],
      "flag_explanations": {
        "-v": "Verbose - display USER, PID, ACCESS, COMMAND"
      },
      "tags": [
        "DEFENSE",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "RESOURCE_MONITORING"
      ],
      "success_indicators": [
        "USER",
        "PID",
        "ACCESS",
        "COMMAND"
      ],
      "failure_indicators": [
        "No processes found",
        "fuser: command not found"
      ],
      "next_steps": [],
      "alternatives": [
        "lsof-directory-usage"
      ],
      "notes": "Lighter weight than lsof.\n\nUseful before unmounting.\n\nACCESS types:\nc (current directory), e (executable), f (open file), r (root directory).\n\nTime estimate:\n1 second.",
      "methodology_guidance": {
        "after_success": "Kill processes: fuser -k <DIRECTORY> (kills all processes using dir) Unmount filesystem after clearing processes Use -m flag for mounted filesystems: fuser -vm <MOUNT_POINT>"
      },
      "filled_example": "fuser -v /mnt/share"
    },
    {
      "id": "w-user-activity",
      "name": "User Activity (Who is Logged In)",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "w",
      "description": "Show who is logged in and what they are doing, plus system load",
      "variables": [],
      "flag_explanations": {},
      "tags": [
        "DEFENSE",
        "ENUMERATION",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "QUICK_WIN",
        "RESOURCE_MONITORING",
        "USER_ACTIVITY"
      ],
      "success_indicators": [
        "USER",
        "TTY",
        "FROM",
        "LOGIN@",
        "IDLE",
        "WHAT",
        "load average"
      ],
      "failure_indicators": [
        "w: command not found"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "CRITICAL for defense monitoring.\n\nShows active users, their terminal, source IP (FROM), login time, idle time, and current command.\n\npractical tip:\nCheck FROM column for unexpected IPs, WHAT column for suspicious commands (shells, persistence scripts).\n\nTime estimate:\n<1 second.",
      "methodology_guidance": {
        "after_success": "Identify unauthorized users Check suspicious commands in WHAT column View login history: last-login-history Monitor for new logins in real-time"
      }
    },
    {
      "id": "who-logged-in",
      "name": "Who is Logged In (Detailed)",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "who -a",
      "description": "Display all information about logged-in users including login time and source",
      "variables": [],
      "flag_explanations": {
        "-a": "All - display all information (equivalent to -b -d --login -p -r -t -T -u)"
      },
      "tags": [
        "DEFENSE",
        "ENUMERATION",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "USER_ACTIVITY"
      ],
      "success_indicators": [
        "system boot",
        "LOGIN",
        "pts/"
      ],
      "failure_indicators": [
        "who: command not found"
      ],
      "next_steps": [],
      "alternatives": [
        "w-user-activity"
      ],
      "notes": "More detailed than 'users' command but less info than 'w'.\n\nShows boot time, runlevel, login processes.\n\nTime estimate:\n<1 second.",
      "methodology_guidance": {
        "after_success": "Check for unauthorized sessions View full login history: last-login-history Simple user list: users"
      }
    },
    {
      "id": "last-login-history",
      "name": "Login History",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "last -a",
      "description": "Display login history from wtmp log (who logged in, when, from where, how long)",
      "variables": [],
      "flag_explanations": {
        "-a": "Display hostname in last column"
      },
      "tags": [
        "DEFENSE",
        "ENUMERATION",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "USER_ACTIVITY"
      ],
      "success_indicators": [
        "USER",
        "TTY",
        "LOGIN TIME",
        "LOGOUT TIME",
        "DURATION"
      ],
      "failure_indicators": [
        "last: command not found",
        "wtmp begins"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "Reads /var/log/wtmp.\n\ndefense tip:\nLook for (1) Logins from unexpected IPs, (2) Short-lived sessions (in/out quickly = potential intrusion), (3) Logins at unusual hours.\n\nFor specific user:\nlast -a <USERNAME>.\n\nTime estimate:\n1-3 seconds.",
      "methodology_guidance": {
        "after_success": "Look for logins from unexpected IPs Check login times (unusual hours = suspicious) View failed login attempts: lastb-failed-logins View last login per user: lastlog-user-last"
      }
    },
    {
      "id": "lastlog-user-last",
      "name": "Last Login for All Users",
      "category": "monitoring",
      "subcategory": "resource-monitoring",
      "command": "lastlog",
      "description": "Display last login time for all users on the system",
      "variables": [],
      "flag_explanations": {},
      "tags": [
        "DEFENSE",
        "ENUMERATION",
        "LINUX",
        "MONITORING",
        "POST_EXPLOITATION",
        "USER_ACTIVITY"
      ],
      "success_indicators": [
        "Username",
        "Port",
        "From",
        "Latest"
      ],
      "failure_indicators": [
        "**Never logged in**",
        "lastlog: command not found"
      ],
      "next_steps": [],
      "alternatives": [
        "last-login-history"
      ],
      "notes": "Shows one entry per user (most recent login).\n\nReads /var/log/lastlog.\n\n'**Never logged in**' is normal for service accounts.\n\nTime estimate:\n1 second.",
      "methodology_guidance": {
        "after_success": "Identify dormant accounts (never logged in) Check service accounts for unexpected logins View specific user: lastlog -u <USERNAME>"
      }
    }
  ]
}