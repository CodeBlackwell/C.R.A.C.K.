{
  "commands": [
    {
      "id": "ps-winrm-credential-setup",
      "name": "PowerShell WinRM Credential Object Setup",
      "description": "Create PSCredential object for remote authentication via WinRM/PowerShell Remoting",
      "command": "$username = '<USERNAME>'; $password = '<PASSWORD>'; $secureString = ConvertTo-SecureString $password -AsPlaintext -Force; $credential = New-Object System.Management.Automation.PSCredential $username, $secureString",
      "category": "exploitation",
      "subcategory": "WINRM",
      "os": "WINDOWS",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Domain username (user or DOMAIN\\user format)",
          "example": "jen",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Plaintext password for the user",
          "example": "Nexus123!",
          "required": true
        }
      ],
      "flags": [
        {
          "flag": "ConvertTo-SecureString",
          "description": "Converts plaintext password to encrypted SecureString object required by PSCredential",
          "default_value": null
        },
        {
          "flag": "-AsPlaintext",
          "description": "Specifies that the input string is plaintext (not already encrypted)",
          "default_value": null
        },
        {
          "flag": "-Force",
          "description": "Bypasses the security warning about using plaintext passwords in scripts",
          "default_value": null
        }
      ],
      "examples": [
        {
          "command": "$username = 'jen'; $password = 'Nexus123!'; $secureString = ConvertTo-SecureString $password -AsPlaintext -Force; $credential = New-Object System.Management.Automation.PSCredential $username, $secureString",
          "description": "Create credential object for domain user 'jen' with password 'Nexus123!' for lateral movement",
          "context": "pentest lateral movement scenario"
        },
        {
          "command": "$username = 'CORP\\administrator'; $password = 'P@ssw0rd'; $secureString = ConvertTo-SecureString $password -AsPlaintext -Force; $credential = New-Object System.Management.Automation.PSCredential $username, $secureString",
          "description": "Create credential object using DOMAIN\\username format for domain administrator",
          "context": "Domain admin lateral movement"
        }
      ],
      "educational": {
        "purpose": "Create reusable credential object required for PowerShell remoting authentication without interactive password prompts",
        "manual_alternative": "Interactive authentication via Enter-PSSession without -Credential flag (prompts for password)",
        "common_failures": [
          "Missing -Force flag causes security warning and script halts",
          "Using single quotes in password string with $ variables causes expansion issues",
          "Not converting to SecureString results in PSCredential constructor error"
        ],
        "when_to_use": [
          "Before establishing WinRM sessions with New-PSSession",
          "Before using Invoke-Command for remote execution",
          "When you have credentials but need non-interactive authentication"
        ],
        "exam_relevance": "CRITICAL for security work lateral movement - required first step for all WinRM-based attacks",
        "time_estimate": "<10 seconds to create object"
      },
      "tags": [
        "POWERSHELL",
        "WINRM",
        "CREDENTIALS",
        "LATERAL_MOVEMENT"
      ],
      "prerequisites": [],
      "alternatives": [
        "wmi-creds-pscredential"
      ],
      "next_steps": [
        "ps-winrm-invoke-command",
        "winrm-enter-pssession",
        "winrm-new-pssession"
      ],
      "filled_example": "$username = 'jen'; $password = 'Nexus123!'; $secureString = ConvertTo-SecureString $password -AsPlaintext -Force; $credential = New-Object System.Management.Automation.PSCredential $username, $secureString"
    }
  ]
}