{
  "category": "exploitation",
  "commands": [
    {
      "id": "msf-db-init",
      "name": "Initialize Metasploit Database",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "sudo msfdb init",
      "description": "Initialize PostgreSQL database for Metasploit Framework to enable persistent storage of hosts, services, credentials, and loot",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "SETUP",
        "POSTGRESQL"
      ],
      "variables": [],
      "flag_explanations": {
        "init": "Create new database instance with msf and msf_test databases",
        "sudo": "Required for PostgreSQL service management and database creation"
      },
      "success_indicators": [
        "Starting database",
        "Creating database user 'msf'",
        "Creating databases 'msf'",
        "Creating initial database schema",
        "Database already started"
      ],
      "failure_indicators": [
        "PostgreSQL not installed",
        "Port 5432 already in use",
        "Permission denied",
        "Failed to connect"
      ],
      "next_steps": [
        "msf-console-start",
        "msf-db-status"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "already_initialized": "Run: sudo msfdb reinit (WARNING: deletes existing data)",
        "port_conflict": "Kill process using port 5432: sudo lsof -ti:5432 | xargs sudo kill -9",
        "connection_failed": "Restart PostgreSQL: sudo systemctl restart postgresql",
        "permission_denied": "Ensure user in postgres group: sudo usermod -aG postgres $USER"
      },
      "notes": "One-time setup per Kali installation.\n\nDatabase persists across reboots and msfconsole sessions.\n\nEnables workspace organization and automated storage of reconnaissance data.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-db-status",
      "name": "Check Metasploit Database Connection",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "db_status",
      "description": "Verify database connectivity from within msfconsole",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "VALIDATION"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Connected to msf",
        "Connection type: postgresql"
      ],
      "failure_indicators": [
        "Failed to connect to the database",
        "Database not connected",
        "No database support"
      ],
      "next_steps": [
        "msf-workspace-create",
        "msf-db-import"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-db-init",
        "msf-console-start"
      ],
      "troubleshooting": {
        "not_connected": "Run: msfdb start (outside msfconsole)",
        "database_not_initialized": "Run: sudo msfdb init (outside msfconsole)"
      },
      "notes": "Run this immediately after starting msfconsole to confirm database is accessible.\n\nWithout database, workspace features and automated storage will not function.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-console-start",
      "name": "Start Metasploit Console",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfconsole -q",
      "description": "Start Metasploit Framework console in quiet mode (skip ASCII banner for faster startup)",
      "tags": [
        "METASPLOIT",
        "CONSOLE",
        "FRAMEWORK"
      ],
      "variables": [],
      "flag_explanations": {
        "-q": "Quiet mode - suppress ASCII banner and version info (faster startup)",
        "-r <SCRIPT>": "Run resource script on startup (optional)",
        "-x '<COMMAND>'": "Execute command and return to shell (optional)"
      },
      "success_indicators": [
        "msf6 > prompt appears",
        "Metasploit tip displayed (if not using -q)",
        "Module counts shown in banner"
      ],
      "failure_indicators": [
        "command not found",
        "Failed to connect to the database",
        "Bundler errors",
        "Ruby version errors"
      ],
      "next_steps": [
        "msf-db-status",
        "msf-workspace-create",
        "msf-search-exploit"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-db-init"
      ],
      "troubleshooting": {
        "database_not_connected": "Run: sudo msfdb init (if first time) or msfdb start",
        "slow_startup": "Use -q flag to skip banner (saves 2-3 seconds)",
        "gem_errors": "Update gems: sudo gem update bundler && bundle install",
        "command_not_found": "Install Metasploit: sudo apt update && sudo apt install metasploit-framework"
      },
      "notes": "Console provides interactive interface to all Metasploit modules.\n\nUse -q flag for faster startup during engagements.\n\nExit with 'exit' or Ctrl+C.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-console-resource",
      "name": "Start Metasploit Console with Resource Script",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "msfconsole -q -r <RESOURCE_SCRIPT>",
      "description": "Start msfconsole and automatically execute commands from a resource script file",
      "tags": [
        "METASPLOIT",
        "AUTOMATION",
        "RESOURCE_SCRIPT"
      ],
      "variables": [
        {
          "name": "<RESOURCE_SCRIPT>",
          "description": "Path to .rc file containing Metasploit commands",
          "example": "~/listener.rc",
          "required": true
        }
      ],
      "flag_explanations": {
        "-q": "Quiet mode - skip banner for faster execution",
        "-r": "Execute resource script on startup"
      },
      "success_indicators": [
        "Processing <filename> for ERB directives",
        "resource (<filename>)> command output",
        "Commands from script execute sequentially"
      ],
      "failure_indicators": [
        "Failed to load resource script",
        "File not found",
        "Syntax error in script"
      ],
      "next_steps": [
        "msf-session-interact"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "file_not_found": "Use absolute path or ensure file exists in current directory",
        "syntax_errors": "Test script line-by-line in msfconsole first",
        "script_fails_silently": "Remove -q flag to see full output and error messages"
      },
      "notes": "Resource scripts automate repetitive tasks like setting up handlers, scanning, or post-exploitation.\n\nUseful for consistent multi-engagement setups.",
      "oscp_relevance": "medium",
      "filled_example": "msfconsole -q -r ~/listener.rc"
    },
    {
      "id": "msf-workspace-list",
      "name": "List Metasploit Workspaces",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "workspace",
      "description": "Display all workspaces in the Metasploit database.\nCurrent workspace is marked with asterisk.",
      "tags": [
        "METASPLOIT",
        "WORKSPACE",
        "DATABASE"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Workspace list displayed",
        "Current workspace marked with *",
        "default workspace shown if no custom workspaces exist"
      ],
      "failure_indicators": [
        "Database not connected",
        "No workspaces found (if database empty)"
      ],
      "next_steps": [
        "msf-workspace-create",
        "msf-workspace-switch"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-db-status"
      ],
      "troubleshooting": {
        "no_workspaces": "Create one with: workspace -a <NAME>",
        "database_error": "Check connection with: db_status"
      },
      "notes": "Workspaces organize data by engagement or target network.\n\nPrevents mixing reconnaissance data from different assessments.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-workspace-create",
      "name": "Create Metasploit Workspace",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "workspace -a <WORKSPACE_NAME>",
      "description": "Create new workspace to isolate hosts, services, and credentials for a specific engagement",
      "tags": [
        "METASPLOIT",
        "WORKSPACE",
        "ORGANIZATION"
      ],
      "variables": [
        {
          "name": "<WORKSPACE_NAME>",
          "description": "Unique name for workspace (alphanumeric, underscores, hyphens)",
          "example": "client_pentest_2024",
          "required": true
        }
      ],
      "flag_explanations": {
        "-a": "Add new workspace",
        "-d": "Delete workspace",
        "-r": "Rename workspace"
      },
      "success_indicators": [
        "Added workspace: <name>",
        "Workspace: <name> (confirms automatic switch to new workspace)"
      ],
      "failure_indicators": [
        "Workspace already exists",
        "Invalid workspace name",
        "Database not connected"
      ],
      "next_steps": [
        "msf-db-import",
        "msf-db-nmap"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-db-status"
      ],
      "troubleshooting": {
        "already_exists": "Use: workspace <NAME> to switch to existing workspace",
        "invalid_name": "Use alphanumeric characters, underscores, and hyphens only"
      },
      "notes": "Creating a workspace automatically switches to it.\n\nAll subsequent reconnaissance data (hosts, services, creds) will be stored in this workspace.",
      "oscp_relevance": "high",
      "filled_example": "workspace -a client_pentest_2024"
    },
    {
      "id": "msf-workspace-switch",
      "name": "Switch Metasploit Workspace",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "workspace <WORKSPACE_NAME>",
      "description": "Switch to different workspace to access its stored hosts, services, and credentials",
      "tags": [
        "METASPLOIT",
        "WORKSPACE",
        "NAVIGATION"
      ],
      "variables": [
        {
          "name": "<WORKSPACE_NAME>",
          "description": "Name of existing workspace to switch to",
          "example": "client_pentest_2024",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Workspace: <name> (confirmation message)"
      ],
      "failure_indicators": [
        "Workspace not found",
        "Unknown workspace"
      ],
      "next_steps": [
        "msf-db-hosts",
        "msf-db-services"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-workspace-create"
      ],
      "troubleshooting": {
        "workspace_not_found": "List available workspaces with: workspace",
        "case_sensitive": "Workspace names are case-sensitive - check exact spelling"
      },
      "notes": "Switching workspaces changes the context for all database queries (hosts, services, creds, loot).\n\nEach workspace is isolated.",
      "oscp_relevance": "medium",
      "filled_example": "workspace client_pentest_2024"
    },
    {
      "id": "msf-search-exploit",
      "name": "Search for Exploit Modules",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "search <QUERY> type:exploit",
      "description": "Search Metasploit module database for exploits matching service, CVE, or keyword",
      "tags": [
        "METASPLOIT",
        "SEARCH",
        "EXPLOIT_DISCOVERY"
      ],
      "variables": [
        {
          "name": "<QUERY>",
          "description": "Search term (service name, CVE ID, keyword, or platform)",
          "example": "apache",
          "required": true
        }
      ],
      "flag_explanations": {
        "type:exploit": "Filter results to exploit modules only (exclude auxiliary, post, etc)",
        "type:auxiliary": "Filter to auxiliary modules (scanners, fuzzers, etc)",
        "platform:<OS>": "Filter by target OS (linux, windows, osx, solaris, bsd, etc)",
        "cve:<CVE>": "Search by CVE number (e.g., cve:2021-44228)",
        "rank:<LEVEL>": "Filter by reliability (excellent, great, good, normal, average, low)",
        "app:<NAME>": "Filter by application name"
      },
      "success_indicators": [
        "Matching Modules list displayed",
        "Columns: #, Name, Disclosure Date, Rank, Check, Description",
        "Module count shown"
      ],
      "failure_indicators": [
        "No results found",
        "Database not connected (empty results)",
        "Invalid search syntax"
      ],
      "next_steps": [
        "msf-use-module",
        "msf-info-module"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-console-start"
      ],
      "troubleshooting": {
        "no_results": "Try broader search (remove filters, use partial name)",
        "too_many_results": "Add filters: type, platform, rank, or cve",
        "database_not_indexed": "Reinitialize database: sudo msfdb reinit"
      },
      "notes": "Use 'info <INDEX>' or 'info <MODULE_PATH>' for detailed module description before selection.\n\nRank 'excellent' indicates most reliable exploits.",
      "oscp_relevance": "high",
      "filled_example": "search apache type:exploit"
    },
    {
      "id": "msf-use-module",
      "name": "Activate Metasploit Module",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "use <MODULE_PATH>",
      "description": "Load and activate a module for configuration and execution.\nModule path or search index accepted.",
      "tags": [
        "METASPLOIT",
        "MODULE_SELECTION"
      ],
      "variables": [
        {
          "name": "<MODULE_PATH>",
          "description": "Full module path (e.g., exploit/unix/ftp/vsftpd_234_backdoor) or search result index number",
          "example": "exploit/multi/handler",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Prompt changes to show module type and path",
        "Example: msf6 exploit(multi/handler) >",
        "No error messages"
      ],
      "failure_indicators": [
        "Failed to load module",
        "Module not found",
        "Invalid module path"
      ],
      "next_steps": [
        "msf-show-options",
        "msf-info-module",
        "msf-show-payloads"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-search-exploit"
      ],
      "troubleshooting": {
        "module_not_found": "Verify path with: search <MODULE_NAME>",
        "outdated_path": "Module paths change - use search to find current path",
        "wrong_module_type": "Use correct prefix: exploit/, auxiliary/, post/, etc"
      },
      "notes": "After 'use', all commands (set, show options, run) operate in context of this module.\n\nUse 'back' to deselect module and return to main prompt.",
      "oscp_relevance": "high",
      "filled_example": "use exploit/multi/handler"
    },
    {
      "id": "msf-info-module",
      "name": "Display Module Information",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "info <MODULE_PATH>",
      "description": "Show detailed information about a module including description, authors, references, targets, and options",
      "tags": [
        "METASPLOIT",
        "MODULE_INFO",
        "DOCUMENTATION"
      ],
      "variables": [
        {
          "name": "<MODULE_PATH>",
          "description": "Module path or search result index",
          "example": "exploit/windows/smb/ms17_010_eternalblue",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Module details displayed (Name, Module, License, Rank, etc)",
        "Description section shown",
        "Basic options listed",
        "Available targets shown (if applicable)"
      ],
      "failure_indicators": [
        "Module not found",
        "Invalid path"
      ],
      "next_steps": [
        "msf-use-module"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-search-exploit"
      ],
      "troubleshooting": {
        "module_not_found": "Use search to find correct path"
      },
      "notes": "Review 'Rank' (reliability), 'Check supported' (can verify vulnerability before exploiting), and 'Module stability' before using unfamiliar modules.\n\n'Module side effects' warns of log entries or artifacts.",
      "oscp_relevance": "high",
      "filled_example": "info exploit/windows/smb/ms17_010_eternalblue"
    },
    {
      "id": "msf-show-options",
      "name": "Display Module Options",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "show options",
      "description": "List all configurable options for currently active module, including required settings and current values",
      "tags": [
        "METASPLOIT",
        "MODULE_CONFIG",
        "OPTIONS"
      ],
      "variables": [],
      "flag_explanations": {
        "show options": "Display basic module options",
        "show advanced": "Display advanced module options (not commonly changed)",
        "show evasion": "Display evasion options (if supported by module)",
        "show missing": "Display only required options that are not yet set"
      },
      "success_indicators": [
        "Options table displayed with columns: Name, Current Setting, Required, Description",
        "Payload options section (for exploit modules)",
        "Required column shows 'yes' for mandatory settings"
      ],
      "failure_indicators": [
        "No module selected",
        "Invalid command"
      ],
      "next_steps": [
        "msf-set-option"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-use-module"
      ],
      "troubleshooting": {
        "no_module_selected": "Use a module first with: use <MODULE_PATH>"
      },
      "notes": "Focus on 'Required:\nyes' options.\n\nSome options auto-fill from previous sessions.\n\nUse 'show missing' to see only unfilled required options.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-set-option",
      "name": "Set Module Option",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "set <OPTION> <VALUE>",
      "description": "Configure a module option with specific value.\nSetting applies to currently active module only.",
      "tags": [
        "METASPLOIT",
        "MODULE_CONFIG"
      ],
      "variables": [
        {
          "name": "<OPTION>",
          "description": "Option name from 'show options' output (case-insensitive)",
          "example": "RHOSTS",
          "required": true
        },
        {
          "name": "<VALUE>",
          "description": "Value to assign to option (IP, port, file path, etc)",
          "example": "192.168.45.100",
          "required": true
        }
      ],
      "flag_explanations": {
        "set": "Set option for current module only",
        "setg": "Set option globally (applies to all modules in session)",
        "unset": "Clear option value for current module",
        "unsetg": "Clear global option value"
      },
      "success_indicators": [
        "OPTION => VALUE confirmation message",
        "'show options' displays new value"
      ],
      "failure_indicators": [
        "Invalid option name",
        "No module selected"
      ],
      "next_steps": [
        "msf-exploit-run",
        "msf-show-options"
      ],
      "alternatives": [
        "msf-setg-option"
      ],
      "prerequisites": [
        "msf-use-module",
        "msf-show-options"
      ],
      "troubleshooting": {
        "option_not_recognized": "Check exact option name with: show options",
        "value_format_wrong": "Review description in 'show options' for expected format"
      },
      "notes": "Common options:\nRHOSTS (target IPs), RPORT (target port), LHOST (attacker IP), LPORT (attacker port).\n\nRHOSTS accepts single IP, range (192.168.1.1-50), CIDR (192.168.1.0/24), or file:path.",
      "oscp_relevance": "high",
      "filled_example": "set RHOSTS 192.168.45.100"
    },
    {
      "id": "msf-setg-option",
      "name": "Set Global Module Option",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "setg <OPTION> <VALUE>",
      "description": "Set option value globally - applies to all modules in current msfconsole session",
      "tags": [
        "METASPLOIT",
        "GLOBAL_CONFIG"
      ],
      "variables": [
        {
          "name": "<OPTION>",
          "description": "Option name (typically LHOST, LPORT for consistent attacker config)",
          "example": "LHOST",
          "required": true
        },
        {
          "name": "<VALUE>",
          "description": "Value to assign globally",
          "example": "192.168.45.5",
          "required": true
        }
      ],
      "flag_explanations": {
        "setg": "Set global option (persists across module switches)",
        "unsetg": "Clear global option"
      },
      "success_indicators": [
        "OPTION => VALUE confirmation",
        "Value appears in all subsequent modules that use this option"
      ],
      "failure_indicators": [
        "Invalid option name"
      ],
      "next_steps": [
        "msf-use-module"
      ],
      "alternatives": [
        "msf-set-option"
      ],
      "prerequisites": [
        "msf-console-start"
      ],
      "troubleshooting": {
        "option_overridden": "Module-specific 'set' takes precedence over 'setg'"
      },
      "notes": "Useful for attacker IP/port that stays constant across multiple exploits.\n\nGlobal options don't persist across msfconsole restarts - use resource scripts for permanent settings.",
      "oscp_relevance": "medium",
      "filled_example": "setg LHOST 192.168.45.5"
    },
    {
      "id": "msf-back",
      "name": "Exit Current Module",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "back",
      "description": "Deselect current module and return to main msfconsole prompt",
      "tags": [
        "METASPLOIT",
        "NAVIGATION"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Prompt changes back to 'msf6 >'",
        "Module context cleared"
      ],
      "failure_indicators": [
        "Already at main prompt"
      ],
      "next_steps": [
        "msf-search-exploit",
        "msf-use-module"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-use-module"
      ],
      "troubleshooting": {},
      "notes": "Module-specific options (set with 'set') are preserved if you return to same module.\n\nGlobal options (set with 'setg') persist regardless.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msf-db-import",
      "name": "Import Scan Results to Database",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "db_import <SCAN_FILE>",
      "description": "Import nmap XML, nessus, or other scan formats into Metasploit database for automated host/service population",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "IMPORT",
        "NMAP"
      ],
      "variables": [
        {
          "name": "<SCAN_FILE>",
          "description": "Path to scan results file (nmap XML, .nessus, etc)",
          "example": "/home/kali/scans/network.xml",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Importing data...",
        "Successfully imported hosts/services",
        "'hosts' and 'services' commands show imported data"
      ],
      "failure_indicators": [
        "File not found",
        "Unsupported file format",
        "Parse error"
      ],
      "next_steps": [
        "msf-db-hosts",
        "msf-db-services"
      ],
      "alternatives": [
        "msf-db-nmap"
      ],
      "prerequisites": [
        "msf-workspace-create"
      ],
      "troubleshooting": {
        "file_not_found": "Use absolute path or ensure file exists",
        "unsupported_format": "Use nmap XML format: nmap -oX scan.xml <TARGET>",
        "empty_import": "Verify scan file contains results (cat <FILE>)"
      },
      "notes": "Supported formats:\nnmap XML (-oX), nessus (.nessus), nmap grepable (-oG with limitations).\n\nXML format is most reliable.\n\nAfter import, use 'hosts' and 'services' to verify data loaded correctly.",
      "oscp_relevance": "high",
      "filled_example": "db_import /home/kali/scans/network.xml"
    },
    {
      "id": "msf-db-nmap",
      "name": "Run Nmap from Metasploit",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "db_nmap <NMAP_OPTIONS> <TARGET>",
      "description": "Execute nmap scan from within msfconsole and automatically import results to database",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "NMAP",
        "SCANNING"
      ],
      "variables": [
        {
          "name": "<NMAP_OPTIONS>",
          "description": "Nmap flags (same syntax as standalone nmap)",
          "example": "-sV -sC -p-",
          "required": false
        },
        {
          "name": "<TARGET>",
          "description": "Target IP, range, or CIDR notation",
          "example": "192.168.45.0/24",
          "required": true
        }
      ],
      "flag_explanations": {
        "-sV": "Service version detection",
        "-sC": "Default NSE scripts",
        "-p-": "Scan all 65535 ports",
        "-A": "Aggressive scan (OS, version, script, traceroute)"
      },
      "success_indicators": [
        "Nmap scan output displayed",
        "Results automatically stored in database",
        "'hosts' and 'services' show new entries"
      ],
      "failure_indicators": [
        "Nmap not found",
        "Permission denied (raw sockets require root)",
        "Database not connected"
      ],
      "next_steps": [
        "msf-db-hosts",
        "msf-db-services",
        "msf-db-vulns"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-workspace-create",
        "msf-db-status"
      ],
      "troubleshooting": {
        "permission_denied": "Start msfconsole with sudo: sudo msfconsole",
        "database_not_storing": "Verify connection with: db_status",
        "nmap_not_found": "Install nmap: sudo apt install nmap"
      },
      "notes": "db_nmap automatically imports results - no need for separate db_import.\n\nResults are stored in current workspace.\n\nUse standard nmap syntax - all flags supported.",
      "oscp_relevance": "high",
      "filled_example": "db_nmap -sV -sC -p- 192.168.45.0/24"
    },
    {
      "id": "msf-db-hosts",
      "name": "List Discovered Hosts",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "hosts",
      "description": "Display all hosts stored in current workspace's database",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "ENUMERATION"
      ],
      "variables": [],
      "flag_explanations": {
        "hosts": "List all hosts",
        "hosts -c <COLUMNS>": "Display specific columns only",
        "hosts -S <SEARCH>": "Search/filter hosts",
        "hosts -R": "Set RHOSTS to all hosts in database (for current module)"
      },
      "success_indicators": [
        "Host table displayed with address, MAC, name, OS, purpose",
        "Host count shown"
      ],
      "failure_indicators": [
        "No hosts in database",
        "Database not connected"
      ],
      "next_steps": [
        "msf-db-services"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-db-import"
      ],
      "troubleshooting": {
        "no_hosts": "Import scan results with: db_import <FILE> or db_nmap",
        "wrong_workspace": "Switch workspace with: workspace <NAME>"
      },
      "notes": "Use 'hosts -R' to automatically set RHOSTS option to all discovered hosts.\n\nFilter with:\nhosts -S <IP_PARTIAL> to find specific hosts.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-db-services",
      "name": "List Discovered Services",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "services",
      "description": "Display all services (open ports) stored in current workspace's database",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "SERVICES",
        "ENUMERATION"
      ],
      "variables": [],
      "flag_explanations": {
        "services": "List all services",
        "services -p <PORT>": "Filter by specific port number",
        "services -S <NAME>": "Search by service name",
        "services -R": "Set RHOSTS to all hosts with matching services (for current module)",
        "services -c <COLUMNS>": "Display specific columns only"
      },
      "success_indicators": [
        "Services table displayed with host, port, protocol, name, state, info",
        "Service count shown"
      ],
      "failure_indicators": [
        "No services in database",
        "Database not connected"
      ],
      "next_steps": [
        "msf-search-exploit",
        "msf-use-module"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-db-import"
      ],
      "troubleshooting": {
        "no_services": "Import scan with service detection: db_nmap -sV <TARGET>",
        "missing_versions": "Service versions require -sV flag in nmap scan"
      },
      "notes": "Filter by port to find all hosts with specific service:\nservices -p 445.\n\nUse 'services -p <PORT> -R' to auto-populate RHOSTS with all hosts running that service.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-db-vulns",
      "name": "List Discovered Vulnerabilities",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "vulns",
      "description": "Display vulnerabilities identified by Metasploit modules and stored in database",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "VULNERABILITIES"
      ],
      "variables": [],
      "flag_explanations": {
        "vulns": "List all vulnerabilities",
        "vulns -p <PORT>": "Filter by port",
        "vulns -h <HOST>": "Filter by host"
      },
      "success_indicators": [
        "Vulnerabilities table with timestamp, host, name, references",
        "CVE/reference links shown"
      ],
      "failure_indicators": [
        "No vulnerabilities in database",
        "Database not connected"
      ],
      "next_steps": [
        "msf-search-exploit"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-db-import"
      ],
      "troubleshooting": {
        "no_vulns": "Run auxiliary/scanner modules to detect vulnerabilities",
        "outdated_checks": "Update Metasploit: sudo msfupdate"
      },
      "notes": "Vulnerabilities are added by check-capable modules and some auxiliary scanners.\n\nNot all vulnerabilities are automatically detected - manual module execution may be required.",
      "oscp_relevance": "medium"
    },
    {
      "id": "msf-db-creds",
      "name": "List Stored Credentials",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "creds",
      "description": "Display all captured credentials (passwords, hashes, tokens) stored in database",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "CREDENTIALS",
        "POST_EXPLOITATION"
      ],
      "variables": [],
      "flag_explanations": {
        "creds": "List all credentials",
        "creds -p <PORT>": "Filter by service port",
        "creds -t <TYPE>": "Filter by type (password, hash, etc)"
      },
      "success_indicators": [
        "Credentials table with host, service, public, private, realm, type",
        "Credential count shown"
      ],
      "failure_indicators": [
        "No credentials in database",
        "Database not connected"
      ],
      "next_steps": [
        "evil-winrm-hash"
      ],
      "alternatives": [],
      "prerequisites": [
        "msf-db-status"
      ],
      "troubleshooting": {
        "no_creds": "Credentials added by successful auxiliary/scanner modules or post-exploitation modules"
      },
      "notes": "Credentials automatically stored by modules like auxiliary/scanner/ssh/ssh_login, post/windows/gather/hashdump, load kiwi (mimikatz).\n\nExport with:\ncreds -o creds.txt",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-workspace-add",
      "name": "Add New Metasploit Workspace",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "workspace -a <WORKSPACE_NAME>",
      "example": "workspace -a oscp_lab",
      "description": "Create and switch to a new workspace for organizing engagement data",
      "tags": [
        "METASPLOIT",
        "WORKSPACE",
        "DATABASE",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<WORKSPACE_NAME>",
          "description": "Name for the new workspace",
          "example": "oscp_lab",
          "required": true
        }
      ],
      "flag_explanations": {
        "-a": "Add new workspace and automatically switch to it"
      },
      "success_indicators": [
        "Added workspace:",
        "Workspace:"
      ],
      "failure_indicators": [
        "Workspace already exists",
        "Database not connected"
      ],
      "notes": "Creating workspace automatically switches to it. All subsequent hosts, services, and credentials stored in this workspace.",
      "oscp_relevance": "high",
      "filled_example": "workspace -a oscp_lab"
    },
    {
      "id": "msf-workspace-delete",
      "name": "Delete Metasploit Workspace",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "workspace -d <WORKSPACE_NAME>",
      "example": "workspace -d old_engagement",
      "description": "Delete a workspace and all its stored data (hosts, services, credentials)",
      "tags": [
        "METASPLOIT",
        "WORKSPACE",
        "DATABASE",
        "OSCP:MEDIUM"
      ],
      "variables": [
        {
          "name": "<WORKSPACE_NAME>",
          "description": "Name of workspace to delete",
          "example": "old_engagement",
          "required": true
        }
      ],
      "flag_explanations": {
        "-d": "Delete workspace and all associated data (WARNING: irreversible)"
      },
      "success_indicators": [
        "Deleted workspace:"
      ],
      "failure_indicators": [
        "Workspace not found",
        "Cannot delete current workspace"
      ],
      "notes": "Cannot delete currently active workspace. Switch to different workspace first with 'workspace <OTHER>'.",
      "oscp_relevance": "medium",
      "filled_example": "workspace -d old_engagement"
    },
    {
      "id": "msf-hosts-list",
      "name": "List All Discovered Hosts",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "hosts",
      "description": "Display all hosts discovered and stored in current workspace database",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "ENUMERATION",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "hosts": "List all hosts in current workspace",
        "-c <COLUMNS>": "Display specific columns (address, mac, name, os_name)",
        "-S <SEARCH>": "Search/filter hosts by string",
        "-R": "Set RHOSTS to all hosts (for current module)"
      },
      "success_indicators": [
        "Host table displayed",
        "address, mac, name, os columns shown"
      ],
      "failure_indicators": [
        "No hosts found",
        "Database not connected"
      ],
      "notes": "Use 'hosts -R' to automatically populate RHOSTS with all discovered hosts for scanning modules.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-services-filter-port",
      "name": "Filter Services by Port",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "services -p <PORT>",
      "example": "services -p 445",
      "description": "List all hosts with a specific port open from database",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "SERVICES",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<PORT>",
          "description": "Port number to filter by",
          "example": "445",
          "required": true
        }
      ],
      "flag_explanations": {
        "-p": "Filter services by port number",
        "-R": "Set RHOSTS to all hosts with matching port (for exploits)"
      },
      "success_indicators": [
        "Services filtered by port displayed",
        "Host:port:service info shown"
      ],
      "failure_indicators": [
        "No services found on port",
        "Database not connected"
      ],
      "notes": "Combine with -R to auto-populate RHOSTS: 'services -p 445 -R' sets all SMB hosts as targets.",
      "oscp_relevance": "high",
      "filled_example": "services -p 445"
    },
    {
      "id": "msf-db-export",
      "name": "Export Database to File",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "db_export -f <FORMAT> <FILENAME>",
      "example": "db_export -f xml engagement_data.xml",
      "description": "Export all workspace data (hosts, services, credentials) to file for backup or reporting",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "EXPORT",
        "OSCP:MEDIUM"
      ],
      "variables": [
        {
          "name": "<FORMAT>",
          "description": "Export format (xml or pwdump)",
          "example": "xml",
          "required": true
        },
        {
          "name": "<FILENAME>",
          "description": "Output filename",
          "example": "engagement_data.xml",
          "required": true
        }
      ],
      "flag_explanations": {
        "-f xml": "Export in XML format (full data)",
        "-f pwdump": "Export credentials in pwdump format"
      },
      "success_indicators": [
        "Starting export",
        "Finished export"
      ],
      "failure_indicators": [
        "Export failed",
        "Permission denied"
      ],
      "notes": "XML format exports complete workspace data. Use pwdump format for credential-only export compatible with hashcat/john.",
      "oscp_relevance": "medium",
      "filled_example": "db_export -f xml engagement_data.xml"
    },
    {
      "id": "msf-search-keyword",
      "name": "Search Modules by Keyword",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "search <KEYWORD>",
      "example": "search eternalblue",
      "description": "Search all Metasploit modules by name, description, or keyword",
      "tags": [
        "METASPLOIT",
        "SEARCH",
        "MODULE_DISCOVERY",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<KEYWORD>",
          "description": "Search term (module name, service, vulnerability)",
          "example": "eternalblue",
          "required": true
        }
      ],
      "flag_explanations": {
        "search": "Search module database",
        "type:exploit": "Filter to exploit modules only",
        "type:auxiliary": "Filter to auxiliary modules only",
        "platform:windows": "Filter by target platform"
      },
      "success_indicators": [
        "Matching Modules list displayed",
        "Module paths shown"
      ],
      "failure_indicators": [
        "No results found"
      ],
      "notes": "Combine filters for precise results: 'search eternalblue type:exploit platform:windows'",
      "oscp_relevance": "high",
      "filled_example": "search eternalblue"
    },
    {
      "id": "msf-search-cve",
      "name": "Search Modules by CVE",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "search cve:<CVE_ID>",
      "example": "search cve:2017-0144",
      "description": "Search for Metasploit modules by CVE identifier",
      "tags": [
        "METASPLOIT",
        "SEARCH",
        "CVE",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<CVE_ID>",
          "description": "CVE identifier (year-number format)",
          "example": "2017-0144",
          "required": true
        }
      ],
      "flag_explanations": {
        "cve:": "Search by CVE identifier (omit CVE- prefix)"
      },
      "success_indicators": [
        "Modules matching CVE displayed",
        "exploit/windows/smb/ms17_010_eternalblue shown"
      ],
      "failure_indicators": [
        "No results found for CVE"
      ],
      "notes": "Use CVE year-number format without 'CVE-' prefix. Example: cve:2021-44228 for Log4Shell.",
      "oscp_relevance": "high",
      "filled_example": "search cve:2017-0144"
    },
    {
      "id": "msf-search-platform",
      "name": "Search Modules by Platform",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "search platform:<PLATFORM>",
      "example": "search platform:windows",
      "description": "Search for Metasploit modules by target platform",
      "tags": [
        "METASPLOIT",
        "SEARCH",
        "PLATFORM",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<PLATFORM>",
          "description": "Target platform (windows, linux, osx, unix, etc.)",
          "example": "windows",
          "required": true
        }
      ],
      "flag_explanations": {
        "platform:": "Filter by target OS platform"
      },
      "success_indicators": [
        "Modules for platform displayed",
        "exploit/* modules shown"
      ],
      "failure_indicators": [
        "No results found"
      ],
      "notes": "Combine with other filters: 'search platform:windows type:exploit smb'. Common platforms: windows, linux, osx, unix, android.",
      "oscp_relevance": "high",
      "filled_example": "search platform:windows"
    },
    {
      "id": "msf-search-type",
      "name": "Search Modules by Type",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "search type:<TYPE>",
      "example": "search type:exploit",
      "description": "Search for Metasploit modules by module type",
      "tags": [
        "METASPLOIT",
        "SEARCH",
        "MODULE_TYPE",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TYPE>",
          "description": "Module type (exploit, auxiliary, post, payload, encoder, nop)",
          "example": "exploit",
          "required": true
        }
      ],
      "flag_explanations": {
        "type:": "Filter by module type (exploit, auxiliary, post, payload, encoder, nop)"
      },
      "success_indicators": [
        "Modules of type displayed"
      ],
      "failure_indicators": [
        "No results found"
      ],
      "notes": "Types: exploit (attack), auxiliary (scan/enum), post (post-exploitation), payload (shellcode). Combine: 'search type:exploit smb'.",
      "oscp_relevance": "high",
      "filled_example": "search type:exploit"
    },
    {
      "id": "msf-services-list",
      "name": "List All Discovered Services",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "services",
      "description": "Display all services (open ports) stored in current workspace database",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "SERVICES",
        "ENUMERATION",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "services": "List all services in current workspace",
        "-p <PORT>": "Filter by port number",
        "-S <NAME>": "Search by service name",
        "-R": "Set RHOSTS to all matching hosts"
      },
      "success_indicators": [
        "Services table displayed",
        "host, port, protocol, name columns shown"
      ],
      "failure_indicators": [
        "No services in database",
        "Database not connected"
      ],
      "notes": "Shows services from db_nmap or db_import. Filter with -p <port> to find all hosts with specific service. Use -R to set RHOSTS automatically.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-creds-list",
      "name": "List Stored Credentials",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "creds",
      "description": "Display all credentials (passwords, hashes) stored in Metasploit database",
      "tags": [
        "METASPLOIT",
        "DATABASE",
        "CREDENTIALS",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "creds": "List all credentials in current workspace",
        "-p <PORT>": "Filter by service port",
        "-t <TYPE>": "Filter by credential type (password, hash)"
      },
      "success_indicators": [
        "Credentials table displayed",
        "host, service, public, private columns shown"
      ],
      "failure_indicators": [
        "No credentials in database",
        "Database not connected"
      ],
      "notes": "Shows credentials captured by successful brute force modules. Export with: creds -o creds.txt. Use captured creds with pass-the-hash attacks.",
      "oscp_relevance": "high"
    },
    {
      "id": "msf-show-advanced",
      "name": "Show Advanced Module Options",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "show advanced",
      "description": "Display advanced configuration options for current module",
      "tags": [
        "METASPLOIT",
        "MODULE_CONFIG",
        "ADVANCED",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {
        "show advanced": "Display advanced options not shown in 'show options'"
      },
      "success_indicators": [
        "Advanced options table displayed"
      ],
      "failure_indicators": [
        "No module selected"
      ],
      "notes": "Shows hidden options like timeouts, encoding, proxies, and evasion settings. Useful for troubleshooting or evading detection. Most OSCP scenarios don't require advanced options.",
      "oscp_relevance": "medium"
    }
  ]
}