{
  "commands": [
    {
      "id": "crackmapexec-validate-admin",
      "name": "CrackMapExec - Validate Credentials and Admin Rights",
      "description": "Validate domain credentials and check for local administrator privileges on target systems.\nPwn3d! indicator shows which systems grant local admin access.",
      "command": "crackmapexec smb <TARGET> -u <USERNAME> -p '<PASSWORD>' -d <DOMAIN>",
      "category": "enumeration",
      "subcategory": "active-directory",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP, hostname, or subnet (e.g., 192.168.50.0/24 to scan entire network)",
          "example": "192.168.50.75",
          "required": true
        },
        {
          "name": "<USERNAME>",
          "description": "Domain username to validate",
          "example": "dave",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Password to validate (use quotes for special characters)",
          "example": "Flowers1",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "Active Directory domain name",
          "example": "corp.com",
          "required": true
        }
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "CREDENTIAL_VALIDATION",
        "ADMIN_CHECK",
        "SMB",
        "LINUX",
        "QUICK_WIN"
      ],
      "flag_explanations": {
        "smb": "Use SMB protocol for validation",
        "-u": "Username to test",
        "-p": "Password to test",
        "-d": "Domain name for domain authentication",
        "--shares": "Enumerate accessible shares after successful authentication",
        "--sam": "Dump SAM database if local admin (requires Pwn3d!)",
        "--lsa": "Dump LSA secrets if local admin (requires Pwn3d!)"
      },
      "success_indicators": [
        "[+]",
        "(Pwn3d!)",
        "corp.com\\dave:Flowers1"
      ],
      "failure_indicators": [
        "[-]",
        "STATUS_LOGON_FAILURE",
        "STATUS_ACCESS_DENIED"
      ],
      "next_steps": [
        "psexec-impacket-shell",
        "smbexec-impacket-fileless",
        "wmiexec-shell",
        "secretsdump-hashes",
        "crackmapexec-sam-dump"
      ],
      "alternatives": [
        "kerbrute-validate-creds",
        "pth-evil-winrm",
        "ftp-connect"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Invalid credentials. Verify username and password are correct. Check for typos.",
        "STATUS_ACCESS_DENIED": "Valid credentials but access denied. User may be restricted or disabled.",
        "[+] but no Pwn3d!": "Valid credentials but NOT local admin on this system. Try other systems in subnet: crackmapexec smb 192.168.50.0/24 -u <USER> -p '<PASS>' -d <DOMAIN>"
      },
      "notes": "CRITICAL certification skill:\nValidate credentials and identify local admin rights in one command.\n\nPWND INDICATOR:\nPwn3d! means user has LOCAL ADMINISTRATOR privileges on the target system = full system compromise possible.\n\nOutput examples:\n[+] corp.com\\dave:Flowers1 = Valid credentials but NOT admin.\n\n[+] corp.com\\dave:Flowers1 (Pwn3d!) = Valid credentials AND local admin.\n\nWHY THIS WORKS:\nCrackMapExec authenticates via SMB and attempts to access ADMIN$ share or perform privileged operations.\n\nIf successful, user is local admin.\n\nNOISE LEVEL:\nLow for single validation check.\n\nTIME ESTIMATE:\n2-5 seconds per host.\n\nSUBNET SCANNING:\nUse CIDR notation to find systems where user is admin:\ncrackmapexec smb 192.168.50.0/24 -u dave -p 'Flowers1' -d corp.com.\n\nThis scans entire subnet and shows which systems display Pwn3d! certification TIP:\nAfter password spraying, immediately validate found credentials to identify admin access.\n\nLocal admin on one workstation can lead to lateral movement and domain admin compromise.\n\nBONUS:\nAdd --shares flag to see accessible shares, --sam to dump local password hashes (requires Pwn3d!), --lsa to dump cached domain credentials (requires Pwn3d!).\n\nExample full validation:\ncrackmapexec smb <TARGET> -u <USER> -p '<PASS>' -d <DOMAIN> --shares --sam --lsa",
      "filled_example": "crackmapexec smb 192.168.50.75 -u dave -p 'Flowers1' -d corp.com"
    },
    {
      "id": "kerbrute-validate-creds",
      "name": "Kerbrute - Quick Credential Validation",
      "description": "Rapidly validate domain credentials via Kerberos pre-authentication.\nNo full login required - minimal network footprint with just 2 UDP packets.",
      "command": "kerbrute passwordspray -d <DOMAIN> --dc <DC_IP> <USERFILE> '<PASSWORD>'",
      "category": "enumeration",
      "subcategory": "active-directory",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Active Directory domain name (FQDN)",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<DC_IP>",
          "description": "Domain controller IP address",
          "example": "192.168.50.70",
          "required": true
        },
        {
          "name": "<USERFILE>",
          "description": "File containing single username to validate (or use multi-user file to validate password across multiple accounts)",
          "example": "single_user.txt",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Password to validate",
          "example": "Nexus123!",
          "required": true
        }
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "CREDENTIAL_VALIDATION",
        "KERBEROS",
        "LINUX",
        "WINDOWS",
        "QUICK_WIN"
      ],
      "flag_explanations": {
        "passwordspray": "Password spraying mode (also works for single user validation)",
        "-d": "Domain name (FQDN)",
        "--dc": "Domain controller IP address"
      },
      "success_indicators": [
        "[+] VALID LOGIN:",
        "@corp.com"
      ],
      "failure_indicators": [
        "Network error",
        "Couldn't find any KDCs",
        "Done! Tested 1 logins (0 successes)"
      ],
      "next_steps": [
        "crackmapexec-validate-admin",
        "pth-evil-winrm",
        "ftp-connect"
      ],
      "alternatives": [
        "crackmapexec-validate-admin",
        "ftp-connect",
        "pth-evil-winrm"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Couldn't find any KDCs": "DC IP incorrect or port 88 blocked. Verify: sudo nmap -p 88 -Pn -sU -v <DC_IP>",
        "0 successes": "Invalid credentials. Verify username and password are correct.",
        "Need to create single user file": "Create file: echo 'username' > single_user.txt"
      },
      "notes": "FASTEST way to validate domain credentials without full authentication.\n\nUses Kerberos AS-REQ to test if credentials are valid.\n\nONLY 2 UDP PACKETS - stealthier than SMB/RDP login attempts.\n\nNOISE LEVEL:\nMinimal - only generates Event ID 4768 (TGT request) for valid creds or Event ID 4771 (pre-auth failed) for invalid.\n\nSPEED:\n<1 second for single validation.\n\nLIMITATION:\nOnly validates credentials are correct, does NOT check admin rights (use crackmapexec-validate-admin for that).\n\nWHY THIS WORKS:\nKerberos pre-authentication requires encrypted timestamp using user's password hash.\n\nIf credentials valid, KDC issues TGT.\n\nIf invalid, KDC returns pre-auth error.\n\nTIME ESTIMATE:\n<5 seconds.\n\nUSE CASES:\n(1) Quick validation of credentials found during engagement.\n\n(2) Batch validation of multiple username:password pairs.\n\n(3) Pre-check before attempting noisy SMB/RDP login.\n\ncertification TIP:\nUse this for QUICK validation (\"are these creds valid?\"), then use crackmapexec-validate-admin to check if user is local admin somewhere.\n\nKerbrute doesn't show admin rights, only credential validity.\n\nFor single user validation, create file:\necho 'pete' > user.txt && kerbrute passwordspray -d corp.com --dc 192.168.50.70 user.txt 'Nexus123!'",
      "methodology_guidance": {
        "after_success": "impacket-getTGT"
      },
      "filled_example": "kerbrute passwordspray -d corp.com --dc 192.168.50.70 single_user.txt 'Nexus123!'"
    },
    {
      "id": "cme-smb-auth-test",
      "name": "CrackMapExec SMB Authentication Test",
      "category": "enumeration",
      "subcategory": "active-directory",
      "command": "crackmapexec smb <TARGET> -u <USER> -p '<PASS>'",
      "example": "crackmapexec smb 192.168.50.70 -u Administrator -p 'Password123!'",
      "description": "Test SMB authentication with credentials. Look for Pwn3d! indicator for local admin access.",
      "tags": [
        "CRACKMAPEXEC",
        "SMB",
        "CREDENTIAL_VALIDATION"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP or range",
          "example": "192.168.50.70",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "Administrator",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Password123!",
          "required": true
        }
      ],
      "flag_explanations": {
        "smb": "Use SMB protocol",
        "-u": "Username",
        "-p": "Password",
        "-d": "Domain (optional)",
        "-H": "NTLM hash instead of password"
      },
      "success_indicators": [
        "[+]",
        "(Pwn3d!)"
      ],
      "failure_indicators": [
        "[-]",
        "STATUS_LOGON_FAILURE"
      ],
      "notes": "[+] = valid creds, (Pwn3d!) = local admin. Use -H for hash. Add -d for domain auth.",
      "filled_example": "crackmapexec smb 192.168.50.70 -u Administrator -p 'Password123!'"
    }
  ]
}