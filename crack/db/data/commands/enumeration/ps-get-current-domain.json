{
  "commands": [
    {
      "id": "ps-get-current-domain",
      "name": "PowerShell Get Current Domain Information",
      "description": "Retrieve current Active Directory domain information using .NET System.DirectoryServices.ActiveDirectory",
      "command": "[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()",
      "category": "ENUMERATION",
      "subcategory": "ACTIVE_DIRECTORY",
      "os": "WINDOWS",
      "variables": [],
      "flags": [],
      "examples": [
        {
          "command": "[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()",
          "description": "Get comprehensive domain information (name, forest, domain controllers, etc.)",
          "context": "Initial AD environment reconnaissance"
        },
        {
          "command": "([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).Name",
          "description": "Extract just the domain name (e.g., corp.local)",
          "context": "Quick domain name verification"
        },
        {
          "command": "([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).DomainControllers | Select-Object Name,IPAddress",
          "description": "List all domain controllers with their names and IP addresses",
          "context": "DC discovery for targeting"
        },
        {
          "command": "([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).PdcRoleOwner.Name",
          "description": "Identify Primary Domain Controller (PDC) - highest value target",
          "context": "High-value target identification"
        },
        {
          "command": "([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).Forest.Name",
          "description": "Get forest name (useful for multi-domain environments)",
          "context": "Forest topology mapping"
        }
      ],
      "educational": {
        "purpose": "Quick domain information gathering using built-in .NET classes - no tools, no file uploads, minimal detection footprint",
        "manual_alternative": "PowerView: Get-Domain | Import-Module PowerView.ps1 required)",
        "common_failures": [
          "Not on domain-joined machine - method requires domain authentication context",
          "Network connectivity issues to domain controller",
          "Returns object - must access properties (.Name, .DomainControllers, etc.) for specific values"
        ],
        "when_to_use": [
          "First step after gaining access to domain-joined Windows workstation",
          "Before lateral movement - identify domain controllers and PDC",
          "When you need domain context without importing PowerView",
          "OSCP exam initial AD enumeration phase"
        ],
        "exam_relevance": "HIGH - Immediate domain awareness without tool uploads. Essential first command on domain-joined hosts.",
        "time_estimate": "<5 seconds",
        "technical_notes": [
          "Returns System.DirectoryServices.ActiveDirectory.Domain object",
          "Automatically uses current user's domain credentials",
          "Provides: Domain name, Forest name, DC list, FSMO role holders",
          "PDC (Primary Domain Controller) is often highest-value target for attacks",
          "DomainControllers property returns collection of DC objects with Name/IPAddress/OSVersion"
        ]
      },
      "oscp_priority": "HIGH",
      "tags": [
        "POWERSHELL",
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "DOMAIN_CONTROLLERS",
        "OSCP:HIGH",
        "NO_TOOLS_REQUIRED"
      ],
      "related_commands": [
        "ps-ldap-directorysearcher",
        "ps-get-group-members-basic",
        "powerview-get-domain"
      ],
      "common_properties": {
        "Name": "Domain DNS name (e.g., corp.local)",
        "Forest": "Forest object containing forest name and domains",
        "DomainControllers": "Collection of all domain controllers",
        "PdcRoleOwner": "Primary Domain Controller (PDC Emulator FSMO role)",
        "RidRoleOwner": "RID Master FSMO role holder",
        "InfrastructureRoleOwner": "Infrastructure Master FSMO role holder",
        "Parent": "Parent domain (if child domain)",
        "Children": "Child domains (if any)"
      },
      "prerequisites": [
        "evil-winrm-shell"
      ],
      "alternatives": [
        "powerview-get-netdomain"
      ],
      "next_steps": [
        "get-aduser",
        "powerview-get-netuser-all",
        "ldapsearch-ad"
      ]
    }
  ]
}