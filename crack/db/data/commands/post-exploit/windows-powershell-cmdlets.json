{
  "metadata": {
    "category": "post-exploit",
    "subcategory": "windows-powershell-native-cmdlets",
    "description": "Native Windows PowerShell cmdlets for enumeration and privilege escalation. These are built-in cmdlets that do not require external modules like PowerView or PowerUp.",
    "author": "pentest Reference",
    "version": "1.0",
    "last_updated": "2025-11-09"
  },
  "commands": [
    {
      "id": "get-aduser",
      "name": "Get Active Directory User",
      "category": "enumeration",
      "command": "Get-ADUser -Identity <USERNAME> -Properties *",
      "description": "Query Active Directory user account using native AD PowerShell module. Returns comprehensive user properties including group memberships, account settings, and attributes. Requires Active Directory PowerShell module to be installed.",
      "tags": [
        "POWERSHELL",
        "AD_ENUM",
        "NATIVE_CMDLET"
      ],
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "User SamAccountName or Distinguished Name to query (use -Filter * for all users)",
          "example": "Administrator",
          "required": true
        }
      ],
      "output_analysis": [
        "SamAccountName: Username",
        "DistinguishedName: Full LDAP path",
        "MemberOf: Group memberships (DN format)",
        "Enabled: Account status (True/False)",
        "PasswordLastSet: Password age",
        "LastLogonDate: Last authentication time",
        "ServicePrincipalNames: SPNs if service account (Kerberoastable)",
        "AdminCount: If 1, indicates protected admin object"
      ],
      "common_uses": [
        "Query specific user account details",
        "Enumerate all domain users with -Filter *",
        "Identify service accounts via ServicePrincipalNames",
        "Check user group memberships",
        "Find accounts with old passwords"
      ],
      "prerequisites": [
        "import-module-activedirectory"
      ],
      "next_steps": [
        "get-adgroup",
        "get-adgroupmember"
      ],
      "alternatives": [
        "powerview-get-netuser",
        "net-user-domain-list"
      ],
      "success_indicators": [
        "Returns user object with populated properties",
        "No access denied errors",
        "Multiple properties displayed"
      ],
      "failure_indicators": [
        "Module 'ActiveDirectory' not found",
        "Cannot find user",
        "Access denied",
        "Unable to contact domain controller"
      ],
      "flag_explanations": {
        "-Identity": "Specific user to query (SamAccountName, DN, GUID, or SID)",
        "-Filter": "Filter criteria (use * for all users, 'Enabled -eq $true' for active users)",
        "-Properties": "Properties to retrieve (* for all, or comma-separated list)",
        "-SearchBase": "LDAP path to search within (e.g., 'OU=Users,DC=domain,DC=local')"
      },
      "troubleshooting": {
        "Module not found": "Install-WindowsFeature RSAT-AD-PowerShell (Server) or RSAT (Desktop)",
        "Cannot find user": "Verify username spelling or use -Filter for wildcard search",
        "Access denied": "User may lack read permissions on user objects",
        "No domain controller": "Check network connectivity: nltest /dclist:<domain>"
      },
      "notes": "Native alternative to PowerView's Get-NetUser.\n\nRequires AD PowerShell module (part of RSAT).\n\nFor all users:\nGet-ADUser -Filter * -Properties *.\n\nFor service accounts:\nGet-ADUser -Filter {ServicePrincipalName -like '*'} -Properties ServicePrincipalNames.\n\nManual alternative:\nnet user <username> /domain",
      "references": [
        {
          "title": "Get-ADUser Documentation",
          "url": "https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-aduser"
        }
      ],
      "filled_example": "Get-ADUser -Identity Administrator -Properties *"
    },
    {
      "id": "get-adgroup",
      "name": "Get Active Directory Group",
      "category": "enumeration",
      "command": "Get-ADGroup -Identity \"<GROUPNAME>\" -Properties *",
      "description": "Query Active Directory group information using native AD PowerShell module. Returns group properties, members, and group scope. Critical for identifying privileged groups and their memberships.",
      "tags": [
        "POWERSHELL",
        "AD_ENUM",
        "NATIVE_CMDLET"
      ],
      "variables": [
        {
          "name": "<GROUPNAME>",
          "description": "Group name to query (use -Filter * for all groups)",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "output_analysis": [
        "SamAccountName: Group name",
        "DistinguishedName: Full LDAP path",
        "GroupScope: DomainLocal, Global, or Universal",
        "GroupCategory: Security or Distribution",
        "Members: User and group DNs (use Get-ADGroupMember for details)",
        "AdminCount: If 1, indicates privileged group"
      ],
      "common_uses": [
        "Query specific privileged group",
        "Enumerate all domain groups with -Filter *",
        "Identify custom administrative groups",
        "Check group membership",
        "Find nested groups"
      ],
      "prerequisites": [
        "import-module-activedirectory"
      ],
      "next_steps": [
        "get-adgroupmember"
      ],
      "alternatives": [
        "powerview-get-netgroup",
        "net-group-domain-list"
      ],
      "success_indicators": [
        "Returns group object with properties",
        "No access denied errors",
        "Members property populated"
      ],
      "failure_indicators": [
        "Module 'ActiveDirectory' not found",
        "Cannot find group",
        "Access denied"
      ],
      "flag_explanations": {
        "-Identity": "Group name, DN, GUID, or SID to query",
        "-Filter": "Filter criteria (e.g., * for all, 'GroupCategory -eq \"Security\"')",
        "-Properties": "Properties to retrieve (* for all)",
        "-SearchBase": "LDAP search base"
      },
      "troubleshooting": {
        "Module not found": "Install-WindowsFeature RSAT-AD-PowerShell",
        "Cannot find group": "Try wildcard: Get-ADGroup -Filter 'Name -like \"*Admin*\"'",
        "Access denied": "User lacks read permissions on group objects"
      },
      "notes": "Priority Groups:\n'Domain Admins', 'Enterprise Admins', 'Backup Operators', 'Account Operators', 'Server Operators'.\n\nNative alternative to PowerView's Get-NetGroup.\n\nFor all groups:\nGet-ADGroup -Filter * -Properties *.\n\nManual alternative:\nnet group \"<group>\" /domain",
      "references": [
        {
          "title": "Get-ADGroup Documentation",
          "url": "https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-adgroup"
        }
      ],
      "filled_example": "Get-ADGroup -Identity \"Domain Admins\" -Properties *"
    },
    {
      "id": "get-adgroupmember",
      "name": "Get Active Directory Group Members",
      "category": "enumeration",
      "command": "Get-ADGroupMember -Identity \"<GROUPNAME>\" -Recursive",
      "description": "Retrieve members of an Active Directory group including nested group memberships. The -Recursive flag expands nested groups to show all effective members. Critical for mapping privilege escalation paths.",
      "tags": [
        "POWERSHELL",
        "AD_ENUM",
        "NATIVE_CMDLET"
      ],
      "variables": [
        {
          "name": "<GROUPNAME>",
          "description": "Group name to enumerate members",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "output_analysis": [
        "SamAccountName: Member username",
        "DistinguishedName: Member DN",
        "objectClass: user, group, or computer",
        "Recursive results show all nested memberships"
      ],
      "common_uses": [
        "Enumerate Domain Admins members",
        "Find all users in administrative groups (recursive)",
        "Identify nested group memberships",
        "Map privilege inheritance paths"
      ],
      "prerequisites": [
        "import-module-activedirectory"
      ],
      "next_steps": [
        "get-aduser"
      ],
      "alternatives": [
        "powerview-get-netgroupmember",
        "net-group-domain-list"
      ],
      "success_indicators": [
        "Returns list of members",
        "Shows both direct and nested members with -Recursive",
        "No access denied errors"
      ],
      "failure_indicators": [
        "Module 'ActiveDirectory' not found",
        "Cannot find group",
        "Empty result for known populated group"
      ],
      "flag_explanations": {
        "-Identity": "Group name, DN, GUID, or SID",
        "-Recursive": "Expand nested groups to show all effective members"
      },
      "troubleshooting": {
        "Module not found": "Install-WindowsFeature RSAT-AD-PowerShell",
        "Empty result": "Remove -Recursive to see only direct members",
        "Access denied": "User lacks read permissions on group objects"
      },
      "notes": "Native alternative to PowerView's Get-NetGroupMember.\n\nAlways use -Recursive to find nested memberships (users in Group A which is member of Group B).\n\nCritical for pentest AD enumeration.\n\nManual alternative:\nnet group \"<group>\" /domain (shows direct members only)",
      "references": [
        {
          "title": "Get-ADGroupMember Documentation",
          "url": "https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-adgroupmember"
        }
      ],
      "filled_example": "Get-ADGroupMember -Identity \"Domain Admins\" -Recursive"
    },
    {
      "id": "get-adcomputer",
      "name": "Get Active Directory Computer",
      "category": "enumeration",
      "command": "Get-ADComputer -Filter * -Properties *",
      "description": "Query Active Directory computer objects including workstations, servers, and domain controllers. Returns detailed system information for lateral movement targeting.",
      "tags": [
        "POWERSHELL",
        "AD_ENUM",
        "NATIVE_CMDLET"
      ],
      "variables": [],
      "output_analysis": [
        "DNSHostName: Fully qualified domain name",
        "OperatingSystem: OS version",
        "OperatingSystemVersion: Build number",
        "IPv4Address: IP address",
        "LastLogonDate: Activity indicator",
        "ServicePrincipalNames: Services running on computer",
        "Enabled: Active vs disabled computers"
      ],
      "common_uses": [
        "Enumerate all domain computers",
        "Identify servers vs workstations by OS",
        "Find domain controllers",
        "Build lateral movement target list",
        "Locate high-value systems (SQL, Exchange)"
      ],
      "prerequisites": [
        "import-module-activedirectory"
      ],
      "next_steps": [
        "ad-pass-the-hash-impacket-psexec",
        "ad-pass-the-hash-crackmapexec",
        "windows-net-use-smb-connect"
      ],
      "alternatives": [
        "powerview-get-netcomputer"
      ],
      "success_indicators": [
        "Returns computer objects with properties",
        "DNSHostName and OperatingSystem populated",
        "List includes servers and workstations"
      ],
      "failure_indicators": [
        "Module 'ActiveDirectory' not found",
        "No computers returned",
        "Access denied"
      ],
      "flag_explanations": {
        "-Filter": "Filter criteria (* for all, 'OperatingSystem -like \"*Server*\"' for servers)",
        "-Properties": "Properties to retrieve (* for all)",
        "-SearchBase": "LDAP search base (e.g., 'OU=Servers,DC=domain,DC=local')"
      },
      "troubleshooting": {
        "Module not found": "Install-WindowsFeature RSAT-AD-PowerShell",
        "Too much output": "Filter by OS: Get-ADComputer -Filter 'OperatingSystem -like \"*Server*\"'",
        "Access denied": "User lacks read permissions on computer objects"
      },
      "notes": "Native alternative to PowerView's Get-NetComputer.\n\nFocus on servers for practical:\nGet-ADComputer -Filter {OperatingSystem -like '*Server*'} -Properties *.\n\nFor domain controllers:\nGet-ADDomainController -Filter *.\n\nManual alternative:\nnet view for basic computer list",
      "references": [
        {
          "title": "Get-ADComputer Documentation",
          "url": "https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-adcomputer"
        }
      ]
    },
    {
      "id": "get-ciminstance",
      "name": "Get CIM Instance",
      "category": "enumeration",
      "command": "Get-CimInstance -ClassName <CLASSNAME>",
      "description": "Query Windows Management Instrumentation (WMI) classes using CIM cmdlets. Modern replacement for Get-WmiObject. Retrieves system information including processes, services, hardware, installed software, and configuration.",
      "tags": [
        "POWERSHELL",
        "WMI",
        "SYSTEM_ENUM"
      ],
      "variables": [
        {
          "name": "<CLASSNAME>",
          "description": "WMI class name to query",
          "example": "Win32_Process",
          "required": true
        }
      ],
      "output_analysis": [
        "Win32_Process: Running processes (Name, ProcessId, ExecutablePath)",
        "Win32_Service: Services (Name, State, StartMode, PathName)",
        "Win32_OperatingSystem: OS details (Caption, Version, BuildNumber)",
        "Win32_UserAccount: Local users",
        "Win32_Product: Installed software (unreliable, triggers reinstall checks)",
        "Win32_StartupCommand: Startup programs"
      ],
      "common_uses": [
        "Enumerate running processes: Win32_Process",
        "List services: Win32_Service",
        "Get system info: Win32_OperatingSystem",
        "Find installed software (avoid Win32_Product)",
        "Identify startup programs: Win32_StartupCommand",
        "Check for AV: Win32_Product, AntiVirusProduct (root\\SecurityCenter2)"
      ],
      "prerequisites": [],
      "next_steps": [
        "get-service",
        "get-process",
        "get-hotfix"
      ],
      "alternatives": [],
      "success_indicators": [
        "Returns objects matching WMI class",
        "Properties populated with system data",
        "No access denied errors"
      ],
      "failure_indicators": [
        "Invalid class error",
        "Access denied (requires admin for some classes)",
        "WMI service not running"
      ],
      "flag_explanations": {
        "-ClassName": "WMI class name to query (e.g., Win32_Process, Win32_Service)",
        "-Filter": "WQL filter (e.g., 'Name=\"svchost.exe\"')",
        "-ComputerName": "Query remote computer (requires admin access)",
        "-Namespace": "WMI namespace (default: root\\cimv2)"
      },
      "troubleshooting": {
        "Invalid class": "Verify class name: Get-CimClass -ClassName Win32_*",
        "Access denied": "Some classes require admin privileges",
        "Very slow": "Avoid Win32_Product - use registry query instead"
      },
      "notes": "pentest Key Classes:\nWin32_Process (processes), Win32_Service (services), Win32_OperatingSystem (system info), Win32_StartupCommand (persistence).\n\nAvoid Win32_Product (triggers consistency check).\n\nModern replacement for Get-WmiObject (deprecated).\n\nFor remote queries:\nGet-CimInstance -ClassName Win32_Process -ComputerName <TARGET>",
      "references": [
        {
          "title": "Get-CimInstance Documentation",
          "url": "https://docs.microsoft.com/en-us/powershell/module/cimcmdlets/get-ciminstance"
        },
        {
          "title": "Common WMI Classes",
          "url": "https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-provider"
        }
      ],
      "filled_example": "Get-CimInstance -ClassName Win32_Process"
    },
    {
      "id": "get-computerinfo",
      "name": "Get Computer Information",
      "category": "enumeration",
      "command": "Get-ComputerInfo",
      "description": "Retrieve comprehensive system information including OS details, hardware configuration, domain membership, and installed hotfixes. PowerShell 5.1+ cmdlet that consolidates multiple system queries into single output.",
      "tags": [
        "POWERSHELL",
        "SYSTEM_ENUM",
        "NATIVE_CMDLET"
      ],
      "variables": [],
      "output_analysis": [
        "OsName: Operating system name",
        "OsVersion: Build number",
        "OsArchitecture: 32-bit or 64-bit",
        "CsDomain: Domain name (if joined)",
        "CsDomainRole: Workstation vs Domain Controller",
        "BiosVersion: BIOS/firmware version",
        "WindowsProductName: Windows edition",
        "WindowsVersion: Release ID (e.g., 1909, 2004)",
        "OsHotFixes: Installed patches"
      ],
      "common_uses": [
        "Quick system enumeration after initial access",
        "Identify OS version for exploit targeting",
        "Check domain membership status",
        "Verify patch level for known vulnerabilities",
        "Determine privilege escalation vectors based on OS version"
      ],
      "prerequisites": [],
      "next_steps": [
        "get-hotfix"
      ],
      "alternatives": [
        "win-systeminfo",
        "get-ciminstance"
      ],
      "success_indicators": [
        "Returns detailed system object",
        "OS and domain properties populated",
        "No errors"
      ],
      "failure_indicators": [
        "Cmdlet not recognized (requires PS 5.1+)",
        "Timeout on slow systems",
        "Access denied (should work for standard users)"
      ],
      "flag_explanations": {
        "-Property": "Specific properties to retrieve (e.g., -Property OsName,OsVersion)"
      },
      "troubleshooting": {
        "Cmdlet not found": "Requires PowerShell 5.1+. Use systeminfo or Get-CimInstance Win32_OperatingSystem",
        "Very slow": "Filter specific properties: Get-ComputerInfo -Property Os*",
        "Missing data": "Run as admin for complete hardware details"
      },
      "notes": "pentest Quick Enum:\nFast one-liner for system overview.\n\nCheck OsVersion for patch level (compare against exploit-db), CsDomain for AD environment, OsArchitecture for payload architecture.\n\nOutput is verbose - filter with -Property or Select-Object.\n\nFaster alternatives:\nsysteminfo or Get-CimInstance Win32_OperatingSystem",
      "references": [
        {
          "title": "Get-ComputerInfo Documentation",
          "url": "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-computerinfo"
        }
      ]
    },
    {
      "id": "get-itemproperty",
      "name": "Get Registry Item Property",
      "category": "enumeration",
      "command": "Get-ItemProperty -Path <REGISTRY_PATH>",
      "description": "Read Windows Registry values from specified registry key path. Critical for discovering credentials, configuration settings, installed software, and privilege escalation vectors stored in registry.",
      "tags": [
        "POWERSHELL",
        "REGISTRY",
        "PRIVESC"
      ],
      "variables": [
        {
          "name": "<REGISTRY_PATH>",
          "description": "Registry path to query (HKLM:, HKCU:, etc.)",
          "example": "HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
          "required": true
        }
      ],
      "output_analysis": [
        "Returns all properties (values) in the registry key",
        "Property names and their data",
        "PSPath shows full registry path"
      ],
      "common_uses": [
        "Enumerate installed software: HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*",
        "Check AutoRuns: HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
        "AlwaysInstallElevated check: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer",
        "Winlogon credentials: HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon",
        "Saved credentials: HKCU:\\Software\\<Application>",
        "Service ImagePath: HKLM:\\System\\CurrentControlSet\\Services\\<service>"
      ],
      "prerequisites": [
        "evil-winrm-shell"
      ],
      "next_steps": [
        "windows-autologon",
        "windows-alwaysinstallelevated",
        "get-acl"
      ],
      "alternatives": [
        "get-itemproperty",
        "windows-search-sensitive-files"
      ],
      "success_indicators": [
        "Returns property values",
        "No access denied errors",
        "Properties displayed with data"
      ],
      "failure_indicators": [
        "Path not found (key doesn't exist)",
        "Access denied (insufficient permissions)",
        "Empty result (key has no values)"
      ],
      "flag_explanations": {
        "-Path": "Registry path using PowerShell drive notation (HKLM:, HKCU:, HKCR:, HKU:, HKCC:)",
        "-Name": "Specific property name to retrieve (omit for all properties)"
      },
      "troubleshooting": {
        "Path not found": "Verify key exists: Test-Path <REGISTRY_PATH>",
        "Access denied": "Try HKCU: instead of HKLM: or run as admin",
        "Wrong format": "Use PowerShell drive notation: HKLM:\\ not HKEY_LOCAL_MACHINE\\"
      },
      "notes": "Critical Paths:\nAlwaysInstallElevated (HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer - check AlwaysInstallElevated=1), Winlogon credentials (HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon - DefaultUserName/DefaultPassword), Service paths (HKLM:\\System\\CurrentControlSet\\Services\\<service> - ImagePath for unquoted paths).\n\nManual alternative:\nreg query <path> /v <value>",
      "references": [
        {
          "title": "Get-ItemProperty Documentation",
          "url": "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-itemproperty"
        }
      ],
      "filled_example": "Get-ItemProperty -Path HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"
    },
    {
      "id": "get-acl",
      "name": "Get Access Control List",
      "category": "enumeration",
      "command": "Get-Acl -Path <PATH>",
      "description": "Retrieve Access Control List (ACL) for file system objects, registry keys, or Active Directory objects. Shows permissions (DACL), ownership, and access rights. Critical for identifying privilege escalation via weak permissions.",
      "tags": [
        "POWERSHELL",
        "PERMISSIONS",
        "PRIVESC"
      ],
      "variables": [
        {
          "name": "<PATH>",
          "description": "Path to file, directory, registry key, or AD object",
          "example": "C:\\Program Files\\VulnerableApp",
          "required": true
        }
      ],
      "output_analysis": [
        "Owner: User or group that owns the object",
        "Access: List of Access Control Entries (ACEs)",
        "IdentityReference: User/group with permissions",
        "FileSystemRights: Permissions (FullControl, Modify, Write, etc.)",
        "AccessControlType: Allow or Deny",
        "IsInherited: Whether inherited from parent"
      ],
      "common_uses": [
        "Check service binary permissions for hijacking",
        "Identify writable directories in Program Files",
        "Verify registry key permissions for exploit",
        "Check file permissions for sensitive files",
        "Validate share permissions: Get-Acl \\\\<target>\\<share>",
        "AD object permissions for ACL attacks"
      ],
      "prerequisites": [],
      "next_steps": [
        "powerview-get-objectacl-genericall",
        "powerview-get-objectacl-writeowner"
      ],
      "alternatives": [
        "powerview-get-objectacl",
        "ad-acl-enumeration-by-sid"
      ],
      "success_indicators": [
        "Returns ACL object with Access property",
        "Shows owner and permissions list",
        "No access denied errors"
      ],
      "failure_indicators": [
        "Path not found",
        "Access denied (can't read ACL)",
        "Empty Access list"
      ],
      "flag_explanations": {
        "-Path": "File system path, registry path (HKLM:\\), or AD path (AD:\\)"
      },
      "troubleshooting": {
        "Access denied": "User may lack read permissions on ACL (unusual)",
        "Path not found": "Verify path exists: Test-Path <PATH>",
        "Unreadable output": "Format: Get-Acl <PATH> | Format-List or pipe to Select-Object -ExpandProperty Access"
      },
      "notes": "PrivEsc:\nLook for services with writable binary paths, Program Files directories with Modify/Write for Users, registry keys with Full Control for non-admins.\n\nKey permissions:\nFullControl (full access), Modify (write/delete), Write (create/modify).\n\nCheck current user's effective permissions:\n(Get-Acl <PATH>).Access | Where-Object {$_.IdentityReference -like '*Users*'}.\n\nManual alternative:\nicacls <path>",
      "references": [
        {
          "title": "Get-Acl Documentation",
          "url": "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-acl"
        }
      ],
      "filled_example": "Get-Acl -Path C:\\Program Files\\VulnerableApp"
    },
    {
      "id": "get-scheduledtask",
      "name": "Get Scheduled Tasks",
      "category": "enumeration",
      "command": "Get-ScheduledTask | Where-Object {$_.State -ne 'Disabled'}",
      "description": "Enumerate Windows scheduled tasks including task names, states, triggers, actions, and principals. Critical for identifying privilege escalation via task hijacking and persistence mechanisms.",
      "tags": [
        "POWERSHELL",
        "PRIVESC",
        "PERSISTENCE"
      ],
      "variables": [],
      "output_analysis": [
        "TaskName: Name of scheduled task",
        "TaskPath: Location in task scheduler hierarchy",
        "State: Ready, Running, Disabled",
        "Principal: User context task runs under (SYSTEM, admin, user)",
        "Actions: Commands/scripts the task executes",
        "Triggers: When task runs (time, logon, startup)"
      ],
      "common_uses": [
        "Find tasks running as SYSTEM or admin",
        "Identify tasks with writable binaries (privilege escalation)",
        "Discover persistence mechanisms",
        "Enumerate tasks for lateral movement",
        "Check task trigger schedules",
        "Find tasks in user-writable directories"
      ],
      "prerequisites": [
        "evil-winrm-shell"
      ],
      "next_steps": [
        "windows-scheduled-tasks"
      ],
      "alternatives": [
        "windows-scheduled-tasks",
        "get-scheduledtask"
      ],
      "success_indicators": [
        "Returns list of scheduled tasks",
        "TaskName and State populated",
        "Shows both system and user tasks"
      ],
      "failure_indicators": [
        "Cmdlet not recognized (requires PS 4.0+)",
        "Empty result (unlikely)",
        "Access denied on specific tasks"
      ],
      "flag_explanations": {
        "-TaskName": "Filter to specific task name",
        "-TaskPath": "Filter by task path (e.g., \\Microsoft\\Windows\\)"
      },
      "troubleshooting": {
        "Cmdlet not found": "Requires PowerShell 4.0+. Use schtasks /query /fo LIST /v",
        "Too much output": "Filter: Get-ScheduledTask | Where-Object {$_.Principal.UserId -eq 'SYSTEM'}",
        "Need task details": "Get-ScheduledTaskInfo -TaskName <name> for runtime info"
      },
      "notes": "PrivEsc:\nFind tasks running as SYSTEM/admin with writable binaries.\n\nCheck Actions property for executable paths, verify permissions with Get-Acl.\n\nCommon vectors:\nTasks in C:\\Users\\<user>\\AppData, tasks with environment variable paths (%TEMP%), tasks with relative paths.\n\nGet task details:\nGet-ScheduledTask -TaskName <name> | Select-Object -ExpandProperty Actions.\n\nManual alternative:\nschtasks /query /fo LIST /v",
      "references": [
        {
          "title": "Get-ScheduledTask Documentation",
          "url": "https://docs.microsoft.com/en-us/powershell/module/scheduledtasks/get-scheduledtask"
        }
      ]
    },
    {
      "id": "get-gpppassword",
      "name": "Get Group Policy Preferences Password",
      "category": "exploitation",
      "command": "Get-GPPPassword",
      "description": "Extract and decrypt passwords from Group Policy Preferences (GPP) XML files stored in SYSVOL. GPP allows setting local admin passwords via Group Policy, but stores them with known AES key. This PowerSploit/PowerUp function finds and decrypts these passwords automatically.",
      "tags": [
        "POWERSHELL",
        "GPP",
        "CREDENTIAL_THEFT"
      ],
      "variables": [],
      "output_analysis": [
        "UserName: Account name with stored password",
        "Password: Decrypted plaintext password",
        "Changed: When password was set",
        "File: Groups.xml path in SYSVOL",
        "cpassword: Encrypted password (before decryption)"
      ],
      "common_uses": [
        "Extract local admin passwords from GPP",
        "Find credentials in SYSVOL during AD enumeration",
        "Lateral movement with discovered admin passwords",
        "Privilege escalation on domain-joined systems"
      ],
      "prerequisites": [
        "import-powersploit"
      ],
      "next_steps": [
        "windows-hashcat-crack-ntlm",
        "ad-pass-the-hash-impacket-psexec"
      ],
      "alternatives": [],
      "success_indicators": [
        "Returns one or more credentials",
        "Password field shows plaintext password",
        "File path shows Groups.xml location"
      ],
      "failure_indicators": [
        "No GPP passwords found (no vulnerable Group Policies)",
        "Access denied to SYSVOL",
        "Function not recognized (module not imported)"
      ],
      "flag_explanations": {},
      "troubleshooting": {
        "Function not found": "Import-Module PowerSploit or PowerUp first",
        "No passwords found": "Domain may not use GPP or already patched Groups.xml files",
        "Access denied": "Verify domain user access to SYSVOL: dir \\\\<domain>\\SYSVOL"
      },
      "notes": "Critical:\nGPP vulnerability (MS14-025 patched but files remain).\n\nSearches \\\\<domain>\\SYSVOL\\<domain>\\Policies for Groups.xml containing cpassword attribute.\n\nAES key is publicly known (same for all domains).\n\nManual alternative:\nSearch SYSVOL for cpassword, decrypt with gpp-decrypt or Python script.\n\nModern domains may not use GPP passwords, but legacy configs remain.\n\nWorks from any domain user context.",
      "references": [
        {
          "title": "PowerSploit Get-GPPPassword",
          "url": "https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/Get-GPPPassword.ps1"
        },
        {
          "title": "GPP Password Attack",
          "url": "https://adsecurity.org/?p=2288"
        }
      ]
    },
    {
      "id": "get-unquotedservice",
      "name": "Get Unquoted Service Paths",
      "category": "enumeration",
      "command": "Get-ServiceUnquoted",
      "description": "Identify Windows services with unquoted executable paths containing spaces. PowerUp function that finds services vulnerable to path hijacking privilege escalation. When service path is unquoted with spaces, Windows attempts to execute from multiple locations, allowing DLL/binary hijacking.",
      "tags": [
        "POWERSHELL",
        "POWERUP",
        "PRIVESC"
      ],
      "variables": [],
      "output_analysis": [
        "ServiceName: Name of vulnerable service",
        "Path: Unquoted service binary path with spaces",
        "StartName: User context service runs under (look for SYSTEM)",
        "AbuseFunction: PowerUp command to exploit (Install-ServiceBinary)",
        "CanRestart: Whether current user can restart service"
      ],
      "common_uses": [
        "Find unquoted service path vulnerabilities",
        "Identify privilege escalation vectors on Windows systems",
        "Locate services running as SYSTEM with exploitable paths",
        "Privilege escalation after initial access"
      ],
      "prerequisites": [
        "import-powerup"
      ],
      "next_steps": [
        "get-acl"
      ],
      "alternatives": [
        "win-sc-query-services"
      ],
      "success_indicators": [
        "Returns one or more services with unquoted paths",
        "Path contains spaces without quotes",
        "StartName shows SYSTEM or admin account"
      ],
      "failure_indicators": [
        "No unquoted service paths found",
        "Function not recognized (PowerUp not imported)",
        "All services are quoted (system hardened)"
      ],
      "flag_explanations": {},
      "troubleshooting": {
        "Function not found": "Import-Module PowerUp.ps1 first",
        "No results": "System may be properly configured with quoted paths",
        "Can't exploit": "Check directory permissions with Get-Acl or icacls"
      },
      "notes": "PrivEsc Gold:\nUnquoted service paths are common Windows privilege escalation vector.\n\nExample:\nPath 'C:\\Program Files\\Vulnerable App\\service.exe' without quotes tries 'C:\\Program.exe', 'C:\\Program Files\\Vulnerable.exe' before correct path.\n\nPlace malicious binary in intermediate path with write access.\n\nRequires service restart (manual or automatic).\n\nCheck writable directories:\nicacls 'C:\\Program Files'.\n\nPowerUp's Invoke-AllChecks includes this check.\n\nManual alternative:\nwmic service get name,pathname | findstr /i /v \"C:\\Windows\" | findstr /i /v \"\\\"\"",
      "references": [
        {
          "title": "PowerUp Documentation",
          "url": "https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc"
        },
        {
          "title": "Unquoted Service Path Exploitation",
          "url": "https://attack.mitre.org/techniques/T1574/009/"
        }
      ]
    },
    {
      "id": "get-modifiableservicefile",
      "name": "Get Modifiable Service Binaries",
      "category": "enumeration",
      "command": "Get-ModifiableServiceFile",
      "description": "Identify Windows services with binaries or configuration files that current user can modify. PowerUp function that checks file permissions on service executables, DLLs, and config files. Direct privilege escalation by replacing service binary with malicious executable.",
      "tags": [
        "POWERSHELL",
        "POWERUP",
        "PRIVESC"
      ],
      "variables": [],
      "output_analysis": [
        "ServiceName: Name of service with modifiable file",
        "Path: Full path to modifiable binary/DLL",
        "ModifiableFile: Specific file current user can modify",
        "StartName: User context service runs under (target SYSTEM)",
        "AbuseFunction: PowerUp command to exploit (Install-ServiceBinary)",
        "CanRestart: Whether current user can restart service"
      ],
      "common_uses": [
        "Find services with writable binaries (privilege escalation)",
        "Identify weak file permissions on service executables",
        "Locate DLL hijacking opportunities in service paths",
        "Privilege escalation vector enumeration"
      ],
      "prerequisites": [
        "import-powerup"
      ],
      "next_steps": [
        "get-acl"
      ],
      "alternatives": [],
      "success_indicators": [
        "Returns one or more services with modifiable files",
        "ModifiableFile shows writable binary path",
        "StartName shows SYSTEM or admin"
      ],
      "failure_indicators": [
        "No modifiable service files found",
        "Function not recognized (PowerUp not imported)",
        "Access denied errors"
      ],
      "flag_explanations": {},
      "troubleshooting": {
        "Function not found": "Import-Module PowerUp.ps1 first",
        "No results": "Current user lacks write permissions on any service files",
        "False positives": "Verify with icacls: icacls <path> (check for (M) or (F) permissions)"
      },
      "notes": "PrivEsc Critical:\nService binary hijacking is reliable privilege escalation.\n\nIf service runs as SYSTEM and current user can overwrite binary, replace with reverse shell or local admin creation payload.\n\nAlways backup original binary first.\n\nCheck if service auto-starts or requires manual restart.\n\nPowerUp's Install-ServiceBinary automates exploitation.\n\nVerify permissions:\nicacls <path> | findstr /i \"Users Everyone Authenticated\".\n\nManual alternative:\nfor /f %i in ('sc query state^= all^| findstr SERVICE_NAME') do @echo %i && icacls \"%i\"",
      "references": [
        {
          "title": "PowerUp Get-ModifiableServiceFile",
          "url": "https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1"
        },
        {
          "title": "Windows Service Binary Hijacking",
          "url": "https://attack.mitre.org/techniques/T1543/003/"
        }
      ]
    },
    {
      "id": "import-module-activedirectory",
      "name": "Import Active Directory Module",
      "category": "enumeration",
      "command": "Import-Module ActiveDirectory",
      "description": "Load Microsoft Active Directory PowerShell module to enable native AD cmdlets (Get-ADUser, Get-ADGroup, Get-ADComputer, etc.). Part of Remote Server Administration Tools (RSAT). Required for native AD enumeration without PowerView.",
      "tags": [
        "POWERSHELL",
        "AD_ENUM",
        "MODULE_IMPORT"
      ],
      "variables": [],
      "output_analysis": [
        "No output on success (silent load)",
        "Error if module not installed",
        "Verify with: Get-Command -Module ActiveDirectory"
      ],
      "common_uses": [
        "Enable native AD cmdlets for enumeration",
        "Alternative to PowerView when RSAT is installed",
        "Initial setup for AD reconnaissance",
        "Required before Get-ADUser, Get-ADGroup, Get-ADComputer"
      ],
      "prerequisites": [],
      "next_steps": [
        "get-aduser",
        "get-adgroup",
        "get-adcomputer"
      ],
      "alternatives": [
        "import-powerview"
      ],
      "success_indicators": [
        "No error messages",
        "Get-Command -Module ActiveDirectory shows cmdlets"
      ],
      "failure_indicators": [
        "Module 'ActiveDirectory' not found",
        "RSAT not installed",
        "Execution policy errors"
      ],
      "flag_explanations": {},
      "troubleshooting": {
        "Module not found (Server)": "Install-WindowsFeature RSAT-AD-PowerShell",
        "Module not found (Desktop)": "Install RSAT from Windows Features or Microsoft Download",
        "Execution policy": "Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Bypass"
      },
      "notes": "pentest Note:\nRSAT is less common than PowerView on target systems but provides native Microsoft cmdlets.\n\nOn Windows Server:\nInstall-WindowsFeature RSAT-AD-PowerShell.\n\nOn Windows 10:\nInstall via Settings > Apps > Optional Features > RSAT:\nActive Directory Domain Services.\n\nAlternative if unavailable:\nUse PowerView (Import-Module PowerView.ps1) or native tools (net user, net group, nltest).",
      "references": [
        {
          "title": "Active Directory Module",
          "url": "https://docs.microsoft.com/en-us/powershell/module/activedirectory/"
        }
      ]
    },
    {
      "id": "import-powerup",
      "name": "Import PowerUp Module",
      "category": "enumeration",
      "command": "Import-Module <PATH>\\PowerUp.ps1",
      "description": "Load PowerUp privilege escalation framework into PowerShell session. PowerUp is a PowerShell tool for Windows local privilege escalation checks including service misconfigurations, unquoted paths, AlwaysInstallElevated, DLL hijacking, and more.",
      "tags": [
        "POWERSHELL",
        "POWERUP",
        "PRIVESC"
      ],
      "variables": [
        {
          "name": "<PATH>",
          "description": "Directory path where PowerUp.ps1 is located",
          "example": "C:\\Tools",
          "required": true
        }
      ],
      "output_analysis": [
        "No output on success (silent load)",
        "Error messages indicate missing file or execution policy",
        "Verify with: Get-Command -Module PowerUp or Get-Command Invoke-AllChecks"
      ],
      "common_uses": [
        "Initial privilege escalation enumeration on Windows",
        "Automated discovery of privesc vectors",
        "Service misconfiguration checks",
        "Required before Get-ServiceUnquoted, Get-ModifiableServiceFile, Invoke-AllChecks"
      ],
      "prerequisites": [],
      "next_steps": [
        "get-unquotedservice",
        "get-modifiableservicefile"
      ],
      "alternatives": [],
      "success_indicators": [
        "No error messages",
        "Get-Command Invoke-AllChecks returns function"
      ],
      "failure_indicators": [
        "File not found error",
        "Execution policy blocked",
        "Cannot be loaded because running scripts is disabled"
      ],
      "flag_explanations": {},
      "troubleshooting": {
        "execution policy blocked": "Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Bypass",
        "file not found": "Verify PowerUp.ps1 path and use full absolute path",
        "access denied": "Ensure current user has read permissions on file"
      },
      "notes": "Essential:\nPowerUp automates Windows privilege escalation checks.\n\nKey functions:\nInvoke-AllChecks (run all checks), Get-ServiceUnquoted (unquoted service paths), Get-ModifiableServiceFile (writable service binaries), Get-ModifiableRegistryAutoRun (hijackable autoruns).\n\nPowerUp.ps1 may trigger AV - consider obfuscation.\n\nAlternative:\nUse WinPEAS (compiled binary) or manual checks.\n\nPart of PowerSploit framework.",
      "references": [
        {
          "title": "PowerUp GitHub",
          "url": "https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc"
        },
        {
          "title": "PowerUp Usage Guide",
          "url": "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/powerup"
        }
      ],
      "filled_example": "Import-Module C:\\Tools\\PowerUp.ps1"
    },
    {
      "id": "import-powersploit",
      "name": "Import PowerSploit Module",
      "category": "exploitation",
      "command": "Import-Module <PATH>\\PowerSploit.psd1",
      "description": "Load PowerSploit offensive PowerShell framework. PowerSploit includes multiple modules: Privesc (PowerUp), Recon (PowerView), Exfiltration, Persistence, ScriptModification, and CodeExecution. Comprehensive post-exploitation toolkit for Windows.",
      "tags": [
        "POWERSHELL",
        "POWERSPLOIT",
        "POST_EXPLOIT"
      ],
      "variables": [
        {
          "name": "<PATH>",
          "description": "Directory path where PowerSploit.psd1 is located",
          "example": "C:\\Tools\\PowerSploit",
          "required": true
        }
      ],
      "output_analysis": [
        "No output on success",
        "Loads all PowerSploit modules automatically",
        "Verify with: Get-Command -Module PowerSploit"
      ],
      "common_uses": [
        "Load entire PowerSploit framework",
        "Access PowerView, PowerUp, and other modules",
        "Comprehensive Windows post-exploitation",
        "Alternative to loading individual modules"
      ],
      "prerequisites": [],
      "next_steps": [],
      "alternatives": [
        "import-powerview",
        "import-powerup"
      ],
      "success_indicators": [
        "No error messages",
        "Get-Module shows PowerSploit loaded",
        "PowerView and PowerUp commands available"
      ],
      "failure_indicators": [
        "File not found",
        "Execution policy blocked",
        "Module manifest errors"
      ],
      "flag_explanations": {},
      "troubleshooting": {
        "manifest not found": "Use Import-Module <PATH>\\PowerSploit.psm1 instead",
        "execution policy": "Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Bypass",
        "individual module preferred": "Import-Module <PATH>\\Recon\\PowerView.ps1 for just PowerView"
      },
      "notes": "Context:\nPowerSploit provides comprehensive toolkit but individual modules (PowerView, PowerUp) are more commonly used separately.\n\nLoading full framework increases detection risk.\n\nFor pentest, prefer targeted module imports:\nPowerView for AD recon, PowerUp for privesc.\n\nPowerSploit includes Get-GPPPassword (Privesc module).\n\nMay trigger AV/EDR - consider loading modules individually or using obfuscation.",
      "references": [
        {
          "title": "PowerSploit GitHub",
          "url": "https://github.com/PowerShellMafia/PowerSploit"
        }
      ],
      "filled_example": "Import-Module C:\\Tools\\PowerSploit\\PowerSploit.psd1"
    },
    {
      "id": "get-process",
      "name": "Get Running Processes",
      "category": "enumeration",
      "command": "Get-Process",
      "description": "Enumerate all running processes on local or remote system. Native PowerShell cmdlet that returns process objects with detailed information including process name, ID, CPU usage, memory, and executable path.",
      "tags": [
        "POWERSHELL",
        "PROCESS_ENUM",
        "NATIVE_CMDLET"
      ],
      "variables": [],
      "output_analysis": [
        "ProcessName: Executable name",
        "Id: Process ID (PID)",
        "CPU: CPU time consumed",
        "WorkingSet: Memory usage (bytes)",
        "Path: Full executable path (use Get-Process | Select-Object Name,Path)",
        "Company: Software vendor"
      ],
      "common_uses": [
        "Enumerate running processes for target identification",
        "Identify AV/EDR processes",
        "Find privileged processes running as SYSTEM",
        "Process injection target selection",
        "Identify migration targets for Meterpreter"
      ],
      "prerequisites": [],
      "next_steps": [],
      "alternatives": [],
      "success_indicators": [
        "Returns list of running processes",
        "ProcessName and Id populated",
        "No errors"
      ],
      "failure_indicators": [
        "Access denied (unusual for Get-Process)",
        "Empty result (system issue)"
      ],
      "flag_explanations": {
        "-Name": "Filter by process name (e.g., -Name explorer)",
        "-Id": "Filter by PID",
        "-ComputerName": "Query remote computer (requires PS Remoting)"
      },
      "troubleshooting": {
        "Missing Path": "Get-Process | Select-Object Name,Id,Path (Path not shown by default)",
        "Access denied on remote": "Requires PS Remoting and admin access",
        "Need owner/user": "Use Get-CimInstance Win32_Process | Select-Object Name,ProcessId,@{n='Owner';e={$_.GetOwner().User}}"
      },
      "notes": "Practical Usage:\nQuick process enumeration to identify targets and avoid AV.\n\nLook for AV processes (MsMpEng.exe, AVP.exe, etc.) before running exploits.\n\nGet-Process doesn't show process owner by default - use Get-CimInstance Win32_Process for owner information.\n\nFor full process command line:\nGet-CimInstance Win32_Process | Select-Object Name,CommandLine.\n\nFaster than Get-CimInstance for basic enumeration.",
      "references": [
        {
          "title": "Get-Process Documentation",
          "url": "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-process"
        }
      ]
    },
    {
      "id": "get-service",
      "name": "Get Windows Services",
      "category": "enumeration",
      "command": "Get-Service",
      "description": "Enumerate Windows services on local or remote system. Native PowerShell cmdlet that returns service objects with name, display name, and status. Critical for identifying vulnerable services and privilege escalation vectors.",
      "tags": [
        "POWERSHELL",
        "SERVICE_ENUM",
        "NATIVE_CMDLET"
      ],
      "variables": [],
      "output_analysis": [
        "Status: Running, Stopped, Paused",
        "Name: Service short name",
        "DisplayName: Service full name",
        "StartType: Automatic, Manual, Disabled"
      ],
      "common_uses": [
        "Enumerate all services for vulnerability assessment",
        "Identify running services",
        "Find stopped services that can be started",
        "Service-based privilege escalation enumeration",
        "Check service state before exploitation"
      ],
      "prerequisites": [
        "evil-winrm-shell"
      ],
      "next_steps": [
        "windows-unquoted-service"
      ],
      "alternatives": [
        "get-service",
        "systemctl-running-services"
      ],
      "success_indicators": [
        "Returns list of services",
        "Status and Name populated",
        "No errors"
      ],
      "failure_indicators": [
        "Access denied (rare for basic enumeration)",
        "Empty result"
      ],
      "flag_explanations": {
        "-Name": "Filter by service name",
        "-DisplayName": "Filter by display name",
        "-ComputerName": "Query remote computer"
      },
      "troubleshooting": {
        "Missing binary path": "Get-CimInstance Win32_Service | Select-Object Name,PathName,StartName for full details",
        "Need service account": "Get-CimInstance Win32_Service | Select-Object Name,StartName",
        "Remote access denied": "Requires admin access on remote system"
      },
      "notes": "PrivEsc:\nGet-Service shows basic service info.\n\nFor privilege escalation, need binary path and service account - use Get-CimInstance Win32_Service or sc qc <service>.\n\nKey properties for privesc:\nPathName (unquoted paths, writable binaries), StartName (services running as SYSTEM).\n\nCheck service permissions:\nsc sdshow <service> or accesschk -ucqv <service>.\n\nFaster than WMI for basic service status checks.",
      "references": [
        {
          "title": "Get-Service Documentation",
          "url": "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-service"
        }
      ]
    },
    {
      "id": "get-hotfix",
      "name": "Get Installed Hotfixes",
      "category": "enumeration",
      "command": "Get-HotFix",
      "description": "Enumerate installed Windows updates and security patches. Native PowerShell cmdlet that queries installed hotfixes, useful for identifying missing patches and potential kernel exploits.",
      "tags": [
        "POWERSHELL",
        "PATCH_ENUM",
        "NATIVE_CMDLET"
      ],
      "variables": [],
      "output_analysis": [
        "HotFixID: KB number (e.g., KB4012215)",
        "Description: Update type (Security Update, Update, etc.)",
        "InstalledOn: Installation date",
        "InstalledBy: User who installed patch"
      ],
      "common_uses": [
        "Identify missing security patches",
        "Check for specific CVE patches",
        "Kernel exploit applicability assessment",
        "System patch level verification"
      ],
      "prerequisites": [],
      "next_steps": [],
      "alternatives": [],
      "success_indicators": [
        "Returns list of installed hotfixes",
        "HotFixID and InstalledOn populated",
        "No errors"
      ],
      "failure_indicators": [
        "Empty result (rare - most systems have patches)",
        "Access denied (unusual)"
      ],
      "flag_explanations": {
        "-Id": "Filter by specific KB number (e.g., -Id KB4012215)",
        "-Description": "Filter by update type"
      },
      "troubleshooting": {
        "Incomplete list": "Get-HotFix may miss some updates - use wmic qfe list for comprehensive list",
        "Slow query": "Normal on systems with many patches",
        "Compare with exploits": "Use Watson or Sherlock tools for automated CVE matching"
      },
      "notes": "pentest Kernel Exploits:\nCompare installed patches against known exploits.\n\nKey missing patches to check:\nMS16-032, MS15-051, MS10-059.\n\nFor comprehensive patch analysis, combine with systeminfo output and use Windows-Exploit-Suggester.\n\nGet-HotFix may not show all patches - wmic qfe is more comprehensive.\n\nCheck specific patch:\nGet-HotFix -Id KB4012215.\n\nManual alternative:\nwmic qfe get Caption,Description,HotFixID,InstalledOn",
      "references": [
        {
          "title": "Get-HotFix Documentation",
          "url": "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-hotfix"
        }
      ]
    }
  ]
}