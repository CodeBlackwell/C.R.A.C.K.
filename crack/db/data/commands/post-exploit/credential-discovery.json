{
  "category": "post-exploit",
  "description": "Credential discovery and extraction commands for post-exploitation",
  "commands": [
    {
      "id": "linux-cred-discover-config",
      "name": "Discover Credentials in Config Files",
      "category": "post-exploit",
      "subcategory": "credential-access",
      "command": "grep -r -i -E '(password|passwd|pwd|dbpass)' <SEARCH_PATH> 2>/dev/null",
      "description": "Search recursively for password strings in configuration files (PHP, config, env, etc.)",
      "tags": [
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "LINUX",
        "QUICK_WIN"
      ],
      "variables": [
        {
          "name": "<SEARCH_PATH>",
          "description": "Directory to search (common: /var/www/html, /opt, /home)",
          "example": "/var/www/html",
          "required": true
        }
      ],
      "flag_explanations": {
        "-r": "Recursive - search all subdirectories",
        "-i": "Case insensitive - matches PASSWORD, password, Password, etc.",
        "-E": "Extended regex - allows pattern matching with (password|passwd|pwd)",
        "2>/dev/null": "Suppress permission denied errors for cleaner output"
      },
      "success_indicators": [
        "password=",
        "DB_PASSWORD",
        "$password",
        "dbpass",
        "credentials"
      ],
      "failure_indicators": [
        "No such file or directory",
        "Permission denied (all results)",
        "No matches found"
      ],
      "next_steps": [
        "linux-enum-users-shells",
        "ssh-login-password",
        "mysql-connect-basic",
        "postgres-connect-basic"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "Too many results": "Narrow search: grep -r 'DB_PASSWORD' /var/www/html/*.php",
        "Permission denied": "Run with sudo or target user-writable directories",
        "No results in common paths": "Try: /opt, /home/*/.bash_history, /tmp, /var/backups"
      },
      "notes": "Common config file locations:\n/var/www/html/config.php, /var/www/html/wp-config.php, /etc/*.conf, .env files.\n\nTime estimate:\n1-2 minutes.\n\ncertification tip:\nDatabase credentials often reused for SSH.\n\nLook for patterns:\npassword=, DB_PASS, dbpass, credentials, auth.\n\nCheck .git/config for credentials in URLs.",
      "filled_example": "grep -r -i -E '(password|passwd|pwd|dbpass)' /var/www/html 2>/dev/null"
    },
    {
      "id": "linux-enum-users-shells",
      "name": "Enumerate Users with Login Shells",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "cat /etc/passwd | grep -v 'nologin\\|false' | cut -d: -f1",
      "description": "Extract valid usernames from /etc/passwd that have real login shells (exclude service accounts)",
      "tags": [
        "ENUMERATION",
        "LINUX",
        "QUICK_WIN",
        "USER_DISCOVERY"
      ],
      "variables": [],
      "flag_explanations": {
        "cat /etc/passwd": "Display all user account information",
        "grep -v": "Invert match - exclude lines containing nologin or false shells",
        "cut -d: -f1": "Extract first field (username) using colon delimiter"
      },
      "success_indicators": [
        "root",
        "List of usernames",
        "User accounts with /bin/bash or /bin/sh"
      ],
      "failure_indicators": [
        "Permission denied",
        "No such file (unlikely on Linux)",
        "Empty output"
      ],
      "next_steps": [
        "ssh-login-password",
        "hydra-ssh"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "Too many service accounts": "Add more filters: grep -v 'nologin\\|false\\|sync\\|shutdown\\|halt'",
        "Need UID ranges": "Show UIDs: awk -F: '$3 >= 1000 {print $1}' /etc/passwd (human users)",
        "Want full details": "Omit final cut: cat /etc/passwd | grep -v nologin (shows home dirs, shells)"
      },
      "notes": "Valid login shells typically:\n/bin/bash, /bin/sh, /bin/zsh.\n\nService accounts use /usr/sbin/nologin or /bin/false.\n\nTime estimate:\n10 seconds.\n\ncertification tip:\nTest discovered credentials against these users via SSH.\n\nCommon certification usernames:\nuser, admin, root, www-data (if shell granted).\n\nAlso check:\n/home directories for personal data, .ssh/authorized_keys."
    },
    {
      "id": "linux-find-config-files",
      "name": "Find Configuration Files",
      "category": "post-exploit",
      "subcategory": "credential-discovery",
      "command": "find / -name '*.conf' -o -name '*.config' -o -name 'config.php' -o -name 'wp-config.php' -o -name 'settings.php' 2>/dev/null | head -50",
      "description": "Discover configuration files that may contain credentials across the filesystem",
      "variables": [],
      "flag_explanations": {
        "-name '*.conf'": "Linux configuration files",
        "-name '*.config'": "Application config files",
        "-name 'config.php'": "PHP web app configs",
        "-name 'wp-config.php'": "WordPress database credentials",
        "-o": "OR operator for multiple patterns",
        "head -50": "Limit output to manageable size"
      },
      "tags": [
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "LINUX",
        "POST_EXPLOITATION",
        "QUICK_WIN"
      ],
      "success_indicators": [
        "Config files found",
        "/var/www/ configs",
        "wp-config.php found",
        "Database config files"
      ],
      "failure_indicators": [
        "No results",
        "Permission denied on all"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-cred-discover-config",
        "linux-find-env-files"
      ],
      "alternatives": [
        "locate config.php"
      ],
      "troubleshooting": {
        "Too many results": "Target specific directories: find /var/www -name 'config*'",
        "Permission denied": "Focus on readable paths: find /var/www /opt /home -name '*.conf' 2>/dev/null"
      },
      "notes": "High-value config file locations:\n- /var/www/html/config.php (web apps)\n- /var/www/html/wp-config.php (WordPress)\n- /etc/mysql/my.cnf (MySQL)\n- /opt/*/config* (custom apps)\n- /home/*/.* (user configs)\n\nAfter finding files, grep for passwords:\ngrep -i password /path/to/config.php\n\nTime estimate: 10-30 seconds.\n\ncertification tip: WordPress wp-config.php always has database credentials.",
      "methodology_guidance": {
        "after_success": "Read found config files with cat. Grep for password, pass, pwd, secret, key."
      }
    },
    {
      "id": "linux-find-env-files",
      "name": "Find Environment Files",
      "category": "post-exploit",
      "subcategory": "credential-discovery",
      "command": "find / -name '.env' -o -name '*.env' -o -name '.env.*' 2>/dev/null",
      "description": "Discover .env files containing application secrets and credentials",
      "variables": [],
      "flag_explanations": {
        "-name '.env'": "Standard environment file",
        "-name '*.env'": "Named environment files (production.env, etc.)",
        "-name '.env.*'": "Environment variants (.env.local, .env.production)"
      },
      "tags": [
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "LINUX",
        "POST_EXPLOITATION",
        "QUICK_WIN"
      ],
      "success_indicators": [
        ".env files found",
        "/var/www/*/.env",
        "Application directories with .env"
      ],
      "failure_indicators": [
        "No results",
        "Permission denied"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-env-vars",
        "linux-cred-discover-config"
      ],
      "alternatives": [
        "locate .env"
      ],
      "troubleshooting": {
        "No results": "Try: find /var/www /opt /home -name '.env*' 2>/dev/null"
      },
      "notes": "Modern web frameworks use .env files for secrets.\n\nCommon .env contents:\n- DB_PASSWORD=secret\n- APP_KEY=base64:...\n- AWS_SECRET_ACCESS_KEY=...\n- MAIL_PASSWORD=...\n- REDIS_PASSWORD=...\n\nFrameworks using .env:\n- Laravel (.env)\n- Node.js (.env)\n- Django (.env)\n- Ruby on Rails (.env)\n\nTime estimate: 10-20 seconds.\n\ncertification tip: .env files are GOLDMINES. Always check web app directories.",
      "methodology_guidance": {
        "after_success": "cat found .env files immediately. Test credentials for password reuse."
      }
    },
    {
      "id": "linux-find-backup-files",
      "name": "Find Backup Files",
      "category": "post-exploit",
      "subcategory": "credential-discovery",
      "command": "find / -name '*.bak' -o -name '*.backup' -o -name '*.old' -o -name '*~' -o -name '*.swp' 2>/dev/null | head -50",
      "description": "Discover backup files that may contain old credentials or sensitive data",
      "variables": [],
      "flag_explanations": {
        "*.bak": "Common backup extension",
        "*.backup": "Explicit backup files",
        "*.old": "Old version files",
        "*~": "Editor backup files (vim, emacs)",
        "*.swp": "Vim swap files (may contain unsaved data)"
      },
      "tags": [
        "CREDENTIAL_ACCESS",
        "DISCOVERY",
        "LINUX",
        "POST_EXPLOITATION"
      ],
      "success_indicators": [
        "Backup files found",
        "Config backups (.bak)",
        "Old password files",
        "Database dumps"
      ],
      "failure_indicators": [
        "No results",
        "Permission denied"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-find-config-files",
        "linux-cred-discover-config"
      ],
      "alternatives": [],
      "troubleshooting": {
        "Too many results": "Focus on sensitive paths: find /var /etc /opt -name '*.bak' 2>/dev/null"
      },
      "notes": "Backup files often contain:\n- Old passwords (may still work!)\n- Previous configurations\n- Database credentials\n- SSH keys\n\nHigh-value backup locations:\n- /var/backups/\n- /opt/backup/\n- /home/*/backup/\n- Web directories\n\nSwap files (.swp) may contain:\n- Unsaved changes with credentials\n- Recovery data from crashed sessions\n\nTime estimate: 10-30 seconds.\n\ncertification tip: Old passwords in backups may still be valid. Password rotation is rare.",
      "methodology_guidance": {
        "after_success": "Read backup files. Old passwords often still work."
      }
    },
    {
      "id": "linux-world-writable",
      "name": "Find World-Writable Directories",
      "category": "post-exploit",
      "subcategory": "privilege-escalation",
      "command": "find / -type d -perm -002 -ls 2>/dev/null | grep -v '/proc\\|/sys\\|/dev'",
      "description": "Find directories writable by everyone - potential for privilege escalation via file placement",
      "variables": [],
      "flag_explanations": {
        "-type d": "Directories only",
        "-perm -002": "World-writable permission bit set",
        "-ls": "Long listing format",
        "grep -v": "Exclude system directories"
      },
      "tags": [
        "DISCOVERY",
        "ENUMERATION",
        "LINUX",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION"
      ],
      "success_indicators": [
        "Writable directories outside /tmp",
        "Directories in PATH",
        "Cron job directories"
      ],
      "failure_indicators": [
        "Only /tmp and /var/tmp",
        "Permission denied"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-path-hijack",
        "linux-cron-enum"
      ],
      "alternatives": [
        "linux-find-world-writable"
      ],
      "troubleshooting": {
        "Too many results": "Add more exclusions: grep -v '/tmp\\|/var/tmp\\|/run'"
      },
      "notes": "World-writable directories enable:\n- PATH hijacking (if in $PATH)\n- Cron job exploitation (if cron writes there)\n- Library injection (if in library path)\n- Temporary file attacks\n\nExpected world-writable:\n- /tmp, /var/tmp (normal)\n- /dev/shm (RAM-based, normal)\n\nDangerous world-writable:\n- /usr/local/bin (PATH hijack)\n- Cron directories\n- Web directories\n\nTime estimate: 10-20 seconds.\n\ncertification tip: World-writable directory in PATH = easy privesc via binary replacement.",
      "methodology_guidance": {
        "after_success": "Check if any writable dirs are in root's PATH or used by cron"
      }
    }
  ]
}