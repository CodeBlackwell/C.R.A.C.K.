{
  "metadata": {
    "file_purpose": "Windows local enumeration commands for privilege escalation reconnaissance. Based on OSCP Module 17 - covers situational awareness, user/group enumeration, network discovery, and sensitive information hunting.",
    "oscp_relevance": "CRITICAL. First steps after gaining initial shell access on Windows - establishes baseline understanding before privilege escalation attempts."
  },
  "commands": [
    {
      "id": "win-whoami-basic",
      "name": "Whoami - Current User and Hostname",
      "category": "post-exploit",
      "subcategory": "situational-awareness",
      "command": "whoami",
      "description": "Display current username and hostname. First command to run after gaining shell access - establishes identity context for all subsequent enumeration.",
      "variables": [],
      "flag_explanations": {
        "whoami": "Windows built-in command that displays the current user's domain\\username. On local accounts shows HOSTNAME\\username format. No flags needed for basic output. Works in both cmd.exe and PowerShell. ALWAYS run this first - establishes who you are before any enumeration."
      },
      "success_indicators": [
        "Output shows HOSTNAME\\username format",
        "Example: clientwk220\\dave",
        "No error messages displayed"
      ],
      "failure_indicators": [
        "'whoami' is not recognized (very rare - indicates severely broken PATH)",
        "Access denied (indicates restricted shell)"
      ],
      "troubleshooting": {
        "'whoami' is not recognized": "PATH variable broken. Solution: Use full path C:\\Windows\\System32\\whoami.exe. Or check if shell is actually Windows (might be restricted shell or container).",
        "Access denied": "Highly restricted shell (AppLocker, Constrained Language Mode). Solution: Try %USERDOMAIN%\\%USERNAME% environment variables. Or echo %USERNAME% for username only.",
        "Output looks wrong (shows SID instead of name)": "Account may be recently created or orphaned. Solution: Use whoami /user to see SID, then check if account exists with net user."
      },
      "prerequisites": [],
      "next_steps": [
        "win-whoami-groups",
        "win-whoami-priv"
      ],
      "alternatives": [
        "echo %USERNAME%"
      ],
      "tags": [
        "WINDOWS",
        "ENUMERATION",
        "SITUATIONAL_AWARENESS",
        "POST_EXPLOITATION",
        "OSCP:HIGH",
        "QUICK_WIN"
      ],
      "oscp_relevance": "high",
      "notes": "FIRST COMMAND after gaining Windows shell. The hostname often reveals machine purpose (WEB01 = web server, MSSQL01 = database server, CLIENTWK220 = workstation). Username format tells you if local (HOSTNAME\\user) or domain account (DOMAIN\\user). This single command establishes your identity context for ALL subsequent enumeration and privilege escalation decisions.\n\nMANUAL ALTERNATIVES:\n\nBasic whoami:\nwhoami\n# Output: clientwk220\\dave\n\nEnvironment variables (if whoami blocked):\necho %USERDOMAIN%\\%USERNAME%\n# Output: CLIENTWK220\\dave\n\nHostname only:\nhostname\n# Output: clientwk220\n\nPowerShell alternatives:\n$env:USERNAME\n$env:COMPUTERNAME\n$env:USERDOMAIN\n[System.Security.Principal.WindowsIdentity]::GetCurrent().Name\n\nINTERPRETING OUTPUT:\n\nLocal account format:\nHOSTNAME\\username\nExample: CLIENTWK220\\dave\n# Implies: Non-domain machine OR local account on domain machine\n\nDomain account format:\nDOMAIN\\username\nExample: CORP\\dave\n# Implies: Domain-joined machine, domain credentials\n\nHOSTNAME INFERENCE:\n- WEB01, WWW, WEBSERVER = Web server (check IIS, Apache)\n- SQL01, MSSQL, DB = Database server (check SQL Server, MySQL)\n- DC01, DC, PDC = Domain Controller (high-value target)\n- CLIENT, WORKSTATION, WK = User workstation\n- FILE01, FS, NAS = File server (check shares)\n- MAIL, EXCHANGE = Mail server\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "win-whoami-groups",
      "name": "Whoami Groups - Group Memberships and SIDs",
      "category": "post-exploit",
      "subcategory": "situational-awareness",
      "command": "whoami /groups",
      "description": "Display all groups the current user belongs to, including SIDs and group types. Critical for understanding current privilege level and potential escalation paths.",
      "variables": [],
      "flag_explanations": {
        "/groups": "Display all security groups current user is a member of. Shows Group Name, Type (Well-known, Alias, etc.), SID, and Attributes (Enabled, Mandatory, etc.). CRITICAL for privilege assessment - membership in Administrators, Backup Operators, Remote Desktop Users determines attack vectors. SIDs reveal whether groups are local or domain-based."
      },
      "success_indicators": [
        "Table displays with columns: Group Name, Type, SID, Attributes",
        "Shows BUILTIN\\Users and other standard groups",
        "Contains well-known SIDs (S-1-5-*)"
      ],
      "failure_indicators": [
        "'whoami' is not recognized",
        "Access denied",
        "Empty output (extremely unusual)"
      ],
      "troubleshooting": {
        "No Administrators group shown": "User is not local admin. This is expected for low-privilege users. Solution: Look for other interesting groups: Backup Operators (file access), Remote Desktop Users (RDP access), Remote Management Users (WinRM access).",
        "Domain groups not displayed": "Machine may not be domain-joined or current user is local account. Solution: Check systeminfo | findstr Domain to verify domain membership.",
        "SIDs shown instead of names": "Group may be orphaned or from untrusted domain. Solution: SID S-1-5-32-544 = Administrators, S-1-5-32-545 = Users. Research SID online.",
        "Output truncated": "Console buffer too small. Solution: whoami /groups > groups.txt && type groups.txt to save and display full output."
      },
      "prerequisites": [
        "win-whoami-basic"
      ],
      "next_steps": [
        "ps-get-localgroup",
        "ps-get-localgroupmember"
      ],
      "alternatives": [
        "net user %USERNAME%"
      ],
      "tags": [
        "WINDOWS",
        "ENUMERATION",
        "SITUATIONAL_AWARENESS",
        "GROUP_ENUMERATION",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "SECOND COMMAND after whoami basic. Group memberships determine what attacks are possible. Key groups to look for:\n\n**HIGH-VALUE GROUPS (Immediate Privilege Escalation):**\n- Administrators - Full system access\n- Backup Operators - Can read/write all files (backup/restore rights)\n- Server Operators - Can modify services (service hijacking)\n- Account Operators - Can modify most users/groups\n\n**ACCESS GROUPS (Lateral Movement):**\n- Remote Desktop Users - RDP access available\n- Remote Management Users - WinRM access available\n- Distributed COM Users - DCOM lateral movement\n\n**DOMAIN GROUPS (AD Escalation):**\n- Domain Admins - Full domain control\n- Enterprise Admins - Full forest control\n- Schema Admins - AD schema modification\n- Group Policy Creator Owners - GPO modification\n\n**WELL-KNOWN SIDs:**\nS-1-5-32-544 = Administrators\nS-1-5-32-545 = Users\nS-1-5-32-555 = Remote Desktop Users\nS-1-5-11 = Authenticated Users\nS-1-5-18 = SYSTEM\n\nMANUAL ALTERNATIVES:\n\nAll groups with SIDs:\nwhoami /groups\n\nLegacy command (shows fewer groups):\nnet user %USERNAME%\n\nPowerShell:\n[Security.Principal.WindowsIdentity]::GetCurrent().Groups | ForEach-Object { $_.Translate([Security.Principal.NTAccount]).Value }\n\nINTERPRETING INTEGRITY LEVELS:\nMandatory Label\\High Mandatory Level = Elevated process\nMandatory Label\\Medium Mandatory Level = Standard user process\nMandatory Label\\Low Mandatory Level = Sandboxed process\nMandatory Label\\System Mandatory Level = SYSTEM process\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "win-whoami-priv",
      "name": "Whoami Privileges - Check Current Token Privileges",
      "category": "post-exploit",
      "subcategory": "situational-awareness",
      "command": "whoami /priv",
      "description": "Display all privileges assigned to current access token. Critical for identifying Potato attack vectors (SeImpersonatePrivilege) and other privilege escalation opportunities.",
      "variables": [],
      "flag_explanations": {
        "/priv": "Display all privileges in current access token with their state (Enabled/Disabled). Privileges determine what operations current process can perform. KEY PRIVILEGE: SeImpersonatePrivilege = Potato exploits viable. Other important privileges: SeDebugPrivilege (process manipulation), SeBackupPrivilege (read any file), SeRestorePrivilege (write any file), SeLoadDriverPrivilege (driver loading)."
      },
      "success_indicators": [
        "Table displays with columns: Privilege Name, Description, State",
        "Shows privileges like SeChangeNotifyPrivilege",
        "State shows Enabled or Disabled for each privilege"
      ],
      "failure_indicators": [
        "'whoami' is not recognized",
        "Access denied",
        "Very few privileges shown (normal for standard users)"
      ],
      "troubleshooting": {
        "SeImpersonatePrivilege not shown": "User doesn't have impersonation rights. Normal for standard users. Solution: Only service accounts (IIS, SQL Server, etc.) typically have this. If you're in such context, privilege should be present.",
        "All privileges Disabled": "Privileges exist but not active for this process. Solution: Some disabled privileges can be enabled with PowerShell or specific actions. Check if UAC prompt would enable them.",
        "Very few privileges (3-4 only)": "Standard user token. This is normal. Solution: Focus on other escalation vectors (unquoted services, scheduled tasks, etc.) rather than privilege abuse.",
        "Need to see all token info": "Use whoami /all for comprehensive view including user, groups, and privileges combined."
      },
      "prerequisites": [
        "win-whoami-basic"
      ],
      "next_steps": [
        "win-privesc-winpeas",
        "win-potato-exploits"
      ],
      "alternatives": [],
      "tags": [
        "WINDOWS",
        "ENUMERATION",
        "PRIVILEGE_ESCALATION",
        "SITUATIONAL_AWARENESS",
        "POST_EXPLOITATION",
        "OSCP:HIGH",
        "POTATO_EXPLOITS"
      ],
      "oscp_relevance": "high",
      "notes": "CRITICAL for Potato exploit detection. Check for SeImpersonatePrivilege or SeAssignPrimaryTokenPrivilege - if present, Potato exploits (JuicyPotato, PrintSpoofer, RoguePotato, etc.) will likely work for SYSTEM shell.\n\n**EXPLOITABLE PRIVILEGES (Immediate Escalation):**\n\nSeImpersonatePrivilege - POTATO EXPLOITS\n- JuicyPotato (Windows 7-10, Server 2008-2016)\n- PrintSpoofer (Windows 10, Server 2019+)\n- RoguePotato (All versions)\n- SweetPotato (All versions)\n- GodPotato (Windows 10, Server 2019+)\nTypically present on: IIS, MSSQL, service accounts\n\nSeAssignPrimaryTokenPrivilege - POTATO EXPLOITS\nSame as above - enables token manipulation\n\nSeDebugPrivilege - PROCESS INJECTION\n- Dump LSASS memory\n- Inject into any process\n- Read process memory\nTypically: Local Administrators only\n\nSeBackupPrivilege - FILE READ\n- Read any file regardless of ACL\n- Extract SAM/SYSTEM hives\n- Read sensitive configuration\nTypically: Backup Operators group\n\nSeRestorePrivilege - FILE WRITE\n- Write any file regardless of ACL\n- DLL hijacking in protected directories\n- Service binary replacement\nTypically: Backup Operators group\n\nSeLoadDriverPrivilege - DRIVER LOADING\n- Load malicious kernel driver\n- Capcom.sys exploitation\nTypically: Local Administrators only\n\nSeTakeOwnershipPrivilege - OWNERSHIP CHANGE\n- Take ownership of any object\n- Then modify ACLs to gain access\nTypically: Local Administrators only\n\n**COMMON PRIVILEGE SETS:**\n\nStandard User (limited escalation options):\n- SeChangeNotifyPrivilege (bypass traverse checking)\n- SeIncreaseWorkingSetPrivilege\n- SeShutdownPrivilege\n\nService Account (Potato viable):\n- All standard user privileges\n+ SeImpersonatePrivilege\n+ SeAssignPrimaryTokenPrivilege\n\nLocal Administrator (many options):\n- All service account privileges\n+ SeDebugPrivilege\n+ SeBackupPrivilege\n+ SeRestorePrivilege\n+ SeLoadDriverPrivilege\n+ SeTakeOwnershipPrivilege\n\nSYSTEM (full privileges):\n- All privileges enabled\n\nMANUAL ALTERNATIVES:\n\nView all privileges:\nwhoami /priv\n\nComprehensive view (user + groups + privileges):\nwhoami /all\n\nPowerShell (check specific privilege):\n[Security.Principal.WindowsIdentity]::GetCurrent().HasClaim('SeImpersonatePrivilege')\n\nPOTATO DECISION TREE:\n1. Run whoami /priv\n2. Check for SeImpersonatePrivilege = Enabled\n3. If YES: Try PrintSpoofer (newest, reliable)\n4. If PrintSpoofer fails: Try JuicyPotato/SweetPotato\n5. If all fail: Check Windows version compatibility\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "ps-get-localuser",
      "name": "Get-LocalUser - List All Local Users",
      "category": "post-exploit",
      "subcategory": "user-enumeration",
      "command": "Get-LocalUser",
      "description": "PowerShell cmdlet to list all local user accounts on the system. Shows enabled/disabled status and account descriptions. Essential for identifying potential privilege escalation targets.",
      "variables": [],
      "flag_explanations": {
        "Get-LocalUser": "PowerShell cmdlet from LocalAccounts module (Windows 10+, Server 2016+). Lists all local user accounts with Name, Enabled status, and Description fields. Use this to identify: (1) disabled Administrator account (can sometimes be enabled), (2) service accounts that may have weak passwords, (3) admin-related usernames like 'adminuser', 'backupadmin', 'daveadmin' suggesting privileged accounts."
      },
      "success_indicators": [
        "Table with columns: Name, Enabled, Description",
        "Shows Administrator account (usually Disabled)",
        "Shows Guest account (should be Disabled)",
        "Lists custom user accounts"
      ],
      "failure_indicators": [
        "The term 'Get-LocalUser' is not recognized",
        "Access denied",
        "Module LocalAccounts not found"
      ],
      "troubleshooting": {
        "'Get-LocalUser' is not recognized": "Windows version too old (pre-Win10/Server 2016) or module not installed. Solution: Use legacy command: net user. This works on all Windows versions.",
        "Access denied": "Running in restricted PowerShell session. Solution: Use cmd.exe and net user command instead. Or try PowerShell bypass: powershell -ep bypass -c Get-LocalUser",
        "Empty output": "Very unusual - system should have at least Administrator and Guest. Solution: Check if connected to correct system. Use net user as fallback.",
        "Constrained Language Mode": "AppLocker or WDAC restricting PowerShell. Solution: Exit to cmd.exe and use net user. Or use C# reflection techniques to bypass."
      },
      "prerequisites": [],
      "next_steps": [
        "ps-get-localgroup",
        "ps-get-localgroupmember"
      ],
      "alternatives": [
        "win-net-user-local"
      ],
      "tags": [
        "WINDOWS",
        "POWERSHELL",
        "USER_ENUMERATION",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "Identify ALL local users for password attacks and privilege escalation. Look for patterns:\n\n**HIGH-VALUE USERNAME PATTERNS:**\n- *admin* (daveadmin, backupadmin, adminuser)\n- *backup* (backupuser, backup_svc)\n- *service*, *svc* (sqlservice, svc_account)\n- *test* (testadmin - often weak passwords)\n- Same name with/without 'admin' suffix (dave + daveadmin)\n\n**INTERPRETING ENABLED STATUS:**\n- Administrator: False = Disabled (default on Win10+)\n  Consider: Can you enable it if you get admin?\n- Guest: False = Disabled (security best practice)\n  If Enabled: Anonymous access possible\n- Custom accounts: Should be Enabled for active users\n  Disabled accounts may have unchanged old passwords\n\n**ATTACK IMPLICATIONS:**\n1. Find admin-looking usernames\n2. Try password reuse (found passwords from files)\n3. Try weak passwords on service accounts\n4. Cross-reference with found credentials\n\nMANUAL ALTERNATIVES:\n\nPowerShell (modern):\nGet-LocalUser\nGet-LocalUser | Select-Object Name, Enabled, Description\nGet-LocalUser | Where-Object { $_.Enabled -eq $true }\n\nLegacy (all Windows versions):\nnet user\n\nDetailed user info:\nnet user <username>\n\nWMIC:\nwmic useraccount get name,disabled\n\nFilter for enabled accounts only:\nGet-LocalUser | Where-Object Enabled | Select-Object Name\n\nEXAMPLE OUTPUT INTERPRETATION:\n\nName            Enabled Description\n----            ------- -----------\nAdministrator   False   Built-in account for administering...\nBackupAdmin     True    \ndave            True    dave\ndaveadmin       True    \nGuest           False   Built-in account for guest access...\nsteve           True\n\nAnalysis:\n- BackupAdmin: Enabled admin account - HIGH VALUE TARGET\n- dave + daveadmin: Same person has both accounts\n  Pattern: Low-priv dave, high-priv daveadmin\n  Attack: Find dave's password, try it for daveadmin\n- steve: Standard user, check group memberships\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "ps-get-localgroup",
      "name": "Get-LocalGroup - List All Local Groups",
      "category": "post-exploit",
      "subcategory": "group-enumeration",
      "command": "Get-LocalGroup",
      "description": "PowerShell cmdlet to list all local groups on the system. Identifies custom groups that may indicate privileged access or special permissions.",
      "variables": [],
      "flag_explanations": {
        "Get-LocalGroup": "PowerShell cmdlet that lists all local security groups. Shows Name and Description for each group. Look for custom groups (non-BUILTIN) that may have special permissions - descriptions often reveal purpose. Standard BUILTIN groups include Administrators, Users, Remote Desktop Users, Backup Operators."
      },
      "success_indicators": [
        "Table with Name and Description columns",
        "Shows BUILTIN groups (Administrators, Users, etc.)",
        "May show custom groups with descriptions"
      ],
      "failure_indicators": [
        "'Get-LocalGroup' is not recognized",
        "Access denied",
        "Module LocalAccounts not found"
      ],
      "troubleshooting": {
        "'Get-LocalGroup' is not recognized": "Windows version too old. Solution: Use net localgroup command (works on all Windows versions).",
        "Need more group details": "Get-LocalGroup only shows name and description. Solution: For members, use Get-LocalGroupMember <groupname>",
        "Custom groups not explained": "Description may be empty. Solution: Group name often reveals purpose. Check membership with Get-LocalGroupMember."
      },
      "prerequisites": [],
      "next_steps": [
        "ps-get-localgroupmember"
      ],
      "alternatives": [
        "win-net-localgroup"
      ],
      "tags": [
        "WINDOWS",
        "POWERSHELL",
        "GROUP_ENUMERATION",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "Identify ALL local groups, especially custom ones. Standard groups to always check membership for:\n\n**CRITICAL BUILTIN GROUPS:**\n- Administrators - Full system control\n- Backup Operators - Read/write any file\n- Remote Desktop Users - RDP access\n- Remote Management Users - WinRM access\n- Distributed COM Users - DCOM lateral movement\n- Hyper-V Administrators - VM control\n\n**CUSTOM GROUPS TO INVESTIGATE:**\nAny non-BUILTIN group - read the description!\n- adminteam, ITadmins - Likely has special access\n- BackupUsers - May have file access\n- helpdesk - Often has password reset rights\n- developers - May have code/server access\n\nMANUAL ALTERNATIVES:\n\nPowerShell:\nGet-LocalGroup\nGet-LocalGroup | Select-Object Name, Description\nGet-LocalGroup | Where-Object { $_.Name -like '*admin*' }\n\nLegacy:\nnet localgroup\n\nEXAMPLE OUTPUT INTERPRETATION:\n\nName                                Description\n----                                -----------\nAdministrators                      Administrators have complete...\nadminteam                           Members are admins to all workstations on second floor\nBackup Operators                    Backup Operators can override...\nBackupUsers                         \nhelpdesk                            \nRemote Desktop Users                Members can log on remotely...\nRemote Management Users             Members can access WMI resources...\nUsers                               Users are prevented from making...\n\nAnalysis:\n- adminteam: Custom group with informative description\n  Check members: Get-LocalGroupMember adminteam\n- BackupUsers: Custom, no description\n  Different from BUILTIN\\Backup Operators\n- helpdesk: Custom, check if has special permissions\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "ps-get-localgroupmember",
      "name": "Get-LocalGroupMember - List Group Members",
      "category": "post-exploit",
      "subcategory": "group-enumeration",
      "command": "Get-LocalGroupMember <GROUP>",
      "description": "PowerShell cmdlet to list members of a specific local group. Essential for identifying who has administrative or special access on the system.",
      "variables": [
        {
          "name": "<GROUP>",
          "description": "Name of the local group to enumerate members",
          "example": "Administrators",
          "required": true
        }
      ],
      "flag_explanations": {
        "Get-LocalGroupMember": "PowerShell cmdlet that lists all members (users and groups) of specified local group. Shows ObjectClass (User/Group), Name, and PrincipalSource (Local/ActiveDirectory). Use to identify who has specific access - especially for Administrators, Remote Desktop Users, Remote Management Users groups."
      },
      "success_indicators": [
        "Table with ObjectClass, Name, PrincipalSource columns",
        "Shows user accounts in the group",
        "May show nested groups as members"
      ],
      "failure_indicators": [
        "'Get-LocalGroupMember' is not recognized",
        "Group <name> was not found",
        "Access denied"
      ],
      "troubleshooting": {
        "Group not found": "Group name incorrect or doesn't exist. Solution: List all groups first with Get-LocalGroup to get exact names. Names are case-insensitive.",
        "'Get-LocalGroupMember' not recognized": "Windows version too old. Solution: Use net localgroup <groupname> instead.",
        "Shows SID instead of name": "Account may be from untrusted domain or deleted. Solution: Research the SID format or ignore (orphaned account).",
        "Group shows nested groups": "Windows supports group nesting. Solution: Recursively enumerate nested groups: Get-LocalGroupMember <nested_group>."
      },
      "prerequisites": [
        "ps-get-localgroup"
      ],
      "next_steps": [
        "win-net-user-detail"
      ],
      "alternatives": [
        "win-net-localgroup-members"
      ],
      "tags": [
        "WINDOWS",
        "POWERSHELL",
        "GROUP_ENUMERATION",
        "USER_ENUMERATION",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "ALWAYS check Administrators group first - identifies all privileged users on system.\n\n**CRITICAL GROUPS TO ENUMERATE:**\n\n1. Administrators\nGet-LocalGroupMember Administrators\n# All local admins - primary targets\n\n2. Remote Desktop Users\nGet-LocalGroupMember 'Remote Desktop Users'\n# Who can RDP - useful for credential reuse\n\n3. Remote Management Users\nGet-LocalGroupMember 'Remote Management Users'\n# Who can WinRM - useful for lateral movement\n\n4. Backup Operators\nGet-LocalGroupMember 'Backup Operators'\n# Can read/write any file - interesting for privesc\n\n5. Any custom groups found\nGet-LocalGroupMember <custom_group>\n\n**INTERPRETING PRINCIPALSOURCE:**\n- Local = Account created on this machine\n- ActiveDirectory = Domain account\n- MicrosoftAccount = Microsoft/Azure AD account\n\nMANUAL ALTERNATIVES:\n\nPowerShell:\nGet-LocalGroupMember Administrators\nGet-LocalGroupMember 'Remote Desktop Users'\nGet-LocalGroupMember -Group 'Administrators' | Select-Object Name, ObjectClass\n\nLegacy:\nnet localgroup Administrators\nnet localgroup \"Remote Desktop Users\"\n\nEXAMPLE OUTPUT INTERPRETATION:\n\nObjectClass Name                      PrincipalSource\n----------- ----                      ---------------\nUser        CLIENTWK220\\Administrator Local\nUser        CLIENTWK220\\daveadmin     Local\nUser        CLIENTWK220\\backupadmin   Local\nUser        CLIENTWK220\\offsec        Local\n\nAnalysis:\n- 4 local administrators found\n- daveadmin, backupadmin, offsec are custom accounts\n- Administrator is the built-in account\n- All are Local (not domain accounts)\n\nATTACK IMPLICATIONS:\n1. daveadmin - Likely dave's admin account\n   Try: Passwords found for dave\n2. backupadmin - Backup related\n   Check: Backup software configs for stored creds\n3. Target credentials for ANY of these 4 users\n   for SYSTEM-level access\n\nTIME ESTIMATE: <1 second per group"
    },
    {
      "id": "win-net-user-local",
      "name": "Net User - List Local Users (Legacy)",
      "category": "post-exploit",
      "subcategory": "user-enumeration",
      "command": "net user",
      "description": "Legacy Windows command to list all local user accounts. Works on all Windows versions including pre-PowerShell systems. Alternative to Get-LocalUser.",
      "variables": [],
      "flag_explanations": {
        "net user": "Built-in Windows command available since Windows NT. Lists all local user accounts in simple format. Works in cmd.exe and PowerShell on ALL Windows versions. More compatible than Get-LocalUser but provides less detail. Use when PowerShell cmdlets unavailable or in restricted shells."
      },
      "success_indicators": [
        "Header: User accounts for \\\\HOSTNAME",
        "List of usernames displayed",
        "Footer: The command completed successfully"
      ],
      "failure_indicators": [
        "System error has occurred",
        "Access denied",
        "'net' is not recognized (extremely rare)"
      ],
      "troubleshooting": {
        "Access denied": "User lacks permission to list accounts. Very unusual. Solution: Try in elevated prompt. Or check if system is domain controller (use net user /domain for domain users).",
        "Shows domain users instead of local": "Connected to domain controller. Solution: For local accounts on DC, use: wmic useraccount where domain='%COMPUTERNAME%' get name",
        "Need more details on user": "net user only shows names. Solution: Use net user <username> for details on specific user."
      },
      "prerequisites": [],
      "next_steps": [
        "win-net-user-detail",
        "win-net-localgroup"
      ],
      "alternatives": [
        "ps-get-localuser"
      ],
      "tags": [
        "WINDOWS",
        "CMD",
        "LEGACY",
        "USER_ENUMERATION",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "FALLBACK when PowerShell blocked or unavailable. Works on Windows XP through Windows 11 and all Server versions.\n\n**WHEN TO USE NET USER vs GET-LOCALUSER:**\n- net user: Older systems, AppLocker/CLM environments, cmd.exe shells\n- Get-LocalUser: Modern systems, need enabled/disabled status, scripting\n\n**OUTPUT FORMAT:**\n\nUser accounts for \\\\CLIENTWK220\n\n-------------------------------------------------------------------------------\nAdministrator            BackupAdmin              dave\ndaveadmin                DefaultAccount           Guest\noffsec                   steve\nThe command completed successfully.\n\n**COMPARISON WITH GET-LOCALUSER:**\nnet user: Just names, works everywhere\nGet-LocalUser: Name + Enabled + Description, modern systems only\n\nMANUAL ALTERNATIVES:\n\nBasic list:\nnet user\n\nSpecific user details:\nnet user Administrator\nnet user daveadmin\n\nWMIC (more detail):\nwmic useraccount get name,disabled,description\n\nPowerShell:\nGet-LocalUser\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "win-net-user-detail",
      "name": "Net User Detail - Specific User Information",
      "category": "post-exploit",
      "subcategory": "user-enumeration",
      "command": "net user <USERNAME>",
      "description": "Display detailed information about a specific local user including group memberships, password expiry, last logon, and account status.",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "The username to get details for",
          "example": "steve",
          "required": true
        }
      ],
      "flag_explanations": {
        "net user <USERNAME>": "Show detailed information for specific user. Output includes: Full name, comment, account active status, account expiration, password last set, password expiration, password changeable, logon hours, local group memberships, global group memberships (if domain). Critical for understanding user's access level and account configuration."
      },
      "success_indicators": [
        "User name line displayed",
        "Local Group Memberships shown",
        "Account active: Yes/No displayed",
        "The command completed successfully"
      ],
      "failure_indicators": [
        "The user name could not be found",
        "Access denied",
        "System error has occurred"
      ],
      "troubleshooting": {
        "User name not found": "Username doesn't exist or typo. Solution: List users first with net user to get exact names.",
        "Shows domain user info": "Username exists in domain. Solution: Specify local user explicitly: net user <username> /domain:false (doesn't work on all versions). Better: check wmic useraccount where name='<username>' and domain='%COMPUTERNAME%' get * /format:list",
        "Access denied": "Rare - user lacks permission. Solution: Try from elevated prompt or use whoami /groups on target user session."
      },
      "prerequisites": [
        "win-net-user-local"
      ],
      "next_steps": [
        "ps-get-localgroupmember"
      ],
      "alternatives": [],
      "tags": [
        "WINDOWS",
        "CMD",
        "LEGACY",
        "USER_ENUMERATION",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "Get detailed info on SPECIFIC users identified as interesting (admin-like names, found in config files, etc.).\n\n**KEY FIELDS TO ANALYZE:**\n\nAccount active: Yes\n- If No, account disabled but may have valid password\n- Disabled accounts sometimes have unchanged old passwords\n\nLocal Group Memberships:\n- Shows all groups user belongs to\n- Look for: *Administrators, *Remote Desktop Users, etc.\n- Asterisk (*) prefix indicates local group\n\nPassword last set:\n- Very old date = password may be weak/unchanged\n- Very recent = user active, password may be strong\n\nPassword expires:\n- Never = Service account or admin convenience\n- Date = Standard user account\n\nLast logon:\n- Recent = Active user\n- Never/old = Dormant account, may have weak security\n\nMANUAL ALTERNATIVES:\n\nSingle user:\nnet user steve\nnet user Administrator\n\nWMIC:\nwmic useraccount where name='steve' get /format:list\n\nPowerShell:\nGet-LocalUser -Name steve | Format-List *\n\nEXAMPLE OUTPUT INTERPRETATION:\n\nUser name                    steve\nFull Name                    \nComment                      \nAccount active               Yes\nAccount expires              Never\nPassword last set            6/16/2022 1:03:52 PM\nPassword expires             Never\nPassword changeable          6/16/2022 1:03:52 PM\nPassword required            Yes\nUser may change password     Yes\nLogon hours allowed          All\nLocal Group Memberships      *helpdesk          *Remote Desktop Users\n                             *Remote Management Use*Users\nGlobal Group memberships     *None\n\nAnalysis:\n- Account active: Yes (can be used)\n- Password never expires: Convenience setting\n- Local Group Memberships:\n  - helpdesk: Custom group - check what access\n  - Remote Desktop Users: Can RDP to this system\n  - Remote Management Users: Can WinRM to this system\n  - Users: Standard user group\n- Not in Administrators: Not local admin\n- But CAN access system remotely (RDP/WinRM)\n\nATTACK IMPLICATION:\nIf we find steve's password, we can:\n1. RDP to this system\n2. WinRM to this system (evil-winrm)\nBut NOT run as administrator (need privesc)\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "win-net-localgroup",
      "name": "Net Localgroup - List Local Groups (Legacy)",
      "category": "post-exploit",
      "subcategory": "group-enumeration",
      "command": "net localgroup",
      "description": "Legacy Windows command to list all local groups on the system. Works on all Windows versions. Alternative to Get-LocalGroup.",
      "variables": [],
      "flag_explanations": {
        "net localgroup": "Built-in Windows command that lists all local security groups. Works on ALL Windows versions from XP to 11 and all Server versions. Output shows group names prefixed with asterisk (*). Use when Get-LocalGroup unavailable due to old Windows version or PowerShell restrictions."
      },
      "success_indicators": [
        "Header: Aliases for \\\\HOSTNAME",
        "List of group names with * prefix",
        "The command completed successfully"
      ],
      "failure_indicators": [
        "System error has occurred",
        "Access denied"
      ],
      "troubleshooting": {
        "Shows domain groups": "Machine is a domain controller. Solution: Local groups still shown, but domain groups also appear. Focus on groups without DOMAIN\\ prefix.",
        "Access denied": "Very unusual. Solution: Try from elevated prompt."
      },
      "prerequisites": [],
      "next_steps": [
        "win-net-localgroup-members"
      ],
      "alternatives": [
        "ps-get-localgroup"
      ],
      "tags": [
        "WINDOWS",
        "CMD",
        "LEGACY",
        "GROUP_ENUMERATION",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "FALLBACK when PowerShell blocked. Works everywhere.\n\n**EXAMPLE OUTPUT:**\n\nAliases for \\\\CLIENTWK220\n\n-------------------------------------------------------------------------------\n*Access Control Assistance Operators\n*Administrators\n*adminteam\n*Backup Operators\n*BackupUsers\n*Cryptographic Operators\n*Device Owners\n*Distributed COM Users\n*Event Log Readers\n*Guests\n*helpdesk\n*Hyper-V Administrators\n*IIS_IUSRS\n*Network Configuration Operators\n*Performance Log Users\n*Performance Monitor Users\n*Power Users\n*Remote Desktop Users\n*Remote Management Users\n*Replicator\n*System Managed Accounts Group\n*Users\nThe command completed successfully.\n\n**KEY GROUPS TO CHECK MEMBERS:**\n1. Administrators - Full control\n2. adminteam - Custom admin group\n3. Backup Operators - File access\n4. BackupUsers - Custom backup group\n5. helpdesk - Custom support group\n6. Remote Desktop Users - RDP access\n7. Remote Management Users - WinRM access\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "win-net-localgroup-members",
      "name": "Net Localgroup Members - List Group Members (Legacy)",
      "category": "post-exploit",
      "subcategory": "group-enumeration",
      "command": "net localgroup <GROUP>",
      "description": "Legacy Windows command to list members of a specific local group. Works on all Windows versions. Alternative to Get-LocalGroupMember.",
      "variables": [
        {
          "name": "<GROUP>",
          "description": "Name of the local group to list members of",
          "example": "Administrators",
          "required": true
        }
      ],
      "flag_explanations": {
        "net localgroup <GROUP>": "Lists all members of the specified local group. Works on ALL Windows versions. Use when Get-LocalGroupMember unavailable. Group names with spaces must be quoted: net localgroup \"Remote Desktop Users\". Shows both local and domain accounts that are members."
      },
      "success_indicators": [
        "Alias name: <groupname>",
        "Members list displayed",
        "The command completed successfully"
      ],
      "failure_indicators": [
        "The local group name could not be found",
        "Access denied"
      ],
      "troubleshooting": {
        "Group name not found": "Typo or group doesn't exist. Solution: List groups first with net localgroup, use exact name including spaces.",
        "Group has spaces in name": "Must quote the name. Solution: net localgroup \"Remote Desktop Users\" or net localgroup \"Remote Management Users\"",
        "Shows SID instead of name": "Member account orphaned or from untrusted domain. Solution: Ignore or research SID format."
      },
      "prerequisites": [
        "win-net-localgroup"
      ],
      "next_steps": [
        "win-net-user-detail"
      ],
      "alternatives": [
        "ps-get-localgroupmember"
      ],
      "tags": [
        "WINDOWS",
        "CMD",
        "LEGACY",
        "GROUP_ENUMERATION",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "ALWAYS enumerate Administrators group. Use quotes for group names with spaces.\n\n**ESSENTIAL ENUMERATIONS:**\n\nnet localgroup Administrators\nnet localgroup \"Remote Desktop Users\"\nnet localgroup \"Remote Management Users\"\nnet localgroup \"Backup Operators\"\n\n**EXAMPLE OUTPUT:**\n\nAlias name     Administrators\nComment        Administrators have complete and unrestricted access to the computer/domain\n\nMembers\n\n-------------------------------------------------------------------------------\nAdministrator\nbackupadmin\ndaveadmin\noffsec\nThe command completed successfully.\n\nAnalysis:\n- 4 administrators found\n- Target these accounts for password attacks\n\nTIME ESTIMATE: <1 second per group"
    },
    {
      "id": "win-systeminfo-basic",
      "name": "Systeminfo - OS Version and System Information",
      "category": "post-exploit",
      "subcategory": "situational-awareness",
      "command": "systeminfo",
      "description": "Display detailed system information including OS version, build number, architecture, hotfixes, and hardware. Essential for identifying kernel exploits and understanding target environment.",
      "variables": [],
      "flag_explanations": {
        "systeminfo": "Built-in Windows command that displays comprehensive system information. Key fields: OS Name/Version (determines exploit compatibility), System Type (x64/x86 architecture), Hotfix(s) (missing patches = vulnerabilities), Network Card(s) (interfaces for pivoting). Works on all Windows versions. Critical for kernel exploit research and exam planning."
      },
      "success_indicators": [
        "OS Name and Version displayed",
        "System Type shows x64 or x86",
        "Hotfix(s) section lists installed patches",
        "Network Card(s) shows interfaces"
      ],
      "failure_indicators": [
        "'systeminfo' is not recognized (rare)",
        "Access denied (unusual)",
        "Command hangs (network issues querying domain)"
      ],
      "troubleshooting": {
        "Command hangs for long time": "Trying to contact domain controller. Solution: Run systeminfo | findstr /B /C:\"OS\" /C:\"System Type\" /C:\"Hotfix\" for faster output without network queries.",
        "Need specific information quickly": "Full systeminfo is slow. Solution: systeminfo | findstr /i \"os version\" for OS only. Or systeminfo | findstr /i \"hotfix\" for patches only.",
        "Architecture unclear": "Need to know 32-bit vs 64-bit for exploits/tools. Solution: System Type line shows x64-based PC or x86-based PC."
      },
      "prerequisites": [],
      "next_steps": [
        "win-kernel-exploits",
        "win-privesc-winpeas"
      ],
      "alternatives": [
        "Get-ComputerInfo"
      ],
      "tags": [
        "WINDOWS",
        "ENUMERATION",
        "SITUATIONAL_AWARENESS",
        "KERNEL_EXPLOITS",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "CRITICAL for determining attack vectors. Parse output for key information:\n\n**KEY FIELDS:**\n\nOS Name: Microsoft Windows 11 Pro\nOS Version: 10.0.22621 N/A Build 22621\n# Build number determines exact version and patch level\n# Search: \"Windows Build 22621 vulnerabilities\"\n\nSystem Type: x64-based PC\n# CRITICAL for exploit/tool selection\n# x64 = use 64-bit tools/exploits\n# x86 = use 32-bit tools/exploits\n\nHotfix(s): X Hotfix(s) Installed.\n           [01]: KB5015684\n           [02]: KB5016348\n# Missing hotfixes = potential vulnerabilities\n# Compare against known vulnerable patch levels\n\n**QUICK FILTERS:**\n\nOS version only:\nsysteminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\"\n\nArchitecture:\nsysteminfo | findstr /B /C:\"System Type\"\n\nPatches:\nsysteminfo | findstr /B /C:\"Hotfix\"\n\nDomain info:\nsysteminfo | findstr /B /C:\"Domain\"\n\nAll key info:\nsysteminfo | findstr /i \"os name version system type domain hotfix\"\n\n**KERNEL EXPLOIT RESEARCH:**\n1. Note OS version and build number\n2. Search: \"Windows [version] [build] kernel exploit\"\n3. Check if required patches are installed\n4. Cross-reference with exploit-db, GitHub\n\n**COMMON OSCP-RELEVANT BUILDS:**\n- Windows 7 SP1: Build 7601 (many kernel exploits)\n- Windows 10 1607: Build 14393 (various privesc)\n- Windows 10 1903: Build 18362\n- Windows 11 22H2: Build 22621\n- Server 2016: Build 14393\n- Server 2019: Build 17763\n\nTIME ESTIMATE: 5-30 seconds (faster with filters)"
    },
    {
      "id": "win-ipconfig-all",
      "name": "Ipconfig All - Network Configuration",
      "category": "post-exploit",
      "subcategory": "network-enumeration",
      "command": "ipconfig /all",
      "description": "Display detailed network configuration for all interfaces including IP addresses, DNS servers, DHCP status, and MAC addresses. Essential for understanding network position and pivoting opportunities.",
      "variables": [],
      "flag_explanations": {
        "/all": "Display full configuration for all network interfaces. Without /all, only shows IP address, subnet mask, and default gateway. With /all, additionally shows: DNS servers (useful for AD enumeration), DHCP server (indicates network infrastructure), MAC address (for ARP-based attacks), DNS suffix (reveals domain name)."
      },
      "success_indicators": [
        "Windows IP Configuration header displayed",
        "Adapter information for each interface",
        "IPv4 Address shown",
        "DNS Servers listed"
      ],
      "failure_indicators": [
        "'ipconfig' is not recognized (extremely rare)",
        "Media disconnected (adapter disabled)"
      ],
      "troubleshooting": {
        "Multiple adapters shown": "Normal for machines with multiple network connections. Solution: Identify main adapter (usually first Ethernet or Wi-Fi). Look for 'Connection-specific DNS Suffix' to identify domain networks.",
        "DHCP Enabled: Yes but no IP": "DHCP failed. Solution: Adapter may be on isolated network or DHCP server down. Manual IP may be needed.",
        "No DNS servers shown": "Static configuration without DNS. Solution: Check hosts file at C:\\Windows\\System32\\drivers\\etc\\hosts for manual entries."
      },
      "prerequisites": [],
      "next_steps": [
        "win-route-print",
        "win-netstat-ano"
      ],
      "alternatives": [
        "Get-NetIPConfiguration"
      ],
      "tags": [
        "WINDOWS",
        "ENUMERATION",
        "NETWORK",
        "SITUATIONAL_AWARENESS",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "Understand network position and identify pivoting opportunities.\n\n**KEY FIELDS:**\n\nHost Name: clientwk220\n# Confirms hostname from whoami\n\nPrimary Dns Suffix:\n# Empty = not domain-joined or local DNS\n# corp.com = Domain name for AD enumeration\n\nIPv4 Address: 192.168.50.220\n# Your current IP - note for pivoting\n\nSubnet Mask: 255.255.255.0\n# /24 = 254 hosts on this subnet\n\nDefault Gateway: 192.168.50.254\n# Router - may be pivot point\n\nDHCP Enabled: No\n# Manual config = likely server or important workstation\n# Yes = typical workstation\n\nDNS Servers: 8.8.8.8 or 192.168.50.1\n# Internal DNS = AD environment, use for enumeration\n# External DNS = May be standalone or isolated\n\n**PIVOTING ASSESSMENT:**\n1. Note all IP addresses and subnets\n2. Multiple NICs = access to multiple networks\n3. VPN adapters = remote network access\n4. Internal DNS = domain enumeration target\n\n**MANUAL ALTERNATIVES:**\n\nBasic (just IP/gateway):\nipconfig\n\nFull details:\nipconfig /all\n\nDNS cache (reveals accessed hosts):\nipconfig /displaydns\n\nPowerShell:\nGet-NetIPConfiguration\nGet-NetAdapter | Get-NetIPAddress\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "win-route-print",
      "name": "Route Print - Routing Table",
      "category": "post-exploit",
      "subcategory": "network-enumeration",
      "command": "route print",
      "description": "Display the IP routing table showing network destinations and gateways. Reveals accessible networks and potential pivot points.",
      "variables": [],
      "flag_explanations": {
        "route print": "Windows command to display kernel IP routing table. Shows: Interface List (NICs), IPv4 Route Table, IPv6 Route Table. Key information: Network destinations reachable from this host, gateways used for each destination. Reveals hidden networks or VPN routes not obvious from ipconfig."
      },
      "success_indicators": [
        "Interface List displayed",
        "IPv4 Route Table shown",
        "Network Destination 0.0.0.0 (default route) visible",
        "Local subnet route visible"
      ],
      "failure_indicators": [
        "'route' is not recognized (rare)",
        "Access denied"
      ],
      "troubleshooting": {
        "Too much output": "IPv6 routes cluttering view. Solution: route print -4 for IPv4 only.",
        "Need specific route": "Looking for route to specific network. Solution: route print | findstr 192.168"
      },
      "prerequisites": [
        "win-ipconfig-all"
      ],
      "next_steps": [
        "win-netstat-ano"
      ],
      "alternatives": [
        "netstat -rn"
      ],
      "tags": [
        "WINDOWS",
        "ENUMERATION",
        "NETWORK",
        "PIVOTING",
        "POST_EXPLOITATION",
        "OSCP:MEDIUM"
      ],
      "oscp_relevance": "medium",
      "notes": "Identify accessible networks for pivoting and lateral movement.\n\n**INTERPRETING OUTPUT:**\n\nNetwork Destination  Netmask       Gateway       Interface\n0.0.0.0              0.0.0.0       192.168.50.254 192.168.50.220\n# Default route - all traffic not matching other routes goes here\n\n192.168.50.0         255.255.255.0 On-link       192.168.50.220\n# Local subnet - directly accessible hosts\n\n10.10.0.0            255.255.0.0   192.168.50.1  192.168.50.220\n# Additional network route - may indicate VPN or secondary network\n\n**PIVOTING ASSESSMENT:**\n1. Routes to non-local networks = potential pivot targets\n2. Multiple gateways = multiple network paths\n3. VPN routes = access to remote networks\n4. Persistent routes = regularly accessed networks\n\n**QUICK FILTERS:**\n\nIPv4 routes only:\nroute print -4\n\nFilter for specific subnet:\nroute print | findstr 10.10\n\nPowerShell:\nGet-NetRoute\nGet-NetRoute -AddressFamily IPv4\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "win-netstat-ano",
      "name": "Netstat - Active Network Connections",
      "category": "post-exploit",
      "subcategory": "network-enumeration",
      "command": "netstat -ano",
      "description": "Display all active TCP connections, listening ports, and associated process IDs. Essential for identifying running services, other users' connections, and potential attack vectors.",
      "variables": [],
      "flag_explanations": {
        "-a": "Display ALL connections and listening ports. Without this, only shows established connections. Critical for finding services that may be exploitable.",
        "-n": "Numeric form - shows IP addresses instead of hostnames. Faster output, avoids DNS lookups, and shows exact IPs.",
        "-o": "Shows owning Process ID (PID) for each connection. Use with tasklist to identify which process owns each connection. Critical for understanding what's running."
      },
      "success_indicators": [
        "Active Connections header displayed",
        "Columns: Proto, Local Address, Foreign Address, State, PID",
        "Shows LISTENING entries for services",
        "Shows ESTABLISHED for active connections"
      ],
      "failure_indicators": [
        "'netstat' is not recognized (rare)",
        "Access denied"
      ],
      "troubleshooting": {
        "Too much output": "Many connections. Solution: netstat -ano | findstr LISTENING for services only. Or netstat -ano | findstr ESTABLISHED for active connections.",
        "Need to identify process": "Know PID but not process name. Solution: tasklist /fi \"PID eq <pid>\" to get process name.",
        "Want process names directly": "Use netstat -anb (requires admin). Or combine: netstat -ano | findstr :80 to find port 80 PID, then tasklist /fi \"pid eq <pid>\"."
      },
      "prerequisites": [
        "win-ipconfig-all"
      ],
      "next_steps": [
        "ps-get-process"
      ],
      "alternatives": [
        "Get-NetTCPConnection"
      ],
      "tags": [
        "WINDOWS",
        "ENUMERATION",
        "NETWORK",
        "SERVICES",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "CRITICAL for understanding what's running and who's connected.\n\n**COMMON PORTS TO INVESTIGATE:**\n\nPort 80/443 (HTTP/HTTPS):\n- Web server running\n- Check for web exploits, default creds\n\nPort 3306 (MySQL):\n- Database server\n- Check for default creds, config files\n\nPort 3389 (RDP):\n- Remote desktop enabled\n- Shows active RDP sessions (ESTABLISHED)\n\nPort 445 (SMB):\n- File sharing enabled\n- Check for open shares\n\nPort 5985/5986 (WinRM):\n- Windows Remote Management\n- evil-winrm access possible\n\n**INTERPRETING STATE:**\n\nLISTENING - Service waiting for connections\n- 0.0.0.0:PORT = listening on all interfaces\n- 127.0.0.1:PORT = localhost only\n- 192.168.x.x:PORT = specific interface\n\nESTABLISHED - Active connection\n- Check Foreign Address for connected clients\n- Your attack connection visible here\n- Other users' RDP sessions visible\n\n**EXAMPLE ANALYSIS:**\n\nTCP  0.0.0.0:80        0.0.0.0:0    LISTENING   3340\n# Web server on all interfaces, PID 3340\n\nTCP  0.0.0.0:3306      0.0.0.0:0    LISTENING   3508\n# MySQL on all interfaces, PID 3508\n\nTCP  192.168.50.220:3389  192.168.48.3:33770  ESTABLISHED  1148\n# Active RDP session from 192.168.48.3\n# Another user connected - potential credential capture\n\nTCP  192.168.50.220:4444  192.168.48.3:58386  ESTABLISHED  2064\n# Your bind shell connection\n\n**QUICK FILTERS:**\n\nListening ports only:\nnetstat -ano | findstr LISTENING\n\nEstablished connections:\nnetstat -ano | findstr ESTABLISHED\n\nSpecific port:\nnetstat -ano | findstr :3389\nnetstat -ano | findstr :80\n\nPowerShell:\nGet-NetTCPConnection -State Listen\nGet-NetTCPConnection | Where-Object { $_.State -eq 'Established' }\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "ps-get-installed-apps",
      "name": "Get Installed Applications - Registry Query",
      "category": "post-exploit",
      "subcategory": "application-enumeration",
      "command": "Get-ItemProperty \"HKLM:\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*\" | select displayname; Get-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*\" | select displayname",
      "description": "Query Windows registry to list all installed 32-bit and 64-bit applications. Essential for identifying exploitable software, password managers, and sensitive applications.",
      "variables": [],
      "flag_explanations": {
        "HKLM:\\SOFTWARE\\Wow6432Node\\...\\Uninstall\\*": "Registry path for 32-bit applications on 64-bit Windows. Wow6432Node is the Windows-on-Windows 64-bit compatibility layer where 32-bit app info is stored.",
        "HKLM:\\SOFTWARE\\Microsoft\\...\\Uninstall\\*": "Registry path for 64-bit (native) applications. Contains application metadata including DisplayName, DisplayVersion, Publisher.",
        "select displayname": "Filter output to show only application names. Makes output readable. Can also use select displayname, displayversion for versions."
      },
      "success_indicators": [
        "List of application names displayed",
        "Shows common applications (Visual C++, etc.)",
        "Shows third-party applications"
      ],
      "failure_indicators": [
        "Access denied (unusual for HKLM read)",
        "Path not found (unusual)",
        "Constrained Language Mode blocking"
      ],
      "troubleshooting": {
        "Output incomplete or missing apps": "Some apps install differently. Solution: Also check C:\\Program Files\\ and C:\\Program Files (x86)\\ directories manually.",
        "PowerShell blocked": "Use cmd alternative. Solution: reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" /s | findstr DisplayName",
        "Need version numbers": "Add displayversion to select. Solution: Get-ItemProperty ... | select displayname, displayversion"
      },
      "prerequisites": [],
      "next_steps": [
        "ps-get-process"
      ],
      "alternatives": [
        "wmic product get name"
      ],
      "tags": [
        "WINDOWS",
        "POWERSHELL",
        "ENUMERATION",
        "APPLICATION_ENUMERATION",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "Identify installed software for exploit research and credential opportunities.\n\n**HIGH-VALUE APPLICATIONS:**\n\nPassword Managers:\n- KeePass Password Safe - Database file contains all passwords\n- LastPass - May have cached credentials\n- 1Password - Check for local vaults\n\nFTP/SSH Clients (stored credentials):\n- FileZilla - XML config stores base64 encoded passwords\n- WinSCP - Registry stores encrypted passwords\n- PuTTY - Saved sessions may have credentials\n\nDatabases:\n- MySQL/XAMPP - Check for config files with passwords\n- MSSQL - Check for weak SA password\n- PostgreSQL - Config file credentials\n\nDevelopment Tools:\n- Visual Studio - May have Azure/cloud credentials\n- Git - .git-credentials file\n- Docker - Access to containers\n\nRemote Access:\n- TeamViewer - ID for connection\n- AnyDesk - May have saved credentials\n- VNC - Password files\n\n**AFTER FINDING APPLICATIONS:**\n1. Note versions for exploit search\n2. Check install directories for config files\n3. Search for known credential locations\n4. Look for running processes\n\n**MANUAL ALTERNATIVES:**\n\nPowerShell (both architectures):\nGet-ItemProperty \"HKLM:\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*\" | select displayname\nGet-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*\" | select displayname\n\nWith versions:\nGet-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*\" | select displayname, displayversion\n\nCMD (slow but works):\nwmic product get name,version\n\nManual directory check:\ndir \"C:\\Program Files\\\"\ndir \"C:\\Program Files (x86)\\\"\n\nDownloads folder (recent installations):\ndir C:\\Users\\%USERNAME%\\Downloads\\\n\nTIME ESTIMATE: 2-5 seconds"
    },
    {
      "id": "ps-get-process",
      "name": "Get-Process - Running Processes",
      "category": "post-exploit",
      "subcategory": "process-enumeration",
      "command": "Get-Process",
      "description": "List all running processes with resource usage information. Essential for identifying running services, security software, and potential attack targets.",
      "variables": [],
      "flag_explanations": {
        "Get-Process": "PowerShell cmdlet that lists all running processes. Shows: Process name, CPU usage, Memory usage (private working set), and Process ID. More detailed than tasklist with better filtering capabilities. Use to correlate with netstat output (PID) and identify interesting processes."
      },
      "success_indicators": [
        "Table with Handles, NPM, PM, WS, CPU, Id, ProcessName columns",
        "Shows system processes (csrss, lsass, etc.)",
        "Shows user processes and services"
      ],
      "failure_indicators": [
        "Constrained Language Mode blocking",
        "Access denied for process details"
      ],
      "troubleshooting": {
        "Need to find specific process": "Use filtering. Solution: Get-Process -Name httpd or Get-Process | Where-Object { $_.ProcessName -like '*sql*' }",
        "Need full path of executable": "Use additional property. Solution: Get-Process | Select-Object ProcessName, Path",
        "PowerShell blocked": "Use cmd alternative. Solution: tasklist /v"
      },
      "prerequisites": [],
      "next_steps": [
        "win-netstat-ano"
      ],
      "alternatives": [
        "tasklist"
      ],
      "tags": [
        "WINDOWS",
        "POWERSHELL",
        "ENUMERATION",
        "PROCESS_ENUMERATION",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "Identify interesting processes for exploitation and credential theft.\n\n**HIGH-VALUE PROCESSES:**\n\nWeb Servers:\n- httpd, apache - Apache web server\n- w3wp - IIS worker process\n- nginx - Nginx web server\n\nDatabases:\n- mysqld - MySQL database\n- sqlservr - Microsoft SQL Server\n- postgres - PostgreSQL\n\nPassword Managers:\n- KeePass, KeePassXC - May have unlocked database\n- 1password - May have unlocked vault\n\nCredential Targets:\n- lsass - LSASS (dump for credentials)\n- powershell - May have credentials in memory\n\nSecurity Software (obstacles):\n- MsMpEng - Windows Defender\n- ccSvcHst - Symantec\n- mbam* - Malwarebytes\n\n**CORRELATING WITH NETSTAT:**\n1. netstat -ano shows PID for listening port\n2. Get-Process -Id <PID> identifies the process\n3. Research the process for exploitation\n\n**EXAMPLE:**\nnetstat: TCP 0.0.0.0:80 LISTENING 3340\nGet-Process -Id 3340\n# Result: httpd (Apache)\n\n**MANUAL ALTERNATIVES:**\n\nBasic list:\nGet-Process\n\nWith paths:\nGet-Process | Select-Object ProcessName, Path, Id\n\nFind by name:\nGet-Process -Name *mysql*\nGet-Process | Where-Object { $_.ProcessName -like '*http*' }\n\nFind by PID:\nGet-Process -Id 3340\n\nCMD alternative:\ntasklist\ntasklist /v (verbose)\ntasklist /fi \"imagename eq httpd.exe\"\n\nFind process owner:\nGet-Process -IncludeUserName\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "ps-search-kdbx",
      "name": "Search for KeePass Databases",
      "category": "post-exploit",
      "subcategory": "sensitive-information",
      "command": "Get-ChildItem -Path C:\\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue",
      "description": "Recursively search entire C: drive for KeePass password database files (.kdbx). These files contain encrypted passwords that can be cracked or accessed if master password is found.",
      "variables": [],
      "flag_explanations": {
        "-Path C:\\": "Starting directory for recursive search. C:\\ searches entire drive. Can narrow to C:\\Users\\ for faster search.",
        "-Include *.kdbx": "Filter for KeePass database file extension. KeePass 2.x uses .kdbx format. KeePass 1.x used .kdb (less common).",
        "-File": "Only return files, not directories. Prevents false matches on directory names.",
        "-Recurse": "Search all subdirectories recursively. Required to find files anywhere on the system.",
        "-ErrorAction SilentlyContinue": "Suppress access denied errors for directories user cannot read. Keeps output clean."
      },
      "success_indicators": [
        "File path(s) displayed",
        "Mode, LastWriteTime, Length, Name columns shown",
        "Full path to .kdbx file visible"
      ],
      "failure_indicators": [
        "No output (no .kdbx files found)",
        "Access denied messages (without SilentlyContinue)",
        "Constrained Language Mode blocking"
      ],
      "troubleshooting": {
        "Search takes too long": "Full drive search is slow. Solution: Search user directories only: Get-ChildItem -Path C:\\Users\\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue",
        "No results": "No KeePass databases or file extension different. Solution: Try broader search: Get-ChildItem -Path C:\\Users\\ -Include *.kdb,*.kdbx -Recurse -ErrorAction SilentlyContinue",
        "Found database but can't crack": "Need master password. Solution: Search for .key files (key files), check notes/documents for master password, try user's other passwords."
      },
      "prerequisites": [
        "ps-get-installed-apps"
      ],
      "next_steps": [],
      "alternatives": [
        "dir /s /b C:\\*.kdbx"
      ],
      "tags": [
        "WINDOWS",
        "POWERSHELL",
        "CREDENTIAL_HUNTING",
        "PASSWORD_MANAGER",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "KeePass is a popular password manager. Finding .kdbx file is gold mine if you can crack/access it.\n\n**EXPLOITATION PATH:**\n1. Find .kdbx file\n2. Transfer to Kali\n3. Extract hash: keepass2john database.kdbx > hash.txt\n4. Crack with hashcat: hashcat -m 13400 hash.txt wordlist.txt\n5. Open database with master password\n\n**RELATED FILE SEARCHES:**\n\nKeePass databases:\nGet-ChildItem -Path C:\\ -Include *.kdbx,*.kdb -Recurse -ErrorAction SilentlyContinue\n\nKey files (used with master password):\nGet-ChildItem -Path C:\\ -Include *.key,*.keyx -Recurse -ErrorAction SilentlyContinue\n\nKeePass config (may reveal recent databases):\nGet-ChildItem -Path C:\\ -Include KeePass.config.xml -Recurse -ErrorAction SilentlyContinue\n\n**CMD ALTERNATIVE:**\ndir /s /b C:\\*.kdbx\n\n**COMMON LOCATIONS:**\n- C:\\Users\\<user>\\Documents\\Passwords.kdbx\n- C:\\Users\\<user>\\Desktop\\*.kdbx\n- C:\\Users\\<user>\\Dropbox\\*.kdbx\n- C:\\Users\\<user>\\OneDrive\\*.kdbx\n\nTIME ESTIMATE: 1-5 minutes (full drive), 10-30 seconds (user folders)"
    },
    {
      "id": "ps-search-config-files",
      "name": "Search for Configuration Files with Credentials",
      "category": "post-exploit",
      "subcategory": "sensitive-information",
      "command": "Get-ChildItem -Path C:\\xampp -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue",
      "description": "Search application directories for configuration files that may contain plaintext credentials. XAMPP, web apps, and databases often store passwords in config files.",
      "variables": [],
      "flag_explanations": {
        "-Path C:\\xampp": "Target directory for search. Change based on installed applications (e.g., C:\\inetpub, C:\\wamp, C:\\Program Files\\MySQL).",
        "-Include *.txt,*.ini": "File extensions commonly containing credentials. Add *.xml,*.config,*.cfg for broader search.",
        "-File": "Only return files, not directories.",
        "-Recurse": "Search all subdirectories.",
        "-ErrorAction SilentlyContinue": "Suppress permission errors."
      },
      "success_indicators": [
        "List of configuration files displayed",
        "Files like my.ini, passwords.txt, config.php visible",
        "Full paths shown for further investigation"
      ],
      "failure_indicators": [
        "Path not found (application not installed)",
        "No results (no matching files)",
        "Access denied (without SilentlyContinue)"
      ],
      "troubleshooting": {
        "XAMPP not installed": "Search other common locations. Solution: Try C:\\inetpub\\wwwroot for IIS, C:\\wamp for WAMP, or application-specific directories.",
        "Found files but need to read": "Use type or Get-Content. Solution: type C:\\xampp\\mysql\\bin\\my.ini or Get-Content C:\\xampp\\passwords.txt",
        "Too many results": "Narrow search with more specific patterns. Solution: Get-ChildItem -Path C:\\xampp -Include *password*,*config* -Recurse"
      },
      "prerequisites": [
        "ps-get-installed-apps"
      ],
      "next_steps": [],
      "alternatives": [
        "dir /s /b C:\\xampp\\*.txt C:\\xampp\\*.ini"
      ],
      "tags": [
        "WINDOWS",
        "POWERSHELL",
        "CREDENTIAL_HUNTING",
        "CONFIG_FILES",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "Configuration files frequently contain plaintext passwords. Search application directories identified in earlier enumeration.\n\n**HIGH-VALUE TARGETS:**\n\nXAMPP:\nC:\\xampp\\passwords.txt - Default passwords\nC:\\xampp\\mysql\\bin\\my.ini - MySQL config\nC:\\xampp\\phpMyAdmin\\config.inc.php - phpMyAdmin\n\nWAMP:\nC:\\wamp\\mysql\\bin\\my.ini\nC:\\wamp\\apps\\phpmyadmin*\\config.inc.php\n\nIIS:\nC:\\inetpub\\wwwroot\\web.config - Database connection strings\nC:\\Windows\\System32\\inetsrv\\config\\applicationHost.config\n\nFTP Servers:\nC:\\Program Files\\FileZilla Server\\FileZilla Server.xml\nC:\\Program Files (x86)\\FileZilla Server\\FileZilla Server.xml\n\nVNC:\nC:\\Program Files\\RealVNC\\VNC Server\\config.txt\nC:\\Program Files\\UltraVNC\\ultravnc.ini\n\n**COMPREHENSIVE SEARCH:**\n\nAll config files:\nGet-ChildItem -Path C:\\ -Include *.ini,*.config,*.xml,*.cfg -Recurse -ErrorAction SilentlyContinue | Where-Object { $_.FullName -notlike '*Windows*' }\n\nSearch file contents for password:\nGet-ChildItem -Path C:\\Users\\ -Include *.txt,*.xml,*.config -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern 'password' -SimpleMatch\n\n**CMD ALTERNATIVE:**\ndir /s /b C:\\xampp\\*.txt C:\\xampp\\*.ini\nfindstr /si password C:\\xampp\\*.ini C:\\xampp\\*.xml\n\nTIME ESTIMATE: 10-60 seconds per directory"
    },
    {
      "id": "ps-search-user-docs",
      "name": "Search User Documents for Sensitive Files",
      "category": "post-exploit",
      "subcategory": "sensitive-information",
      "command": "Get-ChildItem -Path C:\\Users\\<USERNAME>\\ -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue",
      "description": "Search user's home directory for documents that may contain passwords or sensitive information. Users often store passwords in text files, notes, or spreadsheets.",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Target user's username to search their home directory",
          "example": "dave",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Path C:\\Users\\<USERNAME>\\": "User's home directory. Replace with actual username. For current user: $env:USERPROFILE or C:\\Users\\$env:USERNAME\\",
        "-Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx": "Common document types. Text files often contain notes/passwords. Excel may have password lists. Word may have credentials in documentation.",
        "-File": "Only return files, not directories.",
        "-Recurse": "Search Desktop, Documents, Downloads, and all subdirectories.",
        "-ErrorAction SilentlyContinue": "Suppress permission errors."
      },
      "success_indicators": [
        "List of document files displayed",
        "Files with interesting names visible (passwords.txt, notes.txt, credentials.xlsx)",
        "Desktop and Documents folders searched"
      ],
      "failure_indicators": [
        "User directory not found",
        "Access denied to user's directory",
        "No documents found (unusual)"
      ],
      "troubleshooting": {
        "Access denied to other user's folder": "Insufficient permissions. Solution: Search current user's folder first: Get-ChildItem -Path $env:USERPROFILE -Include *.txt -Recurse -ErrorAction SilentlyContinue",
        "Too many results": "Filter by name pattern. Solution: Get-ChildItem -Path C:\\Users\\dave\\ -Include *password*,*cred*,*secret*,*note* -Recurse",
        "Need to search all users": "Loop through users. Solution: Get-ChildItem -Path C:\\Users\\ -Include *.txt -Recurse -ErrorAction SilentlyContinue"
      },
      "prerequisites": [
        "ps-get-localuser"
      ],
      "next_steps": [],
      "alternatives": [
        "dir /s /b C:\\Users\\dave\\*.txt"
      ],
      "tags": [
        "WINDOWS",
        "POWERSHELL",
        "CREDENTIAL_HUNTING",
        "DOCUMENT_SEARCH",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "Users frequently store passwords in plain text files. The laziness factor is real - never underestimate it!\n\n**HIGH-VALUE LOCATIONS:**\n\nDesktop (quick access, often contains notes):\nC:\\Users\\<user>\\Desktop\\*.txt\n\nDocuments (formal storage):\nC:\\Users\\<user>\\Documents\\*.xlsx\n\nDownloads (recent activity):\nC:\\Users\\<user>\\Downloads\\*\n\n**COMMON PASSWORD FILE NAMES:**\n- passwords.txt\n- pass.txt\n- creds.txt\n- logins.txt\n- notes.txt\n- asdf.txt (random name, often contains sensitive info)\n- todo.txt\n- meeting_notes.txt\n\n**SEARCH PATTERNS:**\n\nCurrent user:\nGet-ChildItem -Path $env:USERPROFILE -Include *.txt,*.pdf -Recurse -ErrorAction SilentlyContinue\n\nAll users:\nGet-ChildItem -Path C:\\Users\\ -Include *.txt -Recurse -ErrorAction SilentlyContinue\n\nPassword-related names:\nGet-ChildItem -Path C:\\Users\\ -Include *pass*,*cred*,*secret*,*login* -Recurse -ErrorAction SilentlyContinue\n\nSearch inside files:\nGet-ChildItem -Path C:\\Users\\dave\\ -Include *.txt -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern 'password' -SimpleMatch\n\n**CMD ALTERNATIVE:**\ndir /s /b C:\\Users\\dave\\Desktop\\*.txt\nfindstr /si password C:\\Users\\dave\\Desktop\\*.txt\n\n**READING FOUND FILES:**\ntype C:\\Users\\dave\\Desktop\\asdf.txt\nGet-Content C:\\Users\\dave\\Desktop\\notes.txt\n\nTIME ESTIMATE: 10-60 seconds per user"
    },
    {
      "id": "ps-get-history",
      "name": "Get-History - PowerShell Session History",
      "category": "post-exploit",
      "subcategory": "powershell-artifacts",
      "command": "Get-History",
      "description": "Display PowerShell command history for current session. Note: This only shows current session - use PSReadline history for persistent history across sessions.",
      "variables": [],
      "flag_explanations": {
        "Get-History": "PowerShell cmdlet that displays command history for the CURRENT SESSION ONLY. This history is stored in memory and lost when session closes. For persistent history (commands from previous sessions), check PSReadline history file. Users often clear this with Clear-History, thinking it removes all traces - it doesn't affect PSReadline."
      },
      "success_indicators": [
        "Table with Id and CommandLine columns",
        "Shows commands executed in current session",
        "May be empty if session just started"
      ],
      "failure_indicators": [
        "Empty output (new session or history cleared)",
        "Constrained Language Mode blocking"
      ],
      "troubleshooting": {
        "Empty output": "New session or Clear-History was run. Solution: Check PSReadline history which persists across sessions: (Get-PSReadlineOption).HistorySavePath",
        "Only shows recent commands": "Get-History has limited buffer. Solution: Get-History -Count 1000 for more commands. Or check PSReadline file for complete history.",
        "User ran Clear-History": "Clear-History only clears Get-History, NOT PSReadline. Solution: Always check PSReadline: type (Get-PSReadlineOption).HistorySavePath"
      },
      "prerequisites": [],
      "next_steps": [
        "ps-get-psreadline-path"
      ],
      "alternatives": [],
      "tags": [
        "WINDOWS",
        "POWERSHELL",
        "HISTORY",
        "CREDENTIAL_HUNTING",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "CRITICAL OSCP KNOWLEDGE: Get-History and PSReadline are DIFFERENT!\n\n**Get-History:**\n- Current session only\n- Stored in memory\n- Lost when PowerShell closes\n- Cleared by Clear-History\n\n**PSReadline (ConsoleHost_history.txt):**\n- Persists across ALL sessions\n- Stored in file on disk\n- NOT cleared by Clear-History\n- Contains commands from weeks/months ago\n\n**ATTACK IMPLICATION:**\nAdmins often run Clear-History thinking they've removed traces.\nThey haven't - PSReadline still has everything!\n\n**WHAT TO LOOK FOR:**\n- Passwords typed in commands\n- net use with credentials\n- psexec with credentials\n- Invoke-Command with credentials\n- Set-Secret (password manager)\n- ConvertTo-SecureString with passwords\n\n**EXAMPLE GOLD:**\n$password = ConvertTo-SecureString \"MyP@ssw0rd\" -AsPlainText -Force\nnet use \\\\server\\share /user:admin password123\nEnter-PSSession -ComputerName DC01 -Credential $cred\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "ps-get-psreadline-path",
      "name": "Get PSReadline History File Path",
      "category": "post-exploit",
      "subcategory": "powershell-artifacts",
      "command": "(Get-PSReadlineOption).HistorySavePath",
      "description": "Display the path to PSReadline's persistent history file. This file contains ALL PowerShell commands across all sessions and is NOT cleared by Clear-History.",
      "variables": [],
      "flag_explanations": {
        "(Get-PSReadlineOption)": "Returns PSReadline module options including history settings. Wrapping in parentheses allows property access.",
        ".HistorySavePath": "Property containing the full path to the history file. Default: C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt"
      },
      "success_indicators": [
        "Full file path displayed",
        "Path ends with ConsoleHost_history.txt",
        "Path is in user's AppData\\Roaming"
      ],
      "failure_indicators": [
        "'Get-PSReadlineOption' is not recognized (PSReadline not installed - very rare on modern Windows)",
        "Empty output (PSReadline history disabled)"
      ],
      "troubleshooting": {
        "Command not recognized": "PSReadline not installed (unusual). Solution: Manual path: C:\\Users\\%USERNAME%\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt",
        "History disabled": "Admin set HistorySaveStyle to SaveNothing. Solution: Path still exists but file may be empty. Check anyway.",
        "Need to check other users": "Path is user-specific. Solution: Replace username in path: C:\\Users\\steve\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt"
      },
      "prerequisites": [
        "ps-get-history"
      ],
      "next_steps": [
        "ps-read-psreadline"
      ],
      "alternatives": [],
      "tags": [
        "WINDOWS",
        "POWERSHELL",
        "HISTORY",
        "CREDENTIAL_HUNTING",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "PSReadline history is GOLD MINE for credentials. Always check it!\n\n**DEFAULT PATHS:**\n\nPowerShell 5.x:\nC:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\n\nPowerShell 7.x:\nC:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\n\n**CHECK MULTIPLE USERS:**\nFor each user found in enumeration, check their history file.\n\n**QUICK ACCESS:**\n\nCurrent user:\n(Get-PSReadlineOption).HistorySavePath\n\nDirect path (current user):\n$env:APPDATA\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\n\nOther user (manual):\nC:\\Users\\dave\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\n\n**CMD ALTERNATIVE:**\necho %APPDATA%\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\n\nTIME ESTIMATE: <1 second"
    },
    {
      "id": "ps-read-psreadline",
      "name": "Read PSReadline History File",
      "category": "post-exploit",
      "subcategory": "powershell-artifacts",
      "command": "type C:\\Users\\<USERNAME>\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt",
      "description": "Display contents of PSReadline history file containing ALL PowerShell commands from all previous sessions. Often contains plaintext credentials and sensitive commands.",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Target user's username",
          "example": "dave",
          "required": true
        }
      ],
      "flag_explanations": {
        "type": "Windows command to display file contents. Alias for Get-Content in PowerShell. Can also use cat (PowerShell alias) or Get-Content.",
        "ConsoleHost_history.txt": "PSReadline's persistent history file. Contains ALL commands from ALL PowerShell sessions. Survives Clear-History, reboots, and session closures."
      },
      "success_indicators": [
        "Command history displayed",
        "Shows commands from previous sessions",
        "May contain credentials in plaintext"
      ],
      "failure_indicators": [
        "File not found (user never used PowerShell or file deleted)",
        "Access denied (reading other user's file without permission)",
        "Empty file (history disabled)"
      ],
      "troubleshooting": {
        "Access denied to other user": "Need elevated privileges. Solution: Read current user's history first. After privilege escalation, read other users' histories.",
        "File not found": "User may not have used PowerShell or path is wrong. Solution: Verify path with (Get-PSReadlineOption).HistorySavePath or manually check if folder exists.",
        "History disabled or cleared": "Admin may have configured PSReadline to not save history. Solution: Check if Start-Transcript was used for other logs."
      },
      "prerequisites": [
        "ps-get-psreadline-path"
      ],
      "next_steps": [
        "ps-search-transcripts"
      ],
      "alternatives": [
        "Get-Content (Get-PSReadlineOption).HistorySavePath"
      ],
      "tags": [
        "WINDOWS",
        "POWERSHELL",
        "HISTORY",
        "CREDENTIAL_HUNTING",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "This is where you find credentials that admins thought they deleted!\n\n**WHAT TO LOOK FOR:**\n\nCredential creation:\n$password = ConvertTo-SecureString \"qwertqwertqwert123!!\" -AsPlainText -Force\n$cred = New-Object System.Management.Automation.PSCredential(\"daveadmin\", $password)\n# JACKPOT! Username and password in plaintext\n\nRemote connections:\nEnter-PSSession -ComputerName DC01 -Credential $cred\nInvoke-Command -ComputerName SERVER01 -Credential $cred -ScriptBlock {...}\n# Reveals target systems and indicates lateral movement\n\nSecret management:\nSet-Secret -Name \"Server02 Admin PW\" -Secret \"paperEarMonitor33@\" -Vault pwmanager\n# Password manager entries\n\nNetwork connections:\nnet use \\\\192.168.1.100\\share /user:domain\\admin P@ssw0rd\n# SMB authentication with plaintext creds\n\nTranscription evidence:\nStart-Transcript -Path \"C:\\Users\\Public\\Transcripts\\transcript01.txt\"\n# Reveals transcript file locations!\n\n**EXAMPLE ATTACK FLOW:**\n1. Read PSReadline history\n2. Find PSCredential creation with password\n3. Use same credentials to authenticate\n4. Privilege escalation achieved!\n\n**READ MULTIPLE USERS:**\n\nCurrent user:\ntype $env:APPDATA\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\n\nSpecific user:\ntype C:\\Users\\dave\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\n\nAll users (requires elevated privs):\nGet-ChildItem C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt | ForEach-Object { Write-Host \"`n=== $($_.FullName) ===\"; Get-Content $_ }\n\nTIME ESTIMATE: <1 second per file"
    },
    {
      "id": "ps-search-transcripts",
      "name": "Search for PowerShell Transcript Files",
      "category": "post-exploit",
      "subcategory": "powershell-artifacts",
      "command": "Get-ChildItem -Path C:\\Users\\ -Include *transcript*,*PowerShell_transcript* -File -Recurse -ErrorAction SilentlyContinue",
      "description": "Search for PowerShell transcription log files. When enabled, transcripts record all commands and output, often containing credentials and sensitive information.",
      "variables": [],
      "flag_explanations": {
        "-Path C:\\Users\\": "Starting directory. Transcripts are often saved in user directories or C:\\Users\\Public\\.",
        "-Include *transcript*,*PowerShell_transcript*": "Search patterns for transcript files. PowerShell default naming includes 'PowerShell_transcript' prefix.",
        "-File": "Only return files, not directories.",
        "-Recurse": "Search all subdirectories.",
        "-ErrorAction SilentlyContinue": "Suppress access denied errors."
      },
      "success_indicators": [
        "Transcript file paths displayed",
        "Files with 'transcript' in name visible",
        "Common locations: C:\\Users\\Public\\Transcripts\\, user directories"
      ],
      "failure_indicators": [
        "No output (transcription not enabled)",
        "Access denied (without SilentlyContinue)"
      ],
      "troubleshooting": {
        "No transcripts found": "Transcription may not be enabled. Solution: Check if PSReadline history was found instead - that's more common. Also try: Get-ChildItem -Path C:\\ -Include *transcript*.txt -Recurse -ErrorAction SilentlyContinue",
        "Found transcript but can't read": "Permission denied. Solution: Note path and try after privilege escalation.",
        "Looking for central storage": "Enterprises may store transcripts centrally. Solution: Check C:\\Transcripts, \\\\server\\logs, etc."
      },
      "prerequisites": [
        "ps-read-psreadline"
      ],
      "next_steps": [],
      "alternatives": [
        "dir /s /b C:\\*transcript*.txt"
      ],
      "tags": [
        "WINDOWS",
        "POWERSHELL",
        "TRANSCRIPTION",
        "CREDENTIAL_HUNTING",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "PowerShell Transcription is 'over-the-shoulder logging' - records everything as if watching the user.\n\n**TRANSCRIPTION vs HISTORY:**\n\nPSReadline History:\n- Just commands typed\n- No output recorded\n- File-based, single location\n\nTranscription:\n- Commands AND their output\n- Shows what user saw\n- Can include credentials in output\n- Multiple files per session\n\n**COMMON TRANSCRIPT LOCATIONS:**\n\nUser-initiated:\nC:\\Users\\<user>\\Desktop\\transcript*.txt\nC:\\Users\\<user>\\Documents\\transcript*.txt\n\nCentralized:\nC:\\Users\\Public\\Transcripts\\\nC:\\Transcripts\\\n\\\\server\\logs\\transcripts\\\n\nGPO-enforced (enterprise):\nC:\\ProgramData\\PowerShellTranscripts\\\n\n**TRANSCRIPT FILE CONTENTS:**\n\n**********************\nWindows PowerShell transcript start\nStart time: 20220623081143\nUsername: CLIENTWK220\\dave\nMachine: CLIENTWK220\n**********************\nPS C:\\Users\\dave> $password = ConvertTo-SecureString \"qwertqwertqwert123!!\" -AsPlainText -Force\nPS C:\\Users\\dave> $cred = New-Object System.Management.Automation.PSCredential(\"daveadmin\", $password)\nPS C:\\Users\\dave> Enter-PSSession -ComputerName CLIENTWK220 -Credential $cred\n**********************\nWindows PowerShell transcript end\n**********************\n\n**SEARCH COMMANDS:**\n\nUser directories:\nGet-ChildItem -Path C:\\Users\\ -Include *transcript* -Recurse -ErrorAction SilentlyContinue\n\nPublic folder:\nGet-ChildItem -Path C:\\Users\\Public\\ -Include *transcript* -Recurse -ErrorAction SilentlyContinue\n\nEntire drive:\nGet-ChildItem -Path C:\\ -Include *transcript*.txt -Recurse -ErrorAction SilentlyContinue\n\n**CMD ALTERNATIVE:**\ndir /s /b C:\\*transcript*.txt\n\nTIME ESTIMATE: 10-60 seconds"
    },
    {
      "id": "win-runas-cmd",
      "name": "Runas - Run Command as Different User",
      "category": "post-exploit",
      "subcategory": "credential-leveraging",
      "command": "runas /user:<USERNAME> cmd",
      "description": "Execute cmd.exe as a different user. Use after finding credentials in files or history to test if they work and gain access as that user.",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Username to run as. For local user: username or HOSTNAME\\username. For domain user: DOMAIN\\username",
          "example": "backupadmin",
          "required": true
        }
      ],
      "flag_explanations": {
        "/user:<USERNAME>": "Specifies the user account to run the program as. Format can be: username (local), HOSTNAME\\username (explicit local), or DOMAIN\\username (domain). You will be prompted for the password interactively.",
        "cmd": "The program to run as the specified user. Can be any executable. Common choices: cmd (command prompt), powershell (PowerShell), or direct program paths."
      },
      "success_indicators": [
        "Password prompt appears",
        "New window opens running as target user",
        "Window title shows 'running as <username>'"
      ],
      "failure_indicators": [
        "The user name or password is incorrect",
        "This user can't sign in because this account is currently disabled",
        "Access is denied",
        "RUNAS ERROR: Unable to run"
      ],
      "troubleshooting": {
        "Password prompt not appearing": "Running in non-interactive shell (bind shell, reverse shell, WinRM). Solution: runas requires interactive GUI session. Use evil-winrm or PowerShell remoting instead.",
        "User name or password incorrect": "Wrong credentials. Solution: Verify password, try variations (case-sensitive). Try both username and HOSTNAME\\username formats.",
        "Account disabled": "Target account is disabled. Solution: Cannot use runas for disabled accounts. Try other users or enable account if you have permission.",
        "Access denied": "May need SeNetworkLogonRight. Solution: Check if user can log on interactively. Try other authentication methods."
      },
      "prerequisites": [],
      "next_steps": [],
      "alternatives": [
        "evil-winrm-shell",
        "ps-winrm-credential-setup"
      ],
      "tags": [
        "WINDOWS",
        "CMD",
        "CREDENTIAL_LEVERAGING",
        "PRIVILEGE_ESCALATION",
        "POST_EXPLOITATION",
        "OSCP:HIGH"
      ],
      "oscp_relevance": "high",
      "notes": "CRITICAL: runas requires INTERACTIVE GUI session. Won't work in bind/reverse shells!\n\n**WHEN TO USE runas:**\n- You have RDP access\n- You found credentials in files/history\n- Target user is local admin or has elevated privileges\n\n**WHEN TO USE ALTERNATIVES:**\n- No GUI: Use evil-winrm, Invoke-Command, or PsExec\n- Domain user: Use Invoke-Command with PSCredential\n- Need SYSTEM: Use PsExec -s\n\n**COMMON PATTERNS:**\n\nLocal user:\nrunas /user:backupadmin cmd\nrunas /user:daveadmin powershell\n\nExplicit local (same machine):\nrunas /user:CLIENTWK220\\backupadmin cmd\n\nDomain user:\nrunas /user:CORP\\administrator cmd\n\nRun specific program:\nrunas /user:admin \"C:\\Program Files\\app.exe\"\n\n**ALTERNATIVES FOR NON-INTERACTIVE SHELLS:**\n\nevil-winrm (from Kali):\nevil-winrm -i 192.168.50.220 -u daveadmin -p \"qwertqwertqwert123!!\"\n\nPowerShell (WinRM):\n$password = ConvertTo-SecureString \"password\" -AsPlainText -Force\n$cred = New-Object System.Management.Automation.PSCredential(\"user\", $password)\nInvoke-Command -ComputerName localhost -Credential $cred -ScriptBlock {whoami}\n\nPsExec (local):\npsexec.exe -u administrator -p password cmd.exe\n\n**AFTER SUCCESSFUL runas:**\n1. Verify with whoami\n2. Check group memberships with whoami /groups\n3. If admin, proceed with post-exploitation\n4. If not admin, continue enumeration from new context\n\nTIME ESTIMATE: <1 second (plus password entry)"
    }
  ]
}
