{
  "category": "post-exploit",
  "subcategory": "credential-hunting",
  "description": "Windows sensitive file discovery and credential hunting commands for security work privilege escalation. Based on pentest Module 17.1.3 'Hidden in Plain View' methodology.",
  "commands": [
    {
      "id": "ps-type-file",
      "name": "Read File Contents",
      "category": "post-exploit",
      "subcategory": "credential-hunting",
      "command": "type <FILE_PATH>",
      "filled_example": "type C:\\xampp\\mysql\\bin\\my.ini",
      "description": "Read contents of discovered sensitive files. Critical step after Get-ChildItem searches - found files must be read to extract credentials.",
      "tags": [
        "WINDOWS",
        "POST_EXPLOITATION",
        "CREDENTIAL_HUNTING",
        "FILE_READ"
      ],
      "variables": [
        {
          "name": "<FILE_PATH>",
          "description": "Full path to file discovered during sensitive file search",
          "example": "C:\\xampp\\mysql\\bin\\my.ini",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "File contents displayed",
        "password",
        "connectionString",
        "DefaultPassword",
        "credentials"
      ],
      "failure_indicators": [
        "Access to the path",
        "is denied",
        "Cannot find path",
        "does not exist"
      ],
      "troubleshooting": {
        "Access is denied": "Current user lacks read permissions. NOTE THIS FILE for re-check after privilege escalation - this is a high-value target. Try 'icacls <FILE_PATH>' to see who can read it.",
        "Cannot find path": "File was moved or deleted since search. Re-run Get-ChildItem to find current location.",
        "File is empty": "May be a placeholder or cleared file. Check file size with 'Get-Item <FILE_PATH>' before reading large files."
      },
      "notes": "Critical: This command bridges the gap between finding files and extracting credentials. The 'type' command is a cmd.exe built-in (alias for Get-Content in PowerShell). Alternative: 'Get-Content <FILE_PATH>' or 'cat <FILE_PATH>' in PowerShell. When reading fails due to permissions, note the file path for re-enumeration after gaining higher privileges - this is the 'cyclical enumeration' concept from pentest Module 17.1.3. Permission denied errors often indicate high-value files containing credentials.",
      "alternatives": [
        "ps-get-content"
      ],
      "next_steps": [
        "win-net-user-detail",
        "win-runas-cmd"
      ]
    },
    {
      "id": "ps-search-app-config",
      "name": "Search Application Config Files",
      "category": "post-exploit",
      "subcategory": "credential-hunting",
      "command": "Get-ChildItem -Path <APP_PATH> -Include *.txt,*.ini,*.config,*.xml -File -Recurse -ErrorAction SilentlyContinue",
      "filled_example": "Get-ChildItem -Path C:\\xampp -Include *.txt,*.ini,*.config,*.xml -File -Recurse -ErrorAction SilentlyContinue",
      "description": "Search any application directory for configuration files containing credentials. Target paths identified from installed applications enumeration.",
      "tags": [
        "WINDOWS",
        "POST_EXPLOITATION",
        "CREDENTIAL_HUNTING",
        "CONFIG_FILES"
      ],
      "variables": [
        {
          "name": "<APP_PATH>",
          "description": "Installation directory of target application identified during enumeration",
          "example": "C:\\xampp",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Path <APP_PATH>": "Target application directory. Identify from Get-ItemProperty enumeration or common paths: C:\\xampp, C:\\wamp64, C:\\Program Files\\<AppName>. Applications like XAMPP store MySQL credentials in my.ini, passwords.txt in their install directory.",
        "-Include *.txt,*.ini,*.config,*.xml": "Common configuration file extensions. INI files contain settings, TXT may have default passwords, CONFIG files (ASP.NET) have connection strings, XML for various app configs. Adjust based on target application.",
        "-File": "Match only files, not directories - reduces noise in output",
        "-Recurse": "Search all subdirectories. Critical because config files often in nested paths like mysql\\bin\\my.ini",
        "-ErrorAction SilentlyContinue": "Suppress 'Access Denied' errors for clean output. Files you can't access are noted for later re-enumeration with higher privileges."
      },
      "success_indicators": [
        "Directory:",
        "Mode",
        ".ini",
        ".config",
        "my.ini",
        "passwords.txt",
        "web.config"
      ],
      "failure_indicators": [
        "Cannot find path",
        "ObjectNotFound"
      ],
      "troubleshooting": {
        "No results found": "Application may use non-standard config locations. Check documentation or search broader with -Path C:\\ but this is slower. Also check AppData folders: C:\\Users\\*\\AppData\\*",
        "Too many results": "Narrow -Include to specific filenames known to contain credentials: my.ini, passwords.txt, config.php, wp-config.php, settings.py",
        "Application not found at expected path": "Use Get-ItemProperty to enumerate installed applications and their actual install paths: Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*' | Select InstallLocation"
      },
      "notes": "Critical: After identifying installed applications (KeePass, XAMPP, MySQL, FileZilla, etc.), target their config directories for credential files. Common high-value targets: XAMPP (my.ini with MySQL root password, passwords.txt with defaults), FileZilla (recentservers.xml with saved FTP creds), WAMP (similar to XAMPP). The WHY: Application config files frequently contain database passwords which users reuse for Windows accounts. Manual alternative: dir /s /b C:\\xampp\\*.ini (cmd.exe). Always read found files with 'type' or 'Get-Content' to extract actual credentials.",
      "prerequisites": [
        "ps-get-installed-apps"
      ],
      "next_steps": [
        "ps-type-file",
        "win-net-user-detail"
      ]
    },
    {
      "id": "ps-search-deployment-files",
      "name": "Search Windows Deployment Files",
      "category": "post-exploit",
      "subcategory": "credential-hunting",
      "command": "Get-ChildItem -Path C:\\ -Include unattend.xml,sysprep.xml,sysprep.inf,Unattended.xml -File -Recurse -ErrorAction SilentlyContinue",
      "description": "Search for Windows deployment/unattended installation files that often contain cleartext administrator passwords left by sysadmins.",
      "tags": [
        "WINDOWS",
        "POST_EXPLOITATION",
        "CREDENTIAL_HUNTING",
        "DEPLOYMENT"
      ],
      "variables": [],
      "flag_explanations": {
        "-Path C:\\": "Search entire C: drive. Deployment files can be anywhere but commonly in C:\\Windows\\Panther\\, C:\\Windows\\System32\\Sysprep\\, or root directories.",
        "-Include unattend.xml,sysprep.xml,sysprep.inf,Unattended.xml": "Target Windows unattended installation answer files. These contain settings for automated Windows deployment including admin credentials. Multiple variants exist: unattend.xml (modern), sysprep.inf (legacy), Unattended.xml (alternate naming).",
        "-File": "Match only files, not directories",
        "-Recurse": "Search all subdirectories - these files can be in unexpected locations",
        "-ErrorAction SilentlyContinue": "Suppress permission errors for clean output"
      },
      "success_indicators": [
        "unattend.xml",
        "sysprep.xml",
        "sysprep.inf",
        "C:\\Windows\\Panther",
        "C:\\Windows\\System32\\Sysprep"
      ],
      "failure_indicators": [
        "No files found"
      ],
      "troubleshooting": {
        "No results found": "Deployment files may have been properly deleted. This is expected on well-maintained systems. Move on to other credential sources.",
        "Search is slow": "Full C: drive search takes time. Can narrow to common locations: Get-ChildItem -Path C:\\Windows\\Panther,C:\\Windows\\System32\\Sysprep -Include unattend.xml -File -ErrorAction SilentlyContinue",
        "File found but no credentials": "Not all deployment files contain passwords. Look for <AutoLogon><Password> or <Credentials><Password> XML elements."
      },
      "notes": "HIGH VALUE: Windows unattended installation files are created during automated OS deployment and SHOULD be deleted afterward. Sysadmins frequently forget this step. These files contain cleartext or Base64-encoded administrator passwords. Key XML elements to search: <AutoLogon><Password><Value>, <Credentials><Password>, <AdministratorPassword>. Base64 passwords decode easily: [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('encoded_password')). Common locations: C:\\Windows\\Panther\\unattend.xml, C:\\Windows\\System32\\Sysprep\\sysprep.xml. Quick win that requires no exploitation.",
      "next_steps": [
        "ps-type-file",
        "win-net-user-detail",
        "win-runas-cmd"
      ]
    },
    {
      "id": "ps-search-webconfig",
      "name": "Search Web Server Config Files",
      "category": "post-exploit",
      "subcategory": "credential-hunting",
      "command": "Get-ChildItem -Path <WEB_ROOT> -Include web.config,*.config,config.php,wp-config.php,settings.py,appsettings.json -File -Recurse -ErrorAction SilentlyContinue",
      "filled_example": "Get-ChildItem -Path C:\\inetpub\\wwwroot -Include web.config,*.config,config.php,wp-config.php,settings.py,appsettings.json -File -Recurse -ErrorAction SilentlyContinue",
      "description": "Search web server document root for configuration files containing database connection strings and credentials.",
      "tags": [
        "WINDOWS",
        "POST_EXPLOITATION",
        "CREDENTIAL_HUNTING",
        "WEB",
        "DATABASE"
      ],
      "variables": [
        {
          "name": "<WEB_ROOT>",
          "description": "Web server document root directory. Identify from running processes (httpd, w3wp) or common paths.",
          "example": "C:\\inetpub\\wwwroot",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Path <WEB_ROOT>": "Web server document root. Common paths: IIS=C:\\inetpub\\wwwroot, XAMPP=C:\\xampp\\htdocs, WAMP=C:\\wamp64\\www, Custom=identify from httpd.conf or running processes",
        "-Include web.config,*.config,config.php,wp-config.php,settings.py,appsettings.json": "Common web config files by technology: ASP.NET (web.config, appsettings.json), PHP (config.php, wp-config.php for WordPress), Python (settings.py for Django). Adjust based on identified web stack.",
        "-File": "Match only files, not directories",
        "-Recurse": "Search all subdirectories - configs may be in app subfolders",
        "-ErrorAction SilentlyContinue": "Suppress permission errors"
      },
      "success_indicators": [
        "web.config",
        "config.php",
        "wp-config.php",
        "appsettings.json",
        "Directory:"
      ],
      "failure_indicators": [
        "Cannot find path",
        "ObjectNotFound"
      ],
      "troubleshooting": {
        "Web root not found": "Identify web server first: Get-Process | Where-Object {$_.Name -match 'httpd|apache|w3wp|nginx'}. Check running services for web server paths.",
        "Config found but encrypted": "ASP.NET can encrypt web.config sections. Look for other config files or check if encryption key is accessible.",
        "No database credentials": "Application may use integrated authentication (no password) or credentials in environment variables. Check applicationHost.config for IIS."
      },
      "notes": "Critical: Web config files contain database connection strings with credentials. These database passwords are frequently reused for Windows accounts (credential reuse). Key search patterns after finding files: 'type web.config | Select-String -Pattern \"connectionString|password|pwd|user id\"'. ASP.NET web.config stores DB creds in <connectionStrings>. PHP configs use define('DB_PASSWORD', '...'). Django settings.py has DATABASES dict with PASSWORD key. IIS applicationHost.config may have site credentials. Manual alternative: dir /s /b C:\\inetpub\\*.config",
      "prerequisites": [
        "ps-get-process",
        "ps-get-installed-apps"
      ],
      "next_steps": [
        "ps-type-file",
        "win-net-user-detail"
      ]
    },
    {
      "id": "ps-search-password-patterns",
      "name": "Search for Password-Named Files",
      "category": "post-exploit",
      "subcategory": "credential-hunting",
      "command": "Get-ChildItem -Path <SEARCH_PATH> -Include *password*,*cred*,*secret*,*login*,*backup*.txt,*backup*.xlsx -File -Recurse -ErrorAction SilentlyContinue",
      "filled_example": "Get-ChildItem -Path C:\\Users -Include *password*,*cred*,*secret*,*login*,*backup*.txt,*backup*.xlsx -File -Recurse -ErrorAction SilentlyContinue",
      "description": "Broad search for files with credential-related naming patterns. Catches user-created password files that specific searches miss.",
      "tags": [
        "WINDOWS",
        "POST_EXPLOITATION",
        "CREDENTIAL_HUNTING",
        "PASSWORD_FILES"
      ],
      "variables": [
        {
          "name": "<SEARCH_PATH>",
          "description": "Search scope - typically C:\\ for full system or C:\\Users for user directories",
          "example": "C:\\Users",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Path <SEARCH_PATH>": "Search scope. Use C:\\ for comprehensive search (slow), C:\\Users for user files (faster), or specific user home like C:\\Users\\dave for targeted search.",
        "-Include *password*,*cred*,*secret*,*login*,*backup*.txt,*backup*.xlsx": "Pattern matching for common credential file names. Users create files like 'passwords.txt', 'my_credentials.doc', 'secret_backup.xlsx', 'login_info.txt'. Asterisks match any characters before/after.",
        "-File": "Match only files, not directories",
        "-Recurse": "Search all subdirectories including Desktop, Documents, Downloads",
        "-ErrorAction SilentlyContinue": "Suppress permission errors - expected when searching other users' directories"
      },
      "success_indicators": [
        "password",
        "cred",
        "secret",
        "login",
        "backup",
        "Directory:"
      ],
      "failure_indicators": [
        "No files found"
      ],
      "troubleshooting": {
        "Too many results": "Narrow search path to specific user directories. Filter by extension: add -Include *password*.txt,*password*.doc to exclude binaries.",
        "Search too slow": "Full C:\\ search takes time. Prioritize: C:\\Users\\*\\Desktop, C:\\Users\\*\\Documents, C:\\Users\\*\\Downloads",
        "Found file but encrypted": "Excel files may be password-protected. Note for potential offline cracking with office2john."
      },
      "notes": "Relevant: This broad search catches the 'lazy user' credential files that specific searches miss. Users commonly create Desktop files like 'asdf.txt' with meeting notes containing passwords, 'passwords.xlsx' with credential lists, or 'backup_credentials.txt'. The reference module example found meeting notes (asdf.txt) with 'Steve's password: securityIsNotAnOption++++++'. Always read found files with 'type' command. Focus on Desktop, Documents, Downloads first. Manual alternative: dir /s /b C:\\Users\\*password* (slower).",
      "prerequisites": [
        "ps-search-user-docs"
      ],
      "next_steps": [
        "ps-type-file",
        "win-net-user-detail"
      ]
    },
    {
      "id": "ps-registry-autologon",
      "name": "Extract AutoLogon Credentials",
      "category": "post-exploit",
      "subcategory": "credential-hunting",
      "command": "Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon' | Select-Object DefaultUserName,DefaultPassword,DefaultDomainName,AutoAdminLogon",
      "description": "Extract cleartext AutoLogon credentials from Windows registry. Commonly configured on kiosk systems, shared workstations, or during deployment.",
      "tags": [
        "WINDOWS",
        "POST_EXPLOITATION",
        "CREDENTIAL_HUNTING",
        "REGISTRY",
        "AUTOLOGON"
      ],
      "variables": [],
      "flag_explanations": {
        "-Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon'": "Registry path for Windows logon settings. AutoLogon credentials stored here for unattended login. HKLM (HKEY_LOCAL_MACHINE) readable by all users.",
        "Select-Object DefaultUserName,DefaultPassword,DefaultDomainName,AutoAdminLogon": "Filter output to credential-related values. DefaultUserName=account, DefaultPassword=cleartext password (if set), DefaultDomainName=domain/workgroup, AutoAdminLogon=1 means enabled."
      },
      "success_indicators": [
        "DefaultUserName",
        "DefaultPassword",
        "AutoAdminLogon : 1"
      ],
      "failure_indicators": [
        "Property not found",
        "DefaultPassword :",
        "Empty values"
      ],
      "troubleshooting": {
        "DefaultPassword is empty": "AutoLogon may not be configured, or password stored using LSA secrets (more secure method). Check if AutoAdminLogon is 1 - if enabled without DefaultPassword, credentials stored elsewhere.",
        "Access denied": "Should be readable by all users. If denied, may be GPO-restricted environment.",
        "Registry path not found": "Unlikely on standard Windows. Verify path spelling exactly."
      },
      "notes": "HIGH VALUE: AutoLogon stores credentials in cleartext in the registry for unattended login. Commonly used on: kiosk systems, shared workstations, lab environments, development machines. When found, these credentials often belong to service accounts or admin users. If AutoAdminLogon=1 but DefaultPassword empty, password may be stored in LSA secrets (requires SYSTEM to extract). Always test found credentials against other accounts - password reuse is common. Quick check that takes seconds - always include in enumeration. Manual alternative: reg query 'HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon' /v DefaultPassword",
      "next_steps": [
        "win-net-user-detail",
        "win-runas-cmd"
      ]
    },
    {
      "id": "ps-cmdkey-list",
      "name": "List Saved Credentials",
      "category": "post-exploit",
      "subcategory": "credential-hunting",
      "command": "cmdkey /list",
      "description": "List Windows Credential Manager saved credentials including RDP connections, network shares, and generic credentials.",
      "tags": [
        "WINDOWS",
        "POST_EXPLOITATION",
        "CREDENTIAL_HUNTING",
        "CREDENTIAL_MANAGER",
        "RDP"
      ],
      "variables": [],
      "flag_explanations": {
        "/list": "Display all stored credentials in Windows Credential Manager for current user. Shows target (server/share), type (Domain Password, Generic), and username. Does NOT display actual passwords (those require SYSTEM or DPAPI extraction)."
      },
      "success_indicators": [
        "Target:",
        "Type:",
        "User:",
        "TERMSRV",
        "Domain:target"
      ],
      "failure_indicators": [
        "No stored credentials",
        "Currently stored credentials:"
      ],
      "troubleshooting": {
        "No credentials listed": "User hasn't saved any credentials. This is common - move on to other credential sources.",
        "Shows targets but no passwords": "Expected - cmdkey shows metadata only. Actual password extraction requires SYSTEM privileges and DPAPI. However, saved RDP credentials can be used with mstsc /v:target if account matches.",
        "Need to see other users' credentials": "cmdkey shows current user only. After privilege escalation, check other user profiles' Credential Manager."
      },
      "notes": "Relevant: While cmdkey doesn't show actual passwords, it reveals what systems the user has saved credentials for - indicating lateral movement targets. TERMSRV entries = saved RDP credentials. If current user has saved RDP creds, can connect to those systems without knowing password: mstsc /v:targetserver. For actual password extraction, need SYSTEM and tools like Mimikatz (sekurlsa::dpapi). Also check RDP connection history: reg query 'HKCU\\Software\\Microsoft\\Terminal Server Client\\Servers' to see recently connected servers (potential pivot targets). Manual alternative: control /name Microsoft.CredentialManager (GUI).",
      "next_steps": [
        "win-net-user-detail"
      ]
    }
  ]
}