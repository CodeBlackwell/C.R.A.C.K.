{"category": "pivoting", "commands": [{"id": "netsh-portproxy-delete", "name": "Netsh Delete Port Forward", "category": "pivoting", "subcategory": "windows-tunneling", "command": "netsh interface portproxy delete v4tov4 listenport=<LISTEN_PORT> listenaddress=<LISTEN_IP>", "description": "Remove netsh port forwarding rule - cleanup after pivoting", "tags": ["NETSH", "WINDOWS", "CLEANUP", "OSCP:MEDIUM", "ADMIN_REQUIRED"], "variables": [{"name": "<LISTEN_PORT>", "description": "Port to stop forwarding", "example": "2222", "required": true}, {"name": "<LISTEN_IP>", "description": "Listen address of rule to delete (must match exactly)", "example": "0.0.0.0", "required": true}], "flag_explanations": {"delete v4tov4": "Remove IPv4-to-IPv4 port forwarding rule"}, "success_indicators": ["Ok. message", "netsh interface portproxy show all no longer lists rule"], "failure_indicators": ["Access is denied - need administrator privileges", "Element not found - wrong listenport or listenaddress"], "alternatives": [], "prerequisites": [], "troubleshooting": {"Element not found": "Verify exact rule: netsh interface portproxy show all, ensure listenaddress matches (e.g., 0.0.0.0 vs 192.168.x.x)", "Access denied": "Run as Administrator"}, "notes": "Critical for cleanup in OSCP exam - remove port forwards to avoid leaving persistent backdoors. Also delete associated firewall rules with netsh-firewall-delete-rule. For complete cleanup: netsh interface portproxy reset (removes all rules).", "oscp_relevance": "medium"}, {"id": "where-windows", "name": "Where - Find Executable", "category": "pivoting", "subcategory": "enumeration", "command": "where <EXECUTABLE>", "description": "Locate executable in Windows PATH - verify tool availability", "tags": ["WINDOWS", "ENUMERATION", "OSCP:MEDIUM"], "variables": [{"name": "<EXECUTABLE>", "description": "Executable name to search for (e.g., ssh, plink, python)", "example": "ssh", "required": true}], "flag_explanations": {}, "success_indicators": ["Full path displayed (e.g., C:\\Windows\\System32\\OpenSSH\\ssh.exe)", "Multiple paths if executable in multiple locations"], "failure_indicators": ["INFO: Could not find files for the given pattern(s) - executable not in PATH"], "alternatives": ["where /R C:\\ <EXECUTABLE> - Search recursively from C:\\ (slow)"], "prerequisites": [], "troubleshooting": {}, "notes": "Quick check for tool availability. Common OSCP checks: where ssh (OpenSSH client), where python, where powershell, where curl. Equivalent to Linux 'which' command.", "oscp_relevance": "medium"}, {"id": "systeminfo-windows", "name": "System Information", "category": "pivoting", "subcategory": "enumeration", "command": "systeminfo", "description": "Display detailed Windows system information - OS version, patches, network config", "tags": ["WINDOWS", "ENUMERATION", "OSCP:HIGH", "SYSTEMINFO"], "variables": [], "flag_explanations": {}, "success_indicators": ["Host Name, OS Name, OS Version displayed", "System Type (x64-based PC or x86-based PC)", "Hotfix(s) list shows installed patches", "Network Card(s) shows IP configuration"], "failure_indicators": [], "alternatives": ["wmic os get caption,version - Specific OS version", "wmic qfe list - Just hotfixes"], "prerequisites": [], "troubleshooting": {}, "notes": "Critical OSCP enumeration command. Check: OS version (for exploit research), Hotfix list (missing patches = vulnerabilities), Network adapters (multi-homed = pivot candidate), System Type (32-bit vs 64-bit for exploit selection). Time estimate: 5-10 seconds for output.", "oscp_relevance": "high"}, {"id": "whoami-priv", "name": "Whoami Privileges", "category": "pivoting", "subcategory": "enumeration", "command": "whoami /priv", "description": "Display current user privileges - check for admin rights and dangerous privileges", "tags": ["WINDOWS", "ENUMERATION", "PRIVESC", "OSCP:HIGH"], "variables": [], "flag_explanations": {"/priv": "Display user privileges", "/all": "(Alternative) Display all user info including groups and SID"}, "success_indicators": ["Privilege Name column lists available privileges", "State shows Enabled or Disabled", "SeDebugPrivilege, SeImpersonatePrivilege = high-value for privilege escalation"], "failure_indicators": [], "alternatives": ["whoami /all - Complete user info"], "prerequisites": [], "troubleshooting": {}, "notes": "Critical for privilege escalation assessment. Key privileges: SeImpersonatePrivilege (Potato exploits), SeDebugPrivilege (process injection), SeBackupPrivilege (backup file access), SeRestorePrivilege (file restore), SeLoadDriverPrivilege (driver loading). If high-value privilege present, search for corresponding exploit. Time estimate: immediate.", "oscp_relevance": "high"}, {"id": "ipconfig-all", "name": "IP Configuration All", "category": "pivoting", "subcategory": "enumeration", "command": "ipconfig /all", "description": "Display detailed network configuration - identify dual-homed hosts and internal subnets", "tags": ["WINDOWS", "ENUMERATION", "NETWORKING", "OSCP:HIGH"], "variables": [], "flag_explanations": {"/all": "Display full configuration (DNS, WINS, adapters)"}, "success_indicators": ["Multiple adapters listed (Ethernet, Ethernet 2, etc.)", "IPv4 Address shows IP for each adapter", "DNS Servers, Default Gateway displayed"], "failure_indicators": [], "alternatives": ["ipconfig - Brief output without /all", "Get-NetIPConfiguration - PowerShell equivalent"], "prerequisites": [], "troubleshooting": {}, "notes": "Critical OSCP enumeration for pivot identification. Look for: Multiple network adapters (dual-homed = pivot candidate), Internal IP ranges (10.x, 172.16-31.x, 192.168.x = potential pivot targets), DNS servers (identify domain controllers). Common pattern: Host has 192.168.45.x (WAN) and 172.16.50.x (internal) = perfect pivot point. Time estimate: immediate.", "oscp_relevance": "high"}, {"id": "netstat-windows", "name": "Netstat Network Connections", "category": "pivoting", "subcategory": "enumeration", "command": "netstat -ano", "description": "Display all network connections and listening ports with process IDs - enumerate services", "tags": ["WINDOWS", "ENUMERATION", "NETWORKING", "OSCP:HIGH"], "variables": [], "flag_explanations": {"-a": "Display all connections and listening ports", "-n": "Display addresses and port numbers in numerical form (faster)", "-o": "Display owning process ID (PID)", "-b": "(Optional) Display executable name (requires admin)"}, "success_indicators": ["Proto, Local Address, Foreign Address, State, PID columns displayed", "LISTENING ports show bound services", "ESTABLISHED connections show active communications"], "failure_indicators": [], "alternatives": ["netstat -an | findstr LISTENING - Only listening ports", "Get-NetTCPConnection - PowerShell equivalent"], "prerequisites": [], "troubleshooting": {}, "notes": "Critical for service enumeration and port forward verification. Use cases: Identify listening ports (potential services), Find established connections (active pivots), Verify port forward active (netstat -ano | findstr <PORT>), Map PID to process (tasklist | findstr <PID>). Combine with netsh-portproxy-show to see full pivot configuration. Time estimate: immediate.", "oscp_relevance": "high"}]}