{
  "category": "pivoting",
  "commands": [
    {
      "id": "netsh-portproxy-delete",
      "name": "Netsh Delete Port Forward",
      "category": "pivoting",
      "subcategory": "windows-tunneling",
      "command": "netsh interface portproxy delete v4tov4 listenport=<LISTEN_PORT> listenaddress=<LISTEN_IP>",
      "description": "Remove netsh port forwarding rule - cleanup after pivoting",
      "tags": [
        "NETSH",
        "WINDOWS",
        "CLEANUP",
        "ADMIN_REQUIRED"
      ],
      "variables": [
        {
          "name": "<LISTEN_PORT>",
          "description": "Port to stop forwarding",
          "example": "2222",
          "required": true
        },
        {
          "name": "<LISTEN_IP>",
          "description": "Listen address of rule to delete (must match exactly)",
          "example": "0.0.0.0",
          "required": true
        }
      ],
      "flag_explanations": {
        "delete v4tov4": "Remove IPv4-to-IPv4 port forwarding rule"
      },
      "success_indicators": [
        "Ok. message",
        "netsh interface portproxy show all no longer lists rule"
      ],
      "failure_indicators": [
        "Access is denied - need administrator privileges",
        "Element not found - wrong listenport or listenaddress"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {
        "Element not found": "Verify exact rule: netsh interface portproxy show all, ensure listenaddress matches (e.g., 0.0.0.0 vs 192.168.x.x)",
        "Access denied": "Run as Administrator"
      },
      "notes": "Critical for cleanup in certification exam - remove port forwards to avoid leaving persistent backdoors.\n\nAlso delete associated firewall rules with netsh-firewall-delete-rule.\n\nFor complete cleanup:\nnetsh interface portproxy reset (removes all rules).",
      "filled_example": "netsh interface portproxy delete v4tov4 listenport=2222 listenaddress=0.0.0.0"
    },
    {
      "id": "where-windows",
      "name": "Where - Find Executable",
      "category": "pivoting",
      "subcategory": "enumeration",
      "command": "where <EXECUTABLE>",
      "description": "Locate executable in Windows PATH - verify tool availability",
      "tags": [
        "WINDOWS",
        "ENUMERATION"
      ],
      "variables": [
        {
          "name": "<EXECUTABLE>",
          "description": "Executable name to search for (e.g., ssh, plink, python)",
          "example": "ssh",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Full path displayed (e.g., C:\\Windows\\System32\\OpenSSH\\ssh.exe)",
        "Multiple paths if executable in multiple locations"
      ],
      "failure_indicators": [
        "INFO: Could not find files for the given pattern(s) - executable not in PATH"
      ],
      "alternatives": [],
      "prerequisites": [],
      "troubleshooting": {},
      "notes": "Quick check for tool availability.\n\nCommon certification checks:\nwhere ssh (OpenSSH client), where python, where powershell, where curl.\n\nEquivalent to Linux 'which' command.",
      "filled_example": "where ssh"
    },
    {
      "id": "systeminfo-windows",
      "name": "System Information",
      "category": "pivoting",
      "subcategory": "enumeration",
      "command": "systeminfo",
      "description": "Display detailed Windows system information - OS version, patches, network config",
      "tags": [
        "WINDOWS",
        "ENUMERATION",
        "SYSTEMINFO"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Host Name, OS Name, OS Version displayed",
        "System Type (x64-based PC or x86-based PC)",
        "Hotfix(s) list shows installed patches",
        "Network Card(s) shows IP configuration"
      ],
      "failure_indicators": [],
      "prerequisites": [
        "evil-winrm-shell"
      ],
      "alternatives": [
        "ipconfig-all",
        "get-computerinfo"
      ],
      "next_steps": [
        "win-privesc-winpeas",
        "win-kernel-exploits"
      ],
      "troubleshooting": {},
      "notes": "Critical certification enumeration command.\n\nCheck:\nOS version (for exploit research), Hotfix list (missing patches = vulnerabilities), Network adapters (multi-homed = pivot candidate), System Type (32-bit vs 64-bit for exploit selection).\n\nTime estimate:\n5-10 seconds for output."
    },
    {
      "id": "whoami-priv",
      "name": "Whoami Privileges",
      "category": "pivoting",
      "subcategory": "enumeration",
      "command": "whoami /priv",
      "description": "Display current user privileges - check for admin rights and dangerous privileges",
      "tags": [
        "WINDOWS",
        "ENUMERATION",
        "PRIVESC"
      ],
      "variables": [],
      "flag_explanations": {
        "/priv": "Display user privileges",
        "/all": "(Alternative) Display all user info including groups and SID"
      },
      "success_indicators": [
        "Privilege Name column lists available privileges",
        "State shows Enabled or Disabled",
        "SeDebugPrivilege, SeImpersonatePrivilege = high-value for privilege escalation"
      ],
      "failure_indicators": [],
      "prerequisites": [
        "evil-winrm-shell"
      ],
      "alternatives": [
        "whoami-priv",
        "whoami-all"
      ],
      "next_steps": [
        "windows-potato-attacks",
        "win-potato-exploits"
      ],
      "troubleshooting": {},
      "notes": "Critical for privilege escalation assessment.\n\nKey privileges:\nSeImpersonatePrivilege (Potato exploits), SeDebugPrivilege (process injection), SeBackupPrivilege (backup file access), SeRestorePrivilege (file restore), SeLoadDriverPrivilege (driver loading).\n\nIf high-value privilege present, search for corresponding exploit.\n\nTime estimate:\nimmediate."
    },
    {
      "id": "ipconfig-all",
      "name": "IP Configuration All",
      "category": "pivoting",
      "subcategory": "enumeration",
      "command": "ipconfig /all",
      "description": "Display detailed network configuration - identify dual-homed hosts and internal subnets",
      "tags": [
        "WINDOWS",
        "ENUMERATION",
        "NETWORKING"
      ],
      "variables": [],
      "flag_explanations": {
        "/all": "Display full configuration (DNS, WINS, adapters)"
      },
      "success_indicators": [
        "Multiple adapters listed (Ethernet, Ethernet 2, etc.)",
        "IPv4 Address shows IP for each adapter",
        "DNS Servers, Default Gateway displayed"
      ],
      "failure_indicators": [],
      "prerequisites": [
        "evil-winrm-shell"
      ],
      "alternatives": [
        "systeminfo-windows",
        "ipconfig-all"
      ],
      "next_steps": [
        "netstat-windows",
        "ssh-dynamic-port-forward",
        "chisel-client"
      ],
      "troubleshooting": {},
      "notes": "Critical certification enumeration for pivot identification.\n\nLook for:\nMultiple network adapters (dual-homed = pivot candidate), Internal IP ranges (10.x, 172.16-31.x, 192.168.x = potential pivot targets), DNS servers (identify domain controllers).\n\nCommon pattern:\nHost has 192.168.45.x (WAN) and 172.16.50.x (internal) = perfect pivot point.\n\nTime estimate:\nimmediate."
    },
    {
      "id": "netstat-windows",
      "name": "Netstat Network Connections",
      "category": "pivoting",
      "subcategory": "enumeration",
      "command": "netstat -ano",
      "description": "Display all network connections and listening ports with process IDs - enumerate services",
      "tags": [
        "WINDOWS",
        "ENUMERATION",
        "NETWORKING"
      ],
      "variables": [],
      "flag_explanations": {
        "-a": "Display all connections and listening ports",
        "-n": "Display addresses and port numbers in numerical form (faster)",
        "-o": "Display owning process ID (PID)",
        "-b": "(Optional) Display executable name (requires admin)"
      },
      "success_indicators": [
        "Proto, Local Address, Foreign Address, State, PID columns displayed",
        "LISTENING ports show bound services",
        "ESTABLISHED connections show active communications"
      ],
      "failure_indicators": [],
      "prerequisites": [
        "evil-winrm-shell"
      ],
      "alternatives": [
        "netstat-windows",
        "ss-listening-ports"
      ],
      "next_steps": [
        "ssh-dynamic-port-forward",
        "chisel-client",
        "proxychains-nmap"
      ],
      "troubleshooting": {},
      "notes": "Critical for service enumeration and port forward verification.\n\nUse cases:\nIdentify listening ports (potential services), Find established connections (active pivots), Verify port forward active (netstat -ano | findstr <PORT>), Map PID to process (tasklist | findstr <PID>).\n\nCombine with netsh-portproxy-show to see full pivot configuration.\n\nTime estimate:\nimmediate."
    }
  ]
}