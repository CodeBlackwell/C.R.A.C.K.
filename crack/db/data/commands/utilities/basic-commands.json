{
  "category": "utilities",
  "subcategory": "basic-commands",
  "description": "Basic Linux commands and machine-specific utilities for OSCP tasks",
  "commands": [
    {
      "id": "cat-read-file",
      "name": "Read File with cat",
      "category": "utilities",
      "subcategory": "file-operations",
      "command": "cat <FILE>",
      "description": "Display file contents to terminal for reading configuration files, flags, and text files",
      "tags": [
        "FILE_OPERATIONS",
        "LINUX",
        "OSCP:HIGH",
        "UTILITIES"
      ],
      "variables": [
        {
          "name": "<FILE>",
          "description": "Path to file to read",
          "example": "/etc/passwd",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "File contents displayed",
        "Text visible in terminal"
      ],
      "failure_indicators": [
        "No such file or directory",
        "Permission denied",
        "Is a directory"
      ],
      "next_steps": [
        "capture-root-flag",
        "grep-search-file"
      ],
      "alternatives": [
        "less-view-file",
        "head-view-file",
        "tail-view-file"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "permission_denied": "File not readable by current user. Try with sudo: sudo cat <FILE>. Or check permissions: ls -l <FILE>",
        "binary_file": "File is binary. Use strings <FILE> to extract readable text. Or hexdump -C <FILE> for hex view"
      },
      "notes": "Basic file reading command for OSCP.\n\nCommon usage:\ncat /etc/passwd - User enumeration\ncat /etc/shadow - Password hashes (requires root)\ncat user.txt - User flag\ncat root.txt - Root flag\ncat config.php - Database credentials\n\nTime estimate: <5 seconds",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "less <FILE> more <FILE> head <FILE> tail <FILE>"
      }
    },
    {
      "id": "cd-change-directory",
      "name": "Change Directory",
      "category": "utilities",
      "subcategory": "navigation",
      "command": "cd <DIRECTORY>",
      "description": "Change current working directory for navigation and file access",
      "tags": [
        "LINUX",
        "NAVIGATION",
        "OSCP:MEDIUM",
        "UTILITIES"
      ],
      "variables": [
        {
          "name": "<DIRECTORY>",
          "description": "Target directory path (absolute or relative)",
          "example": "/var/www/html",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "pwd shows new directory",
        "Prompt updates with new path"
      ],
      "failure_indicators": [
        "No such file or directory",
        "Permission denied",
        "Not a directory"
      ],
      "next_steps": [],
      "alternatives": [],
      "troubleshooting": {
        "permission_denied": "No execute permission on directory. Check: ls -ld <DIRECTORY>. May need higher privileges"
      },
      "notes": "Basic navigation command.\n\nCommon usage:\ncd /home - Home directories\ncd /var/www/html - Web root\ncd /tmp - Temporary files\ncd ~ - User home\ncd - - Previous directory\n\nTime estimate: <1 second",
      "oscp_relevance": "medium",
      "methodology_guidance": {
        "after_success": "pushd <DIRECTORY> cd - (previous directory)"
      }
    },
    {
      "id": "file-rename-extension",
      "name": "Rename File Extension",
      "category": "utilities",
      "subcategory": "file-operations",
      "command": "mv <OLD_NAME> <NEW_NAME>",
      "description": "Rename file to change extension for file upload bypass or correct file type identification",
      "tags": [
        "FILE_OPERATIONS",
        "LINUX",
        "OSCP:MEDIUM",
        "UTILITIES"
      ],
      "variables": [
        {
          "name": "<OLD_NAME>",
          "description": "Current filename",
          "example": "shell.txt",
          "required": true
        },
        {
          "name": "<NEW_NAME>",
          "description": "New filename with desired extension",
          "example": "shell.php",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "File renamed successfully",
        "ls shows new filename"
      ],
      "failure_indicators": [
        "No such file or directory",
        "Permission denied",
        "File exists (target already present)"
      ],
      "next_steps": [],
      "alternatives": [],
      "troubleshooting": {
        "target_exists": "File with new name already exists. Use -f to force: mv -f <OLD> <NEW>. Or choose different name"
      },
      "notes": "File renaming for extension changes.\n\nCommon OSCP usage:\nmv shell.txt shell.php - Prepare webshell\nmv backup backup.zip - Correct archive extension\nmv id_rsa.txt id_rsa - Fix SSH key\n\nTime estimate: <1 second",
      "oscp_relevance": "medium",
      "methodology_guidance": {
        "after_success": "cp <OLD> <NEW> && rm <OLD>"
      }
    },
    {
      "id": "hosts-file-add-entry",
      "name": "Add Entry to /etc/hosts",
      "category": "utilities",
      "subcategory": "network",
      "command": "echo '<IP> <HOSTNAME>' | sudo tee -a /etc/hosts",
      "description": "Add hostname to IP mapping in /etc/hosts file for local DNS resolution",
      "tags": [
        "DNS",
        "LINUX",
        "NETWORK",
        "OSCP:HIGH",
        "UTILITIES"
      ],
      "variables": [
        {
          "name": "<IP>",
          "description": "Target IP address",
          "example": "10.10.11.18",
          "required": true
        },
        {
          "name": "<HOSTNAME>",
          "description": "Hostname to map to IP",
          "example": "usage.htb",
          "required": true
        }
      ],
      "flag_explanations": {
        "sudo": "Required because /etc/hosts is system file (root-owned). Without sudo, operation fails with permission denied",
        "tee -a": "Append to file while also displaying output. -a flag appends instead of overwriting. Alternative to redirect (>>) but works with sudo piping"
      },
      "success_indicators": [
        "Entry added to /etc/hosts",
        "hostname resolves to IP (ping <HOSTNAME>)",
        "Browser can access http://<HOSTNAME>"
      ],
      "failure_indicators": [
        "Permission denied (missing sudo)",
        "sudo: command not found"
      ],
      "next_steps": [
        "ping-host",
        "nmap-service-scan"
      ],
      "alternatives": [
        "nano-edit-hosts"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "still_not_resolving": "DNS cache issue. Flush with: sudo systemd-resolve --flush-caches. Or restart DNS: sudo systemctl restart systemd-resolved",
        "duplicate_entry": "Entry already exists. Edit /etc/hosts manually to update. Or remove old entry first"
      },
      "notes": "CRITICAL OSCP STEP: Map target hostname for web applications.\n\nWorkflow:\n1. Add host entry (THIS COMMAND)\n   echo '10.10.11.18 usage.htb' | sudo tee -a /etc/hosts\n2. Verify resolution\n   ping usage.htb\n   â†’ Should ping 10.10.11.18\n3. Access web application\n   http://usage.htb\n\nCommon OSCP usage:\necho '10.10.11.18 usage.htb' | sudo tee -a /etc/hosts\necho '10.10.11.50 office.htb' | sudo tee -a /etc/hosts\n\nVerification:\ncat /etc/hosts | grep htb\nping -c 1 usage.htb\n\nTime estimate: 5-10 seconds",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "sudo nano /etc/hosts sudo vi /etc/hosts"
      }
    },
    {
      "id": "capture-user-flag",
      "name": "Capture User Flag",
      "category": "utilities",
      "subcategory": "oscp-tasks",
      "command": "cat /home/<USER>/user.txt",
      "description": "Read user flag file to obtain proof of user-level access on target machine",
      "tags": [
        "FLAG_CAPTURE",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PROOF"
      ],
      "variables": [
        {
          "name": "<USER>",
          "description": "Username whose home directory contains flag",
          "example": "dash",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "32-character hexadecimal string displayed",
        "Flag format matches (e.g., abc123def456...)"
      ],
      "failure_indicators": [
        "No such file or directory (wrong user/path)",
        "Permission denied (insufficient privileges)"
      ],
      "next_steps": [
        "check-sudo-privs",
        "linux-enumerate-users"
      ],
      "alternatives": [],
      "troubleshooting": {
        "wrong_user": "Flag in different user's directory. Enumerate: ls -la /home. Try each user: cat /home/*/user.txt 2>/dev/null",
        "permission_denied": "Need to be that user or root. Switch user: su - <USER>. Or escalate to root first"
      },
      "notes": "USER FLAG CAPTURE: Proof of user-level access.\n\nCommon locations:\n/home/<USER>/user.txt\n/home/<USER>/Desktop/user.txt\n/root/user.txt (if root is considered 'user' flag)\n\nWorkflow:\n1. Enumerate users: ls -la /home\n2. Find flag: find /home -name user.txt 2>/dev/null\n3. Read flag (THIS COMMAND): cat /home/dash/user.txt\n4. Document in proof.txt\n\nTime estimate: 5 seconds",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "find /home -name user.txt -exec cat {} \\; locate user.txt"
      }
    },
    {
      "id": "capture-root-flag",
      "name": "Capture Root Flag",
      "category": "utilities",
      "subcategory": "oscp-tasks",
      "command": "cat /root/root.txt",
      "description": "Read root flag file to obtain proof of root-level access and complete machine compromise",
      "tags": [
        "FLAG_CAPTURE",
        "OSCP:HIGH",
        "POST_EXPLOITATION",
        "PRIVILEGE_ESCALATION",
        "PROOF"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "32-character hexadecimal string displayed",
        "Root flag captured"
      ],
      "failure_indicators": [
        "No such file or directory",
        "Permission denied (not root)"
      ],
      "next_steps": [],
      "alternatives": [
        "windows-read-file-type",
        "cat-read-file"
      ],
      "prerequisites": [
        "linux-privesc-to-root",
        "sudo-exploit"
      ],
      "troubleshooting": {
        "permission_denied": "Not root yet. Complete privilege escalation first. Check sudo: sudo -l. Find SUID: find / -perm -4000 2>/dev/null",
        "file_not_found": "May be named differently: cat /root/proof.txt. Or in alternate location: find / -name '*flag*' 2>/dev/null"
      },
      "notes": "ROOT FLAG CAPTURE: Proof of complete system compromise.\n\nCommon locations:\n/root/root.txt\n/root/proof.txt\n/root/Desktop/root.txt\n\nWorkflow:\n1. Escalate to root\n2. Read flag (THIS COMMAND): cat /root/root.txt\n3. Document in proof.txt with screenshot\n4. Complete machine documentation\n\nTime estimate: 5 seconds",
      "oscp_relevance": "high",
      "methodology_guidance": {
        "after_success": "cat /root/proof.txt find /root -name root.txt -exec cat {} \\;"
      }
    },
    {
      "id": "7zip-listfile-research",
      "name": "Research 7zip listfile Option",
      "category": "utilities",
      "subcategory": "machine-specific",
      "command": "7z --help | grep -i listfile",
      "description": "Research 7zip listfile parameter functionality for Usage machine privilege escalation vulnerability",
      "tags": [
        "7ZIP",
        "CVE",
        "MACHINE_SPECIFIC",
        "OSCP:LOW",
        "RESEARCH"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "listfile option documentation displayed",
        "Usage information shown"
      ],
      "failure_indicators": [
        "7z: command not found",
        "No matches found"
      ],
      "next_steps": [],
      "alternatives": [],
      "troubleshooting": {
        "not_installed": "7zip not installed on system. Install: sudo apt install p7zip-full. Or research online"
      },
      "notes": "Machine-specific research for HackTheBox Usage.\n\n7zip --list-file vulnerability allows reading arbitrary files when used with sudo.\n\nExploitation:\nsudo /usr/bin/7za a backup.7z -t7z -snl -mhe=on -p<PASSWORD> @<FILE_TO_READ>\n\nTime estimate: 2-5 minutes (research)",
      "oscp_relevance": "low",
      "methodology_guidance": {
        "after_success": "man 7z 7z --help-full"
      }
    },
    {
      "id": "binary-dynamic-analysis",
      "name": "Dynamic Binary Analysis",
      "category": "utilities",
      "subcategory": "machine-specific",
      "command": "strings <BINARY> | grep -i <KEYWORD>",
      "description": "Analyze binary executable to extract readable strings and identify functionality or credentials",
      "tags": [
        "BINARY_ANALYSIS",
        "MACHINE_SPECIFIC",
        "OSCP:LOW",
        "REVERSE_ENGINEERING"
      ],
      "variables": [
        {
          "name": "<BINARY>",
          "description": "Path to binary file to analyze",
          "example": "/usr/bin/usage_management",
          "required": true
        },
        {
          "name": "<KEYWORD>",
          "description": "Keyword to search for in strings output",
          "example": "password",
          "required": false
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Readable strings extracted",
        "Credentials found",
        "Functionality identified"
      ],
      "failure_indicators": [
        "File not found",
        "Permission denied",
        "Binary stripped (no strings)"
      ],
      "next_steps": [],
      "alternatives": [],
      "troubleshooting": {
        "no_useful_strings": "Binary may be stripped or obfuscated. Try dynamic analysis: ltrace ./binary, strace ./binary. Or decompile with Ghidra"
      },
      "notes": "Basic binary analysis for OSCP.\n\nCommon usage:\nstrings binary | grep -i password\nstrings binary | grep -i user\nstrings binary | grep -i admin\n\nTime estimate: 1-5 minutes",
      "oscp_relevance": "low",
      "methodology_guidance": {
        "after_success": "ltrace <BINARY> strace <BINARY> gdb <BINARY>"
      }
    },
    {
      "id": "sudo-execute-usage-management",
      "name": "Execute usage_management Binary with Sudo",
      "category": "utilities",
      "subcategory": "machine-specific",
      "command": "sudo /usr/bin/usage_management",
      "description": "Execute usage_management binary with sudo privileges for HackTheBox Usage machine privilege escalation",
      "tags": [
        "MACHINE_SPECIFIC",
        "OSCP:LOW",
        "PRIVILEGE_ESCALATION",
        "SUDO"
      ],
      "variables": [],
      "flag_explanations": {},
      "success_indicators": [
        "Program executes with root privileges",
        "Menu or options displayed"
      ],
      "failure_indicators": [
        "Permission denied",
        "Command not found",
        "sudo: unable to execute"
      ],
      "next_steps": [
        "7zip-listfile-research"
      ],
      "alternatives": [],
      "troubleshooting": {
        "not_allowed": "User not in sudoers for this binary. Check: sudo -l. May need different exploit path"
      },
      "notes": "Machine-specific command for HackTheBox Usage.\n\nusage_management binary exploitation:\n1. Check sudo permissions: sudo -l\n2. Execute binary (THIS COMMAND)\n3. Exploit functionality for privilege escalation\n\nTime estimate: Variable",
      "oscp_relevance": "low"
    }
  ]
}
