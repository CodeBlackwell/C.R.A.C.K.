{
  "category": "enumeration",
  "description": "Password cracking methodology and time estimation",
  "commands": [
    {
      "id": "calculate-keyspace",
      "name": "Calculate Password Keyspace",
      "category": "enumeration",
      "command": "python3 -c \"import math; charset=<CHARSET_SIZE>; length=<PASSWORD_LENGTH>; print(f'Keyspace: {charset**length:,} combinations')\"",
      "description": "Calculate total number of possible passwords for brute-force",
      "tags": [
        "METHODOLOGY",
        "KEYSPACE",
        "TIME_ESTIMATION",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<CHARSET_SIZE>",
          "description": "Number of possible characters (26=lowercase, 52=upper+lower, 62=alphanumeric, 95=full ASCII)",
          "example": "62",
          "required": true
        },
        {
          "name": "<PASSWORD_LENGTH>",
          "description": "Password length to test",
          "example": "8",
          "required": true
        }
      ],
      "flag_explanations": {
        "charset**length": "Exponential calculation - Each position has 'charset' possibilities. 8-char password with 62 chars = 62^8 = 218 trillion combinations. Formula: keyspace = charset_size ^ password_length. Example charsets: lowercase (26), upper+lower (52), alphanumeric (62), +special chars (95). Keyspace grows exponentially with length - 8 chars = 218T, 9 chars = 13.5 quadrillion (62x larger).",
        "python3 -c": "Execute Python one-liner - Useful for complex calculations in terminal. Alternative: Use calculator, Excel, or dedicated keyspace tools. Math: Lower charset + longer password often EASIER than higher charset + shorter password (8-char alphanumeric vs 6-char full ASCII)."
      },
      "success_indicators": [
        "Keyspace displayed",
        "Format: 'Keyspace: X combinations'"
      ],
      "notes": "OSCP TIP:\nKeyspace determines brute-force feasibility.\n\nCommon charsets:\nLowercase (a-z) = 26, Upper+Lower (A-Za-z) = 52, Alphanumeric (A-Za-z0-9) = 62, Full printable ASCII = 95.\n\nExample:\n8-char alphanumeric = 62^8 = 218,340,105,584,896 (218 trillion).\n\nAt 1 billion H/s (fast GPU on MD5) = 218,340 seconds = 60 hours.\n\nAt 10 H/s (bcrypt) = 692 YEARS.\n\nConclusion:\nBrute-force only viable for:\nFast hashes (MD5, NTLM) + Short passwords (<8 chars) OR Slow hashes + Dictionary attacks.",
      "oscp_relevance": "high"
    },
    {
      "id": "calculate-crack-time",
      "name": "Estimate Password Cracking Time",
      "category": "enumeration",
      "command": "python3 -c \"keyspace=<KEYSPACE>; hash_rate=<HASH_RATE>; seconds=keyspace/hash_rate; hours=seconds/3600; print(f'Time: {hours:.2f} hours ({hours/24:.2f} days)')\"",
      "description": "Calculate estimated time to crack based on keyspace and hash rate",
      "tags": [
        "METHODOLOGY",
        "TIME_ESTIMATION",
        "PLANNING",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<KEYSPACE>",
          "description": "Total number of password combinations",
          "example": "218340105584896",
          "required": true
        },
        {
          "name": "<HASH_RATE>",
          "description": "Hashes per second (from hashcat benchmark)",
          "example": "1000000000",
          "required": true
        }
      ],
      "flag_explanations": {
        "keyspace/hash_rate": "Time calculation - Divide total combinations by processing speed. Result = seconds to test every combination. On average, crack at 50% (but plan for 100% worst case). Example: 218T combinations ÷ 1B H/s = 218,340 seconds = 60 hours. Formula assumes: 1) No duplicate tests, 2) Constant hash rate, 3) 100% GPU utilization.",
        "seconds/3600": "Convert to hours - Seconds ÷ 3600 = hours. Hours ÷ 24 = days. Provides intuitive time estimate. Example: 218,340 seconds = 60.6 hours = 2.5 days. OSCP context: >4 hours = Not viable during exam. >1 day = Offline-only (post-exam analysis)."
      },
      "success_indicators": [
        "Time estimate displayed",
        "Format shows hours and days"
      ],
      "notes": "OSCP TIP:\nDecision tree - Time estimate < 1 hour:\nProceed with brute-force.\n\n1-4 hours:\nConsider if exam time allows.\n\n4-24 hours:\nOnly if overnight + not time-critical.\n\n>24 hours:\nUse dictionary/rule attacks instead.\n\nReality check:\nAverage crack time = 50% of maximum (but could be 1% or 99% - random).\n\nHash rate varies:\nGPU temp, power limits, other processes.\n\nAlways add 20% safety margin to estimates.",
      "oscp_relevance": "high",
      "prerequisites": [
        "hashcat-benchmark",
        "calculate-keyspace"
      ]
    },
    {
      "id": "attack-mode-decision",
      "name": "Choose Attack Mode Strategy",
      "category": "enumeration",
      "command": "echo 'Attack Mode Decision Tree:\\n1. Straight Wordlist (fastest, try first)\\n2. Wordlist + Rules (best balance)\\n3. Combinator (merge wordlists)\\n4. Mask Attack (known pattern)\\n5. Brute Force (last resort)'",
      "description": "Display attack mode selection strategy",
      "tags": [
        "METHODOLOGY",
        "STRATEGY",
        "ATTACK_MODES",
        "OSCP:HIGH"
      ],
      "variables": [],
      "flag_explanations": {
        "Decision Tree": "Attack progression - Start FAST (straight wordlist), escalate to SMART (rules), end with SLOW (brute-force). Order by: Time efficiency + Success probability. Don't skip straight wordlist - 10-15% success rate in 1-5 minutes. Each mode targets different password creation patterns: Dictionary = human-chosen words, Rules = human variations, Mask = known policy, Brute-force = random/unknown."
      },
      "success_indicators": [
        "Decision tree displayed",
        "5 attack modes listed"
      ],
      "notes": "OSCP TIP:\nAttack mode selection based on intelligence.\n\nSCENARIO 1:\nNo policy known → Try:\nrockyou.txt (straight), rockyou.txt + best64.rule, rockyou.txt + rockyou-30000.rule.\n\nSCENARIO 2:\nPolicy known (8 chars, 1 upper, 1 digit, 1 special) → Create targeted rules:\nc $<YEAR> $! applied to company/season wordlist.\n\nSCENARIO 3:\nPattern observed (firstname+year format) → Use mask:\n?u?l?l?l?l?l?l?l?d?d?d?d.\n\nTime allocation (exam):\nStraight wordlist (5 min), Rule-based (30-60 min), Mask/Brute-force (only if <2 hours estimated).",
      "oscp_relevance": "high"
    },
    {
      "id": "wordlist-effectiveness",
      "name": "Estimate Wordlist Effectiveness",
      "category": "enumeration",
      "command": "wc -l <WORDLIST> && echo 'With rules: ' && python3 -c \"lines=<LINE_COUNT>; rules=<RULE_COUNT>; print(f'{lines * rules:,} total candidates')\"",
      "description": "Calculate total candidates from wordlist + rules combination",
      "tags": [
        "METHODOLOGY",
        "WORDLIST",
        "PLANNING",
        "OSCP:MEDIUM"
      ],
      "variables": [
        {
          "name": "<WORDLIST>",
          "description": "Path to wordlist file",
          "example": "/usr/share/wordlists/rockyou.txt",
          "required": true
        },
        {
          "name": "<LINE_COUNT>",
          "description": "Number of lines in wordlist (from wc -l)",
          "example": "14344391",
          "required": true
        },
        {
          "name": "<RULE_COUNT>",
          "description": "Number of rules in rule file",
          "example": "64",
          "required": true
        }
      ],
      "flag_explanations": {
        "wc -l": "Count wordlist lines - Each line = one base password. rockyou.txt = 14,344,391 words. Smaller lists: common-passwords.txt (10k-100k), company-specific (100-1000 words). Line count × rule count = total candidates tested.",
        "lines * rules": "Multiplication factor - Each rule multiplies wordlist size. 14M words × 64 rules = 896M candidates. Larger rulesets: rockyou-30000.rule (14M × 30,000 = 420 BILLION candidates). Trade-off: More rules = more coverage + more time."
      },
      "success_indicators": [
        "Line count displayed",
        "Total candidates calculated"
      ],
      "notes": "OSCP TIP:\nWordlist selection based on scenario.\n\nOSCP exam common:\nrockyou.txt (generic passwords, high success rate).\n\nCorporate pentest:\nCompany-specific wordlist (company name, products, locations, employee names).\n\nWeb app:\nLeaked DB from similar service.\n\nSize vs.\n\nSuccess:\nBigger ≠ Always better.\n\nTargeted 1,000-word list + good rules > Generic 14M list (faster, focused).\n\nCreate custom:\ngrep '<COMPANY>' /usr/share/wordlists/* > company.txt; Add:\nseasons, years, common patterns.",
      "oscp_relevance": "medium"
    },
    {
      "id": "hash-rate-benchmark",
      "name": "Benchmark Hash Cracking Speed",
      "category": "enumeration",
      "command": "hashcat -b -m <MODE> | grep -A3 'Hashmode:'",
      "description": "Measure hash rate for specific hash type on current system",
      "tags": [
        "METHODOLOGY",
        "BENCHMARK",
        "HASHCAT",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<MODE>",
          "description": "Hash type mode number (0=MD5, 1000=NTLM, 1800=sha512crypt, etc.)",
          "example": "1000",
          "required": true
        }
      ],
      "flag_explanations": {
        "-b": "Benchmark mode - Test hash cracking speed on current hardware (CPU/GPU). Runs short test, displays hashes per second (H/s). Results vary by: GPU model, CPU speed, temperature, power settings. Use to: 1) Estimate crack time, 2) Compare hash algorithms, 3) Detect hardware issues (low H/s = thermal throttling).",
        "-m <MODE>": "Hash type - Different algorithms have vastly different speeds. Fast hashes (MD5, NTLM): Billions H/s. Slow hashes (bcrypt, scrypt, Argon2): Hundreds/thousands H/s. Benchmark ACTUAL target hash type (don't estimate from MD5 if cracking bcrypt).",
        "grep -A3": "Filter output - Benchmark shows ALL hash types by default (100+ lines). -A3 shows 3 lines AFTER match. Shows: Hash type name, Speed, Time. Alternative: Redirect full output: hashcat -b > benchmark.txt"
      },
      "success_indicators": [
        "Hash rate displayed (H/s, kH/s, MH/s, GH/s)",
        "Speed shown for specified mode"
      ],
      "notes": "OSCP TIP:\nBenchmark reveals reality.\n\nExample results (NVIDIA RTX 3080):\nMD5 (-m 0) = 50 GH/s (50 billion/sec), NTLM (-m 1000) = 80 GH/s, SHA256 (-m 1400) = 20 GH/s, bcrypt (-m 3200) = 100 kH/s (100 thousand/sec), KeePass (-m 13400) = 10 H/s.\n\nImplications:\nMD5 8-char alphanumeric brute-force = 1 hour.\n\nKeePass same password = 69,000 YEARS.\n\nConclusion:\nHash algorithm choice matters MORE than password length for slow hashes.\n\nAlways benchmark before committing time.",
      "oscp_relevance": "high"
    },
    {
      "id": "session-management",
      "name": "Manage Long-Running Crack Sessions",
      "category": "enumeration",
      "command": "hashcat -m <MODE> <HASH_FILE> <WORDLIST> --session=<SESSION_NAME> -o <OUTPUT_FILE> --outfile-format=2",
      "description": "Run cracking session with named session and output file",
      "tags": [
        "METHODOLOGY",
        "SESSION_MANAGEMENT",
        "HASHCAT",
        "OSCP:MEDIUM"
      ],
      "variables": [
        {
          "name": "<MODE>",
          "description": "Hash type mode",
          "example": "1000",
          "required": true
        },
        {
          "name": "<HASH_FILE>",
          "description": "File containing hash",
          "example": "ntlm.txt",
          "required": true
        },
        {
          "name": "<WORDLIST>",
          "description": "Wordlist path",
          "example": "/usr/share/wordlists/rockyou.txt",
          "required": true
        },
        {
          "name": "<SESSION_NAME>",
          "description": "Unique session identifier",
          "example": "exam-target1",
          "required": true
        },
        {
          "name": "<OUTPUT_FILE>",
          "description": "File to save cracked passwords",
          "example": "cracked.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "--session": "Session name - Allows pause/resume. Hashcat saves progress automatically. Resume: hashcat --session=<NAME> --restore. View status: hashcat --session=<NAME> --status. Checkpoint file: <SESSION_NAME>.restore (don't delete during run). Essential for: Long attacks, exam scenarios (need to pivot to other tasks), power outages.",
        "-o": "Output file - Save cracked passwords to file (don't rely on terminal output). Format: hash:password (by default). Multiple runs append (don't overwrite). Alternative: Check hashcat.potfile (~/.hashcat/hashcat.potfile) - stores ALL cracked hashes permanently.",
        "--outfile-format": "Output format - Controls output file format. 2 = plain password only (no hash). Formats: 1=hash:password, 2=password, 3=hash, 4=hex_plain, 5=hex_plain:password. Use 2 for clean password list (ready for spraying, SSH login, etc.)."
      },
      "success_indicators": [
        "Session started",
        "Progress updates shown",
        "Output file created"
      ],
      "notes": "OSCP TIP:\nSession management critical for exam.\n\nScenario:\nCracking KeePass hash (slow, hours needed).\n\nStart session:\nhashcat --session=keepass-crack ....\n\nPause (Ctrl+C), work on other machines.\n\nResume later:\nhashcat --session=keepass-crack --restore.\n\nHashcat resumes EXACTLY where it stopped (no wasted work).\n\nCheck progress anytime:\nhashcat --session=keepass-crack --status (shows ETA, speed, candidates tested).\n\nOutput file benefits:\n1) Persist cracked passwords, 2) Share results between tools, 3) Documentation for report.",
      "oscp_relevance": "medium"
    },
    {
      "id": "monitor-crack-progress",
      "name": "Monitor Cracking Progress",
      "category": "enumeration",
      "command": "watch -n 5 'hashcat --session=<SESSION_NAME> --status 2>&1 | grep -E \"Progress|Speed|Recovered|Time\"'",
      "description": "Real-time monitoring of hashcat session progress",
      "tags": [
        "METHODOLOGY",
        "MONITORING",
        "HASHCAT",
        "OSCP:MEDIUM"
      ],
      "variables": [
        {
          "name": "<SESSION_NAME>",
          "description": "Session name to monitor",
          "example": "exam-target1",
          "required": true
        }
      ],
      "flag_explanations": {
        "watch -n 5": "Refresh every 5 seconds - The watch command reruns command at interval. -n 5 = update every 5 seconds. Provides real-time dashboard of crack progress. Alternative intervals: -n 1 (faster updates, more CPU), -n 60 (slower, less intrusive). Ctrl+C to exit watch.",
        "--status": "Status query - Display current session statistics WITHOUT attaching to interactive session. Shows: Progress (%), Speed (H/s), Recovered (cracked count), Time (started, ETA). Non-blocking: Doesn't interrupt running session. Alternative: Press 's' during interactive hashcat session (shows inline status).",
        "grep -E 'Progress|Speed|Recovered|Time'": "Filter key metrics - Status output verbose (20+ lines). Grep extracts important lines only. Metrics: Progress (% complete, X/Y candidates tested), Speed (current H/s), Recovered (cracked/total), Time.Estimated (ETA)."
      },
      "success_indicators": [
        "Progress percentage increasing",
        "Speed shows H/s rate",
        "Recovered count if cracks found"
      ],
      "notes": "OSCP TIP:\nMonitoring prevents wasted time.\n\nCheck 5 minutes after start:\nSpeed stable? (yes = good, fluctuating = thermal issues).\n\nProgress moving? (yes = working, 0% frozen = error).\n\nETA reasonable? (yes = continue, >exam time = abort).\n\nExample:\nStarted bcrypt crack, estimated 48 hours.\n\nAfter 5 min check:\nETA still 48 hours = abort, try different attack.\n\nMonitoring also detects:\nGPU crashes (Speed = 0), wrong hash format (Rejected 100%), completed sessions (Progress = 100%).",
      "oscp_relevance": "medium"
    },
    {
      "id": "optimize-crack-performance",
      "name": "Optimize Hashcat Performance",
      "category": "enumeration",
      "command": "hashcat -m <MODE> <HASH_FILE> <WORDLIST> -w 3 -O --force",
      "description": "Run hashcat with performance optimization flags",
      "tags": [
        "METHODOLOGY",
        "OPTIMIZATION",
        "HASHCAT",
        "OSCP:MEDIUM"
      ],
      "variables": [
        {
          "name": "<MODE>",
          "description": "Hash type mode",
          "example": "1000",
          "required": true
        },
        {
          "name": "<HASH_FILE>",
          "description": "File containing hash",
          "example": "ntlm.txt",
          "required": true
        },
        {
          "name": "<WORDLIST>",
          "description": "Wordlist path",
          "example": "/usr/share/wordlists/rockyou.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "-w 3": "Workload profile - Controls GPU utilization. Levels: 1=Low (desktop usable), 2=Default (balanced), 3=High (GPU maxed, desktop laggy), 4=Nightmare (100% GPU, system unusable). Use -w 3 for: Dedicated cracking (no GUI needed), overnight sessions, maximum speed. Use -w 1/2 for: Working while cracking, GPU shared with display.",
        "-O": "Optimized kernel - Enable performance kernel (faster but limited). Constraint: Max password length reduced (typically 31 chars → 15 chars). Trade-off: 20-30% speed increase for short passwords. Safe assumption: Most real passwords <15 chars. Disable -O if: Cracking long passphrases, No speed improvement seen.",
        "--force": "Force execution despite warnings - Bypass driver/hardware warnings. Use when: Running in VM, Non-standard GPU, OpenCL errors. CAUTION: May cause crashes/instability. Only use if: Default run shows warnings but you understand risks."
      },
      "success_indicators": [
        "Higher H/s rate vs. default",
        "GPU utilization near 100%"
      ],
      "notes": "OSCP TIP:\nPerformance optimization matters for time-constrained scenarios.\n\nBaseline:\nhashcat -m 1000 hash.txt rockyou.txt (default, ~40 GH/s).\n\nOptimized:\nSame + -w 3 -O (~55 GH/s, 37% faster).\n\nOn 1-hour crack = save 20 minutes.\n\nMonitoring optimization:\nWatch GPU usage (nvidia-smi or radeontop).\n\nTarget:\n95-100% GPU util, 70-80°C temp.\n\nIf:\n<80% GPU = increase -w, >90°C = reduce -w (thermal throttling).\n\nOther optimizations:\nClose background apps, use -d 1,2 for multi-GPU, update GPU drivers.",
      "oscp_relevance": "medium"
    }
  ]
}