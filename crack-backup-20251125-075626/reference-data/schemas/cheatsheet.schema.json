{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "CRACK Reference Cheatsheet Schema",
  "type": "object",
  "required": ["cheatsheets"],
  "properties": {
    "cheatsheets": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "name", "description", "educational_header", "scenarios", "sections"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the cheatsheet (kebab-case)"
          },
          "name": {
            "type": "string",
            "description": "Human readable name for the cheatsheet"
          },
          "description": {
            "type": "string",
            "description": "Brief overview of what this cheatsheet covers"
          },
          "educational_header": {
            "type": "object",
            "required": ["how_to_recognize", "when_to_look_for"],
            "properties": {
              "how_to_recognize": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "minItems": 2,
                "description": "Indicators that suggest this technique/vulnerability is applicable"
              },
              "when_to_look_for": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "minItems": 2,
                "description": "Situations or contexts where this cheatsheet becomes relevant"
              }
            }
          },
          "scenarios": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["title", "context", "approach", "commands", "expected_outcome", "why_this_works"],
              "properties": {
                "title": {
                  "type": "string",
                  "description": "Scenario title (e.g., 'Scenario 1: Linux Web Server - /etc/passwd Retrieval')"
                },
                "context": {
                  "type": "string",
                  "description": "Detailed setup/environment description"
                },
                "approach": {
                  "type": "string",
                  "description": "Step-by-step methodology explanation"
                },
                "commands": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "Command IDs referenced for this scenario (link by ID)"
                },
                "expected_outcome": {
                  "type": "string",
                  "description": "What success looks like"
                },
                "why_this_works": {
                  "type": "string",
                  "description": "Technical explanation of the underlying vulnerability/mechanism"
                }
              }
            },
            "minItems": 3,
            "maxItems": 5,
            "description": "3-5 detailed real-world scenarios"
          },
          "sections": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["title", "notes", "commands"],
              "properties": {
                "title": {
                  "type": "string",
                  "description": "Section title (e.g., 'Phase 1: Detection & Verification')"
                },
                "notes": {
                  "type": "string",
                  "description": "Contextual guidance for this phase/section"
                },
                "commands": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "minItems": 1,
                  "description": "Command IDs for this section (link by ID, not command text)"
                }
              }
            },
            "minItems": 1,
            "description": "Phased command execution sections"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Tags for categorization (e.g., WEB, OSCP:HIGH, QUICK_WIN)"
          }
        }
      }
    }
  }
}
