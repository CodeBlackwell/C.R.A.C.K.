{
  "commands": [
    {
      "id": "ps-search-credentials",
      "name": "PowerShell Search Files for Credentials",
      "description": "One-liner commands to search Windows filesystem for credential-containing files",
      "command": "Get-ChildItem -Path <SEARCH_PATH> -Include <PATTERNS> -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern <KEYWORD>",
      "category": "POST_EXPLOIT",
      "subcategory": "CREDENTIAL_HARVESTING",
      "os": "WINDOWS",
      "variables": [
        {
          "name": "<SEARCH_PATH>",
          "description": "Starting directory path for recursive search",
          "example": "C:\\Users",
          "required": true
        },
        {
          "name": "<PATTERNS>",
          "description": "File patterns to search (comma-separated)",
          "example": "*.txt,*.xml,*.ini,*.config",
          "required": false
        },
        {
          "name": "<KEYWORD>",
          "description": "String pattern to search for within files",
          "example": "password",
          "required": true
        }
      ],
      "flags": [
        {
          "flag": "-Path",
          "description": "Root directory to begin search",
          "default_value": "Current directory"
        },
        {
          "flag": "-Include",
          "description": "File patterns to include in search (wildcards supported)",
          "default_value": "All files"
        },
        {
          "flag": "-Recurse",
          "description": "Search subdirectories recursively",
          "default_value": "false"
        },
        {
          "flag": "-ErrorAction SilentlyContinue",
          "description": "Suppress access denied errors during search",
          "default_value": "Continue (stops on error)"
        },
        {
          "flag": "Select-String -Pattern",
          "description": "Search file contents for regex pattern (like grep)",
          "default_value": null
        }
      ],
      "examples": [
        {
          "command": "Get-ChildItem -Path C:\\Users -Include *.txt,*.xml,*.ini,*.config -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern 'password'",
          "description": "Search all user directories for files containing the word 'password'",
          "context": "Broad credential hunting"
        },
        {
          "command": "Get-ChildItem -Path C:\\ -Include unattend.xml,sysprep.inf,sysprep.xml -Recurse -ErrorAction SilentlyContinue",
          "description": "Find Windows deployment answer files (often contain cleartext admin passwords)",
          "context": "Windows unattend file credential disclosure"
        },
        {
          "command": "Get-Content C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt",
          "description": "Read PowerShell command history for all users (may contain credentials in commands)",
          "context": "PowerShell history credential disclosure"
        },
        {
          "command": "Get-ChildItem -Path C:\\inetpub\\wwwroot -Include web.config -Recurse | Select-String -Pattern 'connectionString'",
          "description": "Search IIS web roots for database connection strings in web.config files",
          "context": "Web application credential extraction"
        },
        {
          "command": "Get-ChildItem -Path C:\\Users -Include *.kdbx,*.key -Recurse -ErrorAction SilentlyContinue",
          "description": "Search for KeePass password database files",
          "context": "Password manager database discovery"
        },
        {
          "command": "dir C:\\Users\\*\\Desktop\\*.txt | Select-String -Pattern 'password|username|login'",
          "description": "Search desktop text files for credential-related keywords",
          "context": "Quick desktop credential check"
        }
      ],
      "educational": {
        "purpose": "Automate credential harvesting from common Windows file locations and configuration files after gaining initial access",
        "manual_alternative": "Manual file browsing via File Explorer (extremely time-consuming and error-prone)",
        "common_failures": [
          "Forgetting -ErrorAction SilentlyContinue causes search to halt on access denied errors",
          "Searching C:\\ without filters takes too long (narrow search path and file types)",
          "Select-String is case-insensitive by default - use -CaseSensitive if needed",
          "Large result sets flood console - pipe to | Out-File results.txt to save output"
        ],
        "when_to_use": [
          "After gaining user-level access, searching for privilege escalation credentials",
          "Hunting for database credentials in web application configs",
          "Finding deployment/configuration files with hardcoded passwords",
          "OSCP post-exploitation credential hunting phase"
        ],
        "exam_relevance": "MEDIUM-HIGH - Credential reuse is common in OSCP labs. Found credentials often enable lateral movement or privilege escalation.",
        "time_estimate": "30 seconds to 5 minutes depending on search scope",
        "technical_notes": [
          "Select-String is PowerShell's grep equivalent (searches file contents)",
          "Get-ChildItem (alias: dir, ls, gci) finds files by name/pattern",
          "-ErrorAction SilentlyContinue required when searching restricted directories",
          "Pipe results to Select-Object Filename,LineNumber,Line for cleaner output",
          "Common credential file locations: C:\\inetpub, C:\\xampp, C:\\Users\\*\\AppData"
        ]
      },
      "oscp_priority": "MEDIUM",
      "tags": [
        "POWERSHELL",
        "CREDENTIALS",
        "POST_EXPLOIT",
        "FILE_SEARCH",
        "OSCP:MEDIUM"
      ],
      "related_commands": [
        "ps-registry-autologon",
        "ps-search-desktop-flags",
        "grep-recursive-search"
      ],
      "high_value_files": [
        "unattend.xml - Windows deployment answer files",
        "sysprep.inf, sysprep.xml - System preparation files",
        "web.config - ASP.NET database connection strings",
        "*.ini - Application configuration files",
        "*.config - .NET configuration files",
        "ConsoleHost_history.txt - PowerShell command history",
        "*.kdbx - KeePass password databases",
        "*.rdp - Remote Desktop connection files (saved credentials)"
      ]
    }
  ]
}
