{
  "commands": [
    {
      "id": "ps-search-desktop-flags",
      "name": "PowerShell Search Desktop for Flags",
      "description": "One-liner commands to locate and retrieve OSCP-style flags on Windows desktop directories",
      "command": "Get-Content C:\\Users\\<USERNAME>\\Desktop\\*.txt",
      "category": "POST_EXPLOIT",
      "subcategory": "FLAG_RETRIEVAL",
      "os": "WINDOWS",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Target username whose desktop to search",
          "example": "Administrator",
          "required": true
        }
      ],
      "flags": [],
      "examples": [
        {
          "command": "Get-Content C:\\Users\\Administrator\\Desktop\\*.txt",
          "description": "Read all .txt files on Administrator's desktop (typical flag location)",
          "context": "OSCP flag retrieval after privilege escalation"
        },
        {
          "command": "Get-Content C:\\Users\\Administrator\\Desktop\\proof.txt",
          "description": "Read specific proof.txt flag file (OSCP standard)",
          "context": "Direct flag retrieval when filename known"
        },
        {
          "command": "Get-ChildItem -Path C:\\Users\\Administrator\\Desktop -Recurse -File | Get-Content",
          "description": "Recursively read all files on Administrator desktop (including subdirectories)",
          "context": "Comprehensive flag search when location uncertain"
        },
        {
          "command": "dir C:\\Users\\Administrator\\Desktop",
          "description": "List desktop contents first to identify flag filename before retrieval",
          "context": "Reconnaissance before flag capture"
        },
        {
          "command": "Get-ChildItem -Path C:\\Users -Recurse -Include *.txt,*.flag -ErrorAction SilentlyContinue | Select-Object FullName,Length | Format-Table -AutoSize",
          "description": "Search all user directories for .txt and .flag files (wide net approach)",
          "context": "Thorough flag hunting when standard paths empty"
        },
        {
          "command": "Get-Content C:\\Users\\*\\Desktop\\proof.txt",
          "description": "Search all user desktops for proof.txt using wildcard",
          "context": "Multi-user flag search"
        }
      ],
      "educational": {
        "purpose": "Quickly locate and retrieve OSCP exam flags from Windows hosts after gaining Administrator or SYSTEM access",
        "manual_alternative": "GUI navigation: Open File Explorer → C:\\Users\\Administrator\\Desktop → Double-click proof.txt (not practical via reverse shell)",
        "common_failures": [
          "Access denied - need Administrator or SYSTEM privileges to read other users' desktops",
          "File not found - flag may be in different user directory or subdirectory",
          "Wildcards (*) not expanding - ensure proper quoting in remote commands",
          "ErrorAction not set - errors from inaccessible directories halt execution"
        ],
        "when_to_use": [
          "Immediately after successful privilege escalation to Administrator/SYSTEM",
          "After lateral movement to retrieve remote host flags",
          "When combining with Invoke-Command for remote flag retrieval via WinRM",
          "OSCP exam flag capture phase"
        ],
        "exam_relevance": "CRITICAL - Final step in OSCP exploitation. Must retrieve proof.txt hash for points.",
        "time_estimate": "<5 seconds per command",
        "technical_notes": [
          "Get-Content (alias: cat, gc, type) reads file contents to stdout",
          "Wildcards (*) expand to match all files with pattern",
          "-Recurse searches subdirectories (slower but thorough)",
          "-ErrorAction SilentlyContinue suppresses access denied errors during broad searches",
          "Get-ChildItem (alias: dir, ls, gci) lists directory contents"
        ]
      },
      "oscp_priority": "HIGH",
      "tags": [
        "POWERSHELL",
        "FLAG_RETRIEVAL",
        "POST_EXPLOIT",
        "OSCP:HIGH",
        "PRIVILEGE_ESCALATION"
      ],
      "related_commands": [
        "ps-winrm-invoke-command",
        "ps-search-credentials",
        "ps-registry-autologon"
      ],
      "one_liner_combos": [
        {
          "description": "Remote flag retrieval via WinRM (complete one-liner)",
          "command": "$u='jen';$p='Nexus123!';$s=ConvertTo-SecureString $p -AsPlaintext -Force;$c=New-Object System.Management.Automation.PSCredential $u,$s;Invoke-Command -ComputerName 192.168.117.70 -Credential $c -ScriptBlock {Get-Content C:\\Users\\Administrator\\Desktop\\*.txt}"
        },
        {
          "description": "List then retrieve (two-step one-liner with semicolon)",
          "command": "dir C:\\Users\\Administrator\\Desktop; Get-Content C:\\Users\\Administrator\\Desktop\\proof.txt"
        }
      ]
    }
  ]
}
