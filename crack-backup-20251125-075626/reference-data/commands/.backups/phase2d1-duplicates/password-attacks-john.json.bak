{
  "category": "enumeration",
  "description": "Password hash cracking using John the Ripper (CPU-optimized)",
  "commands": [
    {
      "id": "john-single-crack",
      "name": "John Single Crack Mode",
      "category": "enumeration",
      "command": "john --single <HASH_FILE>",
      "description": "Single crack mode using username-based variations",
      "tags": ["JOHN", "JTR", "SINGLE_MODE", "HASH_CRACKING", "OSCP:MEDIUM"],
      "variables": [
        {
          "name": "<HASH_FILE>",
          "description": "File containing username:hash pairs",
          "example": "shadow.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "--single": "Single crack mode - Generates password candidates based on username and GECOS fields. Most effective when hash file contains usernames (user:hash format). JtR applies intelligent mutations to username (john → john1, john123, John, JOHN, nhoj, etc.). Very fast - try FIRST before wordlist attacks. Success rate ~5-15% for weak passwords."
      },
      "success_indicators": [
        "Loaded X password hash",
        "guesses: X",
        "username (user)"
      ],
      "failure_indicators": [
        "No password hashes loaded",
        "0 password hashes cracked"
      ],
      "next_steps": [
        "john-show",
        "john-wordlist-attack"
      ],
      "alternatives": [
        "hashcat with prince attack (similar username-based mutations)"
      ],
      "notes": "OSCP TIP: Always run single mode FIRST - it's fast (<1 minute) and surprisingly effective. Common successes: username123, Username1!, Username@2023. Requires username:hash format. Most effective on /etc/shadow dumps where GECOS fields provide hints (full names, departments).",
      "oscp_relevance": "medium"
    },
    {
      "id": "john-wordlist-attack",
      "name": "John Wordlist Attack",
      "category": "enumeration",
      "command": "john --wordlist=<WORDLIST> <HASH_FILE>",
      "description": "Dictionary attack using wordlist",
      "tags": ["JOHN", "JTR", "WORDLIST", "DICTIONARY_ATTACK", "HASH_CRACKING", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<WORDLIST>",
          "description": "Path to password wordlist",
          "example": "/usr/share/wordlists/rockyou.txt",
          "required": true
        },
        {
          "name": "<HASH_FILE>",
          "description": "File containing hashes",
          "example": "hashes.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "--wordlist": "Wordlist mode - Straight dictionary attack without mutations. Each password from wordlist tested as-is. Faster than rules mode but less coverage. Use for initial quick scan with common password lists. Default wordlist (if no path): /usr/share/john/password.lst (3,559 passwords)."
      },
      "success_indicators": [
        "Loaded X password hash",
        "guesses: X"
      ],
      "notes": "Standard dictionary attack. Run after --single mode. Use rockyou.txt for comprehensive coverage (14M passwords). JtR auto-detects hash format in most cases.",
      "oscp_relevance": "high"
    },
    {
      "id": "john-rules-attack",
      "name": "John Rule-Based Attack",
      "category": "enumeration",
      "command": "john --wordlist=<WORDLIST> --rules=<RULESET> <HASH_FILE>",
      "description": "Apply mutation rules to wordlist",
      "tags": ["JOHN", "JTR", "RULES", "MUTATION", "HASH_CRACKING", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<WORDLIST>",
          "description": "Base wordlist for mutations",
          "example": "/usr/share/wordlists/rockyou.txt",
          "required": true
        },
        {
          "name": "<RULESET>",
          "description": "Rule name from john.conf",
          "example": "sshRules",
          "required": true
        },
        {
          "name": "<HASH_FILE>",
          "description": "File containing hashes",
          "example": "ssh.hash",
          "required": true
        }
      ],
      "flag_explanations": {
        "--rules": "Rules mode - Apply mutation rules from /etc/john/john.conf. Rules modify wordlist passwords (append, prepend, capitalize, etc.). Built-in rules: Wordlist (default), Extra, Jumbo, KoreLogic, All. Custom rules: Add [List.Rules:RuleName] section to john.conf. Rules dramatically increase coverage (password → Password1!, password123, etc.)."
      },
      "success_indicators": [
        "guesses: X",
        "Proceeding with wordlist mode"
      ],
      "prerequisites": [
        "john-add-custom-rules"
      ],
      "notes": "OSCP TIP: Rule-based attacks crack passwords not in wordlist. Users modify base words to meet policies (Password → Password123!). Custom rules in /etc/john/john.conf: [List.Rules:sshRules] then rule functions. Default rules often sufficient - try before custom.",
      "oscp_relevance": "high"
    },
    {
      "id": "john-format-specify",
      "name": "John Specify Hash Format",
      "category": "enumeration",
      "command": "john --format=<FORMAT> --wordlist=<WORDLIST> <HASH_FILE>",
      "description": "Explicitly specify hash format (when auto-detect fails)",
      "tags": ["JOHN", "JTR", "FORMAT", "HASH_TYPE", "HASH_CRACKING", "OSCP:MEDIUM"],
      "variables": [
        {
          "name": "<FORMAT>",
          "description": "Hash format identifier",
          "example": "raw-md5",
          "required": true
        },
        {
          "name": "<WORDLIST>",
          "description": "Password wordlist",
          "example": "/usr/share/wordlists/rockyou.txt",
          "required": true
        },
        {
          "name": "<HASH_FILE>",
          "description": "File containing hashes",
          "example": "hashes.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "--format": "Hash format - Override auto-detection. Required when: 1) Auto-detect fails 2) Multiple hash types possible (MD2/MD4/MD5 look identical) 3) Custom format needed. List formats: john --list=formats. Common: raw-md5, raw-sha1, raw-sha256, nt (NTLM), bcrypt, descrypt, md5crypt, sha512crypt."
      },
      "success_indicators": [
        "Loaded X password hash (FORMAT)",
        "format confirmed in output"
      ],
      "failure_indicators": [
        "No password hashes loaded (check --format)",
        "Unknown format name"
      ],
      "notes": "List all formats: john --list=formats | grep -i <hash_type>. Common formats: raw-md5 (plain MD5), nt (NTLM), Raw-SHA256, bcrypt, md5crypt ($1$), sha512crypt ($6$). Auto-detect usually works but explicit format avoids ambiguity.",
      "oscp_relevance": "medium"
    },
    {
      "id": "john-show-cracked",
      "name": "Show Cracked Passwords",
      "category": "enumeration",
      "command": "john --show <HASH_FILE>",
      "description": "Display previously cracked passwords from john.pot",
      "tags": ["JOHN", "JTR", "RESULTS", "OUTPUT", "HASH_CRACKING", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<HASH_FILE>",
          "description": "Original hash file",
          "example": "hashes.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "--show": "Show cracked - Display passwords from ~/.john/john.pot (persistent storage). JtR automatically saves cracked hashes. Format: username:password or hash:password. Use for: 1) Viewing results 2) Extracting passwords for documentation 3) Checking crack status."
      },
      "success_indicators": [
        "username:password",
        "X password hash cracked, Y left"
      ],
      "notes": "OSCP REQUIREMENT: Document all cracked passwords. Always run --show after successful crack. JtR saves to ~/.john/john.pot permanently. Combine with --format if needed: john --show --format=raw-md5 hashes.txt",
      "oscp_relevance": "high"
    },
    {
      "id": "john-ssh-key-crack",
      "name": "Crack SSH Private Key Passphrase",
      "category": "enumeration",
      "command": "john --wordlist=<WORDLIST> --rules=<RULESET> <SSH_HASH>",
      "description": "Crack SSH private key passphrase (supports all ciphers)",
      "tags": ["JOHN", "JTR", "SSH", "PRIVATE_KEY", "PASSPHRASE", "HASH_CRACKING", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<WORDLIST>",
          "description": "Password wordlist",
          "example": "custom_wordlist.txt",
          "required": true
        },
        {
          "name": "<RULESET>",
          "description": "Rule name from john.conf",
          "example": "sshRules",
          "required": true
        },
        {
          "name": "<SSH_HASH>",
          "description": "SSH key hash file (from ssh2john)",
          "example": "ssh.hash",
          "required": true
        }
      ],
      "flag_explanations": {
        "SSH format": "John automatically detects SSH format from ssh2john output. Supports ALL SSH ciphers including aes-256-ctr (which Hashcat does NOT support). No --format flag needed for ssh2john output."
      },
      "success_indicators": [
        "Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH])",
        "PASSPHRASE (key)"
      ],
      "prerequisites": [
        "ssh2john-extract"
      ],
      "alternatives": [
        "hashcat -m 22921 (aes-256-cbc only, NOT aes-256-ctr)"
      ],
      "notes": "OSCP TIP: JtR supports MORE SSH ciphers than Hashcat. Use JtR for SSH keys (especially modern keys with aes-256-ctr). Extract hash: ssh2john id_rsa > ssh.hash. Build custom wordlist from user information (notes.txt, common words, dates). Apply rules based on password policy.",
      "oscp_relevance": "high"
    },
    {
      "id": "john-keepass-crack",
      "name": "Crack KeePass Database",
      "category": "enumeration",
      "command": "john --wordlist=<WORDLIST> --rules=<RULESET> <KEEPASS_HASH>",
      "description": "Crack KeePass master password",
      "tags": ["JOHN", "JTR", "KEEPASS", "PASSWORD_MANAGER", "HASH_CRACKING", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<WORDLIST>",
          "description": "Password wordlist",
          "example": "/usr/share/wordlists/rockyou.txt",
          "required": true
        },
        {
          "name": "<RULESET>",
          "description": "Rule name",
          "example": "sshRules",
          "required": true
        },
        {
          "name": "<KEEPASS_HASH>",
          "description": "KeePass hash file (from keepass2john)",
          "example": "keepass.hash",
          "required": true
        }
      ],
      "flag_explanations": {
        "KeePass format": "John auto-detects KeePass format from keepass2john output. Supports KeePass 1.x and 2.x. CPU-based cracking often comparable to GPU for KeePass (slow algorithm by design)."
      },
      "success_indicators": [
        "Loaded 1 password hash (KeePass [SHA256 AES])",
        "PASSWORD (Database)"
      ],
      "prerequisites": [
        "keepass2john-extract"
      ],
      "notes": "Extract hash: keepass2john Database.kdbx > keepass.hash. Remove 'Database:' prefix. KeePass uses slow KDF - focused wordlists essential. User password patterns critical (reuse with policy modifications).",
      "oscp_relevance": "high"
    },
    {
      "id": "john-incremental-mode",
      "name": "John Incremental Mode (Brute-Force)",
      "category": "enumeration",
      "command": "john --incremental <HASH_FILE>",
      "description": "Brute-force attack with intelligent character frequency",
      "tags": ["JOHN", "JTR", "INCREMENTAL", "BRUTE_FORCE", "HASH_CRACKING", "OSCP:LOW"],
      "variables": [
        {
          "name": "<HASH_FILE>",
          "description": "File containing hashes",
          "example": "hashes.txt",
          "required": true
        }
      ],
      "flag_explanations": {
        "--incremental": "Incremental mode - Brute-force with character frequency analysis. NOT pure brute-force - uses statistical model based on common passwords. Tries likely character combinations first (e → a → o vs rare combos). Modes: ASCII (all printable), Alnum (alphanumeric), Digits (numbers only), LowerNum, UpperNum. Specify: --incremental=Digits. Very slow - use as last resort."
      },
      "success_indicators": [
        "Proceeding with incremental mode",
        "guesses: X"
      ],
      "notes": "Last resort attack - extremely slow. Use only when: 1) No wordlist success 2) Short password suspected 3) Fast hash (MD5, NTLM). NOT viable for OSCP exam time constraints unless very short password (<6 chars).",
      "oscp_relevance": "low"
    },
    {
      "id": "john-status",
      "name": "John Show Status",
      "category": "enumeration",
      "command": "john --status",
      "description": "Display status of running/paused cracking session",
      "tags": ["JOHN", "JTR", "STATUS", "PROGRESS", "HASH_CRACKING", "OSCP:MEDIUM"],
      "variables": [],
      "flag_explanations": {
        "--status": "Status display - Show progress of current/last session. Information: Time running, Progress %, Passwords tested, Guesses (cracked), Current word, ETA. Use to monitor long-running attacks. Press any key during run to see status without --status flag."
      },
      "success_indicators": [
        "Session..........: ",
        "Progress.........: ",
        "Time running.....: "
      ],
      "notes": "Monitor long attacks: john --status. During active session, press any key for instant status update (no need for separate command). Critical for OSCP time management - check ETA regularly.",
      "oscp_relevance": "medium"
    },
    {
      "id": "john-restore-session",
      "name": "John Restore Session",
      "category": "enumeration",
      "command": "john --restore",
      "description": "Resume previously interrupted cracking session",
      "tags": ["JOHN", "JTR", "RESTORE", "SESSION", "HASH_CRACKING", "OSCP:MEDIUM"],
      "variables": [],
      "flag_explanations": {
        "--restore": "Restore session - Resume from last checkpoint. JtR auto-saves progress to ~/.john/john.rec. Restore after: Ctrl+C, crash, reboot. Continues from exact position. All parameters restored automatically (no need to specify wordlist, rules, etc.)."
      },
      "success_indicators": [
        "Restored session",
        "Proceeding with <mode>"
      ],
      "failure_indicators": [
        "No session file found"
      ],
      "notes": "JtR auto-saves to ~/.john/john.rec. Resume with: john --restore. Useful for multi-hour attacks interrupted by network issues or intentional pause. Session file cleared after successful completion.",
      "oscp_relevance": "medium"
    },
    {
      "id": "john-list-formats",
      "name": "List All Supported Formats",
      "category": "enumeration",
      "command": "john --list=formats | grep -i <SEARCH>",
      "description": "List all hash formats supported by John",
      "tags": ["JOHN", "JTR", "FORMATS", "REFERENCE", "HASH_CRACKING", "OSCP:MEDIUM"],
      "variables": [
        {
          "name": "<SEARCH>",
          "description": "Optional search term to filter formats",
          "example": "ssh",
          "required": false
        }
      ],
      "flag_explanations": {
        "--list=formats": "List formats - Display all supported hash types. Use grep to filter (john --list=formats | grep -i md5). Common prefixes: raw- (simple hashes), dynamic- (complex formats), crypt- (Unix crypt variants). Hundreds of formats supported."
      },
      "success_indicators": [
        "descrypt",
        "raw-md5",
        "nt"
      ],
      "notes": "Reference command - find correct format name. Examples: raw-md5, raw-sha256, nt (NTLM), bcrypt, SSH, KeePass. Grep for hash type: john --list=formats | grep -i keepass",
      "oscp_relevance": "medium"
    },
    {
      "id": "john-add-custom-rules",
      "name": "Add Custom Rules to john.conf",
      "category": "enumeration",
      "command": "sudo sh -c 'cat <RULE_FILE> >> /etc/john/john.conf'",
      "description": "Append custom rules to John configuration",
      "tags": ["JOHN", "JTR", "RULES", "CUSTOM", "CONFIG", "OSCP:HIGH"],
      "variables": [
        {
          "name": "<RULE_FILE>",
          "description": "File containing custom rules with [List.Rules:Name] header",
          "example": "custom.rule",
          "required": true
        }
      ],
      "flag_explanations": {
        "Rule format": "Rules must start with [List.Rules:RuleName] header, then one rule per line. Rule syntax: c=capitalize, $X=append X, ^X=prepend X, d=duplicate, r=reverse, etc. See /etc/john/john.conf for examples. Reference: john --list=rules"
      },
      "success_indicators": [
        "File appended successfully"
      ],
      "prerequisites": [
        "john-test-rules"
      ],
      "notes": "OSCP TIP: Create custom rules based on password policy. Example: Policy requires capital + 3 digits + special → Rules: c $1 $3 $7 $!, c $1 $2 $3 $!. Format: [List.Rules:sshRules] then c $1 $3 $7 $!. Test first: echo 'password' > test.txt && john --wordlist=test.txt --rules=sshRules --stdout (verify mutations).",
      "oscp_relevance": "high"
    },
    {
      "id": "john-test-rules",
      "name": "Test Rules with Stdout",
      "category": "enumeration",
      "command": "john --wordlist=<WORDLIST> --rules=<RULESET> --stdout",
      "description": "Test rule mutations without cracking (debug mode)",
      "tags": ["JOHN", "JTR", "RULES", "TEST", "DEBUG", "OSCP:MEDIUM"],
      "variables": [
        {
          "name": "<WORDLIST>",
          "description": "Test wordlist",
          "example": "test_words.txt",
          "required": true
        },
        {
          "name": "<RULESET>",
          "description": "Rule name to test",
          "example": "sshRules",
          "required": true
        }
      ],
      "flag_explanations": {
        "--stdout": "Debug mode - Output mutated passwords to stdout instead of cracking. Verify rules produce expected mutations. Example: echo 'password' > test.txt && john --wordlist=test.txt --rules=MyRules --stdout. Critical for testing custom rules before full attack."
      },
      "success_indicators": [
        "Password1",
        "password!",
        "mutated output"
      ],
      "notes": "ALWAYS test custom rules before cracking. Single word test: echo 'password' > test.txt && john --wordlist=test.txt --rules=sshRules --stdout. Verify mutations match password policy requirements.",
      "oscp_relevance": "medium"
    }
  ]
}
