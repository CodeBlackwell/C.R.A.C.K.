{
  "category": "enumeration",
  "description": "PowerView ACL and permission enumeration for privilege escalation path discovery",
  "commands": [
    {
      "id": "powerview-get-objectacl",
      "name": "Get Object ACL (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity <OBJECT>",
      "description": "Retrieve Access Control List (permissions) for any AD object to identify who has what access",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<OBJECT>",
          "description": "AD object to query (username, groupname, or DN)",
          "example": "administrator",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Identity": "Specifies the AD object to query ACLs for. Accepts username, group name, computer name, or distinguished name.",
        "-ResolveGUIDs (optional)": "Resolves GUIDs in ObjectAceType to human-readable names. Use: Get-ObjectAcl -Identity <OBJECT> -ResolveGUIDs"
      },
      "success_indicators": [
        "ObjectDN",
        "ActiveDirectoryRights",
        "SecurityIdentifier",
        "ACE entries displayed"
      ],
      "failure_indicators": [
        "Module not imported",
        "Object not found"
      ],
      "next_steps": [
        "powerview-convert-sidtoname",
        "Filter for dangerous permissions: Get-ObjectAcl -Identity <OBJECT> | ? {$_.ActiveDirectoryRights -match 'GenericAll'}",
        "Check who has rights: Convert-SidToName <SID>"
      ],
      "alternatives": [
        "get-acl",
        "dsacls"
      ],
      "prerequisites": [
        "import-powerview"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "Too much output": "Filter specific fields: Get-ObjectAcl -Identity <OBJECT> | select SecurityIdentifier,ActiveDirectoryRights"
      },
      "notes": "Returns ACL (Access Control List) - all permissions applied to an object.\n\nEACH ACE (ACCESS CONTROL ENTRY) DEFINES:\n1.\n\nSecurityIdentifier:\nWho has access (as SID)\n2.\n\nActiveDirectoryRights:\nWhat access they have (GenericAll, WriteDACL, etc.)\n\nOUTPUT ANALYSIS:\nOutput is verbose - use Convert-SidToName to resolve SIDs.\nFilter for dangerous rights.\n\nOSCP PRIVESC:\nLook for GenericAll, WriteDACL, WriteOwner on privileged groups/users.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-objectacl-genericall",
      "name": "Find GenericAll Permissions (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity \"<OBJECT>\" | ? {$_.ActiveDirectoryRights -eq \"GenericAll\"} | select SecurityIdentifier,ActiveDirectoryRights",
      "description": "Enumerate who has GenericAll (full control) permissions on a specific AD object",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "GENERICALL",
        "PRIVESC",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<OBJECT>",
          "description": "AD object to check (group name, username, etc.)",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "flag_explanations": {
        "? {$_.ActiveDirectoryRights -eq \"GenericAll\"}": "PowerShell Where-Object filter. Only shows ACEs where the permission is GenericAll (full control).",
        "select SecurityIdentifier,ActiveDirectoryRights": "Shows only SID (who has access) and rights (GenericAll)."
      },
      "success_indicators": [
        "SecurityIdentifier",
        "GenericAll",
        "SIDs with full control listed"
      ],
      "failure_indicators": [
        "No matching ACEs",
        "Module not imported"
      ],
      "next_steps": [
        "powerview-convert-sidtoname",
        "Convert all SIDs: Get-ObjectAcl -Identity \"<OBJECT>\" | ? {$_.ActiveDirectoryRights -eq \"GenericAll\"} | select -ExpandProperty SecurityIdentifier | Convert-SidToName",
        "Abuse GenericAll: Add-DomainGroupMember, Set-DomainUserPassword"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview",
        "powerview-get-objectacl"
      ],
      "troubleshooting": {
        "No results": "No GenericAll permissions found. Try other dangerous rights: WriteDACL, WriteOwner, ForceChangePassword"
      },
      "notes": "GENERICALL = FULL CONTROL\n\nON USER OBJECTS:\n- Reset their password\n- Modify attributes\n- Read all properties\n\nON GROUP OBJECTS:\n- Add/remove members (add yourself to Domain Admins!)\n- Modify group attributes\n\nON COMPUTER OBJECTS:\n- Modify servicePrincipalName (Kerberoasting)\n- Access LAPS password\n\nOSCP:\nMost powerful ACL for privilege escalation.\nIf you have GenericAll on privileged group → add yourself to group.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-convert-sidtoname",
      "name": "Convert SID to Username (PowerView)",
      "category": "enumeration",
      "command": "Convert-SidToName <SID>",
      "description": "Resolve Security Identifier (SID) to human-readable username, group name, or computer name",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "SID",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<SID>",
          "description": "Security Identifier to resolve",
          "example": "S-1-5-21-1987370270-658905905-1781884369-1104",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "DOMAIN\\username",
        "Resolved name displayed"
      ],
      "failure_indicators": [
        "Module not imported",
        "SID not found"
      ],
      "next_steps": [
        "Use with ACL enumeration: Get-ObjectAcl | select -ExpandProperty SecurityIdentifier | Convert-SidToName",
        "Identify object type: Get-NetUser -Identity <NAME> or Get-NetGroup -Identity <NAME>"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "SID not found": "SID may be from external domain, deleted object, or invalid format"
      },
      "notes": "SIDs (SECURITY IDENTIFIERS):\nUnique identifiers for AD objects.\n\nFORMAT:\nS-1-5-21-<domain>-<RID>\n\nCOMMON RIDS:\n- 500:\nAdministrator\n- 512:\nDomain Admins\n- 513:\nDomain Users\n\nGet-ObjectAcl returns SIDs in SecurityIdentifier field.\nMust convert to names for analysis.\n\nBATCH CONVERSION:\n  Get-ObjectAcl | select -ExpandProperty SecurityIdentifier | Convert-SidToName\n\nALTERNATIVE:\n  [system.security.principal.securityidentifier]::new('<sid>').translate([system.security.principal.ntaccount]).value\n\nOSCP:\nSIDs are useless until converted to names.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-objectacl-writedacl",
      "name": "Find WriteDACL Permissions (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity \"<OBJECT>\" | ? {$_.ActiveDirectoryRights -match \"WriteDacl\"} | select SecurityIdentifier,ActiveDirectoryRights",
      "description": "Enumerate who can modify ACLs (permissions) on an AD object - allows granting yourself GenericAll",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "WRITEDACL",
        "PRIVESC",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<OBJECT>",
          "description": "AD object to check",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "flag_explanations": {
        "-match \"WriteDacl\"": "Regex match for WriteDacl permission. Also matches WriteDACL (case-insensitive)."
      },
      "success_indicators": [
        "SecurityIdentifier",
        "WriteDacl",
        "SIDs with DACL write access"
      ],
      "failure_indicators": [
        "No matching ACEs",
        "Module not imported"
      ],
      "next_steps": [
        "Convert SIDs to names",
        "Abuse WriteDACL: Add-DomainObjectAcl -TargetIdentity <OBJECT> -Rights All -PrincipalIdentity <YOUR_USER>",
        "Grant yourself GenericAll, then add to group or reset password"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview",
        "powerview-get-objectacl"
      ],
      "troubleshooting": {
        "No results": "Try WriteOwner instead - allows changing object owner to yourself, then modifying permissions"
      },
      "notes": "WRITEDACL = MODIFY ACL PERMISSIONS\n\nATTACK PATH:\n1.\n\nYou have WriteDACL on target object\n2.\n\nGrant yourself GenericAll on that object\n3.\n\nNow you have full control\n\nEXAMPLE:\nWriteDACL on 'Domain Admins' → Grant GenericAll → Add yourself to Domain Admins\n\nSIMILAR POWERFUL RIGHTS:\n- WriteOwner:\nChange owner, then modify ACL\n- WriteProperty:\nModify attributes\n\nOSCP:\nWriteDACL is as powerful as GenericAll - just requires one extra step.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-objectacl-forcechangepassword",
      "name": "Find ForceChangePassword Rights (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity \"<USERNAME>\" -ResolveGUIDs | ? {$_.ObjectAceType -eq \"User-Force-Change-Password\"} | select SecurityIdentifier,ObjectAceType",
      "description": "Enumerate who can reset passwords for a specific user without knowing the current password",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "PASSWORD_RESET",
        "PRIVESC",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Target user to check password reset rights on",
          "example": "administrator",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ResolveGUIDs": "Converts GUIDs in ObjectAceType to human-readable names like 'User-Force-Change-Password'.",
        "ObjectAceType -eq \"User-Force-Change-Password\"": "Filters for the specific extended right that allows password resets."
      },
      "success_indicators": [
        "SecurityIdentifier",
        "User-Force-Change-Password",
        "SIDs with password reset rights"
      ],
      "failure_indicators": [
        "No matching ACEs",
        "Module not imported"
      ],
      "next_steps": [
        "Convert SIDs to names",
        "Abuse: Set-DomainUserPassword -Identity <USERNAME> -Password (ConvertTo-SecureString 'NewPass123!' -AsPlainText -Force)",
        "Authenticate as target user with new password"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview",
        "powerview-get-objectacl"
      ],
      "troubleshooting": {
        "No results": "User may be protected by AdminSDHolder. Check admincount attribute: Get-NetUser -Identity <USERNAME> | select admincount"
      },
      "notes": "USER-FORCE-CHANGE-PASSWORD:\nCan reset user's password without knowing current password.\n\nATTACK PATH:\n1.\n\nYou have ForceChangePassword on target user\n2.\n\nReset their password\n3.\n\nAuthenticate as them\n\nNO CURRENT PASSWORD NEEDED.\nNO ACCOUNT LOCKOUT.\n\nSIMILAR RIGHTS:\nAllExtendedRights (includes password reset + other extended rights)\n\nPROTECTED ACCOUNTS:\nadmincount=1 may have this right restricted by AdminSDHolder.\n\nOSCP:\nIf you can reset Domain Admin password → domain compromised.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-objectacl-writeowner",
      "name": "Find WriteOwner Permissions (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity \"<OBJECT>\" | ? {$_.ActiveDirectoryRights -match \"WriteOwner\"} | select SecurityIdentifier,ActiveDirectoryRights",
      "description": "Enumerate who can change ownership of an AD object - allows granting yourself full permissions",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "WRITEOWNER",
        "PRIVESC",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<OBJECT>",
          "description": "AD object to check",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "flag_explanations": {
        "-match \"WriteOwner\"": "Regex filter for WriteOwner permission."
      },
      "success_indicators": [
        "SecurityIdentifier",
        "WriteOwner",
        "SIDs with ownership change rights"
      ],
      "failure_indicators": [
        "No matching ACEs",
        "Module not imported"
      ],
      "next_steps": [
        "Convert SIDs to names",
        "Abuse WriteOwner: (1) Set-DomainObjectOwner -Identity <OBJECT> -OwnerIdentity <YOUR_USER>, (2) Grant yourself GenericAll, (3) Abuse full control"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview",
        "powerview-get-objectacl"
      ],
      "troubleshooting": {
        "No results": "Try WriteDACL or GenericAll instead"
      },
      "notes": "WRITEOWNER = CHANGE OBJECT OWNER\nObject owners have implicit rights to modify the object's ACL.\n\nATTACK PATH:\n1.\n\nYou have WriteOwner on target object\n2.\n\nChange owner to yourself:\nSet-DomainObjectOwner\n3.\n\nAs owner, grant yourself GenericAll\n4.\n\nAbuse full control (add to group, reset password, etc.)\n\nCOMPARISON:\nSimilar to WriteDACL but requires two steps instead of one.\n\nOSCP:\nWriteOwner on privileged group = privilege escalation path.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-find-interestingdomainacl",
      "name": "Find Interesting ACL Misconfigurations (PowerView)",
      "category": "enumeration",
      "command": "Find-InterestingDomainAcl -ResolveGUIDs | ? {$_.IdentityReferenceName -match \"<USERNAME>\"}",
      "description": "Automatically discover ACL misconfigurations where specified user has dangerous permissions on other objects",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "AUTOMATED",
        "PRIVESC",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Your compromised username to check permissions for",
          "example": "stephanie",
          "required": true
        }
      ],
      "flag_explanations": {
        "-ResolveGUIDs": "Resolves GUIDs to human-readable permission names.",
        "? {$_.IdentityReferenceName -match \"<USERNAME>\"}": "Filters results to only show permissions YOUR user has on other objects."
      },
      "success_indicators": [
        "IdentityReferenceName",
        "ObjectDN",
        "ActiveDirectoryRights",
        "Permissions found"
      ],
      "failure_indicators": [
        "No interesting ACLs found",
        "Module not imported"
      ],
      "next_steps": [
        "Review ActiveDirectoryRights for exploitation opportunities",
        "Check ObjectDN to identify high-value targets",
        "Abuse identified permissions with Add-DomainGroupMember or Set-DomainUserPassword"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "Long execution time": "Command queries entire domain. For faster results, query specific objects with Get-ObjectAcl"
      },
      "notes": "AUTOMATED ACL ENUMERATION:\nScans entire domain for dangerous permissions.\n\nRETURNS INTERESTING RIGHTS:\n- GenericAll\n- WriteDACL\n- WriteOwner\n- ForceChangePassword\n\nKEY FIELDS:\n- IdentityReferenceName:\nWho has the permission (filter for your user)\n- ObjectDN:\nWhat object they have permission on (look for privileged groups/users)\n\nPERFORMANCE:\nSlow in large domains - consider manual enumeration of specific high-value targets.\n\nOSCP:\nRun this early to identify all potential privilege escalation paths via ACL abuse.",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-pathacl",
      "name": "Get Share Path ACL (PowerView)",
      "category": "enumeration",
      "command": "Get-PathAcl -Path \"\\\\<TARGET>\\<SHARE>\"",
      "description": "Enumerate file share permissions to identify accessible or misconfigured shares",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "SHARES",
        "PERMISSIONS",
        "OSCP:MEDIUM"
      ],
      "variables": [
        {
          "name": "<TARGET>",
          "description": "Target hostname or IP",
          "example": "DC1.corp.com",
          "required": true
        },
        {
          "name": "<SHARE>",
          "description": "Share name",
          "example": "SYSVOL",
          "required": true
        }
      ],
      "flag_explanations": {},
      "success_indicators": [
        "Path",
        "IdentityReference",
        "FileSystemRights",
        "Share permissions displayed"
      ],
      "failure_indicators": [
        "Access Denied",
        "Path not found",
        "Module not imported"
      ],
      "next_steps": [
        "Check for writable shares: FullControl, Modify, Write",
        "Look for sensitive data in accessible shares",
        "Check SYSVOL for GPP passwords"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview"
      ],
      "troubleshooting": {
        "Module not imported": "Import-Module .\\PowerView.ps1",
        "Access Denied": "No read permissions on share. Try other shares: Find-DomainShare -CheckShareAccess"
      },
      "notes": "NTFS PERMISSIONS ON NETWORK SHARES\n\nFILESYSTEMRIGHTS:\n- FullControl:\nread/write/delete\n- Modify:\nread/write\n- ReadAndExecute:\nread/execute\n\nIDENTITYREFERENCE:\nShows who has access (users/groups).\n\nCOMMON MISCONFIGURATION:\nEveryone or Authenticated Users with Modify/FullControl on sensitive shares.\n\nSYSVOL SHARE:\nDomain-wide readable.\nMay contain GPP passwords (cpassword attribute).\n\nOSCP:\nCheck all discovered shares for misconfigurations and sensitive data.",
      "oscp_relevance": "medium"
    },
    {
      "id": "powerview-get-objectacl-user",
      "name": "Get User Object ACL (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity \"<USERNAME>\" | select SecurityIdentifier,ActiveDirectoryRights",
      "description": "Enumerate who has permissions on a specific user account",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "PERMISSIONS",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<USERNAME>",
          "description": "Target username to check permissions on",
          "example": "sqlservice",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Identity": "Target object (user, group, computer) to check ACL on. Accepts username, DN, or SID."
      },
      "success_indicators": [
        "SecurityIdentifier",
        "ActiveDirectoryRights"
      ],
      "failure_indicators": [
        "Get-ObjectAcl not recognized",
        "Object not found"
      ],
      "next_steps": [
        "Convert SID to name: Convert-SidToName <SID>"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview"
      ],
      "troubleshooting": {
        "Object not found": "Verify username: Get-NetUser -Identity <USERNAME>"
      },
      "notes": "IDENTIFIES WHO CAN MODIFY USER ACCOUNT\n\nLOOK FOR:\n- GenericAll:\nFull control\n- WriteDACL:\nCan change permissions\n- ForceChangePassword:\nCan reset password",
      "oscp_relevance": "high"
    },
    {
      "id": "powerview-get-objectacl-group",
      "name": "Get Group Object ACL (PowerView)",
      "category": "enumeration",
      "command": "Get-ObjectAcl -Identity \"<GROUPNAME>\" | select SecurityIdentifier,ActiveDirectoryRights",
      "description": "Enumerate who has permissions on a specific group (e.g., Domain Admins)",
      "tags": [
        "ACTIVE_DIRECTORY",
        "ENUMERATION",
        "POWERVIEW",
        "ACL",
        "GROUPS",
        "OSCP:HIGH"
      ],
      "variables": [
        {
          "name": "<GROUPNAME>",
          "description": "Target group name to check permissions on",
          "example": "Domain Admins",
          "required": true
        }
      ],
      "flag_explanations": {
        "-Identity": "Target group to enumerate ACL. Use quotes for names with spaces."
      },
      "success_indicators": [
        "SecurityIdentifier",
        "ActiveDirectoryRights"
      ],
      "failure_indicators": [
        "Get-ObjectAcl not recognized",
        "Group not found"
      ],
      "next_steps": [
        "Check if you can add members: if GenericAll or WriteProperty on 'member' attribute"
      ],
      "alternatives": [],
      "prerequisites": [
        "import-powerview"
      ],
      "troubleshooting": {},
      "notes": "CRITICAL FOR PRIVILEGE ESCALATION\n\nGenericAll on Domain Admins = you can add yourself to the group.\n\nCOMMON MISCONFIGURATION:\nCheck this early in enumeration.",
      "oscp_relevance": "high"
    }
  ]
}