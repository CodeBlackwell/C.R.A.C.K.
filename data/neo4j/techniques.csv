"name","category","difficulty","description","oscp_applicable","steps","detection_difficulty","references"
"7zip Listfile Symlink Arbitrary File Read","privilege_escalation","medium","7zip's @listfile feature treats files prefixed with @ as containing lists of files to compress. When @id_rsa exists, 7zip reads id_rsa as a listfile. Since id_rsa is a symlink, 7zip follows it and reads /root/.ssh/id_rsa content. The -snl flag (store symlinks as links) doesn't prevent listfile feature from reading symlink targets. 7zip then tries to interpret SSH key lines as filenames, fails with 'No more files' errors, but displays the content in output. This allows arbitrary file read as root when binary runs via sudo.","True","Identify sudo binary using 7zip with writable source directory|Research 7zip @listfile feature and -snl flag behavior|Navigate to source directory (/var/www/html)|Create @filename marker (e.g., touch @id_rsa)|Create symlink to target file (ln -s /root/.ssh/id_rsa id_rsa)|Execute sudo binary to trigger 7zip backup|Extract file content from 7zip output (remove 'No more files' markers)|Use extracted content (SSH key, /etc/shadow, etc.) for privilege escalation","medium","https://book.hacktricks.xyz/linux-hardening/privilege-escalation/7z-symlink-abuse|7zip man page: -snl : store symbolic links as links"
